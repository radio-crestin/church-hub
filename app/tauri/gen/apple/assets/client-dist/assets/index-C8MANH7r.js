const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/webviewWindow-YTEqKU76.js","assets/webview-lznaJHrX.js","assets/dpi-BIcrl0fe.js","assets/window-BtdqqXmO.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Tf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ql(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var b0={exports:{}},Wc={};var Wk;function n4(){if(Wk)return Wc;Wk=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,s,i){var o=null;if(i!==void 0&&(o=""+i),s.key!==void 0&&(o=""+s.key),"key"in s){i={};for(var l in s)l!=="key"&&(i[l]=s[l])}else i=s;return s=i.ref,{$$typeof:t,type:r,key:o,ref:s!==void 0?s:null,props:i}}return Wc.Fragment=e,Wc.jsx=n,Wc.jsxs=n,Wc}var Yk;function r4(){return Yk||(Yk=1,b0.exports=n4()),b0.exports}var u=r4();const Zy=new WeakMap,s4=new WeakMap,fh={current:[]};let v0=!1,uu=0;const ru=new Set,jf=new Map;function YT(t){for(const e of t){if(fh.current.includes(e))continue;fh.current.push(e),e.recompute();const n=s4.get(e);if(n)for(const r of n){const s=Zy.get(r);s?.length&&YT(s)}}}function i4(t){const e={prevVal:t.prevState,currentVal:t.state};for(const n of t.listeners)n(e)}function a4(t){const e={prevVal:t.prevState,currentVal:t.state};for(const n of t.listeners)n(e)}function GT(t){if(uu>0&&!jf.has(t)&&jf.set(t,t.prevState),ru.add(t),!(uu>0)&&!v0)try{for(v0=!0;ru.size>0;){const e=Array.from(ru);ru.clear();for(const n of e){const r=jf.get(n)??n.prevState;n.prevState=r,i4(n)}for(const n of e){const r=Zy.get(n);r&&(fh.current.push(n),YT(r))}for(const n of e){const r=Zy.get(n);if(r)for(const s of r)a4(s)}}}finally{v0=!1,fh.current=[],jf.clear()}}function du(t){uu++;try{t()}finally{if(uu--,uu===0){const e=ru.values().next().value;e&&GT(e)}}}function o4(t){return typeof t=="function"}class l4{constructor(e,n){this.listeners=new Set,this.subscribe=r=>{var s,i;this.listeners.add(r);const o=(i=(s=this.options)==null?void 0:s.onSubscribe)==null?void 0:i.call(s,r,this);return()=>{this.listeners.delete(r),o?.()}},this.prevState=e,this.state=e,this.options=n}setState(e){var n,r,s;this.prevState=this.state,(n=this.options)!=null&&n.updateFn?this.state=this.options.updateFn(this.prevState)(e):o4(e)?this.state=e(this.prevState):this.state=e,(s=(r=this.options)==null?void 0:r.onUpdate)==null||s.call(r),GT(this)}}const na="__TSR_index",Gk="popstate",Xk="beforeunload";function c4(t){let e=t.getLocation();const n=new Set,r=o=>{e=t.getLocation(),n.forEach(l=>l({location:e,action:o}))},s=o=>{t.notifyOnIndexChange??!0?r(o):e=t.getLocation()},i=async({task:o,navigateOpts:l,...d})=>{if(l?.ignoreBlocker??!1){o();return}const p=t.getBlockers?.()??[],g=d.type==="PUSH"||d.type==="REPLACE";if(typeof document<"u"&&p.length&&g)for(const y of p){const m=hh(d.path,d.state);if(await y.blockerFn({currentLocation:e,nextLocation:m,action:d.type})){t.onBlocked?.();return}}o()};return{get location(){return e},get length(){return t.getLength()},subscribers:n,subscribe:o=>(n.add(o),()=>{n.delete(o)}),push:(o,l,d)=>{const f=e.state[na];l=Jk(f+1,l),i({task:()=>{t.pushState(o,l),r({type:"PUSH"})},navigateOpts:d,type:"PUSH",path:o,state:l})},replace:(o,l,d)=>{const f=e.state[na];l=Jk(f,l),i({task:()=>{t.replaceState(o,l),r({type:"REPLACE"})},navigateOpts:d,type:"REPLACE",path:o,state:l})},go:(o,l)=>{i({task:()=>{t.go(o),s({type:"GO",index:o})},navigateOpts:l,type:"GO"})},back:o=>{i({task:()=>{t.back(o?.ignoreBlocker??!1),s({type:"BACK"})},navigateOpts:o,type:"BACK"})},forward:o=>{i({task:()=>{t.forward(o?.ignoreBlocker??!1),s({type:"FORWARD"})},navigateOpts:o,type:"FORWARD"})},canGoBack:()=>e.state[na]!==0,createHref:o=>t.createHref(o),block:o=>{if(!t.setBlockers)return()=>{};const l=t.getBlockers?.()??[];return t.setBlockers([...l,o]),()=>{const d=t.getBlockers?.()??[];t.setBlockers?.(d.filter(f=>f!==o))}},flush:()=>t.flush?.(),destroy:()=>t.destroy?.(),notify:r}}function Jk(t,e){e||(e={});const n=ub();return{...e,key:n,__TSR_key:n,[na]:t}}function u4(t){const e=typeof document<"u"?window:void 0,n=e.history.pushState,r=e.history.replaceState;let s=[];const i=()=>s,o=L=>s=L,l=(L=>L),d=(()=>hh(`${e.location.pathname}${e.location.search}${e.location.hash}`,e.history.state));if(!e.history.state?.__TSR_key&&!e.history.state?.key){const L=ub();e.history.replaceState({[na]:0,key:L,__TSR_key:L},"")}let f=d(),p,g=!1,y=!1,m=!1,b=!1;const v=()=>f;let w,S;const T=()=>{w&&(O._ignoreSubscribers=!0,(w.isPush?e.history.pushState:e.history.replaceState)(w.state,"",w.href),O._ignoreSubscribers=!1,w=void 0,S=void 0,p=void 0)},j=(L,A,F)=>{const H=l(A);S||(p=f),f=hh(A,F),w={href:H,state:F,isPush:w?.isPush||L==="push"},S||(S=Promise.resolve().then(()=>T()))},M=L=>{f=d(),O.notify({type:L})},_=async()=>{if(y){y=!1;return}const L=d(),A=L.state[na]-f.state[na],F=A===1,H=A===-1,P=!F&&!H||g;g=!1;const B=P?"GO":H?"BACK":"FORWARD",E=P?{type:"GO",index:A}:{type:H?"BACK":"FORWARD"};if(m)m=!1;else{const K=i();if(typeof document<"u"&&K.length){for(const q of K)if(await q.blockerFn({currentLocation:f,nextLocation:L,action:B})){y=!0,e.history.go(1),O.notify(E);return}}}f=d(),O.notify(E)},R=L=>{if(b){b=!1;return}let A=!1;const F=i();if(typeof document<"u"&&F.length)for(const H of F){const P=H.enableBeforeUnload??!0;if(P===!0){A=!0;break}if(typeof P=="function"&&P()===!0){A=!0;break}}if(A)return L.preventDefault(),L.returnValue=""},O=c4({getLocation:v,getLength:()=>e.history.length,pushState:(L,A)=>j("push",L,A),replaceState:(L,A)=>j("replace",L,A),back:L=>(L&&(m=!0),b=!0,e.history.back()),forward:L=>{L&&(m=!0),b=!0,e.history.forward()},go:L=>{g=!0,e.history.go(L)},createHref:L=>l(L),flush:T,destroy:()=>{e.history.pushState=n,e.history.replaceState=r,e.removeEventListener(Xk,R,{capture:!0}),e.removeEventListener(Gk,_)},onBlocked:()=>{p&&f!==p&&(f=p)},getBlockers:i,setBlockers:o,notifyOnIndexChange:!1});return e.addEventListener(Xk,R,{capture:!0}),e.addEventListener(Gk,_),e.history.pushState=function(...L){const A=n.apply(e.history,L);return O._ignoreSubscribers||M("PUSH"),A},e.history.replaceState=function(...L){const A=r.apply(e.history,L);return O._ignoreSubscribers||M("REPLACE"),A},O}function hh(t,e){const n=t.indexOf("#"),r=t.indexOf("?"),s=ub();return{href:t,pathname:t.substring(0,n>0?r>0?Math.min(n,r):n:r>0?r:t.length),hash:n>-1?t.substring(n):"",search:r>-1?t.slice(r,n===-1?void 0:n):"",state:e||{[na]:0,key:s,__TSR_key:s}}}function ub(){return(Math.random()+1).toString(36).substring(7)}function ex(t){return t[t.length-1]}function d4(t){return typeof t=="function"}function $a(t,e){return d4(t)?t(e):t}const f4=Object.prototype.hasOwnProperty;function qr(t,e){if(t===e)return t;const n=e,r=t2(t)&&t2(n);if(!r&&!(ph(t)&&ph(n)))return n;const s=r?t:Zk(t);if(!s)return n;const i=r?n:Zk(n);if(!i)return n;const o=s.length,l=i.length,d=r?new Array(l):{};let f=0;for(let p=0;p<l;p++){const g=r?p:i[p],y=t[g],m=n[g];if(y===m){d[g]=y,(r?p<o:f4.call(t,g))&&f++;continue}if(y===null||m===null||typeof y!="object"||typeof m!="object"){d[g]=m;continue}const b=qr(y,m);d[g]=b,b===y&&f++}return o===l&&f===o?t:d}function Zk(t){const e=[],n=Object.getOwnPropertyNames(t);for(const s of n){if(!Object.prototype.propertyIsEnumerable.call(t,s))return!1;e.push(s)}const r=Object.getOwnPropertySymbols(t);for(const s of r){if(!Object.prototype.propertyIsEnumerable.call(t,s))return!1;e.push(s)}return e}function ph(t){if(!e2(t))return!1;const e=t.constructor;if(typeof e>"u")return!0;const n=e.prototype;return!(!e2(n)||!n.hasOwnProperty("isPrototypeOf"))}function e2(t){return Object.prototype.toString.call(t)==="[object Object]"}function t2(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function qa(t,e,n){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let r=0,s=t.length;r<s;r++)if(!qa(t[r],e[r],n))return!1;return!0}if(ph(t)&&ph(e)){const r=n?.ignoreUndefined??!0;if(n?.partial){for(const o in e)if((!r||e[o]!==void 0)&&!qa(t[o],e[o],n))return!1;return!0}let s=0;if(!r)s=Object.keys(t).length;else for(const o in t)t[o]!==void 0&&s++;let i=0;for(const o in e)if((!r||e[o]!==void 0)&&(i++,i>s||!qa(t[o],e[o],n)))return!1;return s===i}return!1}function Il(t){let e,n;const r=new Promise((s,i)=>{e=s,n=i});return r.status="pending",r.resolve=s=>{r.status="resolved",r.value=s,e(s),t?.(s)},r.reject=s=>{r.status="rejected",n(s)},r}function ra(t){return!!(t&&typeof t=="object"&&typeof t.then=="function")}const h4=Array.from(new Map([["%","%25"],["\\","%5C"]]).values());function n2(t,e=h4){function n(s,i,o=0){for(let l=o;l<i.length;l++){const d=i[l].toUpperCase();if(s.includes(d)){const f=s.split(d),p=[];for(const g of f)p.push(n(g,i,l+1));return p.join(d)}}try{return decodeURI(s)}catch{return s.replaceAll(/%[0-9A-F]{2}/g,l=>{try{return decodeURI(l)}catch{return l}})}}if(t===""||!/%[0-9A-Fa-f]{2}/g.test(t))return t;const r=t.replaceAll(/%[0-9a-f]{2}/g,s=>s.toUpperCase());return n(r,e)}var p4="Invariant failed";function ci(t,e){if(!t)throw new Error(p4)}const ks=0,Ga=1,Ll=2,zl=3;function ai(t){return db(t.filter(e=>e!==void 0).join("/"))}function db(t){return t.replace(/\/{2,}/g,"/")}function fb(t){return t==="/"?t:t.replace(/^\/{1,}/,"")}function sa(t){return t==="/"?t:t.replace(/\/{1,}$/,"")}function rh(t){return sa(fb(t))}function gh(t,e){return t?.endsWith("/")&&t!=="/"&&t!==`${e}/`?t.slice(0,-1):t}function g4(t,e,n){return gh(t,n)===gh(e,n)}function m4(t){const{type:e,value:n}=t;if(e===ks)return n;const{prefixSegment:r,suffixSegment:s}=t;if(e===Ga){const i=n.substring(1);if(r&&s)return`${r}{$${i}}${s}`;if(r)return`${r}{$${i}}`;if(s)return`{$${i}}${s}`}if(e===zl){const i=n.substring(1);return r&&s?`${r}{-$${i}}${s}`:r?`${r}{-$${i}}`:s?`{-$${i}}${s}`:`{-$${i}}`}if(e===Ll){if(r&&s)return`${r}{$}${s}`;if(r)return`${r}{$}`;if(s)return`{$}${s}`}return n}function y4({base:t,to:e,trailingSlash:n="never",parseCache:r}){let s=Pl(t,r).slice();const i=Pl(e,r);s.length>1&&ex(s)?.value==="/"&&s.pop();for(let d=0,f=i.length;d<f;d++){const p=i[d],g=p.value;g==="/"?d?d===f-1&&s.push(p):s=[p]:g===".."?s.pop():g==="."||s.push(p)}s.length>1&&(ex(s).value==="/"?n==="never"&&s.pop():n==="always"&&s.push({type:ks,value:"/"}));const o=s.map(m4);return ai(o)}const Pl=(t,e)=>{if(!t)return[];const n=e?.get(t);if(n)return n;const r=k4(t);return e?.set(t,r),r},x4=/^\$.{1,}$/,b4=/^(.*?)\{(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,v4=/^(.*?)\{-(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,w4=/^\$$/,S4=/^(.*?)\{\$\}(.*)$/;function k4(t){t=db(t);const e=[];if(t.slice(0,1)==="/"&&(t=t.substring(1),e.push({type:ks,value:"/"})),!t)return e;const n=t.split("/").filter(Boolean);return e.push(...n.map(r=>{const s=r.match(S4);if(s){const l=s[1],d=s[2];return{type:Ll,value:"$",prefixSegment:l||void 0,suffixSegment:d||void 0}}const i=r.match(v4);if(i){const l=i[1],d=i[2],f=i[3];return{type:zl,value:d,prefixSegment:l||void 0,suffixSegment:f||void 0}}const o=r.match(b4);if(o){const l=o[1],d=o[2],f=o[3];return{type:Ga,value:""+d,prefixSegment:l||void 0,suffixSegment:f||void 0}}if(x4.test(r)){const l=r.substring(1);return{type:Ga,value:"$"+l,prefixSegment:void 0,suffixSegment:void 0}}return w4.test(r)?{type:Ll,value:"$",prefixSegment:void 0,suffixSegment:void 0}:{type:ks,value:r}})),t.slice(-1)==="/"&&(t=t.substring(1),e.push({type:ks,value:"/"})),e}function Ef({path:t,params:e,leaveWildcards:n,leaveParams:r,decodeCharMap:s,parseCache:i}){const o=Pl(t,i);function l(g){const y=e[g],m=typeof y=="string";return g==="*"||g==="_splat"?m?encodeURI(y):y:m?C4(y,s):y}let d=!1;const f={},p=ai(o.map(g=>{if(g.type===ks)return g.value;if(g.type===Ll){f._splat=e._splat,f["*"]=e._splat;const y=g.prefixSegment||"",m=g.suffixSegment||"";if(!e._splat)return d=!0,n?`${y}${g.value}${m}`:y||m?`${y}${m}`:void 0;const b=l("_splat");return n?`${y}${g.value}${b??""}${m}`:`${y}${b}${m}`}if(g.type===Ga){const y=g.value.substring(1);!d&&!(y in e)&&(d=!0),f[y]=e[y];const m=g.prefixSegment||"",b=g.suffixSegment||"";if(r){const v=l(g.value);return`${m}${g.value}${v??""}${b}`}return`${m}${l(y)??"undefined"}${b}`}if(g.type===zl){const y=g.value.substring(1),m=g.prefixSegment||"",b=g.suffixSegment||"";if(!(y in e)||e[y]==null)return n?`${m}${y}${b}`:m||b?`${m}${b}`:void 0;if(f[y]=e[y],r){const v=l(g.value);return`${m}${g.value}${v??""}${b}`}return n?`${m}${y}${l(y)??""}${b}`:`${m}${l(y)??""}${b}`}return g.value}));return{usedParams:f,interpolatedPath:p,isMissingParams:d}}function C4(t,e){let n=encodeURIComponent(t);if(e)for(const[r,s]of e)n=n.replaceAll(r,s);return n}function tx(t,e,n){const r=N4(t,e,n);if(!(e.to&&!r))return r??{}}function N4(t,{to:e,fuzzy:n,caseSensitive:r},s){const i=e,o=Pl(t.startsWith("/")?t:`/${t}`,s),l=Pl(i.startsWith("/")?i:`/${i}`,s),d={};return T4(o,l,d,n,r)?d:void 0}function T4(t,e,n,r,s){let i=0,o=0;for(;i<t.length||o<e.length;){const l=t[i],d=e[o];if(d){if(d.type===Ll){const f=t.slice(i);let p;if(d.prefixSegment||d.suffixSegment){if(!l)return!1;const g=d.prefixSegment||"",y=d.suffixSegment||"",m=l.value;if("prefixSegment"in d&&!m.startsWith(g)||"suffixSegment"in d&&!t[t.length-1]?.value.endsWith(y))return!1;let b=decodeURI(ai(f.map(v=>v.value)));g&&b.startsWith(g)&&(b=b.slice(g.length)),y&&b.endsWith(y)&&(b=b.slice(0,b.length-y.length)),p=b}else p=decodeURI(ai(f.map(g=>g.value)));return n["*"]=p,n._splat=p,!0}if(d.type===ks){if(d.value==="/"&&!l?.value){o++;continue}if(l){if(s){if(d.value!==l.value)return!1}else if(d.value.toLowerCase()!==l.value.toLowerCase())return!1;i++,o++;continue}else return!1}if(d.type===Ga){if(!l||l.value==="/")return!1;let f="",p=!1;if(d.prefixSegment||d.suffixSegment){const g=d.prefixSegment||"",y=d.suffixSegment||"",m=l.value;if(g&&!m.startsWith(g)||y&&!m.endsWith(y))return!1;let b=m;g&&b.startsWith(g)&&(b=b.slice(g.length)),y&&b.endsWith(y)&&(b=b.slice(0,b.length-y.length)),f=decodeURIComponent(b),p=!0}else f=decodeURIComponent(l.value),p=!0;p&&(n[d.value.substring(1)]=f,i++),o++;continue}if(d.type===zl){if(!l){o++;continue}if(l.value==="/"){o++;continue}let f="",p=!1;if(d.prefixSegment||d.suffixSegment){const g=d.prefixSegment||"",y=d.suffixSegment||"",m=l.value;if((!g||m.startsWith(g))&&(!y||m.endsWith(y))){let b=m;g&&b.startsWith(g)&&(b=b.slice(g.length)),y&&b.endsWith(y)&&(b=b.slice(0,b.length-y.length)),f=decodeURIComponent(b),p=!0}}else{let g=!0;for(let y=o+1;y<e.length;y++){const m=e[y];if(m?.type===ks&&m.value===l.value){g=!1;break}if(m?.type===Ga||m?.type===Ll){t.length<e.length&&(g=!1);break}}g&&(f=decodeURIComponent(l.value),p=!0)}p&&(n[d.value.substring(1)]=f,i++),o++;continue}}if(i<t.length&&o>=e.length)return n["**"]=ai(t.slice(i).map(f=>f.value)),!!r&&e[e.length-1]?.value!=="/";if(o<e.length&&i>=t.length){for(let f=o;f<e.length;f++)if(e[f]?.type!==zl)return!1;break}break}return!0}const j4=.75,E4=1,M4=.5,A4=.4,R4=.25,_4=.2,O4=.05,D4=.02,I4=.01,r2=2e-4,s2=1e-4;function i2(t,e){return t.prefixSegment&&t.suffixSegment?e+O4+r2*t.prefixSegment.length+s2*t.suffixSegment.length:t.prefixSegment?e+D4+r2*t.prefixSegment.length:t.suffixSegment?e+I4+s2*t.suffixSegment.length:e}function L4(t){const e=[];return t.forEach((r,s)=>{if(r.isRoot||!r.path)return;const i=fb(r.fullPath);let o=Pl(i),l=0;for(;o.length>l+1&&o[l]?.value==="/";)l++;l>0&&(o=o.slice(l));let d=0,f=!1;const p=o.map((g,y)=>{if(g.value==="/")return j4;if(g.type===ks)return E4;let m;g.type===Ga?m=M4:g.type===zl?(m=A4,d++):m=R4;for(let b=y+1;b<o.length;b++){const v=o[b];if(v.type===ks&&v.value!=="/")return f=!0,i2(g,m+_4)}return i2(g,m)});e.push({child:r,trimmed:i,parsed:o,index:s,scores:p,optionalParamCount:d,hasStaticAfter:f})}),e.sort((r,s)=>{const i=Math.min(r.scores.length,s.scores.length);for(let o=0;o<i;o++)if(r.scores[o]!==s.scores[o])return s.scores[o]-r.scores[o];if(r.scores.length!==s.scores.length){if(r.optionalParamCount!==s.optionalParamCount){if(r.hasStaticAfter===s.hasStaticAfter)return r.optionalParamCount-s.optionalParamCount;if(r.hasStaticAfter&&!s.hasStaticAfter)return-1;if(!r.hasStaticAfter&&s.hasStaticAfter)return 1}return s.scores.length-r.scores.length}for(let o=0;o<i;o++)if(r.parsed[o].value!==s.parsed[o].value)return r.parsed[o].value>s.parsed[o].value?1:-1;return r.index-s.index}).map((r,s)=>(r.child.rank=s,r.child))}function z4({routeTree:t,initRoute:e}){const n={},r={},s=o=>{o.forEach((l,d)=>{e?.(l,d);const f=n[l.id];if(ci(!f,`Duplicate routes found with id: ${String(l.id)}`),n[l.id]=l,!l.isRoot&&l.path){const g=sa(l.fullPath);(!r[g]||l.fullPath.endsWith("/"))&&(r[g]=l)}const p=l.children;p?.length&&s(p)})};s([t]);const i=L4(Object.values(n));return{routesById:n,routesByPath:r,flatRoutes:i}}function ls(t){return!!t?.isNotFound}function P4(){try{if(typeof window<"u"&&typeof window.sessionStorage=="object")return window.sessionStorage}catch{}}const mh="tsr-scroll-restoration-v1_3",B4=(t,e)=>{let n;return(...r)=>{n||(n=setTimeout(()=>{t(...r),n=null},e))}};function F4(){const t=P4();if(!t)return null;const e=t.getItem(mh);let n=e?JSON.parse(e):{};return{state:n,set:r=>(n=$a(r,n)||n,t.setItem(mh,JSON.stringify(n)))}}const Mf=F4(),nx=t=>t.state.__TSR_key||t.href;function U4(t){const e=[];let n;for(;n=t.parentNode;)e.push(`${t.tagName}:nth-child(${Array.prototype.indexOf.call(n.children,t)+1})`),t=n;return`${e.reverse().join(" > ")}`.toLowerCase()}let yh=!1;function XT({storageKey:t,key:e,behavior:n,shouldScrollRestoration:r,scrollToTopSelectors:s,location:i}){let o;try{o=JSON.parse(sessionStorage.getItem(t)||"{}")}catch(f){console.error(f);return}const l=e||window.history.state?.__TSR_key,d=o[l];yh=!0;e:{if(r&&d&&Object.keys(d).length>0){for(const g in d){const y=d[g];if(g==="window")window.scrollTo({top:y.scrollY,left:y.scrollX,behavior:n});else if(g){const m=document.querySelector(g);m&&(m.scrollLeft=y.scrollX,m.scrollTop=y.scrollY)}}break e}const f=(i??window.location).hash.split("#",2)[1];if(f){const g=window.history.state?.__hashScrollIntoViewOptions??!0;if(g){const y=document.getElementById(f);y&&y.scrollIntoView(g)}break e}const p={top:0,left:0,behavior:n};if(window.scrollTo(p),s)for(const g of s){if(g==="window")continue;const y=typeof g=="function"?g():document.querySelector(g);y&&y.scrollTo(p)}}yh=!1}function $4(t,e){if(!Mf&&!t.isServer||((t.options.scrollRestoration??!1)&&(t.isScrollRestoring=!0),t.isServer||t.isScrollRestorationSetup||!Mf))return;t.isScrollRestorationSetup=!0,yh=!1;const r=t.options.getScrollRestorationKey||nx;window.history.scrollRestoration="manual";const s=i=>{if(yh||!t.isScrollRestoring)return;let o="";if(i.target===document||i.target===window)o="window";else{const d=i.target.getAttribute("data-scroll-restoration-id");d?o=`[data-scroll-restoration-id="${d}"]`:o=U4(i.target)}const l=r(t.state.location);Mf.set(d=>{const f=d[l]||={},p=f[o]||={};if(o==="window")p.scrollX=window.scrollX||0,p.scrollY=window.scrollY||0;else if(o){const g=document.querySelector(o);g&&(p.scrollX=g.scrollLeft||0,p.scrollY=g.scrollTop||0)}return d})};typeof document<"u"&&document.addEventListener("scroll",B4(s,100),!0),t.subscribe("onRendered",i=>{const o=r(i.toLocation);if(!t.resetNextScroll){t.resetNextScroll=!0;return}typeof t.options.scrollRestoration=="function"&&!t.options.scrollRestoration({location:t.latestLocation})||(XT({storageKey:mh,key:o,behavior:t.options.scrollRestorationBehavior,shouldScrollRestoration:t.isScrollRestoring,scrollToTopSelectors:t.options.scrollToTopSelectors,location:t.history.location}),t.isScrollRestoring&&Mf.set(l=>(l[o]||={},l)))})}function q4(t){if(typeof document<"u"&&document.querySelector){const e=t.state.location.state.__hashScrollIntoViewOptions??!0;if(e&&t.state.location.hash!==""){const n=document.getElementById(t.state.location.hash);n&&n.scrollIntoView(e)}}}function H4(t,e=String){const n=new URLSearchParams;for(const r in t){const s=t[r];s!==void 0&&n.set(r,e(s))}return n.toString()}function w0(t){return t?t==="false"?!1:t==="true"?!0:+t*0===0&&+t+""===t?+t:t:""}function V4(t){const e=new URLSearchParams(t),n={};for(const[r,s]of e.entries()){const i=n[r];i==null?n[r]=w0(s):Array.isArray(i)?i.push(w0(s)):n[r]=[i,w0(s)]}return n}const K4=W4(JSON.parse),Q4=Y4(JSON.stringify,JSON.parse);function W4(t){return e=>{e[0]==="?"&&(e=e.substring(1));const n=V4(e);for(const r in n){const s=n[r];if(typeof s=="string")try{n[r]=t(s)}catch{}}return n}}function Y4(t,e){const n=typeof e=="function";function r(s){if(typeof s=="object"&&s!==null)try{return t(s)}catch{}else if(n&&typeof s=="string")try{return e(s),t(s)}catch{}return s}return s=>{const i=H4(s,r);return i?`?${i}`:""}}const br="__root__";function hb(t){if(t.statusCode=t.statusCode||t.code||307,!t.reloadDocument&&typeof t.href=="string")try{new URL(t.href),t.reloadDocument=!0}catch{}const e=new Headers(t.headers);t.href&&e.get("Location")===null&&e.set("Location",t.href);const n=new Response(null,{status:t.statusCode,headers:e});if(n.options=t,t.throw)throw n;return n}function ws(t){return t instanceof Response&&!!t.options}function G4(t){const e=new Map;let n,r;const s=i=>{i.next&&(i.prev?(i.prev.next=i.next,i.next.prev=i.prev,i.next=void 0,r&&(r.next=i,i.prev=r)):(i.next.prev=void 0,n=i.next,i.next=void 0,r&&(i.prev=r,r.next=i)),r=i)};return{get(i){const o=e.get(i);if(o)return s(o),o.value},set(i,o){if(e.size>=t&&n){const d=n;e.delete(d.key),d.next&&(n=d.next,d.next.prev=void 0),d===r&&(r=void 0)}const l=e.get(i);if(l)l.value=o,s(l);else{const d={key:i,value:o,prev:r};r&&(r.next=d),r=d,n||(n=d),e.set(i,d)}}}}const sh=t=>{if(!t.rendered)return t.rendered=!0,t.onReady?.()},Cp=(t,e)=>!!(t.preload&&!t.router.state.matches.some(n=>n.id===e)),JT=(t,e)=>{const n=t.router.routesById[e.routeId??""]??t.router.routeTree;!n.options.notFoundComponent&&t.router.options?.defaultNotFoundComponent&&(n.options.notFoundComponent=t.router.options.defaultNotFoundComponent),ci(n.options.notFoundComponent);const r=t.matches.find(s=>s.routeId===n.id);ci(r,"Could not find match for route: "+n.id),t.updateMatch(r.id,s=>({...s,status:"notFound",error:e,isFetching:!1})),e.routerCode==="BEFORE_LOAD"&&n.parentRoute&&(e.routeId=n.parentRoute.id,JT(t,e))},Gi=(t,e,n)=>{if(!(!ws(n)&&!ls(n))){if(ws(n)&&n.redirectHandled&&!n.options.reloadDocument)throw n;if(e){e._nonReactive.beforeLoadPromise?.resolve(),e._nonReactive.loaderPromise?.resolve(),e._nonReactive.beforeLoadPromise=void 0,e._nonReactive.loaderPromise=void 0;const r=ws(n)?"redirected":"notFound";e._nonReactive.error=n,t.updateMatch(e.id,s=>({...s,status:r,isFetching:!1,error:n})),ls(n)&&!n.routeId&&(n.routeId=e.routeId),e._nonReactive.loadPromise?.resolve()}throw ws(n)?(t.rendered=!0,n.options._fromLocation=t.location,n.redirectHandled=!0,n=t.router.resolveRedirect(n),n):(JT(t,n),n)}},ZT=(t,e)=>{const n=t.router.getMatch(e);return!!(!t.router.isServer&&n._nonReactive.dehydrated||t.router.isServer&&n.ssr===!1)},Yc=(t,e,n,r)=>{const{id:s,routeId:i}=t.matches[e],o=t.router.looseRoutesById[i];if(n instanceof Promise)throw n;n.routerCode=r,t.firstBadMatchIndex??=e,Gi(t,t.router.getMatch(s),n);try{o.options.onError?.(n)}catch(l){n=l,Gi(t,t.router.getMatch(s),n)}t.updateMatch(s,l=>(l._nonReactive.beforeLoadPromise?.resolve(),l._nonReactive.beforeLoadPromise=void 0,l._nonReactive.loadPromise?.resolve(),{...l,error:n,status:"error",isFetching:!1,updatedAt:Date.now(),abortController:new AbortController}))},X4=(t,e,n,r)=>{const s=t.router.getMatch(e),i=t.matches[n-1]?.id,o=i?t.router.getMatch(i):void 0;if(t.router.isShell()){s.ssr=e===br;return}if(o?.ssr===!1){s.ssr=!1;return}const l=m=>m===!0&&o?.ssr==="data-only"?"data-only":m,d=t.router.options.defaultSsr??!0;if(r.options.ssr===void 0){s.ssr=l(d);return}if(typeof r.options.ssr!="function"){s.ssr=l(r.options.ssr);return}const{search:f,params:p}=s,g={search:Af(f,s.searchError),params:Af(p,s.paramsError),location:t.location,matches:t.matches.map(m=>({index:m.index,pathname:m.pathname,fullPath:m.fullPath,staticData:m.staticData,id:m.id,routeId:m.routeId,search:Af(m.search,m.searchError),params:Af(m.params,m.paramsError),ssr:m.ssr}))},y=r.options.ssr(g);if(ra(y))return y.then(m=>{s.ssr=l(m??d)});s.ssr=l(y??d)},ej=(t,e,n,r)=>{if(r._nonReactive.pendingTimeout!==void 0)return;const s=n.options.pendingMs??t.router.options.defaultPendingMs;if(!!(t.onReady&&!t.router.isServer&&!Cp(t,e)&&(n.options.loader||n.options.beforeLoad||rj(n))&&typeof s=="number"&&s!==1/0&&(n.options.pendingComponent??t.router.options?.defaultPendingComponent))){const o=setTimeout(()=>{sh(t)},s);r._nonReactive.pendingTimeout=o}},J4=(t,e,n)=>{const r=t.router.getMatch(e);if(!r._nonReactive.beforeLoadPromise&&!r._nonReactive.loaderPromise)return;ej(t,e,n,r);const s=()=>{const i=t.router.getMatch(e);i.preload&&(i.status==="redirected"||i.status==="notFound")&&Gi(t,i,i.error)};return r._nonReactive.beforeLoadPromise?r._nonReactive.beforeLoadPromise.then(s):s()},Z4=(t,e,n,r)=>{const s=t.router.getMatch(e),i=s._nonReactive.loadPromise;s._nonReactive.loadPromise=Il(()=>{i?.resolve()});const{paramsError:o,searchError:l}=s;o&&Yc(t,n,o,"PARSE_PARAMS"),l&&Yc(t,n,l,"VALIDATE_SEARCH"),ej(t,e,r,s);const d=new AbortController,f=t.matches[n-1]?.id,y={...(f?t.router.getMatch(f):void 0)?.context??t.router.options.context??void 0,...s.__routeContext};let m=!1;const b=()=>{m||(m=!0,t.updateMatch(e,O=>({...O,isFetching:"beforeLoad",fetchCount:O.fetchCount+1,abortController:d,context:y})))},v=()=>{s._nonReactive.beforeLoadPromise?.resolve(),s._nonReactive.beforeLoadPromise=void 0,t.updateMatch(e,O=>({...O,isFetching:!1}))};if(!r.options.beforeLoad){du(()=>{b(),v()});return}s._nonReactive.beforeLoadPromise=Il();const{search:w,params:S,cause:T}=s,j=Cp(t,e),M={search:w,abortController:d,params:S,preload:j,context:y,location:t.location,navigate:O=>t.router.navigate({...O,_fromLocation:t.location}),buildLocation:t.router.buildLocation,cause:j?"preload":T,matches:t.matches,...t.router.options.additionalContext},_=O=>{if(O===void 0){du(()=>{b(),v()});return}(ws(O)||ls(O))&&(b(),Yc(t,n,O,"BEFORE_LOAD")),du(()=>{b(),t.updateMatch(e,L=>({...L,__beforeLoadContext:O,context:{...L.context,...O}})),v()})};let R;try{if(R=r.options.beforeLoad(M),ra(R))return b(),R.catch(O=>{Yc(t,n,O,"BEFORE_LOAD")}).then(_)}catch(O){b(),Yc(t,n,O,"BEFORE_LOAD")}_(R)},eO=(t,e)=>{const{id:n,routeId:r}=t.matches[e],s=t.router.looseRoutesById[r],i=()=>{if(t.router.isServer){const d=X4(t,n,e,s);if(ra(d))return d.then(l)}return l()},o=()=>Z4(t,n,e,s),l=()=>{if(ZT(t,n))return;const d=J4(t,n,s);return ra(d)?d.then(o):o()};return i()},fu=(t,e,n)=>{const r=t.router.getMatch(e);if(!r||!n.options.head&&!n.options.scripts&&!n.options.headers)return;const s={matches:t.matches,match:r,params:r.params,loaderData:r.loaderData};return Promise.all([n.options.head?.(s),n.options.scripts?.(s),n.options.headers?.(s)]).then(([i,o,l])=>{const d=i?.meta,f=i?.links,p=i?.scripts,g=i?.styles;return{meta:d,links:f,headScripts:p,headers:l,scripts:o,styles:g}})},tj=(t,e,n,r)=>{const s=t.matchPromises[n-1],{params:i,loaderDeps:o,abortController:l,cause:d}=t.router.getMatch(e);let f=t.router.options.context??{};for(let g=0;g<=n;g++){const y=t.matches[g];if(!y)continue;const m=t.router.getMatch(y.id);m&&(f={...f,...m.__routeContext??{},...m.__beforeLoadContext??{}})}const p=Cp(t,e);return{params:i,deps:o,preload:!!p,parentMatchPromise:s,abortController:l,context:f,location:t.location,navigate:g=>t.router.navigate({...g,_fromLocation:t.location}),cause:p?"preload":d,route:r,...t.router.options.additionalContext}},a2=async(t,e,n,r)=>{try{const s=t.router.getMatch(e);try{(!t.router.isServer||s.ssr===!0)&&nj(r);const i=r.options.loader?.(tj(t,e,n,r)),o=r.options.loader&&ra(i);if(!!(o||r._lazyPromise||r._componentsPromise||r.options.head||r.options.scripts||r.options.headers||s._nonReactive.minPendingPromise)&&t.updateMatch(e,g=>({...g,isFetching:"loader"})),r.options.loader){const g=o?await i:i;Gi(t,t.router.getMatch(e),g),g!==void 0&&t.updateMatch(e,y=>({...y,loaderData:g}))}r._lazyPromise&&await r._lazyPromise;const d=fu(t,e,r),f=d?await d:void 0,p=s._nonReactive.minPendingPromise;p&&await p,r._componentsPromise&&await r._componentsPromise,t.updateMatch(e,g=>({...g,error:void 0,status:"success",isFetching:!1,updatedAt:Date.now(),...f}))}catch(i){let o=i;const l=s._nonReactive.minPendingPromise;l&&await l,ls(i)&&await r.options.notFoundComponent?.preload?.(),Gi(t,t.router.getMatch(e),i);try{r.options.onError?.(i)}catch(p){o=p,Gi(t,t.router.getMatch(e),p)}const d=fu(t,e,r),f=d?await d:void 0;t.updateMatch(e,p=>({...p,error:o,status:"error",isFetching:!1,...f}))}}catch(s){const i=t.router.getMatch(e);if(i){const o=fu(t,e,r);if(o){const l=await o;t.updateMatch(e,d=>({...d,...l}))}i._nonReactive.loaderPromise=void 0}Gi(t,i,s)}},tO=async(t,e)=>{const{id:n,routeId:r}=t.matches[e];let s=!1,i=!1;const o=t.router.looseRoutesById[r];if(ZT(t,n)){if(t.router.isServer){const f=fu(t,n,o);if(f){const p=await f;t.updateMatch(n,g=>({...g,...p}))}return t.router.getMatch(n)}}else{const f=t.router.getMatch(n);if(f._nonReactive.loaderPromise){if(f.status==="success"&&!t.sync&&!f.preload)return f;await f._nonReactive.loaderPromise;const p=t.router.getMatch(n),g=p._nonReactive.error||p.error;g&&Gi(t,p,g)}else{const p=Date.now()-f.updatedAt,g=Cp(t,n),y=g?o.options.preloadStaleTime??t.router.options.defaultPreloadStaleTime??3e4:o.options.staleTime??t.router.options.defaultStaleTime??0,m=o.options.shouldReload,b=typeof m=="function"?m(tj(t,n,e,o)):m,v=!!g&&!t.router.state.matches.some(j=>j.id===n),w=t.router.getMatch(n);w._nonReactive.loaderPromise=Il(),v!==w.preload&&t.updateMatch(n,j=>({...j,preload:v}));const{status:S,invalid:T}=w;if(s=S==="success"&&(T||(b??p>y)),!(g&&o.options.preload===!1))if(s&&!t.sync)i=!0,(async()=>{try{await a2(t,n,e,o);const j=t.router.getMatch(n);j._nonReactive.loaderPromise?.resolve(),j._nonReactive.loadPromise?.resolve(),j._nonReactive.loaderPromise=void 0}catch(j){ws(j)&&await t.router.navigate(j.options)}})();else if(S!=="success"||s&&t.sync)await a2(t,n,e,o);else{const j=fu(t,n,o);if(j){const M=await j;t.updateMatch(n,_=>({..._,...M}))}}}}const l=t.router.getMatch(n);i||(l._nonReactive.loaderPromise?.resolve(),l._nonReactive.loadPromise?.resolve()),clearTimeout(l._nonReactive.pendingTimeout),l._nonReactive.pendingTimeout=void 0,i||(l._nonReactive.loaderPromise=void 0),l._nonReactive.dehydrated=void 0;const d=i?l.isFetching:!1;return d!==l.isFetching||l.invalid!==!1?(t.updateMatch(n,f=>({...f,isFetching:d,invalid:!1})),t.router.getMatch(n)):l};async function o2(t){const e=Object.assign(t,{matchPromises:[]});!e.router.isServer&&e.router.state.matches.some(n=>n._forcePending)&&sh(e);try{for(let s=0;s<e.matches.length;s++){const i=eO(e,s);ra(i)&&await i}const n=e.firstBadMatchIndex??e.matches.length;for(let s=0;s<n;s++)e.matchPromises.push(tO(e,s));await Promise.all(e.matchPromises);const r=sh(e);ra(r)&&await r}catch(n){if(ls(n)&&!e.preload){const r=sh(e);throw ra(r)&&await r,n}if(ws(n))throw n}return e.matches}async function nj(t){if(!t._lazyLoaded&&t._lazyPromise===void 0&&(t.lazyFn?t._lazyPromise=t.lazyFn().then(e=>{const{id:n,...r}=e.options;Object.assign(t.options,r),t._lazyLoaded=!0,t._lazyPromise=void 0}):t._lazyLoaded=!0),!t._componentsLoaded&&t._componentsPromise===void 0){const e=()=>{const n=[];for(const r of sj){const s=t.options[r]?.preload;s&&n.push(s())}if(n.length)return Promise.all(n).then(()=>{t._componentsLoaded=!0,t._componentsPromise=void 0});t._componentsLoaded=!0,t._componentsPromise=void 0};t._componentsPromise=t._lazyPromise?t._lazyPromise.then(e):e()}return t._componentsPromise}function Af(t,e){return e?{status:"error",error:e}:{status:"success",value:t}}function rj(t){for(const e of sj)if(t.options[e]?.preload)return!0;return!1}const sj=["component","errorComponent","pendingComponent","notFoundComponent"];function nO(t){return{input:({url:e})=>{for(const n of t)e=ij(n,e);return e},output:({url:e})=>{for(let n=t.length-1;n>=0;n--)e=aj(t[n],e);return e}}}function rO(t){const e=rh(t.basepath),n=`/${e}`,r=`${n}/`,s=t.caseSensitive?n:n.toLowerCase(),i=t.caseSensitive?r:r.toLowerCase();return{input:({url:o})=>{const l=t.caseSensitive?o.pathname:o.pathname.toLowerCase();return l===s?o.pathname="/":l.startsWith(i)&&(o.pathname=o.pathname.slice(n.length)),o},output:({url:o})=>(o.pathname=ai(["/",e,o.pathname]),o)}}function ij(t,e){const n=t?.input?.({url:e});if(n){if(typeof n=="string")return new URL(n);if(n instanceof URL)return n}return e}function aj(t,e){const n=t?.output?.({url:e});if(n){if(typeof n=="string")return new URL(n);if(n instanceof URL)return n}return e}function Ha(t){const e=t.resolvedLocation,n=t.location,r=e?.pathname!==n.pathname,s=e?.href!==n.href,i=e?.hash!==n.hash;return{fromLocation:e,toLocation:n,pathChanged:r,hrefChanged:s,hashChanged:i}}class sO{constructor(e){this.tempLocationKey=`${Math.round(Math.random()*1e7)}`,this.resetNextScroll=!0,this.shouldViewTransition=void 0,this.isViewTransitionTypesSupported=void 0,this.subscribers=new Set,this.isScrollRestoring=!1,this.isScrollRestorationSetup=!1,this.startTransition=n=>n(),this.update=n=>{n.notFoundRoute&&console.warn("The notFoundRoute API is deprecated and will be removed in the next major version. See https://tanstack.com/router/v1/docs/framework/react/guide/not-found-errors#migrating-from-notfoundroute for more info.");const r=this.options,s=this.basepath??r?.basepath??"/",i=this.basepath===void 0,o=r?.rewrite;this.options={...r,...n},this.isServer=this.options.isServer??typeof document>"u",this.pathParamsDecodeCharMap=this.options.pathParamsAllowedCharacters?new Map(this.options.pathParamsAllowedCharacters.map(y=>[encodeURIComponent(y),y])):void 0,(!this.history||this.options.history&&this.options.history!==this.history)&&(this.options.history?this.history=this.options.history:this.isServer||(this.history=u4())),this.origin=this.options.origin,this.origin||(!this.isServer&&window?.origin&&window.origin!=="null"?this.origin=window.origin:this.origin="http://localhost"),this.history&&this.updateLatestLocation(),this.options.routeTree!==this.routeTree&&(this.routeTree=this.options.routeTree,this.buildRouteTree()),!this.__store&&this.latestLocation&&(this.__store=new l4(aO(this.latestLocation),{onUpdate:()=>{this.__store.state={...this.state,cachedMatches:this.state.cachedMatches.filter(y=>!["redirected"].includes(y.status))}}}),$4(this));let l=!1;const d=this.options.basepath??"/",f=this.options.rewrite;if(i||s!==d||o!==f){this.basepath=d;const y=[];rh(d)!==""&&y.push(rO({basepath:d})),f&&y.push(f),this.rewrite=y.length===0?void 0:y.length===1?y[0]:nO(y),this.history&&this.updateLatestLocation(),l=!0}l&&this.__store&&(this.__store.state={...this.state,location:this.latestLocation}),typeof window<"u"&&"CSS"in window&&typeof window.CSS?.supports=="function"&&(this.isViewTransitionTypesSupported=window.CSS.supports("selector(:active-view-transition-type(a)"))},this.updateLatestLocation=()=>{this.latestLocation=this.parseLocation(this.history.location,this.latestLocation)},this.buildRouteTree=()=>{const{routesById:n,routesByPath:r,flatRoutes:s}=z4({routeTree:this.routeTree,initRoute:(o,l)=>{o.init({originalIndex:l})}});this.routesById=n,this.routesByPath=r,this.flatRoutes=s;const i=this.options.notFoundRoute;i&&(i.init({originalIndex:99999999999}),this.routesById[i.id]=i)},this.subscribe=(n,r)=>{const s={eventType:n,fn:r};return this.subscribers.add(s),()=>{this.subscribers.delete(s)}},this.emit=n=>{this.subscribers.forEach(r=>{r.eventType===n.type&&r.fn(n)})},this.parseLocation=(n,r)=>{const s=({href:d,state:f})=>{const p=new URL(d,this.origin),g=ij(this.rewrite,p),y=this.options.parseSearch(g.search),m=this.options.stringifySearch(y);g.search=m;const b=g.href.replace(g.origin,""),{pathname:v,hash:w}=g;return{href:b,publicHref:d,url:g.href,pathname:n2(v),searchStr:m,search:qr(r?.search,y),hash:w.split("#").reverse()[0]??"",state:qr(r?.state,f)}},i=s(n),{__tempLocation:o,__tempKey:l}=i.state;if(o&&(!l||l===this.tempLocationKey)){const d=s(o);return d.state.key=i.state.key,d.state.__TSR_key=i.state.__TSR_key,delete d.state.__tempLocation,{...d,maskedLocation:i}}return i},this.resolvePathWithBase=(n,r)=>y4({base:n,to:db(r),trailingSlash:this.options.trailingSlash,parseCache:this.parsePathnameCache}),this.matchRoutes=(n,r,s)=>typeof n=="string"?this.matchRoutesInternal({pathname:n,search:r},s):this.matchRoutesInternal(n,r),this.parsePathnameCache=G4(1e3),this.getMatchedRoutes=(n,r)=>oO({pathname:n,routePathname:r,caseSensitive:this.options.caseSensitive,routesByPath:this.routesByPath,routesById:this.routesById,flatRoutes:this.flatRoutes,parseCache:this.parsePathnameCache}),this.cancelMatch=n=>{const r=this.getMatch(n);r&&(r.abortController.abort(),clearTimeout(r._nonReactive.pendingTimeout),r._nonReactive.pendingTimeout=void 0)},this.cancelMatches=()=>{const n=this.state.matches.filter(i=>i.status==="pending"),r=this.state.matches.filter(i=>i.isFetching==="loader");new Set([...this.state.pendingMatches??[],...n,...r]).forEach(i=>{this.cancelMatch(i.id)})},this.buildLocation=n=>{const r=(i={})=>{const o=i._fromLocation||this.pendingBuiltLocation||this.latestLocation,l=this.matchRoutes(o,{_buildLocation:!0}),d=ex(l);i.from;const f=i.unsafeRelative==="path"?o.pathname:i.from??d.fullPath,p=this.resolvePathWithBase(f,"."),g=d.search,y={...d.params},m=i.to?this.resolvePathWithBase(p,`${i.to}`):this.resolvePathWithBase(p,"."),b=i.params===!1||i.params===null?{}:(i.params??!0)===!0?y:Object.assign(y,$a(i.params,y)),v=Ef({path:m,params:b,parseCache:this.parsePathnameCache}).interpolatedPath,w=this.matchRoutes(v,void 0,{_buildLocation:!0}).map(F=>this.looseRoutesById[F.routeId]);if(Object.keys(b).length>0)for(const F of w){const H=F.options.params?.stringify??F.options.stringifyParams;H&&Object.assign(b,H(b))}const S=n2(Ef({path:m,params:b,leaveWildcards:!1,leaveParams:n.leaveParams,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath);let T=g;if(n._includeValidateSearch&&this.options.search?.strict){const F={};w.forEach(H=>{if(H.options.validateSearch)try{Object.assign(F,rx(H.options.validateSearch,{...F,...T}))}catch{}}),T=F}T=lO({search:T,dest:i,destRoutes:w,_includeValidateSearch:n._includeValidateSearch}),T=qr(g,T);const j=this.options.stringifySearch(T),M=i.hash===!0?o.hash:i.hash?$a(i.hash,o.hash):void 0,_=M?`#${M}`:"";let R=i.state===!0?o.state:i.state?$a(i.state,o.state):{};R=qr(o.state,R);const O=`${S}${j}${_}`,L=new URL(O,this.origin),A=aj(this.rewrite,L);return{publicHref:A.pathname+A.search+A.hash,href:O,url:A.href,pathname:S,search:T,searchStr:j,state:R,hash:M??"",unmaskOnReload:i.unmaskOnReload}},s=(i={},o)=>{const l=r(i);let d=o?r(o):void 0;if(!d){let f={};const p=this.options.routeMasks?.find(g=>{const y=tx(l.pathname,{to:g.from,caseSensitive:!1,fuzzy:!1},this.parsePathnameCache);return y?(f=y,!0):!1});if(p){const{from:g,...y}=p;o={from:n.from,...y,params:f},d=r(o)}}return d&&(l.maskedLocation=d),l};return n.mask?s(n,{from:n.from,...n.mask}):s(n)},this.commitLocation=({viewTransition:n,ignoreBlocker:r,...s})=>{const i=()=>{const d=["key","__TSR_key","__TSR_index","__hashScrollIntoViewOptions"];d.forEach(p=>{s.state[p]=this.latestLocation.state[p]});const f=qa(s.state,this.latestLocation.state);return d.forEach(p=>{delete s.state[p]}),f},o=sa(this.latestLocation.href)===sa(s.href),l=this.commitLocationPromise;if(this.commitLocationPromise=Il(()=>{l?.resolve()}),o&&i())this.load();else{let{maskedLocation:d,hashScrollIntoView:f,...p}=s;d&&(p={...d,state:{...d.state,__tempKey:void 0,__tempLocation:{...p,search:p.searchStr,state:{...p.state,__tempKey:void 0,__tempLocation:void 0,__TSR_key:void 0,key:void 0}}}},(p.unmaskOnReload??this.options.unmaskOnReload??!1)&&(p.state.__tempKey=this.tempLocationKey)),p.state.__hashScrollIntoViewOptions=f??this.options.defaultHashScrollIntoView??!0,this.shouldViewTransition=n,this.history[s.replace?"replace":"push"](p.publicHref,p.state,{ignoreBlocker:r})}return this.resetNextScroll=s.resetScroll??!0,this.history.subscribers.size||this.load(),this.commitLocationPromise},this.buildAndCommitLocation=({replace:n,resetScroll:r,hashScrollIntoView:s,viewTransition:i,ignoreBlocker:o,href:l,...d}={})=>{if(l){const g=this.history.location.state.__TSR_index,y=hh(l,{__TSR_index:n?g:g+1});d.to=y.pathname,d.search=this.options.parseSearch(y.search),d.hash=y.hash.slice(1)}const f=this.buildLocation({...d,_includeValidateSearch:!0});this.pendingBuiltLocation=f;const p=this.commitLocation({...f,viewTransition:i,replace:n,resetScroll:r,hashScrollIntoView:s,ignoreBlocker:o});return Promise.resolve().then(()=>{this.pendingBuiltLocation===f&&(this.pendingBuiltLocation=void 0)}),p},this.navigate=({to:n,reloadDocument:r,href:s,...i})=>{if(!r&&s)try{new URL(`${s}`),r=!0}catch{}return r?(s||(s=this.buildLocation({to:n,...i}).url),i.replace?window.location.replace(s):window.location.href=s,Promise.resolve()):this.buildAndCommitLocation({...i,href:s,to:n,_isNavigate:!0})},this.beforeLoad=()=>{if(this.cancelMatches(),this.updateLatestLocation(),this.isServer){const r=this.buildLocation({to:this.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0}),s=i=>{try{return encodeURI(decodeURI(i))}catch{return i}};if(rh(s(this.latestLocation.href))!==rh(s(r.href))){let i=r.url;throw this.origin&&i.startsWith(this.origin)&&(i=i.replace(this.origin,"")||"/"),hb({href:i})}}const n=this.matchRoutes(this.latestLocation);this.__store.setState(r=>({...r,status:"pending",statusCode:200,isLoading:!0,location:this.latestLocation,pendingMatches:n,cachedMatches:r.cachedMatches.filter(s=>!n.some(i=>i.id===s.id))}))},this.load=async n=>{let r,s,i;for(i=new Promise(l=>{this.startTransition(async()=>{try{this.beforeLoad();const d=this.latestLocation,f=this.state.resolvedLocation;this.state.redirect||this.emit({type:"onBeforeNavigate",...Ha({resolvedLocation:f,location:d})}),this.emit({type:"onBeforeLoad",...Ha({resolvedLocation:f,location:d})}),await o2({router:this,sync:n?.sync,matches:this.state.pendingMatches,location:d,updateMatch:this.updateMatch,onReady:async()=>{this.startTransition(()=>{this.startViewTransition(async()=>{let p=[],g=[],y=[];du(()=>{this.__store.setState(m=>{const b=m.matches,v=m.pendingMatches||m.matches;return p=b.filter(w=>!v.some(S=>S.id===w.id)),g=v.filter(w=>!b.some(S=>S.id===w.id)),y=v.filter(w=>b.some(S=>S.id===w.id)),{...m,isLoading:!1,loadedAt:Date.now(),matches:v,pendingMatches:void 0,cachedMatches:[...m.cachedMatches,...p.filter(w=>w.status!=="error")]}}),this.clearExpiredCache()}),[[p,"onLeave"],[g,"onEnter"],[y,"onStay"]].forEach(([m,b])=>{m.forEach(v=>{this.looseRoutesById[v.routeId].options[b]?.(v)})})})})}})}catch(d){ws(d)?(r=d,this.isServer||this.navigate({...r.options,replace:!0,ignoreBlocker:!0})):ls(d)&&(s=d),this.__store.setState(f=>({...f,statusCode:r?r.status:s?404:f.matches.some(p=>p.status==="error")?500:200,redirect:r}))}this.latestLoadPromise===i&&(this.commitLocationPromise?.resolve(),this.latestLoadPromise=void 0,this.commitLocationPromise=void 0),l()})}),this.latestLoadPromise=i,await i;this.latestLoadPromise&&i!==this.latestLoadPromise;)await this.latestLoadPromise;let o;this.hasNotFoundMatch()?o=404:this.__store.state.matches.some(l=>l.status==="error")&&(o=500),o!==void 0&&this.__store.setState(l=>({...l,statusCode:o}))},this.startViewTransition=n=>{const r=this.shouldViewTransition??this.options.defaultViewTransition;if(delete this.shouldViewTransition,r&&typeof document<"u"&&"startViewTransition"in document&&typeof document.startViewTransition=="function"){let s;if(typeof r=="object"&&this.isViewTransitionTypesSupported){const i=this.latestLocation,o=this.state.resolvedLocation,l=typeof r.types=="function"?r.types(Ha({resolvedLocation:o,location:i})):r.types;if(l===!1){n();return}s={update:n,types:l}}else s=n;document.startViewTransition(s)}else n()},this.updateMatch=(n,r)=>{this.startTransition(()=>{const s=this.state.pendingMatches?.some(i=>i.id===n)?"pendingMatches":this.state.matches.some(i=>i.id===n)?"matches":this.state.cachedMatches.some(i=>i.id===n)?"cachedMatches":"";s&&this.__store.setState(i=>({...i,[s]:i[s]?.map(o=>o.id===n?r(o):o)}))})},this.getMatch=n=>{const r=s=>s.id===n;return this.state.cachedMatches.find(r)??this.state.pendingMatches?.find(r)??this.state.matches.find(r)},this.invalidate=n=>{const r=s=>n?.filter?.(s)??!0?{...s,invalid:!0,...n?.forcePending||s.status==="error"?{status:"pending",error:void 0}:void 0}:s;return this.__store.setState(s=>({...s,matches:s.matches.map(r),cachedMatches:s.cachedMatches.map(r),pendingMatches:s.pendingMatches?.map(r)})),this.shouldViewTransition=!1,this.load({sync:n?.sync})},this.resolveRedirect=n=>{if(!n.options.href){const r=this.buildLocation(n.options);let s=r.url;this.origin&&s.startsWith(this.origin)&&(s=s.replace(this.origin,"")||"/"),n.options.href=r.href,n.headers.set("Location",s)}return n.headers.get("Location")||n.headers.set("Location",n.options.href),n},this.clearCache=n=>{const r=n?.filter;r!==void 0?this.__store.setState(s=>({...s,cachedMatches:s.cachedMatches.filter(i=>!r(i))})):this.__store.setState(s=>({...s,cachedMatches:[]}))},this.clearExpiredCache=()=>{const n=r=>{const s=this.looseRoutesById[r.routeId];if(!s.options.loader)return!0;const i=(r.preload?s.options.preloadGcTime??this.options.defaultPreloadGcTime:s.options.gcTime??this.options.defaultGcTime)??300*1e3;return r.status==="error"?!0:Date.now()-r.updatedAt>=i};this.clearCache({filter:n})},this.loadRouteChunk=nj,this.preloadRoute=async n=>{const r=this.buildLocation(n);let s=this.matchRoutes(r,{throwOnError:!0,preload:!0,dest:n});const i=new Set([...this.state.matches,...this.state.pendingMatches??[]].map(l=>l.id)),o=new Set([...i,...this.state.cachedMatches.map(l=>l.id)]);du(()=>{s.forEach(l=>{o.has(l.id)||this.__store.setState(d=>({...d,cachedMatches:[...d.cachedMatches,l]}))})});try{return s=await o2({router:this,matches:s,location:r,preload:!0,updateMatch:(l,d)=>{i.has(l)?s=s.map(f=>f.id===l?d(f):f):this.updateMatch(l,d)}}),s}catch(l){if(ws(l))return l.options.reloadDocument?void 0:await this.preloadRoute({...l.options,_fromLocation:r});ls(l)||console.error(l);return}},this.matchRoute=(n,r)=>{const s={...n,to:n.to?this.resolvePathWithBase(n.from||"",n.to):void 0,params:n.params||{},leaveParams:!0},i=this.buildLocation(s);if(r?.pending&&this.state.status!=="pending")return!1;const l=(r?.pending===void 0?!this.state.isLoading:r.pending)?this.latestLocation:this.state.resolvedLocation||this.state.location,d=tx(l.pathname,{...r,to:i.pathname},this.parsePathnameCache);return!d||n.params&&!qa(d,n.params,{partial:!0})?!1:d&&(r?.includeSearch??!0)?qa(l.search,i.search,{partial:!0})?d:!1:d},this.hasNotFoundMatch=()=>this.__store.state.matches.some(n=>n.status==="notFound"||n.globalNotFound),this.update({defaultPreloadDelay:50,defaultPendingMs:1e3,defaultPendingMinMs:500,context:void 0,...e,caseSensitive:e.caseSensitive??!1,notFoundMode:e.notFoundMode??"fuzzy",stringifySearch:e.stringifySearch??Q4,parseSearch:e.parseSearch??K4}),typeof document<"u"&&(self.__TSR_ROUTER__=this)}isShell(){return!!this.options.isShell}isPrerendering(){return!!this.options.isPrerendering}get state(){return this.__store.state}get looseRoutesById(){return this.routesById}matchRoutesInternal(e,n){const{foundRoute:r,matchedRoutes:s,routeParams:i}=this.getMatchedRoutes(e.pathname,n?.dest?.to);let o=!1;(r?r.path!=="/"&&i["**"]:sa(e.pathname))&&(this.options.notFoundRoute?s.push(this.options.notFoundRoute):o=!0);const l=(()=>{if(o){if(this.options.notFoundMode!=="root")for(let p=s.length-1;p>=0;p--){const g=s[p];if(g.children)return g.id}return br}})(),d=[],f=p=>p?.id?p.context??this.options.context??void 0:this.options.context??void 0;return s.forEach((p,g)=>{const y=d[g-1],[m,b,v]=(()=>{const P=y?.search??e.search,B=y?._strictSearch??void 0;try{const E=rx(p.options.validateSearch,{...P})??void 0;return[{...P,...E},{...B,...E},void 0]}catch(E){let K=E;if(E instanceof xh||(K=new xh(E.message,{cause:E})),n?.throwOnError)throw K;return[P,{},K]}})(),w=p.options.loaderDeps?.({search:m})??"",S=w?JSON.stringify(w):"",{interpolatedPath:T,usedParams:j}=Ef({path:p.fullPath,params:i,decodeCharMap:this.pathParamsDecodeCharMap}),M=Ef({path:p.id,params:i,leaveWildcards:!0,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath+S,_=this.getMatch(M),R=this.state.matches.find(P=>P.routeId===p.id),O=_?._strictParams??j;let L;if(!_){const P=p.options.params?.parse??p.options.parseParams;if(P)try{Object.assign(O,P(O))}catch(B){if(L=new iO(B.message,{cause:B}),n?.throwOnError)throw L}}Object.assign(i,O);const A=R?"stay":"enter";let F;if(_)F={..._,cause:A,params:R?qr(R.params,i):i,_strictParams:O,search:qr(R?R.search:_.search,m),_strictSearch:b};else{const P=p.options.loader||p.options.beforeLoad||p.lazyFn||rj(p)?"pending":"success";F={id:M,index:g,routeId:p.id,params:R?qr(R.params,i):i,_strictParams:O,pathname:T,updatedAt:Date.now(),search:R?qr(R.search,m):m,_strictSearch:b,searchError:void 0,status:P,isFetching:!1,error:void 0,paramsError:L,__routeContext:void 0,_nonReactive:{loadPromise:Il()},__beforeLoadContext:void 0,context:{},abortController:new AbortController,fetchCount:0,cause:A,loaderDeps:R?qr(R.loaderDeps,w):w,invalid:!1,preload:!1,links:void 0,scripts:void 0,headScripts:void 0,meta:void 0,staticData:p.options.staticData||{},fullPath:p.fullPath}}n?.preload||(F.globalNotFound=l===p.id),F.searchError=v;const H=f(y);F.context={...H,...F.__routeContext,...F.__beforeLoadContext},d.push(F)}),d.forEach((p,g)=>{const y=this.looseRoutesById[p.routeId];if(!this.getMatch(p.id)&&n?._buildLocation!==!0){const b=d[g-1],v=f(b);if(y.options.context){const w={deps:p.loaderDeps,params:p.params,context:v??{},location:e,navigate:S=>this.navigate({...S,_fromLocation:e}),buildLocation:this.buildLocation,cause:p.cause,abortController:p.abortController,preload:!!p.preload,matches:d};p.__routeContext=y.options.context(w)??void 0}p.context={...v,...p.__routeContext,...p.__beforeLoadContext}}}),d}}class xh extends Error{}class iO extends Error{}function aO(t){return{loadedAt:0,isLoading:!1,isTransitioning:!1,status:"idle",resolvedLocation:void 0,location:t,matches:[],pendingMatches:[],cachedMatches:[],statusCode:200}}function rx(t,e){if(t==null)return{};if("~standard"in t){const n=t["~standard"].validate(e);if(n instanceof Promise)throw new xh("Async validation not supported");if(n.issues)throw new xh(JSON.stringify(n.issues,void 0,2),{cause:n});return n.value}return"parse"in t?t.parse(e):typeof t=="function"?t(e):{}}function oO({pathname:t,routePathname:e,caseSensitive:n,routesByPath:r,routesById:s,flatRoutes:i,parseCache:o}){let l={};const d=sa(t),f=m=>tx(d,{to:m.fullPath,caseSensitive:m.options?.caseSensitive??n,fuzzy:!0},o);let p=e!==void 0?r[e]:void 0;if(p)l=f(p);else{let m;for(const b of i){const v=f(b);if(v)if(b.path!=="/"&&v["**"])m||(m={foundRoute:b,routeParams:v});else{p=b,l=v;break}}!p&&m&&(p=m.foundRoute,l=m.routeParams)}let g=p||s[br];const y=[g];for(;g.parentRoute;)g=g.parentRoute,y.push(g);return y.reverse(),{matchedRoutes:y,routeParams:l,foundRoute:p}}function lO({search:t,dest:e,destRoutes:n,_includeValidateSearch:r}){const s=n.reduce((l,d)=>{const f=[];if("search"in d.options)d.options.search?.middlewares&&f.push(...d.options.search.middlewares);else if(d.options.preSearchFilters||d.options.postSearchFilters){const p=({search:g,next:y})=>{let m=g;"preSearchFilters"in d.options&&d.options.preSearchFilters&&(m=d.options.preSearchFilters.reduce((v,w)=>w(v),g));const b=y(m);return"postSearchFilters"in d.options&&d.options.postSearchFilters?d.options.postSearchFilters.reduce((v,w)=>w(v),b):b};f.push(p)}if(r&&d.options.validateSearch){const p=({search:g,next:y})=>{const m=y(g);try{return{...m,...rx(d.options.validateSearch,m)??void 0}}catch{return m}};f.push(p)}return l.concat(f)},[])??[],i=({search:l})=>e.search?e.search===!0?l:$a(e.search,l):{};s.push(i);const o=(l,d)=>{if(l>=s.length)return d;const f=s[l];return f({search:d,next:g=>o(l+1,g)})};return o(0,t)}const cO="Error preloading route! ";class oj{constructor(e){if(this.init=n=>{this.originalIndex=n.originalIndex;const r=this.options,s=!r?.path&&!r?.id;this.parentRoute=this.options.getParentRoute?.(),s?this._path=br:this.parentRoute||ci(!1);let i=s?br:r?.path;i&&i!=="/"&&(i=fb(i));const o=r?.id||i;let l=s?br:ai([this.parentRoute.id===br?"":this.parentRoute.id,o]);i===br&&(i="/"),l!==br&&(l=ai(["/",l]));const d=l===br?"/":ai([this.parentRoute.fullPath,i]);this._path=i,this._id=l,this._fullPath=d,this._to=d},this.addChildren=n=>this._addFileChildren(n),this._addFileChildren=n=>(Array.isArray(n)&&(this.children=n),typeof n=="object"&&n!==null&&(this.children=Object.values(n)),this),this._addFileTypes=()=>this,this.updateLoader=n=>(Object.assign(this.options,n),this),this.update=n=>(Object.assign(this.options,n),this),this.lazy=n=>(this.lazyFn=n,this),this.options=e||{},this.isRoot=!e?.getParentRoute,e?.id&&e?.path)throw new Error("Route cannot have both an 'id' and a 'path' option.")}get to(){return this._to}get id(){return this._id}get path(){return this._path}get fullPath(){return this._fullPath}}class uO extends oj{constructor(e){super(e)}}var S0={exports:{}},Ve={};var l2;function dO(){if(l2)return Ve;l2=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),y=Symbol.iterator;function m(I){return I===null||typeof I!="object"?null:(I=y&&I[y]||I["@@iterator"],typeof I=="function"?I:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,w={};function S(I,U,te){this.props=I,this.context=U,this.refs=w,this.updater=te||b}S.prototype.isReactComponent={},S.prototype.setState=function(I,U){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,U,"setState")},S.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function T(){}T.prototype=S.prototype;function j(I,U,te){this.props=I,this.context=U,this.refs=w,this.updater=te||b}var M=j.prototype=new T;M.constructor=j,v(M,S.prototype),M.isPureReactComponent=!0;var _=Array.isArray;function R(){}var O={H:null,A:null,T:null,S:null},L=Object.prototype.hasOwnProperty;function A(I,U,te){var Z=te.ref;return{$$typeof:t,type:I,key:U,ref:Z!==void 0?Z:null,props:te}}function F(I,U){return A(I.type,U,I.props)}function H(I){return typeof I=="object"&&I!==null&&I.$$typeof===t}function P(I){var U={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(te){return U[te]})}var B=/\/+/g;function E(I,U){return typeof I=="object"&&I!==null&&I.key!=null?P(""+I.key):U.toString(36)}function K(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(R,R):(I.status="pending",I.then(function(U){I.status==="pending"&&(I.status="fulfilled",I.value=U)},function(U){I.status==="pending"&&(I.status="rejected",I.reason=U)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function q(I,U,te,Z,re){var se=typeof I;(se==="undefined"||se==="boolean")&&(I=null);var ge=!1;if(I===null)ge=!0;else switch(se){case"bigint":case"string":case"number":ge=!0;break;case"object":switch(I.$$typeof){case t:case e:ge=!0;break;case p:return ge=I._init,q(ge(I._payload),U,te,Z,re)}}if(ge)return re=re(I),ge=Z===""?"."+E(I,0):Z,_(re)?(te="",ge!=null&&(te=ge.replace(B,"$&/")+"/"),q(re,U,te,"",function(Se){return Se})):re!=null&&(H(re)&&(re=F(re,te+(re.key==null||I&&I.key===re.key?"":(""+re.key).replace(B,"$&/")+"/")+ge)),U.push(re)),1;ge=0;var be=Z===""?".":Z+":";if(_(I))for(var me=0;me<I.length;me++)Z=I[me],se=be+E(Z,me),ge+=q(Z,U,te,se,re);else if(me=m(I),typeof me=="function")for(I=me.call(I),me=0;!(Z=I.next()).done;)Z=Z.value,se=be+E(Z,me++),ge+=q(Z,U,te,se,re);else if(se==="object"){if(typeof I.then=="function")return q(K(I),U,te,Z,re);throw U=String(I),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return ge}function V(I,U,te){if(I==null)return I;var Z=[],re=0;return q(I,Z,"","",function(se){return U.call(te,se,re++)}),Z}function ie(I){if(I._status===-1){var U=I._result;U=U(),U.then(function(te){(I._status===0||I._status===-1)&&(I._status=1,I._result=te)},function(te){(I._status===0||I._status===-1)&&(I._status=2,I._result=te)}),I._status===-1&&(I._status=0,I._result=U)}if(I._status===1)return I._result.default;throw I._result}var Y=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)},X={map:V,forEach:function(I,U,te){V(I,function(){U.apply(this,arguments)},te)},count:function(I){var U=0;return V(I,function(){U++}),U},toArray:function(I){return V(I,function(U){return U})||[]},only:function(I){if(!H(I))throw Error("React.Children.only expected to receive a single React element child.");return I}};return Ve.Activity=g,Ve.Children=X,Ve.Component=S,Ve.Fragment=n,Ve.Profiler=s,Ve.PureComponent=j,Ve.StrictMode=r,Ve.Suspense=d,Ve.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Ve.__COMPILER_RUNTIME={__proto__:null,c:function(I){return O.H.useMemoCache(I)}},Ve.cache=function(I){return function(){return I.apply(null,arguments)}},Ve.cacheSignal=function(){return null},Ve.cloneElement=function(I,U,te){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var Z=v({},I.props),re=I.key;if(U!=null)for(se in U.key!==void 0&&(re=""+U.key),U)!L.call(U,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&U.ref===void 0||(Z[se]=U[se]);var se=arguments.length-2;if(se===1)Z.children=te;else if(1<se){for(var ge=Array(se),be=0;be<se;be++)ge[be]=arguments[be+2];Z.children=ge}return A(I.type,re,Z)},Ve.createContext=function(I){return I={$$typeof:o,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:i,_context:I},I},Ve.createElement=function(I,U,te){var Z,re={},se=null;if(U!=null)for(Z in U.key!==void 0&&(se=""+U.key),U)L.call(U,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(re[Z]=U[Z]);var ge=arguments.length-2;if(ge===1)re.children=te;else if(1<ge){for(var be=Array(ge),me=0;me<ge;me++)be[me]=arguments[me+2];re.children=be}if(I&&I.defaultProps)for(Z in ge=I.defaultProps,ge)re[Z]===void 0&&(re[Z]=ge[Z]);return A(I,se,re)},Ve.createRef=function(){return{current:null}},Ve.forwardRef=function(I){return{$$typeof:l,render:I}},Ve.isValidElement=H,Ve.lazy=function(I){return{$$typeof:p,_payload:{_status:-1,_result:I},_init:ie}},Ve.memo=function(I,U){return{$$typeof:f,type:I,compare:U===void 0?null:U}},Ve.startTransition=function(I){var U=O.T,te={};O.T=te;try{var Z=I(),re=O.S;re!==null&&re(te,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(R,Y)}catch(se){Y(se)}finally{U!==null&&te.types!==null&&(U.types=te.types),O.T=U}},Ve.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Ve.use=function(I){return O.H.use(I)},Ve.useActionState=function(I,U,te){return O.H.useActionState(I,U,te)},Ve.useCallback=function(I,U){return O.H.useCallback(I,U)},Ve.useContext=function(I){return O.H.useContext(I)},Ve.useDebugValue=function(){},Ve.useDeferredValue=function(I,U){return O.H.useDeferredValue(I,U)},Ve.useEffect=function(I,U){return O.H.useEffect(I,U)},Ve.useEffectEvent=function(I){return O.H.useEffectEvent(I)},Ve.useId=function(){return O.H.useId()},Ve.useImperativeHandle=function(I,U,te){return O.H.useImperativeHandle(I,U,te)},Ve.useInsertionEffect=function(I,U){return O.H.useInsertionEffect(I,U)},Ve.useLayoutEffect=function(I,U){return O.H.useLayoutEffect(I,U)},Ve.useMemo=function(I,U){return O.H.useMemo(I,U)},Ve.useOptimistic=function(I,U){return O.H.useOptimistic(I,U)},Ve.useReducer=function(I,U,te){return O.H.useReducer(I,U,te)},Ve.useRef=function(I){return O.H.useRef(I)},Ve.useState=function(I){return O.H.useState(I)},Ve.useSyncExternalStore=function(I,U,te){return O.H.useSyncExternalStore(I,U,te)},Ve.useTransition=function(){return O.H.useTransition()},Ve.version="19.2.0",Ve}var c2;function Ju(){return c2||(c2=1,S0.exports=dO()),S0.exports}var C=Ju();const St=Ql(C);function pb(t){const e=t.errorComponent??Np;return u.jsx(fO,{getResetKey:t.getResetKey,onCatch:t.onCatch,children:({error:n,reset:r})=>n?C.createElement(e,{error:n,reset:r}):t.children})}class fO extends C.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromProps(e){return{resetKey:e.getResetKey()}}static getDerivedStateFromError(e){return{error:e}}reset(){this.setState({error:null})}componentDidUpdate(e,n){n.error&&n.resetKey!==this.state.resetKey&&this.reset()}componentDidCatch(e,n){this.props.onCatch&&this.props.onCatch(e,n)}render(){return this.props.children({error:this.state.resetKey!==this.props.getResetKey()?null:this.state.error,reset:()=>{this.reset()}})}}function Np({error:t}){const[e,n]=C.useState(!1);return u.jsxs("div",{style:{padding:".5rem",maxWidth:"100%"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:".5rem"},children:[u.jsx("strong",{style:{fontSize:"1rem"},children:"Something went wrong!"}),u.jsx("button",{style:{appearance:"none",fontSize:".6em",border:"1px solid currentColor",padding:".1rem .2rem",fontWeight:"bold",borderRadius:".25rem"},onClick:()=>n(r=>!r),children:e?"Hide Error":"Show Error"})]}),u.jsx("div",{style:{height:".25rem"}}),e?u.jsx("div",{children:u.jsx("pre",{style:{fontSize:".7em",border:"1px solid red",borderRadius:".25rem",padding:".3rem",color:"red",overflow:"auto"},children:t.message?u.jsx("code",{children:t.message}):null})}):null]})}function hO({children:t,fallback:e=null}){return pO()?u.jsx(St.Fragment,{children:t}):u.jsx(St.Fragment,{children:e})}function pO(){return St.useSyncExternalStore(gO,()=>!0,()=>!1)}function gO(){return()=>{}}var k0={exports:{}},C0={},N0={exports:{}},T0={};var u2;function mO(){if(u2)return T0;u2=1;var t=Ju();function e(g,y){return g===y&&(g!==0||1/g===1/y)||g!==g&&y!==y}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,s=t.useEffect,i=t.useLayoutEffect,o=t.useDebugValue;function l(g,y){var m=y(),b=r({inst:{value:m,getSnapshot:y}}),v=b[0].inst,w=b[1];return i(function(){v.value=m,v.getSnapshot=y,d(v)&&w({inst:v})},[g,m,y]),s(function(){return d(v)&&w({inst:v}),g(function(){d(v)&&w({inst:v})})},[g]),o(m),m}function d(g){var y=g.getSnapshot;g=g.value;try{var m=y();return!n(g,m)}catch{return!0}}function f(g,y){return y()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:l;return T0.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:p,T0}var d2;function lj(){return d2||(d2=1,N0.exports=mO()),N0.exports}var f2;function yO(){if(f2)return C0;f2=1;var t=Ju(),e=lj();function n(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var r=typeof Object.is=="function"?Object.is:n,s=e.useSyncExternalStore,i=t.useRef,o=t.useEffect,l=t.useMemo,d=t.useDebugValue;return C0.useSyncExternalStoreWithSelector=function(f,p,g,y,m){var b=i(null);if(b.current===null){var v={hasValue:!1,value:null};b.current=v}else v=b.current;b=l(function(){function S(R){if(!T){if(T=!0,j=R,R=y(R),m!==void 0&&v.hasValue){var O=v.value;if(m(O,R))return M=O}return M=R}if(O=M,r(j,R))return O;var L=y(R);return m!==void 0&&m(O,L)?(j=R,O):(j=R,M=L)}var T=!1,j,M,_=g===void 0?null:g;return[function(){return S(p())},_===null?void 0:function(){return S(_())}]},[p,g,y,m]);var w=s(f,b[0],b[1]);return o(function(){v.hasValue=!0,v.value=w},[w]),d(w),w},C0}var h2;function xO(){return h2||(h2=1,k0.exports=yO()),k0.exports}var cj=xO();function bO(t,e=r=>r,n={}){const r=n.equal??vO;return cj.useSyncExternalStoreWithSelector(t.subscribe,()=>t.state,()=>t.state,e,r)}function vO(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[r,s]of t)if(!e.has(r)||!Object.is(s,e.get(r)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();const n=p2(t);if(n.length!==p2(e).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(e,n[r])||!Object.is(t[n[r]],e[n[r]]))return!1;return!0}function p2(t){return Object.keys(t).concat(Object.getOwnPropertySymbols(t))}const j0=C.createContext(null);function uj(){return typeof document>"u"?j0:window.__TSR_ROUTER_CONTEXT__?window.__TSR_ROUTER_CONTEXT__:(window.__TSR_ROUTER_CONTEXT__=j0,j0)}function ir(t){const e=C.useContext(uj());return t?.warn,e}function Pn(t){const e=ir({warn:t?.router===void 0}),n=t?.router||e,r=C.useRef(void 0);return bO(n.__store,s=>{if(t?.select){if(t.structuralSharing??n.options.defaultStructuralSharing){const i=qr(r.current,t.select(s));return r.current=i,i}return t.select(s)}return s})}const Tp=C.createContext(void 0),wO=C.createContext(void 0);function Cs(t){const e=C.useContext(t.from?wO:Tp);return Pn({select:r=>{const s=r.matches.find(i=>t.from?t.from===i.routeId:i.id===e);if(ci(!((t.shouldThrow??!0)&&!s),`Could not find ${t.from?`an active match from "${t.from}"`:"a nearest match!"}`),s!==void 0)return t.select?t.select(s):s},structuralSharing:t.structuralSharing})}function gb(t){return Cs({from:t.from,strict:t.strict,structuralSharing:t.structuralSharing,select:e=>t.select?t.select(e.loaderData):e.loaderData})}function mb(t){const{select:e,...n}=t;return Cs({...n,select:r=>e?e(r.loaderDeps):r.loaderDeps})}function yb(t){return Cs({from:t.from,shouldThrow:t.shouldThrow,structuralSharing:t.structuralSharing,strict:t.strict,select:e=>{const n=t.strict===!1?e.params:e._strictParams;return t.select?t.select(n):n}})}function Zu(t){return Cs({from:t.from,strict:t.strict,shouldThrow:t.shouldThrow,structuralSharing:t.structuralSharing,select:e=>t.select?t.select(e.search):e.search})}function ar(t){const e=ir();return C.useCallback(n=>e.navigate({...n,from:n.from??t?.from}),[t?.from,e])}var E0={exports:{}},Tn={};var g2;function SO(){if(g2)return Tn;g2=1;var t=Ju();function e(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(d,f,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:g==null?null:""+g,children:d,containerInfo:f,implementation:p}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Tn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Tn.createPortal=function(d,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return i(d,f,null,p)},Tn.flushSync=function(d){var f=o.T,p=r.p;try{if(o.T=null,r.p=2,d)return d()}finally{o.T=f,r.p=p,r.d.f()}},Tn.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(d,f))},Tn.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},Tn.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var p=f.as,g=l(p,f.crossOrigin),y=typeof f.integrity=="string"?f.integrity:void 0,m=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?r.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:y,fetchPriority:m}):p==="script"&&r.d.X(d,{crossOrigin:g,integrity:y,fetchPriority:m,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Tn.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=l(f.as,f.crossOrigin);r.d.M(d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(d)},Tn.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,g=l(p,f.crossOrigin);r.d.L(d,p,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Tn.preloadModule=function(d,f){if(typeof d=="string")if(f){var p=l(f.as,f.crossOrigin);r.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(d)},Tn.requestFormReset=function(d){r.d.r(d)},Tn.unstable_batchedUpdates=function(d,f){return d(f)},Tn.useFormState=function(d,f,p){return o.H.useFormState(d,f,p)},Tn.useFormStatus=function(){return o.H.useHostTransitionStatus()},Tn.version="19.2.0",Tn}var m2;function dj(){if(m2)return E0.exports;m2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),E0.exports=SO(),E0.exports}var Xi=dj();const kO=Ql(Xi),Rf=typeof window<"u"?C.useLayoutEffect:C.useEffect;function M0(t){const e=C.useRef({value:t,prev:null}),n=e.current.value;return t!==n&&(e.current={value:t,prev:n}),e.current.prev}function CO(t,e,n={},r={}){C.useEffect(()=>{if(!t.current||r.disabled||typeof IntersectionObserver!="function")return;const s=new IntersectionObserver(([i])=>{e(i)},n);return s.observe(t.current),()=>{s.disconnect()}},[e,n,r.disabled,t])}function NO(t){const e=C.useRef(null);return C.useImperativeHandle(t,()=>e.current,[]),e}function TO(t,e){const n=ir(),[r,s]=C.useState(!1),i=C.useRef(!1),o=NO(e),{activeProps:l,inactiveProps:d,activeOptions:f,to:p,preload:g,preloadDelay:y,hashScrollIntoView:m,replace:b,startTransition:v,resetScroll:w,viewTransition:S,children:T,target:j,disabled:M,style:_,className:R,onClick:O,onFocus:L,onMouseEnter:A,onMouseLeave:F,onTouchStart:H,ignoreBlocker:P,params:B,search:E,hash:K,state:q,mask:V,reloadDocument:ie,unsafeRelative:Y,from:X,_fromLocation:I,...U}=t,te=Pn({select:xe=>xe.location.search,structuralSharing:!0}),Z=t.from,re=C.useMemo(()=>({...t,from:Z}),[n,te,Z,t._fromLocation,t.hash,t.to,t.search,t.params,t.state,t.mask,t.unsafeRelative]),se=C.useMemo(()=>n.buildLocation({...re}),[n,re]),ge=C.useMemo(()=>{if(M)return;let xe=se.maskedLocation?se.maskedLocation.url:se.url,Ce=!1;return n.origin&&(xe.startsWith(n.origin)?xe=n.history.createHref(xe.replace(n.origin,""))||"/":Ce=!0),{href:xe,external:Ce}},[M,se.maskedLocation,se.url,n.origin,n.history]),be=C.useMemo(()=>{if(ge?.external)return ge.href;try{return new URL(p),p}catch{}},[p,ge]),me=t.reloadDocument||be?!1:g??n.options.defaultPreload,Se=y??n.options.defaultPreloadDelay??0,Oe=Pn({select:xe=>{if(be)return!1;if(f?.exact){if(!g4(xe.location.pathname,se.pathname,n.basepath))return!1}else{const Ce=gh(xe.location.pathname,n.basepath),Te=gh(se.pathname,n.basepath);if(!(Ce.startsWith(Te)&&(Ce.length===Te.length||Ce[Te.length]==="/")))return!1}return(f?.includeSearch??!0)&&!qa(xe.location.search,se.search,{partial:!f?.exact,ignoreUndefined:!f?.explicitUndefined})?!1:f?.includeHash?xe.location.hash===se.hash:!0}}),He=C.useCallback(()=>{n.preloadRoute({...re}).catch(xe=>{console.warn(xe),console.warn(cO)})},[n,re]),ut=C.useCallback(xe=>{xe?.isIntersecting&&He()},[He]);CO(o,ut,RO,{disabled:!!M||me!=="viewport"}),C.useEffect(()=>{i.current||!M&&me==="render"&&(He(),i.current=!0)},[M,He,me]);const z=xe=>{const Ce=xe.currentTarget.getAttribute("target"),Te=j!==void 0?j:Ce;if(!M&&!_O(xe)&&!xe.defaultPrevented&&(!Te||Te==="_self")&&xe.button===0){xe.preventDefault(),Xi.flushSync(()=>{s(!0)});const De=n.subscribe("onResolved",()=>{De(),s(!1)});n.navigate({...re,replace:b,resetScroll:w,hashScrollIntoView:m,startTransition:v,viewTransition:S,ignoreBlocker:P})}};if(be)return{...U,ref:o,href:be,...T&&{children:T},...j&&{target:j},...M&&{disabled:M},..._&&{style:_},...R&&{className:R},...O&&{onClick:O},...L&&{onFocus:L},...A&&{onMouseEnter:A},...F&&{onMouseLeave:F},...H&&{onTouchStart:H}};const fe=xe=>{M||me&&He()},ue=fe,W=xe=>{if(!(M||!me))if(!Se)He();else{const Ce=xe.target;if(Gc.has(Ce))return;const Te=setTimeout(()=>{Gc.delete(Ce),He()},Se);Gc.set(Ce,Te)}},Q=xe=>{if(M||!me||!Se)return;const Ce=xe.target,Te=Gc.get(Ce);Te&&(clearTimeout(Te),Gc.delete(Ce))},ee=Oe?$a(l,{})??jO:A0,pe=Oe?A0:$a(d,{})??A0,we=[R,ee.className,pe.className].filter(Boolean).join(" "),ae=(_||ee.style||pe.style)&&{..._,...ee.style,...pe.style};return{...U,...ee,...pe,href:ge?.href,ref:o,onClick:Xc([O,z]),onFocus:Xc([L,fe]),onMouseEnter:Xc([A,W]),onMouseLeave:Xc([F,Q]),onTouchStart:Xc([H,ue]),disabled:!!M,target:j,...ae&&{style:ae},...we&&{className:we},...M&&EO,...Oe&&MO,...r&&AO}}const A0={},jO={className:"active"},EO={role:"link","aria-disabled":!0},MO={"data-status":"active","aria-current":"page"},AO={"data-transitioning":"transitioning"},Gc=new WeakMap,RO={rootMargin:"100px"},Xc=t=>e=>{for(const n of t)if(n){if(e.defaultPrevented)return;n(e)}},xb=C.forwardRef((t,e)=>{const{_asChild:n,...r}=t,{type:s,ref:i,...o}=TO(r,e),l=typeof r.children=="function"?r.children({isActive:o["data-status"]==="active"}):r.children;return n===void 0&&delete o.disabled,C.createElement(n||"a",{...o,ref:i},l)});function _O(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}let OO=class extends oj{constructor(e){super(e),this.useMatch=n=>Cs({select:n?.select,from:this.id,structuralSharing:n?.structuralSharing}),this.useRouteContext=n=>Cs({...n,from:this.id,select:r=>n?.select?n.select(r.context):r.context}),this.useSearch=n=>Zu({select:n?.select,structuralSharing:n?.structuralSharing,from:this.id}),this.useParams=n=>yb({select:n?.select,structuralSharing:n?.structuralSharing,from:this.id}),this.useLoaderDeps=n=>mb({...n,from:this.id}),this.useLoaderData=n=>gb({...n,from:this.id}),this.useNavigate=()=>ar({from:this.fullPath}),this.Link=St.forwardRef((n,r)=>u.jsx(xb,{ref:r,from:this.fullPath,...n})),this.$$typeof=Symbol.for("react.memo")}};function DO(t){return new OO(t)}class IO extends uO{constructor(e){super(e),this.useMatch=n=>Cs({select:n?.select,from:this.id,structuralSharing:n?.structuralSharing}),this.useRouteContext=n=>Cs({...n,from:this.id,select:r=>n?.select?n.select(r.context):r.context}),this.useSearch=n=>Zu({select:n?.select,structuralSharing:n?.structuralSharing,from:this.id}),this.useParams=n=>yb({select:n?.select,structuralSharing:n?.structuralSharing,from:this.id}),this.useLoaderDeps=n=>mb({...n,from:this.id}),this.useLoaderData=n=>gb({...n,from:this.id}),this.useNavigate=()=>ar({from:this.fullPath}),this.Link=St.forwardRef((n,r)=>u.jsx(xb,{ref:r,from:this.fullPath,...n})),this.$$typeof=Symbol.for("react.memo")}}function LO(t){return new IO(t)}function Rn(t){return typeof t=="object"?new y2(t,{silent:!0}).createRoute(t):new y2(t,{silent:!0}).createRoute}class y2{constructor(e,n){this.path=e,this.createRoute=r=>{this.silent;const s=DO(r);return s.isRoot=!1,s},this.silent=n?.silent}}class x2{constructor(e){this.useMatch=n=>Cs({select:n?.select,from:this.options.id,structuralSharing:n?.structuralSharing}),this.useRouteContext=n=>Cs({from:this.options.id,select:r=>n?.select?n.select(r.context):r.context}),this.useSearch=n=>Zu({select:n?.select,structuralSharing:n?.structuralSharing,from:this.options.id}),this.useParams=n=>yb({select:n?.select,structuralSharing:n?.structuralSharing,from:this.options.id}),this.useLoaderDeps=n=>mb({...n,from:this.options.id}),this.useLoaderData=n=>gb({...n,from:this.options.id}),this.useNavigate=()=>{const n=ir();return ar({from:n.routesById[this.options.id].fullPath})},this.options=e,this.$$typeof=Symbol.for("react.memo")}}function b2(t){return typeof t=="object"?new x2(t):e=>new x2({id:t,...e})}function zO(){const t=ir(),e=C.useRef({router:t,mounted:!1}),[n,r]=C.useState(!1),{hasPendingMatches:s,isLoading:i}=Pn({select:g=>({isLoading:g.isLoading,hasPendingMatches:g.matches.some(y=>y.status==="pending")}),structuralSharing:!0}),o=M0(i),l=i||n||s,d=M0(l),f=i||s,p=M0(f);return t.startTransition=g=>{r(!0),C.startTransition(()=>{g(),r(!1)})},C.useEffect(()=>{const g=t.history.subscribe(t.load),y=t.buildLocation({to:t.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0});return sa(t.latestLocation.href)!==sa(y.href)&&t.commitLocation({...y,replace:!0}),()=>{g()}},[t,t.history]),Rf(()=>{if(typeof window<"u"&&t.ssr||e.current.router===t&&e.current.mounted)return;e.current={router:t,mounted:!0},(async()=>{try{await t.load()}catch(y){console.error(y)}})()},[t]),Rf(()=>{o&&!i&&t.emit({type:"onLoad",...Ha(t.state)})},[o,t,i]),Rf(()=>{p&&!f&&t.emit({type:"onBeforeRouteMount",...Ha(t.state)})},[f,p,t]),Rf(()=>{d&&!l&&(t.emit({type:"onResolved",...Ha(t.state)}),t.__store.setState(g=>({...g,status:"idle",resolvedLocation:g.location})),q4(t))},[l,d,t]),null}function PO(t){const e=Pn({select:n=>`not-found-${n.location.pathname}-${n.status}`});return u.jsx(pb,{getResetKey:()=>e,onCatch:(n,r)=>{if(ls(n))t.onCatch?.(n,r);else throw n},errorComponent:({error:n})=>{if(ls(n))return t.fallback?.(n);throw n},children:t.children})}function BO(){return u.jsx("p",{children:"Not Found"})}function Nl(t){return u.jsx(u.Fragment,{children:t.children})}function fj(t,e,n){return e.options.notFoundComponent?u.jsx(e.options.notFoundComponent,{data:n}):t.options.defaultNotFoundComponent?u.jsx(t.options.defaultNotFoundComponent,{data:n}):u.jsx(BO,{})}function FO({children:t}){const e=ir();return e.isServer?u.jsx("script",{nonce:e.options.ssr?.nonce,className:"$tsr",dangerouslySetInnerHTML:{__html:[t].filter(Boolean).join(`
`)+";$_TSR.c()"}}):null}function UO(){const t=ir();if(!t.isScrollRestoring||!t.isServer||typeof t.options.scrollRestoration=="function"&&!t.options.scrollRestoration({location:t.latestLocation}))return null;const n=(t.options.getScrollRestorationKey||nx)(t.latestLocation),r=n!==nx(t.latestLocation)?n:void 0,s={storageKey:mh,shouldScrollRestoration:!0};return r&&(s.key=r),u.jsx(FO,{children:`(${XT.toString()})(${JSON.stringify(s)})`})}const hj=C.memo(function({matchId:e}){const n=ir(),r=Pn({select:S=>{const T=S.matches.find(j=>j.id===e);return ci(T),{routeId:T.routeId,ssr:T.ssr,_displayPending:T._displayPending}},structuralSharing:!0}),s=n.routesById[r.routeId],i=s.options.pendingComponent??n.options.defaultPendingComponent,o=i?u.jsx(i,{}):null,l=s.options.errorComponent??n.options.defaultErrorComponent,d=s.options.onCatch??n.options.defaultOnCatch,f=s.isRoot?s.options.notFoundComponent??n.options.notFoundRoute?.options.component:s.options.notFoundComponent,p=r.ssr===!1||r.ssr==="data-only",g=(!s.isRoot||s.options.wrapInSuspense||p)&&(s.options.wrapInSuspense??i??(s.options.errorComponent?.preload||p))?C.Suspense:Nl,y=l?pb:Nl,m=f?PO:Nl,b=Pn({select:S=>S.loadedAt}),v=Pn({select:S=>{const T=S.matches.findIndex(j=>j.id===e);return S.matches[T-1]?.routeId}}),w=s.isRoot?s.options.shellComponent??Nl:Nl;return u.jsxs(w,{children:[u.jsx(Tp.Provider,{value:e,children:u.jsx(g,{fallback:o,children:u.jsx(y,{getResetKey:()=>b,errorComponent:l||Np,onCatch:(S,T)=>{if(ls(S))throw S;d?.(S,T)},children:u.jsx(m,{fallback:S=>{if(!f||S.routeId&&S.routeId!==r.routeId||!S.routeId&&!s.isRoot)throw S;return C.createElement(f,S)},children:p||r._displayPending?u.jsx(hO,{fallback:o,children:u.jsx(v2,{matchId:e})}):u.jsx(v2,{matchId:e})})})})}),v===br&&n.options.scrollRestoration?u.jsxs(u.Fragment,{children:[u.jsx($O,{}),u.jsx(UO,{})]}):null]})});function $O(){const t=ir(),e=C.useRef(void 0);return u.jsx("script",{suppressHydrationWarning:!0,ref:n=>{n&&(e.current===void 0||e.current.href!==t.latestLocation.href)&&(t.emit({type:"onRendered",...Ha(t.state)}),e.current=t.latestLocation)}},t.latestLocation.state.__TSR_key)}const v2=C.memo(function({matchId:e}){const n=ir(),{match:r,key:s,routeId:i}=Pn({select:d=>{const f=d.matches.find(b=>b.id===e),p=f.routeId,y=(n.routesById[p].options.remountDeps??n.options.defaultRemountDeps)?.({routeId:p,loaderDeps:f.loaderDeps,params:f._strictParams,search:f._strictSearch});return{key:y?JSON.stringify(y):void 0,routeId:p,match:{id:f.id,status:f.status,error:f.error,_forcePending:f._forcePending,_displayPending:f._displayPending}}},structuralSharing:!0}),o=n.routesById[i],l=C.useMemo(()=>{const d=o.options.component??n.options.defaultComponent;return d?u.jsx(d,{},s):u.jsx(bb,{})},[s,o.options.component,n.options.defaultComponent]);if(r._displayPending)throw n.getMatch(r.id)?._nonReactive.displayPendingPromise;if(r._forcePending)throw n.getMatch(r.id)?._nonReactive.minPendingPromise;if(r.status==="pending"){const d=o.options.pendingMinMs??n.options.defaultPendingMinMs;if(d){const f=n.getMatch(r.id);if(f&&!f._nonReactive.minPendingPromise&&!n.isServer){const p=Il();f._nonReactive.minPendingPromise=p,setTimeout(()=>{p.resolve(),f._nonReactive.minPendingPromise=void 0},d)}}throw n.getMatch(r.id)?._nonReactive.loadPromise}if(r.status==="notFound")return ci(ls(r.error)),fj(n,o,r.error);if(r.status==="redirected")throw ci(ws(r.error)),n.getMatch(r.id)?._nonReactive.loadPromise;if(r.status==="error"){if(n.isServer){const d=(o.options.errorComponent??n.options.defaultErrorComponent)||Np;return u.jsx(d,{error:r.error,reset:void 0,info:{componentStack:""}})}throw r.error}return l}),bb=C.memo(function(){const e=ir(),n=C.useContext(Tp),r=Pn({select:f=>f.matches.find(p=>p.id===n)?.routeId}),s=e.routesById[r],i=Pn({select:f=>{const g=f.matches.find(y=>y.id===n);return ci(g),g.globalNotFound}}),o=Pn({select:f=>{const p=f.matches,g=p.findIndex(y=>y.id===n);return p[g+1]?.id}}),l=e.options.defaultPendingComponent?u.jsx(e.options.defaultPendingComponent,{}):null;if(i)return fj(e,s,void 0);if(!o)return null;const d=u.jsx(hj,{matchId:o});return n===br?u.jsx(C.Suspense,{fallback:l,children:d}):d});function qO(){const t=ir(),n=t.routesById[br].options.pendingComponent??t.options.defaultPendingComponent,r=n?u.jsx(n,{}):null,s=t.isServer||typeof document<"u"&&t.ssr?Nl:C.Suspense,i=u.jsxs(s,{fallback:r,children:[!t.isServer&&u.jsx(zO,{}),u.jsx(HO,{})]});return t.options.InnerWrap?u.jsx(t.options.InnerWrap,{children:i}):i}function HO(){const t=ir(),e=Pn({select:s=>s.matches[0]?.id}),n=Pn({select:s=>s.loadedAt}),r=e?u.jsx(hj,{matchId:e}):null;return u.jsx(Tp.Provider,{value:e,children:t.options.disableGlobalCatchBoundary?r:u.jsx(pb,{getResetKey:()=>n,errorComponent:Np,onCatch:s=>{s.message||s.toString()},children:r})})}const VO=t=>new KO(t);class KO extends sO{constructor(e){super(e)}}typeof globalThis<"u"?(globalThis.createFileRoute=Rn,globalThis.createLazyFileRoute=b2):typeof window<"u"&&(window.createFileRoute=Rn,window.createLazyFileRoute=b2);function QO({router:t,children:e,...n}){Object.keys(n).length>0&&t.update({...t.options,...n,context:{...t.options.context,...n.context}});const r=uj(),s=u.jsx(r.Provider,{value:t,children:e});return t.options.Wrap?u.jsx(t.options.Wrap,{children:s}):s}function WO({router:t,...e}){return u.jsx(QO,{router:t,...e,children:u.jsx(qO,{})})}function YO(t,e){if(t===void 0)return{shouldBlockFn:()=>!0,withResolver:!1};if("shouldBlockFn"in t)return t;if(typeof t=="function")return{shouldBlockFn:async()=>await t(),enableBeforeUnload:!0,withResolver:!1};const n=!!(t.condition??!0),r=t.blockerFn;return{shouldBlockFn:async()=>n&&r!==void 0?await r():n,enableBeforeUnload:n,withResolver:r===void 0}}function GO(t,e){const{shouldBlockFn:n,enableBeforeUnload:r=!0,disabled:s=!1,withResolver:i=!1}=YO(t),o=ir(),{history:l}=o,[d,f]=C.useState({status:"idle",current:void 0,next:void 0,action:void 0,proceed:void 0,reset:void 0});return C.useEffect(()=>{const p=async g=>{function y(T){const j=o.parseLocation(T),M=o.getMatchedRoutes(j.pathname,void 0);if(M.foundRoute===void 0)throw new Error(`No route found for location ${T.href}`);return{routeId:M.foundRoute.id,fullPath:M.foundRoute.fullPath,pathname:j.pathname,params:M.routeParams,search:j.search}}const m=y(g.currentLocation),b=y(g.nextLocation),v=await n({action:g.action,current:m,next:b});if(!i)return v;if(!v)return!1;const S=await new Promise(T=>{f({status:"blocked",current:m,next:b,action:g.action,proceed:()=>T(!1),reset:()=>T(!0)})});return f({status:"idle",current:void 0,next:void 0,action:void 0,proceed:void 0,reset:void 0}),S};return s?void 0:l.block({blockerFn:p,enableBeforeUnload:r})},[n,r,s,i,l,o]),d}function jp(t){return Pn({select:e=>e.location})}var R0={exports:{}},Jc={},_0={exports:{}},O0={};var w2;function XO(){return w2||(w2=1,(function(t){function e(q,V){var ie=q.length;q.push(V);e:for(;0<ie;){var Y=ie-1>>>1,X=q[Y];if(0<s(X,V))q[Y]=V,q[ie]=X,ie=Y;else break e}}function n(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var V=q[0],ie=q.pop();if(ie!==V){q[0]=ie;e:for(var Y=0,X=q.length,I=X>>>1;Y<I;){var U=2*(Y+1)-1,te=q[U],Z=U+1,re=q[Z];if(0>s(te,ie))Z<X&&0>s(re,te)?(q[Y]=re,q[Z]=ie,Y=Z):(q[Y]=te,q[U]=ie,Y=U);else if(Z<X&&0>s(re,ie))q[Y]=re,q[Z]=ie,Y=Z;else break e}}return V}function s(q,V){var ie=q.sortIndex-V.sortIndex;return ie!==0?ie:q.id-V.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var d=[],f=[],p=1,g=null,y=3,m=!1,b=!1,v=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;function M(q){for(var V=n(f);V!==null;){if(V.callback===null)r(f);else if(V.startTime<=q)r(f),V.sortIndex=V.expirationTime,e(d,V);else break;V=n(f)}}function _(q){if(v=!1,M(q),!b)if(n(d)!==null)b=!0,R||(R=!0,P());else{var V=n(f);V!==null&&K(_,V.startTime-q)}}var R=!1,O=-1,L=5,A=-1;function F(){return w?!0:!(t.unstable_now()-A<L)}function H(){if(w=!1,R){var q=t.unstable_now();A=q;var V=!0;try{e:{b=!1,v&&(v=!1,T(O),O=-1),m=!0;var ie=y;try{t:{for(M(q),g=n(d);g!==null&&!(g.expirationTime>q&&F());){var Y=g.callback;if(typeof Y=="function"){g.callback=null,y=g.priorityLevel;var X=Y(g.expirationTime<=q);if(q=t.unstable_now(),typeof X=="function"){g.callback=X,M(q),V=!0;break t}g===n(d)&&r(d),M(q)}else r(d);g=n(d)}if(g!==null)V=!0;else{var I=n(f);I!==null&&K(_,I.startTime-q),V=!1}}break e}finally{g=null,y=ie,m=!1}V=void 0}}finally{V?P():R=!1}}}var P;if(typeof j=="function")P=function(){j(H)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,E=B.port2;B.port1.onmessage=H,P=function(){E.postMessage(null)}}else P=function(){S(H,0)};function K(q,V){O=S(function(){q(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(q){switch(y){case 1:case 2:case 3:var V=3;break;default:V=y}var ie=y;y=V;try{return q()}finally{y=ie}},t.unstable_requestPaint=function(){w=!0},t.unstable_runWithPriority=function(q,V){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ie=y;y=q;try{return V()}finally{y=ie}},t.unstable_scheduleCallback=function(q,V,ie){var Y=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?Y+ie:Y):ie=Y,q){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=ie+X,q={id:p++,callback:V,priorityLevel:q,startTime:ie,expirationTime:X,sortIndex:-1},ie>Y?(q.sortIndex=ie,e(f,q),n(d)===null&&q===n(f)&&(v?(T(O),O=-1):v=!0,K(_,ie-Y))):(q.sortIndex=X,e(d,q),b||m||(b=!0,R||(R=!0,P()))),q},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(q){var V=y;return function(){var ie=y;y=V;try{return q.apply(this,arguments)}finally{y=ie}}}})(O0)),O0}var S2;function JO(){return S2||(S2=1,_0.exports=XO()),_0.exports}var k2;function ZO(){if(k2)return Jc;k2=1;var t=JO(),e=Ju(),n=dj();function r(a){var c="https://react.dev/errors/"+a;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function i(a){var c=a,h=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(h=c.return),a=c.return;while(a)}return c.tag===3?h:null}function o(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function l(a){if(a.tag===31){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function d(a){if(i(a)!==a)throw Error(r(188))}function f(a){var c=a.alternate;if(!c){if(c=i(a),c===null)throw Error(r(188));return c!==a?null:a}for(var h=a,x=c;;){var k=h.return;if(k===null)break;var N=k.alternate;if(N===null){if(x=k.return,x!==null){h=x;continue}break}if(k.child===N.child){for(N=k.child;N;){if(N===h)return d(k),a;if(N===x)return d(k),c;N=N.sibling}throw Error(r(188))}if(h.return!==x.return)h=k,x=N;else{for(var D=!1,$=k.child;$;){if($===h){D=!0,h=k,x=N;break}if($===x){D=!0,x=k,h=N;break}$=$.sibling}if(!D){for($=N.child;$;){if($===h){D=!0,h=N,x=k;break}if($===x){D=!0,x=N,h=k;break}$=$.sibling}if(!D)throw Error(r(189))}}if(h.alternate!==x)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?a:c}function p(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a;for(a=a.child;a!==null;){if(c=p(a),c!==null)return c;a=a.sibling}return null}var g=Object.assign,y=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),j=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function P(a){return a===null||typeof a!="object"?null:(a=H&&a[H]||a["@@iterator"],typeof a=="function"?a:null)}var B=Symbol.for("react.client.reference");function E(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===B?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case v:return"Fragment";case S:return"Profiler";case w:return"StrictMode";case _:return"Suspense";case R:return"SuspenseList";case A:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case b:return"Portal";case j:return a.displayName||"Context";case T:return(a._context.displayName||"Context")+".Consumer";case M:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case O:return c=a.displayName||null,c!==null?c:E(a.type)||"Memo";case L:c=a._payload,a=a._init;try{return E(a(c))}catch{}}return null}var K=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie={pending:!1,data:null,method:null,action:null},Y=[],X=-1;function I(a){return{current:a}}function U(a){0>X||(a.current=Y[X],Y[X]=null,X--)}function te(a,c){X++,Y[X]=a.current,a.current=c}var Z=I(null),re=I(null),se=I(null),ge=I(null);function be(a,c){switch(te(se,c),te(re,a),te(Z,null),c.nodeType){case 9:case 11:a=(a=c.documentElement)&&(a=a.namespaceURI)?yk(a):0;break;default:if(a=c.tagName,c=c.namespaceURI)c=yk(c),a=xk(c,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}U(Z),te(Z,a)}function me(){U(Z),U(re),U(se)}function Se(a){a.memoizedState!==null&&te(ge,a);var c=Z.current,h=xk(c,a.type);c!==h&&(te(re,a),te(Z,h))}function Oe(a){re.current===a&&(U(Z),U(re)),ge.current===a&&(U(ge),Hc._currentValue=ie)}var He,ut;function z(a){if(He===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);He=c&&c[1]||"",ut=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+He+a+ut}var fe=!1;function ue(a,c){if(!a||fe)return"";fe=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(de){var ce=de}Reflect.construct(a,[],ve)}else{try{ve.call()}catch(de){ce=de}a.call(ve.prototype)}}else{try{throw Error()}catch(de){ce=de}(ve=a())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(de){if(de&&ce&&typeof de.stack=="string")return[de.stack,ce.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var k=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");k&&k.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var N=x.DetermineComponentFrameRoot(),D=N[0],$=N[1];if(D&&$){var G=D.split(`
`),le=$.split(`
`);for(k=x=0;x<G.length&&!G[x].includes("DetermineComponentFrameRoot");)x++;for(;k<le.length&&!le[k].includes("DetermineComponentFrameRoot");)k++;if(x===G.length||k===le.length)for(x=G.length-1,k=le.length-1;1<=x&&0<=k&&G[x]!==le[k];)k--;for(;1<=x&&0<=k;x--,k--)if(G[x]!==le[k]){if(x!==1||k!==1)do if(x--,k--,0>k||G[x]!==le[k]){var he=`
`+G[x].replace(" at new "," at ");return a.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",a.displayName)),he}while(1<=x&&0<=k);break}}}finally{fe=!1,Error.prepareStackTrace=h}return(h=a?a.displayName||a.name:"")?z(h):""}function W(a,c){switch(a.tag){case 26:case 27:case 5:return z(a.type);case 16:return z("Lazy");case 13:return a.child!==c&&c!==null?z("Suspense Fallback"):z("Suspense");case 19:return z("SuspenseList");case 0:case 15:return ue(a.type,!1);case 11:return ue(a.type.render,!1);case 1:return ue(a.type,!0);case 31:return z("Activity");default:return""}}function Q(a){try{var c="",h=null;do c+=W(a,h),h=a,a=a.return;while(a);return c}catch(x){return`
Error generating stack: `+x.message+`
`+x.stack}}var ee=Object.prototype.hasOwnProperty,pe=t.unstable_scheduleCallback,we=t.unstable_cancelCallback,ae=t.unstable_shouldYield,xe=t.unstable_requestPaint,Ce=t.unstable_now,Te=t.unstable_getCurrentPriorityLevel,De=t.unstable_ImmediatePriority,Ze=t.unstable_UserBlockingPriority,Ue=t.unstable_NormalPriority,$t=t.unstable_LowPriority,Jr=t.unstable_IdlePriority,Bt=t.log,fs=t.unstable_setDisableYieldValue,dt=null,qt=null;function Cn(a){if(typeof Bt=="function"&&fs(a),qt&&typeof qt.setStrictMode=="function")try{qt.setStrictMode(dt,a)}catch{}}var Nt=Math.clz32?Math.clz32:sc,Co=Math.log,No=Math.LN2;function sc(a){return a>>>=0,a===0?32:31-(Co(a)/No|0)|0}var mi=256,Rs=262144,vt=4194304;function Tt(a){var c=a&42;if(c!==0)return c;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function an(a,c,h){var x=a.pendingLanes;if(x===0)return 0;var k=0,N=a.suspendedLanes,D=a.pingedLanes;a=a.warmLanes;var $=x&134217727;return $!==0?(x=$&~N,x!==0?k=Tt(x):(D&=$,D!==0?k=Tt(D):h||(h=$&~a,h!==0&&(k=Tt(h))))):($=x&~N,$!==0?k=Tt($):D!==0?k=Tt(D):h||(h=x&~a,h!==0&&(k=Tt(h)))),k===0?0:c!==0&&c!==k&&(c&N)===0&&(N=k&-k,h=c&-c,N>=h||N===32&&(h&4194048)!==0)?c:k}function Vn(a,c){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&c)===0}function Kn(a,c){switch(a){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nn(){var a=vt;return vt<<=1,(vt&62914560)===0&&(vt=4194304),a}function Qn(a){for(var c=[],h=0;31>h;h++)c.push(a);return c}function Cr(a,c){a.pendingLanes|=c,c!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function en(a,c,h,x,k,N){var D=a.pendingLanes;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=h,a.entangledLanes&=h,a.errorRecoveryDisabledLanes&=h,a.shellSuspendCounter=0;var $=a.entanglements,G=a.expirationTimes,le=a.hiddenUpdates;for(h=D&~h;0<h;){var he=31-Nt(h),ve=1<<he;$[he]=0,G[he]=-1;var ce=le[he];if(ce!==null)for(le[he]=null,he=0;he<ce.length;he++){var de=ce[he];de!==null&&(de.lane&=-536870913)}h&=~ve}x!==0&&Zr(a,x,0),N!==0&&k===0&&a.tag!==0&&(a.suspendedLanes|=N&~(D&~c))}function Zr(a,c,h){a.pendingLanes|=c,a.suspendedLanes&=~c;var x=31-Nt(c);a.entangledLanes|=c,a.entanglements[x]=a.entanglements[x]|1073741824|h&261930}function cr(a,c){var h=a.entangledLanes|=c;for(a=a.entanglements;h;){var x=31-Nt(h),k=1<<x;k&c|a[x]&c&&(a[x]|=c),h&=~k}}function Nr(a,c){var h=c&-c;return h=(h&42)!==0?1:_s(h),(h&(a.suspendedLanes|c))!==0?0:h}function _s(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Os(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function es(){var a=V.p;return a!==0?a:(a=window.event,a===void 0?32:Uk(a.type))}function yi(a,c){var h=V.p;try{return V.p=a,c()}finally{V.p=h}}var Tr=Math.random().toString(36).slice(2),pn="__reactFiber$"+Tr,Wn="__reactProps$"+Tr,To="__reactContainer$"+Tr,ug="__reactEvents$"+Tr,VA="__reactListeners$"+Tr,KA="__reactHandles$"+Tr,s1="__reactResources$"+Tr,ic="__reactMarker$"+Tr;function dg(a){delete a[pn],delete a[Wn],delete a[ug],delete a[VA],delete a[KA]}function jo(a){var c=a[pn];if(c)return c;for(var h=a.parentNode;h;){if(c=h[To]||h[pn]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(a=Nk(a);a!==null;){if(h=a[pn])return h;a=Nk(a)}return c}a=h,h=a.parentNode}return null}function Eo(a){if(a=a[pn]||a[To]){var c=a.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return a}return null}function ac(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a.stateNode;throw Error(r(33))}function Mo(a){var c=a[s1];return c||(c=a[s1]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function on(a){a[ic]=!0}var i1=new Set,a1={};function ma(a,c){Ao(a,c),Ao(a+"Capture",c)}function Ao(a,c){for(a1[a]=c,a=0;a<c.length;a++)i1.add(c[a])}var QA=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),o1={},l1={};function WA(a){return ee.call(l1,a)?!0:ee.call(o1,a)?!1:QA.test(a)?l1[a]=!0:(o1[a]=!0,!1)}function hd(a,c,h){if(WA(c))if(h===null)a.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":a.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){a.removeAttribute(c);return}}a.setAttribute(c,""+h)}}function pd(a,c,h){if(h===null)a.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttribute(c,""+h)}}function Ds(a,c,h,x){if(x===null)a.removeAttribute(h);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(h);return}a.setAttributeNS(c,h,""+x)}}function jr(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function c1(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function YA(a,c,h){var x=Object.getOwnPropertyDescriptor(a.constructor.prototype,c);if(!a.hasOwnProperty(c)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var k=x.get,N=x.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return k.call(this)},set:function(D){h=""+D,N.call(this,D)}}),Object.defineProperty(a,c,{enumerable:x.enumerable}),{getValue:function(){return h},setValue:function(D){h=""+D},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function fg(a){if(!a._valueTracker){var c=c1(a)?"checked":"value";a._valueTracker=YA(a,c,""+a[c])}}function u1(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var h=c.getValue(),x="";return a&&(x=c1(a)?a.checked?"true":"false":a.value),a=x,a!==h?(c.setValue(a),!0):!1}function gd(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var GA=/[\n"\\]/g;function Er(a){return a.replace(GA,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function hg(a,c,h,x,k,N,D,$){a.name="",D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?a.type=D:a.removeAttribute("type"),c!=null?D==="number"?(c===0&&a.value===""||a.value!=c)&&(a.value=""+jr(c)):a.value!==""+jr(c)&&(a.value=""+jr(c)):D!=="submit"&&D!=="reset"||a.removeAttribute("value"),c!=null?pg(a,D,jr(c)):h!=null?pg(a,D,jr(h)):x!=null&&a.removeAttribute("value"),k==null&&N!=null&&(a.defaultChecked=!!N),k!=null&&(a.checked=k&&typeof k!="function"&&typeof k!="symbol"),$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?a.name=""+jr($):a.removeAttribute("name")}function d1(a,c,h,x,k,N,D,$){if(N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(a.type=N),c!=null||h!=null){if(!(N!=="submit"&&N!=="reset"||c!=null)){fg(a);return}h=h!=null?""+jr(h):"",c=c!=null?""+jr(c):h,$||c===a.value||(a.value=c),a.defaultValue=c}x=x??k,x=typeof x!="function"&&typeof x!="symbol"&&!!x,a.checked=$?a.checked:!!x,a.defaultChecked=!!x,D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(a.name=D),fg(a)}function pg(a,c,h){c==="number"&&gd(a.ownerDocument)===a||a.defaultValue===""+h||(a.defaultValue=""+h)}function Ro(a,c,h,x){if(a=a.options,c){c={};for(var k=0;k<h.length;k++)c["$"+h[k]]=!0;for(h=0;h<a.length;h++)k=c.hasOwnProperty("$"+a[h].value),a[h].selected!==k&&(a[h].selected=k),k&&x&&(a[h].defaultSelected=!0)}else{for(h=""+jr(h),c=null,k=0;k<a.length;k++){if(a[k].value===h){a[k].selected=!0,x&&(a[k].defaultSelected=!0);return}c!==null||a[k].disabled||(c=a[k])}c!==null&&(c.selected=!0)}}function f1(a,c,h){if(c!=null&&(c=""+jr(c),c!==a.value&&(a.value=c),h==null)){a.defaultValue!==c&&(a.defaultValue=c);return}a.defaultValue=h!=null?""+jr(h):""}function h1(a,c,h,x){if(c==null){if(x!=null){if(h!=null)throw Error(r(92));if(K(x)){if(1<x.length)throw Error(r(93));x=x[0]}h=x}h==null&&(h=""),c=h}h=jr(c),a.defaultValue=h,x=a.textContent,x===h&&x!==""&&x!==null&&(a.value=x),fg(a)}function _o(a,c){if(c){var h=a.firstChild;if(h&&h===a.lastChild&&h.nodeType===3){h.nodeValue=c;return}}a.textContent=c}var XA=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function p1(a,c,h){var x=c.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?x?a.setProperty(c,""):c==="float"?a.cssFloat="":a[c]="":x?a.setProperty(c,h):typeof h!="number"||h===0||XA.has(c)?c==="float"?a.cssFloat=h:a[c]=(""+h).trim():a[c]=h+"px"}function g1(a,c,h){if(c!=null&&typeof c!="object")throw Error(r(62));if(a=a.style,h!=null){for(var x in h)!h.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?a.setProperty(x,""):x==="float"?a.cssFloat="":a[x]="");for(var k in c)x=c[k],c.hasOwnProperty(k)&&h[k]!==x&&p1(a,k,x)}else for(var N in c)c.hasOwnProperty(N)&&p1(a,N,c[N])}function gg(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var JA=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ZA=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function md(a){return ZA.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Is(){}var mg=null;function yg(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Oo=null,Do=null;function m1(a){var c=Eo(a);if(c&&(a=c.stateNode)){var h=a[Wn]||null;e:switch(a=c.stateNode,c.type){case"input":if(hg(a,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),c=h.name,h.type==="radio"&&c!=null){for(h=a;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Er(""+c)+'"][type="radio"]'),c=0;c<h.length;c++){var x=h[c];if(x!==a&&x.form===a.form){var k=x[Wn]||null;if(!k)throw Error(r(90));hg(x,k.value,k.defaultValue,k.defaultValue,k.checked,k.defaultChecked,k.type,k.name)}}for(c=0;c<h.length;c++)x=h[c],x.form===a.form&&u1(x)}break e;case"textarea":f1(a,h.value,h.defaultValue);break e;case"select":c=h.value,c!=null&&Ro(a,!!h.multiple,c,!1)}}}var xg=!1;function y1(a,c,h){if(xg)return a(c,h);xg=!0;try{var x=a(c);return x}finally{if(xg=!1,(Oo!==null||Do!==null)&&(rf(),Oo&&(c=Oo,a=Do,Do=Oo=null,m1(c),a)))for(c=0;c<a.length;c++)m1(a[c])}}function oc(a,c){var h=a.stateNode;if(h===null)return null;var x=h[Wn]||null;if(x===null)return null;h=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(a=a.type,x=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!x;break e;default:a=!1}if(a)return null;if(h&&typeof h!="function")throw Error(r(231,c,typeof h));return h}var Ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bg=!1;if(Ls)try{var lc={};Object.defineProperty(lc,"passive",{get:function(){bg=!0}}),window.addEventListener("test",lc,lc),window.removeEventListener("test",lc,lc)}catch{bg=!1}var xi=null,vg=null,yd=null;function x1(){if(yd)return yd;var a,c=vg,h=c.length,x,k="value"in xi?xi.value:xi.textContent,N=k.length;for(a=0;a<h&&c[a]===k[a];a++);var D=h-a;for(x=1;x<=D&&c[h-x]===k[N-x];x++);return yd=k.slice(a,1<x?1-x:void 0)}function xd(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function bd(){return!0}function b1(){return!1}function Yn(a){function c(h,x,k,N,D){this._reactName=h,this._targetInst=k,this.type=x,this.nativeEvent=N,this.target=D,this.currentTarget=null;for(var $ in a)a.hasOwnProperty($)&&(h=a[$],this[$]=h?h(N):N[$]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?bd:b1,this.isPropagationStopped=b1,this}return g(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=bd)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=bd)},persist:function(){},isPersistent:bd}),c}var ya={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vd=Yn(ya),cc=g({},ya,{view:0,detail:0}),eR=Yn(cc),wg,Sg,uc,wd=g({},cc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cg,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==uc&&(uc&&a.type==="mousemove"?(wg=a.screenX-uc.screenX,Sg=a.screenY-uc.screenY):Sg=wg=0,uc=a),wg)},movementY:function(a){return"movementY"in a?a.movementY:Sg}}),v1=Yn(wd),tR=g({},wd,{dataTransfer:0}),nR=Yn(tR),rR=g({},cc,{relatedTarget:0}),kg=Yn(rR),sR=g({},ya,{animationName:0,elapsedTime:0,pseudoElement:0}),iR=Yn(sR),aR=g({},ya,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),oR=Yn(aR),lR=g({},ya,{data:0}),w1=Yn(lR),cR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fR(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=dR[a])?!!c[a]:!1}function Cg(){return fR}var hR=g({},cc,{key:function(a){if(a.key){var c=cR[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=xd(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?uR[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cg,charCode:function(a){return a.type==="keypress"?xd(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?xd(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),pR=Yn(hR),gR=g({},wd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),S1=Yn(gR),mR=g({},cc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cg}),yR=Yn(mR),xR=g({},ya,{propertyName:0,elapsedTime:0,pseudoElement:0}),bR=Yn(xR),vR=g({},wd,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),wR=Yn(vR),SR=g({},ya,{newState:0,oldState:0}),kR=Yn(SR),CR=[9,13,27,32],Ng=Ls&&"CompositionEvent"in window,dc=null;Ls&&"documentMode"in document&&(dc=document.documentMode);var NR=Ls&&"TextEvent"in window&&!dc,k1=Ls&&(!Ng||dc&&8<dc&&11>=dc),C1=" ",N1=!1;function T1(a,c){switch(a){case"keyup":return CR.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function j1(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Io=!1;function TR(a,c){switch(a){case"compositionend":return j1(c);case"keypress":return c.which!==32?null:(N1=!0,C1);case"textInput":return a=c.data,a===C1&&N1?null:a;default:return null}}function jR(a,c){if(Io)return a==="compositionend"||!Ng&&T1(a,c)?(a=x1(),yd=vg=xi=null,Io=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return k1&&c.locale!=="ko"?null:c.data;default:return null}}var ER={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function E1(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!ER[a.type]:c==="textarea"}function M1(a,c,h,x){Oo?Do?Do.push(x):Do=[x]:Oo=x,c=df(c,"onChange"),0<c.length&&(h=new vd("onChange","change",null,h,x),a.push({event:h,listeners:c}))}var fc=null,hc=null;function MR(a){dk(a,0)}function Sd(a){var c=ac(a);if(u1(c))return a}function A1(a,c){if(a==="change")return c}var R1=!1;if(Ls){var Tg;if(Ls){var jg="oninput"in document;if(!jg){var _1=document.createElement("div");_1.setAttribute("oninput","return;"),jg=typeof _1.oninput=="function"}Tg=jg}else Tg=!1;R1=Tg&&(!document.documentMode||9<document.documentMode)}function O1(){fc&&(fc.detachEvent("onpropertychange",D1),hc=fc=null)}function D1(a){if(a.propertyName==="value"&&Sd(hc)){var c=[];M1(c,hc,a,yg(a)),y1(MR,c)}}function AR(a,c,h){a==="focusin"?(O1(),fc=c,hc=h,fc.attachEvent("onpropertychange",D1)):a==="focusout"&&O1()}function RR(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Sd(hc)}function _R(a,c){if(a==="click")return Sd(c)}function OR(a,c){if(a==="input"||a==="change")return Sd(c)}function DR(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var ur=typeof Object.is=="function"?Object.is:DR;function pc(a,c){if(ur(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var h=Object.keys(a),x=Object.keys(c);if(h.length!==x.length)return!1;for(x=0;x<h.length;x++){var k=h[x];if(!ee.call(c,k)||!ur(a[k],c[k]))return!1}return!0}function I1(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function L1(a,c){var h=I1(a);a=0;for(var x;h;){if(h.nodeType===3){if(x=a+h.textContent.length,a<=c&&x>=c)return{node:h,offset:c-a};a=x}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=I1(h)}}function z1(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?z1(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function P1(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var c=gd(a.document);c instanceof a.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)a=c.contentWindow;else break;c=gd(a.document)}return c}function Eg(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}var IR=Ls&&"documentMode"in document&&11>=document.documentMode,Lo=null,Mg=null,gc=null,Ag=!1;function B1(a,c,h){var x=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Ag||Lo==null||Lo!==gd(x)||(x=Lo,"selectionStart"in x&&Eg(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),gc&&pc(gc,x)||(gc=x,x=df(Mg,"onSelect"),0<x.length&&(c=new vd("onSelect","select",null,c,h),a.push({event:c,listeners:x}),c.target=Lo)))}function xa(a,c){var h={};return h[a.toLowerCase()]=c.toLowerCase(),h["Webkit"+a]="webkit"+c,h["Moz"+a]="moz"+c,h}var zo={animationend:xa("Animation","AnimationEnd"),animationiteration:xa("Animation","AnimationIteration"),animationstart:xa("Animation","AnimationStart"),transitionrun:xa("Transition","TransitionRun"),transitionstart:xa("Transition","TransitionStart"),transitioncancel:xa("Transition","TransitionCancel"),transitionend:xa("Transition","TransitionEnd")},Rg={},F1={};Ls&&(F1=document.createElement("div").style,"AnimationEvent"in window||(delete zo.animationend.animation,delete zo.animationiteration.animation,delete zo.animationstart.animation),"TransitionEvent"in window||delete zo.transitionend.transition);function ba(a){if(Rg[a])return Rg[a];if(!zo[a])return a;var c=zo[a],h;for(h in c)if(c.hasOwnProperty(h)&&h in F1)return Rg[a]=c[h];return a}var U1=ba("animationend"),$1=ba("animationiteration"),q1=ba("animationstart"),LR=ba("transitionrun"),zR=ba("transitionstart"),PR=ba("transitioncancel"),H1=ba("transitionend"),V1=new Map,_g="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");_g.push("scrollEnd");function ts(a,c){V1.set(a,c),ma(c,[a])}var kd=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Mr=[],Po=0,Og=0;function Cd(){for(var a=Po,c=Og=Po=0;c<a;){var h=Mr[c];Mr[c++]=null;var x=Mr[c];Mr[c++]=null;var k=Mr[c];Mr[c++]=null;var N=Mr[c];if(Mr[c++]=null,x!==null&&k!==null){var D=x.pending;D===null?k.next=k:(k.next=D.next,D.next=k),x.pending=k}N!==0&&K1(h,k,N)}}function Nd(a,c,h,x){Mr[Po++]=a,Mr[Po++]=c,Mr[Po++]=h,Mr[Po++]=x,Og|=x,a.lanes|=x,a=a.alternate,a!==null&&(a.lanes|=x)}function Dg(a,c,h,x){return Nd(a,c,h,x),Td(a)}function va(a,c){return Nd(a,null,null,c),Td(a)}function K1(a,c,h){a.lanes|=h;var x=a.alternate;x!==null&&(x.lanes|=h);for(var k=!1,N=a.return;N!==null;)N.childLanes|=h,x=N.alternate,x!==null&&(x.childLanes|=h),N.tag===22&&(a=N.stateNode,a===null||a._visibility&1||(k=!0)),a=N,N=N.return;return a.tag===3?(N=a.stateNode,k&&c!==null&&(k=31-Nt(h),a=N.hiddenUpdates,x=a[k],x===null?a[k]=[c]:x.push(c),c.lane=h|536870912),N):null}function Td(a){if(50<zc)throw zc=0,qm=null,Error(r(185));for(var c=a.return;c!==null;)a=c,c=a.return;return a.tag===3?a.stateNode:null}var Bo={};function BR(a,c,h,x){this.tag=a,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dr(a,c,h,x){return new BR(a,c,h,x)}function Ig(a){return a=a.prototype,!(!a||!a.isReactComponent)}function zs(a,c){var h=a.alternate;return h===null?(h=dr(a.tag,c,a.key,a.mode),h.elementType=a.elementType,h.type=a.type,h.stateNode=a.stateNode,h.alternate=a,a.alternate=h):(h.pendingProps=c,h.type=a.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=a.flags&65011712,h.childLanes=a.childLanes,h.lanes=a.lanes,h.child=a.child,h.memoizedProps=a.memoizedProps,h.memoizedState=a.memoizedState,h.updateQueue=a.updateQueue,c=a.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=a.sibling,h.index=a.index,h.ref=a.ref,h.refCleanup=a.refCleanup,h}function Q1(a,c){a.flags&=65011714;var h=a.alternate;return h===null?(a.childLanes=0,a.lanes=c,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=h.childLanes,a.lanes=h.lanes,a.child=h.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=h.memoizedProps,a.memoizedState=h.memoizedState,a.updateQueue=h.updateQueue,a.type=h.type,c=h.dependencies,a.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),a}function jd(a,c,h,x,k,N){var D=0;if(x=a,typeof a=="function")Ig(a)&&(D=1);else if(typeof a=="string")D=H_(a,h,Z.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case A:return a=dr(31,h,c,k),a.elementType=A,a.lanes=N,a;case v:return wa(h.children,k,N,c);case w:D=8,k|=24;break;case S:return a=dr(12,h,c,k|2),a.elementType=S,a.lanes=N,a;case _:return a=dr(13,h,c,k),a.elementType=_,a.lanes=N,a;case R:return a=dr(19,h,c,k),a.elementType=R,a.lanes=N,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case j:D=10;break e;case T:D=9;break e;case M:D=11;break e;case O:D=14;break e;case L:D=16,x=null;break e}D=29,h=Error(r(130,a===null?"null":typeof a,"")),x=null}return c=dr(D,h,c,k),c.elementType=a,c.type=x,c.lanes=N,c}function wa(a,c,h,x){return a=dr(7,a,x,c),a.lanes=h,a}function Lg(a,c,h){return a=dr(6,a,null,c),a.lanes=h,a}function W1(a){var c=dr(18,null,null,0);return c.stateNode=a,c}function zg(a,c,h){return c=dr(4,a.children!==null?a.children:[],a.key,c),c.lanes=h,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}var Y1=new WeakMap;function Ar(a,c){if(typeof a=="object"&&a!==null){var h=Y1.get(a);return h!==void 0?h:(c={value:a,source:c,stack:Q(c)},Y1.set(a,c),c)}return{value:a,source:c,stack:Q(c)}}var Fo=[],Uo=0,Ed=null,mc=0,Rr=[],_r=0,bi=null,hs=1,ps="";function Ps(a,c){Fo[Uo++]=mc,Fo[Uo++]=Ed,Ed=a,mc=c}function G1(a,c,h){Rr[_r++]=hs,Rr[_r++]=ps,Rr[_r++]=bi,bi=a;var x=hs;a=ps;var k=32-Nt(x)-1;x&=~(1<<k),h+=1;var N=32-Nt(c)+k;if(30<N){var D=k-k%5;N=(x&(1<<D)-1).toString(32),x>>=D,k-=D,hs=1<<32-Nt(c)+k|h<<k|x,ps=N+a}else hs=1<<N|h<<k|x,ps=a}function Pg(a){a.return!==null&&(Ps(a,1),G1(a,1,0))}function Bg(a){for(;a===Ed;)Ed=Fo[--Uo],Fo[Uo]=null,mc=Fo[--Uo],Fo[Uo]=null;for(;a===bi;)bi=Rr[--_r],Rr[_r]=null,ps=Rr[--_r],Rr[_r]=null,hs=Rr[--_r],Rr[_r]=null}function X1(a,c){Rr[_r++]=hs,Rr[_r++]=ps,Rr[_r++]=bi,hs=c.id,ps=c.overflow,bi=a}var gn=null,jt=null,rt=!1,vi=null,Or=!1,Fg=Error(r(519));function wi(a){var c=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw yc(Ar(c,a)),Fg}function J1(a){var c=a.stateNode,h=a.type,x=a.memoizedProps;switch(c[pn]=a,c[Wn]=x,h){case"dialog":Je("cancel",c),Je("close",c);break;case"iframe":case"object":case"embed":Je("load",c);break;case"video":case"audio":for(h=0;h<Bc.length;h++)Je(Bc[h],c);break;case"source":Je("error",c);break;case"img":case"image":case"link":Je("error",c),Je("load",c);break;case"details":Je("toggle",c);break;case"input":Je("invalid",c),d1(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0);break;case"select":Je("invalid",c);break;case"textarea":Je("invalid",c),h1(c,x.value,x.defaultValue,x.children)}h=x.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||c.textContent===""+h||x.suppressHydrationWarning===!0||gk(c.textContent,h)?(x.popover!=null&&(Je("beforetoggle",c),Je("toggle",c)),x.onScroll!=null&&Je("scroll",c),x.onScrollEnd!=null&&Je("scrollend",c),x.onClick!=null&&(c.onclick=Is),c=!0):c=!1,c||wi(a,!0)}function Z1(a){for(gn=a.return;gn;)switch(gn.tag){case 5:case 31:case 13:Or=!1;return;case 27:case 3:Or=!0;return;default:gn=gn.return}}function $o(a){if(a!==gn)return!1;if(!rt)return Z1(a),rt=!0,!1;var c=a.tag,h;if((h=c!==3&&c!==27)&&((h=c===5)&&(h=a.type,h=!(h!=="form"&&h!=="button")||s0(a.type,a.memoizedProps)),h=!h),h&&jt&&wi(a),Z1(a),c===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));jt=Ck(a)}else if(c===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));jt=Ck(a)}else c===27?(c=jt,Ii(a.type)?(a=c0,c0=null,jt=a):jt=c):jt=gn?Ir(a.stateNode.nextSibling):null;return!0}function Sa(){jt=gn=null,rt=!1}function Ug(){var a=vi;return a!==null&&(Zn===null?Zn=a:Zn.push.apply(Zn,a),vi=null),a}function yc(a){vi===null?vi=[a]:vi.push(a)}var $g=I(null),ka=null,Bs=null;function Si(a,c,h){te($g,c._currentValue),c._currentValue=h}function Fs(a){a._currentValue=$g.current,U($g)}function qg(a,c,h){for(;a!==null;){var x=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),a===h)break;a=a.return}}function Hg(a,c,h,x){var k=a.child;for(k!==null&&(k.return=a);k!==null;){var N=k.dependencies;if(N!==null){var D=k.child;N=N.firstContext;e:for(;N!==null;){var $=N;N=k;for(var G=0;G<c.length;G++)if($.context===c[G]){N.lanes|=h,$=N.alternate,$!==null&&($.lanes|=h),qg(N.return,h,a),x||(D=null);break e}N=$.next}}else if(k.tag===18){if(D=k.return,D===null)throw Error(r(341));D.lanes|=h,N=D.alternate,N!==null&&(N.lanes|=h),qg(D,h,a),D=null}else D=k.child;if(D!==null)D.return=k;else for(D=k;D!==null;){if(D===a){D=null;break}if(k=D.sibling,k!==null){k.return=D.return,D=k;break}D=D.return}k=D}}function qo(a,c,h,x){a=null;for(var k=c,N=!1;k!==null;){if(!N){if((k.flags&524288)!==0)N=!0;else if((k.flags&262144)!==0)break}if(k.tag===10){var D=k.alternate;if(D===null)throw Error(r(387));if(D=D.memoizedProps,D!==null){var $=k.type;ur(k.pendingProps.value,D.value)||(a!==null?a.push($):a=[$])}}else if(k===ge.current){if(D=k.alternate,D===null)throw Error(r(387));D.memoizedState.memoizedState!==k.memoizedState.memoizedState&&(a!==null?a.push(Hc):a=[Hc])}k=k.return}a!==null&&Hg(c,a,h,x),c.flags|=262144}function Md(a){for(a=a.firstContext;a!==null;){if(!ur(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Ca(a){ka=a,Bs=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function mn(a){return ew(ka,a)}function Ad(a,c){return ka===null&&Ca(a),ew(a,c)}function ew(a,c){var h=c._currentValue;if(c={context:c,memoizedValue:h,next:null},Bs===null){if(a===null)throw Error(r(308));Bs=c,a.dependencies={lanes:0,firstContext:c},a.flags|=524288}else Bs=Bs.next=c;return h}var FR=typeof AbortController<"u"?AbortController:function(){var a=[],c=this.signal={aborted:!1,addEventListener:function(h,x){a.push(x)}};this.abort=function(){c.aborted=!0,a.forEach(function(h){return h()})}},UR=t.unstable_scheduleCallback,$R=t.unstable_NormalPriority,Ht={$$typeof:j,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vg(){return{controller:new FR,data:new Map,refCount:0}}function xc(a){a.refCount--,a.refCount===0&&UR($R,function(){a.controller.abort()})}var bc=null,Kg=0,Ho=0,Vo=null;function qR(a,c){if(bc===null){var h=bc=[];Kg=0,Ho=Ym(),Vo={status:"pending",value:void 0,then:function(x){h.push(x)}}}return Kg++,c.then(tw,tw),c}function tw(){if(--Kg===0&&bc!==null){Vo!==null&&(Vo.status="fulfilled");var a=bc;bc=null,Ho=0,Vo=null;for(var c=0;c<a.length;c++)(0,a[c])()}}function HR(a,c){var h=[],x={status:"pending",value:null,reason:null,then:function(k){h.push(k)}};return a.then(function(){x.status="fulfilled",x.value=c;for(var k=0;k<h.length;k++)(0,h[k])(c)},function(k){for(x.status="rejected",x.reason=k,k=0;k<h.length;k++)(0,h[k])(void 0)}),x}var nw=q.S;q.S=function(a,c){BS=Ce(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&qR(a,c),nw!==null&&nw(a,c)};var Na=I(null);function Qg(){var a=Na.current;return a!==null?a:wt.pooledCache}function Rd(a,c){c===null?te(Na,Na.current):te(Na,c.pool)}function rw(){var a=Qg();return a===null?null:{parent:Ht._currentValue,pool:a}}var Ko=Error(r(460)),Wg=Error(r(474)),_d=Error(r(542)),Od={then:function(){}};function sw(a){return a=a.status,a==="fulfilled"||a==="rejected"}function iw(a,c,h){switch(h=a[h],h===void 0?a.push(c):h!==c&&(c.then(Is,Is),c=h),c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,ow(a),a;default:if(typeof c.status=="string")c.then(Is,Is);else{if(a=wt,a!==null&&100<a.shellSuspendCounter)throw Error(r(482));a=c,a.status="pending",a.then(function(x){if(c.status==="pending"){var k=c;k.status="fulfilled",k.value=x}},function(x){if(c.status==="pending"){var k=c;k.status="rejected",k.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,ow(a),a}throw ja=c,Ko}}function Ta(a){try{var c=a._init;return c(a._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(ja=h,Ko):h}}var ja=null;function aw(){if(ja===null)throw Error(r(459));var a=ja;return ja=null,a}function ow(a){if(a===Ko||a===_d)throw Error(r(483))}var Qo=null,vc=0;function Dd(a){var c=vc;return vc+=1,Qo===null&&(Qo=[]),iw(Qo,a,c)}function wc(a,c){c=c.props.ref,a.ref=c!==void 0?c:null}function Id(a,c){throw c.$$typeof===y?Error(r(525)):(a=Object.prototype.toString.call(c),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a)))}function lw(a){function c(ne,J){if(a){var oe=ne.deletions;oe===null?(ne.deletions=[J],ne.flags|=16):oe.push(J)}}function h(ne,J){if(!a)return null;for(;J!==null;)c(ne,J),J=J.sibling;return null}function x(ne){for(var J=new Map;ne!==null;)ne.key!==null?J.set(ne.key,ne):J.set(ne.index,ne),ne=ne.sibling;return J}function k(ne,J){return ne=zs(ne,J),ne.index=0,ne.sibling=null,ne}function N(ne,J,oe){return ne.index=oe,a?(oe=ne.alternate,oe!==null?(oe=oe.index,oe<J?(ne.flags|=67108866,J):oe):(ne.flags|=67108866,J)):(ne.flags|=1048576,J)}function D(ne){return a&&ne.alternate===null&&(ne.flags|=67108866),ne}function $(ne,J,oe,ye){return J===null||J.tag!==6?(J=Lg(oe,ne.mode,ye),J.return=ne,J):(J=k(J,oe),J.return=ne,J)}function G(ne,J,oe,ye){var ze=oe.type;return ze===v?he(ne,J,oe.props.children,ye,oe.key):J!==null&&(J.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===L&&Ta(ze)===J.type)?(J=k(J,oe.props),wc(J,oe),J.return=ne,J):(J=jd(oe.type,oe.key,oe.props,null,ne.mode,ye),wc(J,oe),J.return=ne,J)}function le(ne,J,oe,ye){return J===null||J.tag!==4||J.stateNode.containerInfo!==oe.containerInfo||J.stateNode.implementation!==oe.implementation?(J=zg(oe,ne.mode,ye),J.return=ne,J):(J=k(J,oe.children||[]),J.return=ne,J)}function he(ne,J,oe,ye,ze){return J===null||J.tag!==7?(J=wa(oe,ne.mode,ye,ze),J.return=ne,J):(J=k(J,oe),J.return=ne,J)}function ve(ne,J,oe){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return J=Lg(""+J,ne.mode,oe),J.return=ne,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case m:return oe=jd(J.type,J.key,J.props,null,ne.mode,oe),wc(oe,J),oe.return=ne,oe;case b:return J=zg(J,ne.mode,oe),J.return=ne,J;case L:return J=Ta(J),ve(ne,J,oe)}if(K(J)||P(J))return J=wa(J,ne.mode,oe,null),J.return=ne,J;if(typeof J.then=="function")return ve(ne,Dd(J),oe);if(J.$$typeof===j)return ve(ne,Ad(ne,J),oe);Id(ne,J)}return null}function ce(ne,J,oe,ye){var ze=J!==null?J.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return ze!==null?null:$(ne,J,""+oe,ye);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case m:return oe.key===ze?G(ne,J,oe,ye):null;case b:return oe.key===ze?le(ne,J,oe,ye):null;case L:return oe=Ta(oe),ce(ne,J,oe,ye)}if(K(oe)||P(oe))return ze!==null?null:he(ne,J,oe,ye,null);if(typeof oe.then=="function")return ce(ne,J,Dd(oe),ye);if(oe.$$typeof===j)return ce(ne,J,Ad(ne,oe),ye);Id(ne,oe)}return null}function de(ne,J,oe,ye,ze){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ne=ne.get(oe)||null,$(J,ne,""+ye,ze);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case m:return ne=ne.get(ye.key===null?oe:ye.key)||null,G(J,ne,ye,ze);case b:return ne=ne.get(ye.key===null?oe:ye.key)||null,le(J,ne,ye,ze);case L:return ye=Ta(ye),de(ne,J,oe,ye,ze)}if(K(ye)||P(ye))return ne=ne.get(oe)||null,he(J,ne,ye,ze,null);if(typeof ye.then=="function")return de(ne,J,oe,Dd(ye),ze);if(ye.$$typeof===j)return de(ne,J,oe,Ad(J,ye),ze);Id(J,ye)}return null}function Re(ne,J,oe,ye){for(var ze=null,at=null,_e=J,We=J=0,tt=null;_e!==null&&We<oe.length;We++){_e.index>We?(tt=_e,_e=null):tt=_e.sibling;var ot=ce(ne,_e,oe[We],ye);if(ot===null){_e===null&&(_e=tt);break}a&&_e&&ot.alternate===null&&c(ne,_e),J=N(ot,J,We),at===null?ze=ot:at.sibling=ot,at=ot,_e=tt}if(We===oe.length)return h(ne,_e),rt&&Ps(ne,We),ze;if(_e===null){for(;We<oe.length;We++)_e=ve(ne,oe[We],ye),_e!==null&&(J=N(_e,J,We),at===null?ze=_e:at.sibling=_e,at=_e);return rt&&Ps(ne,We),ze}for(_e=x(_e);We<oe.length;We++)tt=de(_e,ne,We,oe[We],ye),tt!==null&&(a&&tt.alternate!==null&&_e.delete(tt.key===null?We:tt.key),J=N(tt,J,We),at===null?ze=tt:at.sibling=tt,at=tt);return a&&_e.forEach(function(Fi){return c(ne,Fi)}),rt&&Ps(ne,We),ze}function Fe(ne,J,oe,ye){if(oe==null)throw Error(r(151));for(var ze=null,at=null,_e=J,We=J=0,tt=null,ot=oe.next();_e!==null&&!ot.done;We++,ot=oe.next()){_e.index>We?(tt=_e,_e=null):tt=_e.sibling;var Fi=ce(ne,_e,ot.value,ye);if(Fi===null){_e===null&&(_e=tt);break}a&&_e&&Fi.alternate===null&&c(ne,_e),J=N(Fi,J,We),at===null?ze=Fi:at.sibling=Fi,at=Fi,_e=tt}if(ot.done)return h(ne,_e),rt&&Ps(ne,We),ze;if(_e===null){for(;!ot.done;We++,ot=oe.next())ot=ve(ne,ot.value,ye),ot!==null&&(J=N(ot,J,We),at===null?ze=ot:at.sibling=ot,at=ot);return rt&&Ps(ne,We),ze}for(_e=x(_e);!ot.done;We++,ot=oe.next())ot=de(_e,ne,We,ot.value,ye),ot!==null&&(a&&ot.alternate!==null&&_e.delete(ot.key===null?We:ot.key),J=N(ot,J,We),at===null?ze=ot:at.sibling=ot,at=ot);return a&&_e.forEach(function(t4){return c(ne,t4)}),rt&&Ps(ne,We),ze}function bt(ne,J,oe,ye){if(typeof oe=="object"&&oe!==null&&oe.type===v&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case m:e:{for(var ze=oe.key;J!==null;){if(J.key===ze){if(ze=oe.type,ze===v){if(J.tag===7){h(ne,J.sibling),ye=k(J,oe.props.children),ye.return=ne,ne=ye;break e}}else if(J.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===L&&Ta(ze)===J.type){h(ne,J.sibling),ye=k(J,oe.props),wc(ye,oe),ye.return=ne,ne=ye;break e}h(ne,J);break}else c(ne,J);J=J.sibling}oe.type===v?(ye=wa(oe.props.children,ne.mode,ye,oe.key),ye.return=ne,ne=ye):(ye=jd(oe.type,oe.key,oe.props,null,ne.mode,ye),wc(ye,oe),ye.return=ne,ne=ye)}return D(ne);case b:e:{for(ze=oe.key;J!==null;){if(J.key===ze)if(J.tag===4&&J.stateNode.containerInfo===oe.containerInfo&&J.stateNode.implementation===oe.implementation){h(ne,J.sibling),ye=k(J,oe.children||[]),ye.return=ne,ne=ye;break e}else{h(ne,J);break}else c(ne,J);J=J.sibling}ye=zg(oe,ne.mode,ye),ye.return=ne,ne=ye}return D(ne);case L:return oe=Ta(oe),bt(ne,J,oe,ye)}if(K(oe))return Re(ne,J,oe,ye);if(P(oe)){if(ze=P(oe),typeof ze!="function")throw Error(r(150));return oe=ze.call(oe),Fe(ne,J,oe,ye)}if(typeof oe.then=="function")return bt(ne,J,Dd(oe),ye);if(oe.$$typeof===j)return bt(ne,J,Ad(ne,oe),ye);Id(ne,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,J!==null&&J.tag===6?(h(ne,J.sibling),ye=k(J,oe),ye.return=ne,ne=ye):(h(ne,J),ye=Lg(oe,ne.mode,ye),ye.return=ne,ne=ye),D(ne)):h(ne,J)}return function(ne,J,oe,ye){try{vc=0;var ze=bt(ne,J,oe,ye);return Qo=null,ze}catch(_e){if(_e===Ko||_e===_d)throw _e;var at=dr(29,_e,null,ne.mode);return at.lanes=ye,at.return=ne,at}finally{}}}var Ea=lw(!0),cw=lw(!1),ki=!1;function Yg(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gg(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Ci(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Ni(a,c,h){var x=a.updateQueue;if(x===null)return null;if(x=x.shared,(ct&2)!==0){var k=x.pending;return k===null?c.next=c:(c.next=k.next,k.next=c),x.pending=c,c=Td(a),K1(a,null,h),c}return Nd(a,x,c,h),Td(a)}function Sc(a,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194048)!==0)){var x=c.lanes;x&=a.pendingLanes,h|=x,c.lanes=h,cr(a,h)}}function Xg(a,c){var h=a.updateQueue,x=a.alternate;if(x!==null&&(x=x.updateQueue,h===x)){var k=null,N=null;if(h=h.firstBaseUpdate,h!==null){do{var D={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};N===null?k=N=D:N=N.next=D,h=h.next}while(h!==null);N===null?k=N=c:N=N.next=c}else k=N=c;h={baseState:x.baseState,firstBaseUpdate:k,lastBaseUpdate:N,shared:x.shared,callbacks:x.callbacks},a.updateQueue=h;return}a=h.lastBaseUpdate,a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=c}var Jg=!1;function kc(){if(Jg){var a=Vo;if(a!==null)throw a}}function Cc(a,c,h,x){Jg=!1;var k=a.updateQueue;ki=!1;var N=k.firstBaseUpdate,D=k.lastBaseUpdate,$=k.shared.pending;if($!==null){k.shared.pending=null;var G=$,le=G.next;G.next=null,D===null?N=le:D.next=le,D=G;var he=a.alternate;he!==null&&(he=he.updateQueue,$=he.lastBaseUpdate,$!==D&&($===null?he.firstBaseUpdate=le:$.next=le,he.lastBaseUpdate=G))}if(N!==null){var ve=k.baseState;D=0,he=le=G=null,$=N;do{var ce=$.lane&-536870913,de=ce!==$.lane;if(de?(et&ce)===ce:(x&ce)===ce){ce!==0&&ce===Ho&&(Jg=!0),he!==null&&(he=he.next={lane:0,tag:$.tag,payload:$.payload,callback:null,next:null});e:{var Re=a,Fe=$;ce=c;var bt=h;switch(Fe.tag){case 1:if(Re=Fe.payload,typeof Re=="function"){ve=Re.call(bt,ve,ce);break e}ve=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=Fe.payload,ce=typeof Re=="function"?Re.call(bt,ve,ce):Re,ce==null)break e;ve=g({},ve,ce);break e;case 2:ki=!0}}ce=$.callback,ce!==null&&(a.flags|=64,de&&(a.flags|=8192),de=k.callbacks,de===null?k.callbacks=[ce]:de.push(ce))}else de={lane:ce,tag:$.tag,payload:$.payload,callback:$.callback,next:null},he===null?(le=he=de,G=ve):he=he.next=de,D|=ce;if($=$.next,$===null){if($=k.shared.pending,$===null)break;de=$,$=de.next,de.next=null,k.lastBaseUpdate=de,k.shared.pending=null}}while(!0);he===null&&(G=ve),k.baseState=G,k.firstBaseUpdate=le,k.lastBaseUpdate=he,N===null&&(k.shared.lanes=0),Ai|=D,a.lanes=D,a.memoizedState=ve}}function uw(a,c){if(typeof a!="function")throw Error(r(191,a));a.call(c)}function dw(a,c){var h=a.callbacks;if(h!==null)for(a.callbacks=null,a=0;a<h.length;a++)uw(h[a],c)}var Wo=I(null),Ld=I(0);function fw(a,c){a=Ys,te(Ld,a),te(Wo,c),Ys=a|c.baseLanes}function Zg(){te(Ld,Ys),te(Wo,Wo.current)}function em(){Ys=Ld.current,U(Wo),U(Ld)}var fr=I(null),Dr=null;function Ti(a){var c=a.alternate;te(Ft,Ft.current&1),te(fr,a),Dr===null&&(c===null||Wo.current!==null||c.memoizedState!==null)&&(Dr=a)}function tm(a){te(Ft,Ft.current),te(fr,a),Dr===null&&(Dr=a)}function hw(a){a.tag===22?(te(Ft,Ft.current),te(fr,a),Dr===null&&(Dr=a)):ji()}function ji(){te(Ft,Ft.current),te(fr,fr.current)}function hr(a){U(fr),Dr===a&&(Dr=null),U(Ft)}var Ft=I(0);function zd(a){for(var c=a;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||o0(h)||l0(h)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Us=0,Ke=null,yt=null,Vt=null,Pd=!1,Yo=!1,Ma=!1,Bd=0,Nc=0,Go=null,VR=0;function Ot(){throw Error(r(321))}function nm(a,c){if(c===null)return!1;for(var h=0;h<c.length&&h<a.length;h++)if(!ur(a[h],c[h]))return!1;return!0}function rm(a,c,h,x,k,N){return Us=N,Ke=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,q.H=a===null||a.memoizedState===null?Gw:xm,Ma=!1,N=h(x,k),Ma=!1,Yo&&(N=gw(c,h,x,k)),pw(a),N}function pw(a){q.H=Ec;var c=yt!==null&&yt.next!==null;if(Us=0,Vt=yt=Ke=null,Pd=!1,Nc=0,Go=null,c)throw Error(r(300));a===null||Kt||(a=a.dependencies,a!==null&&Md(a)&&(Kt=!0))}function gw(a,c,h,x){Ke=a;var k=0;do{if(Yo&&(Go=null),Nc=0,Yo=!1,25<=k)throw Error(r(301));if(k+=1,Vt=yt=null,a.updateQueue!=null){var N=a.updateQueue;N.lastEffect=null,N.events=null,N.stores=null,N.memoCache!=null&&(N.memoCache.index=0)}q.H=Xw,N=c(h,x)}while(Yo);return N}function KR(){var a=q.H,c=a.useState()[0];return c=typeof c.then=="function"?Tc(c):c,a=a.useState()[0],(yt!==null?yt.memoizedState:null)!==a&&(Ke.flags|=1024),c}function sm(){var a=Bd!==0;return Bd=0,a}function im(a,c,h){c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~h}function am(a){if(Pd){for(a=a.memoizedState;a!==null;){var c=a.queue;c!==null&&(c.pending=null),a=a.next}Pd=!1}Us=0,Vt=yt=Ke=null,Yo=!1,Nc=Bd=0,Go=null}function On(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vt===null?Ke.memoizedState=Vt=a:Vt=Vt.next=a,Vt}function Ut(){if(yt===null){var a=Ke.alternate;a=a!==null?a.memoizedState:null}else a=yt.next;var c=Vt===null?Ke.memoizedState:Vt.next;if(c!==null)Vt=c,yt=a;else{if(a===null)throw Ke.alternate===null?Error(r(467)):Error(r(310));yt=a,a={memoizedState:yt.memoizedState,baseState:yt.baseState,baseQueue:yt.baseQueue,queue:yt.queue,next:null},Vt===null?Ke.memoizedState=Vt=a:Vt=Vt.next=a}return Vt}function Fd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Tc(a){var c=Nc;return Nc+=1,Go===null&&(Go=[]),a=iw(Go,a,c),c=Ke,(Vt===null?c.memoizedState:Vt.next)===null&&(c=c.alternate,q.H=c===null||c.memoizedState===null?Gw:xm),a}function Ud(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Tc(a);if(a.$$typeof===j)return mn(a)}throw Error(r(438,String(a)))}function om(a){var c=null,h=Ke.updateQueue;if(h!==null&&(c=h.memoCache),c==null){var x=Ke.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(k){return k.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),h===null&&(h=Fd(),Ke.updateQueue=h),h.memoCache=c,h=c.data[c.index],h===void 0)for(h=c.data[c.index]=Array(a),x=0;x<a;x++)h[x]=F;return c.index++,h}function $s(a,c){return typeof c=="function"?c(a):c}function $d(a){var c=Ut();return lm(c,yt,a)}function lm(a,c,h){var x=a.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=h;var k=a.baseQueue,N=x.pending;if(N!==null){if(k!==null){var D=k.next;k.next=N.next,N.next=D}c.baseQueue=k=N,x.pending=null}if(N=a.baseState,k===null)a.memoizedState=N;else{c=k.next;var $=D=null,G=null,le=c,he=!1;do{var ve=le.lane&-536870913;if(ve!==le.lane?(et&ve)===ve:(Us&ve)===ve){var ce=le.revertLane;if(ce===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),ve===Ho&&(he=!0);else if((Us&ce)===ce){le=le.next,ce===Ho&&(he=!0);continue}else ve={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},G===null?($=G=ve,D=N):G=G.next=ve,Ke.lanes|=ce,Ai|=ce;ve=le.action,Ma&&h(N,ve),N=le.hasEagerState?le.eagerState:h(N,ve)}else ce={lane:ve,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},G===null?($=G=ce,D=N):G=G.next=ce,Ke.lanes|=ve,Ai|=ve;le=le.next}while(le!==null&&le!==c);if(G===null?D=N:G.next=$,!ur(N,a.memoizedState)&&(Kt=!0,he&&(h=Vo,h!==null)))throw h;a.memoizedState=N,a.baseState=D,a.baseQueue=G,x.lastRenderedState=N}return k===null&&(x.lanes=0),[a.memoizedState,x.dispatch]}function cm(a){var c=Ut(),h=c.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=a;var x=h.dispatch,k=h.pending,N=c.memoizedState;if(k!==null){h.pending=null;var D=k=k.next;do N=a(N,D.action),D=D.next;while(D!==k);ur(N,c.memoizedState)||(Kt=!0),c.memoizedState=N,c.baseQueue===null&&(c.baseState=N),h.lastRenderedState=N}return[N,x]}function mw(a,c,h){var x=Ke,k=Ut(),N=rt;if(N){if(h===void 0)throw Error(r(407));h=h()}else h=c();var D=!ur((yt||k).memoizedState,h);if(D&&(k.memoizedState=h,Kt=!0),k=k.queue,fm(bw.bind(null,x,k,a),[a]),k.getSnapshot!==c||D||Vt!==null&&Vt.memoizedState.tag&1){if(x.flags|=2048,Xo(9,{destroy:void 0},xw.bind(null,x,k,h,c),null),wt===null)throw Error(r(349));N||(Us&127)!==0||yw(x,c,h)}return h}function yw(a,c,h){a.flags|=16384,a={getSnapshot:c,value:h},c=Ke.updateQueue,c===null?(c=Fd(),Ke.updateQueue=c,c.stores=[a]):(h=c.stores,h===null?c.stores=[a]:h.push(a))}function xw(a,c,h,x){c.value=h,c.getSnapshot=x,vw(c)&&ww(a)}function bw(a,c,h){return h(function(){vw(c)&&ww(a)})}function vw(a){var c=a.getSnapshot;a=a.value;try{var h=c();return!ur(a,h)}catch{return!0}}function ww(a){var c=va(a,2);c!==null&&er(c,a,2)}function um(a){var c=On();if(typeof a=="function"){var h=a;if(a=h(),Ma){Cn(!0);try{h()}finally{Cn(!1)}}}return c.memoizedState=c.baseState=a,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:a},c}function Sw(a,c,h,x){return a.baseState=h,lm(a,yt,typeof x=="function"?x:$s)}function QR(a,c,h,x,k){if(Vd(a))throw Error(r(485));if(a=c.action,a!==null){var N={payload:k,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(D){N.listeners.push(D)}};q.T!==null?h(!0):N.isTransition=!1,x(N),h=c.pending,h===null?(N.next=c.pending=N,kw(c,N)):(N.next=h.next,c.pending=h.next=N)}}function kw(a,c){var h=c.action,x=c.payload,k=a.state;if(c.isTransition){var N=q.T,D={};q.T=D;try{var $=h(k,x),G=q.S;G!==null&&G(D,$),Cw(a,c,$)}catch(le){dm(a,c,le)}finally{N!==null&&D.types!==null&&(N.types=D.types),q.T=N}}else try{N=h(k,x),Cw(a,c,N)}catch(le){dm(a,c,le)}}function Cw(a,c,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(x){Nw(a,c,x)},function(x){return dm(a,c,x)}):Nw(a,c,h)}function Nw(a,c,h){c.status="fulfilled",c.value=h,Tw(c),a.state=h,c=a.pending,c!==null&&(h=c.next,h===c?a.pending=null:(h=h.next,c.next=h,kw(a,h)))}function dm(a,c,h){var x=a.pending;if(a.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=h,Tw(c),c=c.next;while(c!==x)}a.action=null}function Tw(a){a=a.listeners;for(var c=0;c<a.length;c++)(0,a[c])()}function jw(a,c){return c}function Ew(a,c){if(rt){var h=wt.formState;if(h!==null){e:{var x=Ke;if(rt){if(jt){t:{for(var k=jt,N=Or;k.nodeType!==8;){if(!N){k=null;break t}if(k=Ir(k.nextSibling),k===null){k=null;break t}}N=k.data,k=N==="F!"||N==="F"?k:null}if(k){jt=Ir(k.nextSibling),x=k.data==="F!";break e}}wi(x)}x=!1}x&&(c=h[0])}}return h=On(),h.memoizedState=h.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jw,lastRenderedState:c},h.queue=x,h=Qw.bind(null,Ke,x),x.dispatch=h,x=um(!1),N=ym.bind(null,Ke,!1,x.queue),x=On(),k={state:c,dispatch:null,action:a,pending:null},x.queue=k,h=QR.bind(null,Ke,k,N,h),k.dispatch=h,x.memoizedState=a,[c,h,!1]}function Mw(a){var c=Ut();return Aw(c,yt,a)}function Aw(a,c,h){if(c=lm(a,c,jw)[0],a=$d($s)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=Tc(c)}catch(D){throw D===Ko?_d:D}else x=c;c=Ut();var k=c.queue,N=k.dispatch;return h!==c.memoizedState&&(Ke.flags|=2048,Xo(9,{destroy:void 0},WR.bind(null,k,h),null)),[x,N,a]}function WR(a,c){a.action=c}function Rw(a){var c=Ut(),h=yt;if(h!==null)return Aw(c,h,a);Ut(),c=c.memoizedState,h=Ut();var x=h.queue.dispatch;return h.memoizedState=a,[c,x,!1]}function Xo(a,c,h,x){return a={tag:a,create:h,deps:x,inst:c,next:null},c=Ke.updateQueue,c===null&&(c=Fd(),Ke.updateQueue=c),h=c.lastEffect,h===null?c.lastEffect=a.next=a:(x=h.next,h.next=a,a.next=x,c.lastEffect=a),a}function _w(){return Ut().memoizedState}function qd(a,c,h,x){var k=On();Ke.flags|=a,k.memoizedState=Xo(1|c,{destroy:void 0},h,x===void 0?null:x)}function Hd(a,c,h,x){var k=Ut();x=x===void 0?null:x;var N=k.memoizedState.inst;yt!==null&&x!==null&&nm(x,yt.memoizedState.deps)?k.memoizedState=Xo(c,N,h,x):(Ke.flags|=a,k.memoizedState=Xo(1|c,N,h,x))}function Ow(a,c){qd(8390656,8,a,c)}function fm(a,c){Hd(2048,8,a,c)}function YR(a){Ke.flags|=4;var c=Ke.updateQueue;if(c===null)c=Fd(),Ke.updateQueue=c,c.events=[a];else{var h=c.events;h===null?c.events=[a]:h.push(a)}}function Dw(a){var c=Ut().memoizedState;return YR({ref:c,nextImpl:a}),function(){if((ct&2)!==0)throw Error(r(440));return c.impl.apply(void 0,arguments)}}function Iw(a,c){return Hd(4,2,a,c)}function Lw(a,c){return Hd(4,4,a,c)}function zw(a,c){if(typeof c=="function"){a=a();var h=c(a);return function(){typeof h=="function"?h():c(null)}}if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function Pw(a,c,h){h=h!=null?h.concat([a]):null,Hd(4,4,zw.bind(null,c,a),h)}function hm(){}function Bw(a,c){var h=Ut();c=c===void 0?null:c;var x=h.memoizedState;return c!==null&&nm(c,x[1])?x[0]:(h.memoizedState=[a,c],a)}function Fw(a,c){var h=Ut();c=c===void 0?null:c;var x=h.memoizedState;if(c!==null&&nm(c,x[1]))return x[0];if(x=a(),Ma){Cn(!0);try{a()}finally{Cn(!1)}}return h.memoizedState=[x,c],x}function pm(a,c,h){return h===void 0||(Us&1073741824)!==0&&(et&261930)===0?a.memoizedState=c:(a.memoizedState=h,a=US(),Ke.lanes|=a,Ai|=a,h)}function Uw(a,c,h,x){return ur(h,c)?h:Wo.current!==null?(a=pm(a,h,x),ur(a,c)||(Kt=!0),a):(Us&42)===0||(Us&1073741824)!==0&&(et&261930)===0?(Kt=!0,a.memoizedState=h):(a=US(),Ke.lanes|=a,Ai|=a,c)}function $w(a,c,h,x,k){var N=V.p;V.p=N!==0&&8>N?N:8;var D=q.T,$={};q.T=$,ym(a,!1,c,h);try{var G=k(),le=q.S;if(le!==null&&le($,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var he=HR(G,x);jc(a,c,he,mr(a))}else jc(a,c,x,mr(a))}catch(ve){jc(a,c,{then:function(){},status:"rejected",reason:ve},mr())}finally{V.p=N,D!==null&&$.types!==null&&(D.types=$.types),q.T=D}}function GR(){}function gm(a,c,h,x){if(a.tag!==5)throw Error(r(476));var k=qw(a).queue;$w(a,k,c,ie,h===null?GR:function(){return Hw(a),h(x)})}function qw(a){var c=a.memoizedState;if(c!==null)return c;c={memoizedState:ie,baseState:ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:ie},next:null};var h={};return c.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:h},next:null},a.memoizedState=c,a=a.alternate,a!==null&&(a.memoizedState=c),c}function Hw(a){var c=qw(a);c.next===null&&(c=a.alternate.memoizedState),jc(a,c.next.queue,{},mr())}function mm(){return mn(Hc)}function Vw(){return Ut().memoizedState}function Kw(){return Ut().memoizedState}function XR(a){for(var c=a.return;c!==null;){switch(c.tag){case 24:case 3:var h=mr();a=Ci(h);var x=Ni(c,a,h);x!==null&&(er(x,c,h),Sc(x,c,h)),c={cache:Vg()},a.payload=c;return}c=c.return}}function JR(a,c,h){var x=mr();h={lane:x,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Vd(a)?Ww(c,h):(h=Dg(a,c,h,x),h!==null&&(er(h,a,x),Yw(h,c,x)))}function Qw(a,c,h){var x=mr();jc(a,c,h,x)}function jc(a,c,h,x){var k={lane:x,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(Vd(a))Ww(c,k);else{var N=a.alternate;if(a.lanes===0&&(N===null||N.lanes===0)&&(N=c.lastRenderedReducer,N!==null))try{var D=c.lastRenderedState,$=N(D,h);if(k.hasEagerState=!0,k.eagerState=$,ur($,D))return Nd(a,c,k,0),wt===null&&Cd(),!1}catch{}finally{}if(h=Dg(a,c,k,x),h!==null)return er(h,a,x),Yw(h,c,x),!0}return!1}function ym(a,c,h,x){if(x={lane:2,revertLane:Ym(),gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null},Vd(a)){if(c)throw Error(r(479))}else c=Dg(a,h,x,2),c!==null&&er(c,a,2)}function Vd(a){var c=a.alternate;return a===Ke||c!==null&&c===Ke}function Ww(a,c){Yo=Pd=!0;var h=a.pending;h===null?c.next=c:(c.next=h.next,h.next=c),a.pending=c}function Yw(a,c,h){if((h&4194048)!==0){var x=c.lanes;x&=a.pendingLanes,h|=x,c.lanes=h,cr(a,h)}}var Ec={readContext:mn,use:Ud,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useLayoutEffect:Ot,useInsertionEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useSyncExternalStore:Ot,useId:Ot,useHostTransitionStatus:Ot,useFormState:Ot,useActionState:Ot,useOptimistic:Ot,useMemoCache:Ot,useCacheRefresh:Ot};Ec.useEffectEvent=Ot;var Gw={readContext:mn,use:Ud,useCallback:function(a,c){return On().memoizedState=[a,c===void 0?null:c],a},useContext:mn,useEffect:Ow,useImperativeHandle:function(a,c,h){h=h!=null?h.concat([a]):null,qd(4194308,4,zw.bind(null,c,a),h)},useLayoutEffect:function(a,c){return qd(4194308,4,a,c)},useInsertionEffect:function(a,c){qd(4,2,a,c)},useMemo:function(a,c){var h=On();c=c===void 0?null:c;var x=a();if(Ma){Cn(!0);try{a()}finally{Cn(!1)}}return h.memoizedState=[x,c],x},useReducer:function(a,c,h){var x=On();if(h!==void 0){var k=h(c);if(Ma){Cn(!0);try{h(c)}finally{Cn(!1)}}}else k=c;return x.memoizedState=x.baseState=k,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:k},x.queue=a,a=a.dispatch=JR.bind(null,Ke,a),[x.memoizedState,a]},useRef:function(a){var c=On();return a={current:a},c.memoizedState=a},useState:function(a){a=um(a);var c=a.queue,h=Qw.bind(null,Ke,c);return c.dispatch=h,[a.memoizedState,h]},useDebugValue:hm,useDeferredValue:function(a,c){var h=On();return pm(h,a,c)},useTransition:function(){var a=um(!1);return a=$w.bind(null,Ke,a.queue,!0,!1),On().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,c,h){var x=Ke,k=On();if(rt){if(h===void 0)throw Error(r(407));h=h()}else{if(h=c(),wt===null)throw Error(r(349));(et&127)!==0||yw(x,c,h)}k.memoizedState=h;var N={value:h,getSnapshot:c};return k.queue=N,Ow(bw.bind(null,x,N,a),[a]),x.flags|=2048,Xo(9,{destroy:void 0},xw.bind(null,x,N,h,c),null),h},useId:function(){var a=On(),c=wt.identifierPrefix;if(rt){var h=ps,x=hs;h=(x&~(1<<32-Nt(x)-1)).toString(32)+h,c="_"+c+"R_"+h,h=Bd++,0<h&&(c+="H"+h.toString(32)),c+="_"}else h=VR++,c="_"+c+"r_"+h.toString(32)+"_";return a.memoizedState=c},useHostTransitionStatus:mm,useFormState:Ew,useActionState:Ew,useOptimistic:function(a){var c=On();c.memoizedState=c.baseState=a;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=h,c=ym.bind(null,Ke,!0,h),h.dispatch=c,[a,c]},useMemoCache:om,useCacheRefresh:function(){return On().memoizedState=XR.bind(null,Ke)},useEffectEvent:function(a){var c=On(),h={impl:a};return c.memoizedState=h,function(){if((ct&2)!==0)throw Error(r(440));return h.impl.apply(void 0,arguments)}}},xm={readContext:mn,use:Ud,useCallback:Bw,useContext:mn,useEffect:fm,useImperativeHandle:Pw,useInsertionEffect:Iw,useLayoutEffect:Lw,useMemo:Fw,useReducer:$d,useRef:_w,useState:function(){return $d($s)},useDebugValue:hm,useDeferredValue:function(a,c){var h=Ut();return Uw(h,yt.memoizedState,a,c)},useTransition:function(){var a=$d($s)[0],c=Ut().memoizedState;return[typeof a=="boolean"?a:Tc(a),c]},useSyncExternalStore:mw,useId:Vw,useHostTransitionStatus:mm,useFormState:Mw,useActionState:Mw,useOptimistic:function(a,c){var h=Ut();return Sw(h,yt,a,c)},useMemoCache:om,useCacheRefresh:Kw};xm.useEffectEvent=Dw;var Xw={readContext:mn,use:Ud,useCallback:Bw,useContext:mn,useEffect:fm,useImperativeHandle:Pw,useInsertionEffect:Iw,useLayoutEffect:Lw,useMemo:Fw,useReducer:cm,useRef:_w,useState:function(){return cm($s)},useDebugValue:hm,useDeferredValue:function(a,c){var h=Ut();return yt===null?pm(h,a,c):Uw(h,yt.memoizedState,a,c)},useTransition:function(){var a=cm($s)[0],c=Ut().memoizedState;return[typeof a=="boolean"?a:Tc(a),c]},useSyncExternalStore:mw,useId:Vw,useHostTransitionStatus:mm,useFormState:Rw,useActionState:Rw,useOptimistic:function(a,c){var h=Ut();return yt!==null?Sw(h,yt,a,c):(h.baseState=a,[a,h.queue.dispatch])},useMemoCache:om,useCacheRefresh:Kw};Xw.useEffectEvent=Dw;function bm(a,c,h,x){c=a.memoizedState,h=h(x,c),h=h==null?c:g({},c,h),a.memoizedState=h,a.lanes===0&&(a.updateQueue.baseState=h)}var vm={enqueueSetState:function(a,c,h){a=a._reactInternals;var x=mr(),k=Ci(x);k.payload=c,h!=null&&(k.callback=h),c=Ni(a,k,x),c!==null&&(er(c,a,x),Sc(c,a,x))},enqueueReplaceState:function(a,c,h){a=a._reactInternals;var x=mr(),k=Ci(x);k.tag=1,k.payload=c,h!=null&&(k.callback=h),c=Ni(a,k,x),c!==null&&(er(c,a,x),Sc(c,a,x))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var h=mr(),x=Ci(h);x.tag=2,c!=null&&(x.callback=c),c=Ni(a,x,h),c!==null&&(er(c,a,h),Sc(c,a,h))}};function Jw(a,c,h,x,k,N,D){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(x,N,D):c.prototype&&c.prototype.isPureReactComponent?!pc(h,x)||!pc(k,N):!0}function Zw(a,c,h,x){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,x),c.state!==a&&vm.enqueueReplaceState(c,c.state,null)}function Aa(a,c){var h=c;if("ref"in c){h={};for(var x in c)x!=="ref"&&(h[x]=c[x])}if(a=a.defaultProps){h===c&&(h=g({},h));for(var k in a)h[k]===void 0&&(h[k]=a[k])}return h}function eS(a){kd(a)}function tS(a){console.error(a)}function nS(a){kd(a)}function Kd(a,c){try{var h=a.onUncaughtError;h(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function rS(a,c,h){try{var x=a.onCaughtError;x(h.value,{componentStack:h.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(k){setTimeout(function(){throw k})}}function wm(a,c,h){return h=Ci(h),h.tag=3,h.payload={element:null},h.callback=function(){Kd(a,c)},h}function sS(a){return a=Ci(a),a.tag=3,a}function iS(a,c,h,x){var k=h.type.getDerivedStateFromError;if(typeof k=="function"){var N=x.value;a.payload=function(){return k(N)},a.callback=function(){rS(c,h,x)}}var D=h.stateNode;D!==null&&typeof D.componentDidCatch=="function"&&(a.callback=function(){rS(c,h,x),typeof k!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var $=x.stack;this.componentDidCatch(x.value,{componentStack:$!==null?$:""})})}function ZR(a,c,h,x,k){if(h.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=h.alternate,c!==null&&qo(c,h,k,!0),h=fr.current,h!==null){switch(h.tag){case 31:case 13:return Dr===null?sf():h.alternate===null&&Dt===0&&(Dt=3),h.flags&=-257,h.flags|=65536,h.lanes=k,x===Od?h.flags|=16384:(c=h.updateQueue,c===null?h.updateQueue=new Set([x]):c.add(x),Km(a,x,k)),!1;case 22:return h.flags|=65536,x===Od?h.flags|=16384:(c=h.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},h.updateQueue=c):(h=c.retryQueue,h===null?c.retryQueue=new Set([x]):h.add(x)),Km(a,x,k)),!1}throw Error(r(435,h.tag))}return Km(a,x,k),sf(),!1}if(rt)return c=fr.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=k,x!==Fg&&(a=Error(r(422),{cause:x}),yc(Ar(a,h)))):(x!==Fg&&(c=Error(r(423),{cause:x}),yc(Ar(c,h))),a=a.current.alternate,a.flags|=65536,k&=-k,a.lanes|=k,x=Ar(x,h),k=wm(a.stateNode,x,k),Xg(a,k),Dt!==4&&(Dt=2)),!1;var N=Error(r(520),{cause:x});if(N=Ar(N,h),Lc===null?Lc=[N]:Lc.push(N),Dt!==4&&(Dt=2),c===null)return!0;x=Ar(x,h),h=c;do{switch(h.tag){case 3:return h.flags|=65536,a=k&-k,h.lanes|=a,a=wm(h.stateNode,x,a),Xg(h,a),!1;case 1:if(c=h.type,N=h.stateNode,(h.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(Ri===null||!Ri.has(N))))return h.flags|=65536,k&=-k,h.lanes|=k,k=sS(k),iS(k,a,h,x),Xg(h,k),!1}h=h.return}while(h!==null);return!1}var Sm=Error(r(461)),Kt=!1;function yn(a,c,h,x){c.child=a===null?cw(c,null,h,x):Ea(c,a.child,h,x)}function aS(a,c,h,x,k){h=h.render;var N=c.ref;if("ref"in x){var D={};for(var $ in x)$!=="ref"&&(D[$]=x[$])}else D=x;return Ca(c),x=rm(a,c,h,D,N,k),$=sm(),a!==null&&!Kt?(im(a,c,k),qs(a,c,k)):(rt&&$&&Pg(c),c.flags|=1,yn(a,c,x,k),c.child)}function oS(a,c,h,x,k){if(a===null){var N=h.type;return typeof N=="function"&&!Ig(N)&&N.defaultProps===void 0&&h.compare===null?(c.tag=15,c.type=N,lS(a,c,N,x,k)):(a=jd(h.type,null,x,c,c.mode,k),a.ref=c.ref,a.return=c,c.child=a)}if(N=a.child,!Am(a,k)){var D=N.memoizedProps;if(h=h.compare,h=h!==null?h:pc,h(D,x)&&a.ref===c.ref)return qs(a,c,k)}return c.flags|=1,a=zs(N,x),a.ref=c.ref,a.return=c,c.child=a}function lS(a,c,h,x,k){if(a!==null){var N=a.memoizedProps;if(pc(N,x)&&a.ref===c.ref)if(Kt=!1,c.pendingProps=x=N,Am(a,k))(a.flags&131072)!==0&&(Kt=!0);else return c.lanes=a.lanes,qs(a,c,k)}return km(a,c,h,x,k)}function cS(a,c,h,x){var k=x.children,N=a!==null?a.memoizedState:null;if(a===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),x.mode==="hidden"){if((c.flags&128)!==0){if(N=N!==null?N.baseLanes|h:h,a!==null){for(x=c.child=a.child,k=0;x!==null;)k=k|x.lanes|x.childLanes,x=x.sibling;x=k&~N}else x=0,c.child=null;return uS(a,c,N,h,x)}if((h&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},a!==null&&Rd(c,N!==null?N.cachePool:null),N!==null?fw(c,N):Zg(),hw(c);else return x=c.lanes=536870912,uS(a,c,N!==null?N.baseLanes|h:h,h,x)}else N!==null?(Rd(c,N.cachePool),fw(c,N),ji(),c.memoizedState=null):(a!==null&&Rd(c,null),Zg(),ji());return yn(a,c,k,h),c.child}function Mc(a,c){return a!==null&&a.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function uS(a,c,h,x,k){var N=Qg();return N=N===null?null:{parent:Ht._currentValue,pool:N},c.memoizedState={baseLanes:h,cachePool:N},a!==null&&Rd(c,null),Zg(),hw(c),a!==null&&qo(a,c,x,!0),c.childLanes=k,null}function Qd(a,c){return c=Yd({mode:c.mode,children:c.children},a.mode),c.ref=a.ref,a.child=c,c.return=a,c}function dS(a,c,h){return Ea(c,a.child,null,h),a=Qd(c,c.pendingProps),a.flags|=2,hr(c),c.memoizedState=null,a}function e_(a,c,h){var x=c.pendingProps,k=(c.flags&128)!==0;if(c.flags&=-129,a===null){if(rt){if(x.mode==="hidden")return a=Qd(c,x),c.lanes=536870912,Mc(null,a);if(tm(c),(a=jt)?(a=kk(a,Or),a=a!==null&&a.data==="&"?a:null,a!==null&&(c.memoizedState={dehydrated:a,treeContext:bi!==null?{id:hs,overflow:ps}:null,retryLane:536870912,hydrationErrors:null},h=W1(a),h.return=c,c.child=h,gn=c,jt=null)):a=null,a===null)throw wi(c);return c.lanes=536870912,null}return Qd(c,x)}var N=a.memoizedState;if(N!==null){var D=N.dehydrated;if(tm(c),k)if(c.flags&256)c.flags&=-257,c=dS(a,c,h);else if(c.memoizedState!==null)c.child=a.child,c.flags|=128,c=null;else throw Error(r(558));else if(Kt||qo(a,c,h,!1),k=(h&a.childLanes)!==0,Kt||k){if(x=wt,x!==null&&(D=Nr(x,h),D!==0&&D!==N.retryLane))throw N.retryLane=D,va(a,D),er(x,a,D),Sm;sf(),c=dS(a,c,h)}else a=N.treeContext,jt=Ir(D.nextSibling),gn=c,rt=!0,vi=null,Or=!1,a!==null&&X1(c,a),c=Qd(c,x),c.flags|=4096;return c}return a=zs(a.child,{mode:x.mode,children:x.children}),a.ref=c.ref,c.child=a,a.return=c,a}function Wd(a,c){var h=c.ref;if(h===null)a!==null&&a.ref!==null&&(c.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(r(284));(a===null||a.ref!==h)&&(c.flags|=4194816)}}function km(a,c,h,x,k){return Ca(c),h=rm(a,c,h,x,void 0,k),x=sm(),a!==null&&!Kt?(im(a,c,k),qs(a,c,k)):(rt&&x&&Pg(c),c.flags|=1,yn(a,c,h,k),c.child)}function fS(a,c,h,x,k,N){return Ca(c),c.updateQueue=null,h=gw(c,x,h,k),pw(a),x=sm(),a!==null&&!Kt?(im(a,c,N),qs(a,c,N)):(rt&&x&&Pg(c),c.flags|=1,yn(a,c,h,N),c.child)}function hS(a,c,h,x,k){if(Ca(c),c.stateNode===null){var N=Bo,D=h.contextType;typeof D=="object"&&D!==null&&(N=mn(D)),N=new h(x,N),c.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,N.updater=vm,c.stateNode=N,N._reactInternals=c,N=c.stateNode,N.props=x,N.state=c.memoizedState,N.refs={},Yg(c),D=h.contextType,N.context=typeof D=="object"&&D!==null?mn(D):Bo,N.state=c.memoizedState,D=h.getDerivedStateFromProps,typeof D=="function"&&(bm(c,h,D,x),N.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(D=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),D!==N.state&&vm.enqueueReplaceState(N,N.state,null),Cc(c,x,N,k),kc(),N.state=c.memoizedState),typeof N.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(a===null){N=c.stateNode;var $=c.memoizedProps,G=Aa(h,$);N.props=G;var le=N.context,he=h.contextType;D=Bo,typeof he=="object"&&he!==null&&(D=mn(he));var ve=h.getDerivedStateFromProps;he=typeof ve=="function"||typeof N.getSnapshotBeforeUpdate=="function",$=c.pendingProps!==$,he||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||($||le!==D)&&Zw(c,N,x,D),ki=!1;var ce=c.memoizedState;N.state=ce,Cc(c,x,N,k),kc(),le=c.memoizedState,$||ce!==le||ki?(typeof ve=="function"&&(bm(c,h,ve,x),le=c.memoizedState),(G=ki||Jw(c,h,G,x,ce,le,D))?(he||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(c.flags|=4194308)):(typeof N.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=le),N.props=x,N.state=le,N.context=D,x=G):(typeof N.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{N=c.stateNode,Gg(a,c),D=c.memoizedProps,he=Aa(h,D),N.props=he,ve=c.pendingProps,ce=N.context,le=h.contextType,G=Bo,typeof le=="object"&&le!==null&&(G=mn(le)),$=h.getDerivedStateFromProps,(le=typeof $=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(D!==ve||ce!==G)&&Zw(c,N,x,G),ki=!1,ce=c.memoizedState,N.state=ce,Cc(c,x,N,k),kc();var de=c.memoizedState;D!==ve||ce!==de||ki||a!==null&&a.dependencies!==null&&Md(a.dependencies)?(typeof $=="function"&&(bm(c,h,$,x),de=c.memoizedState),(he=ki||Jw(c,h,he,x,ce,de,G)||a!==null&&a.dependencies!==null&&Md(a.dependencies))?(le||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(x,de,G),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(x,de,G)),typeof N.componentDidUpdate=="function"&&(c.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof N.componentDidUpdate!="function"||D===a.memoizedProps&&ce===a.memoizedState||(c.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||D===a.memoizedProps&&ce===a.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=de),N.props=x,N.state=de,N.context=G,x=he):(typeof N.componentDidUpdate!="function"||D===a.memoizedProps&&ce===a.memoizedState||(c.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||D===a.memoizedProps&&ce===a.memoizedState||(c.flags|=1024),x=!1)}return N=x,Wd(a,c),x=(c.flags&128)!==0,N||x?(N=c.stateNode,h=x&&typeof h.getDerivedStateFromError!="function"?null:N.render(),c.flags|=1,a!==null&&x?(c.child=Ea(c,a.child,null,k),c.child=Ea(c,null,h,k)):yn(a,c,h,k),c.memoizedState=N.state,a=c.child):a=qs(a,c,k),a}function pS(a,c,h,x){return Sa(),c.flags|=256,yn(a,c,h,x),c.child}var Cm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Nm(a){return{baseLanes:a,cachePool:rw()}}function Tm(a,c,h){return a=a!==null?a.childLanes&~h:0,c&&(a|=gr),a}function gS(a,c,h){var x=c.pendingProps,k=!1,N=(c.flags&128)!==0,D;if((D=N)||(D=a!==null&&a.memoizedState===null?!1:(Ft.current&2)!==0),D&&(k=!0,c.flags&=-129),D=(c.flags&32)!==0,c.flags&=-33,a===null){if(rt){if(k?Ti(c):ji(),(a=jt)?(a=kk(a,Or),a=a!==null&&a.data!=="&"?a:null,a!==null&&(c.memoizedState={dehydrated:a,treeContext:bi!==null?{id:hs,overflow:ps}:null,retryLane:536870912,hydrationErrors:null},h=W1(a),h.return=c,c.child=h,gn=c,jt=null)):a=null,a===null)throw wi(c);return l0(a)?c.lanes=32:c.lanes=536870912,null}var $=x.children;return x=x.fallback,k?(ji(),k=c.mode,$=Yd({mode:"hidden",children:$},k),x=wa(x,k,h,null),$.return=c,x.return=c,$.sibling=x,c.child=$,x=c.child,x.memoizedState=Nm(h),x.childLanes=Tm(a,D,h),c.memoizedState=Cm,Mc(null,x)):(Ti(c),jm(c,$))}var G=a.memoizedState;if(G!==null&&($=G.dehydrated,$!==null)){if(N)c.flags&256?(Ti(c),c.flags&=-257,c=Em(a,c,h)):c.memoizedState!==null?(ji(),c.child=a.child,c.flags|=128,c=null):(ji(),$=x.fallback,k=c.mode,x=Yd({mode:"visible",children:x.children},k),$=wa($,k,h,null),$.flags|=2,x.return=c,$.return=c,x.sibling=$,c.child=x,Ea(c,a.child,null,h),x=c.child,x.memoizedState=Nm(h),x.childLanes=Tm(a,D,h),c.memoizedState=Cm,c=Mc(null,x));else if(Ti(c),l0($)){if(D=$.nextSibling&&$.nextSibling.dataset,D)var le=D.dgst;D=le,x=Error(r(419)),x.stack="",x.digest=D,yc({value:x,source:null,stack:null}),c=Em(a,c,h)}else if(Kt||qo(a,c,h,!1),D=(h&a.childLanes)!==0,Kt||D){if(D=wt,D!==null&&(x=Nr(D,h),x!==0&&x!==G.retryLane))throw G.retryLane=x,va(a,x),er(D,a,x),Sm;o0($)||sf(),c=Em(a,c,h)}else o0($)?(c.flags|=192,c.child=a.child,c=null):(a=G.treeContext,jt=Ir($.nextSibling),gn=c,rt=!0,vi=null,Or=!1,a!==null&&X1(c,a),c=jm(c,x.children),c.flags|=4096);return c}return k?(ji(),$=x.fallback,k=c.mode,G=a.child,le=G.sibling,x=zs(G,{mode:"hidden",children:x.children}),x.subtreeFlags=G.subtreeFlags&65011712,le!==null?$=zs(le,$):($=wa($,k,h,null),$.flags|=2),$.return=c,x.return=c,x.sibling=$,c.child=x,Mc(null,x),x=c.child,$=a.child.memoizedState,$===null?$=Nm(h):(k=$.cachePool,k!==null?(G=Ht._currentValue,k=k.parent!==G?{parent:G,pool:G}:k):k=rw(),$={baseLanes:$.baseLanes|h,cachePool:k}),x.memoizedState=$,x.childLanes=Tm(a,D,h),c.memoizedState=Cm,Mc(a.child,x)):(Ti(c),h=a.child,a=h.sibling,h=zs(h,{mode:"visible",children:x.children}),h.return=c,h.sibling=null,a!==null&&(D=c.deletions,D===null?(c.deletions=[a],c.flags|=16):D.push(a)),c.child=h,c.memoizedState=null,h)}function jm(a,c){return c=Yd({mode:"visible",children:c},a.mode),c.return=a,a.child=c}function Yd(a,c){return a=dr(22,a,null,c),a.lanes=0,a}function Em(a,c,h){return Ea(c,a.child,null,h),a=jm(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function mS(a,c,h){a.lanes|=c;var x=a.alternate;x!==null&&(x.lanes|=c),qg(a.return,c,h)}function Mm(a,c,h,x,k,N){var D=a.memoizedState;D===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:h,tailMode:k,treeForkCount:N}:(D.isBackwards=c,D.rendering=null,D.renderingStartTime=0,D.last=x,D.tail=h,D.tailMode=k,D.treeForkCount=N)}function yS(a,c,h){var x=c.pendingProps,k=x.revealOrder,N=x.tail;x=x.children;var D=Ft.current,$=(D&2)!==0;if($?(D=D&1|2,c.flags|=128):D&=1,te(Ft,D),yn(a,c,x,h),x=rt?mc:0,!$&&a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&mS(a,h,c);else if(a.tag===19)mS(a,h,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(k){case"forwards":for(h=c.child,k=null;h!==null;)a=h.alternate,a!==null&&zd(a)===null&&(k=h),h=h.sibling;h=k,h===null?(k=c.child,c.child=null):(k=h.sibling,h.sibling=null),Mm(c,!1,k,h,N,x);break;case"backwards":case"unstable_legacy-backwards":for(h=null,k=c.child,c.child=null;k!==null;){if(a=k.alternate,a!==null&&zd(a)===null){c.child=k;break}a=k.sibling,k.sibling=h,h=k,k=a}Mm(c,!0,h,null,N,x);break;case"together":Mm(c,!1,null,null,void 0,x);break;default:c.memoizedState=null}return c.child}function qs(a,c,h){if(a!==null&&(c.dependencies=a.dependencies),Ai|=c.lanes,(h&c.childLanes)===0)if(a!==null){if(qo(a,c,h,!1),(h&c.childLanes)===0)return null}else return null;if(a!==null&&c.child!==a.child)throw Error(r(153));if(c.child!==null){for(a=c.child,h=zs(a,a.pendingProps),c.child=h,h.return=c;a.sibling!==null;)a=a.sibling,h=h.sibling=zs(a,a.pendingProps),h.return=c;h.sibling=null}return c.child}function Am(a,c){return(a.lanes&c)!==0?!0:(a=a.dependencies,!!(a!==null&&Md(a)))}function t_(a,c,h){switch(c.tag){case 3:be(c,c.stateNode.containerInfo),Si(c,Ht,a.memoizedState.cache),Sa();break;case 27:case 5:Se(c);break;case 4:be(c,c.stateNode.containerInfo);break;case 10:Si(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,tm(c),null;break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(Ti(c),c.flags|=128,null):(h&c.child.childLanes)!==0?gS(a,c,h):(Ti(c),a=qs(a,c,h),a!==null?a.sibling:null);Ti(c);break;case 19:var k=(a.flags&128)!==0;if(x=(h&c.childLanes)!==0,x||(qo(a,c,h,!1),x=(h&c.childLanes)!==0),k){if(x)return yS(a,c,h);c.flags|=128}if(k=c.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),te(Ft,Ft.current),x)break;return null;case 22:return c.lanes=0,cS(a,c,h,c.pendingProps);case 24:Si(c,Ht,a.memoizedState.cache)}return qs(a,c,h)}function xS(a,c,h){if(a!==null)if(a.memoizedProps!==c.pendingProps)Kt=!0;else{if(!Am(a,h)&&(c.flags&128)===0)return Kt=!1,t_(a,c,h);Kt=(a.flags&131072)!==0}else Kt=!1,rt&&(c.flags&1048576)!==0&&G1(c,mc,c.index);switch(c.lanes=0,c.tag){case 16:e:{var x=c.pendingProps;if(a=Ta(c.elementType),c.type=a,typeof a=="function")Ig(a)?(x=Aa(a,x),c.tag=1,c=hS(null,c,a,x,h)):(c.tag=0,c=km(null,c,a,x,h));else{if(a!=null){var k=a.$$typeof;if(k===M){c.tag=11,c=aS(null,c,a,x,h);break e}else if(k===O){c.tag=14,c=oS(null,c,a,x,h);break e}}throw c=E(a)||a,Error(r(306,c,""))}}return c;case 0:return km(a,c,c.type,c.pendingProps,h);case 1:return x=c.type,k=Aa(x,c.pendingProps),hS(a,c,x,k,h);case 3:e:{if(be(c,c.stateNode.containerInfo),a===null)throw Error(r(387));x=c.pendingProps;var N=c.memoizedState;k=N.element,Gg(a,c),Cc(c,x,null,h);var D=c.memoizedState;if(x=D.cache,Si(c,Ht,x),x!==N.cache&&Hg(c,[Ht],h,!0),kc(),x=D.element,N.isDehydrated)if(N={element:x,isDehydrated:!1,cache:D.cache},c.updateQueue.baseState=N,c.memoizedState=N,c.flags&256){c=pS(a,c,x,h);break e}else if(x!==k){k=Ar(Error(r(424)),c),yc(k),c=pS(a,c,x,h);break e}else{switch(a=c.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(jt=Ir(a.firstChild),gn=c,rt=!0,vi=null,Or=!0,h=cw(c,null,x,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Sa(),x===k){c=qs(a,c,h);break e}yn(a,c,x,h)}c=c.child}return c;case 26:return Wd(a,c),a===null?(h=Mk(c.type,null,c.pendingProps,null))?c.memoizedState=h:rt||(h=c.type,a=c.pendingProps,x=ff(se.current).createElement(h),x[pn]=c,x[Wn]=a,xn(x,h,a),on(x),c.stateNode=x):c.memoizedState=Mk(c.type,a.memoizedProps,c.pendingProps,a.memoizedState),null;case 27:return Se(c),a===null&&rt&&(x=c.stateNode=Tk(c.type,c.pendingProps,se.current),gn=c,Or=!0,k=jt,Ii(c.type)?(c0=k,jt=Ir(x.firstChild)):jt=k),yn(a,c,c.pendingProps.children,h),Wd(a,c),a===null&&(c.flags|=4194304),c.child;case 5:return a===null&&rt&&((k=x=jt)&&(x=R_(x,c.type,c.pendingProps,Or),x!==null?(c.stateNode=x,gn=c,jt=Ir(x.firstChild),Or=!1,k=!0):k=!1),k||wi(c)),Se(c),k=c.type,N=c.pendingProps,D=a!==null?a.memoizedProps:null,x=N.children,s0(k,N)?x=null:D!==null&&s0(k,D)&&(c.flags|=32),c.memoizedState!==null&&(k=rm(a,c,KR,null,null,h),Hc._currentValue=k),Wd(a,c),yn(a,c,x,h),c.child;case 6:return a===null&&rt&&((a=h=jt)&&(h=__(h,c.pendingProps,Or),h!==null?(c.stateNode=h,gn=c,jt=null,a=!0):a=!1),a||wi(c)),null;case 13:return gS(a,c,h);case 4:return be(c,c.stateNode.containerInfo),x=c.pendingProps,a===null?c.child=Ea(c,null,x,h):yn(a,c,x,h),c.child;case 11:return aS(a,c,c.type,c.pendingProps,h);case 7:return yn(a,c,c.pendingProps,h),c.child;case 8:return yn(a,c,c.pendingProps.children,h),c.child;case 12:return yn(a,c,c.pendingProps.children,h),c.child;case 10:return x=c.pendingProps,Si(c,c.type,x.value),yn(a,c,x.children,h),c.child;case 9:return k=c.type._context,x=c.pendingProps.children,Ca(c),k=mn(k),x=x(k),c.flags|=1,yn(a,c,x,h),c.child;case 14:return oS(a,c,c.type,c.pendingProps,h);case 15:return lS(a,c,c.type,c.pendingProps,h);case 19:return yS(a,c,h);case 31:return e_(a,c,h);case 22:return cS(a,c,h,c.pendingProps);case 24:return Ca(c),x=mn(Ht),a===null?(k=Qg(),k===null&&(k=wt,N=Vg(),k.pooledCache=N,N.refCount++,N!==null&&(k.pooledCacheLanes|=h),k=N),c.memoizedState={parent:x,cache:k},Yg(c),Si(c,Ht,k)):((a.lanes&h)!==0&&(Gg(a,c),Cc(c,null,null,h),kc()),k=a.memoizedState,N=c.memoizedState,k.parent!==x?(k={parent:x,cache:x},c.memoizedState=k,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=k),Si(c,Ht,x)):(x=N.cache,Si(c,Ht,x),x!==k.cache&&Hg(c,[Ht],h,!0))),yn(a,c,c.pendingProps.children,h),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function Hs(a){a.flags|=4}function Rm(a,c,h,x,k){if((c=(a.mode&32)!==0)&&(c=!1),c){if(a.flags|=16777216,(k&335544128)===k)if(a.stateNode.complete)a.flags|=8192;else if(VS())a.flags|=8192;else throw ja=Od,Wg}else a.flags&=-16777217}function bS(a,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!Dk(c))if(VS())a.flags|=8192;else throw ja=Od,Wg}function Gd(a,c){c!==null&&(a.flags|=4),a.flags&16384&&(c=a.tag!==22?Nn():536870912,a.lanes|=c,tl|=c)}function Ac(a,c){if(!rt)switch(a.tailMode){case"hidden":c=a.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?a.tail=null:h.sibling=null;break;case"collapsed":h=a.tail;for(var x=null;h!==null;)h.alternate!==null&&(x=h),h=h.sibling;x===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:x.sibling=null}}function Et(a){var c=a.alternate!==null&&a.alternate.child===a.child,h=0,x=0;if(c)for(var k=a.child;k!==null;)h|=k.lanes|k.childLanes,x|=k.subtreeFlags&65011712,x|=k.flags&65011712,k.return=a,k=k.sibling;else for(k=a.child;k!==null;)h|=k.lanes|k.childLanes,x|=k.subtreeFlags,x|=k.flags,k.return=a,k=k.sibling;return a.subtreeFlags|=x,a.childLanes=h,c}function n_(a,c,h){var x=c.pendingProps;switch(Bg(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(c),null;case 1:return Et(c),null;case 3:return h=c.stateNode,x=null,a!==null&&(x=a.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),Fs(Ht),me(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(a===null||a.child===null)&&($o(c)?Hs(c):a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Ug())),Et(c),null;case 26:var k=c.type,N=c.memoizedState;return a===null?(Hs(c),N!==null?(Et(c),bS(c,N)):(Et(c),Rm(c,k,null,x,h))):N?N!==a.memoizedState?(Hs(c),Et(c),bS(c,N)):(Et(c),c.flags&=-16777217):(a=a.memoizedProps,a!==x&&Hs(c),Et(c),Rm(c,k,a,x,h)),null;case 27:if(Oe(c),h=se.current,k=c.type,a!==null&&c.stateNode!=null)a.memoizedProps!==x&&Hs(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Et(c),null}a=Z.current,$o(c)?J1(c):(a=Tk(k,x,h),c.stateNode=a,Hs(c))}return Et(c),null;case 5:if(Oe(c),k=c.type,a!==null&&c.stateNode!=null)a.memoizedProps!==x&&Hs(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Et(c),null}if(N=Z.current,$o(c))J1(c);else{var D=ff(se.current);switch(N){case 1:N=D.createElementNS("http://www.w3.org/2000/svg",k);break;case 2:N=D.createElementNS("http://www.w3.org/1998/Math/MathML",k);break;default:switch(k){case"svg":N=D.createElementNS("http://www.w3.org/2000/svg",k);break;case"math":N=D.createElementNS("http://www.w3.org/1998/Math/MathML",k);break;case"script":N=D.createElement("div"),N.innerHTML="<script><\/script>",N=N.removeChild(N.firstChild);break;case"select":N=typeof x.is=="string"?D.createElement("select",{is:x.is}):D.createElement("select"),x.multiple?N.multiple=!0:x.size&&(N.size=x.size);break;default:N=typeof x.is=="string"?D.createElement(k,{is:x.is}):D.createElement(k)}}N[pn]=c,N[Wn]=x;e:for(D=c.child;D!==null;){if(D.tag===5||D.tag===6)N.appendChild(D.stateNode);else if(D.tag!==4&&D.tag!==27&&D.child!==null){D.child.return=D,D=D.child;continue}if(D===c)break e;for(;D.sibling===null;){if(D.return===null||D.return===c)break e;D=D.return}D.sibling.return=D.return,D=D.sibling}c.stateNode=N;e:switch(xn(N,k,x),k){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}x&&Hs(c)}}return Et(c),Rm(c,c.type,a===null?null:a.memoizedProps,c.pendingProps,h),null;case 6:if(a&&c.stateNode!=null)a.memoizedProps!==x&&Hs(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(a=se.current,$o(c)){if(a=c.stateNode,h=c.memoizedProps,x=null,k=gn,k!==null)switch(k.tag){case 27:case 5:x=k.memoizedProps}a[pn]=c,a=!!(a.nodeValue===h||x!==null&&x.suppressHydrationWarning===!0||gk(a.nodeValue,h)),a||wi(c,!0)}else a=ff(a).createTextNode(x),a[pn]=c,c.stateNode=a}return Et(c),null;case 31:if(h=c.memoizedState,a===null||a.memoizedState!==null){if(x=$o(c),h!==null){if(a===null){if(!x)throw Error(r(318));if(a=c.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(557));a[pn]=c}else Sa(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Et(c),a=!1}else h=Ug(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=h),a=!0;if(!a)return c.flags&256?(hr(c),c):(hr(c),null);if((c.flags&128)!==0)throw Error(r(558))}return Et(c),null;case 13:if(x=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(k=$o(c),x!==null&&x.dehydrated!==null){if(a===null){if(!k)throw Error(r(318));if(k=c.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(r(317));k[pn]=c}else Sa(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Et(c),k=!1}else k=Ug(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=k),k=!0;if(!k)return c.flags&256?(hr(c),c):(hr(c),null)}return hr(c),(c.flags&128)!==0?(c.lanes=h,c):(h=x!==null,a=a!==null&&a.memoizedState!==null,h&&(x=c.child,k=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(k=x.alternate.memoizedState.cachePool.pool),N=null,x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(N=x.memoizedState.cachePool.pool),N!==k&&(x.flags|=2048)),h!==a&&h&&(c.child.flags|=8192),Gd(c,c.updateQueue),Et(c),null);case 4:return me(),a===null&&Zm(c.stateNode.containerInfo),Et(c),null;case 10:return Fs(c.type),Et(c),null;case 19:if(U(Ft),x=c.memoizedState,x===null)return Et(c),null;if(k=(c.flags&128)!==0,N=x.rendering,N===null)if(k)Ac(x,!1);else{if(Dt!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(N=zd(a),N!==null){for(c.flags|=128,Ac(x,!1),a=N.updateQueue,c.updateQueue=a,Gd(c,a),c.subtreeFlags=0,a=h,h=c.child;h!==null;)Q1(h,a),h=h.sibling;return te(Ft,Ft.current&1|2),rt&&Ps(c,x.treeForkCount),c.child}a=a.sibling}x.tail!==null&&Ce()>tf&&(c.flags|=128,k=!0,Ac(x,!1),c.lanes=4194304)}else{if(!k)if(a=zd(N),a!==null){if(c.flags|=128,k=!0,a=a.updateQueue,c.updateQueue=a,Gd(c,a),Ac(x,!0),x.tail===null&&x.tailMode==="hidden"&&!N.alternate&&!rt)return Et(c),null}else 2*Ce()-x.renderingStartTime>tf&&h!==536870912&&(c.flags|=128,k=!0,Ac(x,!1),c.lanes=4194304);x.isBackwards?(N.sibling=c.child,c.child=N):(a=x.last,a!==null?a.sibling=N:c.child=N,x.last=N)}return x.tail!==null?(a=x.tail,x.rendering=a,x.tail=a.sibling,x.renderingStartTime=Ce(),a.sibling=null,h=Ft.current,te(Ft,k?h&1|2:h&1),rt&&Ps(c,x.treeForkCount),a):(Et(c),null);case 22:case 23:return hr(c),em(),x=c.memoizedState!==null,a!==null?a.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(h&536870912)!==0&&(c.flags&128)===0&&(Et(c),c.subtreeFlags&6&&(c.flags|=8192)):Et(c),h=c.updateQueue,h!==null&&Gd(c,h.retryQueue),h=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==h&&(c.flags|=2048),a!==null&&U(Na),null;case 24:return h=null,a!==null&&(h=a.memoizedState.cache),c.memoizedState.cache!==h&&(c.flags|=2048),Fs(Ht),Et(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function r_(a,c){switch(Bg(c),c.tag){case 1:return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return Fs(Ht),me(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 26:case 27:case 5:return Oe(c),null;case 31:if(c.memoizedState!==null){if(hr(c),c.alternate===null)throw Error(r(340));Sa()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 13:if(hr(c),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Sa()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return U(Ft),null;case 4:return me(),null;case 10:return Fs(c.type),null;case 22:case 23:return hr(c),em(),a!==null&&U(Na),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 24:return Fs(Ht),null;case 25:return null;default:return null}}function vS(a,c){switch(Bg(c),c.tag){case 3:Fs(Ht),me();break;case 26:case 27:case 5:Oe(c);break;case 4:me();break;case 31:c.memoizedState!==null&&hr(c);break;case 13:hr(c);break;case 19:U(Ft);break;case 10:Fs(c.type);break;case 22:case 23:hr(c),em(),a!==null&&U(Na);break;case 24:Fs(Ht)}}function Rc(a,c){try{var h=c.updateQueue,x=h!==null?h.lastEffect:null;if(x!==null){var k=x.next;h=k;do{if((h.tag&a)===a){x=void 0;var N=h.create,D=h.inst;x=N(),D.destroy=x}h=h.next}while(h!==k)}}catch($){ht(c,c.return,$)}}function Ei(a,c,h){try{var x=c.updateQueue,k=x!==null?x.lastEffect:null;if(k!==null){var N=k.next;x=N;do{if((x.tag&a)===a){var D=x.inst,$=D.destroy;if($!==void 0){D.destroy=void 0,k=c;var G=h,le=$;try{le()}catch(he){ht(k,G,he)}}}x=x.next}while(x!==N)}}catch(he){ht(c,c.return,he)}}function wS(a){var c=a.updateQueue;if(c!==null){var h=a.stateNode;try{dw(c,h)}catch(x){ht(a,a.return,x)}}}function SS(a,c,h){h.props=Aa(a.type,a.memoizedProps),h.state=a.memoizedState;try{h.componentWillUnmount()}catch(x){ht(a,c,x)}}function _c(a,c){try{var h=a.ref;if(h!==null){switch(a.tag){case 26:case 27:case 5:var x=a.stateNode;break;case 30:x=a.stateNode;break;default:x=a.stateNode}typeof h=="function"?a.refCleanup=h(x):h.current=x}}catch(k){ht(a,c,k)}}function gs(a,c){var h=a.ref,x=a.refCleanup;if(h!==null)if(typeof x=="function")try{x()}catch(k){ht(a,c,k)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(k){ht(a,c,k)}else h.current=null}function kS(a){var c=a.type,h=a.memoizedProps,x=a.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":h.autoFocus&&x.focus();break e;case"img":h.src?x.src=h.src:h.srcSet&&(x.srcset=h.srcSet)}}catch(k){ht(a,a.return,k)}}function _m(a,c,h){try{var x=a.stateNode;N_(x,a.type,h,c),x[Wn]=c}catch(k){ht(a,a.return,k)}}function CS(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Ii(a.type)||a.tag===4}function Om(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||CS(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Ii(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Dm(a,c,h){var x=a.tag;if(x===5||x===6)a=a.stateNode,c?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(a,c):(c=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,c.appendChild(a),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=Is));else if(x!==4&&(x===27&&Ii(a.type)&&(h=a.stateNode,c=null),a=a.child,a!==null))for(Dm(a,c,h),a=a.sibling;a!==null;)Dm(a,c,h),a=a.sibling}function Xd(a,c,h){var x=a.tag;if(x===5||x===6)a=a.stateNode,c?h.insertBefore(a,c):h.appendChild(a);else if(x!==4&&(x===27&&Ii(a.type)&&(h=a.stateNode),a=a.child,a!==null))for(Xd(a,c,h),a=a.sibling;a!==null;)Xd(a,c,h),a=a.sibling}function NS(a){var c=a.stateNode,h=a.memoizedProps;try{for(var x=a.type,k=c.attributes;k.length;)c.removeAttributeNode(k[0]);xn(c,x,h),c[pn]=a,c[Wn]=h}catch(N){ht(a,a.return,N)}}var Vs=!1,Qt=!1,Im=!1,TS=typeof WeakSet=="function"?WeakSet:Set,ln=null;function s_(a,c){if(a=a.containerInfo,n0=bf,a=P1(a),Eg(a)){if("selectionStart"in a)var h={start:a.selectionStart,end:a.selectionEnd};else e:{h=(h=a.ownerDocument)&&h.defaultView||window;var x=h.getSelection&&h.getSelection();if(x&&x.rangeCount!==0){h=x.anchorNode;var k=x.anchorOffset,N=x.focusNode;x=x.focusOffset;try{h.nodeType,N.nodeType}catch{h=null;break e}var D=0,$=-1,G=-1,le=0,he=0,ve=a,ce=null;t:for(;;){for(var de;ve!==h||k!==0&&ve.nodeType!==3||($=D+k),ve!==N||x!==0&&ve.nodeType!==3||(G=D+x),ve.nodeType===3&&(D+=ve.nodeValue.length),(de=ve.firstChild)!==null;)ce=ve,ve=de;for(;;){if(ve===a)break t;if(ce===h&&++le===k&&($=D),ce===N&&++he===x&&(G=D),(de=ve.nextSibling)!==null)break;ve=ce,ce=ve.parentNode}ve=de}h=$===-1||G===-1?null:{start:$,end:G}}else h=null}h=h||{start:0,end:0}}else h=null;for(r0={focusedElem:a,selectionRange:h},bf=!1,ln=c;ln!==null;)if(c=ln,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,ln=a;else for(;ln!==null;){switch(c=ln,N=c.alternate,a=c.flags,c.tag){case 0:if((a&4)!==0&&(a=c.updateQueue,a=a!==null?a.events:null,a!==null))for(h=0;h<a.length;h++)k=a[h],k.ref.impl=k.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&N!==null){a=void 0,h=c,k=N.memoizedProps,N=N.memoizedState,x=h.stateNode;try{var Re=Aa(h.type,k);a=x.getSnapshotBeforeUpdate(Re,N),x.__reactInternalSnapshotBeforeUpdate=a}catch(Fe){ht(h,h.return,Fe)}}break;case 3:if((a&1024)!==0){if(a=c.stateNode.containerInfo,h=a.nodeType,h===9)a0(a);else if(h===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":a0(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(r(163))}if(a=c.sibling,a!==null){a.return=c.return,ln=a;break}ln=c.return}}function jS(a,c,h){var x=h.flags;switch(h.tag){case 0:case 11:case 15:Qs(a,h),x&4&&Rc(5,h);break;case 1:if(Qs(a,h),x&4)if(a=h.stateNode,c===null)try{a.componentDidMount()}catch(D){ht(h,h.return,D)}else{var k=Aa(h.type,c.memoizedProps);c=c.memoizedState;try{a.componentDidUpdate(k,c,a.__reactInternalSnapshotBeforeUpdate)}catch(D){ht(h,h.return,D)}}x&64&&wS(h),x&512&&_c(h,h.return);break;case 3:if(Qs(a,h),x&64&&(a=h.updateQueue,a!==null)){if(c=null,h.child!==null)switch(h.child.tag){case 27:case 5:c=h.child.stateNode;break;case 1:c=h.child.stateNode}try{dw(a,c)}catch(D){ht(h,h.return,D)}}break;case 27:c===null&&x&4&&NS(h);case 26:case 5:Qs(a,h),c===null&&x&4&&kS(h),x&512&&_c(h,h.return);break;case 12:Qs(a,h);break;case 31:Qs(a,h),x&4&&AS(a,h);break;case 13:Qs(a,h),x&4&&RS(a,h),x&64&&(a=h.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(h=h_.bind(null,h),O_(a,h))));break;case 22:if(x=h.memoizedState!==null||Vs,!x){c=c!==null&&c.memoizedState!==null||Qt,k=Vs;var N=Qt;Vs=x,(Qt=c)&&!N?Ws(a,h,(h.subtreeFlags&8772)!==0):Qs(a,h),Vs=k,Qt=N}break;case 30:break;default:Qs(a,h)}}function ES(a){var c=a.alternate;c!==null&&(a.alternate=null,ES(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&dg(c)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var At=null,Gn=!1;function Ks(a,c,h){for(h=h.child;h!==null;)MS(a,c,h),h=h.sibling}function MS(a,c,h){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(dt,h)}catch{}switch(h.tag){case 26:Qt||gs(h,c),Ks(a,c,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Qt||gs(h,c);var x=At,k=Gn;Ii(h.type)&&(At=h.stateNode,Gn=!1),Ks(a,c,h),Uc(h.stateNode),At=x,Gn=k;break;case 5:Qt||gs(h,c);case 6:if(x=At,k=Gn,At=null,Ks(a,c,h),At=x,Gn=k,At!==null)if(Gn)try{(At.nodeType===9?At.body:At.nodeName==="HTML"?At.ownerDocument.body:At).removeChild(h.stateNode)}catch(N){ht(h,c,N)}else try{At.removeChild(h.stateNode)}catch(N){ht(h,c,N)}break;case 18:At!==null&&(Gn?(a=At,wk(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,h.stateNode),cl(a)):wk(At,h.stateNode));break;case 4:x=At,k=Gn,At=h.stateNode.containerInfo,Gn=!0,Ks(a,c,h),At=x,Gn=k;break;case 0:case 11:case 14:case 15:Ei(2,h,c),Qt||Ei(4,h,c),Ks(a,c,h);break;case 1:Qt||(gs(h,c),x=h.stateNode,typeof x.componentWillUnmount=="function"&&SS(h,c,x)),Ks(a,c,h);break;case 21:Ks(a,c,h);break;case 22:Qt=(x=Qt)||h.memoizedState!==null,Ks(a,c,h),Qt=x;break;default:Ks(a,c,h)}}function AS(a,c){if(c.memoizedState===null&&(a=c.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{cl(a)}catch(h){ht(c,c.return,h)}}}function RS(a,c){if(c.memoizedState===null&&(a=c.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{cl(a)}catch(h){ht(c,c.return,h)}}function i_(a){switch(a.tag){case 31:case 13:case 19:var c=a.stateNode;return c===null&&(c=a.stateNode=new TS),c;case 22:return a=a.stateNode,c=a._retryCache,c===null&&(c=a._retryCache=new TS),c;default:throw Error(r(435,a.tag))}}function Jd(a,c){var h=i_(a);c.forEach(function(x){if(!h.has(x)){h.add(x);var k=p_.bind(null,a,x);x.then(k,k)}})}function Xn(a,c){var h=c.deletions;if(h!==null)for(var x=0;x<h.length;x++){var k=h[x],N=a,D=c,$=D;e:for(;$!==null;){switch($.tag){case 27:if(Ii($.type)){At=$.stateNode,Gn=!1;break e}break;case 5:At=$.stateNode,Gn=!1;break e;case 3:case 4:At=$.stateNode.containerInfo,Gn=!0;break e}$=$.return}if(At===null)throw Error(r(160));MS(N,D,k),At=null,Gn=!1,N=k.alternate,N!==null&&(N.return=null),k.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)_S(c,a),c=c.sibling}var ns=null;function _S(a,c){var h=a.alternate,x=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Xn(c,a),Jn(a),x&4&&(Ei(3,a,a.return),Rc(3,a),Ei(5,a,a.return));break;case 1:Xn(c,a),Jn(a),x&512&&(Qt||h===null||gs(h,h.return)),x&64&&Vs&&(a=a.updateQueue,a!==null&&(x=a.callbacks,x!==null&&(h=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=h===null?x:h.concat(x))));break;case 26:var k=ns;if(Xn(c,a),Jn(a),x&512&&(Qt||h===null||gs(h,h.return)),x&4){var N=h!==null?h.memoizedState:null;if(x=a.memoizedState,h===null)if(x===null)if(a.stateNode===null){e:{x=a.type,h=a.memoizedProps,k=k.ownerDocument||k;t:switch(x){case"title":N=k.getElementsByTagName("title")[0],(!N||N[ic]||N[pn]||N.namespaceURI==="http://www.w3.org/2000/svg"||N.hasAttribute("itemprop"))&&(N=k.createElement(x),k.head.insertBefore(N,k.querySelector("head > title"))),xn(N,x,h),N[pn]=a,on(N),x=N;break e;case"link":var D=_k("link","href",k).get(x+(h.href||""));if(D){for(var $=0;$<D.length;$++)if(N=D[$],N.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&N.getAttribute("rel")===(h.rel==null?null:h.rel)&&N.getAttribute("title")===(h.title==null?null:h.title)&&N.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){D.splice($,1);break t}}N=k.createElement(x),xn(N,x,h),k.head.appendChild(N);break;case"meta":if(D=_k("meta","content",k).get(x+(h.content||""))){for($=0;$<D.length;$++)if(N=D[$],N.getAttribute("content")===(h.content==null?null:""+h.content)&&N.getAttribute("name")===(h.name==null?null:h.name)&&N.getAttribute("property")===(h.property==null?null:h.property)&&N.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&N.getAttribute("charset")===(h.charSet==null?null:h.charSet)){D.splice($,1);break t}}N=k.createElement(x),xn(N,x,h),k.head.appendChild(N);break;default:throw Error(r(468,x))}N[pn]=a,on(N),x=N}a.stateNode=x}else Ok(k,a.type,a.stateNode);else a.stateNode=Rk(k,x,a.memoizedProps);else N!==x?(N===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):N.count--,x===null?Ok(k,a.type,a.stateNode):Rk(k,x,a.memoizedProps)):x===null&&a.stateNode!==null&&_m(a,a.memoizedProps,h.memoizedProps)}break;case 27:Xn(c,a),Jn(a),x&512&&(Qt||h===null||gs(h,h.return)),h!==null&&x&4&&_m(a,a.memoizedProps,h.memoizedProps);break;case 5:if(Xn(c,a),Jn(a),x&512&&(Qt||h===null||gs(h,h.return)),a.flags&32){k=a.stateNode;try{_o(k,"")}catch(Re){ht(a,a.return,Re)}}x&4&&a.stateNode!=null&&(k=a.memoizedProps,_m(a,k,h!==null?h.memoizedProps:k)),x&1024&&(Im=!0);break;case 6:if(Xn(c,a),Jn(a),x&4){if(a.stateNode===null)throw Error(r(162));x=a.memoizedProps,h=a.stateNode;try{h.nodeValue=x}catch(Re){ht(a,a.return,Re)}}break;case 3:if(gf=null,k=ns,ns=hf(c.containerInfo),Xn(c,a),ns=k,Jn(a),x&4&&h!==null&&h.memoizedState.isDehydrated)try{cl(c.containerInfo)}catch(Re){ht(a,a.return,Re)}Im&&(Im=!1,OS(a));break;case 4:x=ns,ns=hf(a.stateNode.containerInfo),Xn(c,a),Jn(a),ns=x;break;case 12:Xn(c,a),Jn(a);break;case 31:Xn(c,a),Jn(a),x&4&&(x=a.updateQueue,x!==null&&(a.updateQueue=null,Jd(a,x)));break;case 13:Xn(c,a),Jn(a),a.child.flags&8192&&a.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(ef=Ce()),x&4&&(x=a.updateQueue,x!==null&&(a.updateQueue=null,Jd(a,x)));break;case 22:k=a.memoizedState!==null;var G=h!==null&&h.memoizedState!==null,le=Vs,he=Qt;if(Vs=le||k,Qt=he||G,Xn(c,a),Qt=he,Vs=le,Jn(a),x&8192)e:for(c=a.stateNode,c._visibility=k?c._visibility&-2:c._visibility|1,k&&(h===null||G||Vs||Qt||Ra(a)),h=null,c=a;;){if(c.tag===5||c.tag===26){if(h===null){G=h=c;try{if(N=G.stateNode,k)D=N.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none";else{$=G.stateNode;var ve=G.memoizedProps.style,ce=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;$.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(Re){ht(G,G.return,Re)}}}else if(c.tag===6){if(h===null){G=c;try{G.stateNode.nodeValue=k?"":G.memoizedProps}catch(Re){ht(G,G.return,Re)}}}else if(c.tag===18){if(h===null){G=c;try{var de=G.stateNode;k?Sk(de,!0):Sk(G.stateNode,!1)}catch(Re){ht(G,G.return,Re)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===a)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break e;for(;c.sibling===null;){if(c.return===null||c.return===a)break e;h===c&&(h=null),c=c.return}h===c&&(h=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=a.updateQueue,x!==null&&(h=x.retryQueue,h!==null&&(x.retryQueue=null,Jd(a,h))));break;case 19:Xn(c,a),Jn(a),x&4&&(x=a.updateQueue,x!==null&&(a.updateQueue=null,Jd(a,x)));break;case 30:break;case 21:break;default:Xn(c,a),Jn(a)}}function Jn(a){var c=a.flags;if(c&2){try{for(var h,x=a.return;x!==null;){if(CS(x)){h=x;break}x=x.return}if(h==null)throw Error(r(160));switch(h.tag){case 27:var k=h.stateNode,N=Om(a);Xd(a,N,k);break;case 5:var D=h.stateNode;h.flags&32&&(_o(D,""),h.flags&=-33);var $=Om(a);Xd(a,$,D);break;case 3:case 4:var G=h.stateNode.containerInfo,le=Om(a);Dm(a,le,G);break;default:throw Error(r(161))}}catch(he){ht(a,a.return,he)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function OS(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var c=a;OS(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),a=a.sibling}}function Qs(a,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)jS(a,c.alternate,c),c=c.sibling}function Ra(a){for(a=a.child;a!==null;){var c=a;switch(c.tag){case 0:case 11:case 14:case 15:Ei(4,c,c.return),Ra(c);break;case 1:gs(c,c.return);var h=c.stateNode;typeof h.componentWillUnmount=="function"&&SS(c,c.return,h),Ra(c);break;case 27:Uc(c.stateNode);case 26:case 5:gs(c,c.return),Ra(c);break;case 22:c.memoizedState===null&&Ra(c);break;case 30:Ra(c);break;default:Ra(c)}a=a.sibling}}function Ws(a,c,h){for(h=h&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,k=a,N=c,D=N.flags;switch(N.tag){case 0:case 11:case 15:Ws(k,N,h),Rc(4,N);break;case 1:if(Ws(k,N,h),x=N,k=x.stateNode,typeof k.componentDidMount=="function")try{k.componentDidMount()}catch(le){ht(x,x.return,le)}if(x=N,k=x.updateQueue,k!==null){var $=x.stateNode;try{var G=k.shared.hiddenCallbacks;if(G!==null)for(k.shared.hiddenCallbacks=null,k=0;k<G.length;k++)uw(G[k],$)}catch(le){ht(x,x.return,le)}}h&&D&64&&wS(N),_c(N,N.return);break;case 27:NS(N);case 26:case 5:Ws(k,N,h),h&&x===null&&D&4&&kS(N),_c(N,N.return);break;case 12:Ws(k,N,h);break;case 31:Ws(k,N,h),h&&D&4&&AS(k,N);break;case 13:Ws(k,N,h),h&&D&4&&RS(k,N);break;case 22:N.memoizedState===null&&Ws(k,N,h),_c(N,N.return);break;case 30:break;default:Ws(k,N,h)}c=c.sibling}}function Lm(a,c){var h=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),a=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(a=c.memoizedState.cachePool.pool),a!==h&&(a!=null&&a.refCount++,h!=null&&xc(h))}function zm(a,c){a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&xc(a))}function rs(a,c,h,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)DS(a,c,h,x),c=c.sibling}function DS(a,c,h,x){var k=c.flags;switch(c.tag){case 0:case 11:case 15:rs(a,c,h,x),k&2048&&Rc(9,c);break;case 1:rs(a,c,h,x);break;case 3:rs(a,c,h,x),k&2048&&(a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&xc(a)));break;case 12:if(k&2048){rs(a,c,h,x),a=c.stateNode;try{var N=c.memoizedProps,D=N.id,$=N.onPostCommit;typeof $=="function"&&$(D,c.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(G){ht(c,c.return,G)}}else rs(a,c,h,x);break;case 31:rs(a,c,h,x);break;case 13:rs(a,c,h,x);break;case 23:break;case 22:N=c.stateNode,D=c.alternate,c.memoizedState!==null?N._visibility&2?rs(a,c,h,x):Oc(a,c):N._visibility&2?rs(a,c,h,x):(N._visibility|=2,Jo(a,c,h,x,(c.subtreeFlags&10256)!==0||!1)),k&2048&&Lm(D,c);break;case 24:rs(a,c,h,x),k&2048&&zm(c.alternate,c);break;default:rs(a,c,h,x)}}function Jo(a,c,h,x,k){for(k=k&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var N=a,D=c,$=h,G=x,le=D.flags;switch(D.tag){case 0:case 11:case 15:Jo(N,D,$,G,k),Rc(8,D);break;case 23:break;case 22:var he=D.stateNode;D.memoizedState!==null?he._visibility&2?Jo(N,D,$,G,k):Oc(N,D):(he._visibility|=2,Jo(N,D,$,G,k)),k&&le&2048&&Lm(D.alternate,D);break;case 24:Jo(N,D,$,G,k),k&&le&2048&&zm(D.alternate,D);break;default:Jo(N,D,$,G,k)}c=c.sibling}}function Oc(a,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var h=a,x=c,k=x.flags;switch(x.tag){case 22:Oc(h,x),k&2048&&Lm(x.alternate,x);break;case 24:Oc(h,x),k&2048&&zm(x.alternate,x);break;default:Oc(h,x)}c=c.sibling}}var Dc=8192;function Zo(a,c,h){if(a.subtreeFlags&Dc)for(a=a.child;a!==null;)IS(a,c,h),a=a.sibling}function IS(a,c,h){switch(a.tag){case 26:Zo(a,c,h),a.flags&Dc&&a.memoizedState!==null&&V_(h,ns,a.memoizedState,a.memoizedProps);break;case 5:Zo(a,c,h);break;case 3:case 4:var x=ns;ns=hf(a.stateNode.containerInfo),Zo(a,c,h),ns=x;break;case 22:a.memoizedState===null&&(x=a.alternate,x!==null&&x.memoizedState!==null?(x=Dc,Dc=16777216,Zo(a,c,h),Dc=x):Zo(a,c,h));break;default:Zo(a,c,h)}}function LS(a){var c=a.alternate;if(c!==null&&(a=c.child,a!==null)){c.child=null;do c=a.sibling,a.sibling=null,a=c;while(a!==null)}}function Ic(a){var c=a.deletions;if((a.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var x=c[h];ln=x,PS(x,a)}LS(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)zS(a),a=a.sibling}function zS(a){switch(a.tag){case 0:case 11:case 15:Ic(a),a.flags&2048&&Ei(9,a,a.return);break;case 3:Ic(a);break;case 12:Ic(a);break;case 22:var c=a.stateNode;a.memoizedState!==null&&c._visibility&2&&(a.return===null||a.return.tag!==13)?(c._visibility&=-3,Zd(a)):Ic(a);break;default:Ic(a)}}function Zd(a){var c=a.deletions;if((a.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var x=c[h];ln=x,PS(x,a)}LS(a)}for(a=a.child;a!==null;){switch(c=a,c.tag){case 0:case 11:case 15:Ei(8,c,c.return),Zd(c);break;case 22:h=c.stateNode,h._visibility&2&&(h._visibility&=-3,Zd(c));break;default:Zd(c)}a=a.sibling}}function PS(a,c){for(;ln!==null;){var h=ln;switch(h.tag){case 0:case 11:case 15:Ei(8,h,c);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var x=h.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:xc(h.memoizedState.cache)}if(x=h.child,x!==null)x.return=h,ln=x;else e:for(h=a;ln!==null;){x=ln;var k=x.sibling,N=x.return;if(ES(x),x===h){ln=null;break e}if(k!==null){k.return=N,ln=k;break e}ln=N}}}var a_={getCacheForType:function(a){var c=mn(Ht),h=c.data.get(a);return h===void 0&&(h=a(),c.data.set(a,h)),h},cacheSignal:function(){return mn(Ht).controller.signal}},o_=typeof WeakMap=="function"?WeakMap:Map,ct=0,wt=null,Xe=null,et=0,ft=0,pr=null,Mi=!1,el=!1,Pm=!1,Ys=0,Dt=0,Ai=0,_a=0,Bm=0,gr=0,tl=0,Lc=null,Zn=null,Fm=!1,ef=0,BS=0,tf=1/0,nf=null,Ri=null,tn=0,_i=null,nl=null,Gs=0,Um=0,$m=null,FS=null,zc=0,qm=null;function mr(){return(ct&2)!==0&&et!==0?et&-et:q.T!==null?Ym():es()}function US(){if(gr===0)if((et&536870912)===0||rt){var a=Rs;Rs<<=1,(Rs&3932160)===0&&(Rs=262144),gr=a}else gr=536870912;return a=fr.current,a!==null&&(a.flags|=32),gr}function er(a,c,h){(a===wt&&(ft===2||ft===9)||a.cancelPendingCommit!==null)&&(rl(a,0),Oi(a,et,gr,!1)),Cr(a,h),((ct&2)===0||a!==wt)&&(a===wt&&((ct&2)===0&&(_a|=h),Dt===4&&Oi(a,et,gr,!1)),ms(a))}function $S(a,c,h){if((ct&6)!==0)throw Error(r(327));var x=!h&&(c&127)===0&&(c&a.expiredLanes)===0||Vn(a,c),k=x?u_(a,c):Vm(a,c,!0),N=x;do{if(k===0){el&&!x&&Oi(a,c,0,!1);break}else{if(h=a.current.alternate,N&&!l_(h)){k=Vm(a,c,!1),N=!1;continue}if(k===2){if(N=c,a.errorRecoveryDisabledLanes&N)var D=0;else D=a.pendingLanes&-536870913,D=D!==0?D:D&536870912?536870912:0;if(D!==0){c=D;e:{var $=a;k=Lc;var G=$.current.memoizedState.isDehydrated;if(G&&(rl($,D).flags|=256),D=Vm($,D,!1),D!==2){if(Pm&&!G){$.errorRecoveryDisabledLanes|=N,_a|=N,k=4;break e}N=Zn,Zn=k,N!==null&&(Zn===null?Zn=N:Zn.push.apply(Zn,N))}k=D}if(N=!1,k!==2)continue}}if(k===1){rl(a,0),Oi(a,c,0,!0);break}e:{switch(x=a,N=k,N){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:Oi(x,c,gr,!Mi);break e;case 2:Zn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(k=ef+300-Ce(),10<k)){if(Oi(x,c,gr,!Mi),an(x,0,!0)!==0)break e;Gs=c,x.timeoutHandle=bk(qS.bind(null,x,h,Zn,nf,Fm,c,gr,_a,tl,Mi,N,"Throttled",-0,0),k);break e}qS(x,h,Zn,nf,Fm,c,gr,_a,tl,Mi,N,null,-0,0)}}break}while(!0);ms(a)}function qS(a,c,h,x,k,N,D,$,G,le,he,ve,ce,de){if(a.timeoutHandle=-1,ve=c.subtreeFlags,ve&8192||(ve&16785408)===16785408){ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Is},IS(c,N,ve);var Re=(N&62914560)===N?ef-Ce():(N&4194048)===N?BS-Ce():0;if(Re=K_(ve,Re),Re!==null){Gs=N,a.cancelPendingCommit=Re(XS.bind(null,a,c,N,h,x,k,D,$,G,he,ve,null,ce,de)),Oi(a,N,D,!le);return}}XS(a,c,N,h,x,k,D,$,G)}function l_(a){for(var c=a;;){var h=c.tag;if((h===0||h===11||h===15)&&c.flags&16384&&(h=c.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var x=0;x<h.length;x++){var k=h[x],N=k.getSnapshot;k=k.value;try{if(!ur(N(),k))return!1}catch{return!1}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Oi(a,c,h,x){c&=~Bm,c&=~_a,a.suspendedLanes|=c,a.pingedLanes&=~c,x&&(a.warmLanes|=c),x=a.expirationTimes;for(var k=c;0<k;){var N=31-Nt(k),D=1<<N;x[N]=-1,k&=~D}h!==0&&Zr(a,h,c)}function rf(){return(ct&6)===0?(Pc(0),!1):!0}function Hm(){if(Xe!==null){if(ft===0)var a=Xe.return;else a=Xe,Bs=ka=null,am(a),Qo=null,vc=0,a=Xe;for(;a!==null;)vS(a.alternate,a),a=a.return;Xe=null}}function rl(a,c){var h=a.timeoutHandle;h!==-1&&(a.timeoutHandle=-1,E_(h)),h=a.cancelPendingCommit,h!==null&&(a.cancelPendingCommit=null,h()),Gs=0,Hm(),wt=a,Xe=h=zs(a.current,null),et=c,ft=0,pr=null,Mi=!1,el=Vn(a,c),Pm=!1,tl=gr=Bm=_a=Ai=Dt=0,Zn=Lc=null,Fm=!1,(c&8)!==0&&(c|=c&32);var x=a.entangledLanes;if(x!==0)for(a=a.entanglements,x&=c;0<x;){var k=31-Nt(x),N=1<<k;c|=a[k],x&=~N}return Ys=c,Cd(),h}function HS(a,c){Ke=null,q.H=Ec,c===Ko||c===_d?(c=aw(),ft=3):c===Wg?(c=aw(),ft=4):ft=c===Sm?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,pr=c,Xe===null&&(Dt=1,Kd(a,Ar(c,a.current)))}function VS(){var a=fr.current;return a===null?!0:(et&4194048)===et?Dr===null:(et&62914560)===et||(et&536870912)!==0?a===Dr:!1}function KS(){var a=q.H;return q.H=Ec,a===null?Ec:a}function QS(){var a=q.A;return q.A=a_,a}function sf(){Dt=4,Mi||(et&4194048)!==et&&fr.current!==null||(el=!0),(Ai&134217727)===0&&(_a&134217727)===0||wt===null||Oi(wt,et,gr,!1)}function Vm(a,c,h){var x=ct;ct|=2;var k=KS(),N=QS();(wt!==a||et!==c)&&(nf=null,rl(a,c)),c=!1;var D=Dt;e:do try{if(ft!==0&&Xe!==null){var $=Xe,G=pr;switch(ft){case 8:Hm(),D=6;break e;case 3:case 2:case 9:case 6:fr.current===null&&(c=!0);var le=ft;if(ft=0,pr=null,sl(a,$,G,le),h&&el){D=0;break e}break;default:le=ft,ft=0,pr=null,sl(a,$,G,le)}}c_(),D=Dt;break}catch(he){HS(a,he)}while(!0);return c&&a.shellSuspendCounter++,Bs=ka=null,ct=x,q.H=k,q.A=N,Xe===null&&(wt=null,et=0,Cd()),D}function c_(){for(;Xe!==null;)WS(Xe)}function u_(a,c){var h=ct;ct|=2;var x=KS(),k=QS();wt!==a||et!==c?(nf=null,tf=Ce()+500,rl(a,c)):el=Vn(a,c);e:do try{if(ft!==0&&Xe!==null){c=Xe;var N=pr;t:switch(ft){case 1:ft=0,pr=null,sl(a,c,N,1);break;case 2:case 9:if(sw(N)){ft=0,pr=null,YS(c);break}c=function(){ft!==2&&ft!==9||wt!==a||(ft=7),ms(a)},N.then(c,c);break e;case 3:ft=7;break e;case 4:ft=5;break e;case 7:sw(N)?(ft=0,pr=null,YS(c)):(ft=0,pr=null,sl(a,c,N,7));break;case 5:var D=null;switch(Xe.tag){case 26:D=Xe.memoizedState;case 5:case 27:var $=Xe;if(D?Dk(D):$.stateNode.complete){ft=0,pr=null;var G=$.sibling;if(G!==null)Xe=G;else{var le=$.return;le!==null?(Xe=le,af(le)):Xe=null}break t}}ft=0,pr=null,sl(a,c,N,5);break;case 6:ft=0,pr=null,sl(a,c,N,6);break;case 8:Hm(),Dt=6;break e;default:throw Error(r(462))}}d_();break}catch(he){HS(a,he)}while(!0);return Bs=ka=null,q.H=x,q.A=k,ct=h,Xe!==null?0:(wt=null,et=0,Cd(),Dt)}function d_(){for(;Xe!==null&&!ae();)WS(Xe)}function WS(a){var c=xS(a.alternate,a,Ys);a.memoizedProps=a.pendingProps,c===null?af(a):Xe=c}function YS(a){var c=a,h=c.alternate;switch(c.tag){case 15:case 0:c=fS(h,c,c.pendingProps,c.type,void 0,et);break;case 11:c=fS(h,c,c.pendingProps,c.type.render,c.ref,et);break;case 5:am(c);default:vS(h,c),c=Xe=Q1(c,Ys),c=xS(h,c,Ys)}a.memoizedProps=a.pendingProps,c===null?af(a):Xe=c}function sl(a,c,h,x){Bs=ka=null,am(c),Qo=null,vc=0;var k=c.return;try{if(ZR(a,k,c,h,et)){Dt=1,Kd(a,Ar(h,a.current)),Xe=null;return}}catch(N){if(k!==null)throw Xe=k,N;Dt=1,Kd(a,Ar(h,a.current)),Xe=null;return}c.flags&32768?(rt||x===1?a=!0:el||(et&536870912)!==0?a=!1:(Mi=a=!0,(x===2||x===9||x===3||x===6)&&(x=fr.current,x!==null&&x.tag===13&&(x.flags|=16384))),GS(c,a)):af(c)}function af(a){var c=a;do{if((c.flags&32768)!==0){GS(c,Mi);return}a=c.return;var h=n_(c.alternate,c,Ys);if(h!==null){Xe=h;return}if(c=c.sibling,c!==null){Xe=c;return}Xe=c=a}while(c!==null);Dt===0&&(Dt=5)}function GS(a,c){do{var h=r_(a.alternate,a);if(h!==null){h.flags&=32767,Xe=h;return}if(h=a.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!c&&(a=a.sibling,a!==null)){Xe=a;return}Xe=a=h}while(a!==null);Dt=6,Xe=null}function XS(a,c,h,x,k,N,D,$,G){a.cancelPendingCommit=null;do of();while(tn!==0);if((ct&6)!==0)throw Error(r(327));if(c!==null){if(c===a.current)throw Error(r(177));if(N=c.lanes|c.childLanes,N|=Og,en(a,h,N,D,$,G),a===wt&&(Xe=wt=null,et=0),nl=c,_i=a,Gs=h,Um=N,$m=k,FS=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,g_(Ue,function(){return nk(),null})):(a.callbackNode=null,a.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=q.T,q.T=null,k=V.p,V.p=2,D=ct,ct|=4;try{s_(a,c,h)}finally{ct=D,V.p=k,q.T=x}}tn=1,JS(),ZS(),ek()}}function JS(){if(tn===1){tn=0;var a=_i,c=nl,h=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||h){h=q.T,q.T=null;var x=V.p;V.p=2;var k=ct;ct|=4;try{_S(c,a);var N=r0,D=P1(a.containerInfo),$=N.focusedElem,G=N.selectionRange;if(D!==$&&$&&$.ownerDocument&&z1($.ownerDocument.documentElement,$)){if(G!==null&&Eg($)){var le=G.start,he=G.end;if(he===void 0&&(he=le),"selectionStart"in $)$.selectionStart=le,$.selectionEnd=Math.min(he,$.value.length);else{var ve=$.ownerDocument||document,ce=ve&&ve.defaultView||window;if(ce.getSelection){var de=ce.getSelection(),Re=$.textContent.length,Fe=Math.min(G.start,Re),bt=G.end===void 0?Fe:Math.min(G.end,Re);!de.extend&&Fe>bt&&(D=bt,bt=Fe,Fe=D);var ne=L1($,Fe),J=L1($,bt);if(ne&&J&&(de.rangeCount!==1||de.anchorNode!==ne.node||de.anchorOffset!==ne.offset||de.focusNode!==J.node||de.focusOffset!==J.offset)){var oe=ve.createRange();oe.setStart(ne.node,ne.offset),de.removeAllRanges(),Fe>bt?(de.addRange(oe),de.extend(J.node,J.offset)):(oe.setEnd(J.node,J.offset),de.addRange(oe))}}}}for(ve=[],de=$;de=de.parentNode;)de.nodeType===1&&ve.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<ve.length;$++){var ye=ve[$];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}bf=!!n0,r0=n0=null}finally{ct=k,V.p=x,q.T=h}}a.current=c,tn=2}}function ZS(){if(tn===2){tn=0;var a=_i,c=nl,h=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||h){h=q.T,q.T=null;var x=V.p;V.p=2;var k=ct;ct|=4;try{jS(a,c.alternate,c)}finally{ct=k,V.p=x,q.T=h}}tn=3}}function ek(){if(tn===4||tn===3){tn=0,xe();var a=_i,c=nl,h=Gs,x=FS;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?tn=5:(tn=0,nl=_i=null,tk(a,a.pendingLanes));var k=a.pendingLanes;if(k===0&&(Ri=null),Os(h),c=c.stateNode,qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(dt,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=q.T,k=V.p,V.p=2,q.T=null;try{for(var N=a.onRecoverableError,D=0;D<x.length;D++){var $=x[D];N($.value,{componentStack:$.stack})}}finally{q.T=c,V.p=k}}(Gs&3)!==0&&of(),ms(a),k=a.pendingLanes,(h&261930)!==0&&(k&42)!==0?a===qm?zc++:(zc=0,qm=a):zc=0,Pc(0)}}function tk(a,c){(a.pooledCacheLanes&=c)===0&&(c=a.pooledCache,c!=null&&(a.pooledCache=null,xc(c)))}function of(){return JS(),ZS(),ek(),nk()}function nk(){if(tn!==5)return!1;var a=_i,c=Um;Um=0;var h=Os(Gs),x=q.T,k=V.p;try{V.p=32>h?32:h,q.T=null,h=$m,$m=null;var N=_i,D=Gs;if(tn=0,nl=_i=null,Gs=0,(ct&6)!==0)throw Error(r(331));var $=ct;if(ct|=4,zS(N.current),DS(N,N.current,D,h),ct=$,Pc(0,!1),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(dt,N)}catch{}return!0}finally{V.p=k,q.T=x,tk(a,c)}}function rk(a,c,h){c=Ar(h,c),c=wm(a.stateNode,c,2),a=Ni(a,c,2),a!==null&&(Cr(a,2),ms(a))}function ht(a,c,h){if(a.tag===3)rk(a,a,h);else for(;c!==null;){if(c.tag===3){rk(c,a,h);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Ri===null||!Ri.has(x))){a=Ar(h,a),h=sS(2),x=Ni(c,h,2),x!==null&&(iS(h,x,c,a),Cr(x,2),ms(x));break}}c=c.return}}function Km(a,c,h){var x=a.pingCache;if(x===null){x=a.pingCache=new o_;var k=new Set;x.set(c,k)}else k=x.get(c),k===void 0&&(k=new Set,x.set(c,k));k.has(h)||(Pm=!0,k.add(h),a=f_.bind(null,a,c,h),c.then(a,a))}function f_(a,c,h){var x=a.pingCache;x!==null&&x.delete(c),a.pingedLanes|=a.suspendedLanes&h,a.warmLanes&=~h,wt===a&&(et&h)===h&&(Dt===4||Dt===3&&(et&62914560)===et&&300>Ce()-ef?(ct&2)===0&&rl(a,0):Bm|=h,tl===et&&(tl=0)),ms(a)}function sk(a,c){c===0&&(c=Nn()),a=va(a,c),a!==null&&(Cr(a,c),ms(a))}function h_(a){var c=a.memoizedState,h=0;c!==null&&(h=c.retryLane),sk(a,h)}function p_(a,c){var h=0;switch(a.tag){case 31:case 13:var x=a.stateNode,k=a.memoizedState;k!==null&&(h=k.retryLane);break;case 19:x=a.stateNode;break;case 22:x=a.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(c),sk(a,h)}function g_(a,c){return pe(a,c)}var lf=null,il=null,Qm=!1,cf=!1,Wm=!1,Di=0;function ms(a){a!==il&&a.next===null&&(il===null?lf=il=a:il=il.next=a),cf=!0,Qm||(Qm=!0,y_())}function Pc(a,c){if(!Wm&&cf){Wm=!0;do for(var h=!1,x=lf;x!==null;){if(a!==0){var k=x.pendingLanes;if(k===0)var N=0;else{var D=x.suspendedLanes,$=x.pingedLanes;N=(1<<31-Nt(42|a)+1)-1,N&=k&~(D&~$),N=N&201326741?N&201326741|1:N?N|2:0}N!==0&&(h=!0,lk(x,N))}else N=et,N=an(x,x===wt?N:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(N&3)===0||Vn(x,N)||(h=!0,lk(x,N));x=x.next}while(h);Wm=!1}}function m_(){ik()}function ik(){cf=Qm=!1;var a=0;Di!==0&&j_()&&(a=Di);for(var c=Ce(),h=null,x=lf;x!==null;){var k=x.next,N=ak(x,c);N===0?(x.next=null,h===null?lf=k:h.next=k,k===null&&(il=h)):(h=x,(a!==0||(N&3)!==0)&&(cf=!0)),x=k}tn!==0&&tn!==5||Pc(a),Di!==0&&(Di=0)}function ak(a,c){for(var h=a.suspendedLanes,x=a.pingedLanes,k=a.expirationTimes,N=a.pendingLanes&-62914561;0<N;){var D=31-Nt(N),$=1<<D,G=k[D];G===-1?(($&h)===0||($&x)!==0)&&(k[D]=Kn($,c)):G<=c&&(a.expiredLanes|=$),N&=~$}if(c=wt,h=et,h=an(a,a===c?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),x=a.callbackNode,h===0||a===c&&(ft===2||ft===9)||a.cancelPendingCommit!==null)return x!==null&&x!==null&&we(x),a.callbackNode=null,a.callbackPriority=0;if((h&3)===0||Vn(a,h)){if(c=h&-h,c===a.callbackPriority)return c;switch(x!==null&&we(x),Os(h)){case 2:case 8:h=Ze;break;case 32:h=Ue;break;case 268435456:h=Jr;break;default:h=Ue}return x=ok.bind(null,a),h=pe(h,x),a.callbackPriority=c,a.callbackNode=h,c}return x!==null&&x!==null&&we(x),a.callbackPriority=2,a.callbackNode=null,2}function ok(a,c){if(tn!==0&&tn!==5)return a.callbackNode=null,a.callbackPriority=0,null;var h=a.callbackNode;if(of()&&a.callbackNode!==h)return null;var x=et;return x=an(a,a===wt?x:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),x===0?null:($S(a,x,c),ak(a,Ce()),a.callbackNode!=null&&a.callbackNode===h?ok.bind(null,a):null)}function lk(a,c){if(of())return null;$S(a,c,!0)}function y_(){M_(function(){(ct&6)!==0?pe(De,m_):ik()})}function Ym(){if(Di===0){var a=Ho;a===0&&(a=mi,mi<<=1,(mi&261888)===0&&(mi=256)),Di=a}return Di}function ck(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:md(""+a)}function uk(a,c){var h=c.ownerDocument.createElement("input");return h.name=c.name,h.value=c.value,a.id&&h.setAttribute("form",a.id),c.parentNode.insertBefore(h,c),a=new FormData(a),h.parentNode.removeChild(h),a}function x_(a,c,h,x,k){if(c==="submit"&&h&&h.stateNode===k){var N=ck((k[Wn]||null).action),D=x.submitter;D&&(c=(c=D[Wn]||null)?ck(c.formAction):D.getAttribute("formAction"),c!==null&&(N=c,D=null));var $=new vd("action","action",null,x,k);a.push({event:$,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Di!==0){var G=D?uk(k,D):new FormData(k);gm(h,{pending:!0,data:G,method:k.method,action:N},null,G)}}else typeof N=="function"&&($.preventDefault(),G=D?uk(k,D):new FormData(k),gm(h,{pending:!0,data:G,method:k.method,action:N},N,G))},currentTarget:k}]})}}for(var Gm=0;Gm<_g.length;Gm++){var Xm=_g[Gm],b_=Xm.toLowerCase(),v_=Xm[0].toUpperCase()+Xm.slice(1);ts(b_,"on"+v_)}ts(U1,"onAnimationEnd"),ts($1,"onAnimationIteration"),ts(q1,"onAnimationStart"),ts("dblclick","onDoubleClick"),ts("focusin","onFocus"),ts("focusout","onBlur"),ts(LR,"onTransitionRun"),ts(zR,"onTransitionStart"),ts(PR,"onTransitionCancel"),ts(H1,"onTransitionEnd"),Ao("onMouseEnter",["mouseout","mouseover"]),Ao("onMouseLeave",["mouseout","mouseover"]),Ao("onPointerEnter",["pointerout","pointerover"]),Ao("onPointerLeave",["pointerout","pointerover"]),ma("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ma("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ma("onBeforeInput",["compositionend","keypress","textInput","paste"]),ma("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ma("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ma("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),w_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bc));function dk(a,c){c=(c&4)!==0;for(var h=0;h<a.length;h++){var x=a[h],k=x.event;x=x.listeners;e:{var N=void 0;if(c)for(var D=x.length-1;0<=D;D--){var $=x[D],G=$.instance,le=$.currentTarget;if($=$.listener,G!==N&&k.isPropagationStopped())break e;N=$,k.currentTarget=le;try{N(k)}catch(he){kd(he)}k.currentTarget=null,N=G}else for(D=0;D<x.length;D++){if($=x[D],G=$.instance,le=$.currentTarget,$=$.listener,G!==N&&k.isPropagationStopped())break e;N=$,k.currentTarget=le;try{N(k)}catch(he){kd(he)}k.currentTarget=null,N=G}}}}function Je(a,c){var h=c[ug];h===void 0&&(h=c[ug]=new Set);var x=a+"__bubble";h.has(x)||(fk(c,a,2,!1),h.add(x))}function Jm(a,c,h){var x=0;c&&(x|=4),fk(h,a,x,c)}var uf="_reactListening"+Math.random().toString(36).slice(2);function Zm(a){if(!a[uf]){a[uf]=!0,i1.forEach(function(h){h!=="selectionchange"&&(w_.has(h)||Jm(h,!1,a),Jm(h,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[uf]||(c[uf]=!0,Jm("selectionchange",!1,c))}}function fk(a,c,h,x){switch(Uk(c)){case 2:var k=Y_;break;case 8:k=G_;break;default:k=p0}h=k.bind(null,c,h,a),k=void 0,!bg||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(k=!0),x?k!==void 0?a.addEventListener(c,h,{capture:!0,passive:k}):a.addEventListener(c,h,!0):k!==void 0?a.addEventListener(c,h,{passive:k}):a.addEventListener(c,h,!1)}function e0(a,c,h,x,k){var N=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var D=x.tag;if(D===3||D===4){var $=x.stateNode.containerInfo;if($===k)break;if(D===4)for(D=x.return;D!==null;){var G=D.tag;if((G===3||G===4)&&D.stateNode.containerInfo===k)return;D=D.return}for(;$!==null;){if(D=jo($),D===null)return;if(G=D.tag,G===5||G===6||G===26||G===27){x=N=D;continue e}$=$.parentNode}}x=x.return}y1(function(){var le=N,he=yg(h),ve=[];e:{var ce=V1.get(a);if(ce!==void 0){var de=vd,Re=a;switch(a){case"keypress":if(xd(h)===0)break e;case"keydown":case"keyup":de=pR;break;case"focusin":Re="focus",de=kg;break;case"focusout":Re="blur",de=kg;break;case"beforeblur":case"afterblur":de=kg;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=v1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=nR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=yR;break;case U1:case $1:case q1:de=iR;break;case H1:de=bR;break;case"scroll":case"scrollend":de=eR;break;case"wheel":de=wR;break;case"copy":case"cut":case"paste":de=oR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=S1;break;case"toggle":case"beforetoggle":de=kR}var Fe=(c&4)!==0,bt=!Fe&&(a==="scroll"||a==="scrollend"),ne=Fe?ce!==null?ce+"Capture":null:ce;Fe=[];for(var J=le,oe;J!==null;){var ye=J;if(oe=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||oe===null||ne===null||(ye=oc(J,ne),ye!=null&&Fe.push(Fc(J,ye,oe))),bt)break;J=J.return}0<Fe.length&&(ce=new de(ce,Re,null,h,he),ve.push({event:ce,listeners:Fe}))}}if((c&7)===0){e:{if(ce=a==="mouseover"||a==="pointerover",de=a==="mouseout"||a==="pointerout",ce&&h!==mg&&(Re=h.relatedTarget||h.fromElement)&&(jo(Re)||Re[To]))break e;if((de||ce)&&(ce=he.window===he?he:(ce=he.ownerDocument)?ce.defaultView||ce.parentWindow:window,de?(Re=h.relatedTarget||h.toElement,de=le,Re=Re?jo(Re):null,Re!==null&&(bt=i(Re),Fe=Re.tag,Re!==bt||Fe!==5&&Fe!==27&&Fe!==6)&&(Re=null)):(de=null,Re=le),de!==Re)){if(Fe=v1,ye="onMouseLeave",ne="onMouseEnter",J="mouse",(a==="pointerout"||a==="pointerover")&&(Fe=S1,ye="onPointerLeave",ne="onPointerEnter",J="pointer"),bt=de==null?ce:ac(de),oe=Re==null?ce:ac(Re),ce=new Fe(ye,J+"leave",de,h,he),ce.target=bt,ce.relatedTarget=oe,ye=null,jo(he)===le&&(Fe=new Fe(ne,J+"enter",Re,h,he),Fe.target=oe,Fe.relatedTarget=bt,ye=Fe),bt=ye,de&&Re)t:{for(Fe=S_,ne=de,J=Re,oe=0,ye=ne;ye;ye=Fe(ye))oe++;ye=0;for(var ze=J;ze;ze=Fe(ze))ye++;for(;0<oe-ye;)ne=Fe(ne),oe--;for(;0<ye-oe;)J=Fe(J),ye--;for(;oe--;){if(ne===J||J!==null&&ne===J.alternate){Fe=ne;break t}ne=Fe(ne),J=Fe(J)}Fe=null}else Fe=null;de!==null&&hk(ve,ce,de,Fe,!1),Re!==null&&bt!==null&&hk(ve,bt,Re,Fe,!0)}}e:{if(ce=le?ac(le):window,de=ce.nodeName&&ce.nodeName.toLowerCase(),de==="select"||de==="input"&&ce.type==="file")var at=A1;else if(E1(ce))if(R1)at=OR;else{at=RR;var _e=AR}else de=ce.nodeName,!de||de.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?le&&gg(le.elementType)&&(at=A1):at=_R;if(at&&(at=at(a,le))){M1(ve,at,h,he);break e}_e&&_e(a,ce,le),a==="focusout"&&le&&ce.type==="number"&&le.memoizedProps.value!=null&&pg(ce,"number",ce.value)}switch(_e=le?ac(le):window,a){case"focusin":(E1(_e)||_e.contentEditable==="true")&&(Lo=_e,Mg=le,gc=null);break;case"focusout":gc=Mg=Lo=null;break;case"mousedown":Ag=!0;break;case"contextmenu":case"mouseup":case"dragend":Ag=!1,B1(ve,h,he);break;case"selectionchange":if(IR)break;case"keydown":case"keyup":B1(ve,h,he)}var We;if(Ng)e:{switch(a){case"compositionstart":var tt="onCompositionStart";break e;case"compositionend":tt="onCompositionEnd";break e;case"compositionupdate":tt="onCompositionUpdate";break e}tt=void 0}else Io?T1(a,h)&&(tt="onCompositionEnd"):a==="keydown"&&h.keyCode===229&&(tt="onCompositionStart");tt&&(k1&&h.locale!=="ko"&&(Io||tt!=="onCompositionStart"?tt==="onCompositionEnd"&&Io&&(We=x1()):(xi=he,vg="value"in xi?xi.value:xi.textContent,Io=!0)),_e=df(le,tt),0<_e.length&&(tt=new w1(tt,a,null,h,he),ve.push({event:tt,listeners:_e}),We?tt.data=We:(We=j1(h),We!==null&&(tt.data=We)))),(We=NR?TR(a,h):jR(a,h))&&(tt=df(le,"onBeforeInput"),0<tt.length&&(_e=new w1("onBeforeInput","beforeinput",null,h,he),ve.push({event:_e,listeners:tt}),_e.data=We)),x_(ve,a,le,h,he)}dk(ve,c)})}function Fc(a,c,h){return{instance:a,listener:c,currentTarget:h}}function df(a,c){for(var h=c+"Capture",x=[];a!==null;){var k=a,N=k.stateNode;if(k=k.tag,k!==5&&k!==26&&k!==27||N===null||(k=oc(a,h),k!=null&&x.unshift(Fc(a,k,N)),k=oc(a,c),k!=null&&x.push(Fc(a,k,N))),a.tag===3)return x;a=a.return}return[]}function S_(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function hk(a,c,h,x,k){for(var N=c._reactName,D=[];h!==null&&h!==x;){var $=h,G=$.alternate,le=$.stateNode;if($=$.tag,G!==null&&G===x)break;$!==5&&$!==26&&$!==27||le===null||(G=le,k?(le=oc(h,N),le!=null&&D.unshift(Fc(h,le,G))):k||(le=oc(h,N),le!=null&&D.push(Fc(h,le,G)))),h=h.return}D.length!==0&&a.push({event:c,listeners:D})}var k_=/\r\n?/g,C_=/\u0000|\uFFFD/g;function pk(a){return(typeof a=="string"?a:""+a).replace(k_,`
`).replace(C_,"")}function gk(a,c){return c=pk(c),pk(a)===c}function xt(a,c,h,x,k,N){switch(h){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||_o(a,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&_o(a,""+x);break;case"className":pd(a,"class",x);break;case"tabIndex":pd(a,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":pd(a,h,x);break;case"style":g1(a,x,N);break;case"data":if(c!=="object"){pd(a,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||h!=="href")){a.removeAttribute(h);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){a.removeAttribute(h);break}x=md(""+x),a.setAttribute(h,x);break;case"action":case"formAction":if(typeof x=="function"){a.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof N=="function"&&(h==="formAction"?(c!=="input"&&xt(a,c,"name",k.name,k,null),xt(a,c,"formEncType",k.formEncType,k,null),xt(a,c,"formMethod",k.formMethod,k,null),xt(a,c,"formTarget",k.formTarget,k,null)):(xt(a,c,"encType",k.encType,k,null),xt(a,c,"method",k.method,k,null),xt(a,c,"target",k.target,k,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){a.removeAttribute(h);break}x=md(""+x),a.setAttribute(h,x);break;case"onClick":x!=null&&(a.onclick=Is);break;case"onScroll":x!=null&&Je("scroll",a);break;case"onScrollEnd":x!=null&&Je("scrollend",a);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(h=x.__html,h!=null){if(k.children!=null)throw Error(r(60));a.innerHTML=h}}break;case"multiple":a.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":a.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){a.removeAttribute("xlink:href");break}h=md(""+x),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?a.setAttribute(h,""+x):a.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?a.setAttribute(h,""):a.removeAttribute(h);break;case"capture":case"download":x===!0?a.setAttribute(h,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?a.setAttribute(h,x):a.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?a.setAttribute(h,x):a.removeAttribute(h);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?a.removeAttribute(h):a.setAttribute(h,x);break;case"popover":Je("beforetoggle",a),Je("toggle",a),hd(a,"popover",x);break;case"xlinkActuate":Ds(a,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Ds(a,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Ds(a,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Ds(a,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Ds(a,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Ds(a,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Ds(a,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Ds(a,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Ds(a,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":hd(a,"is",x);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=JA.get(h)||h,hd(a,h,x))}}function t0(a,c,h,x,k,N){switch(h){case"style":g1(a,x,N);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(h=x.__html,h!=null){if(k.children!=null)throw Error(r(60));a.innerHTML=h}}break;case"children":typeof x=="string"?_o(a,x):(typeof x=="number"||typeof x=="bigint")&&_o(a,""+x);break;case"onScroll":x!=null&&Je("scroll",a);break;case"onScrollEnd":x!=null&&Je("scrollend",a);break;case"onClick":x!=null&&(a.onclick=Is);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!a1.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(k=h.endsWith("Capture"),c=h.slice(2,k?h.length-7:void 0),N=a[Wn]||null,N=N!=null?N[h]:null,typeof N=="function"&&a.removeEventListener(c,N,k),typeof x=="function")){typeof N!="function"&&N!==null&&(h in a?a[h]=null:a.hasAttribute(h)&&a.removeAttribute(h)),a.addEventListener(c,x,k);break e}h in a?a[h]=x:x===!0?a.setAttribute(h,""):hd(a,h,x)}}}function xn(a,c,h){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Je("error",a),Je("load",a);var x=!1,k=!1,N;for(N in h)if(h.hasOwnProperty(N)){var D=h[N];if(D!=null)switch(N){case"src":x=!0;break;case"srcSet":k=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:xt(a,c,N,D,h,null)}}k&&xt(a,c,"srcSet",h.srcSet,h,null),x&&xt(a,c,"src",h.src,h,null);return;case"input":Je("invalid",a);var $=N=D=k=null,G=null,le=null;for(x in h)if(h.hasOwnProperty(x)){var he=h[x];if(he!=null)switch(x){case"name":k=he;break;case"type":D=he;break;case"checked":G=he;break;case"defaultChecked":le=he;break;case"value":N=he;break;case"defaultValue":$=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(r(137,c));break;default:xt(a,c,x,he,h,null)}}d1(a,N,$,G,le,D,k,!1);return;case"select":Je("invalid",a),x=D=N=null;for(k in h)if(h.hasOwnProperty(k)&&($=h[k],$!=null))switch(k){case"value":N=$;break;case"defaultValue":D=$;break;case"multiple":x=$;default:xt(a,c,k,$,h,null)}c=N,h=D,a.multiple=!!x,c!=null?Ro(a,!!x,c,!1):h!=null&&Ro(a,!!x,h,!0);return;case"textarea":Je("invalid",a),N=k=x=null;for(D in h)if(h.hasOwnProperty(D)&&($=h[D],$!=null))switch(D){case"value":x=$;break;case"defaultValue":k=$;break;case"children":N=$;break;case"dangerouslySetInnerHTML":if($!=null)throw Error(r(91));break;default:xt(a,c,D,$,h,null)}h1(a,x,k,N);return;case"option":for(G in h)if(h.hasOwnProperty(G)&&(x=h[G],x!=null))switch(G){case"selected":a.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:xt(a,c,G,x,h,null)}return;case"dialog":Je("beforetoggle",a),Je("toggle",a),Je("cancel",a),Je("close",a);break;case"iframe":case"object":Je("load",a);break;case"video":case"audio":for(x=0;x<Bc.length;x++)Je(Bc[x],a);break;case"image":Je("error",a),Je("load",a);break;case"details":Je("toggle",a);break;case"embed":case"source":case"link":Je("error",a),Je("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in h)if(h.hasOwnProperty(le)&&(x=h[le],x!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:xt(a,c,le,x,h,null)}return;default:if(gg(c)){for(he in h)h.hasOwnProperty(he)&&(x=h[he],x!==void 0&&t0(a,c,he,x,h,void 0));return}}for($ in h)h.hasOwnProperty($)&&(x=h[$],x!=null&&xt(a,c,$,x,h,null))}function N_(a,c,h,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var k=null,N=null,D=null,$=null,G=null,le=null,he=null;for(de in h){var ve=h[de];if(h.hasOwnProperty(de)&&ve!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":G=ve;default:x.hasOwnProperty(de)||xt(a,c,de,null,x,ve)}}for(var ce in x){var de=x[ce];if(ve=h[ce],x.hasOwnProperty(ce)&&(de!=null||ve!=null))switch(ce){case"type":N=de;break;case"name":k=de;break;case"checked":le=de;break;case"defaultChecked":he=de;break;case"value":D=de;break;case"defaultValue":$=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(r(137,c));break;default:de!==ve&&xt(a,c,ce,de,x,ve)}}hg(a,D,$,G,le,he,N,k);return;case"select":de=D=$=ce=null;for(N in h)if(G=h[N],h.hasOwnProperty(N)&&G!=null)switch(N){case"value":break;case"multiple":de=G;default:x.hasOwnProperty(N)||xt(a,c,N,null,x,G)}for(k in x)if(N=x[k],G=h[k],x.hasOwnProperty(k)&&(N!=null||G!=null))switch(k){case"value":ce=N;break;case"defaultValue":$=N;break;case"multiple":D=N;default:N!==G&&xt(a,c,k,N,x,G)}c=$,h=D,x=de,ce!=null?Ro(a,!!h,ce,!1):!!x!=!!h&&(c!=null?Ro(a,!!h,c,!0):Ro(a,!!h,h?[]:"",!1));return;case"textarea":de=ce=null;for($ in h)if(k=h[$],h.hasOwnProperty($)&&k!=null&&!x.hasOwnProperty($))switch($){case"value":break;case"children":break;default:xt(a,c,$,null,x,k)}for(D in x)if(k=x[D],N=h[D],x.hasOwnProperty(D)&&(k!=null||N!=null))switch(D){case"value":ce=k;break;case"defaultValue":de=k;break;case"children":break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(r(91));break;default:k!==N&&xt(a,c,D,k,x,N)}f1(a,ce,de);return;case"option":for(var Re in h)if(ce=h[Re],h.hasOwnProperty(Re)&&ce!=null&&!x.hasOwnProperty(Re))switch(Re){case"selected":a.selected=!1;break;default:xt(a,c,Re,null,x,ce)}for(G in x)if(ce=x[G],de=h[G],x.hasOwnProperty(G)&&ce!==de&&(ce!=null||de!=null))switch(G){case"selected":a.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:xt(a,c,G,ce,x,de)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Fe in h)ce=h[Fe],h.hasOwnProperty(Fe)&&ce!=null&&!x.hasOwnProperty(Fe)&&xt(a,c,Fe,null,x,ce);for(le in x)if(ce=x[le],de=h[le],x.hasOwnProperty(le)&&ce!==de&&(ce!=null||de!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(r(137,c));break;default:xt(a,c,le,ce,x,de)}return;default:if(gg(c)){for(var bt in h)ce=h[bt],h.hasOwnProperty(bt)&&ce!==void 0&&!x.hasOwnProperty(bt)&&t0(a,c,bt,void 0,x,ce);for(he in x)ce=x[he],de=h[he],!x.hasOwnProperty(he)||ce===de||ce===void 0&&de===void 0||t0(a,c,he,ce,x,de);return}}for(var ne in h)ce=h[ne],h.hasOwnProperty(ne)&&ce!=null&&!x.hasOwnProperty(ne)&&xt(a,c,ne,null,x,ce);for(ve in x)ce=x[ve],de=h[ve],!x.hasOwnProperty(ve)||ce===de||ce==null&&de==null||xt(a,c,ve,ce,x,de)}function mk(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function T_(){if(typeof performance.getEntriesByType=="function"){for(var a=0,c=0,h=performance.getEntriesByType("resource"),x=0;x<h.length;x++){var k=h[x],N=k.transferSize,D=k.initiatorType,$=k.duration;if(N&&$&&mk(D)){for(D=0,$=k.responseEnd,x+=1;x<h.length;x++){var G=h[x],le=G.startTime;if(le>$)break;var he=G.transferSize,ve=G.initiatorType;he&&mk(ve)&&(G=G.responseEnd,D+=he*(G<$?1:($-le)/(G-le)))}if(--x,c+=8*(N+D)/(k.duration/1e3),a++,10<a)break}}if(0<a)return c/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var n0=null,r0=null;function ff(a){return a.nodeType===9?a:a.ownerDocument}function yk(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function xk(a,c){if(a===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&c==="foreignObject"?0:a}function s0(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var i0=null;function j_(){var a=window.event;return a&&a.type==="popstate"?a===i0?!1:(i0=a,!0):(i0=null,!1)}var bk=typeof setTimeout=="function"?setTimeout:void 0,E_=typeof clearTimeout=="function"?clearTimeout:void 0,vk=typeof Promise=="function"?Promise:void 0,M_=typeof queueMicrotask=="function"?queueMicrotask:typeof vk<"u"?function(a){return vk.resolve(null).then(a).catch(A_)}:bk;function A_(a){setTimeout(function(){throw a})}function Ii(a){return a==="head"}function wk(a,c){var h=c,x=0;do{var k=h.nextSibling;if(a.removeChild(h),k&&k.nodeType===8)if(h=k.data,h==="/$"||h==="/&"){if(x===0){a.removeChild(k),cl(c);return}x--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")x++;else if(h==="html")Uc(a.ownerDocument.documentElement);else if(h==="head"){h=a.ownerDocument.head,Uc(h);for(var N=h.firstChild;N;){var D=N.nextSibling,$=N.nodeName;N[ic]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&N.rel.toLowerCase()==="stylesheet"||h.removeChild(N),N=D}}else h==="body"&&Uc(a.ownerDocument.body);h=k}while(h);cl(c)}function Sk(a,c){var h=a;a=0;do{var x=h.nextSibling;if(h.nodeType===1?c?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(c?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),x&&x.nodeType===8)if(h=x.data,h==="/$"){if(a===0)break;a--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||a++;h=x}while(h)}function a0(a){var c=a.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var h=c;switch(c=c.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":a0(h),dg(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}a.removeChild(h)}}function R_(a,c,h,x){for(;a.nodeType===1;){var k=h;if(a.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(x){if(!a[ic])switch(c){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(N=a.getAttribute("rel"),N==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(N!==k.rel||a.getAttribute("href")!==(k.href==null||k.href===""?null:k.href)||a.getAttribute("crossorigin")!==(k.crossOrigin==null?null:k.crossOrigin)||a.getAttribute("title")!==(k.title==null?null:k.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(N=a.getAttribute("src"),(N!==(k.src==null?null:k.src)||a.getAttribute("type")!==(k.type==null?null:k.type)||a.getAttribute("crossorigin")!==(k.crossOrigin==null?null:k.crossOrigin))&&N&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(c==="input"&&a.type==="hidden"){var N=k.name==null?null:""+k.name;if(k.type==="hidden"&&a.getAttribute("name")===N)return a}else return a;if(a=Ir(a.nextSibling),a===null)break}return null}function __(a,c,h){if(c==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!h||(a=Ir(a.nextSibling),a===null))return null;return a}function kk(a,c){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=Ir(a.nextSibling),a===null))return null;return a}function o0(a){return a.data==="$?"||a.data==="$~"}function l0(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function O_(a,c){var h=a.ownerDocument;if(a.data==="$~")a._reactRetry=c;else if(a.data!=="$?"||h.readyState!=="loading")c();else{var x=function(){c(),h.removeEventListener("DOMContentLoaded",x)};h.addEventListener("DOMContentLoaded",x),a._reactRetry=x}}function Ir(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return a}var c0=null;function Ck(a){a=a.nextSibling;for(var c=0;a;){if(a.nodeType===8){var h=a.data;if(h==="/$"||h==="/&"){if(c===0)return Ir(a.nextSibling);c--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||c++}a=a.nextSibling}return null}function Nk(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var h=a.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(c===0)return a;c--}else h!=="/$"&&h!=="/&"||c++}a=a.previousSibling}return null}function Tk(a,c,h){switch(c=ff(h),a){case"html":if(a=c.documentElement,!a)throw Error(r(452));return a;case"head":if(a=c.head,!a)throw Error(r(453));return a;case"body":if(a=c.body,!a)throw Error(r(454));return a;default:throw Error(r(451))}}function Uc(a){for(var c=a.attributes;c.length;)a.removeAttributeNode(c[0]);dg(a)}var Lr=new Map,jk=new Set;function hf(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Xs=V.d;V.d={f:D_,r:I_,D:L_,C:z_,L:P_,m:B_,X:U_,S:F_,M:$_};function D_(){var a=Xs.f(),c=rf();return a||c}function I_(a){var c=Eo(a);c!==null&&c.tag===5&&c.type==="form"?Hw(c):Xs.r(a)}var al=typeof document>"u"?null:document;function Ek(a,c,h){var x=al;if(x&&typeof c=="string"&&c){var k=Er(c);k='link[rel="'+a+'"][href="'+k+'"]',typeof h=="string"&&(k+='[crossorigin="'+h+'"]'),jk.has(k)||(jk.add(k),a={rel:a,crossOrigin:h,href:c},x.querySelector(k)===null&&(c=x.createElement("link"),xn(c,"link",a),on(c),x.head.appendChild(c)))}}function L_(a){Xs.D(a),Ek("dns-prefetch",a,null)}function z_(a,c){Xs.C(a,c),Ek("preconnect",a,c)}function P_(a,c,h){Xs.L(a,c,h);var x=al;if(x&&a&&c){var k='link[rel="preload"][as="'+Er(c)+'"]';c==="image"&&h&&h.imageSrcSet?(k+='[imagesrcset="'+Er(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(k+='[imagesizes="'+Er(h.imageSizes)+'"]')):k+='[href="'+Er(a)+'"]';var N=k;switch(c){case"style":N=ol(a);break;case"script":N=ll(a)}Lr.has(N)||(a=g({rel:"preload",href:c==="image"&&h&&h.imageSrcSet?void 0:a,as:c},h),Lr.set(N,a),x.querySelector(k)!==null||c==="style"&&x.querySelector($c(N))||c==="script"&&x.querySelector(qc(N))||(c=x.createElement("link"),xn(c,"link",a),on(c),x.head.appendChild(c)))}}function B_(a,c){Xs.m(a,c);var h=al;if(h&&a){var x=c&&typeof c.as=="string"?c.as:"script",k='link[rel="modulepreload"][as="'+Er(x)+'"][href="'+Er(a)+'"]',N=k;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":N=ll(a)}if(!Lr.has(N)&&(a=g({rel:"modulepreload",href:a},c),Lr.set(N,a),h.querySelector(k)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(qc(N)))return}x=h.createElement("link"),xn(x,"link",a),on(x),h.head.appendChild(x)}}}function F_(a,c,h){Xs.S(a,c,h);var x=al;if(x&&a){var k=Mo(x).hoistableStyles,N=ol(a);c=c||"default";var D=k.get(N);if(!D){var $={loading:0,preload:null};if(D=x.querySelector($c(N)))$.loading=5;else{a=g({rel:"stylesheet",href:a,"data-precedence":c},h),(h=Lr.get(N))&&u0(a,h);var G=D=x.createElement("link");on(G),xn(G,"link",a),G._p=new Promise(function(le,he){G.onload=le,G.onerror=he}),G.addEventListener("load",function(){$.loading|=1}),G.addEventListener("error",function(){$.loading|=2}),$.loading|=4,pf(D,c,x)}D={type:"stylesheet",instance:D,count:1,state:$},k.set(N,D)}}}function U_(a,c){Xs.X(a,c);var h=al;if(h&&a){var x=Mo(h).hoistableScripts,k=ll(a),N=x.get(k);N||(N=h.querySelector(qc(k)),N||(a=g({src:a,async:!0},c),(c=Lr.get(k))&&d0(a,c),N=h.createElement("script"),on(N),xn(N,"link",a),h.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},x.set(k,N))}}function $_(a,c){Xs.M(a,c);var h=al;if(h&&a){var x=Mo(h).hoistableScripts,k=ll(a),N=x.get(k);N||(N=h.querySelector(qc(k)),N||(a=g({src:a,async:!0,type:"module"},c),(c=Lr.get(k))&&d0(a,c),N=h.createElement("script"),on(N),xn(N,"link",a),h.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},x.set(k,N))}}function Mk(a,c,h,x){var k=(k=se.current)?hf(k):null;if(!k)throw Error(r(446));switch(a){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(c=ol(h.href),h=Mo(k).hoistableStyles,x=h.get(c),x||(x={type:"style",instance:null,count:0,state:null},h.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){a=ol(h.href);var N=Mo(k).hoistableStyles,D=N.get(a);if(D||(k=k.ownerDocument||k,D={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},N.set(a,D),(N=k.querySelector($c(a)))&&!N._p&&(D.instance=N,D.state.loading=5),Lr.has(a)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Lr.set(a,h),N||q_(k,a,h,D.state))),c&&x===null)throw Error(r(528,""));return D}if(c&&x!==null)throw Error(r(529,""));return null;case"script":return c=h.async,h=h.src,typeof h=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=ll(h),h=Mo(k).hoistableScripts,x=h.get(c),x||(x={type:"script",instance:null,count:0,state:null},h.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,a))}}function ol(a){return'href="'+Er(a)+'"'}function $c(a){return'link[rel="stylesheet"]['+a+"]"}function Ak(a){return g({},a,{"data-precedence":a.precedence,precedence:null})}function q_(a,c,h,x){a.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=a.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),xn(c,"link",h),on(c),a.head.appendChild(c))}function ll(a){return'[src="'+Er(a)+'"]'}function qc(a){return"script[async]"+a}function Rk(a,c,h){if(c.count++,c.instance===null)switch(c.type){case"style":var x=a.querySelector('style[data-href~="'+Er(h.href)+'"]');if(x)return c.instance=x,on(x),x;var k=g({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return x=(a.ownerDocument||a).createElement("style"),on(x),xn(x,"style",k),pf(x,h.precedence,a),c.instance=x;case"stylesheet":k=ol(h.href);var N=a.querySelector($c(k));if(N)return c.state.loading|=4,c.instance=N,on(N),N;x=Ak(h),(k=Lr.get(k))&&u0(x,k),N=(a.ownerDocument||a).createElement("link"),on(N);var D=N;return D._p=new Promise(function($,G){D.onload=$,D.onerror=G}),xn(N,"link",x),c.state.loading|=4,pf(N,h.precedence,a),c.instance=N;case"script":return N=ll(h.src),(k=a.querySelector(qc(N)))?(c.instance=k,on(k),k):(x=h,(k=Lr.get(N))&&(x=g({},h),d0(x,k)),a=a.ownerDocument||a,k=a.createElement("script"),on(k),xn(k,"link",x),a.head.appendChild(k),c.instance=k);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,pf(x,h.precedence,a));return c.instance}function pf(a,c,h){for(var x=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),k=x.length?x[x.length-1]:null,N=k,D=0;D<x.length;D++){var $=x[D];if($.dataset.precedence===c)N=$;else if(N!==k)break}N?N.parentNode.insertBefore(a,N.nextSibling):(c=h.nodeType===9?h.head:h,c.insertBefore(a,c.firstChild))}function u0(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.title==null&&(a.title=c.title)}function d0(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.integrity==null&&(a.integrity=c.integrity)}var gf=null;function _k(a,c,h){if(gf===null){var x=new Map,k=gf=new Map;k.set(h,x)}else k=gf,x=k.get(h),x||(x=new Map,k.set(h,x));if(x.has(a))return x;for(x.set(a,null),h=h.getElementsByTagName(a),k=0;k<h.length;k++){var N=h[k];if(!(N[ic]||N[pn]||a==="link"&&N.getAttribute("rel")==="stylesheet")&&N.namespaceURI!=="http://www.w3.org/2000/svg"){var D=N.getAttribute(c)||"";D=a+D;var $=x.get(D);$?$.push(N):x.set(D,[N])}}return x}function Ok(a,c,h){a=a.ownerDocument||a,a.head.insertBefore(h,c==="title"?a.querySelector("head > title"):null)}function H_(a,c,h){if(h===1||c.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return a=c.disabled,typeof c.precedence=="string"&&a==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function Dk(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function V_(a,c,h,x){if(h.type==="stylesheet"&&(typeof x.media!="string"||matchMedia(x.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var k=ol(x.href),N=c.querySelector($c(k));if(N){c=N._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(a.count++,a=mf.bind(a),c.then(a,a)),h.state.loading|=4,h.instance=N,on(N);return}N=c.ownerDocument||c,x=Ak(x),(k=Lr.get(k))&&u0(x,k),N=N.createElement("link"),on(N);var D=N;D._p=new Promise(function($,G){D.onload=$,D.onerror=G}),xn(N,"link",x),h.instance=N}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(h,c),(c=h.state.preload)&&(h.state.loading&3)===0&&(a.count++,h=mf.bind(a),c.addEventListener("load",h),c.addEventListener("error",h))}}var f0=0;function K_(a,c){return a.stylesheets&&a.count===0&&xf(a,a.stylesheets),0<a.count||0<a.imgCount?function(h){var x=setTimeout(function(){if(a.stylesheets&&xf(a,a.stylesheets),a.unsuspend){var N=a.unsuspend;a.unsuspend=null,N()}},6e4+c);0<a.imgBytes&&f0===0&&(f0=62500*T_());var k=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&xf(a,a.stylesheets),a.unsuspend)){var N=a.unsuspend;a.unsuspend=null,N()}},(a.imgBytes>f0?50:800)+c);return a.unsuspend=h,function(){a.unsuspend=null,clearTimeout(x),clearTimeout(k)}}:null}function mf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)xf(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var yf=null;function xf(a,c){a.stylesheets=null,a.unsuspend!==null&&(a.count++,yf=new Map,c.forEach(Q_,a),yf=null,mf.call(a))}function Q_(a,c){if(!(c.state.loading&4)){var h=yf.get(a);if(h)var x=h.get(null);else{h=new Map,yf.set(a,h);for(var k=a.querySelectorAll("link[data-precedence],style[data-precedence]"),N=0;N<k.length;N++){var D=k[N];(D.nodeName==="LINK"||D.getAttribute("media")!=="not all")&&(h.set(D.dataset.precedence,D),x=D)}x&&h.set(null,x)}k=c.instance,D=k.getAttribute("data-precedence"),N=h.get(D)||x,N===x&&h.set(null,k),h.set(D,k),this.count++,x=mf.bind(this),k.addEventListener("load",x),k.addEventListener("error",x),N?N.parentNode.insertBefore(k,N.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(k,a.firstChild)),c.state.loading|=4}}var Hc={$$typeof:j,Provider:null,Consumer:null,_currentValue:ie,_currentValue2:ie,_threadCount:0};function W_(a,c,h,x,k,N,D,$,G){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Qn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qn(0),this.hiddenUpdates=Qn(null),this.identifierPrefix=x,this.onUncaughtError=k,this.onCaughtError=N,this.onRecoverableError=D,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function Ik(a,c,h,x,k,N,D,$,G,le,he,ve){return a=new W_(a,c,h,D,G,le,he,ve,$),c=1,N===!0&&(c|=24),N=dr(3,null,null,c),a.current=N,N.stateNode=a,c=Vg(),c.refCount++,a.pooledCache=c,c.refCount++,N.memoizedState={element:x,isDehydrated:h,cache:c},Yg(N),a}function Lk(a){return a?(a=Bo,a):Bo}function zk(a,c,h,x,k,N){k=Lk(k),x.context===null?x.context=k:x.pendingContext=k,x=Ci(c),x.payload={element:h},N=N===void 0?null:N,N!==null&&(x.callback=N),h=Ni(a,x,c),h!==null&&(er(h,a,c),Sc(h,a,c))}function Pk(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var h=a.retryLane;a.retryLane=h!==0&&h<c?h:c}}function h0(a,c){Pk(a,c),(a=a.alternate)&&Pk(a,c)}function Bk(a){if(a.tag===13||a.tag===31){var c=va(a,67108864);c!==null&&er(c,a,67108864),h0(a,67108864)}}function Fk(a){if(a.tag===13||a.tag===31){var c=mr();c=_s(c);var h=va(a,c);h!==null&&er(h,a,c),h0(a,c)}}var bf=!0;function Y_(a,c,h,x){var k=q.T;q.T=null;var N=V.p;try{V.p=2,p0(a,c,h,x)}finally{V.p=N,q.T=k}}function G_(a,c,h,x){var k=q.T;q.T=null;var N=V.p;try{V.p=8,p0(a,c,h,x)}finally{V.p=N,q.T=k}}function p0(a,c,h,x){if(bf){var k=g0(x);if(k===null)e0(a,c,x,vf,h),$k(a,x);else if(J_(k,a,c,h,x))x.stopPropagation();else if($k(a,x),c&4&&-1<X_.indexOf(a)){for(;k!==null;){var N=Eo(k);if(N!==null)switch(N.tag){case 3:if(N=N.stateNode,N.current.memoizedState.isDehydrated){var D=Tt(N.pendingLanes);if(D!==0){var $=N;for($.pendingLanes|=2,$.entangledLanes|=2;D;){var G=1<<31-Nt(D);$.entanglements[1]|=G,D&=~G}ms(N),(ct&6)===0&&(tf=Ce()+500,Pc(0))}}break;case 31:case 13:$=va(N,2),$!==null&&er($,N,2),rf(),h0(N,2)}if(N=g0(x),N===null&&e0(a,c,x,vf,h),N===k)break;k=N}k!==null&&x.stopPropagation()}else e0(a,c,x,null,h)}}function g0(a){return a=yg(a),m0(a)}var vf=null;function m0(a){if(vf=null,a=jo(a),a!==null){var c=i(a);if(c===null)a=null;else{var h=c.tag;if(h===13){if(a=o(c),a!==null)return a;a=null}else if(h===31){if(a=l(c),a!==null)return a;a=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null)}}return vf=a,null}function Uk(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Te()){case De:return 2;case Ze:return 8;case Ue:case $t:return 32;case Jr:return 268435456;default:return 32}default:return 32}}var y0=!1,Li=null,zi=null,Pi=null,Vc=new Map,Kc=new Map,Bi=[],X_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $k(a,c){switch(a){case"focusin":case"focusout":Li=null;break;case"dragenter":case"dragleave":zi=null;break;case"mouseover":case"mouseout":Pi=null;break;case"pointerover":case"pointerout":Vc.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kc.delete(c.pointerId)}}function Qc(a,c,h,x,k,N){return a===null||a.nativeEvent!==N?(a={blockedOn:c,domEventName:h,eventSystemFlags:x,nativeEvent:N,targetContainers:[k]},c!==null&&(c=Eo(c),c!==null&&Bk(c)),a):(a.eventSystemFlags|=x,c=a.targetContainers,k!==null&&c.indexOf(k)===-1&&c.push(k),a)}function J_(a,c,h,x,k){switch(c){case"focusin":return Li=Qc(Li,a,c,h,x,k),!0;case"dragenter":return zi=Qc(zi,a,c,h,x,k),!0;case"mouseover":return Pi=Qc(Pi,a,c,h,x,k),!0;case"pointerover":var N=k.pointerId;return Vc.set(N,Qc(Vc.get(N)||null,a,c,h,x,k)),!0;case"gotpointercapture":return N=k.pointerId,Kc.set(N,Qc(Kc.get(N)||null,a,c,h,x,k)),!0}return!1}function qk(a){var c=jo(a.target);if(c!==null){var h=i(c);if(h!==null){if(c=h.tag,c===13){if(c=o(h),c!==null){a.blockedOn=c,yi(a.priority,function(){Fk(h)});return}}else if(c===31){if(c=l(h),c!==null){a.blockedOn=c,yi(a.priority,function(){Fk(h)});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){a.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}a.blockedOn=null}function wf(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var h=g0(a.nativeEvent);if(h===null){h=a.nativeEvent;var x=new h.constructor(h.type,h);mg=x,h.target.dispatchEvent(x),mg=null}else return c=Eo(h),c!==null&&Bk(c),a.blockedOn=h,!1;c.shift()}return!0}function Hk(a,c,h){wf(a)&&h.delete(c)}function Z_(){y0=!1,Li!==null&&wf(Li)&&(Li=null),zi!==null&&wf(zi)&&(zi=null),Pi!==null&&wf(Pi)&&(Pi=null),Vc.forEach(Hk),Kc.forEach(Hk)}function Sf(a,c){a.blockedOn===c&&(a.blockedOn=null,y0||(y0=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Z_)))}var kf=null;function Vk(a){kf!==a&&(kf=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){kf===a&&(kf=null);for(var c=0;c<a.length;c+=3){var h=a[c],x=a[c+1],k=a[c+2];if(typeof x!="function"){if(m0(x||h)===null)continue;break}var N=Eo(h);N!==null&&(a.splice(c,3),c-=3,gm(N,{pending:!0,data:k,method:h.method,action:x},x,k))}}))}function cl(a){function c(G){return Sf(G,a)}Li!==null&&Sf(Li,a),zi!==null&&Sf(zi,a),Pi!==null&&Sf(Pi,a),Vc.forEach(c),Kc.forEach(c);for(var h=0;h<Bi.length;h++){var x=Bi[h];x.blockedOn===a&&(x.blockedOn=null)}for(;0<Bi.length&&(h=Bi[0],h.blockedOn===null);)qk(h),h.blockedOn===null&&Bi.shift();if(h=(a.ownerDocument||a).$$reactFormReplay,h!=null)for(x=0;x<h.length;x+=3){var k=h[x],N=h[x+1],D=k[Wn]||null;if(typeof N=="function")D||Vk(h);else if(D){var $=null;if(N&&N.hasAttribute("formAction")){if(k=N,D=N[Wn]||null)$=D.formAction;else if(m0(k)!==null)continue}else $=D.action;typeof $=="function"?h[x+1]=$:(h.splice(x,3),x-=3),Vk(h)}}}function Kk(){function a(N){N.canIntercept&&N.info==="react-transition"&&N.intercept({handler:function(){return new Promise(function(D){return k=D})},focusReset:"manual",scroll:"manual"})}function c(){k!==null&&(k(),k=null),x||setTimeout(h,20)}function h(){if(!x&&!navigation.transition){var N=navigation.currentEntry;N&&N.url!=null&&navigation.navigate(N.url,{state:N.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var x=!1,k=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(h,100),function(){x=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),k!==null&&(k(),k=null)}}}function x0(a){this._internalRoot=a}Cf.prototype.render=x0.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(r(409));var h=c.current,x=mr();zk(h,x,a,c,null,null)},Cf.prototype.unmount=x0.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;zk(a.current,2,null,a,null,null),rf(),c[To]=null}};function Cf(a){this._internalRoot=a}Cf.prototype.unstable_scheduleHydration=function(a){if(a){var c=es();a={blockedOn:null,target:a,priority:c};for(var h=0;h<Bi.length&&c!==0&&c<Bi[h].priority;h++);Bi.splice(h,0,a),h===0&&qk(a)}};var Qk=e.version;if(Qk!=="19.2.0")throw Error(r(527,Qk,"19.2.0"));V.findDOMNode=function(a){var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=f(c),a=a!==null?p(a):null,a=a===null?null:a.stateNode,a};var e4={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nf.isDisabled&&Nf.supportsFiber)try{dt=Nf.inject(e4),qt=Nf}catch{}}return Jc.createRoot=function(a,c){if(!s(a))throw Error(r(299));var h=!1,x="",k=eS,N=tS,D=nS;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(k=c.onUncaughtError),c.onCaughtError!==void 0&&(N=c.onCaughtError),c.onRecoverableError!==void 0&&(D=c.onRecoverableError)),c=Ik(a,1,!1,null,null,h,x,null,k,N,D,Kk),a[To]=c.current,Zm(a),new x0(c)},Jc.hydrateRoot=function(a,c,h){if(!s(a))throw Error(r(299));var x=!1,k="",N=eS,D=tS,$=nS,G=null;return h!=null&&(h.unstable_strictMode===!0&&(x=!0),h.identifierPrefix!==void 0&&(k=h.identifierPrefix),h.onUncaughtError!==void 0&&(N=h.onUncaughtError),h.onCaughtError!==void 0&&(D=h.onCaughtError),h.onRecoverableError!==void 0&&($=h.onRecoverableError),h.formState!==void 0&&(G=h.formState)),c=Ik(a,1,!0,c,h??null,x,k,G,N,D,$,Kk),c.context=Lk(null),h=c.current,x=mr(),x=_s(x),k=Ci(x),k.callback=null,Ni(h,k,x),h=x,c.current.lanes=h,Cr(c,h),ms(c),a[To]=c.current,Zm(a),new Cf(c)},Jc.version="19.2.0",Jc}var C2;function eD(){if(C2)return R0.exports;C2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),R0.exports=ZO(),R0.exports}var tD=eD();const nD=Ql(tD),pj="church-hub-api-url",rD="church-hub-user-auth",N2=/\/api\/auth\/user\/(usr_[A-Za-z0-9_]+)$/;function Ep(t){const e=t.match(N2);if(e){const n=e[1];return{baseUrl:t.replace(N2,""),userToken:n}}return{baseUrl:t.replace(/\/+$/,""),userToken:null}}function Mp(){if(typeof window>"u")return null;try{return localStorage.getItem(pj)}catch{return null}}function gj(t){if(!(typeof window>"u"))try{const{baseUrl:e,userToken:n}=Ep(t);localStorage.setItem(pj,e),n&&(localStorage.setItem(rD,n),document.cookie=`user_auth=${n}; path=/; SameSite=Lax`)}catch(e){console.error("Failed to save API URL:",e)}}function mj(t){try{const{baseUrl:e}=Ep(t),n=new URL(e);return n.protocol==="http:"||n.protocol==="https:"}catch{return!1}}async function yj(t){try{const{baseUrl:e,userToken:n}=Ep(t);return(await fetch(`${e}/ping`,{method:"GET",signal:AbortSignal.timeout(5e3)})).ok?n?(await fetch(`${e}/api/me`,{method:"GET",headers:{Cookie:`user_auth=${n}`},credentials:"include",signal:AbortSignal.timeout(5e3)})).ok:!0:!1}catch{return!1}}const xj="3000",vb=typeof window<"u"&&"__TAURI_INTERNALS__"in window;function oo(){if(typeof window>"u"||!vb)return!1;const t=navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")||t.includes("ipod")||t.includes("android")}function bj(){return oo()?Mp()===null:!1}function vj(){return vb&&!oo()?"localhost":typeof window<"u"&&window.location.hostname?window.location.hostname:"127.0.0.1"}function Ct(){return oo()?Mp():`http://${vj()}:${xj}`}function sD(){if(oo()){const t=Mp();return t?t.replace(/^http/,"ws"):null}return`ws://${vj()}:${xj}`}function T2(){if(typeof window>"u"||oo())return!1;if(vb)return!0;const t=window.location.hostname.toLowerCase();return t==="localhost"||t==="127.0.0.1"||t==="::1"||t.startsWith("127.")||t==="tauri.localhost"}const iD=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),aD=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),j2=t=>{const e=aD(t);return e.charAt(0).toUpperCase()+e.slice(1)},wj=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),oD=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var lD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const cD=C.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...l},d)=>C.createElement("svg",{ref:d,...lD,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:wj("lucide",s),...!i&&!oD(l)&&{"aria-hidden":"true"},...l},[...o.map(([f,p])=>C.createElement(f,p)),...Array.isArray(i)?i:[i]]));const je=(t,e)=>{const n=C.forwardRef(({className:r,...s},i)=>C.createElement(cD,{ref:i,iconNode:e,className:wj(`lucide-${iD(j2(t))}`,`lucide-${t}`,r),...s}));return n.displayName=j2(t),n};const uD=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],dD=je("arrow-left-right",uD);const fD=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ed=je("arrow-left",fD);const hD=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Sj=je("bell",hD);const pD=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Ap=je("book-open",pD);const gD=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],wr=je("book",gD);const mD=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],kj=je("bookmark",mD);const yD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Rp=je("calendar-days",yD);const xD=[["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M21 12.598V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8.5",key:"1glfrc"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}]],bh=je("calendar-plus",xD);const bD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Cj=je("calendar",bD);const vD=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],wb=je("check",vD);const wD=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Es=je("chevron-down",wD);const SD=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Nj=je("chevron-left",SD);const kD=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ms=je("chevron-right",kD);const CD=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Sb=je("chevron-up",CD);const ND=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],vh=je("circle-alert",ND);const TD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],jD=je("circle-plus",TD);const ED=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],_p=je("clock",ED);const MD=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Tj=je("compass",MD);const AD=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],td=je("copy",AD);const RD=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],wh=je("download",RD);const _D=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Op=je("ellipsis-vertical",_D);const OD=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Dp=je("external-link",OD);const DD=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Wl=je("eye-off",DD);const ID=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ua=je("eye",ID);const LD=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],zD=je("file-question-mark",LD);const PD=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ds=je("file-text",PD);const BD=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],Ru=je("file-up",BD);const FD=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]],UD=je("film",FD);const $D=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],jj=je("folder-open",$D);const qD=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Ej=je("folder",qD);const HD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],nd=je("globe",HD);const VD=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],Mj=je("grid-3x3",VD);const KD=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],or=je("grip-vertical",KD);const QD=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Aj=je("heart",QD);const WD=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Rj=je("house",WD);const YD=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],_j=je("image",YD);const GD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],XD=je("info",GD);const JD=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],ZD=je("key-round",JD);const eI=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],tI=je("key",eI);const nI=[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]],E2=je("keyboard",nI);const rI=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],sI=je("languages",rI);const iI=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Oj=je("layers",iI);const aI=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Dj=je("link",aI);const oI=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M11 19H3",key:"zflm78"}],["path",{d:"M21 16V5",key:"yxg4q8"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],Ij=je("list-music",oI);const lI=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 19H3",key:"zzsher"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]],cI=je("list-plus",lI);const uI=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Lj=je("list",uI);const dI=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Qe=je("loader-circle",dI);const fI=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],zj=je("mail",fI);const hI=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],Pj=je("map",hI);const pI=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],gI=je("maximize",pI);const mI=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],lo=je("megaphone",mI);const yI=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],xI=je("menu",yI);const bI=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Bj=je("message-square",bI);const vI=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],wI=je("minimize",vI);const SI=[["path",{d:"m9 10 3-3 3 3",key:"11gsxs"}],["path",{d:"M12 13V7",key:"h0r20n"}],["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M8 21h8",key:"1ev6f3"}]],Sh=je("monitor-up",SI);const kI=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],CI=je("move",kI);const NI=[["circle",{cx:"8",cy:"18",r:"4",key:"1fc0mg"}],["path",{d:"M12 18V2l7 4",key:"g04rme"}]],TI=je("music-2",NI);const jI=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],ha=je("music",jI);const EI=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Fj=je("palette",EI);const MI=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],AI=je("panel-left",MI);const RI=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],M2=je("pen-line",RI);const _I=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Xa=je("pencil",_I);const OI=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Uj=je("phone",OI);const DI=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],kb=je("play",DI);const II=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Xt=je("plus",II);const LI=[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],zI=je("power-off",LI);const PI=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],$j=je("power",PI);const BI=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],A2=je("qr-code",BI);const FI=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],UI=je("radio",FI);const $I=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],qI=je("redo-2",$I);const HI=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Cb=je("refresh-cw",HI);const VI=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],KI=je("rotate-ccw",VI);const QI=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],rd=je("save",QI);const WI=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Yl=je("search",WI);const YI=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],qj=je("server",YI);const GI=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ui=je("settings",GI);const XI=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]],JI=je("shield-x",XI);const ZI=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Hj=je("square-pen",ZI);const e6=[["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}],["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}]],t6=je("square-play",e6);const n6=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Vj=je("square",n6);const r6=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Kj=je("star",r6);const s6=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],i6=je("tag",s6);const a6=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Bn=je("trash-2",a6);const o6=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],l6=je("triangle-alert",o6);const c6=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],_f=je("type",c6);const u6=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],d6=je("undo-2",u6);const f6=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],R2=je("upload",f6);const h6=[["circle",{cx:"10",cy:"7",r:"1",key:"dypaad"}],["circle",{cx:"4",cy:"20",r:"1",key:"22iqad"}],["path",{d:"M4.7 19.3 19 5",key:"1enqfc"}],["path",{d:"m21 3-3 1 2 2Z",key:"d3ov82"}],["path",{d:"M9.26 7.68 5 12l2 5",key:"1esawj"}],["path",{d:"m10 14 5 2 3.5-3.5",key:"v8oal5"}],["path",{d:"m18 12 1-1 1 1-1 1Z",key:"1bh22v"}]],p6=je("usb",h6);const g6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Bl=je("users",g6);const m6=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Qj=je("video",m6);const y6=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],x6=je("volume-2",y6);const b6=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],v6=je("volume-x",b6);const w6=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Wj=je("wifi-off",w6);const S6=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],kh=je("wifi",S6);const k6=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],nt=je("x",k6);const C6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],N6=je("zoom-in",C6);const T6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],j6=je("zoom-out",T6),$e=t=>typeof t=="string",Zc=()=>{let t,e;const n=new Promise((r,s)=>{t=r,e=s});return n.resolve=t,n.reject=e,n},_2=t=>t==null?"":""+t,E6=(t,e,n)=>{t.forEach(r=>{e[r]&&(n[r]=e[r])})},M6=/###/g,O2=t=>t&&t.indexOf("###")>-1?t.replace(M6,"."):t,D2=t=>!t||$e(t),hu=(t,e,n)=>{const r=$e(e)?e.split("."):e;let s=0;for(;s<r.length-1;){if(D2(t))return{};const i=O2(r[s]);!t[i]&&n&&(t[i]=new n),Object.prototype.hasOwnProperty.call(t,i)?t=t[i]:t={},++s}return D2(t)?{}:{obj:t,k:O2(r[s])}},I2=(t,e,n)=>{const{obj:r,k:s}=hu(t,e,Object);if(r!==void 0||e.length===1){r[s]=n;return}let i=e[e.length-1],o=e.slice(0,e.length-1),l=hu(t,o,Object);for(;l.obj===void 0&&o.length;)i=`${o[o.length-1]}.${i}`,o=o.slice(0,o.length-1),l=hu(t,o,Object),l?.obj&&typeof l.obj[`${l.k}.${i}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${i}`]=n},A6=(t,e,n,r)=>{const{obj:s,k:i}=hu(t,e,Object);s[i]=s[i]||[],s[i].push(n)},Ch=(t,e)=>{const{obj:n,k:r}=hu(t,e);if(n&&Object.prototype.hasOwnProperty.call(n,r))return n[r]},R6=(t,e,n)=>{const r=Ch(t,n);return r!==void 0?r:Ch(e,n)},Yj=(t,e,n)=>{for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in t?$e(t[r])||t[r]instanceof String||$e(e[r])||e[r]instanceof String?n&&(t[r]=e[r]):Yj(t[r],e[r],n):t[r]=e[r]);return t},ul=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var _6={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const O6=t=>$e(t)?t.replace(/[&<>"'\/]/g,e=>_6[e]):t;class D6{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const I6=[" ",",","?","!",";"],L6=new D6(20),z6=(t,e,n)=>{e=e||"",n=n||"";const r=I6.filter(o=>e.indexOf(o)<0&&n.indexOf(o)<0);if(r.length===0)return!0;const s=L6.getRegExp(`(${r.map(o=>o==="?"?"\\?":o).join("|")})`);let i=!s.test(t);if(!i){const o=t.indexOf(n);o>0&&!s.test(t.substring(0,o))&&(i=!0)}return i},sx=(t,e,n=".")=>{if(!t)return;if(t[e])return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0;const r=e.split(n);let s=t;for(let i=0;i<r.length;){if(!s||typeof s!="object")return;let o,l="";for(let d=i;d<r.length;++d)if(d!==i&&(l+=n),l+=r[d],o=s[l],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&d<r.length-1)continue;i+=d-i+1;break}s=o}return s},_u=t=>t?.replace("_","-"),P6={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console?.[t]?.apply?.(console,e)}};class Nh{constructor(e,n={}){this.init(e,n)}init(e,n={}){this.prefix=n.prefix||"i18next:",this.logger=e||P6,this.options=n,this.debug=n.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,r,s){return s&&!this.debug?null:($e(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new Nh(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new Nh(this.logger,e)}}var Ss=new Nh;let Ip=class{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const s=this.observers[r].get(n)||0;this.observers[r].set(n,s+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e,...n){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([s,i])=>{for(let o=0;o<i;o++)s(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([s,i])=>{for(let o=0;o<i;o++)s.apply(s,[e,...n])})}};class L2 extends Ip{constructor(e,n={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,r,s={}){const i=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,o=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;e.indexOf(".")>-1?l=e.split("."):(l=[e,n],r&&(Array.isArray(r)?l.push(...r):$e(r)&&i?l.push(...r.split(i)):l.push(r)));const d=Ch(this.data,l);return!d&&!n&&!r&&e.indexOf(".")>-1&&(e=l[0],n=l[1],r=l.slice(2).join(".")),d||!o||!$e(r)?d:sx(this.data?.[e]?.[n],r,i)}addResource(e,n,r,s,i={silent:!1}){const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let l=[e,n];r&&(l=l.concat(o?r.split(o):r)),e.indexOf(".")>-1&&(l=e.split("."),s=n,n=l[1]),this.addNamespaces(n),I2(this.data,l,s),i.silent||this.emit("added",e,n,r,s)}addResources(e,n,r,s={silent:!1}){for(const i in r)($e(r[i])||Array.isArray(r[i]))&&this.addResource(e,n,i,r[i],{silent:!0});s.silent||this.emit("added",e,n,r)}addResourceBundle(e,n,r,s,i,o={silent:!1,skipCopy:!1}){let l=[e,n];e.indexOf(".")>-1&&(l=e.split("."),s=r,r=n,n=l[1]),this.addNamespaces(n);let d=Ch(this.data,l)||{};o.skipCopy||(r=JSON.parse(JSON.stringify(r))),s?Yj(d,r,i):d={...d,...r},I2(this.data,l,d),o.silent||this.emit("added",e,n,r)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(s=>n[s]&&Object.keys(n[s]).length>0)}toJSON(){return this.data}}var Gj={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,r,s){return t.forEach(i=>{e=this.processors[i]?.process(e,n,r,s)??e}),e}};const Xj=Symbol("i18next/PATH_KEY");function B6(){const t=[],e=Object.create(null);let n;return e.get=(r,s)=>(n?.revoke?.(),s===Xj?t:(t.push(s),n=Proxy.revocable(r,e),n.proxy)),Proxy.revocable(Object.create(null),e).proxy}function ix(t,e){const{[Xj]:n}=t(B6());return n.join(e?.keySeparator??".")}const z2={},D0=t=>!$e(t)&&typeof t!="boolean"&&typeof t!="number";class Th extends Ip{constructor(e,n={}){super(),E6(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Ss.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,n={interpolation:{}}){const r={...n};if(e==null)return!1;const s=this.resolve(e,r);if(s?.res===void 0)return!1;const i=D0(s.res);return!(r.returnObjects===!1&&i)}extractFromKey(e,n){let r=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const s=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let i=n.ns||this.options.defaultNS||[];const o=r&&e.indexOf(r)>-1,l=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!z6(e,r,s);if(o&&!l){const d=e.match(this.interpolator.nestingRegexp);if(d&&d.length>0)return{key:e,namespaces:$e(i)?[i]:i};const f=e.split(r);(r!==s||r===s&&this.options.ns.indexOf(f[0])>-1)&&(i=f.shift()),e=f.join(s)}return{key:e,namespaces:$e(i)?[i]:i}}translate(e,n,r){let s=typeof n=="object"?{...n}:n;if(typeof s!="object"&&this.options.overloadTranslationOptionHandler&&(s=this.options.overloadTranslationOptionHandler(arguments)),typeof s=="object"&&(s={...s}),s||(s={}),e==null)return"";typeof e=="function"&&(e=ix(e,{...this.options,...s})),Array.isArray(e)||(e=[String(e)]);const i=s.returnDetails!==void 0?s.returnDetails:this.options.returnDetails,o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,{key:l,namespaces:d}=this.extractFromKey(e[e.length-1],s),f=d[d.length-1];let p=s.nsSeparator!==void 0?s.nsSeparator:this.options.nsSeparator;p===void 0&&(p=":");const g=s.lng||this.language,y=s.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(g?.toLowerCase()==="cimode")return y?i?{res:`${f}${p}${l}`,usedKey:l,exactUsedKey:l,usedLng:g,usedNS:f,usedParams:this.getUsedParamsDetails(s)}:`${f}${p}${l}`:i?{res:l,usedKey:l,exactUsedKey:l,usedLng:g,usedNS:f,usedParams:this.getUsedParamsDetails(s)}:l;const m=this.resolve(e,s);let b=m?.res;const v=m?.usedKey||l,w=m?.exactUsedKey||l,S=["[object Number]","[object Function]","[object RegExp]"],T=s.joinArrays!==void 0?s.joinArrays:this.options.joinArrays,j=!this.i18nFormat||this.i18nFormat.handleAsObject,M=s.count!==void 0&&!$e(s.count),_=Th.hasDefaultValue(s),R=M?this.pluralResolver.getSuffix(g,s.count,s):"",O=s.ordinal&&M?this.pluralResolver.getSuffix(g,s.count,{ordinal:!1}):"",L=M&&!s.ordinal&&s.count===0,A=L&&s[`defaultValue${this.options.pluralSeparator}zero`]||s[`defaultValue${R}`]||s[`defaultValue${O}`]||s.defaultValue;let F=b;j&&!b&&_&&(F=A);const H=D0(F),P=Object.prototype.toString.apply(F);if(j&&F&&H&&S.indexOf(P)<0&&!($e(T)&&Array.isArray(F))){if(!s.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const B=this.options.returnedObjectHandler?this.options.returnedObjectHandler(v,F,{...s,ns:d}):`key '${l} (${this.language})' returned an object instead of string.`;return i?(m.res=B,m.usedParams=this.getUsedParamsDetails(s),m):B}if(o){const B=Array.isArray(F),E=B?[]:{},K=B?w:v;for(const q in F)if(Object.prototype.hasOwnProperty.call(F,q)){const V=`${K}${o}${q}`;_&&!b?E[q]=this.translate(V,{...s,defaultValue:D0(A)?A[q]:void 0,joinArrays:!1,ns:d}):E[q]=this.translate(V,{...s,joinArrays:!1,ns:d}),E[q]===V&&(E[q]=F[q])}b=E}}else if(j&&$e(T)&&Array.isArray(b))b=b.join(T),b&&(b=this.extendTranslation(b,e,s,r));else{let B=!1,E=!1;!this.isValidLookup(b)&&_&&(B=!0,b=A),this.isValidLookup(b)||(E=!0,b=l);const q=(s.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&E?void 0:b,V=_&&A!==b&&this.options.updateMissing;if(E||B||V){if(this.logger.log(V?"updateKey":"missingKey",g,f,l,V?A:b),o){const I=this.resolve(l,{...s,keySeparator:!1});I&&I.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let ie=[];const Y=this.languageUtils.getFallbackCodes(this.options.fallbackLng,s.lng||this.language);if(this.options.saveMissingTo==="fallback"&&Y&&Y[0])for(let I=0;I<Y.length;I++)ie.push(Y[I]);else this.options.saveMissingTo==="all"?ie=this.languageUtils.toResolveHierarchy(s.lng||this.language):ie.push(s.lng||this.language);const X=(I,U,te)=>{const Z=_&&te!==b?te:q;this.options.missingKeyHandler?this.options.missingKeyHandler(I,f,U,Z,V,s):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(I,f,U,Z,V,s),this.emit("missingKey",I,f,U,b)};this.options.saveMissing&&(this.options.saveMissingPlurals&&M?ie.forEach(I=>{const U=this.pluralResolver.getSuffixes(I,s);L&&s[`defaultValue${this.options.pluralSeparator}zero`]&&U.indexOf(`${this.options.pluralSeparator}zero`)<0&&U.push(`${this.options.pluralSeparator}zero`),U.forEach(te=>{X([I],l+te,s[`defaultValue${te}`]||A)})}):X(ie,l,A))}b=this.extendTranslation(b,e,s,m,r),E&&b===l&&this.options.appendNamespaceToMissingKey&&(b=`${f}${p}${l}`),(E||B)&&this.options.parseMissingKeyHandler&&(b=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${f}${p}${l}`:l,B?b:void 0,s))}return i?(m.res=b,m.usedParams=this.getUsedParamsDetails(s),m):b}extendTranslation(e,n,r,s,i){if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const d=$e(e)&&(r?.interpolation?.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(d){const g=e.match(this.interpolator.nestingRegexp);f=g&&g.length}let p=r.replace&&!$e(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(p={...this.options.interpolation.defaultVariables,...p}),e=this.interpolator.interpolate(e,p,r.lng||this.language||s.usedLng,r),d){const g=e.match(this.interpolator.nestingRegexp),y=g&&g.length;f<y&&(r.nest=!1)}!r.lng&&s&&s.res&&(r.lng=this.language||s.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,(...g)=>i?.[0]===g[0]&&!r.context?(this.logger.warn(`It seems you are nesting recursively key: ${g[0]} in key: ${n[0]}`),null):this.translate(...g,n),r)),r.interpolation&&this.interpolator.reset()}const o=r.postProcess||this.options.postProcess,l=$e(o)?[o]:o;return e!=null&&l?.length&&r.applyPostProcessor!==!1&&(e=Gj.handle(l,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e,n={}){let r,s,i,o,l;return $e(e)&&(e=[e]),e.forEach(d=>{if(this.isValidLookup(r))return;const f=this.extractFromKey(d,n),p=f.key;s=p;let g=f.namespaces;this.options.fallbackNS&&(g=g.concat(this.options.fallbackNS));const y=n.count!==void 0&&!$e(n.count),m=y&&!n.ordinal&&n.count===0,b=n.context!==void 0&&($e(n.context)||typeof n.context=="number")&&n.context!=="",v=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);g.forEach(w=>{this.isValidLookup(r)||(l=w,!z2[`${v[0]}-${w}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(l)&&(z2[`${v[0]}-${w}`]=!0,this.logger.warn(`key "${s}" for languages "${v.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),v.forEach(S=>{if(this.isValidLookup(r))return;o=S;const T=[p];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(T,p,S,w,n);else{let M;y&&(M=this.pluralResolver.getSuffix(S,n.count,n));const _=`${this.options.pluralSeparator}zero`,R=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(y&&(n.ordinal&&M.indexOf(R)===0&&T.push(p+M.replace(R,this.options.pluralSeparator)),T.push(p+M),m&&T.push(p+_)),b){const O=`${p}${this.options.contextSeparator||"_"}${n.context}`;T.push(O),y&&(n.ordinal&&M.indexOf(R)===0&&T.push(O+M.replace(R,this.options.pluralSeparator)),T.push(O+M),m&&T.push(O+_))}}let j;for(;j=T.pop();)this.isValidLookup(r)||(i=j,r=this.getResource(S,w,j,n))}))})}),{res:r,usedKey:s,exactUsedKey:i,usedLng:o,usedNS:l}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,r,s={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,n,r,s):this.resourceStore.getResource(e,n,r,s)}getUsedParamsDetails(e={}){const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!$e(e.replace);let s=r?e.replace:e;if(r&&typeof e.count<"u"&&(s.count=e.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!r){s={...s};for(const i of n)delete s[i]}return s}static hasDefaultValue(e){const n="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&n===r.substring(0,n.length)&&e[r]!==void 0)return!0;return!1}}class P2{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Ss.create("languageUtils")}getScriptPartFromCode(e){if(e=_u(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=_u(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if($e(e)&&e.indexOf("-")>-1){let n;try{n=Intl.getCanonicalLocales(e)[0]}catch{}return n&&this.options.lowerCaseLng&&(n=n.toLowerCase()),n||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(r=>{if(n)return;const s=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(s))&&(n=s)}),!n&&this.options.supportedLngs&&e.forEach(r=>{if(n)return;const s=this.getScriptPartFromCode(r);if(this.isSupportedCode(s))return n=s;const i=this.getLanguagePartFromCode(r);if(this.isSupportedCode(i))return n=i;n=this.options.supportedLngs.find(o=>{if(o===i)return o;if(!(o.indexOf("-")<0&&i.indexOf("-")<0)&&(o.indexOf("-")>0&&i.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===i||o.indexOf(i)===0&&i.length>1))return o})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),$e(e)&&(e=[e]),Array.isArray(e))return e;if(!n)return e.default||[];let r=e[n];return r||(r=e[this.getScriptPartFromCode(n)]),r||(r=e[this.formatLanguageCode(n)]),r||(r=e[this.getLanguagePartFromCode(n)]),r||(r=e.default),r||[]}toResolveHierarchy(e,n){const r=this.getFallbackCodes((n===!1?[]:n)||this.options.fallbackLng||[],e),s=[],i=o=>{o&&(this.isSupportedCode(o)?s.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return $e(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(e))):$e(e)&&i(this.formatLanguageCode(e)),r.forEach(o=>{s.indexOf(o)<0&&i(this.formatLanguageCode(o))}),s}}const B2={zero:0,one:1,two:2,few:3,many:4,other:5},F2={select:t=>t===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class F6{constructor(e,n={}){this.languageUtils=e,this.options=n,this.logger=Ss.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,n){this.rules[e]=n}clearCache(){this.pluralRulesCache={}}getRule(e,n={}){const r=_u(e==="dev"?"en":e),s=n.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:r,type:s});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let o;try{o=new Intl.PluralRules(r,{type:s})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),F2;if(!e.match(/-|_/))return F2;const d=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(d,n)}return this.pluralRulesCache[i]=o,o}needsPlural(e,n={}){let r=this.getRule(e,n);return r||(r=this.getRule("dev",n)),r?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,n,r={}){return this.getSuffixes(e,r).map(s=>`${n}${s}`)}getSuffixes(e,n={}){let r=this.getRule(e,n);return r||(r=this.getRule("dev",n)),r?r.resolvedOptions().pluralCategories.sort((s,i)=>B2[s]-B2[i]).map(s=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${s}`):[]}getSuffix(e,n,r={}){const s=this.getRule(e,r);return s?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${s.select(n)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",n,r))}}const U2=(t,e,n,r=".",s=!0)=>{let i=R6(t,e,n);return!i&&s&&$e(n)&&(i=sx(t,n,r),i===void 0&&(i=sx(e,n,r))),i},I0=t=>t.replace(/\$/g,"$$$$");class U6{constructor(e={}){this.logger=Ss.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(n=>n),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:n,escapeValue:r,useRawValueToEscape:s,prefix:i,prefixEscaped:o,suffix:l,suffixEscaped:d,formatSeparator:f,unescapeSuffix:p,unescapePrefix:g,nestingPrefix:y,nestingPrefixEscaped:m,nestingSuffix:b,nestingSuffixEscaped:v,nestingOptionsSeparator:w,maxReplaces:S,alwaysFormat:T}=e.interpolation;this.escape=n!==void 0?n:O6,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=i?ul(i):o||"{{",this.suffix=l?ul(l):d||"}}",this.formatSeparator=f||",",this.unescapePrefix=p?"":g||"-",this.unescapeSuffix=this.unescapePrefix?"":p||"",this.nestingPrefix=y?ul(y):m||ul("$t("),this.nestingSuffix=b?ul(b):v||ul(")"),this.nestingOptionsSeparator=w||",",this.maxReplaces=S||1e3,this.alwaysFormat=T!==void 0?T:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,r)=>n?.source===r?(n.lastIndex=0,n):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,n,r,s){let i,o,l;const d=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},f=m=>{if(m.indexOf(this.formatSeparator)<0){const S=U2(n,d,m,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(S,void 0,r,{...s,...n,interpolationkey:m}):S}const b=m.split(this.formatSeparator),v=b.shift().trim(),w=b.join(this.formatSeparator).trim();return this.format(U2(n,d,v,this.options.keySeparator,this.options.ignoreJSONStructure),w,r,{...s,...n,interpolationkey:v})};this.resetRegExp();const p=s?.missingInterpolationHandler||this.options.missingInterpolationHandler,g=s?.interpolation?.skipOnVariables!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:m=>I0(m)},{regex:this.regexp,safeValue:m=>this.escapeValue?I0(this.escape(m)):I0(m)}].forEach(m=>{for(l=0;i=m.regex.exec(e);){const b=i[1].trim();if(o=f(b),o===void 0)if(typeof p=="function"){const w=p(e,i,s);o=$e(w)?w:""}else if(s&&Object.prototype.hasOwnProperty.call(s,b))o="";else if(g){o=i[0];continue}else this.logger.warn(`missed to pass in variable ${b} for interpolating ${e}`),o="";else!$e(o)&&!this.useRawValueToEscape&&(o=_2(o));const v=m.safeValue(o);if(e=e.replace(i[0],v),g?(m.regex.lastIndex+=o.length,m.regex.lastIndex-=i[0].length):m.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),e}nest(e,n,r={}){let s,i,o;const l=(d,f)=>{const p=this.nestingOptionsSeparator;if(d.indexOf(p)<0)return d;const g=d.split(new RegExp(`${p}[ ]*{`));let y=`{${g[1]}`;d=g[0],y=this.interpolate(y,o);const m=y.match(/'/g),b=y.match(/"/g);((m?.length??0)%2===0&&!b||b.length%2!==0)&&(y=y.replace(/'/g,'"'));try{o=JSON.parse(y),f&&(o={...f,...o})}catch(v){return this.logger.warn(`failed parsing options string in nesting for key ${d}`,v),`${d}${p}${y}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,d};for(;s=this.nestingRegexp.exec(e);){let d=[];o={...r},o=o.replace&&!$e(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const f=/{.*}/.test(s[1])?s[1].lastIndexOf("}")+1:s[1].indexOf(this.formatSeparator);if(f!==-1&&(d=s[1].slice(f).split(this.formatSeparator).map(p=>p.trim()).filter(Boolean),s[1]=s[1].slice(0,f)),i=n(l.call(this,s[1].trim(),o),o),i&&s[0]===e&&!$e(i))return i;$e(i)||(i=_2(i)),i||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${e}`),i=""),d.length&&(i=d.reduce((p,g)=>this.format(p,g,r.lng,{...r,interpolationkey:s[1].trim()}),i.trim())),e=e.replace(s[0],i),this.regexp.lastIndex=0}return e}}const $6=t=>{let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const r=t.split("(");e=r[0].toLowerCase().trim();const s=r[1].substring(0,r[1].length-1);e==="currency"&&s.indexOf(":")<0?n.currency||(n.currency=s.trim()):e==="relativetime"&&s.indexOf(":")<0?n.range||(n.range=s.trim()):s.split(";").forEach(o=>{if(o){const[l,...d]=o.split(":"),f=d.join(":").trim().replace(/^'+|'+$/g,""),p=l.trim();n[p]||(n[p]=f),f==="false"&&(n[p]=!1),f==="true"&&(n[p]=!0),isNaN(f)||(n[p]=parseInt(f,10))}})}return{formatName:e,formatOptions:n}},$2=t=>{const e={};return(n,r,s)=>{let i=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(i={...i,[s.interpolationkey]:void 0});const o=r+JSON.stringify(i);let l=e[o];return l||(l=t(_u(r),s),e[o]=l),l(n)}},q6=t=>(e,n,r)=>t(_u(n),r)(e);class H6{constructor(e={}){this.logger=Ss.create("formatter"),this.options=e,this.init(e)}init(e,n={interpolation:{}}){this.formatSeparator=n.interpolation.formatSeparator||",";const r=n.cacheInBuiltFormats?$2:q6;this.formats={number:r((s,i)=>{const o=new Intl.NumberFormat(s,{...i});return l=>o.format(l)}),currency:r((s,i)=>{const o=new Intl.NumberFormat(s,{...i,style:"currency"});return l=>o.format(l)}),datetime:r((s,i)=>{const o=new Intl.DateTimeFormat(s,{...i});return l=>o.format(l)}),relativetime:r((s,i)=>{const o=new Intl.RelativeTimeFormat(s,{...i});return l=>o.format(l,i.range||"day")}),list:r((s,i)=>{const o=new Intl.ListFormat(s,{...i});return l=>o.format(l)})}}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=$2(n)}format(e,n,r,s={}){const i=n.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(l=>l.indexOf(")")>-1)){const l=i.findIndex(d=>d.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,l)].join(this.formatSeparator)}return i.reduce((l,d)=>{const{formatName:f,formatOptions:p}=$6(d);if(this.formats[f]){let g=l;try{const y=s?.formatParams?.[s.interpolationkey]||{},m=y.locale||y.lng||s.locale||s.lng||r;g=this.formats[f](l,m,{...p,...s,...y})}catch(y){this.logger.warn(y)}return g}else this.logger.warn(`there was no format function for ${f}`);return l},e)}}const V6=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class K6 extends Ip{constructor(e,n,r,s={}){super(),this.backend=e,this.store=n,this.services=r,this.languageUtils=r.languageUtils,this.options=s,this.logger=Ss.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(r,s.backend,s)}queueLoad(e,n,r,s){const i={},o={},l={},d={};return e.forEach(f=>{let p=!0;n.forEach(g=>{const y=`${f}|${g}`;!r.reload&&this.store.hasResourceBundle(f,g)?this.state[y]=2:this.state[y]<0||(this.state[y]===1?o[y]===void 0&&(o[y]=!0):(this.state[y]=1,p=!1,o[y]===void 0&&(o[y]=!0),i[y]===void 0&&(i[y]=!0),d[g]===void 0&&(d[g]=!0)))}),p||(l[f]=!0)}),(Object.keys(i).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(i),pending:Object.keys(o),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(d)}}loaded(e,n,r){const s=e.split("|"),i=s[0],o=s[1];n&&this.emit("failedLoading",i,o,n),!n&&r&&this.store.addResourceBundle(i,o,r,void 0,void 0,{skipCopy:!0}),this.state[e]=n?-1:2,n&&r&&(this.state[e]=0);const l={};this.queue.forEach(d=>{A6(d.loaded,[i],o),V6(d,e),n&&d.errors.push(n),d.pendingCount===0&&!d.done&&(Object.keys(d.loaded).forEach(f=>{l[f]||(l[f]={});const p=d.loaded[f];p.length&&p.forEach(g=>{l[f][g]===void 0&&(l[f][g]=!0)})}),d.done=!0,d.errors.length?d.callback(d.errors):d.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(d=>!d.done)}read(e,n,r,s=0,i=this.retryTimeout,o){if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:r,tried:s,wait:i,callback:o});return}this.readingCalls++;const l=(f,p)=>{if(this.readingCalls--,this.waitingReads.length>0){const g=this.waitingReads.shift();this.read(g.lng,g.ns,g.fcName,g.tried,g.wait,g.callback)}if(f&&p&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,r,s+1,i*2,o)},i);return}o(f,p)},d=this.backend[r].bind(this.backend);if(d.length===2){try{const f=d(e,n);f&&typeof f.then=="function"?f.then(p=>l(null,p)).catch(l):l(null,f)}catch(f){l(f)}return}return d(e,n,l)}prepareLoading(e,n,r={},s){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();$e(e)&&(e=this.languageUtils.toResolveHierarchy(e)),$e(n)&&(n=[n]);const i=this.queueLoad(e,n,r,s);if(!i.toLoad.length)return i.pending.length||s(),null;i.toLoad.forEach(o=>{this.loadOne(o)})}load(e,n,r){this.prepareLoading(e,n,{},r)}reload(e,n,r){this.prepareLoading(e,n,{reload:!0},r)}loadOne(e,n=""){const r=e.split("|"),s=r[0],i=r[1];this.read(s,i,"read",void 0,void 0,(o,l)=>{o&&this.logger.warn(`${n}loading namespace ${i} for language ${s} failed`,o),!o&&l&&this.logger.log(`${n}loaded namespace ${i} for language ${s}`,l),this.loaded(e,o,l)})}saveMissing(e,n,r,s,i,o={},l=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(n)){this.logger.warn(`did not save key "${r}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend?.create){const d={...o,isUpdate:i},f=this.backend.create.bind(this.backend);if(f.length<6)try{let p;f.length===5?p=f(e,n,r,s,d):p=f(e,n,r,s),p&&typeof p.then=="function"?p.then(g=>l(null,g)).catch(l):l(null,p)}catch(p){l(p)}else f(e,n,r,s,l,d)}!e||!e[0]||this.store.addResource(e[0],n,r,s)}}}const q2=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),$e(t[1])&&(e.defaultValue=t[1]),$e(t[2])&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(r=>{e[r]=n[r]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),H2=t=>($e(t.ns)&&(t.ns=[t.ns]),$e(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),$e(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs?.indexOf?.("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),typeof t.initImmediate=="boolean"&&(t.initAsync=t.initImmediate),t),Of=()=>{},Q6=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(n=>{typeof t[n]=="function"&&(t[n]=t[n].bind(t))})};class pu extends Ip{constructor(e={},n){if(super(),this.options=H2(e),this.services={},this.logger=Ss,this.modules={external:[]},Q6(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(e={},n){this.isInitializing=!0,typeof e=="function"&&(n=e,e={}),e.defaultNS==null&&e.ns&&($e(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const r=q2();this.options={...r,...this.options,...H2(e)},this.options.interpolation={...r.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const s=f=>f?typeof f=="function"?new f:f:null;if(!this.options.isClone){this.modules.logger?Ss.init(s(this.modules.logger),this.options):Ss.init(null,this.options);let f;this.modules.formatter?f=this.modules.formatter:f=H6;const p=new P2(this.options);this.store=new L2(this.options.resources,this.options);const g=this.services;g.logger=Ss,g.resourceStore=this.store,g.languageUtils=p,g.pluralResolver=new F6(p,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),f&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(g.formatter=s(f),g.formatter.init&&g.formatter.init(g,this.options),this.options.interpolation.format=g.formatter.format.bind(g.formatter)),g.interpolator=new U6(this.options),g.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},g.backendConnector=new K6(s(this.modules.backend),g.resourceStore,g,this.options),g.backendConnector.on("*",(m,...b)=>{this.emit(m,...b)}),this.modules.languageDetector&&(g.languageDetector=s(this.modules.languageDetector),g.languageDetector.init&&g.languageDetector.init(g,this.options.detection,this.options)),this.modules.i18nFormat&&(g.i18nFormat=s(this.modules.i18nFormat),g.i18nFormat.init&&g.i18nFormat.init(this)),this.translator=new Th(this.services,this.options),this.translator.on("*",(m,...b)=>{this.emit(m,...b)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,n||(n=Of),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const f=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);f.length>0&&f[0]!=="dev"&&(this.options.lng=f[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(f=>{this[f]=(...p)=>this.store[f](...p)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(f=>{this[f]=(...p)=>(this.store[f](...p),this)});const l=Zc(),d=()=>{const f=(p,g)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(g),n(p,g)};if(this.languages&&!this.isInitialized)return f(null,this.t.bind(this));this.changeLanguage(this.options.lng,f)};return this.options.resources||!this.options.initAsync?d():setTimeout(d,0),l}loadResources(e,n=Of){let r=n;const s=$e(e)?e:this.language;if(typeof e=="function"&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if(s?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const i=[],o=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(f=>{f!=="cimode"&&i.indexOf(f)<0&&i.push(f)})};s?o(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(d=>o(d)),this.options.preload?.forEach?.(l=>o(l)),this.services.backendConnector.load(i,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(l)})}else r(null)}reloadResources(e,n,r){const s=Zc();return typeof e=="function"&&(r=e,e=void 0),typeof n=="function"&&(r=n,n=void 0),e||(e=this.languages),n||(n=this.options.ns),r||(r=Of),this.services.backendConnector.reload(e,n,i=>{s.resolve(),r(i)}),s}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&Gj.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let n=0;n<this.languages.length;n++){const r=this.languages[n];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,n){this.isLanguageChangingTo=e;const r=Zc();this.emit("languageChanging",e);const s=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},i=(l,d)=>{d?this.isLanguageChangingTo===e&&(s(d),this.translator.changeLanguage(d),this.isLanguageChangingTo=void 0,this.emit("languageChanged",d),this.logger.log("languageChanged",d)):this.isLanguageChangingTo=void 0,r.resolve((...f)=>this.t(...f)),n&&n(l,(...f)=>this.t(...f))},o=l=>{!e&&!l&&this.services.languageDetector&&(l=[]);const d=$e(l)?l:l&&l[0],f=this.store.hasLanguageSomeTranslations(d)?d:this.services.languageUtils.getBestMatchFromCodes($e(l)?[l]:l);f&&(this.language||s(f),this.translator.language||this.translator.changeLanguage(f),this.services.languageDetector?.cacheUserLanguage?.(f)),this.loadResources(f,p=>{i(p,f)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),r}getFixedT(e,n,r){const s=(i,o,...l)=>{let d;typeof o!="object"?d=this.options.overloadTranslationOptionHandler([i,o].concat(l)):d={...o},d.lng=d.lng||s.lng,d.lngs=d.lngs||s.lngs,d.ns=d.ns||s.ns,d.keyPrefix!==""&&(d.keyPrefix=d.keyPrefix||r||s.keyPrefix);const f=this.options.keySeparator||".";let p;return d.keyPrefix&&Array.isArray(i)?p=i.map(g=>(typeof g=="function"&&(g=ix(g,{...this.options,...o})),`${d.keyPrefix}${f}${g}`)):(typeof i=="function"&&(i=ix(i,{...this.options,...o})),p=d.keyPrefix?`${d.keyPrefix}${f}${i}`:i),this.t(p,d)};return $e(e)?s.lng=e:s.lngs=e,s.ns=n,s.keyPrefix=r,s}t(...e){return this.translator?.translate(...e)}exists(...e){return this.translator?.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,n={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=n.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const o=(l,d)=>{const f=this.services.backendConnector.state[`${l}|${d}`];return f===-1||f===0||f===2};if(n.precheck){const l=n.precheck(this,o);if(l!==void 0)return l}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(r,e)&&(!s||o(i,e)))}loadNamespaces(e,n){const r=Zc();return this.options.ns?($e(e)&&(e=[e]),e.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{r.resolve(),n&&n(s)}),r):(n&&n(),Promise.resolve())}loadLanguages(e,n){const r=Zc();$e(e)&&(e=[e]);const s=this.options.preload||[],i=e.filter(o=>s.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return i.length?(this.options.preload=s.concat(i),this.loadResources(o=>{r.resolve(),n&&n(o)}),r):(n&&n(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";try{const s=new Intl.Locale(e);if(s&&s.getTextInfo){const i=s.getTextInfo();if(i&&i.direction)return i.direction}}catch{}const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services?.languageUtils||new P2(q2());return e.toLowerCase().indexOf("-latn")>1?"ltr":n.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},n){const r=new pu(e,n);return r.createInstance=pu.createInstance,r}cloneInstance(e={},n=Of){const r=e.forkResourceStore;r&&delete e.forkResourceStore;const s={...this.options,...e,isClone:!0},i=new pu(s);if((e.debug!==void 0||e.prefix!==void 0)&&(i.logger=i.logger.clone(e)),["store","services","language"].forEach(l=>{i[l]=this[l]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},r){const l=Object.keys(this.store.data).reduce((d,f)=>(d[f]={...this.store.data[f]},d[f]=Object.keys(d[f]).reduce((p,g)=>(p[g]={...d[f][g]},p),d[f]),d),{});i.store=new L2(l,s),i.services.resourceStore=i.store}return i.translator=new Th(i.services,s),i.translator.on("*",(l,...d)=>{i.emit(l,...d)}),i.init(s,n),i.translator.options=s,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const qn=pu.createInstance();qn.createInstance;qn.dir;qn.init;qn.loadResources;qn.reloadResources;qn.use;qn.changeLanguage;qn.getFixedT;qn.t;qn.exists;qn.setDefaultNamespace;qn.hasLoadedNamespace;qn.loadNamespaces;qn.loadLanguages;const W6=(t,e,n,r)=>{const s=[n,{code:e,...r||{}}];if(t?.services?.logger?.forward)return t.services.logger.forward(s,"warn","react-i18next::",!0);Ja(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),t?.services?.logger?.warn?t.services.logger.warn(...s):console?.warn&&console.warn(...s)},V2={},Jj=(t,e,n,r)=>{Ja(n)&&V2[n]||(Ja(n)&&(V2[n]=new Date),W6(t,e,n,r))},Zj=(t,e)=>()=>{if(t.isInitialized)e();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),e()};t.on("initialized",n)}},ax=(t,e,n)=>{t.loadNamespaces(e,Zj(t,n))},K2=(t,e,n,r)=>{if(Ja(n)&&(n=[n]),t.options.preload&&t.options.preload.indexOf(e)>-1)return ax(t,n,r);n.forEach(s=>{t.options.ns.indexOf(s)<0&&t.options.ns.push(s)}),t.loadLanguages(e,Zj(t,r))},Y6=(t,e,n={})=>!e.languages||!e.languages.length?(Jj(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(t,{lng:n.lng,precheck:(r,s)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!s(r.isLanguageChangingTo,t))return!1}}),Ja=t=>typeof t=="string",G6=t=>typeof t=="object"&&t!==null,X6=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,J6={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},Z6=t=>J6[t],eL=t=>t.replace(X6,Z6);let ox={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:eL};const tL=(t={})=>{ox={...ox,...t}},nL=()=>ox;let eE;const rL=t=>{eE=t},sL=()=>eE,iL={type:"3rdParty",init(t){tL(t.options.react),rL(t)}},aL=C.createContext();class oL{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var Nb=lj();const lL=(t,e)=>Ja(e)?e:G6(e)&&Ja(e.defaultValue)?e.defaultValue:Array.isArray(t)?t[t.length-1]:t,cL={t:lL,ready:!1},uL=()=>()=>{},ke=(t,e={})=>{const{i18n:n}=e,{i18n:r,defaultNS:s}=C.useContext(aL)||{},i=n||r||sL();i&&!i.reportNamespaces&&(i.reportNamespaces=new oL),i||Jj(i,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const o=C.useMemo(()=>({...nL(),...i?.options?.react,...e}),[i,e]),{useSuspense:l,keyPrefix:d}=o,f=t||s||i?.options?.defaultNS,p=Ja(f)?[f]:f||["translation"],g=C.useMemo(()=>p,p);i?.reportNamespaces?.addUsedNamespaces?.(g);const y=C.useRef(0),m=C.useCallback(A=>{if(!i)return uL;const{bindI18n:F,bindI18nStore:H}=o,P=()=>{y.current+=1,A()};return F&&i.on(F,P),H&&i.store.on(H,P),()=>{F&&F.split(" ").forEach(B=>i.off(B,P)),H&&H.split(" ").forEach(B=>i.store.off(B,P))}},[i,o]),b=C.useRef(),v=C.useCallback(()=>{if(!i)return cL;const A=!!(i.isInitialized||i.initializedStoreOnce)&&g.every(K=>Y6(K,i,o)),F=e.lng||i.language,H=y.current,P=b.current;if(P&&P.ready===A&&P.lng===F&&P.keyPrefix===d&&P.revision===H)return P;const E={t:i.getFixedT(F,o.nsMode==="fallback"?g:g[0],d),ready:A,lng:F,keyPrefix:d,revision:H};return b.current=E,E},[i,g,d,o,e.lng]),[w,S]=C.useState(0),{t:T,ready:j}=Nb.useSyncExternalStore(m,v,v);C.useEffect(()=>{if(i&&!j&&!l){const A=()=>S(F=>F+1);e.lng?K2(i,e.lng,g,A):ax(i,g,A)}},[i,e.lng,g,j,l,w]);const M=i||{},_=C.useRef(null),R=C.useRef(),O=A=>{const F=Object.getOwnPropertyDescriptors(A);F.__original&&delete F.__original;const H=Object.create(Object.getPrototypeOf(A),F);if(!Object.prototype.hasOwnProperty.call(H,"__original"))try{Object.defineProperty(H,"__original",{value:A,writable:!1,enumerable:!1,configurable:!1})}catch{}return H},L=C.useMemo(()=>{const A=M,F=A?.language;let H=A;A&&(_.current&&_.current.__original===A?R.current!==F?(H=O(A),_.current=H,R.current=F):H=_.current:(H=O(A),_.current=H,R.current=F));const P=[T,H,j];return P.t=T,P.i18n=H,P.ready=j,P},[T,M,j,M.resolvedLanguage,M.language,M.languages]);if(i&&l&&!j)throw new Promise(A=>{const F=()=>A();e.lng?K2(i,e.lng,g,F):ax(i,g,F)});return L},dL={primary:"bg-indigo-600 text-white hover:bg-indigo-700 focus:ring-indigo-500",secondary:"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-100 hover:bg-gray-200 dark:hover:bg-gray-600 focus:ring-gray-500",ghost:"bg-transparent text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-gray-100 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"},fL={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base",icon:"p-2"},it=C.forwardRef(({variant:t="primary",size:e="md",className:n="",children:r,disabled:s,...i},o)=>u.jsx("button",{ref:o,disabled:s,className:`
          inline-flex items-center justify-center font-medium rounded-lg
          focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-gray-900
          transition-colors duration-200
          disabled:opacity-50 disabled:cursor-not-allowed
          ${dL[t]}
          ${fL[e]}
          ${n}
        `,...i,children:r}));it.displayName="Button";const xr=C.forwardRef(({className:t="",...e},n)=>u.jsx("input",{ref:n,className:`w-full px-3 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ${t}`,...e}));xr.displayName="Input";const tE=C.createContext(null);function hL({children:t}){const[e,n]=C.useState([]),r=C.useCallback((o,l="info")=>{const d=Date.now();n(f=>[...f,{id:d,message:o,type:l}]),setTimeout(()=>{n(f=>f.filter(p=>p.id!==d))},3e3)},[]),s=C.useCallback(o=>{n(l=>l.filter(d=>d.id!==o))},[]),i=o=>{switch(o){case"success":return"bg-green-600 text-white";case"error":return"bg-red-600 text-white";default:return"bg-gray-800 text-white dark:bg-gray-200 dark:text-gray-800"}};return u.jsxs(tE.Provider,{value:{showToast:r},children:[t,u.jsx("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2",children:e.map(o=>u.jsxs("div",{className:`px-4 py-3 rounded-lg shadow-lg flex items-center gap-3 animate-slide-in ${i(o.type)}`,children:[u.jsx("span",{children:o.message}),u.jsx("button",{type:"button",onClick:()=>s(o.id),className:"hover:opacity-70 transition-opacity",children:u.jsx(nt,{className:"w-4 h-4"})})]},o.id))}),u.jsx("style",{children:`
        @keyframes slide-in {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        .animate-slide-in {
          animation: slide-in 0.2s ease-out;
        }
      `})]})}function mt(){const t=C.useContext(tE);if(!t)throw new Error("useToast must be used within a ToastProvider");return t}function pL(){const{t}=ke("settings"),{showToast:e}=mt(),[n,r]=C.useState(""),[s,i]=C.useState(""),[o,l]=C.useState(!1),[d,f]=C.useState("idle"),[p,g]=C.useState("");C.useEffect(()=>{const v=Mp();v&&(r(v),i(v))},[]);const y=n!==s,m=async()=>{if(!n.trim()){g(t("sections.apiUrl.errors.emptyUrl"));return}if(!mj(n)){g(t("sections.apiUrl.errors.invalidUrl"));return}l(!0),f("testing"),g(""),await yj(n)?f("success"):(f("error"),g(t("sections.apiUrl.errors.connectionFailed"))),l(!1)},b=()=>{if(d!=="success"){g(t("sections.apiUrl.errors.testFirst"));return}gj(n),i(n),e(t("sections.apiUrl.saved"),"success")};return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(qj,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t("sections.apiUrl.title")})]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("sections.apiUrl.settingsDescription")}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{htmlFor:"settings-api-url",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:t("sections.apiUrl.label")}),u.jsx(xr,{id:"settings-api-url",type:"url",placeholder:"https://your-server.com:3000",value:n,onChange:v=>{r(v.target.value),f("idle"),g("")},disabled:o})]}),p&&u.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:p}),d==="success"&&u.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[u.jsx(kh,{className:"w-4 h-4"}),u.jsx("span",{children:t("sections.apiUrl.connectionSuccess")})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(it,{variant:"secondary",size:"sm",onClick:m,disabled:o||!n.trim(),children:o?u.jsxs(u.Fragment,{children:[u.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),t("sections.apiUrl.testing")]}):d==="error"?u.jsxs(u.Fragment,{children:[u.jsx(Wj,{className:"w-4 h-4 mr-2"}),t("sections.apiUrl.retry")]}):u.jsxs(u.Fragment,{children:[u.jsx(kh,{className:"w-4 h-4 mr-2"}),t("sections.apiUrl.testConnection")]})}),y&&d==="success"&&u.jsx(it,{variant:"primary",size:"sm",onClick:b,children:t("sections.apiUrl.save")})]})]})]})}function gL({onComplete:t}){const{t:e}=ke("settings"),[n,r]=C.useState(""),[s,i]=C.useState(!1),[o,l]=C.useState("idle"),[d,f]=C.useState(""),p=C.useMemo(()=>{if(!n)return!1;const{userToken:m}=Ep(n);return m!==null},[n]),g=async()=>{if(!n.trim()){f(e("sections.apiUrl.errors.emptyUrl"));return}if(!mj(n)){f(e("sections.apiUrl.errors.invalidUrl"));return}i(!0),l("testing"),f(""),await yj(n)?l("success"):(l("error"),f(e("sections.apiUrl.errors.connectionFailed"))),i(!1)},y=()=>{if(o!=="success"){f(e("sections.apiUrl.errors.testFirst"));return}gj(n),t()};return u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 p-4",children:u.jsxs("div",{className:"w-full max-w-md bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 space-y-6",children:[u.jsxs("div",{className:"text-center space-y-2",children:[u.jsx("div",{className:"mx-auto w-16 h-16 bg-indigo-100 dark:bg-indigo-900 rounded-full flex items-center justify-center",children:u.jsx(qj,{className:"w-8 h-8 text-indigo-600 dark:text-indigo-400"})}),u.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e("sections.apiUrl.setup.title")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e("sections.apiUrl.setup.description")})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{htmlFor:"api-url",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:e("sections.apiUrl.label")}),u.jsx(xr,{id:"api-url",type:"url",placeholder:"http://192.168.x.x:3000/api/auth/user/usr_TOKEN",value:n,onChange:m=>{r(m.target.value),l("idle"),f("")},disabled:s}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e("sections.apiUrl.hint")}),p&&u.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400",children:[u.jsx(ZD,{className:"w-4 h-4"}),u.jsx("span",{children:e("sections.apiUrl.authTokenDetected")})]})]}),d&&u.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:d}),o==="success"&&u.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[u.jsx(kh,{className:"w-4 h-4"}),u.jsx("span",{children:e("sections.apiUrl.connectionSuccess")})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsx(it,{variant:"secondary",onClick:g,disabled:s||!n.trim(),className:"w-full",children:s?u.jsxs(u.Fragment,{children:[u.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),e("sections.apiUrl.testing")]}):o==="error"?u.jsxs(u.Fragment,{children:[u.jsx(Wj,{className:"w-4 h-4 mr-2"}),e("sections.apiUrl.retry")]}):u.jsxs(u.Fragment,{children:[u.jsx(kh,{className:"w-4 h-4 mr-2"}),e("sections.apiUrl.testConnection")]})}),u.jsx(it,{variant:"primary",onClick:y,disabled:o!=="success",className:"w-full",children:e("sections.apiUrl.save")})]})]})]})})}const mL="modulepreload",yL=function(t){return"/"+t},Q2={},kn=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){let d=function(f){return Promise.all(f.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");s=d(n.map(f=>{if(f=yL(f),f in Q2)return;Q2[f]=!0;const p=f.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const y=document.createElement("link");if(y.rel=p?"stylesheet":mL,p||(y.as="script"),y.crossOrigin="",y.href=f,l&&y.setAttribute("nonce",l),document.head.appendChild(y),p)return new Promise((m,b)=>{y.addEventListener("load",m),y.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};var co=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},xL={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},bL=class{#t=xL;#e=!1;setTimeoutProvider(t){this.#t=t}setTimeout(t,e){return this.#t.setTimeout(t,e)}clearTimeout(t){this.#t.clearTimeout(t)}setInterval(t,e){return this.#t.setInterval(t,e)}clearInterval(t){this.#t.clearInterval(t)}},La=new bL;function vL(t){setTimeout(t,0)}var Za=typeof window>"u"||"Deno"in globalThis;function En(){}function wL(t,e){return typeof t=="function"?t(e):t}function lx(t){return typeof t=="number"&&t>=0&&t!==1/0}function nE(t,e){return Math.max(t+(e||0)-Date.now(),0)}function ia(t,e){return typeof t=="function"?t(e):t}function Vr(t,e){return typeof t=="function"?t(e):t}function W2(t,e){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=t;if(o){if(r){if(e.queryHash!==Tb(o,e.options))return!1}else if(!Ou(e.queryKey,o))return!1}if(n!=="all"){const d=e.isActive();if(n==="active"&&!d||n==="inactive"&&d)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||s&&s!==e.state.fetchStatus||i&&!i(e))}function Y2(t,e){const{exact:n,status:r,predicate:s,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(eo(e.options.mutationKey)!==eo(i))return!1}else if(!Ou(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||s&&!s(e))}function Tb(t,e){return(e?.queryKeyHashFn||eo)(t)}function eo(t){return JSON.stringify(t,(e,n)=>cx(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function Ou(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Ou(t[n],e[n])):!1}var SL=Object.prototype.hasOwnProperty;function jb(t,e){if(t===e)return t;const n=G2(t)&&G2(e);if(!n&&!(cx(t)&&cx(e)))return e;const s=(n?t:Object.keys(t)).length,i=n?e:Object.keys(e),o=i.length,l=n?new Array(o):{};let d=0;for(let f=0;f<o;f++){const p=n?f:i[f],g=t[p],y=e[p];if(g===y){l[p]=g,(n?f<s:SL.call(t,p))&&d++;continue}if(g===null||y===null||typeof g!="object"||typeof y!="object"){l[p]=y;continue}const m=jb(g,y);l[p]=m,m===g&&d++}return s===o&&d===s?t:l}function Du(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function G2(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function cx(t){if(!X2(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!X2(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function X2(t){return Object.prototype.toString.call(t)==="[object Object]"}function kL(t){return new Promise(e=>{La.setTimeout(e,t)})}function ux(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?jb(t,e):e}function CL(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function NL(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var Eb=Symbol();function rE(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Eb?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function sE(t,e){return typeof t=="function"?t(...e):!!t}var TL=class extends co{#t;#e;#n;constructor(){super(),this.#n=t=>{if(!Za&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#e||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(t){this.#n=t,this.#e?.(),this.#e=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#t!==t&&(this.#t=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#t=="boolean"?this.#t:globalThis.document?.visibilityState!=="hidden"}},Mb=new TL;function dx(){let t,e;const n=new Promise((s,i)=>{t=s,e=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),t(s)},n.reject=s=>{r({status:"rejected",reason:s}),e(s)},n}var jL=vL;function EL(){let t=[],e=0,n=l=>{l()},r=l=>{l()},s=jL;const i=l=>{e?t.push(l):s(()=>{n(l)})},o=()=>{const l=t;t=[],l.length&&s(()=>{r(()=>{l.forEach(d=>{n(d)})})})};return{batch:l=>{let d;e++;try{d=l()}finally{e--,e||o()}return d},batchCalls:l=>(...d)=>{i(()=>{l(...d)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var zt=EL(),ML=class extends co{#t=!0;#e;#n;constructor(){super(),this.#n=t=>{if(!Za&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#e||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(t){this.#n=t,this.#e?.(),this.#e=t(this.setOnline.bind(this))}setOnline(t){this.#t!==t&&(this.#t=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#t}},jh=new ML;function AL(t){return Math.min(1e3*2**t,3e4)}function iE(t){return(t??"online")==="online"?jh.isOnline():!0}var fx=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function aE(t){let e=!1,n=0,r;const s=dx(),i=()=>s.status!=="pending",o=v=>{if(!i()){const w=new fx(v);y(w),t.onCancel?.(w)}},l=()=>{e=!0},d=()=>{e=!1},f=()=>Mb.isFocused()&&(t.networkMode==="always"||jh.isOnline())&&t.canRun(),p=()=>iE(t.networkMode)&&t.canRun(),g=v=>{i()||(r?.(),s.resolve(v))},y=v=>{i()||(r?.(),s.reject(v))},m=()=>new Promise(v=>{r=w=>{(i()||f())&&v(w)},t.onPause?.()}).then(()=>{r=void 0,i()||t.onContinue?.()}),b=()=>{if(i())return;let v;const w=n===0?t.initialPromise:void 0;try{v=w??t.fn()}catch(S){v=Promise.reject(S)}Promise.resolve(v).then(g).catch(S=>{if(i())return;const T=t.retry??(Za?0:3),j=t.retryDelay??AL,M=typeof j=="function"?j(n,S):j,_=T===!0||typeof T=="number"&&n<T||typeof T=="function"&&T(n,S);if(e||!_){y(S);return}n++,t.onFail?.(n,S),kL(M).then(()=>f()?void 0:m()).then(()=>{e?y(S):b()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r?.(),s),cancelRetry:l,continueRetry:d,canStart:p,start:()=>(p()?b():m().then(b),s)}}var oE=class{#t;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),lx(this.gcTime)&&(this.#t=La.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Za?1/0:300*1e3))}clearGcTimeout(){this.#t&&(La.clearTimeout(this.#t),this.#t=void 0)}},RL=class extends oE{#t;#e;#n;#s;#r;#i;#o;constructor(t){super(),this.#o=!1,this.#i=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#s=t.client,this.#n=this.#s.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#t=Z2(this.options),this.state=t.state??this.#t,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(t){if(this.options={...this.#i,...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=Z2(this.options);e.data!==void 0&&(this.setState(J2(e.data,e.dataUpdatedAt)),this.#t=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(t,e){const n=ux(this.state.data,t,this.options);return this.#a({data:n,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),n}setState(t,e){this.#a({type:"setState",state:t,setStateOptions:e})}cancel(t){const e=this.#r?.promise;return this.#r?.cancel(t),e?e.then(En).catch(En):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#t)}isActive(){return this.observers.some(t=>Vr(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Eb||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ia(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!nE(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#a({type:"invalidate"})}async fetch(t,e){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(t&&this.setOptions(t),!this.options.queryFn){const l=this.observers.find(d=>d.options.queryFn);l&&this.setOptions(l.options)}const n=new AbortController,r=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(this.#o=!0,n.signal)})},s=()=>{const l=rE(this.options,e),f=(()=>{const p={client:this.#s,queryKey:this.queryKey,meta:this.meta};return r(p),p})();return this.#o=!1,this.options.persister?this.options.persister(l,f,this):l(f)},o=(()=>{const l={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#s,state:this.state,fetchFn:s};return r(l),l})();this.options.behavior?.onFetch(o,this),this.#e=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#a({type:"fetch",meta:o.fetchOptions?.meta}),this.#r=aE({initialPromise:e?.initialPromise,fn:o.fetchFn,onCancel:l=>{l instanceof fx&&l.revert&&this.setState({...this.#e,fetchStatus:"idle"}),n.abort()},onFail:(l,d)=>{this.#a({type:"failed",failureCount:l,error:d})},onPause:()=>{this.#a({type:"pause"})},onContinue:()=>{this.#a({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0});try{const l=await this.#r.start();if(l===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(l),this.#n.config.onSuccess?.(l,this),this.#n.config.onSettled?.(l,this.state.error,this),l}catch(l){if(l instanceof fx){if(l.silent)return this.#r.promise;if(l.revert){if(this.state.data===void 0)throw l;return this.state.data}}throw this.#a({type:"error",error:l}),this.#n.config.onError?.(l,this),this.#n.config.onSettled?.(this.state.data,l,this),l}finally{this.scheduleGc()}}#a(t){const e=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...lE(n.data,this.options),fetchMeta:t.meta??null};case"success":const r={...n,...J2(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#e=t.manual?r:void 0,r;case"error":const s=t.error;return{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=e(this.state),zt.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:t})})}};function lE(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:iE(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function J2(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Z2(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Ab=class extends co{constructor(t,e){super(),this.options=e,this.#t=t,this.#a=null,this.#o=dx(),this.bindMethods(),this.setOptions(e)}#t;#e=void 0;#n=void 0;#s=void 0;#r;#i;#o;#a;#h;#d;#f;#c;#u;#l;#g=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),eC(this.#e,this.options)?this.#p():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return hx(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return hx(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#v(),this.#w(),this.#e.removeObserver(this)}setOptions(t){const e=this.options,n=this.#e;if(this.options=this.#t.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Vr(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#S(),this.#e.setOptions(this.options),e._defaulted&&!Du(this.options,e)&&this.#t.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const r=this.hasListeners();r&&tC(this.#e,n,this.options,e)&&this.#p(),this.updateResult(),r&&(this.#e!==n||Vr(this.options.enabled,this.#e)!==Vr(e.enabled,this.#e)||ia(this.options.staleTime,this.#e)!==ia(e.staleTime,this.#e))&&this.#m();const s=this.#y();r&&(this.#e!==n||Vr(this.options.enabled,this.#e)!==Vr(e.enabled,this.#e)||s!==this.#l)&&this.#x(s)}getOptimisticResult(t){const e=this.#t.getQueryCache().build(this.#t,t),n=this.createResult(e,t);return OL(this,n)&&(this.#s=n,this.#i=this.options,this.#r=this.#e.state),n}getCurrentResult(){return this.#s}trackResult(t,e){return new Proxy(t,{get:(n,r)=>(this.trackProp(r),e?.(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,r))})}trackProp(t){this.#g.add(t)}getCurrentQuery(){return this.#e}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#t.defaultQueryOptions(t),n=this.#t.getQueryCache().build(this.#t,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#p({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#s))}#p(t){this.#S();let e=this.#e.fetch(this.options,t);return t?.throwOnError||(e=e.catch(En)),e}#m(){this.#v();const t=ia(this.options.staleTime,this.#e);if(Za||this.#s.isStale||!lx(t))return;const n=nE(this.#s.dataUpdatedAt,t)+1;this.#c=La.setTimeout(()=>{this.#s.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#x(t){this.#w(),this.#l=t,!(Za||Vr(this.options.enabled,this.#e)===!1||!lx(this.#l)||this.#l===0)&&(this.#u=La.setInterval(()=>{(this.options.refetchIntervalInBackground||Mb.isFocused())&&this.#p()},this.#l))}#b(){this.#m(),this.#x(this.#y())}#v(){this.#c&&(La.clearTimeout(this.#c),this.#c=void 0)}#w(){this.#u&&(La.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#e,r=this.options,s=this.#s,i=this.#r,o=this.#i,d=t!==n?t.state:this.#n,{state:f}=t;let p={...f},g=!1,y;if(e._optimisticResults){const L=this.hasListeners(),A=!L&&eC(t,e),F=L&&tC(t,n,e,r);(A||F)&&(p={...p,...lE(f.data,t.options)}),e._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:m,errorUpdatedAt:b,status:v}=p;y=p.data;let w=!1;if(e.placeholderData!==void 0&&y===void 0&&v==="pending"){let L;s?.isPlaceholderData&&e.placeholderData===o?.placeholderData?(L=s.data,w=!0):L=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,L!==void 0&&(v="success",y=ux(s?.data,L,e),g=!0)}if(e.select&&y!==void 0&&!w)if(s&&y===i?.data&&e.select===this.#h)y=this.#d;else try{this.#h=e.select,y=e.select(y),y=ux(s?.data,y,e),this.#d=y,this.#a=null}catch(L){this.#a=L}this.#a&&(m=this.#a,y=this.#d,b=Date.now(),v="error");const S=p.fetchStatus==="fetching",T=v==="pending",j=v==="error",M=T&&S,_=y!==void 0,O={status:v,fetchStatus:p.fetchStatus,isPending:T,isSuccess:v==="success",isError:j,isInitialLoading:M,isLoading:M,data:y,dataUpdatedAt:p.dataUpdatedAt,error:m,errorUpdatedAt:b,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:S,isRefetching:S&&!T,isLoadingError:j&&!_,isPaused:p.fetchStatus==="paused",isPlaceholderData:g,isRefetchError:j&&_,isStale:Rb(t,e),refetch:this.refetch,promise:this.#o,isEnabled:Vr(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const L=H=>{O.status==="error"?H.reject(O.error):O.data!==void 0&&H.resolve(O.data)},A=()=>{const H=this.#o=O.promise=dx();L(H)},F=this.#o;switch(F.status){case"pending":t.queryHash===n.queryHash&&L(F);break;case"fulfilled":(O.status==="error"||O.data!==F.value)&&A();break;case"rejected":(O.status!=="error"||O.error!==F.reason)&&A();break}}return O}updateResult(){const t=this.#s,e=this.createResult(this.#e,this.options);if(this.#r=this.#e.state,this.#i=this.options,this.#r.data!==void 0&&(this.#f=this.#e),Du(e,t))return;this.#s=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:r}=this.options,s=typeof r=="function"?r():r;if(s==="all"||!s&&!this.#g.size)return!0;const i=new Set(s??this.#g);return this.options.throwOnError&&i.add("error"),Object.keys(this.#s).some(o=>{const l=o;return this.#s[l]!==t[l]&&i.has(l)})};this.#k({listeners:n()})}#S(){const t=this.#t.getQueryCache().build(this.#t,this.options);if(t===this.#e)return;const e=this.#e;this.#e=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#k(t){zt.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#s)}),this.#t.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function _L(t,e){return Vr(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function eC(t,e){return _L(t,e)||t.state.data!==void 0&&hx(t,e,e.refetchOnMount)}function hx(t,e,n){if(Vr(e.enabled,t)!==!1&&ia(e.staleTime,t)!=="static"){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&Rb(t,e)}return!1}function tC(t,e,n,r){return(t!==e||Vr(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Rb(t,n)}function Rb(t,e){return Vr(e.enabled,t)!==!1&&t.isStaleByTime(ia(e.staleTime,t))}function OL(t,e){return!Du(t.getCurrentResult(),e)}function nC(t){return{onFetch:(e,n)=>{const r=e.options,s=e.fetchOptions?.meta?.fetchMore?.direction,i=e.state.data?.pages||[],o=e.state.data?.pageParams||[];let l={pages:[],pageParams:[]},d=0;const f=async()=>{let p=!1;const g=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(e.signal.aborted?p=!0:e.signal.addEventListener("abort",()=>{p=!0}),e.signal)})},y=rE(e.options,e.fetchOptions),m=async(b,v,w)=>{if(p)return Promise.reject();if(v==null&&b.pages.length)return Promise.resolve(b);const T=(()=>{const R={client:e.client,queryKey:e.queryKey,pageParam:v,direction:w?"backward":"forward",meta:e.options.meta};return g(R),R})(),j=await y(T),{maxPages:M}=e.options,_=w?NL:CL;return{pages:_(b.pages,j,M),pageParams:_(b.pageParams,v,M)}};if(s&&i.length){const b=s==="backward",v=b?DL:rC,w={pages:i,pageParams:o},S=v(r,w);l=await m(w,S,b)}else{const b=t??i.length;do{const v=d===0?o[0]??r.initialPageParam:rC(r,l);if(d>0&&v==null)break;l=await m(l,v),d++}while(d<b)}return l};e.options.persister?e.fetchFn=()=>e.options.persister?.(f,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=f}}}function rC(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function DL(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var IL=class extends oE{#t;#e;#n;#s;constructor(t){super(),this.#t=t.client,this.mutationId=t.mutationId,this.#n=t.mutationCache,this.#e=[],this.state=t.state||cE(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#e.includes(t)||(this.#e.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#e=this.#e.filter(e=>e!==t),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(t){const e=()=>{this.#r({type:"continue"})},n={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#s=aE({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(i,o)=>{this.#r({type:"failed",failureCount:i,error:o})},onPause:()=>{this.#r({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const r=this.state.status==="pending",s=!this.#s.canStart();try{if(r)e();else{this.#r({type:"pending",variables:t,isPaused:s}),await this.#n.config.onMutate?.(t,this,n);const o=await this.options.onMutate?.(t,n);o!==this.state.context&&this.#r({type:"pending",context:o,variables:t,isPaused:s})}const i=await this.#s.start();return await this.#n.config.onSuccess?.(i,t,this.state.context,this,n),await this.options.onSuccess?.(i,t,this.state.context,n),await this.#n.config.onSettled?.(i,null,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(i,null,t,this.state.context,n),this.#r({type:"success",data:i}),i}catch(i){try{throw await this.#n.config.onError?.(i,t,this.state.context,this,n),await this.options.onError?.(i,t,this.state.context,n),await this.#n.config.onSettled?.(void 0,i,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(void 0,i,t,this.state.context,n),i}finally{this.#r({type:"error",error:i})}}finally{this.#n.runNext(this)}}#r(t){const e=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),zt.batch(()=>{this.#e.forEach(n=>{n.onMutationUpdate(t)}),this.#n.notify({mutation:this,type:"updated",action:t})})}};function cE(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var LL=class extends co{constructor(t={}){super(),this.config=t,this.#t=new Set,this.#e=new Map,this.#n=0}#t;#e;#n;build(t,e,n){const r=new IL({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(r),r}add(t){this.#t.add(t);const e=Df(t);if(typeof e=="string"){const n=this.#e.get(e);n?n.push(t):this.#e.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#t.delete(t)){const e=Df(t);if(typeof e=="string"){const n=this.#e.get(e);if(n)if(n.length>1){const r=n.indexOf(t);r!==-1&&n.splice(r,1)}else n[0]===t&&this.#e.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Df(t);if(typeof e=="string"){const r=this.#e.get(e)?.find(s=>s.state.status==="pending");return!r||r===t}else return!0}runNext(t){const e=Df(t);return typeof e=="string"?this.#e.get(e)?.find(r=>r!==t&&r.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){zt.batch(()=>{this.#t.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#t.clear(),this.#e.clear()})}getAll(){return Array.from(this.#t)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Y2(e,n))}findAll(t={}){return this.getAll().filter(e=>Y2(t,e))}notify(t){zt.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return zt.batch(()=>Promise.all(t.map(e=>e.continue().catch(En))))}};function Df(t){return t.options.scope?.id}var zL=class extends co{#t;#e=void 0;#n;#s;constructor(e,n){super(),this.#t=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#t.defaultMutationOptions(e),Du(this.options,n)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&eo(n.mutationKey)!==eo(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#i(e)}getCurrentResult(){return this.#e}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#i()}mutate(e,n){return this.#s=n,this.#n?.removeObserver(this),this.#n=this.#t.getMutationCache().build(this.#t,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??cE();this.#e={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#i(e){zt.batch(()=>{if(this.#s&&this.hasListeners()){const n=this.#e.variables,r=this.#e.context,s={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#s.onSuccess?.(e.data,n,r,s),this.#s.onSettled?.(e.data,null,n,r,s)):e?.type==="error"&&(this.#s.onError?.(e.error,n,r,s),this.#s.onSettled?.(void 0,e.error,n,r,s))}this.listeners.forEach(n=>{n(this.#e)})})}};function sC(t,e){const n=new Set(e);return t.filter(r=>!n.has(r))}function PL(t,e,n){const r=t.slice(0);return r[e]=n,r}var BL=class extends co{#t;#e;#n;#s;#r;#i;#o;#a;#h=[];constructor(t,e,n){super(),this.#t=t,this.#s=n,this.#n=[],this.#r=[],this.#e=[],this.setQueries(e)}onSubscribe(){this.listeners.size===1&&this.#r.forEach(t=>{t.subscribe(e=>{this.#u(t,e)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#r.forEach(t=>{t.destroy()})}setQueries(t,e){this.#n=t,this.#s=e,zt.batch(()=>{const n=this.#r,r=this.#c(this.#n);this.#h=r,r.forEach(p=>p.observer.setOptions(p.defaultedQueryOptions));const s=r.map(p=>p.observer),i=s.map(p=>p.getCurrentResult()),o=n.length!==s.length,l=s.some((p,g)=>p!==n[g]),d=o||l,f=d?!0:i.some((p,g)=>{const y=this.#e[g];return!y||!Du(p,y)});!d&&!f||(d&&(this.#r=s),this.#e=i,this.hasListeners()&&(d&&(sC(n,s).forEach(p=>{p.destroy()}),sC(s,n).forEach(p=>{p.subscribe(g=>{this.#u(p,g)})})),this.#l()))})}getCurrentResult(){return this.#e}getQueries(){return this.#r.map(t=>t.getCurrentQuery())}getObservers(){return this.#r}getOptimisticResult(t,e){const n=this.#c(t),r=n.map(s=>s.observer.getOptimisticResult(s.defaultedQueryOptions));return[r,s=>this.#f(s??r,e),()=>this.#d(r,n)]}#d(t,e){return e.map((n,r)=>{const s=t[r];return n.defaultedQueryOptions.notifyOnChangeProps?s:n.observer.trackResult(s,i=>{e.forEach(o=>{o.observer.trackProp(i)})})})}#f(t,e){return e?((!this.#i||this.#e!==this.#a||e!==this.#o)&&(this.#o=e,this.#a=this.#e,this.#i=jb(this.#i,e(t))),this.#i):t}#c(t){const e=new Map(this.#r.map(r=>[r.options.queryHash,r])),n=[];return t.forEach(r=>{const s=this.#t.defaultQueryOptions(r),i=e.get(s.queryHash);i?n.push({defaultedQueryOptions:s,observer:i}):n.push({defaultedQueryOptions:s,observer:new Ab(this.#t,s)})}),n}#u(t,e){const n=this.#r.indexOf(t);n!==-1&&(this.#e=PL(this.#e,n,e),this.#l())}#l(){if(this.hasListeners()){const t=this.#i,e=this.#d(this.#e,this.#h),n=this.#f(e,this.#s?.combine);t!==n&&zt.batch(()=>{this.listeners.forEach(r=>{r(this.#e)})})}}},FL=class extends co{constructor(t={}){super(),this.config=t,this.#t=new Map}#t;build(t,e,n){const r=e.queryKey,s=e.queryHash??Tb(r,e);let i=this.get(s);return i||(i=new RL({client:t,queryKey:r,queryHash:s,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(r)}),this.add(i)),i}add(t){this.#t.has(t.queryHash)||(this.#t.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#t.get(t.queryHash);e&&(t.destroy(),e===t&&this.#t.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){zt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#t.get(t)}getAll(){return[...this.#t.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>W2(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>W2(t,n)):e}notify(t){zt.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){zt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){zt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},UL=class{#t;#e;#n;#s;#r;#i;#o;#a;constructor(t={}){this.#t=t.queryCache||new FL,this.#e=t.mutationCache||new LL,this.#n=t.defaultOptions||{},this.#s=new Map,this.#r=new Map,this.#i=0}mount(){this.#i++,this.#i===1&&(this.#o=Mb.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#t.onFocus())}),this.#a=jh.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#t.onOnline())}))}unmount(){this.#i--,this.#i===0&&(this.#o?.(),this.#o=void 0,this.#a?.(),this.#a=void 0)}isFetching(t){return this.#t.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#e.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#t.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#t.build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(ia(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return this.#t.findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=this.#t.get(r.queryHash)?.state.data,o=wL(e,i);if(o!==void 0)return this.#t.build(this,r).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return zt.batch(()=>this.#t.findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#t.get(e.queryHash)?.state}removeQueries(t){const e=this.#t;zt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#t;return zt.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=zt.batch(()=>this.#t.findAll(t).map(s=>s.cancel(n)));return Promise.all(r).then(En).catch(En)}invalidateQueries(t,e={}){return zt.batch(()=>(this.#t.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=zt.batch(()=>this.#t.findAll(t).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(En)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(En)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#t.build(this,e);return n.isStaleByTime(ia(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(En).catch(En)}fetchInfiniteQuery(t){return t.behavior=nC(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(En).catch(En)}ensureInfiniteQueryData(t){return t.behavior=nC(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return jh.isOnline()?this.#e.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#t}getMutationCache(){return this.#e}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#s.set(eo(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#s.values()],n={};return e.forEach(r=>{Ou(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(eo(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(r=>{Ou(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Tb(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Eb&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#t.clear(),this.#e.clear()}},uE=C.createContext(void 0),Le=t=>{const e=C.useContext(uE);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},$L=({client:t,children:e})=>(C.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),u.jsx(uE.Provider,{value:t,children:e})),dE=C.createContext(!1),fE=()=>C.useContext(dE);dE.Provider;function qL(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var HL=C.createContext(qL()),hE=()=>C.useContext(HL),pE=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},gE=t=>{C.useEffect(()=>{t.clearReset()},[t])},mE=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:s})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(s&&t.data===void 0||sE(n,[t.error,r])),yE=t=>{if(t.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=t.staleTime;t.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},xE=(t,e)=>t.isLoading&&t.isFetching&&!e,px=(t,e)=>t?.suspense&&e.isPending,Eh=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function VL({queries:t,...e},n){const r=Le(),s=fE(),i=hE(),o=C.useMemo(()=>t.map(v=>{const w=r.defaultQueryOptions(v);return w._optimisticResults=s?"isRestoring":"optimistic",w}),[t,r,s]);o.forEach(v=>{yE(v),pE(v,i)}),gE(i);const[l]=C.useState(()=>new BL(r,o,e)),[d,f,p]=l.getOptimisticResult(o,e.combine),g=!s&&e.subscribed!==!1;C.useSyncExternalStore(C.useCallback(v=>g?l.subscribe(zt.batchCalls(v)):En,[l,g]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),C.useEffect(()=>{l.setQueries(o,e)},[o,e,l]);const m=d.some((v,w)=>px(o[w],v))?d.flatMap((v,w)=>{const S=o[w];if(S){const T=new Ab(r,S);if(px(S,v))return Eh(S,T,i);xE(v,s)&&Eh(S,T,i)}return[]}):[];if(m.length>0)throw Promise.all(m);const b=d.find((v,w)=>{const S=o[w];return S&&mE({result:v,errorResetBoundary:i,throwOnError:S.throwOnError,query:r.getQueryCache().get(S.queryHash),suspense:S.suspense})});if(b?.error)throw b.error;return f(p())}function KL(t,e,n){const r=fE(),s=hE(),i=Le(),o=i.defaultQueryOptions(t);i.getDefaultOptions().queries?._experimental_beforeQuery?.(o),o._optimisticResults=r?"isRestoring":"optimistic",yE(o),pE(o,s),gE(s);const l=!i.getQueryCache().get(o.queryHash),[d]=C.useState(()=>new e(i,o)),f=d.getOptimisticResult(o),p=!r&&t.subscribed!==!1;if(C.useSyncExternalStore(C.useCallback(g=>{const y=p?d.subscribe(zt.batchCalls(g)):En;return d.updateResult(),y},[d,p]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),C.useEffect(()=>{d.setOptions(o)},[o,d]),px(o,f))throw Eh(o,d,s);if(mE({result:f,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw f.error;return i.getDefaultOptions().queries?._experimental_afterQuery?.(o,f),o.experimental_prefetchInRender&&!Za&&xE(f,r)&&(l?Eh(o,d,s):i.getQueryCache().get(o.queryHash)?.promise)?.catch(En).finally(()=>{d.updateResult()}),o.notifyOnChangeProps?f:d.trackResult(f)}function lt(t,e){return KL(t,Ab)}function Ie(t,e){const n=Le(),[r]=C.useState(()=>new zL(n,t));C.useEffect(()=>{r.setOptions(t)},[r,t]);const s=C.useSyncExternalStore(C.useCallback(o=>r.subscribe(zt.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=C.useCallback((o,l)=>{r.mutate(o,l).catch(En)},[r]);if(s.error&&sE(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}function bn(t,e,n,r){if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)}function Tl(t,e,n,r,s){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var Oa,zr,dl,If,ih;const iC="__TAURI_TO_IPC_KEY__";function QL(t,e=!1){return window.__TAURI_INTERNALS__.transformCallback(t,e)}class bE{constructor(e){Oa.set(this,void 0),zr.set(this,0),dl.set(this,[]),If.set(this,void 0),Tl(this,Oa,e||(()=>{})),this.id=QL(n=>{const r=n.index;if("end"in n){r==bn(this,zr,"f")?this.cleanupCallback():Tl(this,If,r);return}const s=n.message;if(r==bn(this,zr,"f")){for(bn(this,Oa,"f").call(this,s),Tl(this,zr,bn(this,zr,"f")+1);bn(this,zr,"f")in bn(this,dl,"f");){const i=bn(this,dl,"f")[bn(this,zr,"f")];bn(this,Oa,"f").call(this,i),delete bn(this,dl,"f")[bn(this,zr,"f")],Tl(this,zr,bn(this,zr,"f")+1)}bn(this,zr,"f")===bn(this,If,"f")&&this.cleanupCallback()}else bn(this,dl,"f")[r]=s})}cleanupCallback(){window.__TAURI_INTERNALS__.unregisterCallback(this.id)}set onmessage(e){Tl(this,Oa,e)}get onmessage(){return bn(this,Oa,"f")}[(Oa=new WeakMap,zr=new WeakMap,dl=new WeakMap,If=new WeakMap,iC)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[iC]()}}async function Yt(t,e={},n){return window.__TAURI_INTERNALS__.invoke(t,e,n)}class WL{get rid(){return bn(this,ih,"f")}constructor(e){ih.set(this,void 0),Tl(this,ih,e)}async close(){return Yt("plugin:resources|close",{rid:this.rid})}}ih=new WeakMap;const Lf="Request cancelled";async function vE(t,e){const n=e?.signal;if(n?.aborted)throw new Error(Lf);const r=e?.maxRedirections,s=e?.connectTimeout,i=e?.proxy,o=e?.danger;e&&(delete e.maxRedirections,delete e.connectTimeout,delete e.proxy,delete e.danger);const l=e?.headers?e.headers instanceof Headers?e.headers:new Headers(e.headers):new Headers,d=new Request(t,e),f=await d.arrayBuffer(),p=f.byteLength!==0?Array.from(new Uint8Array(f)):null;for(const[R,O]of d.headers)l.get(R)||l.set(R,O);const y=(l instanceof Headers?Array.from(l.entries()):Array.isArray(l)?l:Object.entries(l)).map(([R,O])=>[R,typeof O=="string"?O:O.toString()]);if(n?.aborted)throw new Error(Lf);const m=await Yt("plugin:http|fetch",{clientConfig:{method:d.method,url:d.url,headers:y,data:p,maxRedirections:r,connectTimeout:s,proxy:i,danger:o}}),b=()=>Yt("plugin:http|fetch_cancel",{rid:m});if(n?.aborted)throw b(),new Error(Lf);n?.addEventListener("abort",()=>void b());const{status:v,statusText:w,url:S,headers:T,rid:j}=await Yt("plugin:http|fetch_send",{rid:m}),M=[101,103,204,205,304].includes(v)?null:new ReadableStream({start:R=>{const O=new bE;O.onmessage=L=>{if(n?.aborted){R.error(Lf);return}const A=new Uint8Array(L),F=A[A.byteLength-1],H=A.slice(0,A.byteLength-1);if(F==1){R.close();return}R.enqueue(H)},Yt("plugin:http|fetch_read_body",{rid:j,streamChannel:O}).catch(L=>{R.error(L)})}}),_=new Response(M,{status:v,statusText:w});return Object.defineProperty(_,"url",{value:S}),Object.defineProperty(_,"headers",{value:new Headers(T)}),_}const wE=typeof window<"u"&&"__TAURI_INTERNALS__"in window,YL=wE?vE:window.fetch.bind(window);function GL(){const t=window.__serverConfig?.serverPort??void 0??3e3;return`http://${wE?"localhost":window.location.hostname||"localhost"}:${t}`}async function Me(t,e){return await(await YL(`${GL()}${t}`,{...e??{},credentials:"include",headers:{...e?.headers??{}}})).json()}async function XL(t){const e=t?`?broadcastUrl=${encodeURIComponent(t)}`:"";return(await Me(`/api/livestream/message${e}`)).data.message}async function JL(){return(await Me("/api/livestream/obs/status")).data}async function ZL(){return(await Me("/api/livestream/obs/connect",{method:"POST"})).data}async function ez(){return(await Me("/api/livestream/obs/disconnect",{method:"POST"})).data}async function tz(t=!1){return(await Me(`/api/livestream/obs/scenes${t?"?visible=true":""}`)).data}async function nz(t,e){return(await Me(`/api/livestream/obs/scenes/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).data}async function rz(t){return(await Me("/api/livestream/obs/scenes/reorder",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({sceneIds:t})})).data}async function sz(t){return(await Me(`/api/livestream/obs/scene/${encodeURIComponent(t)}`,{method:"POST"})).data}async function iz(){return(await Me("/api/livestream/obs/stream/start",{method:"POST"})).data}async function az(){return(await Me("/api/livestream/obs/stream/stop",{method:"POST"})).data}async function oz(){return(await Me("/api/livestream/obs/config")).data}async function lz(t){return(await Me("/api/livestream/obs/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).data}async function SE(t){return(await Me("/api/livestream/youtube/tokens",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).data}async function cz(){return(await Me("/api/livestream/youtube/status")).data}async function uz(){await Me("/api/livestream/youtube/logout",{method:"DELETE"})}async function dz(){return(await Me("/api/livestream/youtube/config")).data}async function fz(t){return(await Me("/api/livestream/youtube/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).data}async function hz(){return(await Me("/api/livestream/youtube/broadcast/active")).data}async function pz(){return(await Me("/api/livestream/youtube/broadcasts/completed")).data}function gz(){const[t,e]=C.useState(!1),n=Ie({mutationFn:i=>XL(i)}),r=C.useCallback(async i=>await n.mutateAsync(i),[n]),s=C.useCallback(async i=>{const o=n.data||await n.mutateAsync(i);return await navigator.clipboard.writeText(o),e(!0),setTimeout(()=>e(!1),2e3),o},[n]);return{message:n.data,isLoading:n.isPending,fetchMessage:r,copyMessage:s,copied:t}}function tr(t,e){t!=="debug"&&console.log(`[${t.toUpperCase()}] [livestream-ws] ${e}`)}function kE(){const t=Le(),e=C.useRef(null),n=C.useRef(null),r=C.useRef(null),[s,i]=C.useState("disconnected"),[o,l]=C.useState(null),[d,f]=C.useState(null),p=C.useCallback(()=>{if(e.current?.readyState===WebSocket.OPEN)return;const m=Ct().replace(/^http/,"ws")+"/ws";tr("debug",`Connecting to ${m}`),i("connecting");try{const b=new WebSocket(m);e.current=b,b.onopen=()=>{tr("info","WebSocket connected"),console.log("[livestream-ws] WebSocket CONNECTED to",m),i("connected"),r.current=setInterval(()=>{b.readyState===WebSocket.OPEN&&b.send(JSON.stringify({type:"ping"}))},3e4)},b.onmessage=v=>{try{const w=JSON.parse(v.data);if(w.type==="pong"){tr("debug","Received pong");return}w.type==="obs_connection_status"&&(tr("debug","Received OBS connection status update"),t.invalidateQueries({queryKey:["livestream","obs","status"]})),w.type==="obs_streaming_status"&&(tr("debug","Received OBS streaming status update"),t.invalidateQueries({queryKey:["livestream","obs","status"]})),w.type==="obs_current_scene"&&(tr("debug",`Received OBS current scene: ${w.payload.sceneName}`),t.invalidateQueries({queryKey:["livestream","obs","scenes"]})),w.type==="livestream_status"&&(tr("debug","Received livestream status update"),l(w.payload),t.invalidateQueries({queryKey:["livestream","broadcast"]})),w.type==="youtube_auth_status"&&(tr("info",`Received YouTube auth status update: isAuthenticated=${w.payload.isAuthenticated}`),console.log("[livestream-ws] YouTube auth status payload:",w.payload),t.invalidateQueries({queryKey:["livestream","youtube","auth"]})),w.type==="stream_start_progress"&&(tr("debug",`Stream start progress: ${w.payload.step} (${w.payload.progress}%)`),f(w.payload),(w.payload.step==="completed"||w.payload.step==="error")&&setTimeout(()=>f(null),3e3))}catch(w){tr("error",`Failed to parse message: ${w}`)}},b.onerror=v=>{tr("error",`WebSocket error: ${v}`),i("error")},b.onclose=()=>{tr("info","WebSocket disconnected"),i("disconnected"),r.current&&(clearInterval(r.current),r.current=null),n.current=setTimeout(()=>{tr("debug","Attempting reconnect..."),p()},3e3)}}catch(b){tr("error",`Failed to connect: ${b}`),i("error"),n.current=setTimeout(()=>{p()},5e3)}},[t]),g=C.useCallback(()=>{n.current&&(clearTimeout(n.current),n.current=null),r.current&&(clearInterval(r.current),r.current=null),e.current&&(e.current.close(),e.current=null)},[]);return C.useEffect(()=>(p(),()=>{g()}),[p,g]),{status:s,livestreamStatus:o,streamStartProgress:d,connect:p,disconnect:g}}async function mz(){return(await Me("/api/livestream/mixer/config")).data}async function yz(t){return(await Me("/api/livestream/mixer/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).data}async function xz(){return(await Me("/api/livestream/mixer/channels")).data}async function bz(t){return(await Me("/api/livestream/mixer/channels",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({channels:t})})).data}async function CE(){return(await Me("/api/livestream/mixer/test",{method:"POST"})).data}function NE(){const t=Le(),e=lt({queryKey:["livestream","mixer","channels"],queryFn:xz,staleTime:300*1e3}),n=Ie({mutationFn:r=>bz(r),onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","mixer","channels"]})}});return{...e,channels:e.data??[],update:n.mutate,updateAsync:n.mutateAsync,isUpdating:n.isPending}}function _b(){const t=Le(),e=lt({queryKey:["livestream","mixer","config"],queryFn:mz,staleTime:300*1e3}),n=Ie({mutationFn:s=>yz(s),onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","mixer","config"]})}}),r=Ie({mutationFn:CE});return{...e,config:e.data,update:n.mutate,updateAsync:n.mutateAsync,isUpdating:n.isPending,testConnection:r.mutateAsync,isTesting:r.isPending,testResult:r.data}}function vz(){const t=Le(),e=lt({queryKey:["livestream","obs","config"],queryFn:oz,staleTime:300*1e3}),n=Ie({mutationFn:r=>lz(r),onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","obs","config"]})}});return{...e,config:e.data,update:n.mutate,updateAsync:n.mutateAsync,isUpdating:n.isPending}}function Ob(){const t=Le(),e=lt({queryKey:["livestream","obs","status"],queryFn:JL,staleTime:10*1e3,refetchInterval:30*1e3}),n=Ie({mutationFn:ZL,onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","obs"]})}}),r=Ie({mutationFn:ez,onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","obs"]})}});return{...e,status:e.data,isConnected:e.data?.connected??!1,isStreaming:e.data?.isStreaming??!1,isRecording:e.data?.isRecording??!1,connect:n.mutate,connectAsync:n.mutateAsync,isConnecting:n.isPending,disconnect:r.mutate,disconnectAsync:r.mutateAsync,isDisconnecting:r.isPending}}function Db(t=!1){const e=Le(),n=lt({queryKey:["livestream","obs","scenes",t],queryFn:()=>tz(t),staleTime:10*1e3,refetchInterval:30*1e3}),r=Ie({mutationFn:({id:l,data:d})=>nz(l,d),onSuccess:()=>{e.invalidateQueries({queryKey:["livestream","obs","scenes"]})}}),s=Ie({mutationFn:l=>rz(l),onSuccess:()=>{e.invalidateQueries({queryKey:["livestream","obs","scenes"]})}}),i=Ie({mutationFn:l=>sz(l),onMutate:async l=>{await e.cancelQueries({queryKey:["livestream","obs","scenes"]});const d=e.getQueryData(["livestream","obs","scenes",t]);return e.setQueryData(["livestream","obs","scenes",t],f=>f&&f.map(p=>({...p,isCurrent:p.obsSceneName===l}))),{previousScenes:d}},onError:(l,d,f)=>{f?.previousScenes&&e.setQueryData(["livestream","obs","scenes",t],f.previousScenes)},onSettled:()=>{e.invalidateQueries({queryKey:["livestream","obs","scenes"]})}}),o=n.data?.find(l=>l.isCurrent);return{...n,scenes:n.data??[],currentScene:o,updateScene:r.mutate,isUpdating:r.isPending,reorderScenes:s.mutate,isReordering:s.isPending,switchScene:i.mutate,switchSceneAsync:i.mutateAsync,isSwitching:i.isPending}}function Lp(){const t=Le(),{streamStartProgress:e,livestreamStatus:n}=kE(),r=lt({queryKey:["livestream","broadcast","active"],queryFn:hz,staleTime:10*1e3,refetchInterval:30*1e3}),s=Ie({mutationFn:iz,onSuccess:()=>{t.invalidateQueries({queryKey:["livestream"]})}}),i=Ie({mutationFn:az,onSuccess:()=>{t.invalidateQueries({queryKey:["livestream"]})}}),o=n!==null?n.isLive:r.data?.status==="live";return{activeBroadcast:r.data,isLoadingBroadcast:r.isLoading,isLive:o,start:s.mutate,startAsync:s.mutateAsync,isStarting:s.isPending,stop:i.mutate,stopAsync:i.mutateAsync,isStopping:i.isPending,lastStartedBroadcast:s.data?.broadcast,streamStartProgress:e}}function Iu(){return typeof window<"u"&&"__TAURI_INTERNALS__"in window}async function TE(t){if(console.log("[openInTauriBrowser] Attempting to open:",t),console.log("[openInTauriBrowser] window.__TAURI__:",window.__TAURI__),window.__TAURI__?.opener?.openUrl)try{return console.log("[openInTauriBrowser] Using __TAURI__.opener.openUrl"),await window.__TAURI__.opener.openUrl(t),!0}catch(e){console.error("[openInTauriBrowser] opener.openUrl failed:",e)}if(window.__TAURI__?.shell?.open)try{return console.log("[openInTauriBrowser] Using __TAURI__.shell.open"),await window.__TAURI__.shell.open(t),!0}catch(e){console.error("[openInTauriBrowser] shell.open failed:",e)}try{console.log("[openInTauriBrowser] Trying dynamic import of plugin-shell");const{open:e}=await kn(async()=>{const{open:n}=await import("./index-7PmMyvbH.js");return{open:n}},[]);return await e(t),!0}catch(e){console.error("[openInTauriBrowser] plugin-shell import failed:",e)}try{console.log("[openInTauriBrowser] Trying dynamic import of plugin-opener");const{openUrl:e}=await kn(async()=>{const{openUrl:n}=await import("./index-D9YqSRuv.js");return{openUrl:n}},[]);return await e(t),!0}catch(e){console.error("[openInTauriBrowser] plugin-opener import failed:",e)}return!1}async function gx(t){Iu()&&await TE(t)||window.open(t,"_blank","noopener,noreferrer")}async function aC(t,e){const{popupName:n="auth",width:r=600,height:s=700}=e||{};return console.log("[openAuthUrl] isTauri:",Iu(),"url:",t),Iu()?await TE(t)?(console.log("[openAuthUrl] Successfully opened in native browser"),null):(console.error("[openAuthUrl] All Tauri methods failed, trying window.open"),window.open(t,n,`width=${r},height=${s},left=100,top=100`)):window.open(t,n,`width=${r},height=${s},left=100,top=100`)}const L0="https://churchub-youtube-oauth-worker.bringes.io";function jE(){const t=Le(),{t:e}=ke("livestream"),{showToast:n}=mt(),[r,s]=C.useState(!1),[i,o]=C.useState(null),l=C.useRef(void 0),d=lt({queryKey:["livestream","youtube","auth"],queryFn:cz,staleTime:300*1e3});C.useEffect(()=>{const y=d.data?.requiresReauth;y&&l.current!==!0&&!r&&n(e("errors.youtubeSessionExpired"),"error"),l.current=y},[d.data?.requiresReauth,r,n,e]);const f=Ie({mutationFn:SE,onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","youtube"]}),s(!1),o(null)},onError:y=>{o(y instanceof Error?y.message:"Failed to store tokens"),s(!1)}}),p=Ie({mutationFn:uz,onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","youtube"]})}});C.useEffect(()=>{d.data?.isAuthenticated&&r&&(s(!1),o(null))},[d.data?.isAuthenticated,r]);const g=C.useCallback(async()=>{console.log("[useYouTubeAuth] openLoginPopup called"),console.log("[useYouTubeAuth] YOUTUBE_OAUTH_SERVER:",L0),console.log("[useYouTubeAuth] isTauri:",Iu()),s(!0),o(null);try{const y="http://localhost:3000",m=new URL("/auth/youtube",L0);if(m.searchParams.set("origin",y),Iu()){m.searchParams.set("mode","redirect"),m.searchParams.set("returnUrl",`${y}/auth/youtube/callback`),console.log("[useYouTubeAuth] Opening auth URL:",m.toString()),await aC(m.toString(),{popupName:"youtube-auth"}),setTimeout(()=>{f.isPending||s(!1)},6e4);return}m.searchParams.set("mode","postMessage");const b=await aC(m.toString(),{popupName:"youtube-auth"}),v=async S=>{const T=new URL(L0).origin;if(S.origin===T){if(S.data?.type==="youtube-auth-success"){const{tokens:j}=S.data;try{await f.mutateAsync({accessToken:j.accessToken,refreshToken:j.refreshToken,expiresAt:j.expiresAt})}catch(M){o(M instanceof Error?M.message:"Failed to store tokens"),s(!1)}b?.close()}else S.data?.type==="youtube-auth-error"&&(o(S.data.error||"Authentication failed"),s(!1),b?.close());window.removeEventListener("message",v)}};window.addEventListener("message",v);const w=setInterval(()=>{b?.closed&&(clearInterval(w),window.removeEventListener("message",v),f.isPending||s(!1))},500)}catch(y){o(y instanceof Error?y.message:"Authentication failed"),s(!1)}},[f]);return{...d,isAuthenticated:d.data?.isAuthenticated??!1,channelName:d.data?.channelName,channelId:d.data?.channelId,requiresReauth:d.data?.requiresReauth??!1,login:g,logout:p.mutate,isLoggingOut:p.isPending,isAuthenticating:r,authError:i}}function Ib(){const t=Le(),e=lt({queryKey:["livestream","youtube","config"],queryFn:dz,staleTime:300*1e3}),n=Ie({mutationFn:r=>fz(r),onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","youtube","config"]})}});return{...e,config:e.data,update:n.mutate,updateAsync:n.mutateAsync,isUpdating:n.isPending}}function EE(t=!0){const e=lt({queryKey:["livestream","youtube","broadcasts","completed"],queryFn:pz,staleTime:6e4,enabled:t});return{broadcasts:e.data??[],isLoading:e.isLoading,refetch:e.refetch,isRefetching:e.isRefetching,error:e.error}}function wz(t){return!1}function zf(t,e,n,...r){t==="error"?console.error(`[${e}] ${n}`,...r):t==="warn"?console.warn(`[${e}] ${n}`,...r):wz()&&(t==="debug"?console.debug(`[${e}] ${n}`,...r):t==="info"&&console.log(`[${e}] ${n}`,...r))}function Gl(t){return{debug:(e,...n)=>zf("debug",t,e,...n),info:(e,...n)=>zf("info",t,e,...n),warn:(e,...n)=>zf("warn",t,e,...n),error:(e,...n)=>zf("error",t,e,...n)}}const Lb=C.createContext(null);function Sz({children:t}){const[e,n]=C.useState(0),r=C.useRef(!1);r.current=e>0;const s=C.useCallback(()=>{n(l=>l+1)},[]),i=C.useCallback(()=>{n(l=>Math.max(0,l-1))},[]),o=C.useMemo(()=>({isRecording:e>0,isRecordingRef:r,startRecording:s,stopRecording:i}),[e,s,i]);return u.jsx(Lb.Provider,{value:o,children:t})}function kz(){const t=C.useContext(Lb);if(!t)throw new Error("useShortcutRecording must be used within ShortcutRecordingProvider");return t}function Cz(){return C.useContext(Lb)}async function uo(t,e){try{const n=await Me(`/api/settings/${t}/${e}`);return n.error?null:n.data??null}catch{return null}}async function fo(t,e){try{const n=await Me(`/api/settings/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return n.error?!1:n.data?.success??!1}catch{return!1}}const gu="midi:",ME={enabled:!1,inputDeviceId:null,outputDeviceId:null},oC={actions:{startLive:{shortcuts:[],enabled:!0},stopLive:{shortcuts:[],enabled:!0},searchSong:{shortcuts:[],enabled:!0},searchBible:{shortcuts:[],enabled:!0}},version:1},Pf="global_keyboard_shortcuts";function zb(){const t=Le(),{data:e,isLoading:n}=lt({queryKey:["app_settings",Pf],queryFn:()=>uo("app_settings",Pf)}),r=Ie({mutationFn:f=>fo("app_settings",{key:Pf,value:JSON.stringify(f)}),onSuccess:()=>{t.invalidateQueries({queryKey:["app_settings",Pf]})}}),s=C.useMemo(()=>{if(!e?.value)return oC;try{return JSON.parse(e.value)}catch{return oC}},[e]),i=C.useMemo(()=>s.midi??ME,[s]),o=C.useCallback(async(f,p)=>{const g={...s,actions:{...s.actions,[f]:p}};await r.mutateAsync(g)},[s,r]),l=C.useCallback(async f=>{const p={...s,midi:f};await r.mutateAsync(p)},[s,r]),d=C.useCallback(async f=>{await r.mutateAsync(f)},[r]);return{shortcuts:s,midiConfig:i,isLoading:n,isSaving:r.isPending,updateActionShortcuts:o,updateMIDIConfig:l,updateFullConfig:d}}async function lC(t,e){const n=new bE;return n.onmessage=e,await Yt("plugin:global-shortcut|register",{shortcuts:Array.isArray(t)?t:[t],handler:n})}async function cC(){return await Yt("plugin:global-shortcut|unregister_all",{})}const Pr=Gl("keyboard-shortcuts:global");function Nz({shortcuts:t,sceneShortcuts:e,onStartLive:n,onStopLive:r,onSearchSong:s,onSearchBible:i,onSceneSwitch:o,isRecordingRef:l}){const d=C.useRef({onStartLive:n,onStopLive:r,onSearchSong:s,onSearchBible:i,onSceneSwitch:o});C.useEffect(()=>{d.current={onStartLive:n,onStopLive:r,onSearchSong:s,onSearchBible:i,onSceneSwitch:o}},[n,r,s,i,o]);const f=JSON.stringify(t),p=JSON.stringify(e);C.useEffect(()=>{let g=!1;return(async()=>{const m=JSON.parse(f),b=JSON.parse(p);try{if(await cC(),Pr.debug("Unregistered all previous shortcuts"),g)return;const v={startLive:()=>d.current.onStartLive(),stopLive:()=>d.current.onStopLive(),searchSong:()=>d.current.onSearchSong(),searchBible:()=>d.current.onSearchBible()};if(m.actions){for(const[w,S]of Object.entries(m.actions))if(S.enabled){for(const T of S.shortcuts)if(T){if(g)return;try{await lC(T,j=>{if(j.state==="Pressed"){if(l?.current){Pr.debug(`Skipping shortcut ${T} - recording in progress`);return}Pr.info(`App shortcut triggered: ${T} -> ${w}`),v[w]()}}),Pr.info(`Registered app shortcut: ${T} -> ${w}`)}catch(j){Pr.error(`Failed to register app shortcut ${T}:`,j)}}}}for(const{shortcut:w,sceneName:S}of b)if(w){if(g)return;try{await lC(w,T=>{if(T.state==="Pressed"){if(l?.current){Pr.debug(`Skipping scene shortcut ${w} - recording in progress`);return}Pr.info(`Scene shortcut triggered: ${w} -> ${S}`),d.current.onSceneSwitch(S)}}),Pr.info(`Registered scene shortcut: ${w} -> ${S}`)}catch(T){Pr.error(`Failed to register scene shortcut ${w}:`,T)}}Pr.info("All shortcuts registered successfully")}catch(v){Pr.error("Failed to register shortcuts:",v)}})(),()=>{g=!0,cC().catch(m=>{Pr.error("Failed to cleanup shortcuts on unmount:",m)})}},[f,p])}const nn=Gl("midi:context"),Pb=C.createContext(null);function AE({children:t,initialConfig:e=ME,onConfigChange:n}){const[r,s]=C.useState(!1),[i,o]=C.useState(null),[l,d]=C.useState([]),[f,p]=C.useState([]),[g,y]=C.useState(e),m=C.useRef(null),b=C.useRef(null),v=C.useRef(new Set),w=!0,S=C.useCallback(async()=>{try{const E=await(await fetch(`${Ct()}/api/midi/devices`)).json();if(E.data){const K=E.data.inputs.map(V=>({id:String(V.id),name:V.name,manufacturer:"Unknown",state:"connected"})),q=E.data.outputs.map(V=>({id:String(V.id),name:V.name,manufacturer:"Unknown",state:"connected"}));d(K),p(q),nn.debug("Fetched MIDI devices",{inputs:K,outputs:q})}}catch(B){nn.error("Failed to fetch MIDI devices",{error:B})}},[]),T=C.useCallback(()=>{if(m.current?.readyState===WebSocket.OPEN)return;const B=`${sD()}/ws`;try{const E=new WebSocket(B);m.current=E,E.onopen=()=>{s(!0),o(null)},E.onmessage=K=>{try{const q=JSON.parse(K.data);if(q.type==="midi_message"){const V={type:q.payload.type,channel:q.payload.channel,note:q.payload.note,controller:q.payload.controller,value:q.payload.value,timestamp:q.payload.timestamp};v.current.forEach(ie=>{try{ie(V)}catch(Y){nn.error("Error in MIDI message subscriber",{error:Y})}})}q.type==="midi_connection_status"&&nn.debug("MIDI connection status",q.payload),q.type==="midi_devices"&&(nn.debug("MIDI devices update",q.payload),S())}catch(q){nn.error("Failed to parse WebSocket message",{error:q})}},E.onerror=K=>{nn.error("WebSocket error",{error:K}),o("WebSocket connection error")},E.onclose=()=>{nn.info("WebSocket disconnected"),g.enabled&&(b.current=setTimeout(()=>{nn.debug("Reconnecting WebSocket..."),T()},3e3))}}catch(E){nn.error("Failed to connect WebSocket",{error:E}),o("Failed to connect to MIDI service")}},[g.enabled,S]),j=C.useCallback(async()=>{try{await S(),T();const B=g.inputDeviceId?parseInt(g.inputDeviceId,10):null,E=g.outputDeviceId?parseInt(g.outputDeviceId,10):null;if(B!==null||E!==null)try{const q=await(await fetch(`${Ct()}/api/midi/connect`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inputDeviceId:B,outputDeviceId:E})})).json()}catch{}return!0}catch(B){const E=B instanceof Error?B.message:"Unknown error requesting MIDI access";return nn.error("MIDI access request failed",{error:E}),o(E),!1}},[S,T,g.inputDeviceId,g.outputDeviceId]),M=C.useCallback(async(B,E)=>{try{const q=await(await fetch(`${Ct()}/api/midi/connect`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inputDeviceId:B,outputDeviceId:E})})).json();return nn.debug("MIDI connect result",q),q.data}catch(K){return nn.error("Failed to connect MIDI devices",{error:K}),null}},[]),_=C.useCallback(B=>{const E=B?parseInt(B,10):null;y(K=>{const q={...K,inputDeviceId:B};return n?.(q),q}),M(E,g.outputDeviceId?parseInt(g.outputDeviceId,10):null)},[g.outputDeviceId,M,n]),R=C.useCallback(B=>{const E=B?parseInt(B,10):null;y(K=>{const q={...K,outputDeviceId:B};return n?.(q),q}),M(g.inputDeviceId?parseInt(g.inputDeviceId,10):null,E)},[g.inputDeviceId,M,n]),O=C.useCallback(B=>{y(E=>{const K={...E,enabled:B};return n?.(K),K}),B?j():(m.current&&(m.current.close(),m.current=null),fetch(`${Ct()}/api/midi/disconnect`,{method:"POST"}).catch(E=>nn.error("Failed to disconnect",{error:E})))},[n,j]),L=C.useCallback(B=>{if(y(E=>{const K={...E,...B};return n?.(K),K}),B.inputDeviceId!==void 0||B.outputDeviceId!==void 0){const E=B.inputDeviceId??g.inputDeviceId,K=B.outputDeviceId??g.outputDeviceId;M(E?parseInt(E,10):null,K?parseInt(K,10):null)}},[g.inputDeviceId,g.outputDeviceId,M,n]),A=C.useCallback((B,E)=>{if(!m.current||m.current.readyState!==WebSocket.OPEN){nn.debug("Cannot set LED: WebSocket not connected");return}try{m.current.send(JSON.stringify({type:"midi_set_led",payload:{note:B,on:E}})),nn.debug(`LED ${B} set to ${E?"ON":"OFF"}`)}catch(K){nn.error("Error sending LED message",{error:K,note:B,on:E})}},[]),F=C.useCallback(B=>{if(!m.current||m.current.readyState!==WebSocket.OPEN){nn.debug("Cannot set LEDs: WebSocket not connected");return}const E=[];B.forEach((K,q)=>{E.push({note:q,on:K})});try{m.current.send(JSON.stringify({type:"midi_set_all_leds",payload:{ledStates:E}}))}catch(K){nn.error("Error sending LED messages",{error:K})}},[]),H=C.useCallback(B=>(v.current.add(B),()=>{v.current.delete(B)}),[]);C.useEffect(()=>(g.enabled&&j(),()=>{b.current&&clearTimeout(b.current),m.current&&m.current.close()}),[g.enabled,j]),C.useEffect(()=>{y(e)},[e]);const P=C.useMemo(()=>({isSupported:w,isEnabled:g.enabled,hasPermission:r,permissionError:i,inputDevices:l,outputDevices:f,selectedInputId:g.inputDeviceId,selectedOutputId:g.outputDeviceId,requestAccess:j,selectInputDevice:_,selectOutputDevice:R,setEnabled:O,setLED:A,setAllLEDs:F,subscribe:H,config:g,updateConfig:L}),[w,g,r,i,l,f,j,_,R,O,A,F,H,L]);return u.jsx(Pb.Provider,{value:P,children:t})}function Tz(){const t=C.useContext(Pb);if(!t)throw new Error("useMIDI must be used within a MIDIProvider");return t}function Bb(){return C.useContext(Pb)}function RE(t){switch(t.type){case"note_on":return`${gu}note_on:${t.note}`;case"note_off":return`${gu}note_off:${t.note}`;case"control_change":return`${gu}cc:${t.controller}`;default:return""}}function _E(t){if(!to(t))return null;const e=t.slice(gu.length),[n,r]=e.split(":"),s=parseInt(r,10);if(isNaN(s))return null;switch(n){case"note_on":return{type:"note_on",number:s};case"note_off":return{type:"note_off",number:s};case"cc":return{type:"control_change",number:s};default:return null}}function to(t){return t.startsWith(gu)}function jz(t){const e=_E(t);if(!e)return t;switch(e.type){case"note_on":return`MIDI Note ${e.number}`;case"note_off":return`MIDI Note Off ${e.number}`;case"control_change":return`MIDI CC ${e.number}`;default:return t}}function uC(t){const e=_E(t);return e?e.number:null}const z0=Gl("midi:led-feedback");function Ez({shortcuts:t,sceneShortcuts:e,isLive:n,currentSceneName:r}){const s=Bb(),i=C.useRef(new Map);C.useEffect(()=>{if(!s||!s.isEnabled||!s.selectedOutputId){z0.debug("LED feedback disabled: no MIDI output");return}const o=new Map;if(t?.actions){const d=Object.keys(t.actions);for(const f of d){const p=t.actions[f];if(!(!p?.enabled||!p.shortcuts))for(const g of p.shortcuts){if(!to(g))continue;const y=uC(g);if(y===null)continue;let m=!1;(f==="startLive"||f==="stopLive")&&(m=n),o.set(y,m)}}}for(const{shortcut:d,sceneName:f}of e){if(!to(d))continue;const p=uC(d);if(p===null)continue;const g=f===r;o.set(p,g)}const l=[];if(o.forEach((d,f)=>{i.current.get(f)!==d&&l.push({note:f,on:d})}),i.current.forEach((d,f)=>{!o.has(f)&&d&&l.push({note:f,on:!1})}),l.length>0){z0.debug("LED state changes",{changes:l});for(const{note:d,on:f}of l)s.setLED(d,f)}i.current=o},[s,t,e,n,r]),C.useEffect(()=>()=>{!s||!s.isEnabled||(z0.debug("Cleaning up LED states"),i.current.forEach((o,l)=>{o&&s.setLED(l,!1)}))},[s])}const fl=Gl("midi:shortcuts"),Mz=200;function Az({shortcuts:t,sceneShortcuts:e,onStartLive:n,onStopLive:r,onSearchSong:s,onSearchBible:i,onSceneSwitch:o,isRecordingRef:l}){const d=Bb(),f=C.useRef({onStartLive:n,onStopLive:r,onSearchSong:s,onSearchBible:i,onSceneSwitch:o});C.useEffect(()=>{f.current={onStartLive:n,onStopLive:r,onSearchSong:s,onSearchBible:i,onSceneSwitch:o}},[n,r,s,i,o]);const p=C.useRef(new Map),g=C.useRef(new Map);C.useEffect(()=>{const m=new Map;if(t?.actions){const b=Object.keys(t.actions);for(const v of b){const w=t.actions[v];if(w?.enabled&&w.shortcuts){for(const S of w.shortcuts)if(to(S)){const T=m.get(S)||[];T.push({type:"global",action:v}),m.set(S,T),fl.debug(`Mapped MIDI shortcut ${S} to global action ${v}`)}}}}for(const{shortcut:b,sceneName:v}of e)if(to(b)){const w=m.get(b)||[];w.push({type:"scene",action:v}),m.set(b,w),fl.debug(`Mapped MIDI shortcut ${b} to scene ${v}`)}p.current=m,fl.info(`Built MIDI shortcut map with ${m.size} entries`)},[t,e]);const y=C.useCallback(m=>{if(l?.current){fl.debug("Skipping MIDI action - recording in progress");return}if(m.type==="note_off"||m.type==="control_change"&&m.value===0)return;const b=RE(m),v=Date.now(),w=g.current.get(b)||0;if(v-w<Mz){fl.debug(`Debouncing MIDI shortcut: ${b} (${v-w}ms since last)`);return}g.current.set(b,v);const S=p.current.get(b);if(!(!S||S.length===0)){fl.info(`MIDI shortcut triggered: ${b}`,{mappings:S});for(const T of S)if(T.type==="global")switch(T.action){case"startLive":f.current.onStartLive?.();break;case"stopLive":f.current.onStopLive?.();break;case"searchSong":f.current.onSearchSong?.();break;case"searchBible":f.current.onSearchBible?.();break}else T.type==="scene"&&f.current.onSceneSwitch?.(T.action)}},[]);C.useEffect(()=>{if(!d||!d.isEnabled)return;const m=d.subscribe(b=>{y(b)});return()=>{m()}},[d,y])}const Js=Gl("keyboard-shortcuts:manager");function Rz(){const t=ar(),{shortcuts:e,isLoading:n}=zb(),{start:r,stop:s,isLive:i,isStarting:o,isStopping:l,streamStartProgress:d}=Lp(),{scenes:f,switchScene:p,currentScene:g}=Db(),{isRecordingRef:y}=kz(),m=C.useRef(!1),b=C.useRef(!1),v=d&&d.step!=="completed"&&d.step!=="error";C.useEffect(()=>{!o&&!v&&(m.current=!1)},[o,v]),C.useEffect(()=>{l||(b.current=!1)},[l]);const w=C.useMemo(()=>{const R=[];for(const O of f)if(O.shortcuts)for(const L of O.shortcuts)R.push({shortcut:L,sceneName:O.obsSceneName});return R},[f]),S=C.useCallback(()=>{if(i){if(b.current||l){Js.debug("Skipping stop - already stopping");return}b.current=!0,Js.info("Stopping live stream via shortcut (toggle)"),t({to:"/livestream"}),s();return}if(m.current||o||v){Js.debug("Skipping start - already starting");return}m.current=!0,Js.info("Starting live stream via shortcut"),t({to:"/livestream"}),r()},[r,s,t,i,o,l,v]),T=C.useCallback(()=>{if(b.current||!i&&!v||l){Js.debug("Skipping stop - livestream is not live/starting or already stopping");return}b.current=!0,Js.info("Stopping live stream via shortcut"),t({to:"/livestream/"}),s()},[s,t,i,l,v]),j=C.useCallback(()=>{Js.debug("Navigating to song search via shortcut"),t({to:"/songs/"})},[t]),M=C.useCallback(()=>{Js.debug("Navigating to Bible search via shortcut"),t({to:"/bible/"})},[t]),_=C.useCallback(R=>{Js.debug(`Switching to scene: ${R}`),p(R)},[p]);return Nz({shortcuts:n?{actions:{},version:1}:e,sceneShortcuts:w,onStartLive:S,onStopLive:T,onSearchSong:j,onSearchBible:M,onSceneSwitch:_,isRecordingRef:y}),Az({shortcuts:n?{actions:{},version:1}:e,sceneShortcuts:w,onStartLive:S,onStopLive:T,onSearchSong:j,onSearchBible:M,onSceneSwitch:_,isRecordingRef:y}),Ez({shortcuts:n?{actions:{},version:1}:e,sceneShortcuts:w,isLive:i??!1,currentSceneName:g?.obsSceneName??null}),null}function OE(t){if(to(t))return jz(t);const e=navigator.platform.includes("Mac");return t.replace("CommandOrControl",e?"Cmd":"Ctrl").replace("Control","Ctrl").replace("Meta","Cmd").replace("ArrowUp","").replace("ArrowDown","").replace("ArrowLeft","").replace("ArrowRight","")}function dC(t){return["Meta","Control","Alt","Shift"].includes(t)}const _z=[["startLive","stopLive"]];function Oz(t,e){return _z.some(([n,r])=>t===n&&e===r||t===r&&e===n)}function Dz(t,e,n,r){for(const[s,i]of Object.entries(n.actions))if(s!==e&&!Oz(e,s)&&i.shortcuts.includes(t))return{shortcut:t,conflictSource:"global",conflictName:s};for(const s of r)if(s.shortcuts?.includes(t))return{shortcut:t,conflictSource:"scene",conflictName:s.displayName};return null}function DE({value:t,onChange:e,onRemove:n,error:r,namespace:s="settings"}){const{t:i}=ke(s),[o,l]=C.useState(!1),d=C.useRef(o),f=C.useRef(e),p=Bb(),g=Cz();C.useEffect(()=>{d.current=o},[o]),C.useEffect(()=>{f.current=e},[e]),C.useEffect(()=>!o||!p||!p.isEnabled?void 0:p.subscribe(j=>{if(j.type==="note_off"||j.type==="control_change"&&j.value===0)return;const M=RE(j);M&&(f.current(M),l(!1),g?.stopRecording())}),[o,p,g]);const y=s==="livestream"?"scenes":"sections.shortcuts",m=C.useCallback(T=>{if(T.preventDefault(),T.stopPropagation(),!d.current)return;const j=[];if((T.metaKey||T.ctrlKey)&&j.push("CommandOrControl"),T.altKey&&j.push("Alt"),T.shiftKey&&j.push("Shift"),!dC(T.key)){const M=T.key.length===1?T.key.toUpperCase():T.key;j.push(M)}j.length>0&&!dC(T.key)&&(f.current(j.join("+")),l(!1),g?.stopRecording())},[g]),b=C.useCallback(()=>{l(!0),g?.startRecording()},[g]),v=C.useCallback(()=>{l(!1),g?.stopRecording()},[g]),w=t&&to(t),S=()=>o?p?.isEnabled?i(`${y}.recordShortcutOrMidi`,{defaultValue:"Press key or MIDI button..."}):i(`${y}.recordShortcut`):i(`${y}.clickToRecord`,{defaultValue:"Click to record"});return u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:"flex-1 relative",children:[w&&!o&&u.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 px-1.5 py-0.5 text-[10px] font-medium bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded",children:"MIDI"}),u.jsx("input",{type:"text",readOnly:!0,value:t?OE(t):"",placeholder:S(),onKeyDown:m,onFocus:b,onBlur:v,className:`
            w-full py-2 text-sm
            border rounded-lg
            bg-white dark:bg-gray-700
            text-gray-900 dark:text-white
            placeholder:text-gray-400 dark:placeholder:text-gray-500
            focus:outline-none focus:ring-2
            cursor-pointer
            ${w&&!o?"pl-14 pr-3":"px-3"}
            ${r?"border-red-500 focus:ring-red-500":o?"border-indigo-500 focus:ring-indigo-500":"border-gray-300 dark:border-gray-600 focus:ring-indigo-500"}
          `}),o&&u.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-indigo-500 animate-pulse",children:i(`${y}.recording`,{defaultValue:"Recording..."})})]}),u.jsx("button",{type:"button",onClick:n,className:"p-2 text-gray-400 hover:text-red-500 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:i(`${y}.removeShortcut`),children:u.jsx(nt,{size:18})})]})}function Iz({action:t,config:e,allShortcuts:n,scenes:r,onUpdate:s}){const{t:i}=ke("settings"),[o,l]=C.useState({}),d=t.icon,f=C.useCallback(v=>Dz(v,t.id,n,r),[t.id,n,r]),p=C.useCallback(v=>{if(v.conflictSource==="global"){const w=i(`sections.shortcuts.actions.${v.conflictName}.label`);return i("sections.shortcuts.conflicts.global",{action:w})}return i("sections.shortcuts.conflicts.scene",{scene:v.conflictName})},[i]),g=C.useCallback(()=>{s({...e,shortcuts:[...e.shortcuts,""]})},[e,s]),y=C.useCallback(v=>{const w=e.shortcuts.filter((S,T)=>T!==v);s({...e,shortcuts:w}),l(S=>{const T={...S};return delete T[v],T})},[e,s]),m=C.useCallback((v,w)=>{const S=[...e.shortcuts];S[v]=w,s({...e,shortcuts:S});const T=f(w);l(T?j=>({...j,[v]:p(T)}):j=>{const M={...j};return delete M[v],M})},[e,s,f,p]),b=C.useCallback(()=>{s({...e,enabled:!e.enabled})},[e,s]);return u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-start justify-between mb-3",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-indigo-50 dark:bg-indigo-900/30 rounded-lg",children:u.jsx(d,{size:20,className:"text-indigo-600 dark:text-indigo-400"})}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:i(t.labelKey)}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:i(t.descriptionKey)})]})]}),u.jsx("button",{type:"button",onClick:b,className:`
            px-3 py-1 text-xs font-medium rounded-full transition-colors
            ${e.enabled?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}
          `,children:e.enabled?i("sections.shortcuts.enabled"):i("sections.shortcuts.disabled")})]}),u.jsxs("div",{className:"space-y-2",children:[e.shortcuts.length===0?u.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 italic",children:i("sections.shortcuts.noShortcuts")}):e.shortcuts.map((v,w)=>u.jsxs("div",{children:[u.jsx(DE,{value:v,onChange:S=>m(w,S),onRemove:()=>y(w),error:o[w],namespace:"settings"}),o[w]&&u.jsx("p",{className:"mt-1 text-xs text-red-500",children:o[w]})]},w)),u.jsxs("button",{type:"button",onClick:g,className:"flex items-center gap-2 text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 mt-2",children:[u.jsx(Xt,{size:16}),i("sections.shortcuts.addShortcut")]})]})]})}function Mn({options:t,value:e,onChange:n,onCreateNew:r,placeholder:s="Select...",createNewLabel:i="Create",disabled:o=!1,allowClear:l=!0,className:d=""}){const[f,p]=C.useState(!1),[g,y]=C.useState(""),[m,b]=C.useState(!1),[v,w]=C.useState({left:0,width:0,openUpward:!1}),S=C.useRef(null),T=C.useRef(null),j=C.useRef(null),M=C.useRef(null),_=t.find(P=>P.value===e),R=t.filter(P=>P.label.toLowerCase().includes(g.toLowerCase())),O=r&&g.trim().length>0&&!t.some(P=>P.label.toLowerCase()===g.toLowerCase());C.useEffect(()=>{function P(B){const E=B.target,K=S.current&&!S.current.contains(E),q=j.current&&!j.current.contains(E);K&&q&&(p(!1),y(""))}return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]),C.useEffect(()=>{f&&M.current&&M.current.focus()},[f]),C.useEffect(()=>{if(f&&T.current){const P=T.current.getBoundingClientRect(),B=250,E=window.innerHeight-P.bottom,K=P.top,q=E<B&&K>E;w(q?{bottom:window.innerHeight-P.top+4,left:P.left+window.scrollX,width:P.width,openUpward:!0}:{top:P.bottom+window.scrollY+4,left:P.left+window.scrollX,width:P.width,openUpward:!1})}},[f]);const L=P=>{n(P.value),p(!1),y("")},A=P=>{P.stopPropagation(),n(null)},F=async()=>{if(!(!r||!g.trim())){b(!0);try{const P=await r(g.trim());P&&(n(P.value),p(!1),y(""))}finally{b(!1)}}},H=P=>{P.key==="Escape"?(p(!1),y("")):P.key==="Enter"&&O&&(P.preventDefault(),F())};return u.jsxs("div",{ref:S,className:`relative ${d}`,children:[u.jsxs("button",{ref:T,type:"button",onClick:()=>!o&&p(!f),disabled:o,className:"w-full flex items-center justify-between gap-2 px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-left text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[u.jsx("span",{className:_?"":"text-gray-400 dark:text-gray-500",children:_?.label||s}),u.jsxs("div",{className:"flex items-center gap-1",children:[l&&_&&u.jsx(nt,{className:"w-4 h-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",onClick:A}),u.jsx(Es,{className:`w-4 h-4 text-gray-400 transition-transform ${f?"rotate-180":""}`})]})]}),f&&Xi.createPortal(u.jsxs("div",{ref:j,className:"fixed z-[9999] bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg overflow-hidden",style:{...v.openUpward?{bottom:v.bottom}:{top:v.top},left:v.left,width:v.width},children:[u.jsx("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:u.jsx("input",{ref:M,type:"text",value:g,onChange:P=>y(P.target.value),onKeyDown:H,placeholder:"Search...",className:"w-full px-2 py-1 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded text-sm text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-indigo-500"})}),u.jsxs("div",{className:"max-h-48 overflow-y-auto",children:[O&&u.jsxs("button",{type:"button",onClick:F,disabled:m,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-indigo-600 dark:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 disabled:opacity-50",children:[u.jsx(Xt,{className:"w-4 h-4"}),i,' "',g,'"']}),R.length===0&&!O?u.jsx("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:"No options found"}):R.map(P=>u.jsxs("button",{type:"button",onClick:()=>L(P),className:`w-full flex items-center justify-between px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 ${P.value===e?"bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-400":"text-gray-900 dark:text-white"}`,children:[P.label,P.value===e&&u.jsx(wb,{className:"w-4 h-4"})]},P.value))]})]}),document.body)]})}function Lz(){const{t}=ke("settings"),e=Tz(),n=C.useMemo(()=>e.inputDevices.map(o=>({value:o.id,label:o.manufacturer&&o.manufacturer!=="Unknown"?`${o.name} (${o.manufacturer})`:o.name})),[e.inputDevices]),r=C.useMemo(()=>e.outputDevices.map(o=>({value:o.id,label:o.manufacturer&&o.manufacturer!=="Unknown"?`${o.name} (${o.manufacturer})`:o.name})),[e.outputDevices]),s=()=>{!e.hasPermission&&!e.isEnabled?e.requestAccess().then(o=>{o&&e.setEnabled(!0)}):e.setEnabled(!e.isEnabled)},i=()=>{e.requestAccess()};return e.isSupported?u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:u.jsx(TI,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t("sections.shortcuts.midi.title",{defaultValue:"MIDI Controller"})}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t("sections.shortcuts.midi.description",{defaultValue:"Use hardware MIDI controllers for shortcuts with LED feedback"})})]})]}),u.jsx("button",{type:"button",onClick:s,className:`
            relative inline-flex h-6 w-11 items-center rounded-full transition-colors
            ${e.isEnabled?"bg-purple-600":"bg-gray-200 dark:bg-gray-700"}
          `,role:"switch","aria-checked":e.isEnabled,children:u.jsx("span",{className:`
              inline-block h-4 w-4 transform rounded-full bg-white transition-transform
              ${e.isEnabled?"translate-x-6":"translate-x-1"}
            `})})]}),e.permissionError&&u.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:u.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:t("sections.shortcuts.midi.permissionError",{defaultValue:"MIDI access denied: {{error}}",error:e.permissionError})})}),e.isEnabled&&e.hasPermission&&u.jsxs("div",{className:"space-y-3 pl-10",children:[u.jsx("div",{className:"flex justify-end",children:u.jsxs("button",{type:"button",onClick:i,className:"flex items-center gap-1.5 px-2 py-1 text-xs text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:[u.jsx(Cb,{className:"w-3 h-3"}),t("sections.shortcuts.midi.refresh",{defaultValue:"Refresh devices"})]})}),u.jsxs("div",{className:"space-y-1.5",children:[u.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[u.jsx(p6,{className:"w-4 h-4"}),t("sections.shortcuts.midi.inputDevice",{defaultValue:"Input Device"})]}),u.jsx(Mn,{options:n,value:e.selectedInputId,onChange:o=>e.selectInputDevice(o),placeholder:t("sections.shortcuts.midi.selectDevice",{defaultValue:"Select device..."}),allowClear:!0}),e.inputDevices.length===0&&u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t("sections.shortcuts.midi.noInputDevices",{defaultValue:"No MIDI input devices detected"})})]}),u.jsxs("div",{className:"space-y-1.5",children:[u.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[u.jsx($j,{className:"w-4 h-4"}),t("sections.shortcuts.midi.outputDevice",{defaultValue:"Output Device (LEDs)"})]}),u.jsx(Mn,{options:r,value:e.selectedOutputId,onChange:o=>e.selectOutputDevice(o),placeholder:t("sections.shortcuts.midi.selectDevice",{defaultValue:"Select device..."}),allowClear:!0}),e.outputDevices.length===0&&u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t("sections.shortcuts.midi.noOutputDevices",{defaultValue:"No MIDI output devices detected"})})]}),(e.selectedInputId||e.selectedOutputId)&&u.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${e.selectedInputId&&e.selectedOutputId?"bg-green-500":"bg-yellow-500"}`}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.selectedInputId&&e.selectedOutputId?t("sections.shortcuts.midi.fullyConnected",{defaultValue:"Input and output connected"}):e.selectedInputId?t("sections.shortcuts.midi.inputOnly",{defaultValue:"Input connected (no LED feedback)"}):t("sections.shortcuts.midi.outputOnly",{defaultValue:"Output connected (no triggers)"})})]})]}),e.isEnabled&&!e.hasPermission&&!e.permissionError&&u.jsx("div",{className:"pl-10",children:u.jsx("button",{type:"button",onClick:()=>e.requestAccess(),className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors",children:t("sections.shortcuts.midi.requestPermission",{defaultValue:"Grant MIDI Access"})})})]}):u.jsx("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:u.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:t("sections.shortcuts.midi.notSupported",{defaultValue:"Web MIDI API is not supported in this browser. MIDI controller features are unavailable."})})})}function zz({children:t}){const{midiConfig:e,updateMIDIConfig:n,isLoading:r}=zb(),s=C.useCallback(i=>{n(i)},[n]);return r?u.jsx(u.Fragment,{children:t}):u.jsx(AE,{initialConfig:e,onConfigChange:s,children:t})}const Pz=[{id:"startLive",labelKey:"sections.shortcuts.actions.startLive.label",descriptionKey:"sections.shortcuts.actions.startLive.description",icon:kb},{id:"stopLive",labelKey:"sections.shortcuts.actions.stopLive.label",descriptionKey:"sections.shortcuts.actions.stopLive.description",icon:Vj},{id:"searchSong",labelKey:"sections.shortcuts.actions.searchSong.label",descriptionKey:"sections.shortcuts.actions.searchSong.description",icon:ha},{id:"searchBible",labelKey:"sections.shortcuts.actions.searchBible.label",descriptionKey:"sections.shortcuts.actions.searchBible.description",icon:Ap}];function Bz(){const{t}=ke("settings"),{shortcuts:e,isLoading:n,updateActionShortcuts:r}=zb(),{scenes:s}=Db(),i=C.useMemo(()=>s?s.map(l=>({displayName:l.displayName,shortcuts:l.shortcuts||[]})):[],[s]),o=(l,d)=>{r(l,d)};return n?u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(E2,{size:24,className:"text-indigo-600 dark:text-indigo-400"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.shortcuts.title")})]}),u.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3,4].map(l=>u.jsx("div",{className:"h-32 bg-gray-100 dark:bg-gray-800 rounded-lg"},l))})]}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(E2,{size:24,className:"text-indigo-600 dark:text-indigo-400"}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.shortcuts.title")}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("sections.shortcuts.description")})]})]}),u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:u.jsx(Lz,{})}),u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 space-y-3",children:Pz.map(l=>u.jsx(Iz,{action:l,config:e.actions[l.id],allShortcuts:e,scenes:i,onUpdate:d=>o(l.id,d)},l.id))})]})}async function Fz(){const t=await fetch(`${Ct()}/api/screens`,{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch screens");return(await t.json()).data}async function Uz(t){const e=await fetch(`${Ct()}/api/screens/${t}`,{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch screen");return(await e.json()).data}async function $z(t){`${t.name}`;const e=await fetch(`${Ct()}/api/screens`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!e.ok)throw new Error("Failed to save screen");return(await e.json()).data}async function qz(t){if(!(await fetch(`${Ct()}/api/screens/${t}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("Failed to delete screen")}async function Hz(t,e,n,r){const s=await fetch(`${Ct()}/api/screens/${t}/batch-config`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({globalSettings:e,contentConfigs:n,nextSlideConfig:r}),credentials:"include"});if(!s.ok)throw new Error("Failed to batch update screen config");return(await s.json()).data}const Fb=["screens"];function Ub(){return lt({queryKey:Fb,queryFn:Fz})}function Vz(){const t=navigator.userAgent.toLowerCase(),e=navigator.platform.toLowerCase();return e.includes("win")||t.includes("windows")?"windows":e.includes("mac")||t.includes("macintosh")||t.includes("mac os")?"macos":e.includes("linux")||t.includes("linux")?"linux":"unknown"}async function Mh(t,e){const n=Vz();console.log(`[setWindowFullscreen] Platform: ${n}, setting fullscreen: ${e}`);const r=async()=>{try{return await new Promise(o=>setTimeout(o,100)),await t.isFullscreen()===e}catch{return!1}},s=async()=>{try{const i=await t.isMaximized();return e?i:!i}catch{return!1}};try{if(console.log("[setWindowFullscreen] Trying win.setFullscreen()..."),await t.setFullscreen(e),await r())return console.log(`[setWindowFullscreen] setFullscreen(${e}) succeeded!`),!0;console.log("[setWindowFullscreen] setFullscreen did not achieve desired state")}catch(i){console.error("[setWindowFullscreen] setFullscreen threw error:",i)}if(n==="macos")try{return console.log("[setWindowFullscreen] Trying macOS setSimpleFullscreen..."),await t.setSimpleFullscreen(e),console.log(`[setWindowFullscreen] setSimpleFullscreen(${e}) called`),!0}catch(i){console.error("[setWindowFullscreen] setSimpleFullscreen failed:",i)}else if(n==="windows")try{if(console.log("[setWindowFullscreen] Trying Windows maximize+decorations fallback..."),e?(await t.setDecorations(!1),await t.maximize()):(await t.unmaximize(),await t.setDecorations(!0)),await s())return console.log("[setWindowFullscreen] Windows fallback succeeded!"),!0;console.log("[setWindowFullscreen] Windows fallback did not achieve desired state")}catch(i){console.error("[setWindowFullscreen] Windows fallback failed:",i)}return console.error(`[setWindowFullscreen] All Tauri methods failed for platform: ${n}`),!1}const IE="display-window-positions";function dn(){const t="__TAURI_INTERNALS__"in window,e="__TAURI__"in window;return console.log("[isTauri] __TAURI_INTERNALS__:",t,"__TAURI__:",e),t||e}function mx(){return dn()?"http://localhost:3000":window.location.origin}function Kz(t,e){try{const n=LE();n[t]=e,localStorage.setItem(IE,JSON.stringify(n))}catch(n){console.error("[saveWindowState] Failed to save window state:",n)}}function LE(){try{const t=localStorage.getItem(IE);return t?JSON.parse(t):{}}catch{return{}}}function Qz(t){return LE()[t]||null}async function zE(t,e,n=!1,r){console.log(`[openDisplayWindow] Opening display ${t} in ${e} mode, isTauri: ${dn()}, defaultFullscreen: ${n}`);const s=`${mx()}/screen/${t}`;console.log(`[openDisplayWindow] URL: ${s}`),console.log("[openDisplayWindow] Opening in native mode"),await Yz(t,s,n,r)}async function Wz(t){if(console.log(`[openInBrowser] called, isTauri: ${dn()}`),dn())try{console.log("[openInBrowser] Importing @tauri-apps/plugin-shell");const{open:e}=await kn(async()=>{const{open:n}=await import("./index-7PmMyvbH.js");return{open:n}},[]);console.log("[openInBrowser] Calling shell.open()"),await e(t),console.log("[openInBrowser] shell.open() completed")}catch(e){console.error("[openInBrowser] Failed to open in browser via Tauri:",e),window.open(t,"_blank")}else console.log("[openInBrowser] Opening via window.open"),window.open(t,"_blank")}async function Yz(t,e,n=!1,r){if(console.log(`[openInNativeWindow] called, isTauri: ${dn()}`),dn())try{console.log("[openInNativeWindow] Importing @tauri-apps/api/webviewWindow");const{WebviewWindow:s}=await kn(async()=>{const{WebviewWindow:p}=await import("./webviewWindow-YTEqKU76.js");return{WebviewWindow:p}},__vite__mapDeps([0,1,2,3]));console.log("[openInNativeWindow] WebviewWindow imported:",s);const i=`display-${t}`;console.log(`[openInNativeWindow] Window label: ${i}`),console.log("[openInNativeWindow] Checking for existing window");const o=await s.getByLabel(i);if(console.log("[openInNativeWindow] existingWindow:",o),o){console.log("[openInNativeWindow] Window exists, focusing"),await o.setFocus(),await o.setAlwaysOnTop(!0);return}const l=Qz(t);console.log("[openInNativeWindow] Stored state:",l);const d={url:e,title:r||`Display ${t}`,width:l?.width??1280,height:l?.height??720,x:l?.x,y:l?.y,center:!l,resizable:!0,maximizable:!0,minimizable:!0,decorations:!0,alwaysOnTop:!0,skipTaskbar:!0,focus:!0};console.log("[openInNativeWindow] Creating window with options:",d);const f=new s(i,d);console.log("[openInNativeWindow] WebviewWindow constructor called, webview:",f),f.once("tauri://created",async()=>{console.log(`[openInNativeWindow] Native window created: ${i}`),await new Promise(y=>setTimeout(y,100));const p=await s.getByLabel(i);if(!p){console.error("[openInNativeWindow] Could not get window by label");return}l?.fullscreen?(console.log("[openInNativeWindow] Restoring fullscreen state"),await Mh(p,!0)):l?.maximized?(console.log("[openInNativeWindow] Restoring maximized state"),await p.maximize()):!l&&n&&(console.log("[openInNativeWindow] Applying default fullscreen setting"),await Mh(p,!0));const g=async()=>{try{const y=await s.getByLabel(i);if(y){const m=await y.outerPosition(),b=await y.outerSize(),v=await y.isMaximized(),w=await y.isFullscreen();Kz(t,{x:m.x,y:m.y,width:b.width,height:b.height,maximized:v,fullscreen:w})}}catch{}};f.listen("tauri://move",g),f.listen("tauri://resize",g)}),f.once("tauri://error",p=>{console.error("[openInNativeWindow] tauri://error event:",p)}),console.log("[openInNativeWindow] Event listeners attached")}catch(s){console.error("[openInNativeWindow] Error opening native window:",s),console.log("[openInNativeWindow] Falling back to browser window.open"),window.open(e,"_blank")}else console.log("[openInNativeWindow] Not in Tauri, falling back to browser"),window.open(e,"_blank")}async function fC(t){if(console.log(`[closeDisplayWindow] Closing display ${t}, isTauri: ${dn()}`),!!dn())try{const{WebviewWindow:e}=await kn(async()=>{const{WebviewWindow:s}=await import("./webviewWindow-YTEqKU76.js");return{WebviewWindow:s}},__vite__mapDeps([0,1,2,3])),n=`display-${t}`;console.log(`[closeDisplayWindow] Looking for window: ${n}`);const r=await e.getByLabel(n);console.log(`[closeDisplayWindow] Window found: ${!!r}`),r?(await r.close(),console.log("[closeDisplayWindow] Window closed successfully")):console.warn(`[closeDisplayWindow] Window not found: ${n}`)}catch(e){console.error("[closeDisplayWindow] Failed to close display window:",e)}}async function Gz(t){const e=t.filter(n=>n.isActive);for(const n of e)await zE(n.id,"native",n.isFullscreen,n.name),await new Promise(r=>setTimeout(r,100))}const Xz=Gl("app:screen");function Jz(){const{data:t,isSuccess:e}=Ub(),n=C.useRef(!1);C.useEffect(()=>{n.current||!e||!t||!dn()||(n.current=!0,Gz(t).catch(r=>{Xz.error("Failed to auto-open screens:",r)}))},[t,e])}function Zz(){return Ie({mutationFn:({screenId:t,globalSettings:e,contentConfigs:n,nextSlideConfig:r})=>Hz(t,e,n,r)})}function eP(){const t=Le();return Ie({mutationFn:qz,onSuccess:()=>{t.invalidateQueries({queryKey:Fb})}})}function tP(){const{data:t}=fi(),e=PE(),n=zp(),r=$b(),s=!!t?.currentQueueItemId||!!t?.currentSongSlideId;C.useEffect(()=>{const i=o=>{if(!(o.target instanceof HTMLInputElement||o.target instanceof HTMLTextAreaElement||o.target instanceof HTMLSelectElement||o.target instanceof HTMLElement&&o.target.isContentEditable||document.querySelector("dialog[open]")))switch(o.key){case"ArrowRight":case"ArrowDown":case" ":case"PageDown":o.preventDefault(),s&&e.mutate("next");break;case"ArrowLeft":case"ArrowUp":case"PageUp":o.preventDefault(),s&&e.mutate("prev");break;case"Escape":o.preventDefault(),n.mutate();break;case"F5":case"F10":case"Enter":o.preventDefault(),r.mutate();break}};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[s,e,n,r])}async function nP(){const t=await fetch(`${Ct()}/api/presentation/state`,{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch presentation state");return(await t.json()).data}async function rP(t){const e=await fetch(`${Ct()}/api/presentation/state`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!e.ok)throw new Error("Failed to update presentation state");return(await e.json()).data}async function sP(){const t=await fetch(`${Ct()}/api/presentation/clear`,{method:"POST",credentials:"include"});if(!t.ok)throw new Error("Failed to clear slide");return(await t.json()).data}async function iP(){const t=await fetch(`${Ct()}/api/presentation/show`,{method:"POST",credentials:"include"});if(!t.ok)throw new Error("Failed to show slide");return(await t.json()).data}async function aP(t){const e=await fetch(`${Ct()}/api/presentation/navigate-queue`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({direction:t}),credentials:"include"});if(!e.ok)throw new Error("Failed to navigate queue");return(await e.json()).data}async function oP(t){const e=await fetch(`${Ct()}/api/presentation/temporary-bible`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!e.ok)throw new Error("Failed to present temporary Bible verse");return(await e.json()).data}async function lP(t){const e=await fetch(`${Ct()}/api/presentation/temporary-song`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!e.ok)throw new Error("Failed to present temporary song");return(await e.json()).data}async function cP(t){const e=await fetch(`${Ct()}/api/presentation/navigate-temporary`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({direction:t.direction}),credentials:"include"});if(!e.ok)throw new Error("Failed to navigate temporary content");return(await e.json()).data}async function uP(){const t=await fetch(`${Ct()}/api/presentation/clear-temporary`,{method:"POST",credentials:"include"});if(!t.ok)throw new Error("Failed to clear temporary content");return(await t.json()).data}const As=["presentation","state"];function fi(){return lt({queryKey:As,queryFn:nP,refetchInterval:1e4,refetchOnWindowFocus:!0})}function zp(){const t=Le();return Ie({mutationFn:sP,onSuccess:e=>{t.setQueryData(As,e)}})}function $b(){const t=Le();return Ie({mutationFn:iP,onSuccess:e=>{t.setQueryData(As,e)}})}function dP(){const t=Le();return Ie({mutationFn:rP,onSuccess:e=>{t.setQueryData(As,e)}})}function PE(){const t=Le();return Ie({mutationFn:aP,onSuccess:e=>{t.setQueryData(As,e)}})}function fP(){const t=Le();return Ie({mutationFn:oP,onSuccess:e=>{t.setQueryData(As,e)}})}function BE(){const t=Le();return Ie({mutationFn:lP,onSuccess:e=>{t.setQueryData(As,e)}})}function FE(){const t=Le();return Ie({mutationFn:cP,onSuccess:e=>{t.setQueryData(As,e)}})}function UE(){const t=Le();return Ie({mutationFn:uP,onSuccess:e=>{t.setQueryData(As,e)}})}function Lu(t){return["screens",t]}function qb(t){return lt({queryKey:Lu(t??0),queryFn:()=>Uz(t),enabled:t!=null})}function $E(){const t=Le();return Ie({mutationFn:$z,onSuccess:e=>{t.invalidateQueries({queryKey:Fb}),e?.id&&t.invalidateQueries({queryKey:Lu(e.id)})}})}function yr(t,e){t!=="debug"&&console.log(`[${t.toUpperCase()}] [websocket] ${e}`)}function Xl(){const t=Le(),e=C.useRef(null),n=C.useRef(null),r=C.useRef(null),[s,i]=C.useState("disconnected"),o=C.useCallback(()=>{if(e.current?.readyState===WebSocket.OPEN)return;const p=Ct().replace(/^http/,"ws")+"/ws";yr("debug",`Connecting to ${p}`),i("connecting");try{const g=new WebSocket(p);e.current=g,g.onopen=()=>{yr("info","WebSocket connected"),i("connected"),r.current=setInterval(()=>{g.readyState===WebSocket.OPEN&&g.send(JSON.stringify({type:"ping"}))},3e4)},g.onmessage=y=>{try{const m=JSON.parse(y.data);if(m.type==="pong"){yr("debug","Received pong");return}m.type==="presentation_state"&&(yr("debug","Received presentation state update"),t.setQueryData(As,m.payload)),m.type==="screen_config_updated"&&(yr("debug",`Received screen config update for screen ${m.payload.screenId}`),t.invalidateQueries({queryKey:Lu(m.payload.screenId)})),m.type==="screen_config_preview"&&(yr("debug",`Received screen config preview for screen ${m.payload.screenId}`),t.setQueryData(Lu(m.payload.screenId),m.payload.config))}catch(m){yr("error",`Failed to parse message: ${m}`)}},g.onerror=y=>{yr("error",`WebSocket error: ${y}`),i("error"),n.current||(n.current=setTimeout(()=>{yr("debug","Attempting reconnect after error..."),o()},3e3))},g.onclose=()=>{yr("info","WebSocket disconnected"),i("disconnected"),r.current&&(clearInterval(r.current),r.current=null),n.current&&(clearTimeout(n.current),n.current=null),n.current=setTimeout(()=>{yr("debug","Attempting reconnect..."),o()},3e3)}}catch(g){yr("error",`Failed to connect: ${g}`),i("error"),n.current=setTimeout(()=>{o()},5e3)}},[t]),l=C.useCallback(()=>{n.current&&(clearTimeout(n.current),n.current=null),r.current&&(clearInterval(r.current),r.current=null),e.current&&(e.current.close(),e.current=null)},[]),d=C.useCallback(f=>e.current?.readyState===WebSocket.OPEN?(e.current.send(JSON.stringify(f)),!0):(yr("error","Cannot send message: WebSocket not connected"),!1),[]);return C.useEffect(()=>(o(),()=>{l()}),[o,l]),{status:s,connect:o,disconnect:l,send:d}}function qE({isOpen:t,title:e,message:n,onClose:r,variant:s="info"}){const{t:i}=ke(),o=C.useRef(null);C.useEffect(()=>{const p=o.current;p&&(t?p.showModal():p.close())},[t]);const l={error:"text-red-500",warning:"text-yellow-500",info:"text-blue-500"}[s],d={error:"bg-red-600 hover:bg-red-700",warning:"bg-yellow-600 hover:bg-yellow-700",info:"bg-indigo-600 hover:bg-indigo-700"}[s],f=p=>{p.target===o.current&&r()};return u.jsx("dialog",{ref:o,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:r,onClick:f,children:u.jsxs("div",{className:"p-6 min-w-[300px] max-w-md",children:[u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsxs("div",{className:`flex-shrink-0 ${l}`,children:[s==="error"&&u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s==="warning"&&u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s==="info"&&u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:e}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:n})]})]}),u.jsx("div",{className:"flex justify-end mt-6",children:u.jsx("button",{type:"button",onClick:r,className:`px-4 py-2 rounded-lg font-medium text-white transition-colors ${d}`,children:i("common:buttons.ok")})})]})})}function di({isOpen:t,title:e,message:n,confirmLabel:r,cancelLabel:s,onConfirm:i,onCancel:o,variant:l="default"}){const{t:d}=ke(),f=C.useRef(null);C.useEffect(()=>{const y=f.current;y&&(t?y.showModal():y.close())},[t]);const p=l==="danger"?"bg-red-600 hover:bg-red-700 text-white":"bg-indigo-600 hover:bg-indigo-700 text-white",g=y=>{y.target===f.current&&o()};return u.jsx("dialog",{ref:f,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:o,onClick:g,children:u.jsxs("div",{className:"p-6 min-w-[300px] max-w-md",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:e}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:n}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:s??d("common:buttons.cancel")}),u.jsx("button",{type:"button",onClick:i,className:`px-4 py-2 rounded-lg font-medium transition-colors ${p}`,children:r})]})]})})}function hP({category:t,onEdit:e,onDelete:n}){const{t:r}=ke("settings");return u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white truncate block",children:t.name}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[r("sections.categories.value"),": ",t.priority]})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{type:"button",onClick:e,className:"p-2 text-gray-500 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors",title:r("sections.categories.actions.edit"),children:u.jsx(Xa,{size:16})}),u.jsx("button",{type:"button",onClick:n,className:"p-2 text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors",title:r("sections.categories.actions.delete"),children:u.jsx(Bn,{size:16})})]})]})}function pP({isOpen:t,category:e,onSubmit:n,onCancel:r,isLoading:s}){const{t:i}=ke("settings"),o=C.useRef(null),l=C.useRef(null),[d,f]=C.useState(e?.name??""),[p,g]=C.useState(e?.priority??1);C.useEffect(()=>{t?(o.current?.showModal(),l.current?.focus()):o.current?.close()},[t]),C.useEffect(()=>{f(e?.name??""),g(e?.priority??1)},[e]);const y=b=>{b.preventDefault(),d.trim()&&n(d.trim(),p)},m=b=>{b.target===o.current&&r()};return u.jsx("dialog",{ref:o,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-md w-full",onClose:r,onClick:m,children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:i(e?"sections.categories.modals.edit.title":"sections.categories.modals.create.title")}),u.jsx("button",{type:"button",onClick:r,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:u.jsx(nt,{size:20})})]}),u.jsxs("form",{onSubmit:y,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("sections.categories.categoryName")}),u.jsx("input",{ref:l,type:"text",value:d,onChange:b=>f(b.target.value),placeholder:i("sections.categories.categoryNamePlaceholder"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("sections.categories.value")}),u.jsx("input",{type:"number",min:1,value:p,onChange:b=>g(Number(b.target.value)||1),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:i("common:buttons.cancel","Cancel")}),u.jsx("button",{type:"submit",disabled:s||!d.trim(),className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors disabled:opacity-50",children:i(e?"sections.categories.modals.edit.submit":"sections.categories.modals.create.submit")})]})]})]})})}async function gP(){return(await Me("/api/categories")).data??[]}async function mP(t){const e=await Me("/api/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,category:e.data}}async function yP(t){return(await Me(`/api/categories/${t}`,{method:"DELETE"})).data?.success??!1}async function xP(){return(await Me("/api/songs")).data??[]}async function bP(t){return(await Me(`/api/songs/${t}`)).data??null}async function vP(t){const e=await Me("/api/songs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function wP(t){return(await Me(`/api/songs/${t}`,{method:"DELETE"})).data?.success??!1}async function SP(t){return(await Me(`/api/songs/search?q=${encodeURIComponent(t)}`)).data??[]}function Pp(){return lt({queryKey:["categories"],queryFn:gP})}function kP(){const t=Le();return Ie({mutationFn:yP,onSuccess:e=>{e&&t.invalidateQueries({queryKey:["categories"]})}})}function CP(){const t=Le();return Ie({mutationFn:wP,onSuccess:()=>{t.invalidateQueries({queryKey:["songs"]})}})}function NP(t,e){if(t.title!==e.title||t.categoryId!==e.categoryId||t.slides.length!==e.slides.length)return!1;for(let n=0;n<t.slides.length;n++)if(t.slides[n].content!==e.slides[n].content||t.slides[n].sortOrder!==e.slides[n].sortOrder)return!1;return!0}function TP(){const t=C.useRef(null),e=C.useCallback(s=>{t.current={title:s.title,categoryId:s.categoryId,slides:s.slides.map((i,o)=>({id:i.id,content:i.content,sortOrder:o}))}},[]),n=C.useCallback(s=>{if(!t.current)return!0;const i={title:s.title,categoryId:s.categoryId,slides:s.slides.map((o,l)=>({id:o.id,content:o.content,sortOrder:l}))};return!NP(i,t.current)},[]),r=C.useCallback(()=>{t.current=null},[]);return{setSavedState:e,isDirty:n,resetSavedState:r}}function jP(t){return lt({queryKey:["songs","search",t],queryFn:()=>SP(t),enabled:t.length>0})}function Hb(t){return lt({queryKey:["song",t],queryFn:()=>bP(t),enabled:t!==null})}function EP({onNextSlide:t,onPreviousSlide:e,onHidePresentation:n,enabled:r=!0}){C.useEffect(()=>{if(!r)return;const s=i=>{if(!(i.target instanceof HTMLInputElement||i.target instanceof HTMLTextAreaElement||i.target instanceof HTMLSelectElement))switch(i.key){case"ArrowDown":case"ArrowRight":i.preventDefault(),t();break;case"ArrowUp":case"ArrowLeft":i.preventDefault(),e();break;case"Escape":i.preventDefault(),n();break}};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[r,t,e,n])}function MP(){return lt({queryKey:["songs"],queryFn:xP})}function AP({isDirty:t}){const[e,n]=C.useState(!1),[r,s]=C.useState(null),{proceed:i,reset:o,status:l}=GO({condition:t});C.useEffect(()=>{l==="blocked"&&(n(!0),s(()=>i))},[l,i]),C.useEffect(()=>{const p=g=>{t&&(g.preventDefault(),g.returnValue="")};return window.addEventListener("beforeunload",p),()=>window.removeEventListener("beforeunload",p)},[t]);const d=C.useCallback(()=>{n(!1),s(null),o?.()},[o]),f=C.useCallback(()=>{n(!1),r?.(),s(null)},[r]);return{showModal:e,handleCancel:d,handleDiscard:f}}function Vb(){const t=Le();return Ie({mutationFn:e=>mP(e),onSuccess:e=>{e.success&&t.invalidateQueries({queryKey:["categories"]})}})}function Kb(){const t=Le();return Ie({mutationFn:e=>vP(e),onSuccess:e=>{e.success&&(t.invalidateQueries({queryKey:["songs"]}),e.id&&t.invalidateQueries({queryKey:["song",e.id]}))}})}function RP(){const{t}=ke("settings"),{showToast:e}=mt(),{data:n,isLoading:r,error:s}=Pp(),i=Vb(),o=kP(),[l,d]=C.useState({type:"none"}),f=async(y,m)=>{(await i.mutateAsync({name:y,priority:m})).success?(d({type:"none"}),e(t("sections.categories.toast.created"),"success")):e(t("sections.categories.toast.error"),"error")},p=async(y,m)=>{if(l.type!=="edit")return;(await i.mutateAsync({id:l.category.id,name:y,priority:m})).success?(d({type:"none"}),e(t("sections.categories.toast.updated"),"success")):e(t("sections.categories.toast.error"),"error")},g=async()=>{if(l.type!=="delete")return;await o.mutateAsync(l.category.id)?(d({type:"none"}),e(t("sections.categories.toast.deleted"),"success")):e(t("sections.categories.toast.error"),"error")};return r?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s?u.jsx("div",{className:"text-center py-8 text-red-500",children:t("sections.categories.toast.error")}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.categories.title")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("sections.categories.description")})]}),u.jsxs("button",{type:"button",onClick:()=>d({type:"create"}),className:"flex items-center gap-2 px-3 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors text-sm whitespace-nowrap shrink-0",children:[u.jsx(Xt,{size:16}),t("sections.categories.addCategory")]})]}),n&&n.length>0?u.jsx("div",{className:"space-y-2",children:n.map(y=>u.jsx(hP,{category:y,onEdit:()=>d({type:"edit",category:y}),onDelete:()=>d({type:"delete",category:y})},y.id))}):u.jsxs("div",{className:"text-center py-12 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx(jj,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:t("sections.categories.noCategories")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:t("sections.categories.noCategoriesDescription")})]}),(l.type==="create"||l.type==="edit")&&u.jsx(pP,{isOpen:!0,category:l.type==="edit"?l.category:void 0,onSubmit:l.type==="create"?f:p,onCancel:()=>d({type:"none"}),isLoading:i.isPending}),l.type==="delete"&&u.jsx(di,{isOpen:!0,title:t("sections.categories.modals.delete.title"),message:t("sections.categories.modals.delete.message",{name:l.category.name}),confirmLabel:t("sections.categories.modals.delete.confirm"),cancelLabel:t("common:buttons.cancel","Cancel"),onConfirm:g,onCancel:()=>d({type:"none"}),variant:"danger"})]})}function Bp({value:t,onChange:e,disabled:n}){const{t:r}=ke("songs"),{data:s}=Pp(),i=Vb(),o=C.useMemo(()=>s?.map(d=>({value:d.id,label:d.name}))??[],[s]),l=async d=>{const f=await i.mutateAsync({name:d});return f.success&&f.category?{value:f.category.id,label:f.category.name}:null};return u.jsx(Mn,{options:o,value:t,onChange:d=>e(d),onCreateNew:l,placeholder:r("editor.categoryPlaceholder"),createNewLabel:r("category.create"),disabled:n})}function _P({isOpen:t,onClose:e,onImport:n}){const{t:r}=ke("songs"),[s,i]=C.useState(""),o=C.useRef(null);C.useEffect(()=>{const g=o.current;g&&(t?g.showModal():g.close())},[t]);const l=C.useMemo(()=>s.trim()?s.split(/\n\s*\n/).map(g=>g.trim()).filter(g=>g.length>0).map(g=>g.split(`
`).map(m=>`<p>${m}</p>`).join("")):[],[s]),d=()=>{l.length>0&&(n(l),i(""),e())},f=()=>{i(""),e()},p=g=>{g.target===o.current&&f()};return u.jsx("dialog",{ref:o,className:"fixed inset-0 p-0 m-auto w-full max-w-lg bg-transparent backdrop:bg-black/50",onClose:f,onClick:p,children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[u.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ds,{className:"w-5 h-5 text-indigo-500"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r("import.title")})]}),u.jsx("button",{type:"button",onClick:f,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",children:u.jsx(nt,{className:"w-5 h-5 text-gray-500"})})]}),u.jsxs("div",{className:"p-4 space-y-4",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r("import.description")}),u.jsx("textarea",{value:s,onChange:g=>i(g.target.value),placeholder:r("import.placeholder"),rows:10,className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none font-mono text-sm"}),l.length>0&&u.jsx("p",{className:"text-sm text-indigo-600 dark:text-indigo-400",children:r("import.preview",{count:l.length})})]}),u.jsxs("div",{className:"flex justify-end gap-2 px-4 py-3 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:r("import.cancel")}),u.jsx("button",{type:"button",onClick:d,disabled:l.length===0,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:r("import.confirm")})]})]})})}function OP({song:t,onClick:e}){const n=t.highlightedTitle?.includes("<mark>");return u.jsxs("button",{type:"button",onClick:e,className:"w-full flex items-center justify-between p-4 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:border-indigo-300 dark:hover:border-indigo-600 hover:shadow-sm transition-all text-left group",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[n?u.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate [&_mark]:bg-yellow-300 [&_mark]:dark:bg-yellow-400/60 [&_mark]:rounded-sm [&_mark]:px-0.5",dangerouslySetInnerHTML:{__html:t.highlightedTitle}}):u.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.title}),t.categoryName&&u.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[u.jsx(i6,{className:"w-3 h-3 text-gray-400"}),u.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.categoryName})]}),t.matchedContent&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-2 [&_mark]:bg-yellow-300 [&_mark]:dark:bg-yellow-400/60 [&_mark]:rounded-sm [&_mark]:px-0.5",dangerouslySetInnerHTML:{__html:t.matchedContent}})]}),u.jsx(Ms,{className:"w-5 h-5 text-gray-400 group-hover:text-indigo-500 transition-colors flex-shrink-0 ml-2"})]})}function DP({isOpen:t,availableTranslations:e,onSubmit:n,onClose:r}){const{t:s}=ke("settings"),i=C.useRef(null),[o,l]=C.useState(null);C.useEffect(()=>{const g=i.current;g&&(t?(g.showModal(),l(null)):g.close())},[t]);const d=C.useMemo(()=>e.map(g=>({value:g.id,label:`${g.name} (${g.abbreviation})`})),[e]),f=()=>{o!==null&&(n(o),r())},p=g=>{g.target===i.current&&r()};return u.jsx("dialog",{ref:i,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:r,onClick:p,children:u.jsxs("div",{className:"p-6 min-w-[350px] max-w-md",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:s("sections.bible.modals.add.title")}),u.jsx("div",{className:"space-y-4 mb-6",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:s("sections.bible.modals.add.selectLabel")}),u.jsx(Mn,{options:d,value:o,onChange:g=>l(g),placeholder:s("sections.bible.modals.add.selectLabel"),allowClear:!1})]})}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:s("common:buttons.cancel",{defaultValue:"Cancel"})}),u.jsx("button",{type:"button",onClick:f,disabled:o===null,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:s("sections.bible.modals.add.submit")})]})]})})}function IP({onPrevVerse:t,onNextVerse:e,canNavigate:n}){const{t:r}=ke("bible");Xl();const{data:s}=fi(),i=zp(),o=$b(),l=s?.isHidden??!0,d=!!s?.currentSongSlideId||!!s?.currentQueueItemId||!!s?.lastSongSlideId,f=async()=>{(s?.lastSongSlideId||s?.currentQueueItemId)&&await o.mutateAsync()},p=async()=>{await i.mutateAsync()};return u.jsxs("div",{className:"flex flex-col lg:h-full bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 lg:p-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Sh,{size:18,className:"text-indigo-600 dark:text-indigo-400"}),u.jsx("h3",{className:"font-medium text-gray-900 dark:text-white text-sm lg:text-base",children:r("controls.title")})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-md ${l?"bg-gray-100 dark:bg-gray-700":"bg-red-100 dark:bg-red-900/30"}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${l?"bg-gray-400 dark:bg-gray-500":"bg-red-500 animate-pulse"}`}),u.jsx("span",{className:`text-xs font-semibold ${l?"text-gray-400 dark:text-gray-500":"text-red-600 dark:text-red-400"}`,children:"LIVE"})]}),l?u.jsxs("button",{type:"button",onClick:f,disabled:!d||o.isPending,className:"flex items-center gap-1.5 px-2 lg:px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 transition-colors",title:`${r("controls.show")} (F10)`,children:[o.isPending?u.jsx(Qe,{size:18,className:"animate-spin"}):u.jsx(ua,{size:18}),u.jsx("span",{className:"hidden sm:inline",children:r("controls.show")}),u.jsx("span",{className:"text-xs opacity-75 hidden sm:inline",children:"(F10)"})]}):u.jsxs("button",{type:"button",onClick:p,disabled:i.isPending,className:"flex items-center gap-1.5 px-2 lg:px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 transition-colors",title:`${r("controls.hide")} (Esc)`,children:[i.isPending?u.jsx(Qe,{size:18,className:"animate-spin"}):u.jsx(Wl,{size:18}),u.jsx("span",{className:"hidden sm:inline",children:r("controls.hide")}),u.jsx("span",{className:"text-xs opacity-75 hidden sm:inline",children:"(Esc)"})]})]})]}),u.jsxs("div",{className:"p-2 lg:p-3 lg:flex-1 lg:min-h-0 flex flex-col",children:[u.jsx("div",{className:"w-full lg:flex-1 lg:min-h-0 lg:flex lg:items-center lg:justify-center",children:u.jsx(Yv,{})}),u.jsxs("div",{className:"flex items-center justify-center gap-2 pt-2 lg:pt-3 flex-shrink-0",children:[u.jsxs("button",{type:"button",onClick:t,disabled:!n,className:"flex items-center gap-1.5 px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",title:r("controls.prevVerse"),children:[u.jsx(Sb,{size:18}),u.jsx("span",{className:"text-sm",children:r("controls.prev")})]}),u.jsxs("button",{type:"button",onClick:e,disabled:!n,className:"flex items-center gap-1.5 px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",title:r("controls.nextVerse"),children:[u.jsx("span",{className:"text-sm",children:r("controls.next")}),u.jsx(Es,{size:18})]})]})]})]})}const hC=39;function LP({books:t,isLoading:e,onSelectBook:n}){const{t:r}=ke("bible");if(e)return u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600 dark:text-indigo-400"})});if(t.length===0)return u.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:r("navigation.noBooks")});const s=t.filter(o=>o.bookOrder<=hC),i=t.filter(o=>o.bookOrder>hC);return u.jsxs("div",{className:"h-full overflow-y-auto space-y-4",children:[s.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-1",children:r("navigation.oldTestament")}),u.jsx("div",{className:"grid grid-cols-2 gap-1",children:s.map(o=>u.jsx("button",{type:"button",onClick:()=>n(o.id,o.bookName),className:"text-left px-2 py-1.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 rounded-md transition-colors truncate",children:o.bookName},o.id))})]}),i.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-1",children:r("navigation.newTestament")}),u.jsx("div",{className:"grid grid-cols-2 gap-1",children:i.map(o=>u.jsx("button",{type:"button",onClick:()=>n(o.id,o.bookName),className:"text-left px-2 py-1.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 rounded-md transition-colors truncate",children:o.bookName},o.id))})]})]})}function zP({bookName:t,chapters:e,isLoading:n,onSelectChapter:r,onGoBack:s}){const{t:i}=ke("bible");return n?u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600 dark:text-indigo-400"})}):u.jsxs("div",{className:"space-y-3",children:[u.jsxs("button",{type:"button",onClick:s,className:"flex items-center gap-1.5 text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 transition-colors",children:[u.jsx(ed,{size:16}),i("navigation.back")]}),u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t}),u.jsx("div",{className:"grid grid-cols-6 gap-1.5",children:e.map(o=>u.jsx("button",{type:"button",onClick:()=>r(o.chapter),className:"aspect-square flex items-center justify-center text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 hover:bg-indigo-100 dark:hover:bg-indigo-900/40 rounded-md transition-colors",children:o.chapter},o.chapter))})]})}function PP({results:t,isLoading:e,verseNumber:n}){if(e)return u.jsx("div",{className:"flex items-center justify-center py-4",children:u.jsx(Qe,{className:"w-4 h-4 animate-spin text-indigo-500"})});const r=t.filter(s=>s.verse!==null);return r.length===0||r.length===1?null:u.jsx("div",{className:"mt-2 space-y-2 pl-6 border-l-2 border-indigo-200 dark:border-indigo-700",children:r.map(({translation:s,verse:i})=>u.jsxs("div",{className:"text-sm",children:[u.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 mr-2",children:s.abbreviation}),u.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:i?.text})]},s.id))})}async function BP(){return(await Me("/api/bible/translations")).data}async function FP(t){return(await Me("/api/bible/translations",{method:"POST",body:JSON.stringify(t)})).data}async function UP(t){return(await Me(`/api/bible/books/${t}`)).data}async function $P(t){return(await Me(`/api/bible/chapters/${t}`)).data}async function qP(t,e){return(await Me(`/api/bible/verses/${t}/${e}`)).data}async function HP(t){return(await Me(`/api/bible/verse/${t}`)).data}async function VP(t){try{return(await Me(`/api/bible/next-verse/${t}`)).data}catch{return null}}async function KP(t,e,n,r){try{return(await Me(`/api/bible/verse-by-reference/${t}/${e}/${n}/${r}`)).data}catch{return null}}async function QP(t,e,n){const r=new URLSearchParams({q:t});return e&&r.set("translationId",String(e)),r.set("limit",String(n)),(await Me(`/api/bible/search?${r.toString()}`)).data}function WP(t,e,n,r){const s=!!e&&!!n&&!!r,i=VL({queries:t.map(f=>({queryKey:["bible","verse-by-reference",f.id,e,n,r],queryFn:()=>KP(f.id,e,n,r),enabled:s,staleTime:600*1e3}))}),o=t.map((f,p)=>({translation:f,verse:i[p]?.data??null,isLoading:i[p]?.isLoading??!1,isError:i[p]?.isError??!1})),l=i.some(f=>f.isLoading),d=i.some(f=>f.isError);return{results:o,isLoading:l,isError:d}}const YP=100;function GP({bookName:t,bookCode:e,chapter:n,verses:r,presentedIndex:s,searchedIndex:i,isLoading:o,selectedTranslations:l,onSelectVerse:d,onGoBack:f}){const{t:p}=ke("bible"),g=C.useRef(null),y=C.useRef(null),m=s!==null?r[s]?.verse:void 0,b=l.slice(1),{results:v,isLoading:w}=WP(b,e,n,m),S=s??i,T=r[0]?.id;return C.useEffect(()=>{if(g.current&&y.current){const j=y.current,_=g.current.getBoundingClientRect(),R=j.getBoundingClientRect(),O=_.top-R.top+j.scrollTop,L=Math.max(0,O-YP);j.scrollTo({top:L,behavior:"smooth"})}},[S,T]),o?u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600 dark:text-indigo-400"})}):u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsxs("button",{type:"button",onClick:f,className:"flex items-center gap-1.5 text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 transition-colors",children:[u.jsx(ed,{size:16}),p("navigation.back")]}),u.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t," ",n]})]}),u.jsx("div",{ref:y,className:"flex-1 min-h-0 space-y-1 overflow-y-auto px-0.5 py-0.5",children:r.map((j,M)=>{const _=M===s,R=M===i&&!_,O=_||R,L=()=>_?"bg-green-100 dark:bg-green-900/50 ring-2 ring-green-500":R?"bg-indigo-100 dark:bg-indigo-900/50 ring-2 ring-indigo-500":"hover:bg-gray-100 dark:hover:bg-gray-700",A=()=>_?"text-green-700 dark:text-green-300":R?"text-indigo-700 dark:text-indigo-300":"text-gray-500 dark:text-gray-400",F=()=>_?"text-green-900 dark:text-green-100":R?"text-indigo-900 dark:text-indigo-100":"text-gray-700 dark:text-gray-200";return u.jsxs("div",{children:[u.jsxs("button",{ref:O?g:null,type:"button",onClick:()=>d(M),className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${L()}`,children:[u.jsx("span",{className:`font-semibold mr-2 ${A()}`,children:j.verse}),u.jsx("span",{className:F(),children:j.text})]}),_&&b.length>0&&u.jsx(PP,{results:v,isLoading:w,verseNumber:j.verse})]},j.id)})})]})}function XP({onNextVerse:t,onPreviousVerse:e,onGoBack:n,onHidePresentation:r,onPresentSearched:s,enabled:i=!0}){C.useEffect(()=>{if(!i)return;const o=l=>{if(!(l.target instanceof HTMLInputElement||l.target instanceof HTMLTextAreaElement||l.target instanceof HTMLSelectElement))switch(l.key){case"ArrowDown":case"ArrowRight":l.preventDefault(),t();break;case"ArrowUp":case"ArrowLeft":l.preventDefault(),e();break;case"Backspace":l.preventDefault(),n();break;case"Escape":l.preventDefault(),r();break;case"Enter":s&&(l.preventDefault(),s());break}};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[i,t,e,n,r,s])}const P0={translationId:void 0,bookId:void 0,bookName:void 0,chapter:void 0,presentedIndex:null,searchedIndex:null,searchQuery:"",level:"books"};function JP(t){const[e,n]=C.useState({...P0,translationId:t}),r=C.useCallback(w=>{n(()=>({...P0,translationId:w}))},[]),s=C.useCallback((w,S,T=!0)=>{n(j=>({...j,bookId:w,bookName:S,chapter:void 0,presentedIndex:null,searchedIndex:null,level:"chapters",searchQuery:T?"":j.searchQuery}))},[]),i=C.useCallback(w=>{n(S=>({...S,chapter:w,presentedIndex:null,searchedIndex:null,level:"verses"}))},[]),o=C.useCallback(w=>{n(S=>({...S,presentedIndex:w}))},[]),l=C.useCallback(()=>{n(w=>({...w,presentedIndex:(w.presentedIndex??w.searchedIndex??-1)+1,searchedIndex:null}))},[]),d=C.useCallback(()=>{n(w=>({...w,presentedIndex:Math.max(0,(w.presentedIndex??w.searchedIndex??1)-1),searchedIndex:null}))},[]),f=C.useCallback(()=>{n(w=>({...w,searchedIndex:w.presentedIndex,presentedIndex:null}))},[]),p=C.useCallback(()=>{n(w=>w.level==="verses"?{...w,chapter:void 0,presentedIndex:null,searchedIndex:null,level:"chapters"}:w.level==="chapters"?{...w,bookId:void 0,bookName:void 0,level:"books"}:w)},[]),g=C.useCallback(w=>{n(S=>({...S,searchQuery:w}))},[]),y=C.useCallback(()=>{n(w=>({...w,searchQuery:""}))},[]),m=C.useCallback(()=>{n(w=>({...P0,translationId:w.translationId}))},[]),b=C.useCallback(w=>{n({translationId:w.translationId,bookId:w.bookId,bookName:w.bookName,chapter:w.chapter,presentedIndex:w.verseIndex,searchedIndex:null,searchQuery:"",level:"verses"})},[]),v=C.useCallback(w=>{const S=w.clearSearch===!1;n(T=>({...T,bookId:w.bookId,bookName:w.bookName,chapter:w.chapter,presentedIndex:S?T.presentedIndex:w.verseIndex??null,searchedIndex:S?w.verseIndex??null:null,searchQuery:S?T.searchQuery:"",level:"verses"}))},[]);return{state:e,selectTranslation:r,selectBook:s,selectChapter:i,presentVerse:o,nextVerse:l,previousVerse:d,clearPresentation:f,goBack:p,setSearchQuery:g,clearSearch:y,reset:m,navigateToVerse:b,navigateToChapter:v}}function Fp(t){return lt({queryKey:["bible","books",t],queryFn:()=>UP(t),enabled:!!t,staleTime:600*1e3})}function ZP(t){return lt({queryKey:["bible","chapters",t],queryFn:()=>$P(t),enabled:!!t,staleTime:600*1e3})}const HE="default_bible_translation",VE="selected_bible_translations",KE=3;async function QE(){const t=await uo("app_settings",HE);if(!t)return null;const e=parseInt(t.value,10);return Number.isNaN(e)?null:e}async function e8(t){return await fo("app_settings",{key:HE,value:String(t)})}async function t8(){const t=await uo("app_settings",VE);if(!t){const e=await QE();return e!==null?[e]:[]}try{const e=JSON.parse(t.value);return Array.isArray(e.translationIds)?e.translationIds.filter(n=>typeof n=="number").slice(0,KE):[]}catch{return[]}}async function n8(t){const e=t.slice(0,KE);return await fo("app_settings",{key:VE,value:JSON.stringify({translationIds:e})})}const WE=["bible","translations"];function YE(){return lt({queryKey:WE,queryFn:BP,staleTime:300*1e3})}const pC=["settings","default_bible_translation"];function Qb(){const t=Le(),{data:e=[],isLoading:n}=YE(),{data:r,isLoading:s}=lt({queryKey:pC,queryFn:QE,staleTime:300*1e3}),i=Ie({mutationFn:e8,onSuccess:()=>{t.invalidateQueries({queryKey:pC})}});return{translation:e.find(d=>d.id===r)??e[0]??null,translations:e,defaultTranslationId:r,setDefaultTranslation:i,isLoading:n||s}}function r8(){const t=Le();return Ie({mutationFn:FP,onSuccess:()=>{t.invalidateQueries({queryKey:WE})}})}function s8(t,e,n,r=!0){return lt({queryKey:["bible","search",t,e,n],queryFn:()=>QP(t,e,n),enabled:r&&t.length>=2,staleTime:60*1e3})}const gC=["settings","selected_bible_translations"],yx=3;function Wb(){const t=Le(),{data:e=[],isLoading:n}=YE(),{data:r=[],isLoading:s}=lt({queryKey:gC,queryFn:t8,staleTime:300*1e3}),i=Ie({mutationFn:n8,onSuccess:()=>{t.invalidateQueries({queryKey:gC})}}),o=r.map(b=>e.find(v=>v.id===b)).filter(b=>b!==void 0),l=e.filter(b=>!r.includes(b.id)),d=o[0]??null,f=n||s,p=r.length<yx;return{selectedTranslations:o,selectedIds:r,availableTranslations:l,translations:e,primaryTranslation:d,addTranslation:async b=>{if(!p)return;const v=[...r,b];await i.mutateAsync(v)},removeTranslation:async b=>{const v=r.filter(w=>w!==b);await i.mutateAsync(v)},reorderTranslations:async b=>{await i.mutateAsync(b)},saveTranslations:i,isLoading:f,canAddMore:p,maxTranslations:yx}}function i8(t,e){const n=t.trim();if(!n)return{type:"none"};const r=/^(\d?\s*[a-zA-Z]+)\s*(\d+)?(?:[\s:,](\d+))?$/i,s=n.match(r);if(!s)return{type:"none"};const[,i,o,l]=s,d=i.trim().toLowerCase(),f=a8(d,e);if(!f)return{type:"none"};const p=o?parseInt(o,10):void 0,g=l?parseInt(l,10):void 0;return p!==void 0&&p>f.chapterCount?{type:"none"}:g!==void 0&&p!==void 0?{type:"verse",bookName:f.bookName,chapter:p,verse:g,matchedBook:f}:p!==void 0?{type:"chapter",bookName:f.bookName,chapter:p,matchedBook:f}:{type:"book",bookName:f.bookName,matchedBook:f}}function a8(t,e){const n=Bf(t),r=e.find(o=>Bf(o.bookName)===n);if(r)return r;const s=e.find(o=>Bf(o.bookName).startsWith(n));if(s)return s;const i=e.find(o=>Bf(o.bookCode)===n);if(i)return i}function Bf(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"")}function o8({searchQuery:t,books:e,navigation:n,enabled:r}){const s=C.useRef(null),{selectBook:i,navigateToChapter:o,selectVerse:l}=n,d=C.useMemo(()=>!r||e.length===0||!t.trim()?null:i8(t,e),[t,e,r]);return C.useEffect(()=>{if(!d||d.type==="none"){s.current=null;return}const{matchedBook:f,chapter:p,verse:g,type:y}=d;if(!f)return;const m=`${y}-${f.id}-${p??""}-${g??""}`;if(s.current!==m)switch(s.current=m,y){case"book":i(f.id,f.bookName,!1);break;case"chapter":p!==void 0&&o({bookId:f.id,bookName:f.bookName,chapter:p,clearSearch:!1});break;case"verse":p!==void 0&&g!==void 0&&o({bookId:f.id,bookName:f.bookName,chapter:p,verseIndex:g-1,clearSearch:!1});break}},[d,i,o,l]),{parsedReference:d,isReferenceSearch:d!==null&&d.type!=="none"}}function GE(t,e){return lt({queryKey:["bible","verses",t,e],queryFn:()=>qP(t,e),enabled:!!t&&!!e,staleTime:600*1e3})}function l8(t){return lt({queryKey:["bible","verse",t],queryFn:()=>HP(t),enabled:!!t,staleTime:600*1e3})}function c8({navigation:t,onSelectVerse:e,onSelectSearchResult:n,onPresentSearched:r}){const{t:s}=ke("bible"),i=C.useRef(null),{state:o,selectBook:l,selectChapter:d,goBack:f,setSearchQuery:p,clearSearch:g}=t;C.useEffect(()=>{i.current?.focus()},[]);const{selectedTranslations:y}=Wb(),{data:m=[],isLoading:b}=Fp(o.translationId),{data:v=[],isLoading:w}=ZP(o.bookId),{data:S=[],isLoading:T}=GE(o.bookId,o.chapter),M=m.find(H=>H.id===o.bookId)?.bookCode||"",{isReferenceSearch:_}=o8({searchQuery:o.searchQuery,books:m,navigation:t,enabled:o.searchQuery.length>=2}),{data:R,isLoading:O}=s8(o.searchQuery,o.translationId,50,!_),L=H=>{const P=S[H];P&&e(P,H)},A=H=>{H.key==="Enter"&&r&&(H.preventDefault(),r())},F=o.searchQuery.length>=2&&!_;return u.jsxs("div",{className:"flex flex-col lg:h-full bg-white dark:bg-gray-800 lg:rounded-lg lg:border lg:border-gray-200 lg:dark:border-gray-700",children:[u.jsx("div",{className:"p-3 space-y-2 border-b border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"relative",children:[u.jsx(Yl,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),u.jsx("input",{ref:i,type:"text",value:o.searchQuery,onChange:H=>p(H.target.value),onKeyDown:A,placeholder:s("search.placeholder"),className:"w-full pl-9 pr-9 py-2 text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white placeholder-gray-400"}),o.searchQuery&&u.jsx("button",{type:"button",onClick:g,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(nt,{size:16})})]})}),u.jsx("div",{className:"lg:flex-1 overflow-hidden lg:overflow-y-auto lg:scrollbar-thin p-3",children:F?u.jsx(u8,{results:R?.results||[],type:R?.type||"text",isLoading:O,onSelectResult:n}):o.level==="books"?u.jsx(LP,{books:m,isLoading:b,onSelectBook:l}):o.level==="chapters"?u.jsx(zP,{bookName:o.bookName||"",chapters:v,isLoading:w,onSelectChapter:d,onGoBack:f}):u.jsx(GP,{bookName:o.bookName||"",bookCode:M,chapter:o.chapter||0,verses:S,presentedIndex:o.presentedIndex,searchedIndex:o.searchedIndex,isLoading:T,selectedTranslations:y,onSelectVerse:L,onGoBack:f})})]})}function u8({results:t,type:e,isLoading:n,onSelectResult:r}){const{t:s}=ke("bible");return n?u.jsx("div",{className:"flex items-center justify-center py-8 text-gray-500 dark:text-gray-400",children:s("search.searching")}):t.length===0?u.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:s("search.noResults")}):u.jsx("div",{className:"space-y-1",children:t.map(i=>{const o=e==="text",l=i,d=i;return u.jsxs("button",{type:"button",onClick:()=>r(l),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[u.jsx("div",{className:"text-xs font-medium text-indigo-600 dark:text-indigo-400 mb-0.5",children:o?l.reference:`${d.bookName} ${d.chapter}:${d.verse}`}),u.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-200 line-clamp-2",dangerouslySetInnerHTML:{__html:o?l.highlightedText:d.text}})]},i.id)})})}async function d8(){return(await Me("/api/queue")).data??[]}async function f8(t){const e=await Me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function h8(t){return(await Me(`/api/queue/${t}`,{method:"DELETE"})).data?.success??!1}async function p8(){return(await Me("/api/queue",{method:"DELETE"})).data?.success??!1}async function g8(t){return(await Me("/api/queue/reorder",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).data?.success??!1}async function m8(t,e){return(await Me(`/api/queue/${t}/expand`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({expanded:e})})).data??null}async function y8(t){const e=await Me("/api/queue/slide",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function x8(t){const e=await Me(`/api/queue/slide/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({slideType:t.slideType,slideContent:t.slideContent})});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function b8(t){const e=await Me("/api/queue/bible-passage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function v8(t){const e=await Me("/api/queue/export-to-schedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t})});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function w8(t){const e=await Me("/api/queue/versete-tineri",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}function S8(){const t=Le();return Ie({mutationFn:e=>f8(e),onSuccess:e=>{e.success&&e.data&&t.setQueryData(["queue"],n=>n?[...n,e.data]:[e.data]),t.invalidateQueries({queryKey:["queue"]})}})}function XE(){const t=Le();return Ie({mutationFn:()=>p8(),onMutate:async()=>{await t.cancelQueries({queryKey:["queue"]});const e=t.getQueryData(["queue"]);return t.setQueryData(["queue"],[]),{previousQueue:e}},onError:(e,n,r)=>{r?.previousQueue&&t.setQueryData(["queue"],r.previousQueue)},onSettled:()=>{t.invalidateQueries({queryKey:["queue"]})}})}function k8(){const t=Le();return Ie({mutationFn:e=>b8(e),onSuccess:e=>{e.success&&t.invalidateQueries({queryKey:["queue"]})}})}function C8(){const t=Le();return Ie({mutationFn:e=>y8(e),onSuccess:e=>{e.success&&t.invalidateQueries({queryKey:["queue"]})}})}function N8(){const t=Le();return Ie({mutationFn:e=>w8(e),onSuccess:e=>{e.success&&t.invalidateQueries({queryKey:["queue"]})}})}function Up(){return lt({queryKey:["queue"],queryFn:d8})}function T8(){const t=Le();return Ie({mutationFn:e=>h8(e),onMutate:async e=>{await t.cancelQueries({queryKey:["queue"]});const n=t.getQueryData(["queue"]);return t.setQueryData(["queue"],r=>r?r.filter(s=>s.id!==e):[]),{previousQueue:n}},onError:(e,n,r)=>{r?.previousQueue&&t.setQueryData(["queue"],r.previousQueue)},onSettled:()=>{t.invalidateQueries({queryKey:["queue"]})}})}function j8(){const t=Le();return Ie({mutationFn:e=>g8(e),onMutate:async e=>{await t.cancelQueries({queryKey:["queue"]});const n=t.getQueryData(["queue"]);return t.setQueryData(["queue"],r=>{if(!r)return[];const s=new Map(r.map(i=>[i.id,i]));return e.itemIds.map(i=>s.get(i)).filter(i=>i!==void 0).map((i,o)=>({...i,sortOrder:o}))}),{previousQueue:n}},onError:(e,n,r)=>{r?.previousQueue&&t.setQueryData(["queue"],r.previousQueue)},onSettled:()=>{t.invalidateQueries({queryKey:["queue"]})}})}function E8(){const t=Le();return Ie({mutationFn:e=>v8(e),onSuccess:e=>{e.success&&t.invalidateQueries({queryKey:["schedules"]})}})}function M8(t){if(!t)return null;let e=t.parentElement;for(;e;){const{overflowY:n}=window.getComputedStyle(e);if(n==="auto"||n==="scroll")return e;e=e.parentElement}return null}function A8(t){const e=M8(t);if(!e)return;const n=t.getBoundingClientRect(),r=e.getBoundingClientRect(),s=n.top-r.top+e.scrollTop,i=n.height,o=s-i,l=e.scrollHeight-e.clientHeight,d=Math.max(0,Math.min(o,l)),f=n.top-r.top;Math.abs(f-i)<5||e.scrollTo({top:d,behavior:"smooth"})}function Yb(t,e){C.useEffect(()=>{e&&t.current&&A8(t.current)},[e,t])}function JE(){const t=Le();return Ie({mutationFn:({id:e,expanded:n})=>m8(e,n),onMutate:async({id:e,expanded:n})=>{await t.cancelQueries({queryKey:["queue"]});const r=t.getQueryData(["queue"]);return t.setQueryData(["queue"],s=>s?s.map(i=>i.id===e?{...i,isExpanded:n}:i):[]),{previousQueue:r}},onError:(e,n,r)=>{r?.previousQueue&&t.setQueryData(["queue"],r.previousQueue)},onSettled:()=>{t.invalidateQueries({queryKey:["queue"]})}})}function R8(){const t=Le();return Ie({mutationFn:e=>x8(e),onSuccess:()=>{t.invalidateQueries({queryKey:["queue"]})}})}const _8=/^(\d?\s*[a-zA-Z]+)\s*(\d+)\s*[:.,]\s*(\d+)(?:\s*[-]\s*(?:(\d+)\s*[:.,]\s*)?(\d+))?$/i;function ZE(t){const{input:e,books:n}=t,r=e.trim();if(!r)return{status:"empty",errorKey:"biblePassage.errors.empty"};const s=r.match(_8);if(!s)return{status:"invalid_format",errorKey:"biblePassage.errors.invalid_format"};const[,i,o,l,d,f]=s,p=i.trim(),g=D8(p,n);if(!g)return{status:"book_not_found",errorKey:"biblePassage.errors.book_not_found"};const y=parseInt(o,10),m=parseInt(l,10);let b,v;if(f?d?(b=parseInt(d,10),v=parseInt(f,10)):(b=y,v=parseInt(f,10)):(b=y,v=m),y<1||y>g.chapterCount)return{status:"invalid_chapter",errorKey:"biblePassage.errors.invalid_chapter"};if(b<1||b>g.chapterCount)return{status:"invalid_chapter",errorKey:"biblePassage.errors.invalid_chapter"};if(b<y||b===y&&v<m)return{status:"end_before_start",errorKey:"biblePassage.errors.end_before_start"};const w=O8(g.bookName,y,m,b,v);return{status:"valid",bookCode:g.bookCode,bookName:g.bookName,startChapter:y,startVerse:m,endChapter:b,endVerse:v,matchedBook:g,formattedReference:w}}function O8(t,e,n,r,s){return e===r?n===s?`${t} ${e}:${n}`:`${t} ${e}:${n}-${s}`:`${t} ${e}:${n} - ${r}:${s}`}function D8(t,e){const n=Ff(t),r=e.find(o=>Ff(o.bookName)===n);if(r)return r;const s=e.find(o=>Ff(o.bookName).startsWith(n));if(s)return s;const i=e.find(o=>Ff(o.bookCode)===n);if(i)return i}function Ff(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"")}function e3({isOpen:t,onClose:e,afterItemId:n,onSaved:r}){const{t:s}=ke("queue"),{showToast:i}=mt(),o=C.useRef(null),l=C.useRef(null),d=k8(),[f,p]=C.useState(""),[g,y]=C.useState(null),{translation:m}=Qb(),{data:b=[]}=Fp(m?.id??0);C.useEffect(()=>{const M=setTimeout(()=>{if(!f.trim()){y(null);return}if(b.length===0)return;const _=ZE({input:f,books:b});y(_)},300);return()=>clearTimeout(M)},[f,b]),C.useEffect(()=>{t?(o.current?.showModal(),setTimeout(()=>l.current?.focus(),100)):o.current?.close()},[t]);const v=()=>{d.isPending||e()},w=M=>{M.target===o.current&&v()},S=async()=>{if(!m||!g||g.status!=="valid")return;(await d.mutateAsync({translationId:m.id,translationAbbreviation:m.abbreviation,bookCode:g.bookCode,bookName:g.bookName,startChapter:g.startChapter,startVerse:g.startVerse,endChapter:g.endChapter,endVerse:g.endVerse,afterItemId:n})).success?(i(s("messages.biblePassageInserted"),"success"),r?.(),e()):i(s("messages.error"),"error")},T=M=>{M.key==="Enter"&&g?.status==="valid"&&S()},j=g?.status==="valid";return u.jsx("dialog",{ref:o,onCancel:v,onClick:w,className:"fixed inset-0 m-auto w-full max-w-lg p-0 rounded-lg bg-white dark:bg-gray-800 backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col max-h-[80vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(wr,{size:20,className:"text-teal-600"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s("biblePassage.title")})]}),u.jsx("button",{type:"button",onClick:v,disabled:d.isPending,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:s("biblePassage.reference")}),u.jsx("input",{ref:l,type:"text",value:f,onChange:M=>p(M.target.value),onKeyDown:T,placeholder:s("biblePassage.referencePlaceholder"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-teal-500 focus:border-teal-500"}),u.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:s("biblePassage.referenceHint")})]}),g&&u.jsx("div",{className:`p-3 rounded-lg border ${j?"bg-teal-50 dark:bg-teal-900/30 border-teal-200 dark:border-teal-800":"bg-red-50 dark:bg-red-900/30 border-red-200 dark:border-red-800"}`,children:j?u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"font-medium text-teal-800 dark:text-teal-200",children:g.formattedReference}),u.jsxs("span",{className:"flex items-center gap-1 text-sm text-teal-600 dark:text-teal-400",children:[u.jsx(wb,{size:16}),s("biblePassage.valid")]})]}):u.jsxs("div",{className:"flex items-center gap-2 text-red-700 dark:text-red-300",children:[u.jsx(vh,{size:16}),u.jsx("span",{children:s(g.errorKey)})]})})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:v,disabled:d.isPending,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg disabled:opacity-50",children:s("actions.cancel")}),u.jsxs("button",{type:"button",onClick:S,disabled:d.isPending||!j,className:"inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 disabled:opacity-50",children:[d.isPending&&u.jsx(Qe,{size:18,className:"animate-spin"}),s("biblePassage.add")]})]})]})})}function I8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return C.useMemo(()=>r=>{e.forEach(s=>s(r))},e)}const $p=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Jl(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function Gb(t){return"nodeType"in t}function lr(t){var e,n;return t?Jl(t)?t:Gb(t)&&(e=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?e:window:window}function Xb(t){const{Document:e}=lr(t);return t instanceof e}function sd(t){return Jl(t)?!1:t instanceof lr(t).HTMLElement}function t3(t){return t instanceof lr(t).SVGElement}function Zl(t){return t?Jl(t)?t.document:Gb(t)?Xb(t)?t:sd(t)||t3(t)?t.ownerDocument:document:document:document}const Ns=$p?C.useLayoutEffect:C.useEffect;function Jb(t){const e=C.useRef(t);return Ns(()=>{e.current=t}),C.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}function L8(){const t=C.useRef(null),e=C.useCallback((r,s)=>{t.current=setInterval(r,s)},[]),n=C.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,n]}function zu(t,e){e===void 0&&(e=[t]);const n=C.useRef(t);return Ns(()=>{n.current!==t&&(n.current=t)},e),n}function id(t,e){const n=C.useRef();return C.useMemo(()=>{const r=t(n.current);return n.current=r,r},[...e])}function Ah(t){const e=Jb(t),n=C.useRef(null),r=C.useCallback(s=>{s!==n.current&&e?.(s,n.current),n.current=s},[]);return[n,r]}function xx(t){const e=C.useRef();return C.useEffect(()=>{e.current=t},[t]),e.current}let B0={};function ad(t,e){return C.useMemo(()=>{if(e)return e;const n=B0[t]==null?0:B0[t]+1;return B0[t]=n,t+"-"+n},[t,e])}function n3(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,o)=>{const l=Object.entries(o);for(const[d,f]of l){const p=i[d];p!=null&&(i[d]=p+t*f)}return i},{...e})}}const _l=n3(1),Pu=n3(-1);function z8(t){return"clientX"in t&&"clientY"in t}function Zb(t){if(!t)return!1;const{KeyboardEvent:e}=lr(t.target);return e&&t instanceof e}function P8(t){if(!t)return!1;const{TouchEvent:e}=lr(t.target);return e&&t instanceof e}function bx(t){if(P8(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:n}=t.touches[0];return{x:e,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:n}=t.changedTouches[0];return{x:e,y:n}}}return z8(t)?{x:t.clientX,y:t.clientY}:null}const cs=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:n}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:n}=t;return"scaleX("+e+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[cs.Translate.toString(t),cs.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:n,easing:r}=t;return e+" "+n+"ms "+r}}}),mC="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function B8(t){return t.matches(mC)?t:t.querySelector(mC)}const F8={display:"none"};function U8(t){let{id:e,value:n}=t;return St.createElement("div",{id:e,style:F8},n)}function $8(t){let{id:e,announcement:n,ariaLiveType:r="assertive"}=t;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return St.createElement("div",{id:e,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function q8(){const[t,e]=C.useState("");return{announce:C.useCallback(r=>{r!=null&&e(r)},[]),announcement:t}}const r3=C.createContext(null);function H8(t){const e=C.useContext(r3);C.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function V8(){const[t]=C.useState(()=>new Set),e=C.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[C.useCallback(r=>{let{type:s,event:i}=r;t.forEach(o=>{var l;return(l=o[s])==null?void 0:l.call(o,i)})},[t]),e]}const K8={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Q8={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was moved over droppable area "+n.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was dropped over droppable area "+n.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function W8(t){let{announcements:e=Q8,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=K8}=t;const{announce:i,announcement:o}=q8(),l=ad("DndLiveRegion"),[d,f]=C.useState(!1);if(C.useEffect(()=>{f(!0)},[]),H8(C.useMemo(()=>({onDragStart(g){let{active:y}=g;i(e.onDragStart({active:y}))},onDragMove(g){let{active:y,over:m}=g;e.onDragMove&&i(e.onDragMove({active:y,over:m}))},onDragOver(g){let{active:y,over:m}=g;i(e.onDragOver({active:y,over:m}))},onDragEnd(g){let{active:y,over:m}=g;i(e.onDragEnd({active:y,over:m}))},onDragCancel(g){let{active:y,over:m}=g;i(e.onDragCancel({active:y,over:m}))}}),[i,e])),!d)return null;const p=St.createElement(St.Fragment,null,St.createElement(U8,{id:r,value:s.draggable}),St.createElement($8,{id:l,announcement:o}));return n?Xi.createPortal(p,n):p}var rn;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(rn||(rn={}));function Rh(){}function sr(t,e){return C.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function ho(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return C.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const us=Object.freeze({x:0,y:0});function s3(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function i3(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return n-r}function Y8(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return r-n}function yC(t){let{left:e,top:n,height:r,width:s}=t;return[{x:e,y:n},{x:e+s,y:n},{x:e,y:n+r},{x:e+s,y:n+r}]}function a3(t,e){if(!t||t.length===0)return null;const[n]=t;return n[e]}function xC(t,e,n){return e===void 0&&(e=t.left),n===void 0&&(n=t.top),{x:e+t.width*.5,y:n+t.height*.5}}const po=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const s=xC(e,e.left,e.top),i=[];for(const o of r){const{id:l}=o,d=n.get(l);if(d){const f=s3(xC(d),s);i.push({id:l,data:{droppableContainer:o,value:f}})}}return i.sort(i3)},G8=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const s=yC(e),i=[];for(const o of r){const{id:l}=o,d=n.get(l);if(d){const f=yC(d),p=s.reduce((y,m,b)=>y+s3(f[b],m),0),g=Number((p/4).toFixed(4));i.push({id:l,data:{droppableContainer:o,value:g}})}}return i.sort(i3)};function X8(t,e){const n=Math.max(e.top,t.top),r=Math.max(e.left,t.left),s=Math.min(e.left+e.width,t.left+t.width),i=Math.min(e.top+e.height,t.top+t.height),o=s-r,l=i-n;if(r<s&&n<i){const d=e.width*e.height,f=t.width*t.height,p=o*l,g=p/(d+f-p);return Number(g.toFixed(4))}return 0}const J8=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const s=[];for(const i of r){const{id:o}=i,l=n.get(o);if(l){const d=X8(l,e);d>0&&s.push({id:o,data:{droppableContainer:i,value:d}})}}return s.sort(Y8)};function Z8(t,e,n){return{...t,scaleX:e&&n?e.width/n.width:1,scaleY:e&&n?e.height/n.height:1}}function o3(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:us}function e7(t){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((o,l)=>({...o,top:o.top+t*l.y,bottom:o.bottom+t*l.y,left:o.left+t*l.x,right:o.right+t*l.x}),{...n})}}const t7=e7(1);function n7(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function r7(t,e,n){const r=n7(e);if(!r)return t;const{scaleX:s,scaleY:i,x:o,y:l}=r,d=t.left-o-(1-s)*parseFloat(n),f=t.top-l-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),p=s?t.width/s:t.width,g=i?t.height/i:t.height;return{width:p,height:g,top:f,right:d+p,bottom:f+g,left:d}}const s7={ignoreTransform:!1};function ec(t,e){e===void 0&&(e=s7);let n=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:f,transformOrigin:p}=lr(t).getComputedStyle(t);f&&(n=r7(n,f,p))}const{top:r,left:s,width:i,height:o,bottom:l,right:d}=n;return{top:r,left:s,width:i,height:o,bottom:l,right:d}}function bC(t){return ec(t,{ignoreTransform:!0})}function i7(t){const e=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:e,bottom:n,width:e,height:n}}function a7(t,e){return e===void 0&&(e=lr(t).getComputedStyle(t)),e.position==="fixed"}function o7(t,e){e===void 0&&(e=lr(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=e[s];return typeof i=="string"?n.test(i):!1})}function qp(t,e){const n=[];function r(s){if(e!=null&&n.length>=e||!s)return n;if(Xb(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!sd(s)||t3(s)||n.includes(s))return n;const i=lr(t).getComputedStyle(s);return s!==t&&o7(s,i)&&n.push(s),a7(s,i)?n:r(s.parentNode)}return t?r(t):n}function l3(t){const[e]=qp(t,1);return e??null}function F0(t){return!$p||!t?null:Jl(t)?t:Gb(t)?Xb(t)||t===Zl(t).scrollingElement?window:sd(t)?t:null:null}function c3(t){return Jl(t)?t.scrollX:t.scrollLeft}function u3(t){return Jl(t)?t.scrollY:t.scrollTop}function vx(t){return{x:c3(t),y:u3(t)}}var cn;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(cn||(cn={}));function d3(t){return!$p||!t?!1:t===document.scrollingElement}function f3(t){const e={x:0,y:0},n=d3(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},s=t.scrollTop<=e.y,i=t.scrollLeft<=e.x,o=t.scrollTop>=r.y,l=t.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:o,isRight:l,maxScroll:r,minScroll:e}}const l7={x:.2,y:.2};function c7(t,e,n,r,s){let{top:i,left:o,right:l,bottom:d}=n;r===void 0&&(r=10),s===void 0&&(s=l7);const{isTop:f,isBottom:p,isLeft:g,isRight:y}=f3(t),m={x:0,y:0},b={x:0,y:0},v={height:e.height*s.y,width:e.width*s.x};return!f&&i<=e.top+v.height?(m.y=cn.Backward,b.y=r*Math.abs((e.top+v.height-i)/v.height)):!p&&d>=e.bottom-v.height&&(m.y=cn.Forward,b.y=r*Math.abs((e.bottom-v.height-d)/v.height)),!y&&l>=e.right-v.width?(m.x=cn.Forward,b.x=r*Math.abs((e.right-v.width-l)/v.width)):!g&&o<=e.left+v.width&&(m.x=cn.Backward,b.x=r*Math.abs((e.left+v.width-o)/v.width)),{direction:m,speed:b}}function u7(t){if(t===document.scrollingElement){const{innerWidth:i,innerHeight:o}=window;return{top:0,left:0,right:i,bottom:o,width:i,height:o}}const{top:e,left:n,right:r,bottom:s}=t.getBoundingClientRect();return{top:e,left:n,right:r,bottom:s,width:t.clientWidth,height:t.clientHeight}}function h3(t){return t.reduce((e,n)=>_l(e,vx(n)),us)}function d7(t){return t.reduce((e,n)=>e+c3(n),0)}function f7(t){return t.reduce((e,n)=>e+u3(n),0)}function h7(t,e){if(e===void 0&&(e=ec),!t)return;const{top:n,left:r,bottom:s,right:i}=e(t);l3(t)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const p7=[["x",["left","right"],d7],["y",["top","bottom"],f7]];class ev{constructor(e,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=qp(n),s=h3(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[i,o,l]of p7)for(const d of o)Object.defineProperty(this,d,{get:()=>{const f=l(r),p=s[i]-f;return this.rect[d]+p},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class mu{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=e}add(e,n,r){var s;(s=this.target)==null||s.addEventListener(e,n,r),this.listeners.push([e,n,r])}}function g7(t){const{EventTarget:e}=lr(t);return t instanceof e?t:Zl(t)}function U0(t,e){const n=Math.abs(t.x),r=Math.abs(t.y);return typeof e=="number"?Math.sqrt(n**2+r**2)>e:"x"in e&&"y"in e?n>e.x&&r>e.y:"x"in e?n>e.x:"y"in e?r>e.y:!1}var Kr;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Kr||(Kr={}));function vC(t){t.preventDefault()}function m7(t){t.stopPropagation()}var st;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(st||(st={}));const p3={start:[st.Space,st.Enter],cancel:[st.Esc],end:[st.Space,st.Enter,st.Tab]},y7=(t,e)=>{let{currentCoordinates:n}=e;switch(t.code){case st.Right:return{...n,x:n.x+25};case st.Left:return{...n,x:n.x-25};case st.Down:return{...n,y:n.y+25};case st.Up:return{...n,y:n.y-25}}};class hi{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:n}}=e;this.props=e,this.listeners=new mu(Zl(n)),this.windowListeners=new mu(lr(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Kr.Resize,this.handleCancel),this.windowListeners.add(Kr.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Kr.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:n}=this.props,r=e.node.current;r&&h7(r),n(us)}handleKeyDown(e){if(Zb(e)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=p3,coordinateGetter:o=y7,scrollBehavior:l="smooth"}=s,{code:d}=e;if(i.end.includes(d)){this.handleEnd(e);return}if(i.cancel.includes(d)){this.handleCancel(e);return}const{collisionRect:f}=r.current,p=f?{x:f.left,y:f.top}:us;this.referenceCoordinates||(this.referenceCoordinates=p);const g=o(e,{active:n,context:r.current,currentCoordinates:p});if(g){const y=Pu(g,p),m={x:0,y:0},{scrollableAncestors:b}=r.current;for(const v of b){const w=e.code,{isTop:S,isRight:T,isLeft:j,isBottom:M,maxScroll:_,minScroll:R}=f3(v),O=u7(v),L={x:Math.min(w===st.Right?O.right-O.width/2:O.right,Math.max(w===st.Right?O.left:O.left+O.width/2,g.x)),y:Math.min(w===st.Down?O.bottom-O.height/2:O.bottom,Math.max(w===st.Down?O.top:O.top+O.height/2,g.y))},A=w===st.Right&&!T||w===st.Left&&!j,F=w===st.Down&&!M||w===st.Up&&!S;if(A&&L.x!==g.x){const H=v.scrollLeft+y.x,P=w===st.Right&&H<=_.x||w===st.Left&&H>=R.x;if(P&&!y.y){v.scrollTo({left:H,behavior:l});return}P?m.x=v.scrollLeft-H:m.x=w===st.Right?v.scrollLeft-_.x:v.scrollLeft-R.x,m.x&&v.scrollBy({left:-m.x,behavior:l});break}else if(F&&L.y!==g.y){const H=v.scrollTop+y.y,P=w===st.Down&&H<=_.y||w===st.Up&&H>=R.y;if(P&&!y.x){v.scrollTo({top:H,behavior:l});return}P?m.y=v.scrollTop-H:m.y=w===st.Down?v.scrollTop-_.y:v.scrollTop-R.y,m.y&&v.scrollBy({top:-m.y,behavior:l});break}}this.handleMove(e,_l(Pu(g,this.referenceCoordinates),m))}}}handleMove(e,n){const{onMove:r}=this.props;e.preventDefault(),r(n)}handleEnd(e){const{onEnd:n}=this.props;e.preventDefault(),this.detach(),n()}handleCancel(e){const{onCancel:n}=this.props;e.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}hi.activators=[{eventName:"onKeyDown",handler:(t,e,n)=>{let{keyboardCodes:r=p3,onActivation:s}=e,{active:i}=n;const{code:o}=t.nativeEvent;if(r.start.includes(o)){const l=i.activatorNode.current;return l&&t.target!==l?!1:(t.preventDefault(),s?.({event:t.nativeEvent}),!0)}return!1}}];function wC(t){return!!(t&&"distance"in t)}function SC(t){return!!(t&&"delay"in t)}class tv{constructor(e,n,r){var s;r===void 0&&(r=g7(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=n;const{event:i}=e,{target:o}=i;this.props=e,this.events=n,this.document=Zl(o),this.documentListeners=new mu(this.document),this.listeners=new mu(r),this.windowListeners=new mu(lr(o)),this.initialCoordinates=(s=bx(i))!=null?s:us,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Kr.Resize,this.handleCancel),this.windowListeners.add(Kr.DragStart,vC),this.windowListeners.add(Kr.VisibilityChange,this.handleCancel),this.windowListeners.add(Kr.ContextMenu,vC),this.documentListeners.add(Kr.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(SC(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(wC(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,n){const{active:r,onPending:s}=this.props;s(r,e,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:e}=this,{onStart:n}=this.props;e&&(this.activated=!0,this.documentListeners.add(Kr.Click,m7,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Kr.SelectionChange,this.removeTextSelection),n(e))}handleMove(e){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:o,options:{activationConstraint:l}}=i;if(!s)return;const d=(n=bx(e))!=null?n:us,f=Pu(s,d);if(!r&&l){if(wC(l)){if(l.tolerance!=null&&U0(f,l.tolerance))return this.handleCancel();if(U0(f,l.distance))return this.handleStart()}if(SC(l)&&U0(f,l.tolerance))return this.handleCancel();this.handlePending(l,f);return}e.cancelable&&e.preventDefault(),o(d)}handleEnd(){const{onAbort:e,onEnd:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleCancel(){const{onAbort:e,onCancel:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleKeydown(e){e.code===st.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const x7={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class pi extends tv{constructor(e){const{event:n}=e,r=Zl(n.target);super(e,x7,r)}}pi.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return!n.isPrimary||n.button!==0?!1:(r?.({event:n}),!0)}}];const b7={move:{name:"mousemove"},end:{name:"mouseup"}};var wx;(function(t){t[t.RightClick=2]="RightClick"})(wx||(wx={}));class v7 extends tv{constructor(e){super(e,b7,Zl(e.event.target))}}v7.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return n.button===wx.RightClick?!1:(r?.({event:n}),!0)}}];const $0={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class w7 extends tv{constructor(e){super(e,$0)}static setup(){return window.addEventListener($0.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener($0.move.name,e)};function e(){}}}w7.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;const{touches:s}=n;return s.length>1?!1:(r?.({event:n}),!0)}}];var yu;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(yu||(yu={}));var _h;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(_h||(_h={}));function S7(t){let{acceleration:e,activator:n=yu.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:o=5,order:l=_h.TreeOrder,pointerCoordinates:d,scrollableAncestors:f,scrollableAncestorRects:p,delta:g,threshold:y}=t;const m=C7({delta:g,disabled:!i}),[b,v]=L8(),w=C.useRef({x:0,y:0}),S=C.useRef({x:0,y:0}),T=C.useMemo(()=>{switch(n){case yu.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case yu.DraggableRect:return s}},[n,s,d]),j=C.useRef(null),M=C.useCallback(()=>{const R=j.current;if(!R)return;const O=w.current.x*S.current.x,L=w.current.y*S.current.y;R.scrollBy(O,L)},[]),_=C.useMemo(()=>l===_h.TreeOrder?[...f].reverse():f,[l,f]);C.useEffect(()=>{if(!i||!f.length||!T){v();return}for(const R of _){if(r?.(R)===!1)continue;const O=f.indexOf(R),L=p[O];if(!L)continue;const{direction:A,speed:F}=c7(R,L,T,e,y);for(const H of["x","y"])m[H][A[H]]||(F[H]=0,A[H]=0);if(F.x>0||F.y>0){v(),j.current=R,b(M,o),w.current=F,S.current=A;return}}w.current={x:0,y:0},S.current={x:0,y:0},v()},[e,M,r,v,i,o,JSON.stringify(T),JSON.stringify(m),b,f,_,p,JSON.stringify(y)])}const k7={x:{[cn.Backward]:!1,[cn.Forward]:!1},y:{[cn.Backward]:!1,[cn.Forward]:!1}};function C7(t){let{delta:e,disabled:n}=t;const r=xx(e);return id(s=>{if(n||!r||!s)return k7;const i={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[cn.Backward]:s.x[cn.Backward]||i.x===-1,[cn.Forward]:s.x[cn.Forward]||i.x===1},y:{[cn.Backward]:s.y[cn.Backward]||i.y===-1,[cn.Forward]:s.y[cn.Forward]||i.y===1}}},[n,e,r])}function N7(t,e){const n=e!=null?t.get(e):void 0,r=n?n.node.current:null;return id(s=>{var i;return e==null?null:(i=r??s)!=null?i:null},[r,e])}function T7(t,e){return C.useMemo(()=>t.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(o=>({eventName:o.eventName,handler:e(o.handler,r)}));return[...n,...i]},[]),[t,e])}var Bu;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Bu||(Bu={}));var Sx;(function(t){t.Optimized="optimized"})(Sx||(Sx={}));const kC=new Map;function j7(t,e){let{dragging:n,dependencies:r,config:s}=e;const[i,o]=C.useState(null),{frequency:l,measure:d,strategy:f}=s,p=C.useRef(t),g=w(),y=zu(g),m=C.useCallback(function(S){S===void 0&&(S=[]),!y.current&&o(T=>T===null?S:T.concat(S.filter(j=>!T.includes(j))))},[y]),b=C.useRef(null),v=id(S=>{if(g&&!n)return kC;if(!S||S===kC||p.current!==t||i!=null){const T=new Map;for(let j of t){if(!j)continue;if(i&&i.length>0&&!i.includes(j.id)&&j.rect.current){T.set(j.id,j.rect.current);continue}const M=j.node.current,_=M?new ev(d(M),M):null;j.rect.current=_,_&&T.set(j.id,_)}return T}return S},[t,i,n,g,d]);return C.useEffect(()=>{p.current=t},[t]),C.useEffect(()=>{g||m()},[n,g]),C.useEffect(()=>{i&&i.length>0&&o(null)},[JSON.stringify(i)]),C.useEffect(()=>{g||typeof l!="number"||b.current!==null||(b.current=setTimeout(()=>{m(),b.current=null},l))},[l,g,m,...r]),{droppableRects:v,measureDroppableContainers:m,measuringScheduled:i!=null};function w(){switch(f){case Bu.Always:return!1;case Bu.BeforeDragging:return n;default:return!n}}}function g3(t,e){return id(n=>t?n||(typeof e=="function"?e(t):t):null,[e,t])}function E7(t,e){return g3(t,e)}function M7(t){let{callback:e,disabled:n}=t;const r=Jb(e),s=C.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return C.useEffect(()=>()=>s?.disconnect(),[s]),s}function Hp(t){let{callback:e,disabled:n}=t;const r=Jb(e),s=C.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return C.useEffect(()=>()=>s?.disconnect(),[s]),s}function A7(t){return new ev(ec(t),t)}function CC(t,e,n){e===void 0&&(e=A7);const[r,s]=C.useState(null);function i(){s(d=>{if(!t)return null;if(t.isConnected===!1){var f;return(f=d??n)!=null?f:null}const p=e(t);return JSON.stringify(d)===JSON.stringify(p)?d:p})}const o=M7({callback(d){if(t)for(const f of d){const{type:p,target:g}=f;if(p==="childList"&&g instanceof HTMLElement&&g.contains(t)){i();break}}}}),l=Hp({callback:i});return Ns(()=>{i(),t?(l?.observe(t),o?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),o?.disconnect())},[t]),r}function R7(t){const e=g3(t);return o3(t,e)}const NC=[];function _7(t){const e=C.useRef(t),n=id(r=>t?r&&r!==NC&&t&&e.current&&t.parentNode===e.current.parentNode?r:qp(t):NC,[t]);return C.useEffect(()=>{e.current=t},[t]),n}function O7(t){const[e,n]=C.useState(null),r=C.useRef(t),s=C.useCallback(i=>{const o=F0(i.target);o&&n(l=>l?(l.set(o,vx(o)),new Map(l)):null)},[]);return C.useEffect(()=>{const i=r.current;if(t!==i){o(i);const l=t.map(d=>{const f=F0(d);return f?(f.addEventListener("scroll",s,{passive:!0}),[f,vx(f)]):null}).filter(d=>d!=null);n(l.length?new Map(l):null),r.current=t}return()=>{o(t),o(i)};function o(l){l.forEach(d=>{const f=F0(d);f?.removeEventListener("scroll",s)})}},[s,t]),C.useMemo(()=>t.length?e?Array.from(e.values()).reduce((i,o)=>_l(i,o),us):h3(t):us,[t,e])}function TC(t,e){e===void 0&&(e=[]);const n=C.useRef(null);return C.useEffect(()=>{n.current=null},e),C.useEffect(()=>{const r=t!==us;r&&!n.current&&(n.current=t),!r&&n.current&&(n.current=null)},[t]),n.current?Pu(t,n.current):us}function D7(t){C.useEffect(()=>{if(!$p)return;const e=t.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of e)n?.()}},t.map(e=>{let{sensor:n}=e;return n}))}function I7(t,e){return C.useMemo(()=>t.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=o=>{i(o,e)},n},{}),[t,e])}function m3(t){return C.useMemo(()=>t?i7(t):null,[t])}const jC=[];function L7(t,e){e===void 0&&(e=ec);const[n]=t,r=m3(n?lr(n):null),[s,i]=C.useState(jC);function o(){i(()=>t.length?t.map(d=>d3(d)?r:new ev(e(d),d)):jC)}const l=Hp({callback:o});return Ns(()=>{l?.disconnect(),o(),t.forEach(d=>l?.observe(d))},[t]),s}function z7(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return sd(e)?e:t}function P7(t){let{measure:e}=t;const[n,r]=C.useState(null),s=C.useCallback(f=>{for(const{target:p}of f)if(sd(p)){r(g=>{const y=e(p);return g?{...g,width:y.width,height:y.height}:y});break}},[e]),i=Hp({callback:s}),o=C.useCallback(f=>{const p=z7(f);i?.disconnect(),p&&i?.observe(p),r(p?e(p):null)},[e,i]),[l,d]=Ah(o);return C.useMemo(()=>({nodeRef:l,rect:n,setRef:d}),[n,l,d])}const B7=[{sensor:pi,options:{}},{sensor:hi,options:{}}],F7={current:{}},ah={draggable:{measure:bC},droppable:{measure:bC,strategy:Bu.WhileDragging,frequency:Sx.Optimized},dragOverlay:{measure:ec}};class xu extends Map{get(e){var n;return e!=null&&(n=super.get(e))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:n}=e;return!n})}getNodeFor(e){var n,r;return(n=(r=this.get(e))==null?void 0:r.node.current)!=null?n:void 0}}const U7={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new xu,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Rh},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:ah,measureDroppableContainers:Rh,windowRect:null,measuringScheduled:!1},$7={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Rh,draggableNodes:new Map,over:null,measureDroppableContainers:Rh},Vp=C.createContext($7),y3=C.createContext(U7);function q7(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new xu}}}function H7(t,e){switch(e.type){case rn.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case rn.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case rn.DragEnd:case rn.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case rn.RegisterDroppable:{const{element:n}=e,{id:r}=n,s=new xu(t.droppable.containers);return s.set(r,n),{...t,droppable:{...t.droppable,containers:s}}}case rn.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=e,i=t.droppable.containers.get(n);if(!i||r!==i.key)return t;const o=new xu(t.droppable.containers);return o.set(n,{...i,disabled:s}),{...t,droppable:{...t.droppable,containers:o}}}case rn.UnregisterDroppable:{const{id:n,key:r}=e,s=t.droppable.containers.get(n);if(!s||r!==s.key)return t;const i=new xu(t.droppable.containers);return i.delete(n),{...t,droppable:{...t.droppable,containers:i}}}default:return t}}function V7(t){let{disabled:e}=t;const{active:n,activatorEvent:r,draggableNodes:s}=C.useContext(Vp),i=xx(r),o=xx(n?.id);return C.useEffect(()=>{if(!e&&!r&&i&&o!=null){if(!Zb(i)||document.activeElement===i.target)return;const l=s.get(o);if(!l)return;const{activatorNode:d,node:f}=l;if(!d.current&&!f.current)return;requestAnimationFrame(()=>{for(const p of[d.current,f.current]){if(!p)continue;const g=B8(p);if(g){g.focus();break}}})}},[r,e,s,o,i]),null}function K7(t,e){let{transform:n,...r}=e;return t!=null&&t.length?t.reduce((s,i)=>i({transform:s,...r}),n):n}function Q7(t){return C.useMemo(()=>({draggable:{...ah.draggable,...t?.draggable},droppable:{...ah.droppable,...t?.droppable},dragOverlay:{...ah.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function W7(t){let{activeNode:e,measure:n,initialRect:r,config:s=!0}=t;const i=C.useRef(!1),{x:o,y:l}=typeof s=="boolean"?{x:s,y:s}:s;Ns(()=>{if(!o&&!l||!e){i.current=!1;return}if(i.current||!r)return;const f=e?.node.current;if(!f||f.isConnected===!1)return;const p=n(f),g=o3(p,r);if(o||(g.x=0),l||(g.y=0),i.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const y=l3(f);y&&y.scrollBy({top:g.y,left:g.x})}},[e,o,l,r,n])}const x3=C.createContext({...us,scaleX:1,scaleY:1});var Hi;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Hi||(Hi={}));const go=C.memo(function(e){var n,r,s,i;let{id:o,accessibility:l,autoScroll:d=!0,children:f,sensors:p=B7,collisionDetection:g=J8,measuring:y,modifiers:m,...b}=e;const v=C.useReducer(H7,void 0,q7),[w,S]=v,[T,j]=V8(),[M,_]=C.useState(Hi.Uninitialized),R=M===Hi.Initialized,{draggable:{active:O,nodes:L,translate:A},droppable:{containers:F}}=w,H=O!=null?L.get(O):null,P=C.useRef({initial:null,translated:null}),B=C.useMemo(()=>{var vt;return O!=null?{id:O,data:(vt=H?.data)!=null?vt:F7,rect:P}:null},[O,H]),E=C.useRef(null),[K,q]=C.useState(null),[V,ie]=C.useState(null),Y=zu(b,Object.values(b)),X=ad("DndDescribedBy",o),I=C.useMemo(()=>F.getEnabled(),[F]),U=Q7(y),{droppableRects:te,measureDroppableContainers:Z,measuringScheduled:re}=j7(I,{dragging:R,dependencies:[A.x,A.y],config:U.droppable}),se=N7(L,O),ge=C.useMemo(()=>V?bx(V):null,[V]),be=Rs(),me=E7(se,U.draggable.measure);W7({activeNode:O!=null?L.get(O):null,config:be.layoutShiftCompensation,initialRect:me,measure:U.draggable.measure});const Se=CC(se,U.draggable.measure,me),Oe=CC(se?se.parentElement:null),He=C.useRef({activatorEvent:null,active:null,activeNode:se,collisionRect:null,collisions:null,droppableRects:te,draggableNodes:L,draggingNode:null,draggingNodeRect:null,droppableContainers:F,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ut=F.getNodeFor((n=He.current.over)==null?void 0:n.id),z=P7({measure:U.dragOverlay.measure}),fe=(r=z.nodeRef.current)!=null?r:se,ue=R?(s=z.rect)!=null?s:Se:null,W=!!(z.nodeRef.current&&z.rect),Q=R7(W?null:Se),ee=m3(fe?lr(fe):null),pe=_7(R?ut??se:null),we=L7(pe),ae=K7(m,{transform:{x:A.x-Q.x,y:A.y-Q.y,scaleX:1,scaleY:1},activatorEvent:V,active:B,activeNodeRect:Se,containerNodeRect:Oe,draggingNodeRect:ue,over:He.current.over,overlayNodeRect:z.rect,scrollableAncestors:pe,scrollableAncestorRects:we,windowRect:ee}),xe=ge?_l(ge,A):null,Ce=O7(pe),Te=TC(Ce),De=TC(Ce,[Se]),Ze=_l(ae,Te),Ue=ue?t7(ue,ae):null,$t=B&&Ue?g({active:B,collisionRect:Ue,droppableRects:te,droppableContainers:I,pointerCoordinates:xe}):null,Jr=a3($t,"id"),[Bt,fs]=C.useState(null),dt=W?ae:_l(ae,De),qt=Z8(dt,(i=Bt?.rect)!=null?i:null,Se),Cn=C.useRef(null),Nt=C.useCallback((vt,Tt)=>{let{sensor:an,options:Vn}=Tt;if(E.current==null)return;const Kn=L.get(E.current);if(!Kn)return;const Nn=vt.nativeEvent,Qn=new an({active:E.current,activeNode:Kn,event:Nn,options:Vn,context:He,onAbort(en){if(!L.get(en))return;const{onDragAbort:cr}=Y.current,Nr={id:en};cr?.(Nr),T({type:"onDragAbort",event:Nr})},onPending(en,Zr,cr,Nr){if(!L.get(en))return;const{onDragPending:Os}=Y.current,es={id:en,constraint:Zr,initialCoordinates:cr,offset:Nr};Os?.(es),T({type:"onDragPending",event:es})},onStart(en){const Zr=E.current;if(Zr==null)return;const cr=L.get(Zr);if(!cr)return;const{onDragStart:Nr}=Y.current,_s={activatorEvent:Nn,active:{id:Zr,data:cr.data,rect:P}};Xi.unstable_batchedUpdates(()=>{Nr?.(_s),_(Hi.Initializing),S({type:rn.DragStart,initialCoordinates:en,active:Zr}),T({type:"onDragStart",event:_s}),q(Cn.current),ie(Nn)})},onMove(en){S({type:rn.DragMove,coordinates:en})},onEnd:Cr(rn.DragEnd),onCancel:Cr(rn.DragCancel)});Cn.current=Qn;function Cr(en){return async function(){const{active:cr,collisions:Nr,over:_s,scrollAdjustedTranslate:Os}=He.current;let es=null;if(cr&&Os){const{cancelDrop:yi}=Y.current;es={activatorEvent:Nn,active:cr,collisions:Nr,delta:Os,over:_s},en===rn.DragEnd&&typeof yi=="function"&&await Promise.resolve(yi(es))&&(en=rn.DragCancel)}E.current=null,Xi.unstable_batchedUpdates(()=>{S({type:en}),_(Hi.Uninitialized),fs(null),q(null),ie(null),Cn.current=null;const yi=en===rn.DragEnd?"onDragEnd":"onDragCancel";if(es){const Tr=Y.current[yi];Tr?.(es),T({type:yi,event:es})}})}}},[L]),Co=C.useCallback((vt,Tt)=>(an,Vn)=>{const Kn=an.nativeEvent,Nn=L.get(Vn);if(E.current!==null||!Nn||Kn.dndKit||Kn.defaultPrevented)return;const Qn={active:Nn};vt(an,Tt.options,Qn)===!0&&(Kn.dndKit={capturedBy:Tt.sensor},E.current=Vn,Nt(an,Tt))},[L,Nt]),No=T7(p,Co);D7(p),Ns(()=>{Se&&M===Hi.Initializing&&_(Hi.Initialized)},[Se,M]),C.useEffect(()=>{const{onDragMove:vt}=Y.current,{active:Tt,activatorEvent:an,collisions:Vn,over:Kn}=He.current;if(!Tt||!an)return;const Nn={active:Tt,activatorEvent:an,collisions:Vn,delta:{x:Ze.x,y:Ze.y},over:Kn};Xi.unstable_batchedUpdates(()=>{vt?.(Nn),T({type:"onDragMove",event:Nn})})},[Ze.x,Ze.y]),C.useEffect(()=>{const{active:vt,activatorEvent:Tt,collisions:an,droppableContainers:Vn,scrollAdjustedTranslate:Kn}=He.current;if(!vt||E.current==null||!Tt||!Kn)return;const{onDragOver:Nn}=Y.current,Qn=Vn.get(Jr),Cr=Qn&&Qn.rect.current?{id:Qn.id,rect:Qn.rect.current,data:Qn.data,disabled:Qn.disabled}:null,en={active:vt,activatorEvent:Tt,collisions:an,delta:{x:Kn.x,y:Kn.y},over:Cr};Xi.unstable_batchedUpdates(()=>{fs(Cr),Nn?.(en),T({type:"onDragOver",event:en})})},[Jr]),Ns(()=>{He.current={activatorEvent:V,active:B,activeNode:se,collisionRect:Ue,collisions:$t,droppableRects:te,draggableNodes:L,draggingNode:fe,draggingNodeRect:ue,droppableContainers:F,over:Bt,scrollableAncestors:pe,scrollAdjustedTranslate:Ze},P.current={initial:ue,translated:Ue}},[B,se,$t,Ue,L,fe,ue,te,F,Bt,pe,Ze]),S7({...be,delta:A,draggingRect:Ue,pointerCoordinates:xe,scrollableAncestors:pe,scrollableAncestorRects:we});const sc=C.useMemo(()=>({active:B,activeNode:se,activeNodeRect:Se,activatorEvent:V,collisions:$t,containerNodeRect:Oe,dragOverlay:z,draggableNodes:L,droppableContainers:F,droppableRects:te,over:Bt,measureDroppableContainers:Z,scrollableAncestors:pe,scrollableAncestorRects:we,measuringConfiguration:U,measuringScheduled:re,windowRect:ee}),[B,se,Se,V,$t,Oe,z,L,F,te,Bt,Z,pe,we,U,re,ee]),mi=C.useMemo(()=>({activatorEvent:V,activators:No,active:B,activeNodeRect:Se,ariaDescribedById:{draggable:X},dispatch:S,draggableNodes:L,over:Bt,measureDroppableContainers:Z}),[V,No,B,Se,S,X,L,Bt,Z]);return St.createElement(r3.Provider,{value:j},St.createElement(Vp.Provider,{value:mi},St.createElement(y3.Provider,{value:sc},St.createElement(x3.Provider,{value:qt},f)),St.createElement(V7,{disabled:l?.restoreFocus===!1})),St.createElement(W8,{...l,hiddenTextDescribedById:X}));function Rs(){const vt=K?.autoScrollEnabled===!1,Tt=typeof d=="object"?d.enabled===!1:d===!1,an=R&&!vt&&!Tt;return typeof d=="object"?{...d,enabled:an}:{enabled:an}}}),Y7=C.createContext(null),EC="button",G7="Draggable";function X7(t){let{id:e,data:n,disabled:r=!1,attributes:s}=t;const i=ad(G7),{activators:o,activatorEvent:l,active:d,activeNodeRect:f,ariaDescribedById:p,draggableNodes:g,over:y}=C.useContext(Vp),{role:m=EC,roleDescription:b="draggable",tabIndex:v=0}=s??{},w=d?.id===e,S=C.useContext(w?x3:Y7),[T,j]=Ah(),[M,_]=Ah(),R=I7(o,e),O=zu(n);Ns(()=>(g.set(e,{id:e,key:i,node:T,activatorNode:M,data:O}),()=>{const A=g.get(e);A&&A.key===i&&g.delete(e)}),[g,e]);const L=C.useMemo(()=>({role:m,tabIndex:v,"aria-disabled":r,"aria-pressed":w&&m===EC?!0:void 0,"aria-roledescription":b,"aria-describedby":p.draggable}),[r,m,v,w,b,p.draggable]);return{active:d,activatorEvent:l,activeNodeRect:f,attributes:L,isDragging:w,listeners:r?void 0:R,node:T,over:y,setNodeRef:j,setActivatorNodeRef:_,transform:S}}function J7(){return C.useContext(y3)}const Z7="Droppable",eB={timeout:25};function tB(t){let{data:e,disabled:n=!1,id:r,resizeObserverConfig:s}=t;const i=ad(Z7),{active:o,dispatch:l,over:d,measureDroppableContainers:f}=C.useContext(Vp),p=C.useRef({disabled:n}),g=C.useRef(!1),y=C.useRef(null),m=C.useRef(null),{disabled:b,updateMeasurementsFor:v,timeout:w}={...eB,...s},S=zu(v??r),T=C.useCallback(()=>{if(!g.current){g.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{f(Array.isArray(S.current)?S.current:[S.current]),m.current=null},w)},[w]),j=Hp({callback:T,disabled:b||!o}),M=C.useCallback((L,A)=>{j&&(A&&(j.unobserve(A),g.current=!1),L&&j.observe(L))},[j]),[_,R]=Ah(M),O=zu(e);return C.useEffect(()=>{!j||!_.current||(j.disconnect(),g.current=!1,j.observe(_.current))},[_,j]),C.useEffect(()=>(l({type:rn.RegisterDroppable,element:{id:r,key:i,disabled:n,node:_,rect:y,data:O}}),()=>l({type:rn.UnregisterDroppable,key:i,id:r})),[r]),C.useEffect(()=>{n!==p.current.disabled&&(l({type:rn.SetDroppableDisabled,id:r,key:i,disabled:n}),p.current.disabled=n)},[r,i,n,l]),{active:o,rect:y,isOver:d?.id===r,node:_,over:d,setNodeRef:R}}function tc(t,e,n){const r=t.slice();return r.splice(n<0?r.length+n:n,0,r.splice(e,1)[0]),r}function nB(t,e){return t.reduce((n,r,s)=>{const i=e.get(r);return i&&(n[s]=i),n},Array(t.length))}function Uf(t){return t!==null&&t>=0}function rB(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function sB(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const b3=t=>{let{rects:e,activeIndex:n,overIndex:r,index:s}=t;const i=tc(e,r,n),o=e[s],l=i[s];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},$f={scaleX:1,scaleY:1},mo=t=>{var e;let{activeIndex:n,activeNodeRect:r,index:s,rects:i,overIndex:o}=t;const l=(e=i[n])!=null?e:r;if(!l)return null;if(s===n){const f=i[o];return f?{x:0,y:n<o?f.top+f.height-(l.top+l.height):f.top-l.top,...$f}:null}const d=iB(i,s,n);return s>n&&s<=o?{x:0,y:-l.height-d,...$f}:s<n&&s>=o?{x:0,y:l.height+d,...$f}:{x:0,y:0,...$f}};function iB(t,e,n){const r=t[e],s=t[e-1],i=t[e+1];return r?n<e?s?r.top-(s.top+s.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const v3="Sortable",w3=St.createContext({activeIndex:-1,containerId:v3,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:b3,disabled:{draggable:!1,droppable:!1}});function yo(t){let{children:e,id:n,items:r,strategy:s=b3,disabled:i=!1}=t;const{active:o,dragOverlay:l,droppableRects:d,over:f,measureDroppableContainers:p}=J7(),g=ad(v3,n),y=l.rect!==null,m=C.useMemo(()=>r.map(R=>typeof R=="object"&&"id"in R?R.id:R),[r]),b=o!=null,v=o?m.indexOf(o.id):-1,w=f?m.indexOf(f.id):-1,S=C.useRef(m),T=!rB(m,S.current),j=w!==-1&&v===-1||T,M=sB(i);Ns(()=>{T&&b&&p(m)},[T,m,b,p]),C.useEffect(()=>{S.current=m},[m]);const _=C.useMemo(()=>({activeIndex:v,containerId:g,disabled:M,disableTransforms:j,items:m,overIndex:w,useDragOverlay:y,sortedRects:nB(m,d),strategy:s}),[v,g,M.draggable,M.droppable,j,m,w,d,y,s]);return St.createElement(w3.Provider,{value:_},e)}const aB=t=>{let{id:e,items:n,activeIndex:r,overIndex:s}=t;return tc(n,r,s).indexOf(e)},oB=t=>{let{containerId:e,isSorting:n,wasDragging:r,index:s,items:i,newIndex:o,previousItems:l,previousContainerId:d,transition:f}=t;return!f||!r||l!==i&&s===o?!1:n?!0:o!==s&&e===d},lB={duration:200,easing:"ease"},S3="transform",cB=cs.Transition.toString({property:S3,duration:0,easing:"linear"}),uB={roleDescription:"sortable"};function dB(t){let{disabled:e,index:n,node:r,rect:s}=t;const[i,o]=C.useState(null),l=C.useRef(n);return Ns(()=>{if(!e&&n!==l.current&&r.current){const d=s.current;if(d){const f=ec(r.current,{ignoreTransform:!0}),p={x:d.left-f.left,y:d.top-f.top,scaleX:d.width/f.width,scaleY:d.height/f.height};(p.x||p.y)&&o(p)}}n!==l.current&&(l.current=n)},[e,n,r,s]),C.useEffect(()=>{i&&o(null)},[i]),i}function xo(t){let{animateLayoutChanges:e=oB,attributes:n,disabled:r,data:s,getNewIndex:i=aB,id:o,strategy:l,resizeObserverConfig:d,transition:f=lB}=t;const{items:p,containerId:g,activeIndex:y,disabled:m,disableTransforms:b,sortedRects:v,overIndex:w,useDragOverlay:S,strategy:T}=C.useContext(w3),j=fB(r,m),M=p.indexOf(o),_=C.useMemo(()=>({sortable:{containerId:g,index:M,items:p},...s}),[g,s,M,p]),R=C.useMemo(()=>p.slice(p.indexOf(o)),[p,o]),{rect:O,node:L,isOver:A,setNodeRef:F}=tB({id:o,data:_,disabled:j.droppable,resizeObserverConfig:{updateMeasurementsFor:R,...d}}),{active:H,activatorEvent:P,activeNodeRect:B,attributes:E,setNodeRef:K,listeners:q,isDragging:V,over:ie,setActivatorNodeRef:Y,transform:X}=X7({id:o,data:_,attributes:{...uB,...n},disabled:j.draggable}),I=I8(F,K),U=!!H,te=U&&!b&&Uf(y)&&Uf(w),Z=!S&&V,re=Z&&te?X:null,ge=te?re??(l??T)({rects:v,activeNodeRect:B,activeIndex:y,overIndex:w,index:M}):null,be=Uf(y)&&Uf(w)?i({id:o,items:p,activeIndex:y,overIndex:w}):M,me=H?.id,Se=C.useRef({activeId:me,items:p,newIndex:be,containerId:g}),Oe=p!==Se.current.items,He=e({active:H,containerId:g,isDragging:V,isSorting:U,id:o,index:M,items:p,newIndex:Se.current.newIndex,previousItems:Se.current.items,previousContainerId:Se.current.containerId,transition:f,wasDragging:Se.current.activeId!=null}),ut=dB({disabled:!He,index:M,node:L,rect:O});return C.useEffect(()=>{U&&Se.current.newIndex!==be&&(Se.current.newIndex=be),g!==Se.current.containerId&&(Se.current.containerId=g),p!==Se.current.items&&(Se.current.items=p)},[U,be,g,p]),C.useEffect(()=>{if(me===Se.current.activeId)return;if(me!=null&&Se.current.activeId==null){Se.current.activeId=me;return}const fe=setTimeout(()=>{Se.current.activeId=me},50);return()=>clearTimeout(fe)},[me]),{active:H,activeIndex:y,attributes:E,data:_,rect:O,index:M,newIndex:be,items:p,isOver:A,isSorting:U,isDragging:V,listeners:q,node:L,overIndex:w,over:ie,setNodeRef:I,setActivatorNodeRef:Y,setDroppableNodeRef:F,setDraggableNodeRef:K,transform:ut??ge,transition:z()};function z(){if(ut||Oe&&Se.current.newIndex===M)return cB;if(!(Z&&!Zb(P)||!f)&&(U||He))return cs.Transition.toString({...f,property:S3})}}function fB(t,e){var n,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(n=t?.draggable)!=null?n:e.draggable,droppable:(r=t?.droppable)!=null?r:e.droppable}}function Oh(t){if(!t)return!1;const e=t.data.current;return!!(e&&"sortable"in e&&typeof e.sortable=="object"&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const hB=[st.Down,st.Right,st.Up,st.Left],bo=(t,e)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:i,over:o,scrollableAncestors:l}}=e;if(hB.includes(t.code)){if(t.preventDefault(),!n||!r)return;const d=[];i.getEnabled().forEach(g=>{if(!g||g!=null&&g.disabled)return;const y=s.get(g.id);if(y)switch(t.code){case st.Down:r.top<y.top&&d.push(g);break;case st.Up:r.top>y.top&&d.push(g);break;case st.Left:r.left>y.left&&d.push(g);break;case st.Right:r.left<y.left&&d.push(g);break}});const f=G8({collisionRect:r,droppableRects:s,droppableContainers:d});let p=a3(f,"id");if(p===o?.id&&f.length>1&&(p=f[1].id),p!=null){const g=i.get(n.id),y=i.get(p),m=y?s.get(y.id):null,b=y?.node.current;if(b&&m&&g&&y){const w=qp(b).some((R,O)=>l[O]!==R),S=k3(g,y),T=pB(g,y),j=w||!S?{x:0,y:0}:{x:T?r.width-m.width:0,y:T?r.height-m.height:0},M={x:m.left,y:m.top};return j.x&&j.y?M:Pu(M,j)}}}};function k3(t,e){return!Oh(t)||!Oh(e)?!1:t.data.current.sortable.containerId===e.data.current.sortable.containerId}function pB(t,e){return!Oh(t)||!Oh(e)||!k3(t,e)?!1:t.data.current.sortable.index<e.data.current.sortable.index}function gB({translation:t,index:e,onRemove:n}){const{t:r}=ke("settings"),{attributes:s,listeners:i,setNodeRef:o,transform:l,transition:d,isDragging:f}=xo({id:t.id}),p={transform:cs.Transform.toString(l),transition:d,opacity:f?.5:1},g=y=>{switch(y){case 0:return r("sections.bible.primary");case 1:return r("sections.bible.secondary");case 2:return r("sections.bible.tertiary");default:return""}};return u.jsxs("div",{ref:o,style:p,className:`
        flex items-center gap-3 p-3 bg-white dark:bg-gray-800
        border border-gray-200 dark:border-gray-700 rounded-lg
        ${f?"shadow-lg ring-2 ring-indigo-500":""}
      `,children:[u.jsx("button",{type:"button",className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 cursor-grab active:cursor-grabbing",...s,...i,children:u.jsx(or,{size:20})}),u.jsx("div",{className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-md bg-indigo-100 dark:bg-indigo-900/50 text-indigo-600 dark:text-indigo-400",children:u.jsx(wr,{size:18})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.name}),u.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400",children:t.abbreviation})]}),u.jsx("span",{className:"text-xs text-indigo-600 dark:text-indigo-400",children:g(e)})]}),u.jsx("button",{type:"button",onClick:n,className:"p-2 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:r("common:buttons.remove",{defaultValue:"Remove"}),children:u.jsx(nt,{size:18})})]})}function mB(){const{t}=ke("settings"),{showToast:e}=mt(),{selectedTranslations:n,selectedIds:r,availableTranslations:s,addTranslation:i,removeTranslation:o,reorderTranslations:l,isLoading:d,canAddMore:f}=Wb(),[p,g]=C.useState(!1),y=ho(sr(pi),sr(hi,{coordinateGetter:bo})),m=async w=>{const{active:S,over:T}=w;if(!T||S.id===T.id)return;const j=r.findIndex(R=>R===S.id),M=r.findIndex(R=>R===T.id);if(j===-1||M===-1)return;const _=tc(r,j,M);try{await l(_),e(t("sections.bible.toast.saved"),"success")}catch{e(t("sections.bible.toast.error"),"error")}},b=async w=>{try{await i(w),e(t("sections.bible.toast.added"),"success")}catch{e(t("sections.bible.toast.error"),"error")}},v=async w=>{try{await o(w),e(t("sections.bible.toast.removed"),"success")}catch{e(t("sections.bible.toast.error"),"error")}};return d?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"})}):u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[u.jsx(wr,{className:"w-5 h-5"}),t("sections.bible.title")]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t("sections.bible.description")})]}),u.jsxs("button",{type:"button",onClick:()=>g(!0),disabled:!f,className:"flex items-center gap-2 px-3 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-sm font-medium rounded-lg transition-colors",title:f?void 0:t("sections.bible.maxReached"),children:[u.jsx(Xt,{size:16}),t("sections.bible.addTranslation")]})]}),n.length===0?u.jsxs("div",{className:"text-center py-8 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-dashed border-gray-300 dark:border-gray-600",children:[u.jsx(wr,{className:"w-12 h-12 mx-auto text-gray-400 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:t("sections.bible.noTranslations")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:t("sections.bible.noTranslationsDescription")})]}):u.jsx(go,{sensors:y,collisionDetection:po,onDragEnd:m,children:u.jsx(yo,{items:r,strategy:mo,children:u.jsx("div",{className:"space-y-2",children:n.map((w,S)=>u.jsx(gB,{translation:w,index:S,onRemove:()=>v(w.id)},w.id))})})}),n.length>0&&u.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-3",children:[n.length," / ",yx," ",t("sections.bible.translationsSelected",{defaultValue:"translations selected"})]}),u.jsx(DP,{isOpen:p,availableTranslations:s,onSubmit:b,onClose:()=>g(!1)})]})}function yB({isOpen:t,onClose:e}){const{t:n}=ke("bible"),r=C.useRef(null),s=C.useRef(null),[i,o]=C.useState(null),{mutateAsync:l,isPending:d}=r8();C.useEffect(()=>{t?r.current?.showModal():r.current?.close()},[t]),C.useEffect(()=>{const y=r.current;if(!y)return;const m=b=>{b.preventDefault(),e()};return y.addEventListener("cancel",m),()=>y.removeEventListener("cancel",m)},[e]);const f=y=>{y.target===r.current&&e()},p=()=>{s.current?.click()},g=async y=>{const m=y.target.files?.[0];if(m){try{const b=await m.text(),v=m.name.replace(/\.xml$/i,"").replace(/-/g," ");await l({xmlContent:b,name:v,abbreviation:v.substring(0,10).toUpperCase(),language:"ro"})}catch(b){o(b instanceof Error?b.message:n("import.error"))}s.current&&(s.current.value="")}};return u.jsxs(u.Fragment,{children:[u.jsx("dialog",{ref:r,className:"fixed inset-0 m-auto w-full max-w-4xl p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:f,children:u.jsxs("div",{className:"flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n("settings.title")}),u.jsx("button",{type:"button",onClick:e,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:u.jsx(mB,{})}),u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[u.jsx(Ru,{className:"w-5 h-5"}),n("settings.import.title")]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:n("settings.import.description")})]}),u.jsxs("button",{type:"button",onClick:p,disabled:d,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-sm font-medium rounded-lg transition-colors",children:[d?u.jsx(Qe,{className:"w-4 h-4 animate-spin"}):u.jsx(Ru,{className:"w-4 h-4"}),n("settings.import.button")]}),u.jsx("input",{ref:s,type:"file",accept:".xml",onChange:g,className:"hidden"})]}),u.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx(XD,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"text-sm",children:[u.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:n("settings.import.formatTitle")}),u.jsx("p",{className:"text-blue-800 dark:text-blue-200 mb-3",children:n("settings.import.formatDescription")}),u.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:n("settings.import.structureTitle")}),u.jsx("pre",{className:"bg-blue-100 dark:bg-blue-900/40 p-3 rounded text-xs text-blue-900 dark:text-blue-100 overflow-x-auto whitespace-pre",children:`<?xml version="1.0" encoding="UTF-8"?>
<usfx>
  <book id="GEN">
    <id>GEN</id>
    <h>Genesis</h>
    <c id="1">
      <v id="1">In the beginning God created...</v>
      <v id="2">And the earth was without form...</v>
    </c>
    <c id="2">
      <v id="1">Thus the heavens and the earth...</v>
    </c>
  </book>
</usfx>`}),u.jsxs("ul",{className:"mt-3 space-y-1 text-blue-800 dark:text-blue-200",children:[u.jsxs("li",{children:[" ",n("settings.import.hints.rootElement")]}),u.jsxs("li",{children:[" ",n("settings.import.hints.bookElement")]}),u.jsxs("li",{children:[" ",n("settings.import.hints.chapterElement")]}),u.jsxs("li",{children:[" ",n("settings.import.hints.verseElement")]})]})]})]})})]})]})]})}),u.jsx(qE,{isOpen:!!i,title:n("import.errorTitle"),message:i||"",onClose:()=>o(null),variant:"error"})]})}function xB(t,e,n,r){const s=`${t} ${e}:${n}`;return r?`${s} - ${r}`:s}function bB({onAddSong:t,onAddBibleVerse:e,onAddBiblePassage:n,onAddSlide:r,onImportSchedule:s}){const{t:i}=ke("queue"),[o,l]=C.useState(!1),d=C.useRef(null);C.useEffect(()=>{o?d.current?.showModal():d.current?.close()},[o]);const f=g=>{l(!1),g()},p=()=>{l(!1)};return u.jsxs(u.Fragment,{children:[u.jsx("button",{type:"button",onClick:()=>l(!0),className:"p-1.5 text-white bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 rounded-lg transition-colors",title:i("addToQueue.button"),children:u.jsx(Xt,{size:18})}),u.jsx("dialog",{ref:d,onCancel:p,onClick:g=>{g.target===d.current&&p()},className:"fixed inset-0 m-auto w-full max-w-sm p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:i("addToQueue.title")}),u.jsx("button",{type:"button",onClick:p,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"p-4 space-y-2",children:[u.jsxs("button",{type:"button",onClick:()=>f(t),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center",children:u.jsx(ha,{size:20,className:"text-indigo-600 dark:text-indigo-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:i("addToQueue.searchSong")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("addToQueue.searchSongDescription")})]})]}),e&&u.jsxs("button",{type:"button",onClick:()=>f(e),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:u.jsx(wr,{size:20,className:"text-blue-600 dark:text-blue-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:i("addToQueue.bibleVerse")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("addToQueue.bibleVerseDescription")})]})]}),n&&u.jsxs("button",{type:"button",onClick:()=>f(n),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-teal-100 dark:bg-teal-900/30 flex items-center justify-center",children:u.jsx(Ap,{size:20,className:"text-teal-600 dark:text-teal-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:i("addToQueue.biblePassage")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("addToQueue.biblePassageDescription")})]})]}),u.jsxs("button",{type:"button",onClick:()=>f(()=>r("announcement")),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center",children:u.jsx(lo,{size:20,className:"text-orange-600 dark:text-orange-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:i("addToQueue.announcement")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("addToQueue.announcementDescription")})]})]}),u.jsxs("button",{type:"button",onClick:()=>f(()=>r("versete_tineri")),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:u.jsx(ds,{size:20,className:"text-green-600 dark:text-green-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:i("addToQueue.verseteTineri")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("addToQueue.verseteTineriDescription")})]})]}),s&&u.jsxs("button",{type:"button",onClick:()=>f(s),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center",children:u.jsx(Rp,{size:20,className:"text-purple-600 dark:text-purple-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:i("importSchedule.title")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("importSchedule.description")})]})]})]})]})})]})}function vn(t){this.content=t}vn.prototype={constructor:vn,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,s=r.find(t),i=r.content.slice();return s==-1?i.push(n||t,e):(i[s+1]=e,n&&(i[s]=n)),new vn(i)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new vn(n)},addToStart:function(t,e){return new vn([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new vn(n)},addBefore:function(t,e,n){var r=this.remove(e),s=r.content.slice(),i=r.find(t);return s.splice(i==-1?s.length:i,0,e,n),new vn(s)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=vn.from(t),t.size?new vn(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=vn.from(t),t.size?new vn(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=vn.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};vn.from=function(t){if(t instanceof vn)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new vn(e)};function C3(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let s=t.child(r),i=e.child(r);if(s==i){n+=s.nodeSize;continue}if(!s.sameMarkup(i))return n;if(s.isText&&s.text!=i.text){for(let o=0;s.text[o]==i.text[o];o++)n++;return n}if(s.content.size||i.content.size){let o=C3(s.content,i.content,n+1);if(o!=null)return o}n+=s.nodeSize}}function N3(t,e,n,r){for(let s=t.childCount,i=e.childCount;;){if(s==0||i==0)return s==i?null:{a:n,b:r};let o=t.child(--s),l=e.child(--i),d=o.nodeSize;if(o==l){n-=d,r-=d;continue}if(!o.sameMarkup(l))return{a:n,b:r};if(o.isText&&o.text!=l.text){let f=0,p=Math.min(o.text.length,l.text.length);for(;f<p&&o.text[o.text.length-f-1]==l.text[l.text.length-f-1];)f++,n--,r--;return{a:n,b:r}}if(o.content.size||l.content.size){let f=N3(o.content,l.content,n-1,r-1);if(f)return f}n-=d,r-=d}}class Ne{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,s=0,i){for(let o=0,l=0;l<n;o++){let d=this.content[o],f=l+d.nodeSize;if(f>e&&r(d,s+l,i||null,o)!==!1&&d.content.size){let p=l+1;d.nodesBetween(Math.max(0,e-p),Math.min(d.content.size,n-p),r,s+p)}l=f}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,s){let i="",o=!0;return this.nodesBetween(e,n,(l,d)=>{let f=l.isText?l.text.slice(Math.max(e,d)-d,n-d):l.isLeaf?s?typeof s=="function"?s(l):s:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&f||l.isTextblock)&&r&&(o?o=!1:i+=r),i+=f},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,s=this.content.slice(),i=0;for(n.isText&&n.sameMarkup(r)&&(s[s.length-1]=n.withText(n.text+r.text),i=1);i<e.content.length;i++)s.push(e.content[i]);return new Ne(s,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],s=0;if(n>e)for(let i=0,o=0;o<n;i++){let l=this.content[i],d=o+l.nodeSize;d>e&&((o<e||d>n)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,n-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,n-o-1))),r.push(l),s+=l.nodeSize),o=d}return new Ne(r,s)}cutByIndex(e,n){return e==n?Ne.empty:e==0&&n==this.content.length?this:new Ne(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let s=this.content.slice(),i=this.size+n.nodeSize-r.nodeSize;return s[e]=n,new Ne(s,i)}addToStart(e){return new Ne([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Ne(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let s=this.content[n];e(s,r,n),r+=s.nodeSize}}findDiffStart(e,n=0){return C3(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return N3(this,e,n,r)}findIndex(e){if(e==0)return qf(0,e);if(e==this.size)return qf(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let s=this.child(n),i=r+s.nodeSize;if(i>=e)return i==e?qf(n+1,i):qf(n,r);r=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return Ne.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ne(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Ne.empty;let n,r=0;for(let s=0;s<e.length;s++){let i=e[s];r+=i.nodeSize,s&&i.isText&&e[s-1].sameMarkup(i)?(n||(n=e.slice(0,s)),n[n.length-1]=i.withText(n[n.length-1].text+i.text)):n&&n.push(i)}return new Ne(n||e,r)}static from(e){if(!e)return Ne.empty;if(e instanceof Ne)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Ne([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Ne.empty=new Ne([],0);const q0={index:0,offset:0};function qf(t,e){return q0.index=t,q0.offset=e,q0}function Dh(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Dh(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Dh(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let kt=class kx{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let s=0;s<e.length;s++){let i=e[s];if(this.eq(i))return e;if(this.type.excludes(i.type))n||(n=e.slice(0,s));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(n||(n=e.slice(0,s)),n.push(this),r=!0),n&&n.push(i)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Dh(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let s=r.create(n.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return kx.none;if(e instanceof kx)return[e];let n=e.slice();return n.sort((r,s)=>r.type.rank-s.type.rank),n}};kt.none=[];class Ih extends Error{}class Ae{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=j3(this.content,e+this.openStart,n);return r&&new Ae(r,this.openStart,this.openEnd)}removeBetween(e,n){return new Ae(T3(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return Ae.empty;let r=n.openStart||0,s=n.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Ae(Ne.fromJSON(e,n.content),r,s)}static maxOpen(e,n=!0){let r=0,s=0;for(let i=e.firstChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.lastChild)s++;return new Ae(e,r,s)}}Ae.empty=new Ae(Ne.empty,0,0);function T3(t,e,n){let{index:r,offset:s}=t.findIndex(e),i=t.maybeChild(r),{index:o,offset:l}=t.findIndex(n);if(s==e||i.isText){if(l!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(r,i.copy(T3(i.content,e-s-1,n-s-1)))}function j3(t,e,n,r){let{index:s,offset:i}=t.findIndex(e),o=t.maybeChild(s);if(i==e||o.isText)return r&&!r.canReplace(s,s,n)?null:t.cut(0,e).append(n).append(t.cut(e));let l=j3(o.content,e-i-1,n,o);return l&&t.replaceChild(s,o.copy(l))}function vB(t,e,n){if(n.openStart>t.depth)throw new Ih("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Ih("Inconsistent open depths");return E3(t,e,n,0)}function E3(t,e,n,r){let s=t.index(r),i=t.node(r);if(s==e.index(r)&&r<t.depth-n.openStart){let o=E3(t,e,n,r+1);return i.copy(i.content.replaceChild(s,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let o=t.parent,l=o.content;return Ka(o,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}else{let{start:o,end:l}=wB(n,t);return Ka(i,A3(t,o,l,e,r))}else return Ka(i,Lh(t,e,r))}function M3(t,e){if(!e.type.compatibleContent(t.type))throw new Ih("Cannot join "+e.type.name+" onto "+t.type.name)}function Cx(t,e,n){let r=t.node(n);return M3(r,e.node(n)),r}function Va(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function bu(t,e,n,r){let s=(e||t).node(n),i=0,o=e?e.index(n):s.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(Va(t.nodeAfter,r),i++));for(let l=i;l<o;l++)Va(s.child(l),r);e&&e.depth==n&&e.textOffset&&Va(e.nodeBefore,r)}function Ka(t,e){return t.type.checkContent(e),t.copy(e)}function A3(t,e,n,r,s){let i=t.depth>s&&Cx(t,e,s+1),o=r.depth>s&&Cx(n,r,s+1),l=[];return bu(null,t,s,l),i&&o&&e.index(s)==n.index(s)?(M3(i,o),Va(Ka(i,A3(t,e,n,r,s+1)),l)):(i&&Va(Ka(i,Lh(t,e,s+1)),l),bu(e,n,s,l),o&&Va(Ka(o,Lh(n,r,s+1)),l)),bu(r,null,s,l),new Ne(l)}function Lh(t,e,n){let r=[];if(bu(null,t,n,r),t.depth>n){let s=Cx(t,e,n+1);Va(Ka(s,Lh(t,e,n+1)),r)}return bu(e,null,n,r),new Ne(r)}function wB(t,e){let n=e.depth-t.openStart,s=e.node(n).copy(t.content);for(let i=n-1;i>=0;i--)s=e.node(i).copy(Ne.from(s));return{start:s.resolveNoCache(t.openStart+n),end:s.resolveNoCache(s.content.size-t.openEnd-n)}}class Fu{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(n);return r?e.child(n).cut(r):s}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],s=n==0?0:this.path[n*3-1]+1;for(let i=0;i<e;i++)s+=r.child(i).nodeSize;return s}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return kt.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),s=e.maybeChild(n);if(!r){let l=r;r=s,s=l}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!s||!i[o].isInSet(s.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,s=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new zh(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],s=0,i=n;for(let o=e;;){let{index:l,offset:d}=o.content.findIndex(i),f=i-d;if(r.push(o,l,s+d),!f||(o=o.child(l),o.isText))break;i=f-1,s+=d+1}return new Fu(n,r,i)}static resolveCached(e,n){let r=MC.get(e);if(r)for(let i=0;i<r.elts.length;i++){let o=r.elts[i];if(o.pos==n)return o}else MC.set(e,r=new SB);let s=r.elts[r.i]=Fu.resolve(e,n);return r.i=(r.i+1)%kB,s}}class SB{constructor(){this.elts=[],this.i=0}}const kB=12,MC=new WeakMap;class zh{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const CB=Object.create(null);let aa=class Nx{constructor(e,n,r,s=kt.none){this.type=e,this.attrs=n,this.marks=s,this.content=r||Ne.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,s=0){this.content.nodesBetween(e,n,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,s){return this.content.textBetween(e,n,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Dh(this.attrs,n||e.defaultAttrs||CB)&&kt.sameSet(this.marks,r||kt.none)}copy(e=null){return e==this.content?this:new Nx(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Nx(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return Ae.empty;let s=this.resolve(e),i=this.resolve(n),o=r?0:s.sharedDepth(n),l=s.start(o),f=s.node(o).content.cut(s.pos-l,i.pos-l);return new Ae(f,s.depth-o,i.depth-o)}replace(e,n,r){return vB(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:s}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(s==e||n.isText)return n;e-=s+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let s=this.content.child(n-1);return{node:s,index:n-1,offset:r-s.nodeSize}}resolve(e){return Fu.resolveCached(this,e)}resolveNoCache(e){return Fu.resolve(this,e)}rangeHasMark(e,n,r){let s=!1;return n>e&&this.nodesBetween(e,n,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),R3(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=Ne.empty,s=0,i=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,s,i),l=o&&o.matchFragment(this.content,n);if(!l||!l.validEnd)return!1;for(let d=s;d<i;d++)if(!this.type.allowsMarks(r.child(d).marks))return!1;return!0}canReplaceWith(e,n,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(e).matchType(r),o=i&&i.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=kt.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!kt.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let s=Ne.fromJSON(e,n.content),i=e.nodeType(n.type).create(n.attrs,s,r);return i.type.checkAttrs(i.attrs),i}};aa.prototype.text=void 0;class Ph extends aa{constructor(e,n,r,s){if(super(e,n,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):R3(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Ph(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Ph(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function R3(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class no{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new NB(e,n);if(r.next==null)return no.empty;let s=_3(r);r.next&&r.err("Unexpected trailing text");let i=_B(RB(s));return OB(i,r),i}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let s=this;for(let i=n;s&&i<r;i++)s=s.matchType(e.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let s=[this];function i(o,l){let d=o.matchFragment(e,r);if(d&&(!n||d.validEnd))return Ne.from(l.map(f=>f.createAndFill()));for(let f=0;f<o.next.length;f++){let{type:p,next:g}=o.next[f];if(!(p.isText||p.hasRequiredAttrs())&&s.indexOf(g)==-1){s.push(g);let y=i(g,l.concat(p));if(y)return y}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(e)){let o=[];for(let l=s;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:l,next:d}=i.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in n)&&(!s.type||d.validEnd)&&(r.push({match:l.contentMatch,type:l,via:s}),n[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&n(r.next[s].next)}return n(this),e.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return i}).join(`
`)}}no.empty=new no(!0);class NB{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function _3(t){let e=[];do e.push(TB(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function TB(t){let e=[];do e.push(jB(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function jB(t){let e=AB(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=EB(t,e);else break;return e}function AC(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function EB(t,e){let n=AC(t),r=n;return t.eat(",")&&(t.next!="}"?r=AC(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function MB(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let s=[];for(let i in n){let o=n[i];o.isInGroup(e)&&s.push(o)}return s.length==0&&t.err("No node type or group '"+e+"' found"),s}function AB(t){if(t.eat("(")){let e=_3(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=MB(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function RB(t){let e=[[]];return s(i(t,0),n()),e;function n(){return e.push([])-1}function r(o,l,d){let f={term:d,to:l};return e[o].push(f),f}function s(o,l){o.forEach(d=>d.to=l)}function i(o,l){if(o.type=="choice")return o.exprs.reduce((d,f)=>d.concat(i(f,l)),[]);if(o.type=="seq")for(let d=0;;d++){let f=i(o.exprs[d],l);if(d==o.exprs.length-1)return f;s(f,l=n())}else if(o.type=="star"){let d=n();return r(l,d),s(i(o.expr,d),d),[r(d)]}else if(o.type=="plus"){let d=n();return s(i(o.expr,l),d),s(i(o.expr,d),d),[r(d)]}else{if(o.type=="opt")return[r(l)].concat(i(o.expr,l));if(o.type=="range"){let d=l;for(let f=0;f<o.min;f++){let p=n();s(i(o.expr,d),p),d=p}if(o.max==-1)s(i(o.expr,d),d);else for(let f=o.min;f<o.max;f++){let p=n();r(d,p),s(i(o.expr,d),p),d=p}return[r(d)]}else{if(o.type=="name")return[r(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function O3(t,e){return e-t}function RC(t,e){let n=[];return r(e),n.sort(O3);function r(s){let i=t[s];if(i.length==1&&!i[0].term)return r(i[0].to);n.push(s);for(let o=0;o<i.length;o++){let{term:l,to:d}=i[o];!l&&n.indexOf(d)==-1&&r(d)}}}function _B(t){let e=Object.create(null);return n(RC(t,0));function n(r){let s=[];r.forEach(o=>{t[o].forEach(({term:l,to:d})=>{if(!l)return;let f;for(let p=0;p<s.length;p++)s[p][0]==l&&(f=s[p][1]);RC(t,d).forEach(p=>{f||s.push([l,f=[]]),f.indexOf(p)==-1&&f.push(p)})})});let i=e[r.join(",")]=new no(r.indexOf(t.length-1)>-1);for(let o=0;o<s.length;o++){let l=s[o][1].sort(O3);i.next.push({type:s[o][0],next:e[l.join(",")]||n(l)})}return i}}function OB(t,e){for(let n=0,r=[t];n<r.length;n++){let s=r[n],i=!s.validEnd,o=[];for(let l=0;l<s.next.length;l++){let{type:d,next:f}=s.next[l];o.push(d.name),i&&!(d.isText||d.hasRequiredAttrs())&&(i=!1),r.indexOf(f)==-1&&r.push(f)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function D3(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function I3(t,e){let n=Object.create(null);for(let r in t){let s=e&&e[r];if(s===void 0){let i=t[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=s}return n}function L3(t,e,n,r){for(let s in e)if(!(s in t))throw new RangeError(`Unsupported attribute ${s} for ${n} of type ${s}`);for(let s in t){let i=t[s];i.validate&&i.validate(e[s])}}function z3(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new IB(t,r,e[r]);return n}let _C=class P3{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=z3(e,r.attrs),this.defaultAttrs=D3(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==no.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:I3(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new aa(this,this.computeAttrs(e),Ne.from(n),kt.setFrom(r))}createChecked(e=null,n,r){return n=Ne.from(n),this.checkContent(n),new aa(this,this.computeAttrs(e),n,kt.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=Ne.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let s=this.contentMatch.matchFragment(n),i=s&&s.fillBefore(Ne.empty,!0);return i?new aa(this,e,n.append(i),kt.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){L3(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:kt.none:e}static compile(e,n){let r=Object.create(null);e.forEach((i,o)=>r[i]=new P3(i,n,o));let s=n.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function DB(t,e,n){let r=n.split("|");return s=>{let i=s===null?"null":typeof s;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${i}`)}}class IB{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?DB(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Kp{constructor(e,n,r,s){this.name=e,this.rank=n,this.schema=r,this.spec=s,this.attrs=z3(e,s.attrs),this.excluded=null;let i=D3(this.attrs);this.instance=i?new kt(this,i):null}create(e=null){return!e&&this.instance?this.instance:new kt(this,I3(this.attrs,e))}static compile(e,n){let r=Object.create(null),s=0;return e.forEach((i,o)=>r[i]=new Kp(i,s++,n,o)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){L3(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class B3{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let s in e)n[s]=e[s];n.nodes=vn.from(e.nodes),n.marks=vn.from(e.marks||{}),this.nodes=_C.compile(this.spec.nodes,this),this.marks=Kp.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],o=i.spec.content||"",l=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=no.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=l=="_"?null:l?OC(this,l.split(" ")):l==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:OC(this,o.split(" "))}this.nodeFromJSON=s=>aa.fromJSON(this,s),this.markFromJSON=s=>kt.fromJSON(this,s),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof _C){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,s)}text(e,n){let r=this.nodes.text;return new Ph(r,r.defaultAttrs,e,kt.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function OC(t,e){let n=[];for(let r=0;r<e.length;r++){let s=e[r],i=t.marks[s],o=i;if(i)n.push(i);else for(let l in t.marks){let d=t.marks[l];(s=="_"||d.spec.group&&d.spec.group.split(" ").indexOf(s)>-1)&&n.push(o=d)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function LB(t){return t.tag!=null}function zB(t){return t.style!=null}let vu=class Tx{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(s=>{if(LB(s))this.tags.push(s);else if(zB(s)){let i=/[^=]*/.exec(s.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let i=e.nodes[s.node];return i.contentMatch.matchType(i)})}parse(e,n={}){let r=new IC(this,n,!1);return r.addAll(e,kt.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new IC(this,n,!0);return r.addAll(e,kt.none,n.from,n.to),Ae.maxOpen(r.finish())}matchTag(e,n,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(FB(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||n.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,n,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let o=this.styles[i],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=n))){if(o.getAttrs){let d=o.getAttrs(n);if(d===!1)continue;o.attrs=d||void 0}return o}}}static schemaRules(e){let n=[];function r(s){let i=s.priority==null?50:s.priority,o=0;for(;o<n.length;o++){let l=n[o];if((l.priority==null?50:l.priority)<i)break}n.splice(o,0,s)}for(let s in e.marks){let i=e.marks[s].spec.parseDOM;i&&i.forEach(o=>{r(o=LC(o)),o.mark||o.ignore||o.clearMark||(o.mark=s)})}for(let s in e.nodes){let i=e.nodes[s].spec.parseDOM;i&&i.forEach(o=>{r(o=LC(o)),o.node||o.ignore||o.mark||(o.node=s)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Tx(e,Tx.schemaRules(e)))}};const F3={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},PB={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},U3={ol:!0,ul:!0},Uu=1,jx=2,wu=4;function DC(t,e,n){return e!=null?(e?Uu:0)|(e==="full"?jx:0):t&&t.whitespace=="pre"?Uu|jx:n&~wu}class Hf{constructor(e,n,r,s,i,o){this.type=e,this.attrs=n,this.marks=r,this.solid=s,this.options=o,this.content=[],this.activeMarks=kt.none,this.match=i||(o&wu?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(Ne.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Uu)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let n=Ne.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(Ne.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!F3.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class IC{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=n.topNode,i,o=DC(null,n.preserveWhitespace,0)|(r?wu:0);s?i=new Hf(s.type,s.attrs,kt.none,!0,n.topMatch||s.type.contentMatch,o):r?i=new Hf(null,null,kt.none,!0,null,o):i=new Hf(e.schema.topNodeType,null,kt.none,!0,null,o),this.nodes=[i],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,s=this.top,i=s.options&jx?"full":this.localPreserveWS||(s.options&Uu)>0,{schema:o}=this.parser;if(i==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i)if(i==="full")r=r.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(o.linebreakReplacement.create())){let l=r.split(/\r?\n|\r/);for(let d=0;d<l.length;d++)d&&this.insertNode(o.linebreakReplacement.create(),n,!0),l[d]&&this.insertNode(o.text(l[d]),n,!/\S/.test(l[d]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let l=s.content[s.content.length-1],d=e.previousSibling;(!l||d&&d.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(r=r.slice(1))}r&&this.insertNode(o.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let s=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),l;U3.hasOwnProperty(o)&&this.parser.normalizeLists&&BB(e);let d=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,r));e:if(d?d.ignore:PB.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,n);else if(!d||d.skip||d.closeParent){d&&d.closeParent?this.open=Math.max(0,this.open-1):d&&d.skip.nodeType&&(e=d.skip);let f,p=this.needsBlock;if(F3.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),f=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let g=d&&d.skip?n:this.readStyles(e,n);g&&this.addAll(e,g),f&&this.sync(i),this.needsBlock=p}else{let f=this.readStyles(e,n);f&&this.addElementByRule(e,d,f,d.consuming===!1?l:void 0)}this.localPreserveWS=s}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let i=this.parser.matchedStyles[s],o=r.getPropertyValue(i);if(o)for(let l=void 0;;){let d=this.parser.matchStyle(i,o,this,l);if(!d)break;if(d.ignore)return null;if(d.clearMark?n=n.filter(f=>!d.clearMark(f)):n=n.concat(this.parser.schema.marks[d.mark].create(d.attrs)),d.consuming===!1)l=d;else break}}return n}addElementByRule(e,n,r,s){let i,o;if(n.node)if(o=this.parser.schema.nodes[n.node],o.isLeaf)this.insertNode(o.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let d=this.enter(o,n.attrs||null,r,n.preserveWhitespace);d&&(i=!0,r=d)}else{let d=this.parser.schema.marks[n.mark];r=r.concat(d.create(n.attrs))}let l=this.top;if(o&&o.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(d=>this.insertNode(d,r,!1));else{let d=e;typeof n.contentElement=="string"?d=e.querySelector(n.contentElement):typeof n.contentElement=="function"?d=n.contentElement(e):n.contentElement&&(d=n.contentElement),this.findAround(e,d,!0),this.addAll(d,r),this.findAround(e,d,!1)}i&&this.sync(l)&&this.open--}addAll(e,n,r,s){let i=r||0;for(let o=r?e.childNodes[r]:e.firstChild,l=s==null?null:e.childNodes[s];o!=l;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o,n);this.findAtPoint(e,i)}findPlace(e,n,r){let s,i;for(let o=this.open,l=0;o>=0;o--){let d=this.nodes[o],f=d.findWrapping(e);if(f&&(!s||s.length>f.length+l)&&(s=f,i=d,!f.length))break;if(d.solid){if(r)break;l+=2}}if(!s)return null;this.sync(i);for(let o=0;o<s.length;o++)n=this.enterInner(s[o],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(n=this.enterInner(i,null,n))}let s=this.findPlace(e,n,r);if(s){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=kt.none;for(let l of s.concat(e.marks))(i.type?i.type.allowsMarkType(l.type):zC(l.type,e.type))&&(o=l.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,n,r,s){let i=this.findPlace(e.create(n),r,!1);return i&&(i=this.enterInner(e,n,r,!0,s)),i}enterInner(e,n,r,s=!1,i){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let l=DC(e,i,o.options);o.options&wu&&o.content.length==0&&(l|=wu);let d=kt.none;return r=r.filter(f=>(o.type?o.type.allowsMarkType(f.type):zC(f.type,e))?(d=f.addToSet(d),!1):!0),this.nodes.push(new Hf(e,n,d,s,null,l)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Uu)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&n.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),o=(l,d)=>{for(;l>=0;l--){let f=n[l];if(f==""){if(l==n.length-1||l==0)continue;for(;d>=i;d--)if(o(l-1,d))return!0;return!1}else{let p=d>0||d==0&&s?this.nodes[d].type:r&&d>=i?r.node(d-i).type:null;if(!p||p.name!=f&&!p.isInGroup(f))return!1;d--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function BB(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&U3.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function FB(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function LC(t){let e={};for(let n in t)e[n]=t[n];return e}function zC(t,e){let n=e.schema.nodes;for(let r in n){let s=n[r];if(!s.allowsMarkType(t))continue;let i=[],o=l=>{i.push(l);for(let d=0;d<l.edgeCount;d++){let{type:f,next:p}=l.edge(d);if(f==e||i.indexOf(p)<0&&o(p))return!0}};if(o(s.contentMatch))return!0}}class vo{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=H0(n).createDocumentFragment());let s=r,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let l=0,d=0;for(;l<i.length&&d<o.marks.length;){let f=o.marks[d];if(!this.marks[f.type.name]){d++;continue}if(!f.eq(i[l][0])||f.type.spec.spanning===!1)break;l++,d++}for(;l<i.length;)s=i.pop()[1];for(;d<o.marks.length;){let f=o.marks[d++],p=this.serializeMark(f,o.isInline,n);p&&(i.push([f,s]),s.appendChild(p.dom),s=p.contentDOM||p.dom)}}s.appendChild(this.serializeNodeInner(o,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:s}=oh(H0(n),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,s)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let s=e.marks.length-1;s>=0;s--){let i=this.serializeMark(e.marks[s],e.isInline,n);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,n,r={}){let s=this.marks[e.type.name];return s&&oh(H0(r),s(e,n),null,e.attrs)}static renderSpec(e,n,r=null,s){return oh(e,n,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new vo(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=PC(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return PC(e.marks)}}function PC(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function H0(t){return t.document||window.document}const BC=new WeakMap;function UB(t){let e=BC.get(t);return e===void 0&&BC.set(t,e=$B(t)),e}function $B(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)n(r[s]);else for(let s in r)n(r[s])}return n(t),e}function oh(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],i;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=UB(r))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=s.indexOf(" ");o>0&&(n=s.slice(0,o),s=s.slice(o+1));let l,d=n?t.createElementNS(n,s):t.createElement(s),f=e[1],p=1;if(f&&typeof f=="object"&&f.nodeType==null&&!Array.isArray(f)){p=2;for(let g in f)if(f[g]!=null){let y=g.indexOf(" ");y>0?d.setAttributeNS(g.slice(0,y),g.slice(y+1),f[g]):g=="style"&&d.style?d.style.cssText=f[g]:d.setAttribute(g,f[g])}}for(let g=p;g<e.length;g++){let y=e[g];if(y===0){if(g<e.length-1||g>p)throw new RangeError("Content hole must be the only child of its parent node");return{dom:d,contentDOM:d}}else{let{dom:m,contentDOM:b}=oh(t,y,n,r);if(d.appendChild(m),b){if(l)throw new RangeError("Multiple content holes");l=b}}}return{dom:d,contentDOM:l}}const $3=65535,q3=Math.pow(2,16);function qB(t,e){return t+e*q3}function FC(t){return t&$3}function HB(t){return(t-(t&$3))/q3}const H3=1,V3=2,lh=4,K3=8;class Ex{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&K3)>0}get deletedBefore(){return(this.delInfo&(H3|lh))>0}get deletedAfter(){return(this.delInfo&(V3|lh))>0}get deletedAcross(){return(this.delInfo&lh)>0}}class vr{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&vr.empty)return vr.empty}recover(e){let n=0,r=FC(e);if(!this.inverted)for(let s=0;s<r;s++)n+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+n+HB(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let s=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let d=this.ranges[l]-(this.inverted?s:0);if(d>e)break;let f=this.ranges[l+i],p=this.ranges[l+o],g=d+f;if(e<=g){let y=f?e==d?-1:e==g?1:n:n,m=d+s+(y<0?0:p);if(r)return m;let b=e==(n<0?d:g)?null:qB(l/3,e-d),v=e==d?V3:e==g?H3:lh;return(n<0?e!=d:e!=g)&&(v|=K3),new Ex(m,v,b)}s+=p-f}return r?e+s:new Ex(e+s,0,null)}touches(e,n){let r=0,s=FC(n),i=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let d=this.ranges[l]-(this.inverted?r:0);if(d>e)break;let f=this.ranges[l+i],p=d+f;if(e<=p&&l==s*3)return!0;r+=this.ranges[l+o]-f}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let o=this.ranges[s],l=o-(this.inverted?i:0),d=o+(this.inverted?0:i),f=this.ranges[s+n],p=this.ranges[s+r];e(l,l+f,d,d+p),i+=p-f}}invert(){return new vr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?vr.empty:new vr(e<0?[0,-e,0]:[0,0,e])}}vr.empty=new vr([]);class $u{constructor(e,n,r=0,s=e?e.length:0){this.mirror=n,this.from=r,this.to=s,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new $u(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let s=e.getMirror(n);this.appendMap(e._maps[n],s!=null&&s<n?r+s:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let s=e.getMirror(n);this.appendMap(e._maps[n].invert(),s!=null&&s>n?r-s-1:void 0)}}invert(){let e=new $u;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let s=0;for(let i=this.from;i<this.to;i++){let o=this._maps[i],l=o.mapResult(e,n);if(l.recover!=null){let d=this.getMirror(i);if(d!=null&&d>i&&d<this.to){i=d,e=this._maps[d].recover(l.recover);continue}}s|=l.delInfo,e=l.pos}return r?e:new Ex(e,s,null)}}const V0=Object.create(null);class _n{getMap(){return vr.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=V0[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in V0)throw new RangeError("Duplicate use of step JSON ID "+e);return V0[e]=n,n.prototype.jsonID=e,n}}class Gt{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new Gt(e,null)}static fail(e){return new Gt(null,e)}static fromReplace(e,n,r,s){try{return Gt.ok(e.replace(n,r,s))}catch(i){if(i instanceof Ih)return Gt.fail(i.message);throw i}}}function nv(t,e,n){let r=[];for(let s=0;s<t.childCount;s++){let i=t.child(s);i.content.size&&(i=i.copy(nv(i.content,e,i))),i.isInline&&(i=e(i,n,s)),r.push(i)}return Ne.fromArray(r)}class Ji extends _n{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new Ae(nv(n.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),n.openStart,n.openEnd);return Gt.fromReplace(e,this.from,this.to,i)}invert(){return new as(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Ji(n.pos,r.pos,this.mark)}merge(e){return e instanceof Ji&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ji(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ji(n.from,n.to,e.markFromJSON(n.mark))}}_n.jsonID("addMark",Ji);class as extends _n{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new Ae(nv(n.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),n.openStart,n.openEnd);return Gt.fromReplace(e,this.from,this.to,r)}invert(){return new Ji(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new as(n.pos,r.pos,this.mark)}merge(e){return e instanceof as&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new as(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new as(n.from,n.to,e.markFromJSON(n.mark))}}_n.jsonID("removeMark",as);class Zi extends _n{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Gt.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return Gt.fromReplace(e,this.pos,this.pos+1,new Ae(Ne.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let s=0;s<n.marks.length;s++)if(!n.marks[s].isInSet(r))return new Zi(this.pos,n.marks[s]);return new Zi(this.pos,this.mark)}}return new ro(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Zi(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Zi(n.pos,e.markFromJSON(n.mark))}}_n.jsonID("addNodeMark",Zi);class ro extends _n{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Gt.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return Gt.fromReplace(e,this.pos,this.pos+1,new Ae(Ne.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new Zi(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new ro(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new ro(n.pos,e.markFromJSON(n.mark))}}_n.jsonID("removeNodeMark",ro);class un extends _n{constructor(e,n,r,s=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=s}apply(e){return this.structure&&Mx(e,this.from,this.to)?Gt.fail("Structure replace would overwrite content"):Gt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new vr([this.from,this.to-this.from,this.slice.size])}invert(e){return new un(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new un(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof un)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?Ae.empty:new Ae(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new un(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?Ae.empty:new Ae(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new un(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new un(n.from,n.to,Ae.fromJSON(e,n.slice),!!n.structure)}}_n.jsonID("replace",un);class fn extends _n{constructor(e,n,r,s,i,o,l=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=o,this.structure=l}apply(e){if(this.structure&&(Mx(e,this.from,this.gapFrom)||Mx(e,this.gapTo,this.to)))return Gt.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return Gt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?Gt.fromReplace(e,this.from,this.to,r):Gt.fail("Content does not fit in gap")}getMap(){return new vr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new fn(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||s<n.pos||i>r.pos?null:new fn(n.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new fn(n.from,n.to,n.gapFrom,n.gapTo,Ae.fromJSON(e,n.slice),n.insert,!!n.structure)}}_n.jsonID("replaceAround",fn);function Mx(t,e,n){let r=t.resolve(e),s=n-e,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function VB(t,e,n,r){let s=[],i=[],o,l;t.doc.nodesBetween(e,n,(d,f,p)=>{if(!d.isInline)return;let g=d.marks;if(!r.isInSet(g)&&p.type.allowsMarkType(r.type)){let y=Math.max(f,e),m=Math.min(f+d.nodeSize,n),b=r.addToSet(g);for(let v=0;v<g.length;v++)g[v].isInSet(b)||(o&&o.to==y&&o.mark.eq(g[v])?o.to=m:s.push(o=new as(y,m,g[v])));l&&l.to==y?l.to=m:i.push(l=new Ji(y,m,r))}}),s.forEach(d=>t.step(d)),i.forEach(d=>t.step(d))}function KB(t,e,n,r){let s=[],i=0;t.doc.nodesBetween(e,n,(o,l)=>{if(!o.isInline)return;i++;let d=null;if(r instanceof Kp){let f=o.marks,p;for(;p=r.isInSet(f);)(d||(d=[])).push(p),f=p.removeFromSet(f)}else r?r.isInSet(o.marks)&&(d=[r]):d=o.marks;if(d&&d.length){let f=Math.min(l+o.nodeSize,n);for(let p=0;p<d.length;p++){let g=d[p],y;for(let m=0;m<s.length;m++){let b=s[m];b.step==i-1&&g.eq(s[m].style)&&(y=b)}y?(y.to=f,y.step=i):s.push({style:g,from:Math.max(l,e),to:f,step:i})}}}),s.forEach(o=>t.step(new as(o.from,o.to,o.style)))}function rv(t,e,n,r=n.contentMatch,s=!0){let i=t.doc.nodeAt(e),o=[],l=e+1;for(let d=0;d<i.childCount;d++){let f=i.child(d),p=l+f.nodeSize,g=r.matchType(f.type);if(!g)o.push(new un(l,p,Ae.empty));else{r=g;for(let y=0;y<f.marks.length;y++)n.allowsMarkType(f.marks[y].type)||t.step(new as(l,p,f.marks[y]));if(s&&f.isText&&n.whitespace!="pre"){let y,m=/\r?\n|\r/g,b;for(;y=m.exec(f.text);)b||(b=new Ae(Ne.from(n.schema.text(" ",n.allowedMarks(f.marks))),0,0)),o.push(new un(l+y.index,l+y.index+y[0].length,b))}}l=p}if(!r.validEnd){let d=r.fillBefore(Ne.empty,!0);t.replace(l,l,new Ae(d,0,0))}for(let d=o.length-1;d>=0;d--)t.step(o[d])}function QB(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function nc(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth,s=0,i=0;;--r){let o=t.$from.node(r),l=t.$from.index(r)+s,d=t.$to.indexAfter(r)-i;if(r<t.depth&&o.canReplace(l,d,n))return r;if(r==0||o.type.spec.isolating||!QB(o,l,d))break;l&&(s=1),d<o.childCount&&(i=1)}return null}function WB(t,e,n){let{$from:r,$to:s,depth:i}=e,o=r.before(i+1),l=s.after(i+1),d=o,f=l,p=Ne.empty,g=0;for(let b=i,v=!1;b>n;b--)v||r.index(b)>0?(v=!0,p=Ne.from(r.node(b).copy(p)),g++):d--;let y=Ne.empty,m=0;for(let b=i,v=!1;b>n;b--)v||s.after(b+1)<s.end(b)?(v=!0,y=Ne.from(s.node(b).copy(y)),m++):f++;t.step(new fn(d,f,o,l,new Ae(p.append(y),g,m),p.size-g,!0))}function sv(t,e,n=null,r=t){let s=YB(t,e),i=s&&GB(r,e);return i?s.map(UC).concat({type:e,attrs:n}).concat(i.map(UC)):null}function UC(t){return{type:t,attrs:null}}function YB(t,e){let{parent:n,startIndex:r,endIndex:s}=t,i=n.contentMatchAt(r).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return n.canReplaceWith(r,s,o)?i:null}function GB(t,e){let{parent:n,startIndex:r,endIndex:s}=t,i=n.child(r),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let d=(o.length?o[o.length-1]:e).contentMatch;for(let f=r;d&&f<s;f++)d=d.matchType(n.child(f).type);return!d||!d.validEnd?null:o}function XB(t,e,n){let r=Ne.empty;for(let o=n.length-1;o>=0;o--){if(r.size){let l=n[o].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=Ne.from(n[o].type.create(n[o].attrs,r))}let s=e.start,i=e.end;t.step(new fn(s,i,s,i,new Ae(r,0,0),n.length,!0))}function JB(t,e,n,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=t.steps.length;t.doc.nodesBetween(e,n,(o,l)=>{let d=typeof s=="function"?s(o):s;if(o.isTextblock&&!o.hasMarkup(r,d)&&ZB(t.doc,t.mapping.slice(i).map(l),r)){let f=null;if(r.schema.linebreakReplacement){let m=r.whitespace=="pre",b=!!r.contentMatch.matchType(r.schema.linebreakReplacement);m&&!b?f=!1:!m&&b&&(f=!0)}f===!1&&W3(t,o,l,i),rv(t,t.mapping.slice(i).map(l,1),r,void 0,f===null);let p=t.mapping.slice(i),g=p.map(l,1),y=p.map(l+o.nodeSize,1);return t.step(new fn(g,y,g+1,y-1,new Ae(Ne.from(r.create(d,null,o.marks)),0,0),1,!0)),f===!0&&Q3(t,o,l,i),!1}})}function Q3(t,e,n,r){e.forEach((s,i)=>{if(s.isText){let o,l=/\r?\n|\r/g;for(;o=l.exec(s.text);){let d=t.mapping.slice(r).map(n+1+i+o.index);t.replaceWith(d,d+1,e.type.schema.linebreakReplacement.create())}}})}function W3(t,e,n,r){e.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let o=t.mapping.slice(r).map(n+1+i);t.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function ZB(t,e,n){let r=t.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,n)}function eF(t,e,n,r,s){let i=t.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let o=n.create(r,null,s||i.marks);if(i.isLeaf)return t.replaceWith(e,e+i.nodeSize,o);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new fn(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new Ae(Ne.from(o),0,0),1,!0))}function oi(t,e,n=1,r){let s=t.resolve(e),i=s.depth-n,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let f=s.depth-1,p=n-2;f>i;f--,p--){let g=s.node(f),y=s.index(f);if(g.type.spec.isolating)return!1;let m=g.content.cutByIndex(y,g.childCount),b=r&&r[p+1];b&&(m=m.replaceChild(0,b.type.create(b.attrs)));let v=r&&r[p]||g;if(!g.canReplace(y+1,g.childCount)||!v.type.validContent(m))return!1}let l=s.indexAfter(i),d=r&&r[0];return s.node(i).canReplaceWith(l,l,d?d.type:s.node(i+1).type)}function tF(t,e,n=1,r){let s=t.doc.resolve(e),i=Ne.empty,o=Ne.empty;for(let l=s.depth,d=s.depth-n,f=n-1;l>d;l--,f--){i=Ne.from(s.node(l).copy(i));let p=r&&r[f];o=Ne.from(p?p.type.create(p.attrs,o):s.node(l).copy(o))}t.step(new un(e,e,new Ae(i.append(o),n,n),!0))}function pa(t,e){let n=t.resolve(e),r=n.index();return Y3(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function nF(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let s=0;s<e.childCount;s++){let i=e.child(s),o=i.type==r?t.type.schema.nodes.text:i.type;if(n=n.matchType(o),!n||!t.type.allowsMarks(i.marks))return!1}return n.validEnd}function Y3(t,e){return!!(t&&e&&!t.isLeaf&&nF(t,e))}function Qp(t,e,n=-1){let r=t.resolve(e);for(let s=r.depth;;s--){let i,o,l=r.index(s);if(s==r.depth?(i=r.nodeBefore,o=r.nodeAfter):n>0?(i=r.node(s+1),l++,o=r.node(s).maybeChild(l)):(i=r.node(s).maybeChild(l-1),o=r.node(s+1)),i&&!i.isTextblock&&Y3(i,o)&&r.node(s).canReplace(l,l+1))return e;if(s==0)break;e=n<0?r.before(s):r.after(s)}}function rF(t,e,n){let r=null,{linebreakReplacement:s}=t.doc.type.schema,i=t.doc.resolve(e-n),o=i.node().type;if(s&&o.inlineContent){let p=o.whitespace=="pre",g=!!o.contentMatch.matchType(s);p&&!g?r=!1:!p&&g&&(r=!0)}let l=t.steps.length;if(r===!1){let p=t.doc.resolve(e+n);W3(t,p.node(),p.before(),l)}o.inlineContent&&rv(t,e+n-1,o,i.node().contentMatchAt(i.index()),r==null);let d=t.mapping.slice(l),f=d.map(e-n);if(t.step(new un(f,d.map(e+n,-1),Ae.empty,!0)),r===!0){let p=t.doc.resolve(f);Q3(t,p.node(),p.before(),t.steps.length)}return t}function sF(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,n))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,n))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function G3(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let s=n.content;for(let i=0;i<n.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(n.openStart==0&&n.size?2:1);i++)for(let o=r.depth;o>=0;o--){let l=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,d=r.index(o)+(l>0?1:0),f=r.node(o),p=!1;if(i==1)p=f.canReplace(d,d,s);else{let g=f.contentMatchAt(d).findWrapping(s.firstChild.type);p=g&&f.canReplaceWith(d,d,g[0])}if(p)return l==0?r.pos:l<0?r.before(o+1):r.after(o+1)}return null}function Wp(t,e,n=e,r=Ae.empty){if(e==n&&!r.size)return null;let s=t.resolve(e),i=t.resolve(n);return X3(s,i,r)?new un(e,n,r):new iF(s,i,r).fit()}function X3(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class iF{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=Ne.empty;for(let s=0;s<=e.depth;s++){let i=e.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=Ne.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let f=this.findFittable();f?this.placeNodes(f):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let i=this.placed,o=r.depth,l=s.depth;for(;o&&l&&i.childCount==1;)i=i.firstChild.content,o--,l--;let d=new Ae(i,o,l);return e>-1?new fn(r.pos,e,this.$to.pos,this.$to.end(),d,n):d.size||r.pos!=this.$to.pos?new un(r.pos,s.pos,d):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let i=n.firstChild;if(n.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){e=r;break}n=i.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=K0(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let o=s.firstChild;for(let l=this.depth;l>=0;l--){let{type:d,match:f}=this.frontier[l],p,g=null;if(n==1&&(o?f.matchType(o.type)||(g=f.fillBefore(Ne.from(o),!1)):i&&d.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:l,parent:i,inject:g};if(n==2&&o&&(p=f.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:l,parent:i,wrap:p};if(i&&f.matchType(i.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=K0(e,n);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new Ae(e,n+1,Math.max(r,s.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=K0(e,n);if(s.childCount<=1&&n>0){let i=e.size-n<=n+s.size;this.unplaced=new Ae(su(e,n-1,1),n-1,i?n-1:r)}else this.unplaced=new Ae(su(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:s,wrap:i}){for(;this.depth>n;)this.closeFrontierNode();if(i)for(let v=0;v<i.length;v++)this.openFrontierNode(i[v]);let o=this.unplaced,l=r?r.content:o.content,d=o.openStart-e,f=0,p=[],{match:g,type:y}=this.frontier[n];if(s){for(let v=0;v<s.childCount;v++)p.push(s.child(v));g=g.matchFragment(s)}let m=l.size+e-(o.content.size-o.openEnd);for(;f<l.childCount;){let v=l.child(f),w=g.matchType(v.type);if(!w)break;f++,(f>1||d==0||v.content.size)&&(g=w,p.push(J3(v.mark(y.allowedMarks(v.marks)),f==1?d:0,f==l.childCount?m:-1)))}let b=f==l.childCount;b||(m=-1),this.placed=iu(this.placed,n,Ne.from(p)),this.frontier[n].match=g,b&&m<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,w=l;v<m;v++){let S=w.lastChild;this.frontier.push({type:S.type,match:S.contentMatchAt(S.childCount)}),w=S.content}this.unplaced=b?e==0?Ae.empty:new Ae(su(o.content,e-1,1),e-1,m<0?o.openEnd:e-1):new Ae(su(o.content,e,f),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Q0(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:s}=this.frontier[n],i=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),o=Q0(e,n,s,r,i);if(o){for(let l=n-1;l>=0;l--){let{match:d,type:f}=this.frontier[l],p=Q0(e,l,f,d,!0);if(!p||p.childCount)continue e}return{depth:n,fit:o,move:i?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=iu(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let s=e.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,i)}return e}openFrontierNode(e,n=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=iu(this.placed,this.depth,Ne.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(Ne.empty,!0);n.childCount&&(this.placed=iu(this.placed,this.frontier.length,n))}}function su(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(su(t.firstChild.content,e-1,n)))}function iu(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(iu(t.lastChild.content,e-1,n)))}function K0(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function J3(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,J3(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(Ne.empty,!0)))),t.copy(r)}function Q0(t,e,n,r,s){let i=t.node(e),o=s?t.indexAfter(e):t.index(e);if(o==i.childCount&&!n.compatibleContent(i.type))return null;let l=r.fillBefore(i.content,!0,o);return l&&!aF(n,i.content,o)?l:null}function aF(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function oF(t){return t.spec.defining||t.spec.definingForContent}function lF(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let s=t.doc.resolve(e),i=t.doc.resolve(n);if(X3(s,i,r))return t.step(new un(e,n,r));let o=eM(s,i);o[o.length-1]==0&&o.pop();let l=-(s.depth+1);o.unshift(l);for(let y=s.depth,m=s.pos-1;y>0;y--,m--){let b=s.node(y).type.spec;if(b.defining||b.definingAsContext||b.isolating)break;o.indexOf(y)>-1?l=y:s.before(y)==m&&o.splice(1,0,-y)}let d=o.indexOf(l),f=[],p=r.openStart;for(let y=r.content,m=0;;m++){let b=y.firstChild;if(f.push(b),m==r.openStart)break;y=b.content}for(let y=p-1;y>=0;y--){let m=f[y],b=oF(m.type);if(b&&!m.sameMarkup(s.node(Math.abs(l)-1)))p=y;else if(b||!m.type.isTextblock)break}for(let y=r.openStart;y>=0;y--){let m=(y+p+1)%(r.openStart+1),b=f[m];if(b)for(let v=0;v<o.length;v++){let w=o[(v+d)%o.length],S=!0;w<0&&(S=!1,w=-w);let T=s.node(w-1),j=s.index(w-1);if(T.canReplaceWith(j,j,b.type,b.marks))return t.replace(s.before(w),S?i.after(w):n,new Ae(Z3(r.content,0,r.openStart,m),m,r.openEnd))}}let g=t.steps.length;for(let y=o.length-1;y>=0&&(t.replace(e,n,r),!(t.steps.length>g));y--){let m=o[y];m<0||(e=s.before(m),n=i.after(m))}}function Z3(t,e,n,r,s){if(e<n){let i=t.firstChild;t=t.replaceChild(0,i.copy(Z3(i.content,e+1,n,r,i)))}if(e>r){let i=s.contentMatchAt(0),o=i.fillBefore(t).append(t);t=o.append(i.matchFragment(o).fillBefore(Ne.empty,!0))}return t}function cF(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let s=sF(t.doc,e,r.type);s!=null&&(e=n=s)}t.replaceRange(e,n,new Ae(Ne.from(r),0,0))}function uF(t,e,n){let r=t.doc.resolve(e),s=t.doc.resolve(n),i=eM(r,s);for(let o=0;o<i.length;o++){let l=i[o],d=o==i.length-1;if(d&&l==0||r.node(l).type.contentMatch.validEnd)return t.delete(r.start(l),s.end(l));if(l>0&&(d||r.node(l-1).canReplace(r.index(l-1),s.indexAfter(l-1))))return t.delete(r.before(l),s.after(l))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(e-r.start(o)==r.depth-o&&n>r.end(o)&&s.end(o)-n!=s.depth-o&&r.start(o-1)==s.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),s.index(o-1)))return t.delete(r.before(o),n);t.delete(e,n)}function eM(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let s=r;s>=0;s--){let i=t.start(s);if(i<t.pos-(t.depth-s)||e.end(s)>e.pos+(e.depth-s)||t.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(i==e.start(s)||s==t.depth&&s==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==i-1)&&n.push(s)}return n}class Ol extends _n{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return Gt.fail("No node at attribute step's position");let r=Object.create(null);for(let i in n.attrs)r[i]=n.attrs[i];r[this.attr]=this.value;let s=n.type.create(r,null,n.marks);return Gt.fromReplace(e,this.pos,this.pos+1,new Ae(Ne.from(s),0,n.isLeaf?0:1))}getMap(){return vr.empty}invert(e){return new Ol(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Ol(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ol(n.pos,n.attr,n.value)}}_n.jsonID("attr",Ol);class qu extends _n{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let s in e.attrs)n[s]=e.attrs[s];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return Gt.ok(r)}getMap(){return vr.empty}invert(e){return new qu(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new qu(n.attr,n.value)}}_n.jsonID("docAttr",qu);let Fl=class extends Error{};Fl=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};Fl.prototype=Object.create(Error.prototype);Fl.prototype.constructor=Fl;Fl.prototype.name="TransformError";class tM{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new $u}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Fl(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=Ae.empty){let s=Wp(this.doc,e,n,r);return s&&this.step(s),this}replaceWith(e,n,r){return this.replace(e,n,new Ae(Ne.from(r),0,0))}delete(e,n){return this.replace(e,n,Ae.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return lF(this,e,n,r),this}replaceRangeWith(e,n,r){return cF(this,e,n,r),this}deleteRange(e,n){return uF(this,e,n),this}lift(e,n){return WB(this,e,n),this}join(e,n=1){return rF(this,e,n),this}wrap(e,n){return XB(this,e,n),this}setBlockType(e,n=e,r,s=null){return JB(this,e,n,r,s),this}setNodeMarkup(e,n,r=null,s){return eF(this,e,n,r,s),this}setNodeAttribute(e,n,r){return this.step(new Ol(e,n,r)),this}setDocAttribute(e,n){return this.step(new qu(e,n)),this}addNodeMark(e,n){return this.step(new Zi(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof kt)n.isInSet(r.marks)&&this.step(new ro(e,n));else{let s=r.marks,i,o=[];for(;i=n.isInSet(s);)o.push(new ro(e,i)),s=i.removeFromSet(s);for(let l=o.length-1;l>=0;l--)this.step(o[l])}return this}split(e,n=1,r){return tF(this,e,n,r),this}addMark(e,n,r){return VB(this,e,n,r),this}removeMark(e,n,r){return KB(this,e,n,r),this}clearIncompatible(e,n,r){return rv(this,e,n,r),this}}const W0=Object.create(null);class Ge{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new dF(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=Ae.empty){let r=n.content.lastChild,s=null;for(let l=0;l<n.openEnd;l++)s=r,r=r.lastChild;let i=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:d,$to:f}=o[l],p=e.mapping.slice(i);e.replaceRange(p.map(d.pos),p.map(f.pos),l?Ae.empty:n),l==0&&HC(e,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:o,$to:l}=s[i],d=e.mapping.slice(r),f=d.map(o.pos),p=d.map(l.pos);i?e.deleteRange(f,p):(e.replaceRangeWith(f,p,n),HC(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let s=e.parent.inlineContent?new qe(e):jl(e.node(0),e.parent,e.pos,e.index(),n,r);if(s)return s;for(let i=e.depth-1;i>=0;i--){let o=n<0?jl(e.node(0),e.node(i),e.before(i+1),e.index(i),n,r):jl(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,n,r);if(o)return o}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new Sr(e.node(0))}static atStart(e){return jl(e,e,0,0,1)||new Sr(e)}static atEnd(e){return jl(e,e,e.content.size,e.childCount,-1)||new Sr(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=W0[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in W0)throw new RangeError("Duplicate use of selection JSON ID "+e);return W0[e]=n,n.prototype.jsonID=e,n}getBookmark(){return qe.between(this.$anchor,this.$head).getBookmark()}}Ge.prototype.visible=!0;class dF{constructor(e,n){this.$from=e,this.$to=n}}let $C=!1;function qC(t){!$C&&!t.parent.inlineContent&&($C=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class qe extends Ge{constructor(e,n=e){qC(e),qC(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return Ge.near(r);let s=e.resolve(n.map(this.anchor));return new qe(s.parent.inlineContent?s:r,r)}replace(e,n=Ae.empty){if(super.replace(e,n),n==Ae.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof qe&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Yp(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new qe(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let s=e.resolve(n);return new this(s,r==n?s:e.resolve(r))}static between(e,n,r){let s=e.pos-n.pos;if((!r||s)&&(r=s>=0?1:-1),!n.parent.inlineContent){let i=Ge.findFrom(n,r,!0)||Ge.findFrom(n,-r,!0);if(i)n=i.$head;else return Ge.near(n,r)}return e.parent.inlineContent||(s==0?e=n:(e=(Ge.findFrom(e,-r,!0)||Ge.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=s<0&&(e=n))),new qe(e,n)}}Ge.jsonID("text",qe);class Yp{constructor(e,n){this.anchor=e,this.head=n}map(e){return new Yp(e.map(this.anchor),e.map(this.head))}resolve(e){return qe.between(e.resolve(this.anchor),e.resolve(this.head))}}class Be extends Ge{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:s}=n.mapResult(this.anchor),i=e.resolve(s);return r?Ge.near(i):new Be(i)}content(){return new Ae(Ne.from(this.node),0,0)}eq(e){return e instanceof Be&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new iv(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Be(e.resolve(n.anchor))}static create(e,n){return new Be(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}Be.prototype.visible=!1;Ge.jsonID("node",Be);class iv{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new Yp(r,r):new iv(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&Be.isSelectable(r)?new Be(n):Ge.near(n)}}class Sr extends Ge{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=Ae.empty){if(n==Ae.empty){e.delete(0,e.doc.content.size);let r=Ge.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new Sr(e)}map(e){return new Sr(e)}eq(e){return e instanceof Sr}getBookmark(){return fF}}Ge.jsonID("all",Sr);const fF={map(){return this},resolve(t){return new Sr(t)}};function jl(t,e,n,r,s,i=!1){if(e.inlineContent)return qe.create(t,n);for(let o=r-(s>0?0:1);s>0?o<e.childCount:o>=0;o+=s){let l=e.child(o);if(l.isAtom){if(!i&&Be.isSelectable(l))return Be.create(t,n-(s<0?l.nodeSize:0))}else{let d=jl(t,l,n+s,s<0?l.childCount:0,s,i);if(d)return d}n+=l.nodeSize*s}return null}function HC(t,e,n){let r=t.steps.length-1;if(r<e)return;let s=t.steps[r];if(!(s instanceof un||s instanceof fn))return;let i=t.mapping.maps[r],o;i.forEach((l,d,f,p)=>{o==null&&(o=p)}),t.setSelection(Ge.near(t.doc.resolve(o),n))}const VC=1,Vf=2,KC=4;class hF extends tM{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|VC)&~Vf,this.storedMarks=null,this}get selectionSet(){return(this.updated&VC)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Vf,this}ensureMarks(e){return kt.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Vf)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Vf,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||kt.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let s=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),!e)return this.deleteRange(n,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(n);i=r==n?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,s.text(e,i)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(Ge.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=KC,this}get scrolledIntoView(){return(this.updated&KC)>0}}function QC(t,e){return!e||!t?t:t.bind(e)}class au{constructor(e,n,r){this.name=e,this.init=QC(n.init,r),this.apply=QC(n.apply,r)}}const pF=[new au("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new au("selection",{init(t,e){return t.selection||Ge.atStart(e.doc)},apply(t){return t.selection}}),new au("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new au("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Y0{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=pF.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new au(r.key,r.spec.state,r))})}}class Rl{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),s=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let d=s?s[o].n:0,f=s?s[o].state:this,p=d<n.length&&l.spec.appendTransaction.call(l,d?n.slice(d):n,f,r);if(p&&r.filterTransaction(p,o)){if(p.setMeta("appendedTransaction",e),!s){s=[];for(let g=0;g<this.config.plugins.length;g++)s.push(g<o?{state:r,n:n.length}:{state:this,n:0})}n.push(p),r=r.applyInner(p),i=!0}s&&(s[o]={state:r,n:n.length})}}if(!i)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new Rl(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];n[i.name]=i.apply(e,this[i.name],this,n)}return n}get tr(){return new hF(this)}static create(e){let n=new Y0(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Rl(n);for(let s=0;s<n.fields.length;s++)r[n.fields[s].name]=n.fields[s].init(e,r);return r}reconfigure(e){let n=new Y0(this.schema,e.plugins),r=n.fields,s=new Rl(n);for(let i=0;i<r.length;i++){let o=r[i].name;s[o]=this.hasOwnProperty(o)?this[o]:r[i].init(e,s)}return s}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],i=s.spec.state;i&&i.toJSON&&(n[r]=i.toJSON.call(s,this[s.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new Y0(e.schema,e.plugins),i=new Rl(s);return s.fields.forEach(o=>{if(o.name=="doc")i.doc=aa.fromJSON(e.schema,n.doc);else if(o.name=="selection")i.selection=Ge.fromJSON(i.doc,n.selection);else if(o.name=="storedMarks")n.storedMarks&&(i.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let d=r[l],f=d.spec.state;if(d.key==o.name&&f&&f.fromJSON&&Object.prototype.hasOwnProperty.call(n,l)){i[o.name]=f.fromJSON.call(d,e,n[l],i);return}}i[o.name]=o.init(e,i)}}),i}}function nM(t,e,n){for(let r in t){let s=t[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=nM(s,e,{})),n[r]=s}return n}class _t{constructor(e){this.spec=e,this.props={},e.props&&nM(e.props,this,this.props),this.key=e.key?e.key.key:rM("plugin")}getState(e){return e[this.key]}}const G0=Object.create(null);function rM(t){return t in G0?t+"$"+ ++G0[t]:(G0[t]=0,t+"$")}class sn{constructor(e="key"){this.key=rM(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const av=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function sM(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const iM=(t,e,n)=>{let r=sM(t,n);if(!r)return!1;let s=ov(r);if(!s){let o=r.blockRange(),l=o&&nc(o);return l==null?!1:(e&&e(t.tr.lift(o,l).scrollIntoView()),!0)}let i=s.nodeBefore;if(pM(t,s,e,-1))return!0;if(r.parent.content.size==0&&(Ul(i,"end")||Be.isSelectable(i)))for(let o=r.depth;;o--){let l=Wp(t.doc,r.before(o),r.after(o),Ae.empty);if(l&&l.slice.size<l.to-l.from){if(e){let d=t.tr.step(l);d.setSelection(Ul(i,"end")?Ge.findFrom(d.doc.resolve(d.mapping.map(s.pos,-1)),-1):Be.create(d.doc,s.pos-i.nodeSize)),e(d.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return i.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1},gF=(t,e,n)=>{let r=sM(t,n);if(!r)return!1;let s=ov(r);return s?aM(t,s,e):!1},mF=(t,e,n)=>{let r=lM(t,n);if(!r)return!1;let s=lv(r);return s?aM(t,s,e):!1};function aM(t,e,n){let r=e.nodeBefore,s=r,i=e.pos-1;for(;!s.isTextblock;i--){if(s.type.spec.isolating)return!1;let p=s.lastChild;if(!p)return!1;s=p}let o=e.nodeAfter,l=o,d=e.pos+1;for(;!l.isTextblock;d++){if(l.type.spec.isolating)return!1;let p=l.firstChild;if(!p)return!1;l=p}let f=Wp(t.doc,i,d,Ae.empty);if(!f||f.from!=i||f instanceof un&&f.slice.size>=d-i)return!1;if(n){let p=t.tr.step(f);p.setSelection(qe.create(p.doc,i)),n(p.scrollIntoView())}return!0}function Ul(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const oM=(t,e,n)=>{let{$head:r,empty:s}=t.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;i=ov(r)}let o=i&&i.nodeBefore;return!o||!Be.isSelectable(o)?!1:(e&&e(t.tr.setSelection(Be.create(t.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function ov(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function lM(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const cM=(t,e,n)=>{let r=lM(t,n);if(!r)return!1;let s=lv(r);if(!s)return!1;let i=s.nodeAfter;if(pM(t,s,e,1))return!0;if(r.parent.content.size==0&&(Ul(i,"start")||Be.isSelectable(i))){let o=Wp(t.doc,r.before(),r.after(),Ae.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(Ul(i,"start")?Ge.findFrom(l.doc.resolve(l.mapping.map(s.pos)),1):Be.create(l.doc,l.mapping.map(s.pos))),e(l.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},uM=(t,e,n)=>{let{$head:r,empty:s}=t.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;i=lv(r)}let o=i&&i.nodeAfter;return!o||!Be.isSelectable(o)?!1:(e&&e(t.tr.setSelection(Be.create(t.doc,i.pos)).scrollIntoView()),!0)};function lv(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const yF=(t,e)=>{let n=t.selection,r=n instanceof Be,s;if(r){if(n.node.isTextblock||!pa(t.doc,n.from))return!1;s=n.from}else if(s=Qp(t.doc,n.from,-1),s==null)return!1;if(e){let i=t.tr.join(s);r&&i.setSelection(Be.create(i.doc,s-t.doc.resolve(s).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},xF=(t,e)=>{let n=t.selection,r;if(n instanceof Be){if(n.node.isTextblock||!pa(t.doc,n.to))return!1;r=n.to}else if(r=Qp(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},bF=(t,e)=>{let{$from:n,$to:r}=t.selection,s=n.blockRange(r),i=s&&nc(s);return i==null?!1:(e&&e(t.tr.lift(s,i).scrollIntoView()),!0)},dM=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function cv(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const vF=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let s=n.node(-1),i=n.indexAfter(-1),o=cv(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(e){let l=n.after(),d=t.tr.replaceWith(l,l,o.createAndFill());d.setSelection(Ge.near(d.doc.resolve(l),1)),e(d.scrollIntoView())}return!0},fM=(t,e)=>{let n=t.selection,{$from:r,$to:s}=n;if(n instanceof Sr||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=cv(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,l=t.tr.insert(o,i.createAndFill());l.setSelection(qe.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},hM=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let i=n.before();if(oi(t.doc,i))return e&&e(t.tr.split(i).scrollIntoView()),!0}let r=n.blockRange(),s=r&&nc(r);return s==null?!1:(e&&e(t.tr.lift(r,s).scrollIntoView()),!0)};function wF(t){return(e,n)=>{let{$from:r,$to:s}=e.selection;if(e.selection instanceof Be&&e.selection.node.isBlock)return!r.parentOffset||!oi(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let i=[],o,l,d=!1,f=!1;for(let m=r.depth;;m--)if(r.node(m).isBlock){d=r.end(m)==r.pos+(r.depth-m),f=r.start(m)==r.pos-(r.depth-m),l=cv(r.node(m-1).contentMatchAt(r.indexAfter(m-1))),i.unshift(d&&l?{type:l}:null),o=m;break}else{if(m==1)return!1;i.unshift(null)}let p=e.tr;(e.selection instanceof qe||e.selection instanceof Sr)&&p.deleteSelection();let g=p.mapping.map(r.pos),y=oi(p.doc,g,i.length,i);if(y||(i[0]=l?{type:l}:null,y=oi(p.doc,g,i.length,i)),!y)return!1;if(p.split(g,i.length,i),!d&&f&&r.node(o).type!=l){let m=p.mapping.map(r.before(o)),b=p.doc.resolve(m);l&&r.node(o-1).canReplaceWith(b.index(),b.index()+1,l)&&p.setNodeMarkup(p.mapping.map(r.before(o)),l)}return n&&n(p.scrollIntoView()),!0}}const SF=wF(),kF=(t,e)=>{let{$from:n,to:r}=t.selection,s,i=n.sharedDepth(r);return i==0?!1:(s=n.before(i),e&&e(t.tr.setSelection(Be.create(t.doc,s))),!0)};function CF(t,e,n){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(s.isTextblock||pa(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function pM(t,e,n,r){let s=e.nodeBefore,i=e.nodeAfter,o,l,d=s.type.spec.isolating||i.type.spec.isolating;if(!d&&CF(t,e,n))return!0;let f=!d&&e.parent.canReplace(e.index(),e.index()+1);if(f&&(o=(l=s.contentMatchAt(s.childCount)).findWrapping(i.type))&&l.matchType(o[0]||i.type).validEnd){if(n){let m=e.pos+i.nodeSize,b=Ne.empty;for(let S=o.length-1;S>=0;S--)b=Ne.from(o[S].create(null,b));b=Ne.from(s.copy(b));let v=t.tr.step(new fn(e.pos-1,m,e.pos,m,new Ae(b,1,0),o.length,!0)),w=v.doc.resolve(m+2*o.length);w.nodeAfter&&w.nodeAfter.type==s.type&&pa(v.doc,w.pos)&&v.join(w.pos),n(v.scrollIntoView())}return!0}let p=i.type.spec.isolating||r>0&&d?null:Ge.findFrom(e,1),g=p&&p.$from.blockRange(p.$to),y=g&&nc(g);if(y!=null&&y>=e.depth)return n&&n(t.tr.lift(g,y).scrollIntoView()),!0;if(f&&Ul(i,"start",!0)&&Ul(s,"end")){let m=s,b=[];for(;b.push(m),!m.isTextblock;)m=m.lastChild;let v=i,w=1;for(;!v.isTextblock;v=v.firstChild)w++;if(m.canReplace(m.childCount,m.childCount,v.content)){if(n){let S=Ne.empty;for(let j=b.length-1;j>=0;j--)S=Ne.from(b[j].copy(S));let T=t.tr.step(new fn(e.pos-b.length,e.pos+i.nodeSize,e.pos+w,e.pos+i.nodeSize-w,new Ae(S,b.length,0),0,!0));n(T.scrollIntoView())}return!0}}return!1}function gM(t){return function(e,n){let r=e.selection,s=t<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(n&&n(e.tr.setSelection(qe.create(e.doc,t<0?s.start(i):s.end(i)))),!0):!1}}const NF=gM(-1),TF=gM(1);function jF(t,e=null){return function(n,r){let{$from:s,$to:i}=n.selection,o=s.blockRange(i),l=o&&sv(o,t,e);return l?(r&&r(n.tr.wrap(o,l).scrollIntoView()),!0):!1}}function WC(t,e=null){return function(n,r){let s=!1;for(let i=0;i<n.selection.ranges.length&&!s;i++){let{$from:{pos:o},$to:{pos:l}}=n.selection.ranges[i];n.doc.nodesBetween(o,l,(d,f)=>{if(s)return!1;if(!(!d.isTextblock||d.hasMarkup(t,e)))if(d.type==t)s=!0;else{let p=n.doc.resolve(f),g=p.index();s=p.parent.canReplaceWith(g,g+1,t)}})}if(!s)return!1;if(r){let i=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:d}}=n.selection.ranges[o];i.setBlockType(l,d,t,e)}r(i.scrollIntoView())}return!0}}function uv(...t){return function(e,n,r){for(let s=0;s<t.length;s++)if(t[s](e,n,r))return!0;return!1}}uv(av,iM,oM);uv(av,cM,uM);uv(dM,fM,hM,SF);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function EF(t,e=null){return function(n,r){let{$from:s,$to:i}=n.selection,o=s.blockRange(i);if(!o)return!1;let l=r?n.tr:null;return MF(l,o,t,e)?(r&&r(l.scrollIntoView()),!0):!1}}function MF(t,e,n,r=null){let s=!1,i=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let d=o.resolve(e.start-2);i=new zh(d,d,e.depth),e.endIndex<e.parent.childCount&&(e=new zh(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let l=sv(i,n,r,e);return l?(t&&AF(t,e,l,s,n),!0):!1}function AF(t,e,n,r,s){let i=Ne.empty;for(let p=n.length-1;p>=0;p--)i=Ne.from(n[p].type.create(n[p].attrs,i));t.step(new fn(e.start-(r?2:0),e.end,e.start,e.end,new Ae(i,0,0),n.length,!0));let o=0;for(let p=0;p<n.length;p++)n[p].type==s&&(o=p+1);let l=n.length-o,d=e.start+n.length-(r?2:0),f=e.parent;for(let p=e.startIndex,g=e.endIndex,y=!0;p<g;p++,y=!1)!y&&oi(t.doc,d,l)&&(t.split(d,l),d+=2*l),d+=f.child(p).nodeSize;return t}function RF(t){return function(e,n){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==t);return i?n?r.node(i.depth-1).type==t?_F(e,n,t,i):OF(e,n,i):!0:!1}}function _F(t,e,n,r){let s=t.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new fn(i-1,o,i,o,new Ae(Ne.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new zh(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const l=nc(r);if(l==null)return!1;s.lift(r,l);let d=s.doc.resolve(s.mapping.map(i,-1)-1);return pa(s.doc,d.pos)&&d.nodeBefore.type==d.nodeAfter.type&&s.join(d.pos),e(s.scrollIntoView()),!0}function OF(t,e,n){let r=t.tr,s=n.parent;for(let m=n.end,b=n.endIndex-1,v=n.startIndex;b>v;b--)m-=s.child(b).nodeSize,r.delete(m-1,m+1);let i=r.doc.resolve(n.start),o=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let l=n.startIndex==0,d=n.endIndex==s.childCount,f=i.node(-1),p=i.index(-1);if(!f.canReplace(p+(l?0:1),p+1,o.content.append(d?Ne.empty:Ne.from(s))))return!1;let g=i.pos,y=g+o.nodeSize;return r.step(new fn(g-(l?1:0),y+(d?1:0),g+1,y-1,new Ae((l?Ne.empty:Ne.from(s.copy(Ne.empty))).append(d?Ne.empty:Ne.from(s.copy(Ne.empty))),l?0:1,d?0:1),l?0:1)),e(r.scrollIntoView()),!0}function DF(t){return function(e,n){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,f=>f.childCount>0&&f.firstChild.type==t);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let l=i.parent,d=l.child(o-1);if(d.type!=t)return!1;if(n){let f=d.lastChild&&d.lastChild.type==l.type,p=Ne.from(f?t.create():null),g=new Ae(Ne.from(t.create(null,Ne.from(l.type.create(null,p)))),f?3:1,0),y=i.start,m=i.end;n(e.tr.step(new fn(y-(f?3:1),m,y,m,g,1,!0)).scrollIntoView())}return!0}}const wn=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},$l=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Ax=null;const ri=function(t,e,n){let r=Ax||(Ax=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},IF=function(){Ax=null},so=function(t,e,n,r){return n&&(YC(t,e,n,r,-1)||YC(t,e,n,r,1))},LF=/^(img|br|input|textarea|hr)$/i;function YC(t,e,n,r,s){for(var i;;){if(t==n&&e==r)return!0;if(e==(s<0?0:Yr(t))){let o=t.parentNode;if(!o||o.nodeType!=1||od(t)||LF.test(t.nodeName)||t.contentEditable=="false")return!1;e=wn(t)+(s<0?0:1),t=o}else if(t.nodeType==1){let o=t.childNodes[e+(s<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((i=o.pmViewDesc)===null||i===void 0)&&i.ignoreForSelection)e+=s;else return!1;else t=o,e=s<0?Yr(t):0}else return!1}}function Yr(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function zF(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Yr(t)}else if(t.parentNode&&!od(t))e=wn(t),t=t.parentNode;else return null}}function PF(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!od(t))e=wn(t)+1,t=t.parentNode;else return null}}function BF(t,e,n){for(let r=e==0,s=e==Yr(t);r||s;){if(t==n)return!0;let i=wn(t);if(t=t.parentNode,!t)return!1;r=r&&i==0,s=s&&i==Yr(t)}}function od(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Gp=function(t){return t.focusNode&&so(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Ia(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function FF(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function UF(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Yr(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Yr(r.startContainer),r.startOffset)}}}const Ts=typeof navigator<"u"?navigator:null,GC=typeof document<"u"?document:null,ga=Ts&&Ts.userAgent||"",Rx=/Edge\/(\d+)/.exec(ga),mM=/MSIE \d/.exec(ga),_x=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ga),rr=!!(mM||_x||Rx),oa=mM?document.documentMode:_x?+_x[1]:Rx?+Rx[1]:0,Gr=!rr&&/gecko\/(\d+)/i.test(ga);Gr&&+(/Firefox\/(\d+)/.exec(ga)||[0,0])[1];const Ox=!rr&&/Chrome\/(\d+)/.exec(ga),An=!!Ox,yM=Ox?+Ox[1]:0,Fn=!rr&&!!Ts&&/Apple Computer/.test(Ts.vendor),ql=Fn&&(/Mobile\/\w+/.test(ga)||!!Ts&&Ts.maxTouchPoints>2),Qr=ql||(Ts?/Mac/.test(Ts.platform):!1),$F=Ts?/Win/.test(Ts.platform):!1,ii=/Android \d/.test(ga),ld=!!GC&&"webkitFontSmoothing"in GC.documentElement.style,qF=ld?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function HF(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Zs(t,e){return typeof t=="number"?t:t[e]}function VF(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function XC(t,e,n){let r=t.someProp("scrollThreshold")||0,s=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument;for(let o=n||t.dom;o;){if(o.nodeType!=1){o=$l(o);continue}let l=o,d=l==i.body,f=d?HF(i):VF(l),p=0,g=0;if(e.top<f.top+Zs(r,"top")?g=-(f.top-e.top+Zs(s,"top")):e.bottom>f.bottom-Zs(r,"bottom")&&(g=e.bottom-e.top>f.bottom-f.top?e.top+Zs(s,"top")-f.top:e.bottom-f.bottom+Zs(s,"bottom")),e.left<f.left+Zs(r,"left")?p=-(f.left-e.left+Zs(s,"left")):e.right>f.right-Zs(r,"right")&&(p=e.right-f.right+Zs(s,"right")),p||g)if(d)i.defaultView.scrollBy(p,g);else{let m=l.scrollLeft,b=l.scrollTop;g&&(l.scrollTop+=g),p&&(l.scrollLeft+=p);let v=l.scrollLeft-m,w=l.scrollTop-b;e={left:e.left-v,top:e.top-w,right:e.right-v,bottom:e.bottom-w}}let y=d?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(y))break;o=y=="absolute"?o.offsetParent:$l(o)}}function KF(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,s;for(let i=(e.left+e.right)/2,o=n+1;o<Math.min(innerHeight,e.bottom);o+=5){let l=t.root.elementFromPoint(i,o);if(!l||l==t.dom||!t.dom.contains(l))continue;let d=l.getBoundingClientRect();if(d.top>=n-20){r=l,s=d.top;break}}return{refDOM:r,refTop:s,stack:xM(t.dom)}}function xM(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=$l(r));return e}function QF({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;bM(n,r==0?0:r-e)}function bM(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:s,left:i}=t[n];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let hl=null;function WF(t){if(t.setActive)return t.setActive();if(hl)return t.focus(hl);let e=xM(t);t.focus(hl==null?{get preventScroll(){return hl={preventScroll:!0},!0}}:void 0),hl||(hl=!1,bM(e,0))}function vM(t,e){let n,r=2e8,s,i=0,o=e.top,l=e.top,d,f;for(let p=t.firstChild,g=0;p;p=p.nextSibling,g++){let y;if(p.nodeType==1)y=p.getClientRects();else if(p.nodeType==3)y=ri(p).getClientRects();else continue;for(let m=0;m<y.length;m++){let b=y[m];if(b.top<=o&&b.bottom>=l){o=Math.max(b.bottom,o),l=Math.min(b.top,l);let v=b.left>e.left?b.left-e.left:b.right<e.left?e.left-b.right:0;if(v<r){n=p,r=v,s=v&&n.nodeType==3?{left:b.right<e.left?b.right:b.left,top:e.top}:e,p.nodeType==1&&v&&(i=g+(e.left>=(b.left+b.right)/2?1:0));continue}}else b.top>e.top&&!d&&b.left<=e.left&&b.right>=e.left&&(d=p,f={left:Math.max(b.left,Math.min(b.right,e.left)),top:b.top});!n&&(e.left>=b.right&&e.top>=b.top||e.left>=b.left&&e.top>=b.bottom)&&(i=g+1)}}return!n&&d&&(n=d,s=f,r=0),n&&n.nodeType==3?YF(n,s):!n||r&&n.nodeType==1?{node:t,offset:i}:vM(n,s)}function YF(t,e){let n=t.nodeValue.length,r=document.createRange();for(let s=0;s<n;s++){r.setEnd(t,s+1),r.setStart(t,s);let i=qi(r,1);if(i.top!=i.bottom&&dv(e,i))return{node:t,offset:s+(e.left>=(i.left+i.right)/2?1:0)}}return{node:t,offset:0}}function dv(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function GF(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function XF(t,e,n){let{node:r,offset:s}=vM(e,n),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&n.left>(o.left+o.right)/2?1:-1}return t.docView.posFromDOM(r,s,i)}function JF(t,e,n,r){let s=-1;for(let i=e,o=!1;i!=t.dom;){let l=t.docView.nearestDesc(i,!0),d;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((d=l.dom.getBoundingClientRect()).width||d.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!o&&d.left>r.left||d.top>r.top?s=l.posBefore:(!o&&d.right<r.left||d.bottom<r.top)&&(s=l.posAfter),o=!0),!l.contentDOM&&s<0&&!l.node.isText))return(l.node.isBlock?r.top<(d.top+d.bottom)/2:r.left<(d.left+d.right)/2)?l.posBefore:l.posAfter;i=l.dom.parentNode}return s>-1?s:t.docView.posFromDOM(e,n,-1)}function wM(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=s;;){let o=t.childNodes[i];if(o.nodeType==1){let l=o.getClientRects();for(let d=0;d<l.length;d++){let f=l[d];if(dv(e,f))return wM(o,e,f)}}if((i=(i+1)%r)==s)break}return t}function ZF(t,e){let n=t.dom.ownerDocument,r,s=0,i=UF(n,e.left,e.top);i&&({node:r,offset:s}=i);let o=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),l;if(!o||!t.dom.contains(o.nodeType!=1?o.parentNode:o)){let f=t.dom.getBoundingClientRect();if(!dv(e,f)||(o=wM(t.dom,e,f),!o))return null}if(Fn)for(let f=o;r&&f;f=$l(f))f.draggable&&(r=void 0);if(o=GF(o,e),r){if(Gr&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let p=r.childNodes[s],g;p.nodeName=="IMG"&&(g=p.getBoundingClientRect()).right<=e.left&&g.bottom>e.top&&s++}let f;ld&&s&&r.nodeType==1&&(f=r.childNodes[s-1]).nodeType==1&&f.contentEditable=="false"&&f.getBoundingClientRect().top>=e.top&&s--,r==t.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=t.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(l=JF(t,r,s,e))}l==null&&(l=XF(t,o,e));let d=t.docView.nearestDesc(o,!0);return{pos:l,inside:d?d.posAtStart-d.border:-1}}function JC(t){return t.top<t.bottom||t.left<t.right}function qi(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(JC(r))return r}return Array.prototype.find.call(n,JC)||t.getBoundingClientRect()}const e9=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function SM(t,e,n){let{node:r,offset:s,atom:i}=t.docView.domFromPos(e,n<0?-1:1),o=ld||Gr;if(r.nodeType==3)if(o&&(e9.test(r.nodeValue)||(n<0?!s:s==r.nodeValue.length))){let d=qi(ri(r,s,s),n);if(Gr&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let f=qi(ri(r,s-1,s-1),-1);if(f.top==d.top){let p=qi(ri(r,s,s+1),-1);if(p.top!=d.top)return eu(p,p.left<f.left)}}return d}else{let d=s,f=s,p=n<0?1:-1;return n<0&&!s?(f++,p=-1):n>=0&&s==r.nodeValue.length?(d--,p=1):n<0?d--:f++,eu(qi(ri(r,d,f),p),p<0)}if(!t.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&s&&(n<0||s==Yr(r))){let d=r.childNodes[s-1];if(d.nodeType==1)return X0(d.getBoundingClientRect(),!1)}if(i==null&&s<Yr(r)){let d=r.childNodes[s];if(d.nodeType==1)return X0(d.getBoundingClientRect(),!0)}return X0(r.getBoundingClientRect(),n>=0)}if(i==null&&s&&(n<0||s==Yr(r))){let d=r.childNodes[s-1],f=d.nodeType==3?ri(d,Yr(d)-(o?0:1)):d.nodeType==1&&(d.nodeName!="BR"||!d.nextSibling)?d:null;if(f)return eu(qi(f,1),!1)}if(i==null&&s<Yr(r)){let d=r.childNodes[s];for(;d.pmViewDesc&&d.pmViewDesc.ignoreForCoords;)d=d.nextSibling;let f=d?d.nodeType==3?ri(d,0,o?0:1):d.nodeType==1?d:null:null;if(f)return eu(qi(f,-1),!0)}return eu(qi(r.nodeType==3?ri(r):r,-n),n>=0)}function eu(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function X0(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function kM(t,e,n){let r=t.state,s=t.root.activeElement;r!=e&&t.updateState(e),s!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),s!=t.dom&&s&&s.focus()}}function t9(t,e,n){let r=e.selection,s=n=="up"?r.$from:r.$to;return kM(t,e,()=>{let{node:i}=t.docView.domFromPos(s.pos,n=="up"?-1:1);for(;;){let l=t.docView.nearestDesc(i,!0);if(!l)break;if(l.node.isBlock){i=l.contentDOM||l.dom;break}i=l.dom.parentNode}let o=SM(t,s.pos,1);for(let l=i.firstChild;l;l=l.nextSibling){let d;if(l.nodeType==1)d=l.getClientRects();else if(l.nodeType==3)d=ri(l,0,l.nodeValue.length).getClientRects();else continue;for(let f=0;f<d.length;f++){let p=d[f];if(p.bottom>p.top+1&&(n=="up"?o.top-p.top>(p.bottom-o.top)*2:p.bottom-o.bottom>(o.bottom-p.top)*2))return!1}}return!0})}const n9=/[\u0590-\u08ac]/;function r9(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,o=s==r.parent.content.size,l=t.domSelection();return l?!n9.test(r.parent.textContent)||!l.modify?n=="left"||n=="backward"?i:o:kM(t,e,()=>{let{focusNode:d,focusOffset:f,anchorNode:p,anchorOffset:g}=t.domSelectionRange(),y=l.caretBidiLevel;l.modify("move",n,"character");let m=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:b,focusOffset:v}=t.domSelectionRange(),w=b&&!m.contains(b.nodeType==1?b:b.parentNode)||d==b&&f==v;try{l.collapse(p,g),d&&(d!=p||f!=g)&&l.extend&&l.extend(d,f)}catch{}return y!=null&&(l.caretBidiLevel=y),w}):r.pos==r.start()||r.pos==r.end()}let ZC=null,eN=null,tN=!1;function s9(t,e,n){return ZC==e&&eN==n?tN:(ZC=e,eN=n,tN=n=="up"||n=="down"?t9(t,e,n):r9(t,e,n))}const Xr=0,nN=1,za=2,js=3;class cd{constructor(e,n,r,s){this.parent=e,this.children=n,this.dom=r,this.contentDOM=s,this.dirty=Xr,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let s=this.children[n];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,o;if(e==this.contentDOM)i=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=n>wn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&n==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,s=e;s;s=s.parentNode){let i=this.getDesc(s),o;if(i&&(!n||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return i}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let s=e;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let s=this.children[n],i=r+s.size;if(r==e&&i!=r){for(;!s.border&&s.children.length;)for(let o=0;o<s.children.length;o++){let l=s.children[o];if(l.size){s=l;break}}return s}if(e<i)return s.descAt(e-r-s.border);r=i}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],l=i+o.size;if(l>e||o instanceof NM){s=e-i;break}i=l}if(s)return this.children[r].domFromPos(s-this.children[r].border,n);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof CM&&i.side>=0;r--);if(n<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&n&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,n):{node:this.contentDOM,offset:i?wn(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,n):{node:this.contentDOM,offset:i?wn(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let o=r,l=0;;l++){let d=this.children[l],f=o+d.size;if(s==-1&&e<=f){let p=o+d.border;if(e>=p&&n<=f-d.border&&d.node&&d.contentDOM&&this.contentDOM.contains(d.contentDOM))return d.parseRange(e,n,p);e=o;for(let g=l;g>0;g--){let y=this.children[g-1];if(y.size&&y.dom.parentNode==this.contentDOM&&!y.emptyChildAt(1)){s=wn(y.dom)+1;break}e-=y.size}s==-1&&(s=0)}if(s>-1&&(f>n||l==this.children.length-1)){n=f;for(let p=l+1;p<this.children.length;p++){let g=this.children[p];if(g.size&&g.dom.parentNode==this.contentDOM&&!g.emptyChildAt(-1)){i=wn(g.dom);break}n+=g.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=f}return{node:this.contentDOM,from:e,to:n,fromOffset:s,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,s=!1){let i=Math.min(e,n),o=Math.max(e,n);for(let m=0,b=0;m<this.children.length;m++){let v=this.children[m],w=b+v.size;if(i>b&&o<w)return v.setSelection(e-b-v.border,n-b-v.border,r,s);b=w}let l=this.domFromPos(e,e?-1:1),d=n==e?l:this.domFromPos(n,n?-1:1),f=r.root.getSelection(),p=r.domSelectionRange(),g=!1;if((Gr||Fn)&&e==n){let{node:m,offset:b}=l;if(m.nodeType==3){if(g=!!(b&&m.nodeValue[b-1]==`
`),g&&b==m.nodeValue.length)for(let v=m,w;v;v=v.parentNode){if(w=v.nextSibling){w.nodeName=="BR"&&(l=d={node:w.parentNode,offset:wn(w)+1});break}let S=v.pmViewDesc;if(S&&S.node&&S.node.isBlock)break}}else{let v=m.childNodes[b-1];g=v&&(v.nodeName=="BR"||v.contentEditable=="false")}}if(Gr&&p.focusNode&&p.focusNode!=d.node&&p.focusNode.nodeType==1){let m=p.focusNode.childNodes[p.focusOffset];m&&m.contentEditable=="false"&&(s=!0)}if(!(s||g&&Fn)&&so(l.node,l.offset,p.anchorNode,p.anchorOffset)&&so(d.node,d.offset,p.focusNode,p.focusOffset))return;let y=!1;if((f.extend||e==n)&&!(g&&Gr)){f.collapse(l.node,l.offset);try{e!=n&&f.extend(d.node,d.offset),y=!0}catch{}}if(!y){if(e>n){let b=l;l=d,d=b}let m=document.createRange();m.setEnd(d.node,d.offset),m.setStart(l.node,l.offset),f.removeAllRanges(),f.addRange(m)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],o=r+i.size;if(r==o?e<=o&&n>=r:e<o&&n>r){let l=r+i.border,d=o-i.border;if(e>=l&&n<=d){this.dirty=e==r||n==o?za:nN,e==l&&n==d&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=js:i.markDirty(e-l,n-l);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?za:js}r=o}this.dirty=za}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?za:nN;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class CM extends cd{constructor(e,n,r,s){let i,o=n.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!n.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=n,this.widget=n,i=this}matchesWidget(e){return this.dirty==Xr&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class i9 extends cd{constructor(e,n,r,s){super(e,[],n,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class io extends cd{constructor(e,n,r,s,i){super(e,[],r,s),this.mark=n,this.spec=i}static create(e,n,r,s){let i=s.nodeViews[n.type.name],o=i&&i(n,s,r);return(!o||!o.dom)&&(o=vo.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new io(e,n,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&js||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=js&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=Xr){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Xr}}slice(e,n,r){let s=io.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;n<o&&(i=Ix(i,n,o,r)),e>0&&(i=Ix(i,0,e,r));for(let l=0;l<i.length;l++)i[l].parent=s;return s.children=i,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class la extends cd{constructor(e,n,r,s,i,o,l,d,f){super(e,[],i,o),this.node=n,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=l}static create(e,n,r,s,i,o){let l=i.nodeViews[n.type.name],d,f=l&&l(n,i,()=>{if(!d)return o;if(d.parent)return d.parent.posBeforeChild(d)},r,s),p=f&&f.dom,g=f&&f.contentDOM;if(n.isText){if(!p)p=document.createTextNode(n.text);else if(p.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else p||({dom:p,contentDOM:g}=vo.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!g&&!n.isText&&p.nodeName!="BR"&&(p.hasAttribute("contenteditable")||(p.contentEditable="false"),n.type.spec.draggable&&(p.draggable=!0));let y=p;return p=EM(p,r,n),f?d=new a9(e,n,r,s,p,g||null,y,f,i,o+1):n.isText?new Xp(e,n,r,s,p,y,i):new la(e,n,r,s,p,g||null,y,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Ne.empty)}return e}matchesNode(e,n,r){return this.dirty==Xr&&e.eq(this.node)&&Bh(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,s=n,i=e.composing?this.localCompositionInfo(e,n):null,o=i&&i.pos>-1?i:null,l=i&&i.pos<0,d=new l9(this,o&&o.node,e);d9(this.node,this.innerDeco,(f,p,g)=>{f.spec.marks?d.syncToMarks(f.spec.marks,r,e):f.type.side>=0&&!g&&d.syncToMarks(p==this.node.childCount?kt.none:this.node.child(p).marks,r,e),d.placeWidget(f,e,s)},(f,p,g,y)=>{d.syncToMarks(f.marks,r,e);let m;d.findNodeMatch(f,p,g,y)||l&&e.state.selection.from>s&&e.state.selection.to<s+f.nodeSize&&(m=d.findIndexWithChild(i.node))>-1&&d.updateNodeAt(f,p,g,m,e)||d.updateNextNode(f,p,g,e,y,s)||d.addNode(f,p,g,e,s),s+=f.nodeSize}),d.syncToMarks([],r,e),this.node.isTextblock&&d.addTextblockHacks(),d.destroyRest(),(d.changed||this.dirty==za)&&(o&&this.protectLocalComposition(e,o),TM(this.contentDOM,this.children,e),ql&&f9(this.dom))}localCompositionInfo(e,n){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof qe)||r<n||s>n+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,l=h9(this.node.content,o,r-n,s-n);return l<0?null:{node:i,pos:l,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:s}){if(this.getDesc(n))return;let i=n;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new i9(this,i,n,s);e.input.compositionNodes.push(o),this.children=Ix(this.children,r,r+s.length,e,o)}update(e,n,r,s){return this.dirty==js||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,s),!0)}updateInner(e,n,r,s){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=Xr}updateOuterDeco(e){if(Bh(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=jM(this.dom,this.nodeDOM,Dx(this.outerDeco,this.node,n),Dx(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function rN(t,e,n,r,s){EM(r,e,t);let i=new la(void 0,t,e,n,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class Xp extends la{constructor(e,n,r,s,i,o,l){super(e,n,r,s,i,null,o,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,s){return this.dirty==js||this.dirty!=Xr&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=Xr||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=Xr,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let s=this.node.cut(e,n),i=document.createTextNode(s.text);return new Xp(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=js)}get domAtom(){return!1}isText(e){return this.node.text==e}}class NM extends cd{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Xr&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class a9 extends la{constructor(e,n,r,s,i,o,l,d,f,p){super(e,n,r,s,i,o,l,f,p),this.spec=d}update(e,n,r,s){if(this.dirty==js)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,n,r);return i&&this.updateInner(e,n,r,s),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,s){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function TM(t,e,n){let r=t.firstChild,s=!1;for(let i=0;i<e.length;i++){let o=e[i],l=o.dom;if(l.parentNode==t){for(;l!=r;)r=sN(r),s=!0;r=r.nextSibling}else s=!0,t.insertBefore(l,r);if(o instanceof io){let d=r?r.previousSibling:t.lastChild;TM(o.contentDOM,o.children,n),r=d?d.nextSibling:t.firstChild}}for(;r;)r=sN(r),s=!0;s&&n.trackWrites==t&&(n.trackWrites=null)}const Su=function(t){t&&(this.nodeName=t)};Su.prototype=Object.create(null);const Pa=[new Su];function Dx(t,e,n){if(t.length==0)return Pa;let r=n?Pa[0]:new Su,s=[r];for(let i=0;i<t.length;i++){let o=t[i].type.attrs;if(o){o.nodeName&&s.push(r=new Su(o.nodeName));for(let l in o){let d=o[l];d!=null&&(n&&s.length==1&&s.push(r=new Su(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+d:l=="style"?r.style=(r.style?r.style+";":"")+d:l!="nodeName"&&(r[l]=d))}}}return s}function jM(t,e,n,r){if(n==Pa&&r==Pa)return e;let s=e;for(let i=0;i<r.length;i++){let o=r[i],l=n[i];if(i){let d;l&&l.nodeName==o.nodeName&&s!=t&&(d=s.parentNode)&&d.nodeName.toLowerCase()==o.nodeName||(d=document.createElement(o.nodeName),d.pmIsDeco=!0,d.appendChild(s),l=Pa[0]),s=d}o9(s,l||Pa[0],o)}return s}function o9(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=n.class?n.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&t.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&t.classList.add(s[i]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)t.style.removeProperty(s[1])}n.style&&(t.style.cssText+=n.style)}}function EM(t,e,n){return jM(t,t,Pa,Dx(e,n,t.nodeType!=1))}function Bh(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function sN(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class l9{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=c9(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let s=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;s<o&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=Xr,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let d=this.index;d<Math.min(this.index+3,this.top.children.length);d++){let f=this.top.children[d];if(f.matchesMark(e[i])&&!this.isLocked(f.dom)){l=d;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let d=io.create(this.top,e[i],n,r);this.top.children.splice(this.index,0,d),this.top=d,this.changed=!0}this.index=0,i++}}findNodeMatch(e,n,r,s){let i=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(e,n,r))i=this.top.children.indexOf(o,this.index);else for(let l=this.index,d=Math.min(this.top.children.length,l+5);l<d;l++){let f=this.top.children[l];if(f.matchesNode(e,n,r)&&!this.preMatch.matched.has(f)){i=l;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,n,r,s,i){let o=this.top.children[s];return o.dirty==js&&o.dom==o.contentDOM&&(o.dirty=za),o.update(e,n,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=n}}updateNextNode(e,n,r,s,i,o){for(let l=this.index;l<this.top.children.length;l++){let d=this.top.children[l];if(d instanceof la){let f=this.preMatch.matched.get(d);if(f!=null&&f!=i)return!1;let p=d.dom,g,y=this.isLocked(p)&&!(e.isText&&d.node&&d.node.isText&&d.nodeDOM.nodeValue==e.text&&d.dirty!=js&&Bh(n,d.outerDeco));if(!y&&d.update(e,n,r,s))return this.destroyBetween(this.index,l),d.dom!=p&&(this.changed=!0),this.index++,!0;if(!y&&(g=this.recreateWrapper(d,e,n,r,s,o)))return this.destroyBetween(this.index,l),this.top.children[this.index]=g,g.contentDOM&&(g.dirty=za,g.updateChildren(s,o+1),g.dirty=Xr),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,s,i,o){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Bh(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let l=la.create(this.top,n,r,s,i,o);if(l.contentDOM){l.children=e.children,e.children=[];for(let d of l.children)d.parent=l}return e.destroy(),l}addNode(e,n,r,s,i){let o=la.create(this.top,e,n,r,s,i);o.contentDOM&&o.updateChildren(s,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,n,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new CM(this.top,e,n,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof io;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Xp)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Fn||An)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new NM(this.top,[],r,null);n!=this.top?n.children.push(s):n.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function c9(t,e){let n=e,r=n.children.length,s=t.childCount,i=new Map,o=[];e:for(;s>0;){let l;for(;;)if(r){let f=n.children[r-1];if(f instanceof io)n=f,r=f.children.length;else{l=f,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let d=l.node;if(d){if(d!=t.child(s-1))break;--s,i.set(l,s),o.push(l)}}return{index:s,matched:i,matches:o.reverse()}}function u9(t,e){return t.type.side-e.type.side}function d9(t,e,n,r){let s=e.locals(t),i=0;if(s.length==0){for(let f=0;f<t.childCount;f++){let p=t.child(f);r(p,s,e.forChild(i,p),f),i+=p.nodeSize}return}let o=0,l=[],d=null;for(let f=0;;){let p,g;for(;o<s.length&&s[o].to==i;){let w=s[o++];w.widget&&(p?(g||(g=[p])).push(w):p=w)}if(p)if(g){g.sort(u9);for(let w=0;w<g.length;w++)n(g[w],f,!!d)}else n(p,f,!!d);let y,m;if(d)m=-1,y=d,d=null;else if(f<t.childCount)m=f,y=t.child(f++);else break;for(let w=0;w<l.length;w++)l[w].to<=i&&l.splice(w--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)l.push(s[o++]);let b=i+y.nodeSize;if(y.isText){let w=b;o<s.length&&s[o].from<w&&(w=s[o].from);for(let S=0;S<l.length;S++)l[S].to<w&&(w=l[S].to);w<b&&(d=y.cut(w-i),y=y.cut(0,w-i),b=w,m=-1)}else for(;o<s.length&&s[o].to<b;)o++;let v=y.isInline&&!y.isLeaf?l.filter(w=>!w.inline):l.slice();r(y,v,e.forChild(i,y),m),i=b}}function f9(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function h9(t,e,n,r){for(let s=0,i=0;s<t.childCount&&i<=r;){let o=t.child(s++),l=i;if(i+=o.nodeSize,!o.isText)continue;let d=o.text;for(;s<t.childCount;){let f=t.child(s++);if(i+=f.nodeSize,!f.isText)break;d+=f.text}if(i>=n){if(i>=r&&d.slice(r-e.length-l,r-l)==e)return r-e.length;let f=l<r?d.lastIndexOf(e,r-l-1):-1;if(f>=0&&f+e.length+l>=n)return l+f;if(n==r&&d.length>=r+e.length-l&&d.slice(r-l,r-l+e.length)==e)return r}}return-1}function Ix(t,e,n,r,s){let i=[];for(let o=0,l=0;o<t.length;o++){let d=t[o],f=l,p=l+=d.size;f>=n||p<=e?i.push(d):(f<e&&i.push(d.slice(0,e-f,r)),s&&(i.push(s),s=void 0),p>n&&i.push(d.slice(n-f,d.size,r)))}return i}function fv(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let s=t.docView.nearestDesc(n.focusNode),i=s&&s.size==0,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let l=r.resolve(o),d,f;if(Gp(n)){for(d=o;s&&!s.node;)s=s.parent;let g=s.node;if(s&&g.isAtom&&Be.isSelectable(g)&&s.parent&&!(g.isInline&&BF(n.focusNode,n.focusOffset,s.dom))){let y=s.posBefore;f=new Be(o==y?l:r.resolve(y))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let g=o,y=o;for(let m=0;m<n.rangeCount;m++){let b=n.getRangeAt(m);g=Math.min(g,t.docView.posFromDOM(b.startContainer,b.startOffset,1)),y=Math.max(y,t.docView.posFromDOM(b.endContainer,b.endOffset,-1))}if(g<0)return null;[d,o]=y==t.state.selection.anchor?[y,g]:[g,y],l=r.resolve(o)}else d=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(d<0)return null}let p=r.resolve(d);if(!f){let g=e=="pointer"||t.state.selection.head<l.pos&&!i?1:-1;f=hv(t,p,l,g)}return f}function MM(t){return t.editable?t.hasFocus():RM(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function li(t,e=!1){let n=t.state.selection;if(AM(t,n),!!MM(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&An){let r=t.domSelectionRange(),s=t.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&so(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)g9(t);else{let{anchor:r,head:s}=n,i,o;iN&&!(n instanceof qe)&&(n.$from.parent.inlineContent||(i=aN(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=aN(t,n.to))),t.docView.setSelection(r,s,t,e),iN&&(i&&oN(i),o&&oN(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&p9(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const iN=Fn||An&&yM<63;function aN(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),s=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(Fn&&s&&s.contentEditable=="false")return J0(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return J0(s);if(i)return J0(i)}}function J0(t){return t.contentEditable="true",Fn&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function oN(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function p9(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,s=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=s)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!MM(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function g9(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,wn(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&rr&&oa<=11&&(n.disabled=!0,n.disabled=!1)}function AM(t,e){if(e instanceof Be){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(lN(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else lN(t)}function lN(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function hv(t,e,n,r){return t.someProp("createSelectionBetween",s=>s(t,e,n))||qe.between(e,n,r)}function cN(t){return t.editable&&!t.hasFocus()?!1:RM(t)}function RM(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function m9(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return so(e.node,e.offset,n.anchorNode,n.anchorOffset)}function Lx(t,e){let{$anchor:n,$head:r}=t.selection,s=e>0?n.max(r):n.min(r),i=s.parent.inlineContent?s.depth?t.doc.resolve(e>0?s.after():s.before()):null:s;return i&&Ge.findFrom(i,e)}function Vi(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function uN(t,e,n){let r=t.state.selection;if(r instanceof qe)if(n.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=t.state.doc.resolve(s.pos+i.nodeSize*(e<0?-1:1));return Vi(t,new qe(r.$anchor,o))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let s=Lx(t.state,e);return s&&s instanceof Be?Vi(t,s):!1}else if(!(Qr&&n.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,o;if(!i||i.isText)return!1;let l=e<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(o=t.docView.descAt(l))&&!o.contentDOM?Be.isSelectable(i)?Vi(t,new Be(e<0?t.state.doc.resolve(s.pos-i.nodeSize):s)):ld?Vi(t,new qe(t.state.doc.resolve(e<0?l:l+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof Be&&r.node.isInline)return Vi(t,new qe(e>0?r.$to:r.$from));{let s=Lx(t.state,e);return s?Vi(t,s):!1}}}function Fh(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function ku(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function pl(t,e){return e<0?y9(t):x9(t)}function y9(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s,i,o=!1;for(Gr&&n.nodeType==1&&r<Fh(n)&&ku(n.childNodes[r],-1)&&(o=!0);;)if(r>0){if(n.nodeType!=1)break;{let l=n.childNodes[r-1];if(ku(l,-1))s=n,i=--r;else if(l.nodeType==3)n=l,r=n.nodeValue.length;else break}}else{if(_M(n))break;{let l=n.previousSibling;for(;l&&ku(l,-1);)s=n.parentNode,i=wn(l),l=l.previousSibling;if(l)n=l,r=Fh(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}o?zx(t,n,r):s&&zx(t,s,i)}function x9(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s=Fh(n),i,o;for(;;)if(r<s){if(n.nodeType!=1)break;let l=n.childNodes[r];if(ku(l,1))i=n,o=++r;else break}else{if(_M(n))break;{let l=n.nextSibling;for(;l&&ku(l,1);)i=l.parentNode,o=wn(l)+1,l=l.nextSibling;if(l)n=l,r=0,s=Fh(n);else{if(n=n.parentNode,n==t.dom)break;r=s=0}}}i&&zx(t,i,o)}function _M(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function b9(t,e){for(;t&&e==t.childNodes.length&&!od(t);)e=wn(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function v9(t,e){for(;t&&!e&&!od(t);)e=wn(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function zx(t,e,n){if(e.nodeType!=3){let i,o;(o=b9(e,n))?(e=o,n=0):(i=v9(e,n))&&(e=i,n=i.nodeValue.length)}let r=t.domSelection();if(!r)return;if(Gp(r)){let i=document.createRange();i.setEnd(e,n),i.setStart(e,n),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:s}=t;setTimeout(()=>{t.state==s&&li(t)},50)}function dN(t,e){let n=t.state.doc.resolve(e);if(!(An||$F)&&n.parent.inlineContent){let s=t.coordsAtPos(e);if(e>n.start()){let i=t.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(e<n.end()){let i=t.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function fN(t,e,n){let r=t.state.selection;if(r instanceof qe&&!r.empty||n.indexOf("s")>-1||Qr&&n.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let o=Lx(t.state,e);if(o&&o instanceof Be)return Vi(t,o)}if(!s.parent.inlineContent){let o=e<0?s:i,l=r instanceof Sr?Ge.near(o,e):Ge.findFrom(o,e);return l?Vi(t,l):!1}return!1}function hN(t,e){if(!(t.state.selection instanceof qe))return!0;let{$head:n,$anchor:r,empty:s}=t.state.selection;if(!n.sameParent(r))return!0;if(!s)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let o=t.state.tr;return e<0?o.delete(n.pos-i.nodeSize,n.pos):o.delete(n.pos,n.pos+i.nodeSize),t.dispatch(o),!0}return!1}function pN(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function w9(t){if(!Fn||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;pN(t,r,"true"),setTimeout(()=>pN(t,r,"false"),20)}return!1}function S9(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function k9(t,e){let n=e.keyCode,r=S9(e);if(n==8||Qr&&n==72&&r=="c")return hN(t,-1)||pl(t,-1);if(n==46&&!e.shiftKey||Qr&&n==68&&r=="c")return hN(t,1)||pl(t,1);if(n==13||n==27)return!0;if(n==37||Qr&&n==66&&r=="c"){let s=n==37?dN(t,t.state.selection.from)=="ltr"?-1:1:-1;return uN(t,s,r)||pl(t,s)}else if(n==39||Qr&&n==70&&r=="c"){let s=n==39?dN(t,t.state.selection.from)=="ltr"?1:-1:1;return uN(t,s,r)||pl(t,s)}else{if(n==38||Qr&&n==80&&r=="c")return fN(t,-1,r)||pl(t,-1);if(n==40||Qr&&n==78&&r=="c")return w9(t)||fN(t,1,r)||pl(t,1);if(r==(Qr?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function pv(t,e){t.someProp("transformCopied",m=>{e=m(e,t)});let n=[],{content:r,openStart:s,openEnd:i}=e;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let m=r.firstChild;n.push(m.type.name,m.attrs!=m.type.defaultAttrs?m.attrs:null),r=m.content}let o=t.someProp("clipboardSerializer")||vo.fromSchema(t.state.schema),l=PM(),d=l.createElement("div");d.appendChild(o.serializeFragment(r,{document:l}));let f=d.firstChild,p,g=0;for(;f&&f.nodeType==1&&(p=zM[f.nodeName.toLowerCase()]);){for(let m=p.length-1;m>=0;m--){let b=l.createElement(p[m]);for(;d.firstChild;)b.appendChild(d.firstChild);d.appendChild(b),g++}f=d.firstChild}f&&f.nodeType==1&&f.setAttribute("data-pm-slice",`${s} ${i}${g?` -${g}`:""} ${JSON.stringify(n)}`);let y=t.someProp("clipboardTextSerializer",m=>m(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:d,text:y,slice:e}}function OM(t,e,n,r,s){let i=s.parent.type.spec.code,o,l;if(!n&&!e)return null;let d=!!e&&(r||i||!n);if(d){if(t.someProp("transformPastedText",y=>{e=y(e,i||r,t)}),i)return l=new Ae(Ne.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",y=>{l=y(l,t,!0)}),l;let g=t.someProp("clipboardTextParser",y=>y(e,s,r,t));if(g)l=g;else{let y=s.marks(),{schema:m}=t.state,b=vo.fromSchema(m);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let w=o.appendChild(document.createElement("p"));v&&w.appendChild(b.serializeNode(m.text(v,y)))})}}else t.someProp("transformPastedHTML",g=>{n=g(n,t)}),o=j9(n),ld&&E9(o);let f=o&&o.querySelector("[data-pm-slice]"),p=f&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(f.getAttribute("data-pm-slice")||"");if(p&&p[3])for(let g=+p[3];g>0;g--){let y=o.firstChild;for(;y&&y.nodeType!=1;)y=y.nextSibling;if(!y)break;o=y}if(l||(l=(t.someProp("clipboardParser")||t.someProp("domParser")||vu.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(d||p),context:s,ruleFromNode(y){return y.nodeName=="BR"&&!y.nextSibling&&y.parentNode&&!C9.test(y.parentNode.nodeName)?{ignore:!0}:null}})),p)l=M9(gN(l,+p[1],+p[2]),p[4]);else if(l=Ae.maxOpen(N9(l.content,s),!0),l.openStart||l.openEnd){let g=0,y=0;for(let m=l.content.firstChild;g<l.openStart&&!m.type.spec.isolating;g++,m=m.firstChild);for(let m=l.content.lastChild;y<l.openEnd&&!m.type.spec.isolating;y++,m=m.lastChild);l=gN(l,g,y)}return t.someProp("transformPasted",g=>{l=g(l,t,d)}),l}const C9=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function N9(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let s=e.node(n).contentMatchAt(e.index(n)),i,o=[];if(t.forEach(l=>{if(!o)return;let d=s.findWrapping(l.type),f;if(!d)return o=null;if(f=o.length&&i.length&&IM(d,i,l,o[o.length-1],0))o[o.length-1]=f;else{o.length&&(o[o.length-1]=LM(o[o.length-1],i.length));let p=DM(l,d);o.push(p),s=s.matchType(p.type),i=d}}),o)return Ne.from(o)}return t}function DM(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,Ne.from(t));return t}function IM(t,e,n,r,s){if(s<t.length&&s<e.length&&t[s]==e[s]){let i=IM(t,e,n,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==t.length-1?n.type:t[s+1]))return r.copy(r.content.append(Ne.from(DM(n,t,s+1))))}}function LM(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,LM(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(Ne.empty,!0);return t.copy(n.append(r))}function Px(t,e,n,r,s,i){let o=e<0?t.firstChild:t.lastChild,l=o.content;return t.childCount>1&&(i=0),s<r-1&&(l=Px(l,e,n,r,s+1,i)),s>=n&&(l=e<0?o.contentMatchAt(0).fillBefore(l,i<=s).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(Ne.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(l))}function gN(t,e,n){return e<t.openStart&&(t=new Ae(Px(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new Ae(Px(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const zM={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let mN=null;function PM(){return mN||(mN=document.implementation.createHTMLDocument("title"))}let Z0=null;function T9(t){let e=window.trustedTypes;return e?(Z0||(Z0=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),Z0.createHTML(t)):t}function j9(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=PM().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),s;if((s=r&&zM[r[1].toLowerCase()])&&(t=s.map(i=>"<"+i+">").join("")+t+s.map(i=>"</"+i+">").reverse().join("")),n.innerHTML=T9(t),s)for(let i=0;i<s.length;i++)n=n.querySelector(s[i])||n;return n}function E9(t){let e=t.querySelectorAll(An?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function M9(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:s,openStart:i,openEnd:o}=t;for(let l=r.length-2;l>=0;l-=2){let d=n.nodes[r[l]];if(!d||d.hasRequiredAttrs())break;s=Ne.from(d.create(r[l+1],s)),i++,o++}return new Ae(s,i,o)}const Un={},$n={},A9={touchstart:!0,touchmove:!0};class R9{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function _9(t){for(let e in Un){let n=Un[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{D9(t,r)&&!gv(t,r)&&(t.editable||!(r.type in $n))&&n(t,r)},A9[e]?{passive:!0}:void 0)}Fn&&t.dom.addEventListener("input",()=>null),Bx(t)}function ea(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function O9(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function Bx(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>gv(t,r))})}function gv(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function D9(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function I9(t,e){!gv(t,e)&&Un[e.type]&&(t.editable||!(e.type in $n))&&Un[e.type](t,e)}$n.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!FM(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(ii&&An&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),ql&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",s=>s(t,Ia(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||k9(t,n)?n.preventDefault():ea(t,"key")};$n.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};$n.keypress=(t,e)=>{let n=e;if(FM(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Qr&&n.metaKey)return;if(t.someProp("handleKeyPress",s=>s(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof qe)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(n.charCode),i=()=>t.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!t.someProp("handleTextInput",o=>o(t,r.$from.pos,r.$to.pos,s,i))&&t.dispatch(i()),n.preventDefault()}};function Jp(t){return{left:t.clientX,top:t.clientY}}function L9(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function mv(t,e,n,r,s){if(r==-1)return!1;let i=t.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(t.someProp(e,l=>o>i.depth?l(t,n,i.nodeAfter,i.before(o),s,!0):l(t,n,i.node(o),i.before(o),s,!1)))return!0;return!1}function Dl(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function z9(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&Be.isSelectable(r)?(Dl(t,new Be(n)),!0):!1}function P9(t,e){if(e==-1)return!1;let n=t.state.selection,r,s;n instanceof Be&&(r=n.node);let i=t.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let l=o>i.depth?i.nodeAfter:i.node(o);if(Be.isSelectable(l)){r&&n.$from.depth>0&&o>=n.$from.depth&&i.before(n.$from.depth+1)==n.$from.pos?s=i.before(n.$from.depth):s=i.before(o);break}}return s!=null?(Dl(t,Be.create(t.state.doc,s)),!0):!1}function B9(t,e,n,r,s){return mv(t,"handleClickOn",e,n,r)||t.someProp("handleClick",i=>i(t,e,r))||(s?P9(t,n):z9(t,n))}function F9(t,e,n,r){return mv(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",s=>s(t,e,r))}function U9(t,e,n,r){return mv(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",s=>s(t,e,r))||$9(t,n,r)}function $9(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Dl(t,qe.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let i=s.depth+1;i>0;i--){let o=i>s.depth?s.nodeAfter:s.node(i),l=s.before(i);if(o.inlineContent)Dl(t,qe.create(r,l+1,l+1+o.content.size));else if(Be.isSelectable(o))Dl(t,Be.create(r,l));else continue;return!0}}function yv(t){return Uh(t)}const BM=Qr?"metaKey":"ctrlKey";Un.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=yv(t),s=Date.now(),i="singleClick";s-t.input.lastClick.time<500&&L9(n,t.input.lastClick)&&!n[BM]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?i="doubleClick":t.input.lastClick.type=="doubleClick"&&(i="tripleClick")),t.input.lastClick={time:s,x:n.clientX,y:n.clientY,type:i,button:n.button};let o=t.posAtCoords(Jp(n));o&&(i=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new q9(t,o,n,!!r)):(i=="doubleClick"?F9:U9)(t,o.pos,o.inside,n)?n.preventDefault():ea(t,"pointer"))};class q9{constructor(e,n,r,s){this.view=e,this.pos=n,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[BM],this.allowDefault=r.shiftKey;let i,o;if(n.inside>-1)i=e.state.doc.nodeAt(n.inside),o=n.inside;else{let p=e.state.doc.resolve(n.pos);i=p.parent,o=p.depth?p.before():0}const l=s?null:r.target,d=l?e.docView.nearestDesc(l,!0):null;this.target=d&&d.nodeDOM.nodeType==1?d.nodeDOM:null;let{selection:f}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||f instanceof Be&&f.from<=o&&f.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Gr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ea(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>li(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Jp(e))),this.updateAllowDefault(e),this.allowDefault||!n?ea(this.view,"pointer"):B9(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Fn&&this.mightDrag&&!this.mightDrag.node.isAtom||An&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Dl(this.view,Ge.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):ea(this.view,"pointer")}move(e){this.updateAllowDefault(e),ea(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Un.touchstart=t=>{t.input.lastTouch=Date.now(),yv(t),ea(t,"pointer")};Un.touchmove=t=>{t.input.lastTouch=Date.now(),ea(t,"pointer")};Un.contextmenu=t=>yv(t);function FM(t,e){return t.composing?!0:Fn&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const H9=ii?5e3:-1;$n.compositionstart=$n.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof qe&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),Uh(t,!0),t.markCursor=null;else if(Uh(t,!e.selection.empty),Gr&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let o=i<0?s.lastChild:s.childNodes[i-1];if(!o)break;if(o.nodeType==3){let l=t.domSelection();l&&l.collapse(o,o.nodeValue.length);break}else s=o,i=-1}}t.input.composing=!0}UM(t,H9)};$n.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,UM(t,20))};function UM(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Uh(t),e))}function $M(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=K9());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function V9(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=zF(e.focusNode,e.focusOffset),r=PF(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let s=r.pmViewDesc,i=t.domObserver.lastChangedTextNode;if(n==i||r==i)return i;if(!s||!s.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let o=n.pmViewDesc;if(!(!o||!o.isText(n.nodeValue)))return r}}return n||r}function K9(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Uh(t,e=!1){if(!(ii&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),$M(t),e||t.docView&&t.docView.dirty){let n=fv(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function Q9(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const Hu=rr&&oa<15||ql&&qF<604;Un.copy=$n.cut=(t,e)=>{let n=e,r=t.state.selection,s=n.type=="cut";if(r.empty)return;let i=Hu?null:n.clipboardData,o=r.content(),{dom:l,text:d}=pv(t,o);i?(n.preventDefault(),i.clearData(),i.setData("text/html",l.innerHTML),i.setData("text/plain",d)):Q9(t,l),s&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function W9(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function Y9(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Vu(t,r.value,null,s,e):Vu(t,r.textContent,r.innerHTML,s,e)},50)}function Vu(t,e,n,r,s){let i=OM(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",d=>d(t,s,i||Ae.empty)))return!0;if(!i)return!1;let o=W9(i),l=o?t.state.tr.replaceSelectionWith(o,r):t.state.tr.replaceSelection(i);return t.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function qM(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}$n.paste=(t,e)=>{let n=e;if(t.composing&&!ii)return;let r=Hu?null:n.clipboardData,s=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&Vu(t,qM(r),r.getData("text/html"),s,n)?n.preventDefault():Y9(t,n)};class HM{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const G9=Qr?"altKey":"ctrlKey";function VM(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[G9]}Un.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let s=t.state.selection,i=s.empty?null:t.posAtCoords(Jp(n)),o;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof Be?s.to-1:s.to))){if(r&&r.mightDrag)o=Be.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let g=t.docView.nearestDesc(n.target,!0);g&&g.node.type.spec.draggable&&g!=t.docView&&(o=Be.create(t.state.doc,g.posBefore))}}let l=(o||t.state.selection).content(),{dom:d,text:f,slice:p}=pv(t,l);(!n.dataTransfer.files.length||!An||yM>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Hu?"Text":"text/html",d.innerHTML),n.dataTransfer.effectAllowed="copyMove",Hu||n.dataTransfer.setData("text/plain",f),t.dragging=new HM(p,VM(t,n),o)};Un.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};$n.dragover=$n.dragenter=(t,e)=>e.preventDefault();$n.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let s=t.posAtCoords(Jp(n));if(!s)return;let i=t.state.doc.resolve(s.pos),o=r&&r.slice;o?t.someProp("transformPasted",b=>{o=b(o,t,!1)}):o=OM(t,qM(n.dataTransfer),Hu?null:n.dataTransfer.getData("text/html"),!1,i);let l=!!(r&&VM(t,n));if(t.someProp("handleDrop",b=>b(t,n,o||Ae.empty,l))){n.preventDefault();return}if(!o)return;n.preventDefault();let d=o?G3(t.state.doc,i.pos,o):i.pos;d==null&&(d=i.pos);let f=t.state.tr;if(l){let{node:b}=r;b?b.replace(f):f.deleteSelection()}let p=f.mapping.map(d),g=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,y=f.doc;if(g?f.replaceRangeWith(p,p,o.content.firstChild):f.replaceRange(p,p,o),f.doc.eq(y))return;let m=f.doc.resolve(p);if(g&&Be.isSelectable(o.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(o.content.firstChild))f.setSelection(new Be(m));else{let b=f.mapping.map(d);f.mapping.maps[f.mapping.maps.length-1].forEach((v,w,S,T)=>b=T),f.setSelection(hv(t,m,f.doc.resolve(b)))}t.focus(),t.dispatch(f.setMeta("uiEvent","drop"))};Un.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&li(t)},20))};Un.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Un.beforeinput=(t,e)=>{if(An&&ii&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",i=>i(t,Ia(8,"Backspace")))))return;let{$cursor:s}=t.state.selection;s&&s.pos>0&&t.dispatch(t.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let t in $n)Un[t]=$n[t];function Ku(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class $h{constructor(e,n){this.toDOM=e,this.spec=n||Qa,this.side=this.spec.side||0}map(e,n,r,s){let{pos:i,deleted:o}=e.mapResult(n.from+s,this.side<0?-1:1);return o?null:new zn(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof $h&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Ku(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class ca{constructor(e,n){this.attrs=e,this.spec=n||Qa}map(e,n,r,s){let i=e.map(n.from+s,this.spec.inclusiveStart?-1:1)-r,o=e.map(n.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new zn(i,o,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof ca&&Ku(this.attrs,e.attrs)&&Ku(this.spec,e.spec)}static is(e){return e.type instanceof ca}destroy(){}}class xv{constructor(e,n){this.attrs=e,this.spec=n||Qa}map(e,n,r,s){let i=e.mapResult(n.from+s,1);if(i.deleted)return null;let o=e.mapResult(n.to+s,-1);return o.deleted||o.pos<=i.pos?null:new zn(i.pos-r,o.pos-r,this)}valid(e,n){let{index:r,offset:s}=e.content.findIndex(n.from),i;return s==n.from&&!(i=e.child(r)).isText&&s+i.nodeSize==n.to}eq(e){return this==e||e instanceof xv&&Ku(this.attrs,e.attrs)&&Ku(this.spec,e.spec)}destroy(){}}class zn{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new zn(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new zn(e,e,new $h(n,r))}static inline(e,n,r,s){return new zn(e,n,new ca(r,s))}static node(e,n,r,s){return new zn(e,n,new xv(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof ca}get widget(){return this.type instanceof $h}}const El=[],Qa={};class Rt{constructor(e,n){this.local=e.length?e:El,this.children=n.length?n:El}static create(e,n){return n.length?qh(n,e,0,Qa):jn}find(e,n,r){let s=[];return this.findInner(e??0,n??1e9,s,0,r),s}findInner(e,n,r,s,i){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=n&&l.to>=e&&(!i||i(l.spec))&&r.push(l.copy(l.from+s,l.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,n-l,r,s+l,i)}}map(e,n,r){return this==jn||e.maps.length==0?this:this.mapInner(e,n,0,0,r||Qa)}mapInner(e,n,r,s,i){let o;for(let l=0;l<this.local.length;l++){let d=this.local[l].map(e,r,s);d&&d.type.valid(n,d)?(o||(o=[])).push(d):i.onRemove&&i.onRemove(this.local[l].spec)}return this.children.length?X9(this.children,o||[],e,n,r,s,i):o?new Rt(o.sort(Wa),El):jn}add(e,n){return n.length?this==jn?Rt.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let s,i=0;e.forEach((l,d)=>{let f=d+r,p;if(p=QM(n,l,f)){for(s||(s=this.children.slice());i<s.length&&s[i]<d;)i+=3;s[i]==d?s[i+2]=s[i+2].addInner(l,p,f+1):s.splice(i,0,d,d+l.nodeSize,qh(p,l,f+1,Qa)),i+=3}});let o=KM(i?WM(n):n,-r);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new Rt(o.length?this.local.concat(o).sort(Wa):this.local,s||this.children)}remove(e){return e.length==0||this==jn?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let o,l=r[i]+n,d=r[i+1]+n;for(let p=0,g;p<e.length;p++)(g=e[p])&&g.from>l&&g.to<d&&(e[p]=null,(o||(o=[])).push(g));if(!o)continue;r==this.children&&(r=this.children.slice());let f=r[i+2].removeInner(o,l+1);f!=jn?r[i+2]=f:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let l=0;l<s.length;l++)s[l].eq(o,n)&&(s==this.local&&(s=this.local.slice()),s.splice(l--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new Rt(s,r):jn}forChild(e,n){if(this==jn)return this;if(n.isLeaf)return Rt.empty;let r,s;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let i=e+1,o=i+n.content.size;for(let l=0;l<this.local.length;l++){let d=this.local[l];if(d.from<o&&d.to>i&&d.type instanceof ca){let f=Math.max(i,d.from)-i,p=Math.min(o,d.to)-i;f<p&&(s||(s=[])).push(d.copy(f,p))}}if(s){let l=new Rt(s.sort(Wa),El);return r?new Wi([l,r]):l}return r||jn}eq(e){if(this==e)return!0;if(!(e instanceof Rt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return bv(this.localsInner(e))}localsInner(e){if(this==jn)return El;if(e.inlineContent||!this.local.some(ca.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof ca||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Rt.empty=new Rt([],[]);Rt.removeOverlap=bv;const jn=Rt.empty;class Wi{constructor(e){this.members=e}map(e,n){const r=this.members.map(s=>s.map(e,n,Qa));return Wi.from(r)}forChild(e,n){if(n.isLeaf)return Rt.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(e,n);i!=jn&&(i instanceof Wi?r=r.concat(i.members):r.push(i))}return Wi.from(r)}eq(e){if(!(e instanceof Wi)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(e);if(i.length)if(!n)n=i;else{r&&(n=n.slice(),r=!1);for(let o=0;o<i.length;o++)n.push(i[o])}}return n?bv(r?n:n.sort(Wa)):El}static from(e){switch(e.length){case 0:return jn;case 1:return e[0];default:return new Wi(e.every(n=>n instanceof Rt)?e:e.reduce((n,r)=>n.concat(r instanceof Rt?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function X9(t,e,n,r,s,i,o){let l=t.slice();for(let f=0,p=i;f<n.maps.length;f++){let g=0;n.maps[f].forEach((y,m,b,v)=>{let w=v-b-(m-y);for(let S=0;S<l.length;S+=3){let T=l[S+1];if(T<0||y>T+p-g)continue;let j=l[S]+p-g;m>=j?l[S+1]=y<=j?-2:-1:y>=p&&w&&(l[S]+=w,l[S+1]+=w)}g+=w}),p=n.maps[f].map(p,-1)}let d=!1;for(let f=0;f<l.length;f+=3)if(l[f+1]<0){if(l[f+1]==-2){d=!0,l[f+1]=-1;continue}let p=n.map(t[f]+i),g=p-s;if(g<0||g>=r.content.size){d=!0;continue}let y=n.map(t[f+1]+i,-1),m=y-s,{index:b,offset:v}=r.content.findIndex(g),w=r.maybeChild(b);if(w&&v==g&&v+w.nodeSize==m){let S=l[f+2].mapInner(n,w,p+1,t[f]+i+1,o);S!=jn?(l[f]=g,l[f+1]=m,l[f+2]=S):(l[f+1]=-2,d=!0)}else d=!0}if(d){let f=J9(l,t,e,n,s,i,o),p=qh(f,r,0,o);e=p.local;for(let g=0;g<l.length;g+=3)l[g+1]<0&&(l.splice(g,3),g-=3);for(let g=0,y=0;g<p.children.length;g+=3){let m=p.children[g];for(;y<l.length&&l[y]<m;)y+=3;l.splice(y,0,p.children[g],p.children[g+1],p.children[g+2])}}return new Rt(e.sort(Wa),l)}function KM(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let s=t[r];n.push(new zn(s.from+e,s.to+e,s.type))}return n}function J9(t,e,n,r,s,i,o){function l(d,f){for(let p=0;p<d.local.length;p++){let g=d.local[p].map(r,s,f);g?n.push(g):o.onRemove&&o.onRemove(d.local[p].spec)}for(let p=0;p<d.children.length;p+=3)l(d.children[p+2],d.children[p]+f+1)}for(let d=0;d<t.length;d+=3)t[d+1]==-1&&l(t[d+2],e[d]+i+1);return n}function QM(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,s=null;for(let i=0,o;i<t.length;i++)(o=t[i])&&o.from>n&&o.to<r&&((s||(s=[])).push(o),t[i]=null);return s}function WM(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function qh(t,e,n,r){let s=[],i=!1;e.forEach((l,d)=>{let f=QM(t,l,d+n);if(f){i=!0;let p=qh(f,l,n+d+1,r);p!=jn&&s.push(d,d+l.nodeSize,p)}});let o=KM(i?WM(t):t,-n).sort(Wa);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(r.onRemove&&r.onRemove(o[l].spec),o.splice(l--,1));return o.length||s.length?new Rt(o,s):jn}function Wa(t,e){return t.from-e.from||t.to-e.to}function bv(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let s=n+1;s<e.length;s++){let i=e[s];if(i.from==r.from){i.to!=r.to&&(e==t&&(e=t.slice()),e[s]=i.copy(i.from,r.to),yN(e,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),yN(e,s,r.copy(i.from,r.to)));break}}}return e}function yN(t,e,n){for(;e<t.length&&Wa(n,t[e])>0;)e++;t.splice(e,0,n)}function ey(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=jn&&e.push(r)}),t.cursorWrapper&&e.push(Rt.create(t.state.doc,[t.cursorWrapper.deco])),Wi.from(e)}const Z9={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},eU=rr&&oa<=11;class tU{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class nU{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new tU,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);rr&&oa<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),eU&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Z9)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(cN(this.view)){if(this.suppressingSelectionUpdates)return li(this.view);if(rr&&oa<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&so(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let i=e.focusNode;i;i=$l(i))n.add(i);for(let i=e.anchorNode;i;i=$l(i))if(n.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&cN(e)&&!this.ignoreSelectionChange(r),i=-1,o=-1,l=!1,d=[];if(e.editable)for(let p=0;p<n.length;p++){let g=this.registerMutation(n[p],d);g&&(i=i<0?g.from:Math.min(g.from,i),o=o<0?g.to:Math.max(g.to,o),g.typeOver&&(l=!0))}if(Gr&&d.length){let p=d.filter(g=>g.nodeName=="BR");if(p.length==2){let[g,y]=p;g.parentNode&&g.parentNode.parentNode==y.parentNode?y.remove():g.remove()}else{let{focusNode:g}=this.currentSelection;for(let y of p){let m=y.parentNode;m&&m.nodeName=="LI"&&(!g||iU(e,g)!=m)&&y.remove()}}}let f=null;i<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Gp(r)&&(f=fv(e))&&f.eq(Ge.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,li(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||s)&&(i>-1&&(e.docView.markDirty(i,o),rU(e)),this.handleDOMChange(i,o,l,d),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||li(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let p=0;p<e.addedNodes.length;p++){let g=e.addedNodes[p];n.push(g),g.nodeType==3&&(this.lastChangedTextNode=g)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,i=e.nextSibling;if(rr&&oa<=11&&e.addedNodes.length)for(let p=0;p<e.addedNodes.length;p++){let{previousSibling:g,nextSibling:y}=e.addedNodes[p];(!g||Array.prototype.indexOf.call(e.addedNodes,g)<0)&&(s=g),(!y||Array.prototype.indexOf.call(e.addedNodes,y)<0)&&(i=y)}let o=s&&s.parentNode==e.target?wn(s)+1:0,l=r.localPosFromDOM(e.target,o,-1),d=i&&i.parentNode==e.target?wn(i):e.target.childNodes.length,f=r.localPosFromDOM(e.target,d,1);return{from:l,to:f}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let xN=new WeakMap,bN=!1;function rU(t){if(!xN.has(t)&&(xN.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Gr,bN)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),bN=!0}}function vN(t,e){let n=e.startContainer,r=e.startOffset,s=e.endContainer,i=e.endOffset,o=t.domAtPos(t.state.selection.anchor);return so(o.node,o.offset,s,i)&&([n,r,s,i]=[s,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:i}}function sU(t,e){if(e.getComposedRanges){let s=e.getComposedRanges(t.root)[0];if(s)return vN(t,s)}let n;function r(s){s.preventDefault(),s.stopImmediatePropagation(),n=s.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?vN(t,n):null}function iU(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function aU(t,e,n){let{node:r,fromOffset:s,toOffset:i,from:o,to:l}=t.docView.parseRange(e,n),d=t.domSelectionRange(),f,p=d.anchorNode;if(p&&t.dom.contains(p.nodeType==1?p:p.parentNode)&&(f=[{node:p,offset:d.anchorOffset}],Gp(d)||f.push({node:d.focusNode,offset:d.focusOffset})),An&&t.input.lastKeyCode===8)for(let w=i;w>s;w--){let S=r.childNodes[w-1],T=S.pmViewDesc;if(S.nodeName=="BR"&&!T){i=w;break}if(!T||T.size)break}let g=t.state.doc,y=t.someProp("domParser")||vu.fromSchema(t.state.schema),m=g.resolve(o),b=null,v=y.parse(r,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:s,to:i,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:f,ruleFromNode:oU,context:m});if(f&&f[0].pos!=null){let w=f[0].pos,S=f[1]&&f[1].pos;S==null&&(S=w),b={anchor:w+o,head:S+o}}return{doc:v,sel:b,from:o,to:l}}function oU(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Fn&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Fn&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const lU=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function cU(t,e,n,r,s){let i=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let O=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,L=fv(t,O);if(L&&!t.state.selection.eq(L)){if(An&&ii&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",F=>F(t,Ia(13,"Enter"))))return;let A=t.state.tr.setSelection(L);O=="pointer"?A.setMeta("pointer",!0):O=="key"&&A.scrollIntoView(),i&&A.setMeta("composition",i),t.dispatch(A)}return}let o=t.state.doc.resolve(e),l=o.sharedDepth(n);e=o.before(l+1),n=t.state.doc.resolve(n).after(l+1);let d=t.state.selection,f=aU(t,e,n),p=t.state.doc,g=p.slice(f.from,f.to),y,m;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(y=t.state.selection.to,m="end"):(y=t.state.selection.from,m="start"),t.input.lastKeyCode=null;let b=fU(g.content,f.doc.content,f.from,y,m);if(b&&t.input.domChangeCount++,(ql&&t.input.lastIOSEnter>Date.now()-225||ii)&&s.some(O=>O.nodeType==1&&!lU.test(O.nodeName))&&(!b||b.endA>=b.endB)&&t.someProp("handleKeyDown",O=>O(t,Ia(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!b)if(r&&d instanceof qe&&!d.empty&&d.$head.sameParent(d.$anchor)&&!t.composing&&!(f.sel&&f.sel.anchor!=f.sel.head))b={start:d.from,endA:d.to,endB:d.to};else{if(f.sel){let O=wN(t,t.state.doc,f.sel);if(O&&!O.eq(t.state.selection)){let L=t.state.tr.setSelection(O);i&&L.setMeta("composition",i),t.dispatch(L)}}return}t.state.selection.from<t.state.selection.to&&b.start==b.endB&&t.state.selection instanceof qe&&(b.start>t.state.selection.from&&b.start<=t.state.selection.from+2&&t.state.selection.from>=f.from?b.start=t.state.selection.from:b.endA<t.state.selection.to&&b.endA>=t.state.selection.to-2&&t.state.selection.to<=f.to&&(b.endB+=t.state.selection.to-b.endA,b.endA=t.state.selection.to)),rr&&oa<=11&&b.endB==b.start+1&&b.endA==b.start&&b.start>f.from&&f.doc.textBetween(b.start-f.from-1,b.start-f.from+1)==" "&&(b.start--,b.endA--,b.endB--);let v=f.doc.resolveNoCache(b.start-f.from),w=f.doc.resolveNoCache(b.endB-f.from),S=p.resolve(b.start),T=v.sameParent(w)&&v.parent.inlineContent&&S.end()>=b.endA;if((ql&&t.input.lastIOSEnter>Date.now()-225&&(!T||s.some(O=>O.nodeName=="DIV"||O.nodeName=="P"))||!T&&v.pos<f.doc.content.size&&(!v.sameParent(w)||!v.parent.inlineContent)&&v.pos<w.pos&&!/\S/.test(f.doc.textBetween(v.pos,w.pos,"","")))&&t.someProp("handleKeyDown",O=>O(t,Ia(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>b.start&&dU(p,b.start,b.endA,v,w)&&t.someProp("handleKeyDown",O=>O(t,Ia(8,"Backspace")))){ii&&An&&t.domObserver.suppressSelectionUpdates();return}An&&b.endB==b.start&&(t.input.lastChromeDelete=Date.now()),ii&&!T&&v.start()!=w.start()&&w.parentOffset==0&&v.depth==w.depth&&f.sel&&f.sel.anchor==f.sel.head&&f.sel.head==b.endA&&(b.endB-=2,w=f.doc.resolveNoCache(b.endB-f.from),setTimeout(()=>{t.someProp("handleKeyDown",function(O){return O(t,Ia(13,"Enter"))})},20));let j=b.start,M=b.endA,_=O=>{let L=O||t.state.tr.replace(j,M,f.doc.slice(b.start-f.from,b.endB-f.from));if(f.sel){let A=wN(t,L.doc,f.sel);A&&!(An&&t.composing&&A.empty&&(b.start!=b.endB||t.input.lastChromeDelete<Date.now()-100)&&(A.head==j||A.head==L.mapping.map(M)-1)||rr&&A.empty&&A.head==j)&&L.setSelection(A)}return i&&L.setMeta("composition",i),L.scrollIntoView()},R;if(T)if(v.pos==w.pos){rr&&oa<=11&&v.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>li(t),20));let O=_(t.state.tr.delete(j,M)),L=p.resolve(b.start).marksAcross(p.resolve(b.endA));L&&O.ensureMarks(L),t.dispatch(O)}else if(b.endA==b.endB&&(R=uU(v.parent.content.cut(v.parentOffset,w.parentOffset),S.parent.content.cut(S.parentOffset,b.endA-S.start())))){let O=_(t.state.tr);R.type=="add"?O.addMark(j,M,R.mark):O.removeMark(j,M,R.mark),t.dispatch(O)}else if(v.parent.child(v.index()).isText&&v.index()==w.index()-(w.textOffset?0:1)){let O=v.parent.textBetween(v.parentOffset,w.parentOffset),L=()=>_(t.state.tr.insertText(O,j,M));t.someProp("handleTextInput",A=>A(t,j,M,O,L))||t.dispatch(L())}else t.dispatch(_());else t.dispatch(_())}function wN(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:hv(t,e.resolve(n.anchor),e.resolve(n.head))}function uU(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,s=n,i=r,o,l,d;for(let p=0;p<r.length;p++)s=r[p].removeFromSet(s);for(let p=0;p<n.length;p++)i=n[p].removeFromSet(i);if(s.length==1&&i.length==0)l=s[0],o="add",d=p=>p.mark(l.addToSet(p.marks));else if(s.length==0&&i.length==1)l=i[0],o="remove",d=p=>p.mark(l.removeFromSet(p.marks));else return null;let f=[];for(let p=0;p<e.childCount;p++)f.push(d(e.child(p)));if(Ne.from(f).eq(t))return{mark:l,type:o}}function dU(t,e,n,r,s){if(n-e<=s.pos-r.pos||ty(r,!0,!1)<s.pos)return!1;let i=t.resolve(e);if(!r.parent.isTextblock){let l=i.nodeAfter;return l!=null&&n==e+l.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=t.resolve(ty(i,!0,!0));return!o.parent.isTextblock||o.pos>n||ty(o,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function ty(t,e,n){let r=t.depth,s=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,s++,e=!1;if(n){let i=t.node(r).maybeChild(t.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function fU(t,e,n,r,s){let i=t.findDiffStart(e,n);if(i==null)return null;let{a:o,b:l}=t.findDiffEnd(e,n+t.size,n+e.size);if(s=="end"){let d=Math.max(0,i-Math.min(o,l));r-=o+d-i}if(o<i&&t.size<e.size){let d=r<=i&&r>=o?i-r:0;i-=d,i&&i<e.size&&SN(e.textBetween(i-1,i+1))&&(i+=d?1:-1),l=i+(l-o),o=i}else if(l<i){let d=r<=i&&r>=l?i-r:0;i-=d,i&&i<t.size&&SN(t.textBetween(i-1,i+1))&&(i+=d?1:-1),o=i+(o-l),l=i}return{start:i,endA:o,endB:l}}function SN(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class YM{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new R9,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(jN),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=NN(this),CN(this),this.nodeViews=TN(this),this.docView=rN(this.state.doc,kN(this),ey(this),this.dom,this),this.domObserver=new nU(this,(r,s,i,o)=>cU(this,r,s,i,o)),this.domObserver.start(),_9(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Bx(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(jN),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let s=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&($M(this),o=!0),this.state=e;let l=s.plugins!=e.plugins||this._props.plugins!=n.plugins;if(l||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let m=TN(this);pU(m,this.nodeViews)&&(this.nodeViews=m,i=!0)}(l||n.handleDOMEvents!=this._props.handleDOMEvents)&&Bx(this),this.editable=NN(this),CN(this);let d=ey(this),f=kN(this),p=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",g=i||!this.docView.matchesNode(e.doc,f,d);(g||!e.selection.eq(s.selection))&&(o=!0);let y=p=="preserve"&&o&&this.dom.style.overflowAnchor==null&&KF(this);if(o){this.domObserver.stop();let m=g&&(rr||An)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&hU(s.selection,e.selection);if(g){let b=An?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=V9(this)),(i||!this.docView.update(e.doc,f,d,this))&&(this.docView.updateOuterDeco(f),this.docView.destroy(),this.docView=rN(e.doc,f,d,this.dom,this)),b&&!this.trackWrites&&(m=!0)}m||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&m9(this))?li(this,m):(AM(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),p=="reset"?this.dom.scrollTop=0:p=="to selection"?this.scrollToSelection():y&&QF(y)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof Be){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&XC(this,n.getBoundingClientRect(),e)}else XC(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-n.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new HM(e.slice,e.move,s<0?void 0:Be.create(this.state.doc,s))}someProp(e,n){let r=this._props&&this._props[e],s;if(r!=null&&(s=n?n(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(s=n?n(l):l))return s}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let l=i[o].props[e];if(l!=null&&(s=n?n(l):l))return s}}hasFocus(){if(rr){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&WF(this.dom),li(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return ZF(this,e)}coordsAtPos(e,n=1){return SM(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let s=this.docView.posFromDOM(e,n,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,n){return s9(this,n||this.state,e)}pasteHTML(e,n){return Vu(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Vu(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return pv(this,e)}destroy(){this.docView&&(O9(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ey(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,IF())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return I9(this,e)}domSelectionRange(){let e=this.domSelection();return e?Fn&&this.root.nodeType===11&&FF(this.dom.ownerDocument)==this.dom&&sU(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}YM.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function kN(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[zn.node(0,t.state.doc.content.size,e)]}function CN(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:zn.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function NN(t){return!t.someProp("editable",e=>e(t.state)===!1)}function hU(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function TN(t){let e=Object.create(null);function n(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function pU(t,e){let n=0,r=0;for(let s in t){if(t[s]!=e[s])return!0;n++}for(let s in e)r++;return n!=r}function jN(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var da={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Hh={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},gU=typeof navigator<"u"&&/Mac/.test(navigator.platform),mU=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Sn=0;Sn<10;Sn++)da[48+Sn]=da[96+Sn]=String(Sn);for(var Sn=1;Sn<=24;Sn++)da[Sn+111]="F"+Sn;for(var Sn=65;Sn<=90;Sn++)da[Sn]=String.fromCharCode(Sn+32),Hh[Sn]=String.fromCharCode(Sn);for(var ny in da)Hh.hasOwnProperty(ny)||(Hh[ny]=da[ny]);function yU(t){var e=gU&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||mU&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Hh:da)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const xU=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),bU=typeof navigator<"u"&&/Win/.test(navigator.platform);function vU(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,s,i,o;for(let l=0;l<e.length-1;l++){let d=e[l];if(/^(cmd|meta|m)$/i.test(d))o=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))s=!0;else if(/^s(hift)?$/i.test(d))i=!0;else if(/^mod$/i.test(d))xU?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+d)}return r&&(n="Alt-"+n),s&&(n="Ctrl-"+n),o&&(n="Meta-"+n),i&&(n="Shift-"+n),n}function wU(t){let e=Object.create(null);for(let n in t)e[vU(n)]=t[n];return e}function ry(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function SU(t){return new _t({props:{handleKeyDown:GM(t)}})}function GM(t){let e=wU(t);return function(n,r){let s=yU(r),i,o=e[ry(s,r)];if(o&&o(n.state,n.dispatch,n))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let l=e[ry(s,r,!1)];if(l&&l(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(bU&&r.ctrlKey&&r.altKey)&&(i=da[r.keyCode])&&i!=s){let l=e[ry(i,r)];if(l&&l(n.state,n.dispatch,n))return!0}}return!1}}var kU=Object.defineProperty,vv=(t,e)=>{for(var n in e)kU(t,n,{get:e[n],enumerable:!0})};function Zp(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:s}=n,{storedMarks:i}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,i=n.storedMarks,n}}}var eg=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:r}=e,{tr:s}=n,i=this.buildProps(s);return Object.fromEntries(Object.entries(t).map(([o,l])=>[o,(...f)=>{const p=l(...f)(i);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(s),p}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:i}=r,o=[],l=!!t,d=t||s.tr,f=()=>(!l&&e&&!d.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(d),o.every(g=>g===!0)),p={...Object.fromEntries(Object.entries(n).map(([g,y])=>[g,(...b)=>{const v=this.buildProps(d,e),w=y(...b)(v);return o.push(w),p}])),run:f};return p}createCan(t){const{rawCommands:e,state:n}=this,r=!1,s=t||n.tr,i=this.buildProps(s,r);return{...Object.fromEntries(Object.entries(e).map(([l,d])=>[l,(...f)=>d(...f)({...i,dispatch:void 0})])),chain:()=>this.createChain(s,r)}}buildProps(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:i}=r,o={tr:t,editor:r,view:i,state:Zp({state:s,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([l,d])=>[l,(...f)=>d(...f)(o)]))}};return o}},XM={};vv(XM,{blur:()=>CU,clearContent:()=>NU,clearNodes:()=>TU,command:()=>jU,createParagraphNear:()=>EU,cut:()=>MU,deleteCurrentNode:()=>AU,deleteNode:()=>RU,deleteRange:()=>_U,deleteSelection:()=>OU,enter:()=>DU,exitCode:()=>IU,extendMarkRange:()=>LU,first:()=>zU,focus:()=>BU,forEach:()=>FU,insertContent:()=>UU,insertContentAt:()=>HU,joinBackward:()=>QU,joinDown:()=>KU,joinForward:()=>WU,joinItemBackward:()=>YU,joinItemForward:()=>GU,joinTextblockBackward:()=>XU,joinTextblockForward:()=>JU,joinUp:()=>VU,keyboardShortcut:()=>e$,lift:()=>t$,liftEmptyBlock:()=>n$,liftListItem:()=>r$,newlineInCode:()=>s$,resetAttributes:()=>i$,scrollIntoView:()=>a$,selectAll:()=>o$,selectNodeBackward:()=>l$,selectNodeForward:()=>c$,selectParentNode:()=>u$,selectTextblockEnd:()=>d$,selectTextblockStart:()=>f$,setContent:()=>h$,setMark:()=>R$,setMeta:()=>_$,setNode:()=>O$,setNodeSelection:()=>D$,setTextDirection:()=>I$,setTextSelection:()=>L$,sinkListItem:()=>z$,splitBlock:()=>P$,splitListItem:()=>B$,toggleList:()=>F$,toggleMark:()=>U$,toggleNode:()=>$$,toggleWrap:()=>q$,undoInputRule:()=>H$,unsetAllMarks:()=>V$,unsetMark:()=>K$,unsetTextDirection:()=>Q$,updateAttributes:()=>W$,wrapIn:()=>Y$,wrapInList:()=>G$});var CU=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window?.getSelection())==null||n.removeAllRanges())}),!0),NU=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),TU=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:s}=r;return n&&s.forEach(({$from:i,$to:o})=>{t.doc.nodesBetween(i.pos,o.pos,(l,d)=>{if(l.type.isText)return;const{doc:f,mapping:p}=e,g=f.resolve(p.map(d)),y=f.resolve(p.map(d+l.nodeSize)),m=g.blockRange(y);if(!m)return;const b=nc(m);if(l.type.isTextblock){const{defaultType:v}=g.parent.contentMatchAt(g.index());e.setNodeMarkup(m.start,v)}(b||b===0)&&e.lift(m,b)})}),!0},jU=t=>e=>t(e),EU=()=>({state:t,dispatch:e})=>fM(t,e),MU=(t,e)=>({editor:n,tr:r})=>{const{state:s}=n,i=s.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const o=r.mapping.map(e);return r.insert(o,i.content),r.setSelection(new qe(r.doc.resolve(Math.max(o-1,0)))),!0},AU=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const s=t.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===r.type){if(e){const l=s.before(i),d=s.after(i);t.delete(l,d).scrollIntoView()}return!0}return!1};function Jt(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var RU=t=>({tr:e,state:n,dispatch:r})=>{const s=Jt(t,n.schema),i=e.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s){if(r){const d=i.before(o),f=i.after(o);e.delete(d,f).scrollIntoView()}return!0}return!1},_U=t=>({tr:e,dispatch:n})=>{const{from:r,to:s}=t;return n&&e.delete(r,s),!0},OU=()=>({state:t,dispatch:e})=>av(t,e),DU=()=>({commands:t})=>t.keyboardShortcut("Enter"),IU=()=>({state:t,dispatch:e})=>vF(t,e);function wv(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Vh(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>n.strict?e[s]===t[s]:wv(e[s])?e[s].test(t[s]):e[s]===t[s]):!0}function JM(t,e,n={}){return t.find(r=>r.type===e&&Vh(Object.fromEntries(Object.keys(n).map(s=>[s,r.attrs[s]])),n))}function EN(t,e,n={}){return!!JM(t,e,n)}function Sv(t,e,n){var r;if(!t||!e)return;let s=t.parent.childAfter(t.parentOffset);if((!s.node||!s.node.marks.some(p=>p.type===e))&&(s=t.parent.childBefore(t.parentOffset)),!s.node||!s.node.marks.some(p=>p.type===e)||(n=n||((r=s.node.marks[0])==null?void 0:r.attrs),!JM([...s.node.marks],e,n)))return;let o=s.index,l=t.start()+s.offset,d=o+1,f=l+s.node.nodeSize;for(;o>0&&EN([...t.parent.child(o-1).marks],e,n);)o-=1,l-=t.parent.child(o).nodeSize;for(;d<t.parent.childCount&&EN([...t.parent.child(d).marks],e,n);)f+=t.parent.child(d).nodeSize,d+=1;return{from:l,to:f}}function gi(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var LU=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const i=gi(t,r.schema),{doc:o,selection:l}=n,{$from:d,from:f,to:p}=l;if(s){const g=Sv(d,i,e);if(g&&g.from<=f&&g.to>=p){const y=qe.create(o,g.from,g.to);n.setSelection(y)}}return!0},zU=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function ZM(t){return t instanceof qe}function Ba(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function e5(t,e=null){if(!e)return null;const n=Ge.atStart(t),r=Ge.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const s=n.from,i=r.to;return e==="all"?qe.create(t,Ba(0,s,i),Ba(t.content.size,s,i)):qe.create(t,Ba(e,s,i),Ba(e,s,i))}function PU(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function kv(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var BU=(t=null,e={})=>({editor:n,view:r,tr:s,dispatch:i})=>{e={scrollIntoView:!0,...e};const o=()=>{(kv()||PU())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e?.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(i&&t===null&&!ZM(n.state.selection))return o(),!0;const l=e5(s.doc,t)||n.state.selection,d=n.state.selection.eq(l);return i&&(d||s.setSelection(l),d&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},FU=(t,e)=>n=>t.every((r,s)=>e(r,{...n,index:s})),UU=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),t5=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&t5(r)}return t};function Kf(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return t5(n)}function Qu(t,e,n){if(t instanceof aa||t instanceof Ne)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,s=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return Ne.fromArray(t.map(l=>e.nodeFromJSON(l)));const o=e.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(i){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",i),Qu("",e,n)}if(s){if(n.errorOnInvalidContent){let o=!1,l="";const d=new B3({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:f=>(o=!0,l=typeof f=="string"?f:f.outerHTML,null)}]}})});if(n.slice?vu.fromSchema(d).parseSlice(Kf(t),n.parseOptions):vu.fromSchema(d).parse(Kf(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const i=vu.fromSchema(e);return n.slice?i.parseSlice(Kf(t),n.parseOptions).content:i.parse(Kf(t),n.parseOptions)}return Qu("",e,n)}function $U(t,e,n){const r=t.steps.length-1;if(r<e)return;const s=t.steps[r];if(!(s instanceof un||s instanceof fn))return;const i=t.mapping.maps[r];let o=0;i.forEach((l,d,f,p)=>{o===0&&(o=p)}),t.setSelection(Ge.near(t.doc.resolve(o),n))}var qU=t=>!("type"in t),HU=(t,e,n)=>({tr:r,dispatch:s,editor:i})=>{var o;if(s){n={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let l;const d=w=>{i.emit("contentError",{editor:i,error:w,disableCollaboration:()=>{"collaboration"in i.storage&&typeof i.storage.collaboration=="object"&&i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},f={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{Qu(e,i.schema,{parseOptions:f,errorOnInvalidContent:!0})}catch(w){d(w)}try{l=Qu(e,i.schema,{parseOptions:f,errorOnInvalidContent:(o=n.errorOnInvalidContent)!=null?o:i.options.enableContentCheck})}catch(w){return d(w),!1}let{from:p,to:g}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},y=!0,m=!0;if((qU(l)?l:[l]).forEach(w=>{w.check(),y=y?w.isText&&w.marks.length===0:!1,m=m?w.isBlock:!1}),p===g&&m){const{parent:w}=r.doc.resolve(p);w.isTextblock&&!w.type.spec.code&&!w.childCount&&(p-=1,g+=1)}let v;if(y){if(Array.isArray(e))v=e.map(w=>w.text||"").join("");else if(e instanceof Ne){let w="";e.forEach(S=>{S.text&&(w+=S.text)}),v=w}else typeof e=="object"&&e&&e.text?v=e.text:v=e;r.insertText(v,p,g)}else{v=l;const w=r.doc.resolve(p),S=w.node(),T=w.parentOffset===0,j=S.isText||S.isTextblock,M=S.content.size>0;T&&j&&M&&(p=Math.max(0,p-1)),r.replaceWith(p,g,v)}n.updateSelection&&$U(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:p,text:v}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:p,text:v})}return!0},VU=()=>({state:t,dispatch:e})=>yF(t,e),KU=()=>({state:t,dispatch:e})=>xF(t,e),QU=()=>({state:t,dispatch:e})=>iM(t,e),WU=()=>({state:t,dispatch:e})=>cM(t,e),YU=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Qp(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},GU=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Qp(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},XU=()=>({state:t,dispatch:e})=>gF(t,e),JU=()=>({state:t,dispatch:e})=>mF(t,e);function n5(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function ZU(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,s,i,o;for(let l=0;l<e.length-1;l+=1){const d=e[l];if(/^(cmd|meta|m)$/i.test(d))o=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))s=!0;else if(/^s(hift)?$/i.test(d))i=!0;else if(/^mod$/i.test(d))kv()||n5()?o=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),i&&(n=`Shift-${n}`),n}var e$=t=>({editor:e,view:n,tr:r,dispatch:s})=>{const i=ZU(t).split(/-(?!$)/),o=i.find(f=>!["Alt","Ctrl","Meta","Shift"].includes(f)),l=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),d=e.captureTransaction(()=>{n.someProp("handleKeyDown",f=>f(n,l))});return d?.steps.forEach(f=>{const p=f.map(r.mapping);p&&s&&r.maybeStep(p)}),!0};function fa(t,e,n={}){const{from:r,to:s,empty:i}=t.selection,o=e?Jt(e,t.schema):null,l=[];t.doc.nodesBetween(r,s,(g,y)=>{if(g.isText)return;const m=Math.max(r,y),b=Math.min(s,y+g.nodeSize);l.push({node:g,from:m,to:b})});const d=s-r,f=l.filter(g=>o?o.name===g.node.type.name:!0).filter(g=>Vh(g.node.attrs,n,{strict:!1}));return i?!!f.length:f.reduce((g,y)=>g+y.to-y.from,0)>=d}var t$=(t,e={})=>({state:n,dispatch:r})=>{const s=Jt(t,n.schema);return fa(n,s,e)?bF(n,r):!1},n$=()=>({state:t,dispatch:e})=>hM(t,e),r$=t=>({state:e,dispatch:n})=>{const r=Jt(t,e.schema);return RF(r)(e,n)},s$=()=>({state:t,dispatch:e})=>dM(t,e);function tg(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function MN(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,s)=>(n.includes(s)||(r[s]=t[s]),r),{})}var i$=(t,e)=>({tr:n,state:r,dispatch:s})=>{let i=null,o=null;const l=tg(typeof t=="string"?t:t.name,r.schema);if(!l)return!1;l==="node"&&(i=Jt(t,r.schema)),l==="mark"&&(o=gi(t,r.schema));let d=!1;return n.selection.ranges.forEach(f=>{r.doc.nodesBetween(f.$from.pos,f.$to.pos,(p,g)=>{i&&i===p.type&&(d=!0,s&&n.setNodeMarkup(g,void 0,MN(p.attrs,e))),o&&p.marks.length&&p.marks.forEach(y=>{o===y.type&&(d=!0,s&&n.addMark(g,g+p.nodeSize,o.create(MN(y.attrs,e))))})})}),d},a$=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),o$=()=>({tr:t,dispatch:e})=>{if(e){const n=new Sr(t.doc);t.setSelection(n)}return!0},l$=()=>({state:t,dispatch:e})=>oM(t,e),c$=()=>({state:t,dispatch:e})=>uM(t,e),u$=()=>({state:t,dispatch:e})=>kF(t,e),d$=()=>({state:t,dispatch:e})=>TF(t,e),f$=()=>({state:t,dispatch:e})=>NF(t,e);function Fx(t,e,n={},r={}){return Qu(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var h$=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:s,tr:i,dispatch:o,commands:l})=>{const{doc:d}=i;if(r.preserveWhitespace!=="full"){const f=Fx(t,s.schema,r,{errorOnInvalidContent:e??s.options.enableContentCheck});return o&&i.replaceWith(0,d.content.size,f).setMeta("preventUpdate",!n),!0}return o&&i.setMeta("preventUpdate",!n),l.insertContentAt({from:0,to:d.content.size},t,{parseOptions:r,errorOnInvalidContent:e??s.options.enableContentCheck})};function r5(t,e){const n=gi(e,t.schema),{from:r,to:s,empty:i}=t.selection,o=[];i?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,s,d=>{o.push(...d.marks)});const l=o.find(d=>d.type.name===n.name);return l?{...l.attrs}:{}}function s5(t,e){const n=new tM(t);return e.forEach(r=>{r.steps.forEach(s=>{n.step(s)})}),n}function p$(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function g$(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(s,i)=>{n(s)&&r.push({node:s,pos:i})}),r}function m$(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function ng(t){return e=>m$(e.$from,t)}function Pe(t,e,n){return t.config[e]===void 0&&t.parent?Pe(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?Pe(t.parent,e,n):null}):t.config[e]}function Cv(t){return t.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=Pe(e,"addExtensions",n);return r?[e,...Cv(r())]:e}).flat(10)}function Nv(t,e){const n=vo.fromSchema(e).serializeFragment(t),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}function i5(t){return typeof t=="function"}function gt(t,e=void 0,...n){return i5(t)?e?t.bind(e)(...n):t(...n):t}function y$(t={}){return Object.keys(t).length===0&&t.constructor===Object}function Hl(t){const e=t.filter(s=>s.type==="extension"),n=t.filter(s=>s.type==="node"),r=t.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function a5(t){const e=[],{nodeExtensions:n,markExtensions:r}=Hl(t),s=[...n,...r],i={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage,extensions:s},d=Pe(o,"addGlobalAttributes",l);if(!d)return;d().forEach(p=>{p.types.forEach(g=>{Object.entries(p.attributes).forEach(([y,m])=>{e.push({type:g,name:y,attribute:{...i,...m}})})})})}),s.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage},d=Pe(o,"addAttributes",l);if(!d)return;const f=d();Object.entries(f).forEach(([p,g])=>{const y={...i,...g};typeof y?.default=="function"&&(y.default=y.default()),y?.isRequired&&y?.default===void 0&&delete y.default,e.push({type:o.name,name:p,attribute:y})})}),e}function Zt(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([s,i])=>{if(!r[s]){r[s]=i;return}if(s==="class"){const l=i?String(i).split(" "):[],d=r[s]?r[s].split(" "):[],f=l.filter(p=>!d.includes(p));r[s]=[...d,...f].join(" ")}else if(s==="style"){const l=i?i.split(";").map(p=>p.trim()).filter(Boolean):[],d=r[s]?r[s].split(";").map(p=>p.trim()).filter(Boolean):[],f=new Map;d.forEach(p=>{const[g,y]=p.split(":").map(m=>m.trim());f.set(g,y)}),l.forEach(p=>{const[g,y]=p.split(":").map(m=>m.trim());f.set(g,y)}),r[s]=Array.from(f.entries()).map(([p,g])=>`${p}: ${g}`).join("; ")}else r[s]=i}),r},{})}function Kh(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>Zt(n,r),{})}function x$(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function AN(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const s=e.reduce((i,o)=>{const l=o.attribute.parseHTML?o.attribute.parseHTML(n):x$(n.getAttribute(o.name));return l==null?i:{...i,[o.name]:l}},{});return{...r,...s}}}}function RN(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&y$(n)?!1:n!=null))}function _N(t){var e,n;const r={};return!((e=t?.attribute)!=null&&e.isRequired)&&"default"in(t?.attribute||{})&&(r.default=t.attribute.default),((n=t?.attribute)==null?void 0:n.validate)!==void 0&&(r.validate=t.attribute.validate),[t.name,r]}function b$(t,e){var n;const r=a5(t),{nodeExtensions:s,markExtensions:i}=Hl(t),o=(n=s.find(f=>Pe(f,"topNode")))==null?void 0:n.name,l=Object.fromEntries(s.map(f=>{const p=r.filter(S=>S.type===f.name),g={name:f.name,options:f.options,storage:f.storage,editor:e},y=t.reduce((S,T)=>{const j=Pe(T,"extendNodeSchema",g);return{...S,...j?j(f):{}}},{}),m=RN({...y,content:gt(Pe(f,"content",g)),marks:gt(Pe(f,"marks",g)),group:gt(Pe(f,"group",g)),inline:gt(Pe(f,"inline",g)),atom:gt(Pe(f,"atom",g)),selectable:gt(Pe(f,"selectable",g)),draggable:gt(Pe(f,"draggable",g)),code:gt(Pe(f,"code",g)),whitespace:gt(Pe(f,"whitespace",g)),linebreakReplacement:gt(Pe(f,"linebreakReplacement",g)),defining:gt(Pe(f,"defining",g)),isolating:gt(Pe(f,"isolating",g)),attrs:Object.fromEntries(p.map(_N))}),b=gt(Pe(f,"parseHTML",g));b&&(m.parseDOM=b.map(S=>AN(S,p)));const v=Pe(f,"renderHTML",g);v&&(m.toDOM=S=>v({node:S,HTMLAttributes:Kh(S,p)}));const w=Pe(f,"renderText",g);return w&&(m.toText=w),[f.name,m]})),d=Object.fromEntries(i.map(f=>{const p=r.filter(w=>w.type===f.name),g={name:f.name,options:f.options,storage:f.storage,editor:e},y=t.reduce((w,S)=>{const T=Pe(S,"extendMarkSchema",g);return{...w,...T?T(f):{}}},{}),m=RN({...y,inclusive:gt(Pe(f,"inclusive",g)),excludes:gt(Pe(f,"excludes",g)),group:gt(Pe(f,"group",g)),spanning:gt(Pe(f,"spanning",g)),code:gt(Pe(f,"code",g)),attrs:Object.fromEntries(p.map(_N))}),b=gt(Pe(f,"parseHTML",g));b&&(m.parseDOM=b.map(w=>AN(w,p)));const v=Pe(f,"renderHTML",g);return v&&(m.toDOM=w=>v({mark:w,HTMLAttributes:Kh(w,p)})),[f.name,m]}));return new B3({topNode:o,nodes:l,marks:d})}function v$(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}function Tv(t){return t.sort((n,r)=>{const s=Pe(n,"priority")||100,i=Pe(r,"priority")||100;return s>i?-1:s<i?1:0})}function o5(t){const e=Tv(Cv(t)),n=v$(e.map(r=>r.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function l5(t,e,n){const{from:r,to:s}=e,{blockSeparator:i=`

`,textSerializers:o={}}=n||{};let l="";return t.nodesBetween(r,s,(d,f,p,g)=>{var y;d.isBlock&&f>r&&(l+=i);const m=o?.[d.type.name];if(m)return p&&(l+=m({node:d,pos:f,parent:p,index:g,range:e})),!1;d.isText&&(l+=(y=d?.text)==null?void 0:y.slice(Math.max(r,f)-f,s-f))}),l}function w$(t,e){const n={from:0,to:t.content.size};return l5(t,n,e)}function c5(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function S$(t,e){const n=Jt(e,t.schema),{from:r,to:s}=t.selection,i=[];t.doc.nodesBetween(r,s,l=>{i.push(l)});const o=i.reverse().find(l=>l.type.name===n.name);return o?{...o.attrs}:{}}function u5(t,e){const n=tg(typeof e=="string"?e:e.name,t.schema);return n==="node"?S$(t,e):n==="mark"?r5(t,e):{}}function k$(t,e=JSON.stringify){const n={};return t.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(n,s)?!1:n[s]=!0})}function C$(t){const e=k$(t);return e.length===1?e:e.filter((n,r)=>!e.filter((i,o)=>o!==r).some(i=>n.oldRange.from>=i.oldRange.from&&n.oldRange.to<=i.oldRange.to&&n.newRange.from>=i.newRange.from&&n.newRange.to<=i.newRange.to))}function d5(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((s,i)=>{const o=[];if(s.ranges.length)s.forEach((l,d)=>{o.push({from:l,to:d})});else{const{from:l,to:d}=n[i];if(l===void 0||d===void 0)return;o.push({from:l,to:d})}o.forEach(({from:l,to:d})=>{const f=e.slice(i).map(l,-1),p=e.slice(i).map(d),g=e.invert().map(f,-1),y=e.invert().map(p);r.push({oldRange:{from:g,to:y},newRange:{from:f,to:p}})})}),C$(r)}function jv(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(s=>{const i=n.resolve(t),o=Sv(i,s.type);o&&r.push({mark:s,...o})}):n.nodesBetween(t,e,(s,i)=>{!s||s?.nodeSize===void 0||r.push(...s.marks.map(o=>({from:i,to:i+s.nodeSize,mark:o})))}),r}var N$=(t,e,n,r=20)=>{const s=t.doc.resolve(n);let i=r,o=null;for(;i>0&&o===null;){const l=s.node(i);l?.type.name===e?o=l:i-=1}return[o,i]};function sy(t,e){return e.nodes[t]||e.marks[t]||null}function ch(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=t.find(i=>i.type===e&&i.name===r);return s?s.attribute.keepOnSplit:!1}))}var T$=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(s,i,o,l)=>{var d,f;const p=((f=(d=s.type.spec).toText)==null?void 0:f.call(d,{node:s,pos:i,parent:o,index:l}))||s.textContent||"%leaf%";n+=s.isAtom&&!s.isText?p:p.slice(0,Math.max(0,r-i))}),n};function Ux(t,e,n={}){const{empty:r,ranges:s}=t.selection,i=e?gi(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(g=>i?i.name===g.type.name:!0).find(g=>Vh(g.attrs,n,{strict:!1}));let o=0;const l=[];if(s.forEach(({$from:g,$to:y})=>{const m=g.pos,b=y.pos;t.doc.nodesBetween(m,b,(v,w)=>{if(!v.isText&&!v.marks.length)return;const S=Math.max(m,w),T=Math.min(b,w+v.nodeSize),j=T-S;o+=j,l.push(...v.marks.map(M=>({mark:M,from:S,to:T})))})}),o===0)return!1;const d=l.filter(g=>i?i.name===g.mark.type.name:!0).filter(g=>Vh(g.mark.attrs,n,{strict:!1})).reduce((g,y)=>g+y.to-y.from,0),f=l.filter(g=>i?g.mark.type!==i&&g.mark.type.excludes(i):!0).reduce((g,y)=>g+y.to-y.from,0);return(d>0?d+f:d)>=o}function j$(t,e,n={}){if(!e)return fa(t,null,n)||Ux(t,null,n);const r=tg(e,t.schema);return r==="node"?fa(t,e,n):r==="mark"?Ux(t,e,n):!1}var E$=(t,e)=>{const{$from:n,$to:r,$anchor:s}=t.selection;if(e){const i=ng(l=>l.type.name===e)(t.selection);if(!i)return!1;const o=t.doc.resolve(i.pos+1);return s.pos+1===o.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)},M$=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function ON(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function DN(t,e){const{nodeExtensions:n}=Hl(e),r=n.find(o=>o.name===t);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},i=gt(Pe(r,"group",s));return typeof i!="string"?!1:i.split(" ").includes("list")}function rg(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!=null?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let s=!0;return t.content.forEach(i=>{s!==!1&&(rg(i,{ignoreWhitespace:n,checkChildren:e})||(s=!1))}),s}return!1}function f5(t){return t instanceof Be}function A$(t,e,n){var r;const{selection:s}=e;let i=null;if(ZM(s)&&(i=s.$cursor),i){const l=(r=t.storedMarks)!=null?r:i.marks();return i.parent.type.allowsMarkType(n)&&(!!n.isInSet(l)||!l.some(f=>f.type.excludes(n)))}const{ranges:o}=s;return o.some(({$from:l,$to:d})=>{let f=l.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(l.pos,d.pos,(p,g,y)=>{if(f)return!1;if(p.isInline){const m=!y||y.type.allowsMarkType(n),b=!!n.isInSet(p.marks)||!p.marks.some(v=>v.type.excludes(n));f=m&&b}return!f}),f})}var R$=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const{selection:i}=n,{empty:o,ranges:l}=i,d=gi(t,r.schema);if(s)if(o){const f=r5(r,d);n.addStoredMark(d.create({...f,...e}))}else l.forEach(f=>{const p=f.$from.pos,g=f.$to.pos;r.doc.nodesBetween(p,g,(y,m)=>{const b=Math.max(m,p),v=Math.min(m+y.nodeSize,g);y.marks.find(S=>S.type===d)?y.marks.forEach(S=>{d===S.type&&n.addMark(b,v,d.create({...S.attrs,...e}))}):n.addMark(b,v,d.create(e))})});return A$(r,n,d)},_$=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),O$=(t,e={})=>({state:n,dispatch:r,chain:s})=>{const i=Jt(t,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),i.isTextblock?s().command(({commands:l})=>WC(i,{...o,...e})(n)?!0:l.clearNodes()).command(({state:l})=>WC(i,{...o,...e})(l,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},D$=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,s=Ba(t,0,r.content.size),i=Be.create(r,s);e.setSelection(i)}return!0},I$=(t,e)=>({tr:n,state:r,dispatch:s})=>{const{selection:i}=r;let o,l;return typeof e=="number"?(o=e,l=e):e&&"from"in e&&"to"in e?(o=e.from,l=e.to):(o=i.from,l=i.to),s&&n.doc.nodesBetween(o,l,(d,f)=>{d.isText||n.setNodeMarkup(f,void 0,{...d.attrs,dir:t})}),!0},L$=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:s,to:i}=typeof t=="number"?{from:t,to:t}:t,o=qe.atStart(r).from,l=qe.atEnd(r).to,d=Ba(s,o,l),f=Ba(i,o,l),p=qe.create(r,d,f);e.setSelection(p)}return!0},z$=t=>({state:e,dispatch:n})=>{const r=Jt(t,e.schema);return DF(r)(e,n)};function IN(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(s=>e?.includes(s.type.name));t.tr.ensureMarks(r)}}var P$=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:s})=>{const{selection:i,doc:o}=e,{$from:l,$to:d}=i,f=s.extensionManager.attributes,p=ch(f,l.node().type.name,l.node().attrs);if(i instanceof Be&&i.node.isBlock)return!l.parentOffset||!oi(o,l.pos)?!1:(r&&(t&&IN(n,s.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const g=d.parentOffset===d.parent.content.size,y=l.depth===0?void 0:p$(l.node(-1).contentMatchAt(l.indexAfter(-1)));let m=g&&y?[{type:y,attrs:p}]:void 0,b=oi(e.doc,e.mapping.map(l.pos),1,m);if(!m&&!b&&oi(e.doc,e.mapping.map(l.pos),1,y?[{type:y}]:void 0)&&(b=!0,m=y?[{type:y,attrs:p}]:void 0),r){if(b&&(i instanceof qe&&e.deleteSelection(),e.split(e.mapping.map(l.pos),1,m),y&&!g&&!l.parentOffset&&l.parent.type!==y)){const v=e.mapping.map(l.before()),w=e.doc.resolve(v);l.node(-1).canReplaceWith(w.index(),w.index()+1,y)&&e.setNodeMarkup(e.mapping.map(l.before()),y)}t&&IN(n,s.extensionManager.splittableMarks),e.scrollIntoView()}return b},B$=(t,e={})=>({tr:n,state:r,dispatch:s,editor:i})=>{var o;const l=Jt(t,r.schema),{$from:d,$to:f}=r.selection,p=r.selection.node;if(p&&p.isBlock||d.depth<2||!d.sameParent(f))return!1;const g=d.node(-1);if(g.type!==l)return!1;const y=i.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==l||d.index(-2)!==d.node(-2).childCount-1)return!1;if(s){let S=Ne.empty;const T=d.index(-1)?1:d.index(-2)?2:3;for(let L=d.depth-T;L>=d.depth-3;L-=1)S=Ne.from(d.node(L).copy(S));const j=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,M={...ch(y,d.node().type.name,d.node().attrs),...e},_=((o=l.contentMatch.defaultType)==null?void 0:o.createAndFill(M))||void 0;S=S.append(Ne.from(l.createAndFill(null,_)||void 0));const R=d.before(d.depth-(T-1));n.replace(R,d.after(-j),new Ae(S,4-T,0));let O=-1;n.doc.nodesBetween(R,n.doc.content.size,(L,A)=>{if(O>-1)return!1;L.isTextblock&&L.content.size===0&&(O=A+1)}),O>-1&&n.setSelection(qe.near(n.doc.resolve(O))),n.scrollIntoView()}return!0}const m=f.pos===d.end()?g.contentMatchAt(0).defaultType:null,b={...ch(y,g.type.name,g.attrs),...e},v={...ch(y,d.node().type.name,d.node().attrs),...e};n.delete(d.pos,f.pos);const w=m?[{type:l,attrs:b},{type:m,attrs:v}]:[{type:l,attrs:b}];if(!oi(n.doc,d.pos,2))return!1;if(s){const{selection:S,storedMarks:T}=r,{splittableMarks:j}=i.extensionManager,M=T||S.$to.parentOffset&&S.$from.marks();if(n.split(d.pos,2,w).scrollIntoView(),!M||!s)return!0;const _=M.filter(R=>j.includes(R.type.name));n.ensureMarks(_)}return!0},iy=(t,e)=>{const n=ng(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===s?.type&&pa(t.doc,n.pos)&&t.join(n.pos),!0},ay=(t,e)=>{const n=ng(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===s?.type&&pa(t.doc,r)&&t.join(r),!0},F$=(t,e,n,r={})=>({editor:s,tr:i,state:o,dispatch:l,chain:d,commands:f,can:p})=>{const{extensions:g,splittableMarks:y}=s.extensionManager,m=Jt(t,o.schema),b=Jt(e,o.schema),{selection:v,storedMarks:w}=o,{$from:S,$to:T}=v,j=S.blockRange(T),M=w||v.$to.parentOffset&&v.$from.marks();if(!j)return!1;const _=ng(R=>DN(R.type.name,g))(v);if(j.depth>=1&&_&&j.depth-_.depth<=1){if(_.node.type===m)return f.liftListItem(b);if(DN(_.node.type.name,g)&&m.validContent(_.node.content)&&l)return d().command(()=>(i.setNodeMarkup(_.pos,m),!0)).command(()=>iy(i,m)).command(()=>ay(i,m)).run()}return!n||!M||!l?d().command(()=>p().wrapInList(m,r)?!0:f.clearNodes()).wrapInList(m,r).command(()=>iy(i,m)).command(()=>ay(i,m)).run():d().command(()=>{const R=p().wrapInList(m,r),O=M.filter(L=>y.includes(L.type.name));return i.ensureMarks(O),R?!0:f.clearNodes()}).wrapInList(m,r).command(()=>iy(i,m)).command(()=>ay(i,m)).run()},U$=(t,e={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:i=!1}=n,o=gi(t,r.schema);return Ux(r,o,e)?s.unsetMark(o,{extendEmptyMarkRange:i}):s.setMark(o,e)},$$=(t,e,n={})=>({state:r,commands:s})=>{const i=Jt(t,r.schema),o=Jt(e,r.schema),l=fa(r,i,n);let d;return r.selection.$anchor.sameParent(r.selection.$head)&&(d=r.selection.$anchor.parent.attrs),l?s.setNode(o,d):s.setNode(i,{...d,...n})},q$=(t,e={})=>({state:n,commands:r})=>{const s=Jt(t,n.schema);return fa(n,s,e)?r.lift(s):r.wrapIn(s,e)},H$=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let i;if(s.spec.isInputRules&&(i=s.getState(t))){if(e){const o=t.tr,l=i.transform;for(let d=l.steps.length-1;d>=0;d-=1)o.step(l.steps[d].invert(l.docs[d]));if(i.text){const d=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,t.schema.text(i.text,d))}else o.delete(i.from,i.to)}return!0}}return!1},V$=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:s}=n;return r||e&&s.forEach(i=>{t.removeMark(i.$from.pos,i.$to.pos)}),!0},K$=(t,e={})=>({tr:n,state:r,dispatch:s})=>{var i;const{extendEmptyMarkRange:o=!1}=e,{selection:l}=n,d=gi(t,r.schema),{$from:f,empty:p,ranges:g}=l;if(!s)return!0;if(p&&o){let{from:y,to:m}=l;const b=(i=f.marks().find(w=>w.type===d))==null?void 0:i.attrs,v=Sv(f,d,b);v&&(y=v.from,m=v.to),n.removeMark(y,m,d)}else g.forEach(y=>{n.removeMark(y.$from.pos,y.$to.pos,d)});return n.removeStoredMark(d),!0},Q$=t=>({tr:e,state:n,dispatch:r})=>{const{selection:s}=n;let i,o;return typeof t=="number"?(i=t,o=t):t&&"from"in t&&"to"in t?(i=t.from,o=t.to):(i=s.from,o=s.to),r&&e.doc.nodesBetween(i,o,(l,d)=>{if(l.isText)return;const f={...l.attrs};delete f.dir,e.setNodeMarkup(d,void 0,f)}),!0},W$=(t,e={})=>({tr:n,state:r,dispatch:s})=>{let i=null,o=null;const l=tg(typeof t=="string"?t:t.name,r.schema);if(!l)return!1;l==="node"&&(i=Jt(t,r.schema)),l==="mark"&&(o=gi(t,r.schema));let d=!1;return n.selection.ranges.forEach(f=>{const p=f.$from.pos,g=f.$to.pos;let y,m,b,v;n.selection.empty?r.doc.nodesBetween(p,g,(w,S)=>{i&&i===w.type&&(d=!0,b=Math.max(S,p),v=Math.min(S+w.nodeSize,g),y=S,m=w)}):r.doc.nodesBetween(p,g,(w,S)=>{S<p&&i&&i===w.type&&(d=!0,b=Math.max(S,p),v=Math.min(S+w.nodeSize,g),y=S,m=w),S>=p&&S<=g&&(i&&i===w.type&&(d=!0,s&&n.setNodeMarkup(S,void 0,{...w.attrs,...e})),o&&w.marks.length&&w.marks.forEach(T=>{if(o===T.type&&(d=!0,s)){const j=Math.max(S,p),M=Math.min(S+w.nodeSize,g);n.addMark(j,M,o.create({...T.attrs,...e}))}}))}),m&&(y!==void 0&&s&&n.setNodeMarkup(y,void 0,{...m.attrs,...e}),o&&m.marks.length&&m.marks.forEach(w=>{o===w.type&&s&&n.addMark(b,v,o.create({...w.attrs,...e}))}))}),d},Y$=(t,e={})=>({state:n,dispatch:r})=>{const s=Jt(t,n.schema);return jF(s,e)(n,r)},G$=(t,e={})=>({state:n,dispatch:r})=>{const s=Jt(t,n.schema);return EF(s,e)(n,r)},X$=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(r=>r.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(r=>r!==e):delete this.callbacks[t]),this}once(t,e){const n=(...r)=>{this.off(t,n),e.apply(this,r)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},sg=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},J$=(t,e)=>{if(wv(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Qf(t){var e;const{editor:n,from:r,to:s,text:i,rules:o,plugin:l}=t,{view:d}=n;if(d.composing)return!1;const f=d.state.doc.resolve(r);if(f.parent.type.spec.code||(e=f.nodeBefore||f.nodeAfter)!=null&&e.marks.find(y=>y.type.spec.code))return!1;let p=!1;const g=T$(f)+i;return o.forEach(y=>{if(p)return;const m=J$(g,y.find);if(!m)return;const b=d.state.tr,v=Zp({state:d.state,transaction:b}),w={from:r-(m[0].length-i.length),to:s},{commands:S,chain:T,can:j}=new eg({editor:n,state:v});y.handler({state:v,range:w,match:m,commands:S,chain:T,can:j})===null||!b.steps.length||(y.undoable&&b.setMeta(l,{transform:b,from:r,to:s,text:i}),d.dispatch(b),p=!0)}),p}function Z$(t){const{editor:e,rules:n}=t,r=new _t({state:{init(){return null},apply(s,i,o){const l=s.getMeta(r);if(l)return l;const d=s.getMeta("applyInputRules");return!!d&&setTimeout(()=>{let{text:p}=d;typeof p=="string"?p=p:p=Nv(Ne.from(p),o.schema);const{from:g}=d,y=g+p.length;Qf({editor:e,from:g,to:y,text:p,rules:n,plugin:r})}),s.selectionSet||s.docChanged?null:i}},props:{handleTextInput(s,i,o,l){return Qf({editor:e,from:i,to:o,text:l,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:i}=s.state.selection;i&&Qf({editor:e,from:i.pos,to:i.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,i){if(i.key!=="Enter")return!1;const{$cursor:o}=s.state.selection;return o?Qf({editor:e,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function eq(t){return Object.prototype.toString.call(t).slice(8,-1)}function Wf(t){return eq(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function h5(t,e){const n={...t};return Wf(t)&&Wf(e)&&Object.keys(e).forEach(r=>{Wf(e[r])&&Wf(t[r])?n[r]=h5(t[r],e[r]):n[r]=e[r]}),n}var Ev=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...gt(Pe(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...gt(Pe(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>h5(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},wo=class p5 extends Ev{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new p5(n)}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const o=s.marks();if(!!!o.find(f=>f?.type.name===n.name))return!1;const d=o.find(f=>f?.type.name===n.name);return d&&r.removeStoredMark(d),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function tq(t){return typeof t=="number"}var nq=class{constructor(t){this.find=t.find,this.handler=t.handler}},rq=(t,e,n)=>{if(wv(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(s=>{const i=[s.text];return i.index=s.index,i.input=t,i.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(s.replaceWith)),i}):[]};function sq(t){const{editor:e,state:n,from:r,to:s,rule:i,pasteEvent:o,dropEvent:l}=t,{commands:d,chain:f,can:p}=new eg({editor:e,state:n}),g=[];return n.doc.nodesBetween(r,s,(m,b)=>{var v,w,S,T,j;if((w=(v=m.type)==null?void 0:v.spec)!=null&&w.code||!(m.isText||m.isTextblock||m.isInline))return;const M=(j=(T=(S=m.content)==null?void 0:S.size)!=null?T:m.nodeSize)!=null?j:0,_=Math.max(r,b),R=Math.min(s,b+M);if(_>=R)return;const O=m.isText?m.text||"":m.textBetween(_-b,R-b,void 0,"");rq(O,i.find,o).forEach(A=>{if(A.index===void 0)return;const F=_+A.index+1,H=F+A[0].length,P={from:n.tr.mapping.map(F),to:n.tr.mapping.map(H)},B=i.handler({state:n,range:P,match:A,commands:d,chain:f,can:p,pasteEvent:o,dropEvent:l});g.push(B)})}),g.every(m=>m!==null)}var Yf=null,iq=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",t),n};function aq(t){const{editor:e,rules:n}=t;let r=null,s=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const d=({state:p,from:g,to:y,rule:m,pasteEvt:b})=>{const v=p.tr,w=Zp({state:p,transaction:v});if(!(!sq({editor:e,state:w,from:Math.max(g-1,0),to:y.b-1,rule:m,pasteEvent:b,dropEvent:l})||!v.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,v}};return n.map(p=>new _t({view(g){const y=b=>{var v;r=(v=g.dom.parentElement)!=null&&v.contains(b.target)?g.dom.parentElement:null,r&&(Yf=e)},m=()=>{Yf&&(Yf=null)};return window.addEventListener("dragstart",y),window.addEventListener("dragend",m),{destroy(){window.removeEventListener("dragstart",y),window.removeEventListener("dragend",m)}}},props:{handleDOMEvents:{drop:(g,y)=>{if(i=r===g.dom.parentElement,l=y,!i){const m=Yf;m?.isEditable&&setTimeout(()=>{const b=m.state.selection;b&&m.commands.deleteRange({from:b.from,to:b.to})},10)}return!1},paste:(g,y)=>{var m;const b=(m=y.clipboardData)==null?void 0:m.getData("text/html");return o=y,s=!!b?.includes("data-pm-slice"),!1}}},appendTransaction:(g,y,m)=>{const b=g[0],v=b.getMeta("uiEvent")==="paste"&&!s,w=b.getMeta("uiEvent")==="drop"&&!i,S=b.getMeta("applyPasteRules"),T=!!S;if(!v&&!w&&!T)return;if(T){let{text:_}=S;typeof _=="string"?_=_:_=Nv(Ne.from(_),m.schema);const{from:R}=S,O=R+_.length,L=iq(_);return d({rule:p,state:m,from:R,to:{b:O},pasteEvt:L})}const j=y.doc.content.findDiffStart(m.doc.content),M=y.doc.content.findDiffEnd(m.doc.content);if(!(!tq(j)||!M||j===M.b))return d({rule:p,state:m,from:j,to:M,pasteEvt:o})}}))}var ig=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=o5(t),this.schema=b$(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:sy(e.name,this.schema)},r=Pe(e,"addCommands",n);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this;return Tv([...this.extensions].reverse()).flatMap(r=>{const s={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:sy(r.name,this.schema)},i=[],o=Pe(r,"addKeyboardShortcuts",s);let l={};if(r.type==="mark"&&Pe(r,"exitable",s)&&(l.ArrowRight=()=>wo.handleExit({editor:t,mark:r})),o){const y=Object.fromEntries(Object.entries(o()).map(([m,b])=>[m,()=>b({editor:t})]));l={...l,...y}}const d=SU(l);i.push(d);const f=Pe(r,"addInputRules",s);if(ON(r,t.options.enableInputRules)&&f){const y=f();if(y&&y.length){const m=Z$({editor:t,rules:y}),b=Array.isArray(m)?m:[m];i.push(...b)}}const p=Pe(r,"addPasteRules",s);if(ON(r,t.options.enablePasteRules)&&p){const y=p();if(y&&y.length){const m=aq({editor:t,rules:y});i.push(...m)}}const g=Pe(r,"addProseMirrorPlugins",s);if(g){const y=g();i.push(...y)}return i})}get attributes(){return a5(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=Hl(this.extensions);return Object.fromEntries(e.filter(n=>!!Pe(n,"addNodeView")).map(n=>{const r=this.attributes.filter(d=>d.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Jt(n.name,this.schema)},i=Pe(n,"addNodeView",s);if(!i)return[];const o=i();if(!o)return[];const l=(d,f,p,g,y)=>{const m=Kh(d,r);return o({node:d,view:f,getPos:p,decorations:g,innerDecorations:y,editor:t,extension:n,HTMLAttributes:m})};return[n.name,l]}))}get markViews(){const{editor:t}=this,{markExtensions:e}=Hl(this.extensions);return Object.fromEntries(e.filter(n=>!!Pe(n,"addMarkView")).map(n=>{const r=this.attributes.filter(l=>l.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:gi(n.name,this.schema)},i=Pe(n,"addMarkView",s);if(!i)return[];const o=(l,d,f)=>{const p=Kh(l,r);return i()({mark:l,view:d,inline:f,editor:t,extension:n,HTMLAttributes:p,updateAttributes:g=>{vq(l,t,g)}})};return[n.name,o]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var n;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:sy(e.name,this.schema)};e.type==="mark"&&((n=gt(Pe(e,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(e.name);const s=Pe(e,"onBeforeCreate",r),i=Pe(e,"onCreate",r),o=Pe(e,"onUpdate",r),l=Pe(e,"onSelectionUpdate",r),d=Pe(e,"onTransaction",r),f=Pe(e,"onFocus",r),p=Pe(e,"onBlur",r),g=Pe(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),i&&this.editor.on("create",i),o&&this.editor.on("update",o),l&&this.editor.on("selectionUpdate",l),d&&this.editor.on("transaction",d),f&&this.editor.on("focus",f),p&&this.editor.on("blur",p),g&&this.editor.on("destroy",g)})}};ig.resolve=o5;ig.sort=Tv;ig.flatten=Cv;var oq={};vv(oq,{ClipboardTextSerializer:()=>m5,Commands:()=>y5,Delete:()=>x5,Drop:()=>b5,Editable:()=>v5,FocusEvents:()=>S5,Keymap:()=>k5,Paste:()=>C5,Tabindex:()=>N5,TextDirection:()=>T5,focusEventsPluginKey:()=>w5});var Pt=class g5 extends Ev{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new g5(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},m5=Pt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new _t({key:new sn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:s}=e,{ranges:i}=s,o=Math.min(...i.map(p=>p.$from.pos)),l=Math.max(...i.map(p=>p.$to.pos)),d=c5(n);return l5(r,{from:o,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}}),y5=Pt.create({name:"commands",addCommands(){return{...XM}}}),x5=Pt.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,r,s;const i=()=>{var o,l,d,f;if((f=(d=(l=(o=this.editor.options.coreExtensionOptions)==null?void 0:o.delete)==null?void 0:l.filterTransaction)==null?void 0:d.call(l,t))!=null?f:t.getMeta("y-sync$"))return;const p=s5(t.before,[t,...e]);d5(p).forEach(m=>{p.mapping.mapResult(m.oldRange.from).deletedAfter&&p.mapping.mapResult(m.oldRange.to).deletedBefore&&p.before.nodesBetween(m.oldRange.from,m.oldRange.to,(b,v)=>{const w=v+b.nodeSize-2,S=m.oldRange.from<=v&&w<=m.oldRange.to;this.editor.emit("delete",{type:"node",node:b,from:v,to:w,newFrom:p.mapping.map(v),newTo:p.mapping.map(w),deletedRange:m.oldRange,newRange:m.newRange,partial:!S,editor:this.editor,transaction:t,combinedTransform:p})})});const y=p.mapping;p.steps.forEach((m,b)=>{var v,w;if(m instanceof as){const S=y.slice(b).map(m.from,-1),T=y.slice(b).map(m.to),j=y.invert().map(S,-1),M=y.invert().map(T),_=(v=p.doc.nodeAt(S-1))==null?void 0:v.marks.some(O=>O.eq(m.mark)),R=(w=p.doc.nodeAt(T))==null?void 0:w.marks.some(O=>O.eq(m.mark));this.editor.emit("delete",{type:"mark",mark:m.mark,from:m.from,to:m.to,deletedRange:{from:j,to:M},newRange:{from:S,to:T},partial:!!(R||_),editor:this.editor,transaction:t,combinedTransform:p})}})};(s=(r=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:r.async)==null||s?setTimeout(i,0):i()}}),b5=Pt.create({name:"drop",addProseMirrorPlugins(){return[new _t({key:new sn("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),v5=Pt.create({name:"editable",addProseMirrorPlugins(){return[new _t({key:new sn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),w5=new sn("focusEvents"),S5=Pt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new _t({key:w5,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),k5=Pt.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:l})=>{const{selection:d,doc:f}=l,{empty:p,$anchor:g}=d,{pos:y,parent:m}=g,b=g.parent.isTextblock&&y>0?l.doc.resolve(y-1):g,v=b.parent.type.spec.isolating,w=g.pos-g.parentOffset,S=v&&b.parent.childCount===1?w===g.pos:Ge.atStart(f).from===y;return!p||!m.type.isTextblock||m.textContent.length||!S||S&&g.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return kv()||n5()?i:s},addProseMirrorPlugins(){return[new _t({key:new sn("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(v=>v.getMeta("composition")))return;const r=t.some(v=>v.docChanged)&&!e.doc.eq(n.doc),s=t.some(v=>v.getMeta("preventClearDocument"));if(!r||s)return;const{empty:i,from:o,to:l}=e.selection,d=Ge.atStart(e.doc).from,f=Ge.atEnd(e.doc).to;if(i||!(o===d&&l===f)||!rg(n.doc))return;const y=n.tr,m=Zp({state:n,transaction:y}),{commands:b}=new eg({editor:this.editor,state:m});if(b.clearNodes(),!!y.steps.length)return y}})]}}),C5=Pt.create({name:"paste",addProseMirrorPlugins(){return[new _t({key:new sn("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),N5=Pt.create({name:"tabindex",addProseMirrorPlugins(){return[new _t({key:new sn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),T5=Pt.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=Hl(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const n=e.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new _t({key:new sn("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),lq=class Ml{constructor(e,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new Ml(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Ml(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Ml(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,i=n.isAtom&&!n.isText,o=this.pos+r+(i?0:1);if(o<0||o>this.resolvedPos.doc.nodeSize-2)return;const l=this.resolvedPos.doc.resolve(o);if(!s&&l.depth<=this.depth)return;const d=new Ml(l,this.editor,s,s?n:null);s&&(d.actualDepth=this.depth+1),e.push(new Ml(l,this.editor,s,s?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(n).length>0){const i=s.node.attrs,o=Object.keys(n);for(let l=0;l<o.length;l+=1){const d=o[l];if(i[d]!==n[d])break}}else r=s;s=s.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const i=Object.keys(n);return this.children.forEach(o=>{r&&s.length>0||(o.node.type.name===e&&i.every(d=>n[d]===o.node.attrs[d])&&s.push(o),!(r&&s.length>0)&&(s=s.concat(o.querySelectorAll(e,n,r))))}),s}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},cq=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function uq(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(s),s}var dq=class extends X${constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:s,moved:i})=>this.options.onDrop(r,s,i)),this.on("paste",({event:r,slice:s})=>this.options.onPaste(r,s)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=e5(e,this.options.autofocus);this.editorState=Rl.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t?.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=uq(cq,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=i5(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(s=>{const i=typeof s=="string"?`${s}$`:s.key;n=n.filter(o=>!o.key.startsWith(i))}),e.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var t,e;const r=[...this.options.enableCoreExtensions?[v5,m5.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),y5,S5,k5,N5,b5,C5,x5,T5.configure({direction:this.options.textDirection})].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s?.type));this.extensionManager=new ig(r,this)}createCommandManager(){this.commandManager=new eg({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=Fx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(n=>n.name!=="collaboration"),this.createExtensionManager()}}),t=Fx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){var e;this.editorView=new YM(t,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)==null?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.prependClass(),this.injectCSS();const r=this.view.dom;r.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(f=>{var p;return(p=this.capturedTransaction)==null?void 0:p.step(f)});return}const{state:e,transactions:n}=this.state.applyTransaction(t),r=!this.state.selection.eq(e.selection),s=n.includes(t),i=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!s)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const o=n.findLast(f=>f.getMeta("focus")||f.getMeta("blur")),l=o?.getMeta("focus"),d=o?.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:o}),d&&this.emit("blur",{editor:this,event:d.event,transaction:o}),!(t.getMeta("preventUpdate")||!n.some(f=>f.docChanged)||i.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return u5(this.state,t)}isActive(t,e){const n=typeof t=="string"?t:null,r=typeof t=="string"?e:t;return j$(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Nv(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:n={}}=t||{};return w$(this.state.doc,{blockSeparator:e,textSerializers:{...c5(this.schema),...n}})}get isEmpty(){return rg(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new lq(e,this)}get $doc(){return this.$pos(0)}};function Vl(t){return new sg({find:t.find,handler:({state:e,range:n,match:r})=>{const s=gt(t.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:i}=e,o=r[r.length-1],l=r[0];if(o){const d=l.search(/\S/),f=n.from+l.indexOf(o),p=f+o.length;if(jv(n.from,n.to,e.doc).filter(m=>m.mark.type.excluded.find(v=>v===t.type&&v!==m.mark.type)).filter(m=>m.to>f).length)return null;p<n.to&&i.delete(p,n.to),f>n.from&&i.delete(n.from+d,f);const y=n.from+d+o.length;i.addMark(n.from+d,y,t.type.create(s||{})),i.removeStoredMark(t.type)}},undoable:t.undoable})}function fq(t){return new sg({find:t.find,handler:({state:e,range:n,match:r})=>{const s=gt(t.getAttributes,void 0,r)||{},{tr:i}=e,o=n.from;let l=n.to;const d=t.type.create(s);if(r[1]){const f=r[0].lastIndexOf(r[1]);let p=o+f;p>l?p=l:l=p+r[1].length;const g=r[0][r[0].length-1];i.insertText(g,o+r[0].length-1),i.replaceWith(p,l,d)}else if(r[0]){const f=t.type.isInline?o:o-1;i.insert(f,t.type.create(s)).delete(i.mapping.map(o),i.mapping.map(l))}i.scrollIntoView()},undoable:t.undoable})}function $x(t){return new sg({find:t.find,handler:({state:e,range:n,match:r})=>{const s=e.doc.resolve(n.from),i=gt(t.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,i)},undoable:t.undoable})}function Kl(t){return new sg({find:t.find,handler:({state:e,range:n,match:r,chain:s})=>{const i=gt(t.getAttributes,void 0,r)||{},o=e.tr.delete(n.from,n.to),d=o.doc.resolve(n.from).blockRange(),f=d&&sv(d,t.type,i);if(!f)return null;if(o.wrap(d,f),t.keepMarks&&t.editor){const{selection:g,storedMarks:y}=e,{splittableMarks:m}=t.editor.extensionManager,b=y||g.$to.parentOffset&&g.$from.marks();if(b){const v=b.filter(w=>m.includes(w.type.name));o.ensureMarks(v)}}if(t.keepAttributes){const g=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(g,i).run()}const p=o.doc.resolve(n.from-1).nodeBefore;p&&p.type===t.type&&pa(o.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,p))&&o.join(n.from-1)},undoable:t.undoable})}function hq(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof Be){const i=r.index();return r.parent.canReplaceWith(i,i+1,e)}let s=r.depth;for(;s>=0;){const i=r.index(s);if(r.node(s).contentMatchAt(i).matchType(e))return!0;s-=1}return!1}var pq={};vv(pq,{createAtomBlockMarkdownSpec:()=>gq,createBlockMarkdownSpec:()=>mq,createInlineMarkdownSpec:()=>bq,parseAttributes:()=>Mv,parseIndentedBlocks:()=>qx,renderNestedMarkdownContent:()=>Rv,serializeAttributes:()=>Av});function Mv(t){if(!t?.trim())return{};const e={},n=[],r=t.replace(/["']([^"']*)["']/g,f=>(n.push(f),`__QUOTED_${n.length-1}__`)),s=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(s){const f=s.map(p=>p.trim().slice(1));e.class=f.join(" ")}const i=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);i&&(e.id=i[1]);const o=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(o)).forEach(([,f,p])=>{var g;const y=parseInt(((g=p.match(/__QUOTED_(\d+)__/))==null?void 0:g[1])||"0",10),m=n[y];m&&(e[f]=m.slice(1,-1))});const d=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return d&&d.split(/\s+/).filter(Boolean).forEach(p=>{p.match(/^[a-zA-Z][\w-]*$/)&&(e[p]=!0)}),e}function Av(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([n,r])=>{n==="class"||n==="id"||(r===!0?e.push(n):r!==!1&&r!=null&&e.push(`${n}="${String(r)}"`))}),e.join(" ")}function gq(t){const{nodeName:e,name:n,parseAttributes:r=Mv,serializeAttributes:s=Av,defaultAttributes:i={},requiredAttributes:o=[],allowedAttributes:l}=t,d=n||e,f=p=>{if(!l)return p;const g={};return l.forEach(y=>{y in p&&(g[y]=p[y])}),g};return{parseMarkdown:(p,g)=>{const y={...i,...p.attributes};return g.createNode(e,y,[])},markdownTokenizer:{name:e,level:"block",start(p){var g;const y=new RegExp(`^:::${d}(?:\\s|$)`,"m"),m=(g=p.match(y))==null?void 0:g.index;return m!==void 0?m:-1},tokenize(p,g,y){const m=new RegExp(`^:::${d}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),b=p.match(m);if(!b)return;const v=b[1]||"",w=r(v);if(!o.find(T=>!(T in w)))return{type:e,raw:b[0],attributes:w}}},renderMarkdown:p=>{const g=f(p.attrs||{}),y=s(g),m=y?` {${y}}`:"";return`:::${d}${m} :::`}}}function mq(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=Mv,serializeAttributes:i=Av,defaultAttributes:o={},content:l="block",allowedAttributes:d}=t,f=n||e,p=g=>{if(!d)return g;const y={};return d.forEach(m=>{m in g&&(y[m]=g[m])}),y};return{parseMarkdown:(g,y)=>{let m;if(r){const v=r(g);m=typeof v=="string"?[{type:"text",text:v}]:v}else l==="block"?m=y.parseChildren(g.tokens||[]):m=y.parseInline(g.tokens||[]);const b={...o,...g.attributes};return y.createNode(e,b,m)},markdownTokenizer:{name:e,level:"block",start(g){var y;const m=new RegExp(`^:::${f}`,"m"),b=(y=g.match(m))==null?void 0:y.index;return b!==void 0?b:-1},tokenize(g,y,m){var b;const v=new RegExp(`^:::${f}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),w=g.match(v);if(!w)return;const[S,T=""]=w,j=s(T);let M=1;const _=S.length;let R="";const O=/^:::([\w-]*)(\s.*)?/gm,L=g.slice(_);for(O.lastIndex=0;;){const A=O.exec(L);if(A===null)break;const F=A.index,H=A[1];if(!((b=A[2])!=null&&b.endsWith(":::"))){if(H)M+=1;else if(M-=1,M===0){const P=L.slice(0,F);R=P.trim();const B=g.slice(0,_+F+A[0].length);let E=[];if(R)if(l==="block")for(E=m.blockTokens(P),E.forEach(K=>{K.text&&(!K.tokens||K.tokens.length===0)&&(K.tokens=m.inlineTokens(K.text))});E.length>0;){const K=E[E.length-1];if(K.type==="paragraph"&&(!K.text||K.text.trim()===""))E.pop();else break}else E=m.inlineTokens(R);return{type:e,raw:B,attributes:j,content:R,tokens:E}}}}}},renderMarkdown:(g,y)=>{const m=p(g.attrs||{}),b=i(m),v=b?` {${b}}`:"",w=y.renderChildren(g.content||[],`

`);return`:::${f}${v}

${w}

:::`}}}function yq(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(t);for(;r!==null;){const[,s,i,o]=r;e[s]=i||o,r=n.exec(t)}return e}function xq(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function bq(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=yq,serializeAttributes:i=xq,defaultAttributes:o={},selfClosing:l=!1,allowedAttributes:d}=t,f=n||e,p=y=>{if(!d)return y;const m={};return d.forEach(b=>{b in y&&(m[b]=y[b])}),m},g=f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(y,m)=>{const b={...o,...y.attributes};if(l)return m.createNode(e,b);const v=r?r(y):y.content||"";return v?m.createNode(e,b,[m.createTextNode(v)]):m.createNode(e,b,[])},markdownTokenizer:{name:e,level:"inline",start(y){const m=l?new RegExp(`\\[${g}\\s*[^\\]]*\\]`):new RegExp(`\\[${g}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${g}\\]`),b=y.match(m),v=b?.index;return v!==void 0?v:-1},tokenize(y,m,b){const v=l?new RegExp(`^\\[${g}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${g}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${g}\\]`),w=y.match(v);if(!w)return;let S="",T="";if(l){const[,M]=w;T=M}else{const[,M,_]=w;T=M,S=_||""}const j=s(T.trim());return{type:e,raw:w[0],content:S.trim(),attributes:j}}},renderMarkdown:y=>{let m="";r?m=r(y):y.content&&y.content.length>0&&(m=y.content.filter(S=>S.type==="text").map(S=>S.text).join(""));const b=p(y.attrs||{}),v=i(b),w=v?` ${v}`:"";return l?`[${f}${w}]`:`[${f}${w}]${m}[/${f}]`}}}function qx(t,e,n){var r,s,i,o;const l=t.split(`
`),d=[];let f="",p=0;const g=e.baseIndentSize||2;for(;p<l.length;){const y=l[p],m=y.match(e.itemPattern);if(!m){if(d.length>0)break;if(y.trim()===""){p+=1,f=`${f}${y}
`;continue}else return}const b=e.extractItemData(m),{indentLevel:v,mainContent:w}=b;f=`${f}${y}
`;const S=[w];for(p+=1;p<l.length;){const _=l[p];if(_.trim()===""){const O=l.slice(p+1).findIndex(F=>F.trim()!=="");if(O===-1)break;if((((s=(r=l[p+1+O].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:s.length)||0)>v){S.push(_),f=`${f}${_}
`,p+=1;continue}else break}if((((o=(i=_.match(/^(\s*)/))==null?void 0:i[1])==null?void 0:o.length)||0)>v)S.push(_),f=`${f}${_}
`,p+=1;else break}let T;const j=S.slice(1);if(j.length>0){const _=j.map(R=>R.slice(v+g)).join(`
`);_.trim()&&(e.customNestedParser?T=e.customNestedParser(_):T=n.blockTokens(_))}const M=e.createToken(b,T);d.push(M)}if(d.length!==0)return{items:d,raw:f}}function Rv(t,e,n,r){if(!t||!Array.isArray(t.content))return"";const s=typeof n=="function"?n(r):n,[i,...o]=t.content,l=e.renderChildren([i]),d=[`${s}${l}`];return o&&o.length>0&&o.forEach(f=>{const p=e.renderChildren([f]);if(p){const g=p.split(`
`).map(y=>y?e.indent(y):"").join(`
`);d.push(g)}}),d.join(`
`)}function vq(t,e,n={}){const{state:r}=e,{doc:s,tr:i}=r,o=t;s.descendants((l,d)=>{const f=i.mapping.map(d),p=i.mapping.map(d)+l.nodeSize;let g=null;if(l.marks.forEach(m=>{if(m!==o)return!1;g=m}),!g)return;let y=!1;if(Object.keys(n).forEach(m=>{n[m]!==g.attrs[m]&&(y=!0)}),y){const m=t.type.create({...t.attrs,...n});i.removeMark(f,p,t.type),i.addMark(f,p,m)}}),i.docChanged&&e.view.dispatch(i)}var kr=class j5 extends Ev{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new j5(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function ao(t){return new nq({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:s})=>{const i=gt(t.getAttributes,void 0,r,s);if(i===!1||i===null)return null;const{tr:o}=e,l=r[r.length-1],d=r[0];let f=n.to;if(l){const p=d.search(/\S/),g=n.from+d.indexOf(l),y=g+l.length;if(jv(n.from,n.to,e.doc).filter(b=>b.mark.type.excluded.find(w=>w===t.type&&w!==b.mark.type)).filter(b=>b.to>g).length)return null;y<n.to&&o.delete(y,n.to),g>n.from&&o.delete(n.from+p,g),f=n.from+p+l.length,o.addMark(n.from+p,f,t.type.create(i||{})),o.removeStoredMark(t.type)}}})}var wq=Pt.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const e=t.style.textAlign;return this.options.alignments.includes(e)?e:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>({commands:e})=>this.options.alignments.includes(t)?this.options.types.map(n=>e.updateAttributes(n,{textAlign:t})).some(n=>n):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(e=>t.resetAttributes(e,"textAlign")).some(e=>e),toggleTextAlign:t=>({editor:e,commands:n})=>this.options.alignments.includes(t)?e.isActive({textAlign:t})?n.unsetTextAlign():n.setTextAlign(t):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),_v=wq,oy,LN;function Sq(){return LN||(LN=1,oy=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,s,i;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(s=r;s--!==0;)if(!t(e[s],n[s]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(s of e.entries())if(!n.has(s[0]))return!1;for(s of e.entries())if(!t(s[1],n.get(s[0])))return!1;return!0}if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(s of e.entries())if(!n.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(r=e.length,r!=n.length)return!1;for(s=r;s--!==0;)if(e[s]!==n[s])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(i=Object.keys(e),r=i.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[s]))return!1;for(s=r;s--!==0;){var o=i[s];if(!(o==="_owner"&&e.$$typeof)&&!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}),oy}var kq=Sq();const Cq=Ql(kq);var Nq=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},Tq=({contentComponent:t})=>{const e=Nb.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return u.jsx(u.Fragment,{children:Object.values(e)})};function jq(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:kO.createPortal(r.reactElement,r.element,n)},t.forEach(s=>s())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(s=>s())}}}var Eq=class extends St.Component{constructor(t){var e;super(t),this.editorContentRef=St.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const t=this.props.editor;if(t&&!t.isDestroyed&&t.options.element){if(t.contentComponent)return;const e=this.editorContentRef.current;e.append(t.view.dom),t.setOptions({element:e}),t.contentComponent=jq(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(n=>n.hasContentComponentInitialized?n:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.firstChild))return;const n=document.createElement("div");n.append(e.view.dom),e.setOptions({element:n})}catch{}}}render(){const{editor:t,innerRef:e,...n}=this.props;return u.jsxs(u.Fragment,{children:[u.jsx("div",{ref:Nq(e,this.editorContentRef),...n}),t?.contentComponent&&u.jsx(Tq,{contentComponent:t.contentComponent})]})}},Mq=C.forwardRef((t,e)=>{const n=St.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return St.createElement(Eq,{key:n,innerRef:e,...t})}),Ov=St.memo(Mq),Aq=typeof window<"u"?C.useLayoutEffect:C.useEffect,Rq=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},n=this.editor;return n.on("transaction",e),()=>{n.off("transaction",e)}}}};function _q(t){var e;const[n]=C.useState(()=>new Rq(t.editor)),r=cj.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:Cq);return Aq(()=>n.watch(t.editor),[t.editor,n]),C.useDebugValue(r),r}var Oq=!1,Hx=typeof window>"u",Dq=Hx||!!(typeof window<"u"&&window.next),Iq=class E5{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Hx||Dq?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onBeforeCreate)==null?void 0:i.call(s,...r)},onBlur:(...r)=>{var s,i;return(i=(s=this.options.current).onBlur)==null?void 0:i.call(s,...r)},onCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onCreate)==null?void 0:i.call(s,...r)},onDestroy:(...r)=>{var s,i;return(i=(s=this.options.current).onDestroy)==null?void 0:i.call(s,...r)},onFocus:(...r)=>{var s,i;return(i=(s=this.options.current).onFocus)==null?void 0:i.call(s,...r)},onSelectionUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onSelectionUpdate)==null?void 0:i.call(s,...r)},onTransaction:(...r)=>{var s,i;return(i=(s=this.options.current).onTransaction)==null?void 0:i.call(s,...r)},onUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onUpdate)==null?void 0:i.call(s,...r)},onContentError:(...r)=>{var s,i;return(i=(s=this.options.current).onContentError)==null?void 0:i.call(s,...r)},onDrop:(...r)=>{var s,i;return(i=(s=this.options.current).onDrop)==null?void 0:i.call(s,...r)},onPaste:(...r)=>{var s,i;return(i=(s=this.options.current).onPaste)==null?void 0:i.call(s,...r)},onDelete:(...r)=>{var s,i;return(i=(s=this.options.current).onDelete)==null?void 0:i.call(s,...r)}};return new dq(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((s,i)=>{var o;return s===((o=n.extensions)==null?void 0:o[i])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?E5.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,s)=>r===e[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function Dv(t={},e=[]){const n=C.useRef(t);n.current=t;const[r]=C.useState(()=>new Iq(n)),s=Nb.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return C.useDebugValue(s),C.useEffect(r.onRender(e)),_q({editor:s,selector:({transactionNumber:i})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&i===0?0:i+1}),s}var Lq=C.createContext({editor:null});Lq.Consumer;var zq=C.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),Pq=()=>C.useContext(zq);St.forwardRef((t,e)=>{const{onDragStart:n}=Pq(),r=t.as||"div";return u.jsx(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});St.createContext({markViewContentRef:()=>{}});var Qh=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:n,...r}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,r,n]},Bq=/^\s*>\s$/,Fq=kr.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return Qh("blockquote",{...Zt(this.options.HTMLAttributes,t),children:Qh("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=">",r=[];return t.content.forEach(s=>{const l=e.renderChildren([s]).split(`
`).map(d=>d.trim()===""?n:`${n} ${d}`);r.push(l.join(`
`))}),r.join(`
${n}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Kl({find:Bq,type:this.type})]}}),Uq=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,$q=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,qq=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Hq=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Vq=wo.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return Qh("strong",{...Zt(this.options.HTMLAttributes,t),children:Qh("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Vl({find:Uq,type:this.type}),Vl({find:qq,type:this.type})]},addPasteRules(){return[ao({find:$q,type:this.type}),ao({find:Hq,type:this.type})]}}),Kq=/(^|[^`])`([^`]+)`(?!`)$/,Qq=/(^|[^`])`([^`]+)`(?!`)/g,Wq=wo.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Zt(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Vl({find:Kq,type:this.type})]},addPasteRules(){return[ao({find:Qq,type:this.type})]}}),ly=4,Yq=/^```([a-z]+)?[\s\n]$/,Gq=/^~~~([a-z]+)?[\s\n]$/,Xq=kr.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:ly,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const i=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",Zt(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return((n=t.raw)==null?void 0:n.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let r="";const s=((n=t.attrs)==null?void 0:n.language)||"";return t.content?r=[`\`\`\`${s}`,e.renderChildren(t.content),"```"].join(`
`):r=`\`\`\`${s}

\`\`\``,r},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:ly,{state:r}=t,{selection:s}=r,{$from:i,empty:o}=s;if(i.parent.type!==this.type)return!1;const l=" ".repeat(n);return o?t.commands.insertContent(l):t.commands.command(({tr:d})=>{const{from:f,to:p}=s,m=r.doc.textBetween(f,p,`
`,`
`).split(`
`).map(b=>l+b).join(`
`);return d.replaceWith(f,p,r.schema.text(m)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:ly,{state:r}=t,{selection:s}=r,{$from:i,empty:o}=s;return i.parent.type!==this.type?!1:o?t.commands.command(({tr:l})=>{var d;const{pos:f}=i,p=i.start(),g=i.end(),m=r.doc.textBetween(p,g,`
`,`
`).split(`
`);let b=0,v=0;const w=f-p;for(let R=0;R<m.length;R+=1){if(v+m[R].length>=w){b=R;break}v+=m[R].length+1}const T=((d=m[b].match(/^ */))==null?void 0:d[0])||"",j=Math.min(T.length,n);if(j===0)return!0;let M=p;for(let R=0;R<b;R+=1)M+=m[R].length+1;return l.delete(M,M+j),f-M<=j&&l.setSelection(qe.create(l.doc,M)),!0}):t.commands.command(({tr:l})=>{const{from:d,to:f}=s,y=r.doc.textBetween(d,f,`
`,`
`).split(`
`).map(m=>{var b;const v=((b=m.match(/^ */))==null?void 0:b[0])||"",w=Math.min(v.length,n);return m.slice(w)}).join(`
`);return l.replaceWith(d,f,r.schema.text(y)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!i||!o?!1:t.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:s,empty:i}=n;if(!i||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const l=s.after();return l===void 0?!1:r.nodeAt(l)?t.commands.command(({tr:f})=>(f.setSelection(Ge.near(r.resolve(l))),!0)):t.commands.exitCode()}}},addInputRules(){return[$x({find:Yq,type:this.type,getAttributes:t=>({language:t[1]})}),$x({find:Gq,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new _t({key:new sn("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=s?.mode;if(!n||!i)return!1;const{tr:o,schema:l}=t.state,d=l.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:i},d)),o.selection.$from.parent.type!==this.type&&o.setSelection(qe.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),Jq=kr.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),Zq=kr.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Zt(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:s,storedMarks:i}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:l}=r.extensionManager,d=i||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:f,dispatch:p})=>{if(p&&d&&o){const g=d.filter(y=>l.includes(y.type.name));f.ensureMarks(g)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),eH=kr.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Zt(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var n;const r=(n=t.attrs)!=null&&n.level?parseInt(t.attrs.level,10):1,s="#".repeat(r);return t.content?`${s} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>$x({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),tH=kr.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Zt(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!hq(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:r}=n,s=t();return f5(n)?s.insertContentAt(r.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({state:i,tr:o,dispatch:l})=>{if(l){const{$to:d}=o.selection,f=d.end();if(d.nodeAfter)d.nodeAfter.isTextblock?o.setSelection(qe.create(o.doc,d.pos+1)):d.nodeAfter.isBlock?o.setSelection(Be.create(o.doc,d.pos)):o.setSelection(qe.create(o.doc,d.pos));else{const p=i.schema.nodes[this.options.nextNodeType]||d.parent.type.contentMatch.defaultType,g=p?.create();g&&(o.insert(f,g),o.setSelection(qe.create(o.doc,f+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[fq({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),nH=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,rH=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,sH=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,iH=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,aH=wo.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Zt(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Vl({find:nH,type:this.type}),Vl({find:sH,type:this.type})]},addPasteRules(){return[ao({find:rH,type:this.type}),ao({find:iH,type:this.type})]}});const oH="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",lH="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",Vx="numeric",Kx="ascii",Qx="alpha",Cu="asciinumeric",ou="alphanumeric",Wx="domain",M5="emoji",cH="scheme",uH="slashscheme",cy="whitespace";function dH(t,e){return t in e||(e[t]=[]),e[t]}function Fa(t,e,n){e[Vx]&&(e[Cu]=!0,e[ou]=!0),e[Kx]&&(e[Cu]=!0,e[Qx]=!0),e[Cu]&&(e[ou]=!0),e[Qx]&&(e[ou]=!0),e[ou]&&(e[Wx]=!0),e[M5]&&(e[Wx]=!0);for(const r in e){const s=dH(r,n);s.indexOf(t)<0&&s.push(t)}}function fH(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}function nr(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}nr.groups={};nr.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let r=0;r<e.jr.length;r++){const s=e.jr[r][0],i=e.jr[r][1];if(i&&s.test(t))return i}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let s=0;s<t.length;s++)this.tt(t[s],e,n,r)},tr(t,e,n,r){r=r||nr.groups;let s;return e&&e.j?s=e:(s=new nr(e),n&&r&&Fa(e,n,r)),this.jr.push([t,s]),s},ts(t,e,n,r){let s=this;const i=t.length;if(!i)return s;for(let o=0;o<i-1;o++)s=s.tt(t[o]);return s.tt(t[i-1],e,n,r)},tt(t,e,n,r){r=r||nr.groups;const s=this;if(e&&e.j)return s.j[t]=e,e;const i=e;let o,l=s.go(t);if(l?(o=new nr,Object.assign(o.j,l.j),o.jr.push.apply(o.jr,l.jr),o.jd=l.jd,o.t=l.t):o=new nr,i){if(r)if(o.t&&typeof o.t=="string"){const d=Object.assign(fH(o.t,r),n);Fa(i,d,r)}else n&&Fa(i,n,r);o.t=i}return s.j[t]=o,o}};const Ye=(t,e,n,r,s)=>t.ta(e,n,r,s),It=(t,e,n,r,s)=>t.tr(e,n,r,s),zN=(t,e,n,r,s)=>t.ts(e,n,r,s),Ee=(t,e,n,r,s)=>t.tt(e,n,r,s),ni="WORD",Yx="UWORD",A5="ASCIINUMERICAL",R5="ALPHANUMERICAL",Wu="LOCALHOST",Gx="TLD",Xx="UTLD",uh="SCHEME",Al="SLASH_SCHEME",Iv="NUM",Jx="WS",Lv="NL",Nu="OPENBRACE",Tu="CLOSEBRACE",Wh="OPENBRACKET",Yh="CLOSEBRACKET",Gh="OPENPAREN",Xh="CLOSEPAREN",Jh="OPENANGLEBRACKET",Zh="CLOSEANGLEBRACKET",ep="FULLWIDTHLEFTPAREN",tp="FULLWIDTHRIGHTPAREN",np="LEFTCORNERBRACKET",rp="RIGHTCORNERBRACKET",sp="LEFTWHITECORNERBRACKET",ip="RIGHTWHITECORNERBRACKET",ap="FULLWIDTHLESSTHAN",op="FULLWIDTHGREATERTHAN",lp="AMPERSAND",cp="APOSTROPHE",up="ASTERISK",Ki="AT",dp="BACKSLASH",fp="BACKTICK",hp="CARET",Yi="COLON",zv="COMMA",pp="DOLLAR",xs="DOT",gp="EQUALS",Pv="EXCLAMATION",Hr="HYPHEN",ju="PERCENT",mp="PIPE",yp="PLUS",xp="POUND",Eu="QUERY",Bv="QUOTE",_5="FULLWIDTHMIDDLEDOT",Fv="SEMI",bs="SLASH",Mu="TILDE",bp="UNDERSCORE",O5="EMOJI",vp="SYM";var D5=Object.freeze({__proto__:null,ALPHANUMERICAL:R5,AMPERSAND:lp,APOSTROPHE:cp,ASCIINUMERICAL:A5,ASTERISK:up,AT:Ki,BACKSLASH:dp,BACKTICK:fp,CARET:hp,CLOSEANGLEBRACKET:Zh,CLOSEBRACE:Tu,CLOSEBRACKET:Yh,CLOSEPAREN:Xh,COLON:Yi,COMMA:zv,DOLLAR:pp,DOT:xs,EMOJI:O5,EQUALS:gp,EXCLAMATION:Pv,FULLWIDTHGREATERTHAN:op,FULLWIDTHLEFTPAREN:ep,FULLWIDTHLESSTHAN:ap,FULLWIDTHMIDDLEDOT:_5,FULLWIDTHRIGHTPAREN:tp,HYPHEN:Hr,LEFTCORNERBRACKET:np,LEFTWHITECORNERBRACKET:sp,LOCALHOST:Wu,NL:Lv,NUM:Iv,OPENANGLEBRACKET:Jh,OPENBRACE:Nu,OPENBRACKET:Wh,OPENPAREN:Gh,PERCENT:ju,PIPE:mp,PLUS:yp,POUND:xp,QUERY:Eu,QUOTE:Bv,RIGHTCORNERBRACKET:rp,RIGHTWHITECORNERBRACKET:ip,SCHEME:uh,SEMI:Fv,SLASH:bs,SLASH_SCHEME:Al,SYM:vp,TILDE:Mu,TLD:Gx,UNDERSCORE:bp,UTLD:Xx,UWORD:Yx,WORD:ni,WS:Jx});const ei=/[a-z]/,tu=new RegExp("\\p{L}","u"),uy=new RegExp("\\p{Emoji}","u"),ti=/\d/,dy=/\s/,PN="\r",fy=`
`,hH="",pH="",hy="";let Gf=null,Xf=null;function gH(t=[]){const e={};nr.groups=e;const n=new nr;Gf==null&&(Gf=BN(oH)),Xf==null&&(Xf=BN(lH)),Ee(n,"'",cp),Ee(n,"{",Nu),Ee(n,"}",Tu),Ee(n,"[",Wh),Ee(n,"]",Yh),Ee(n,"(",Gh),Ee(n,")",Xh),Ee(n,"<",Jh),Ee(n,">",Zh),Ee(n,"",ep),Ee(n,"",tp),Ee(n,"",np),Ee(n,"",rp),Ee(n,"",sp),Ee(n,"",ip),Ee(n,"",ap),Ee(n,"",op),Ee(n,"&",lp),Ee(n,"*",up),Ee(n,"@",Ki),Ee(n,"`",fp),Ee(n,"^",hp),Ee(n,":",Yi),Ee(n,",",zv),Ee(n,"$",pp),Ee(n,".",xs),Ee(n,"=",gp),Ee(n,"!",Pv),Ee(n,"-",Hr),Ee(n,"%",ju),Ee(n,"|",mp),Ee(n,"+",yp),Ee(n,"#",xp),Ee(n,"?",Eu),Ee(n,'"',Bv),Ee(n,"/",bs),Ee(n,";",Fv),Ee(n,"~",Mu),Ee(n,"_",bp),Ee(n,"\\",dp),Ee(n,"",_5);const r=It(n,ti,Iv,{[Vx]:!0});It(r,ti,r);const s=It(r,ei,A5,{[Cu]:!0}),i=It(r,tu,R5,{[ou]:!0}),o=It(n,ei,ni,{[Kx]:!0});It(o,ti,s),It(o,ei,o),It(s,ti,s),It(s,ei,s);const l=It(n,tu,Yx,{[Qx]:!0});It(l,ei),It(l,ti,i),It(l,tu,l),It(i,ti,i),It(i,ei),It(i,tu,i);const d=Ee(n,fy,Lv,{[cy]:!0}),f=Ee(n,PN,Jx,{[cy]:!0}),p=It(n,dy,Jx,{[cy]:!0});Ee(n,hy,p),Ee(f,fy,d),Ee(f,hy,p),It(f,dy,p),Ee(p,PN),Ee(p,fy),It(p,dy,p),Ee(p,hy,p);const g=It(n,uy,O5,{[M5]:!0});Ee(g,"#"),It(g,uy,g),Ee(g,hH,g);const y=Ee(g,pH);Ee(y,"#"),It(y,uy,g);const m=[[ei,o],[ti,s]],b=[[ei,null],[tu,l],[ti,i]];for(let v=0;v<Gf.length;v++)Ui(n,Gf[v],Gx,ni,m);for(let v=0;v<Xf.length;v++)Ui(n,Xf[v],Xx,Yx,b);Fa(Gx,{tld:!0,ascii:!0},e),Fa(Xx,{utld:!0,alpha:!0},e),Ui(n,"file",uh,ni,m),Ui(n,"mailto",uh,ni,m),Ui(n,"http",Al,ni,m),Ui(n,"https",Al,ni,m),Ui(n,"ftp",Al,ni,m),Ui(n,"ftps",Al,ni,m),Fa(uh,{scheme:!0,ascii:!0},e),Fa(Al,{slashscheme:!0,ascii:!0},e),t=t.sort((v,w)=>v[0]>w[0]?1:-1);for(let v=0;v<t.length;v++){const w=t[v][0],T=t[v][1]?{[cH]:!0}:{[uH]:!0};w.indexOf("-")>=0?T[Wx]=!0:ei.test(w)?ti.test(w)?T[Cu]=!0:T[Kx]=!0:T[Vx]=!0,zN(n,w,w,T)}return zN(n,"localhost",Wu,{ascii:!0}),n.jd=new nr(vp),{start:n,tokens:Object.assign({groups:e},D5)}}function I5(t,e){const n=mH(e.replace(/[A-Z]/g,l=>l.toLowerCase())),r=n.length,s=[];let i=0,o=0;for(;o<r;){let l=t,d=null,f=0,p=null,g=-1,y=-1;for(;o<r&&(d=l.go(n[o]));)l=d,l.accepts()?(g=0,y=0,p=l):g>=0&&(g+=n[o].length,y++),f+=n[o].length,i+=n[o].length,o++;i-=g,o-=y,f-=g,s.push({t:p.t,v:e.slice(i-f,i),s:i-f,e:i})}return s}function mH(t){const e=[],n=t.length;let r=0;for(;r<n;){let s=t.charCodeAt(r),i,o=s<55296||s>56319||r+1===n||(i=t.charCodeAt(r+1))<56320||i>57343?t[r]:t.slice(r,r+2);e.push(o),r+=o.length}return e}function Ui(t,e,n,r,s){let i;const o=e.length;for(let l=0;l<o-1;l++){const d=e[l];t.j[d]?i=t.j[d]:(i=new nr(r),i.jr=s.slice(),t.j[d]=i),t=i}return i=new nr(n),i.jr=s.slice(),t.j[e[o-1]]=i,i}function BN(t){const e=[],n=[];let r=0,s="0123456789";for(;r<t.length;){let i=0;for(;s.indexOf(t[r+i])>=0;)i++;if(i>0){e.push(n.join(""));for(let o=parseInt(t.substring(r,r+i),10);o>0;o--)n.pop();r+=i}else n.push(t[r]),r++}return e}const Yu={defaultProtocol:"http",events:null,format:FN,formatHref:FN,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Uv(t,e=null){let n=Object.assign({},Yu);t&&(n=Object.assign(n,t instanceof Uv?t.o:t));const r=n.ignoreTags,s=[];for(let i=0;i<r.length;i++)s.push(r[i].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=s}Uv.prototype={o:Yu,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=e!=null;let s=this.o[t];return s&&(typeof s=="object"?(s=n.t in s?s[n.t]:Yu[t],typeof s=="function"&&r&&(s=s(e,n))):typeof s=="function"&&r&&(s=s(e,n.t,n)),s)},getObj(t,e,n){let r=this.o[t];return typeof r=="function"&&e!=null&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function FN(t){return t}function L5(t,e){this.t="token",this.v=t,this.tk=e}L5.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=Yu.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),s=t.get("tagName",n,e),i=this.toFormattedString(t),o={},l=t.get("className",n,e),d=t.get("target",n,e),f=t.get("rel",n,e),p=t.getObj("attributes",n,e),g=t.getObj("events",n,e);return o.href=r,l&&(o.class=l),d&&(o.target=d),f&&(o.rel=f),p&&Object.assign(o,p),{tagName:s,attributes:o,content:i,eventListeners:g}}};function ag(t,e){class n extends L5{constructor(s,i){super(s,i),this.t=t}}for(const r in e)n.prototype[r]=e[r];return n.t=t,n}const UN=ag("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),$N=ag("text"),yH=ag("nl"),Jf=ag("url",{isLink:!0,toHref(t=Yu.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Wu&&t[1].t===Yi}}),Br=t=>new nr(t);function xH({groups:t}){const e=t.domain.concat([lp,up,Ki,dp,fp,hp,pp,gp,Hr,Iv,ju,mp,yp,xp,bs,vp,Mu,bp]),n=[cp,Yi,zv,xs,Pv,ju,Eu,Bv,Fv,Jh,Zh,Nu,Tu,Yh,Wh,Gh,Xh,ep,tp,np,rp,sp,ip,ap,op],r=[lp,cp,up,dp,fp,hp,pp,gp,Hr,Nu,Tu,ju,mp,yp,xp,Eu,bs,vp,Mu,bp],s=Br(),i=Ee(s,Mu);Ye(i,r,i),Ye(i,t.domain,i);const o=Br(),l=Br(),d=Br();Ye(s,t.domain,o),Ye(s,t.scheme,l),Ye(s,t.slashscheme,d),Ye(o,r,i),Ye(o,t.domain,o);const f=Ee(o,Ki);Ee(i,Ki,f),Ee(l,Ki,f),Ee(d,Ki,f);const p=Ee(i,xs);Ye(p,r,i),Ye(p,t.domain,i);const g=Br();Ye(f,t.domain,g),Ye(g,t.domain,g);const y=Ee(g,xs);Ye(y,t.domain,g);const m=Br(UN);Ye(y,t.tld,m),Ye(y,t.utld,m),Ee(f,Wu,m);const b=Ee(g,Hr);Ee(b,Hr,b),Ye(b,t.domain,g),Ye(m,t.domain,g),Ee(m,xs,y),Ee(m,Hr,b);const v=Ee(m,Yi);Ye(v,t.numeric,UN);const w=Ee(o,Hr),S=Ee(o,xs);Ee(w,Hr,w),Ye(w,t.domain,o),Ye(S,r,i),Ye(S,t.domain,o);const T=Br(Jf);Ye(S,t.tld,T),Ye(S,t.utld,T),Ye(T,t.domain,o),Ye(T,r,i),Ee(T,xs,S),Ee(T,Hr,w),Ee(T,Ki,f);const j=Ee(T,Yi),M=Br(Jf);Ye(j,t.numeric,M);const _=Br(Jf),R=Br();Ye(_,e,_),Ye(_,n,R),Ye(R,e,_),Ye(R,n,R),Ee(T,bs,_),Ee(M,bs,_);const O=Ee(l,Yi),L=Ee(d,Yi),A=Ee(L,bs),F=Ee(A,bs);Ye(l,t.domain,o),Ee(l,xs,S),Ee(l,Hr,w),Ye(d,t.domain,o),Ee(d,xs,S),Ee(d,Hr,w),Ye(O,t.domain,_),Ee(O,bs,_),Ee(O,Eu,_),Ye(F,t.domain,_),Ye(F,e,_),Ee(F,bs,_);const H=[[Nu,Tu],[Wh,Yh],[Gh,Xh],[Jh,Zh],[ep,tp],[np,rp],[sp,ip],[ap,op]];for(let P=0;P<H.length;P++){const[B,E]=H[P],K=Ee(_,B);Ee(R,B,K),Ee(K,E,_);const q=Br(Jf);Ye(K,e,q);const V=Br();Ye(K,n),Ye(q,e,q),Ye(q,n,V),Ye(V,e,q),Ye(V,n,V),Ee(q,E,_),Ee(V,E,_)}return Ee(s,Wu,T),Ee(s,Lv,yH),{start:s,tokens:D5}}function bH(t,e,n){let r=n.length,s=0,i=[],o=[];for(;s<r;){let l=t,d=null,f=null,p=0,g=null,y=-1;for(;s<r&&!(d=l.go(n[s].t));)o.push(n[s++]);for(;s<r&&(f=d||l.go(n[s].t));)d=null,l=f,l.accepts()?(y=0,g=l):y>=0&&y++,s++,p++;if(y<0)s-=p,s<r&&(o.push(n[s]),s++);else{o.length>0&&(i.push(py($N,e,o)),o=[]),s-=y,p-=y;const m=g.t,b=n.slice(s-p,s);i.push(py(m,e,b))}}return o.length>0&&i.push(py($N,e,o)),i}function py(t,e,n){const r=n[0].s,s=n[n.length-1].e,i=e.slice(r,s);return new t(i,n)}const vH=typeof console<"u"&&console&&console.warn||(()=>{}),wH="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Mt={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function SH(){return nr.groups={},Mt.scanner=null,Mt.parser=null,Mt.tokenQueue=[],Mt.pluginQueue=[],Mt.customSchemes=[],Mt.initialized=!1,Mt}function qN(t,e=!1){if(Mt.initialized&&vH(`linkifyjs: already initialized - will not register custom scheme "${t}" ${wH}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Mt.customSchemes.push([t,e])}function kH(){Mt.scanner=gH(Mt.customSchemes);for(let t=0;t<Mt.tokenQueue.length;t++)Mt.tokenQueue[t][1]({scanner:Mt.scanner});Mt.parser=xH(Mt.scanner.tokens);for(let t=0;t<Mt.pluginQueue.length;t++)Mt.pluginQueue[t][1]({scanner:Mt.scanner,parser:Mt.parser});return Mt.initialized=!0,Mt}function $v(t){return Mt.initialized||kH(),bH(Mt.parser.start,t,I5(Mt.scanner.start,t))}$v.scan=I5;function z5(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new Uv(n),s=$v(t),i=[];for(let o=0;o<s.length;o++){const l=s[o];l.isLink&&(!e||l.t===e)&&r.check(l)&&i.push(l.toFormattedObject(r))}return i}var qv="[\0- -\u2029]",CH=new RegExp(qv),NH=new RegExp(`${qv}$`),TH=new RegExp(qv,"g");function jH(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function EH(t){return new _t({key:new sn("autolink"),appendTransaction:(e,n,r)=>{const s=e.some(f=>f.docChanged)&&!n.doc.eq(r.doc),i=e.some(f=>f.getMeta("preventAutolink"));if(!s||i)return;const{tr:o}=r,l=s5(n.doc,[...e]);if(d5(l).forEach(({newRange:f})=>{const p=g$(r.doc,f,m=>m.isTextblock);let g,y;if(p.length>1)g=p[0],y=r.doc.textBetween(g.pos,g.pos+g.node.nodeSize,void 0," ");else if(p.length){const m=r.doc.textBetween(f.from,f.to," "," ");if(!NH.test(m))return;g=p[0],y=r.doc.textBetween(g.pos,f.to,void 0," ")}if(g&&y){const m=y.split(CH).filter(Boolean);if(m.length<=0)return!1;const b=m[m.length-1],v=g.pos+y.lastIndexOf(b);if(!b)return!1;const w=$v(b).map(S=>S.toObject(t.defaultProtocol));if(!jH(w))return!1;w.filter(S=>S.isLink).map(S=>({...S,from:v+S.start+1,to:v+S.end+1})).filter(S=>r.schema.marks.code?!r.doc.rangeHasMark(S.from,S.to,r.schema.marks.code):!0).filter(S=>t.validate(S.value)).filter(S=>t.shouldAutoLink(S.value)).forEach(S=>{jv(S.from,S.to,r.doc).some(T=>T.mark.type===t.type)||o.addMark(S.from,S.to,t.type.create({href:S.href}))})}}),!!o.steps.length)return o}})}function MH(t){return new _t({key:new sn("handleClickLink"),props:{handleClick:(e,n,r)=>{var s,i;if(r.button!==0||!e.editable)return!1;let o=null;if(r.target instanceof HTMLAnchorElement)o=r.target;else{let p=r.target;const g=[];for(;p.nodeName!=="DIV";)g.push(p),p=p.parentNode;o=g.find(y=>y.nodeName==="A")}if(!o)return!1;const l=u5(e.state,t.type.name),d=(s=o?.href)!=null?s:l.href,f=(i=o?.target)!=null?i:l.target;return t.enableClickSelection&&t.editor.commands.extendMarkRange(t.type.name),o&&d?(window.open(d,f),!0):!1}}})}function AH(t){return new _t({key:new sn("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{shouldAutoLink:s}=t,{state:i}=e,{selection:o}=i,{empty:l}=o;if(l)return!1;let d="";r.content.forEach(p=>{d+=p.textContent});const f=z5(d,{defaultProtocol:t.defaultProtocol}).find(p=>p.isLink&&p.value===d);return!d||!f||s!==void 0&&!s(f.href)?!1:t.editor.commands.setMark(t.type,{href:f.href})}}})}function Da(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&n.push(s)}),!t||t.replace(TH,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var RH=wo.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){qN(t);return}qN(t.scheme,t.optionalSlashes)})},onDestroy(){SH()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!Da(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!Da(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!Da(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Zt(this.options.HTMLAttributes,t),0]:["a",Zt(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var n;const r=((n=t.attrs)==null?void 0:n.href)||"";return`[${e.renderChildren(t)}](${r})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!Da(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:r=>!!Da(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[ao({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,s=z5(t).filter(i=>i.isLink&&this.options.isAllowedUri(i.value,{defaultValidate:o=>!!Da(o,n),protocols:n,defaultProtocol:r}));s.length&&s.forEach(i=>{this.options.shouldAutoLink(i.value)&&e.push({text:i.value,data:{href:i.href},index:i.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(EH({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!Da(s,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&t.push(MH({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(AH({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),_H=Object.defineProperty,OH=(t,e)=>{for(var n in e)_H(t,n,{get:e[n],enumerable:!0})},DH="listItem",HN="textStyle",VN=/^\s*([-+*])\s$/,P5=kr.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Zt(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(DH,this.editor.getAttributes(HN)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Kl({find:VN,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Kl({find:VN,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(HN),editor:this.editor})),[t]}}),B5=kr.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Zt(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(s=>s.type==="paragraph"))n=e.parseChildren(t.tokens);else{const s=t.tokens[0];if(s&&s.type==="text"&&s.tokens&&s.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(s.tokens)}],t.tokens.length>1){const o=t.tokens.slice(1),l=e.parseChildren(o);n.push(...l)}}else n=e.parseChildren(t.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>Rv(t,e,r=>r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${r.index+1}. `:"- ",n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),IH={};OH(IH,{findListItemPos:()=>ud,getNextListDepth:()=>Hv,handleBackspace:()=>Zx,handleDelete:()=>eb,hasListBefore:()=>F5,hasListItemAfter:()=>LH,hasListItemBefore:()=>U5,listItemHasSubList:()=>$5,nextListIsDeeper:()=>q5,nextListIsHigher:()=>H5});var ud=(t,e)=>{const{$from:n}=e.selection,r=Jt(t,e.schema);let s=null,i=n.depth,o=n.pos,l=null;for(;i>0&&l===null;)s=n.node(i),s.type===r?l=i:(i-=1,o-=1);return l===null?null:{$pos:e.doc.resolve(o),depth:l}},Hv=(t,e)=>{const n=ud(t,e);if(!n)return!1;const[,r]=N$(e,t,n.$pos.pos+4);return r},F5=(t,e,n)=>{const{$anchor:r}=t.selection,s=Math.max(0,r.pos-2),i=t.doc.resolve(s).node();return!(!i||!n.includes(i.type.name))},U5=(t,e)=>{var n;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-2);return!(s.index()===0||((n=s.nodeBefore)==null?void 0:n.type.name)!==t)},$5=(t,e,n)=>{if(!n)return!1;const r=Jt(t,e.schema);let s=!1;return n.descendants(i=>{i.type===r&&(s=!0)}),s},Zx=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!fa(t.state,e)&&F5(t.state,e,n)){const{$anchor:l}=t.state.selection,d=t.state.doc.resolve(l.before()-1),f=[];d.node().descendants((y,m)=>{y.type.name===e&&f.push({node:y,pos:m})});const p=f.at(-1);if(!p)return!1;const g=t.state.doc.resolve(d.start()+p.pos+1);return t.chain().cut({from:l.start()-1,to:l.end()+1},g.end()).joinForward().run()}if(!fa(t.state,e)||!M$(t.state))return!1;const r=ud(e,t.state);if(!r)return!1;const i=t.state.doc.resolve(r.$pos.pos-2).node(r.depth),o=$5(e,t.state,i);return U5(e,t.state)&&!o?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},q5=(t,e)=>{const n=Hv(t,e),r=ud(t,e);return!r||!n?!1:n>r.depth},H5=(t,e)=>{const n=Hv(t,e),r=ud(t,e);return!r||!n?!1:n<r.depth},eb=(t,e)=>{if(!fa(t.state,e)||!E$(t.state,e))return!1;const{selection:n}=t.state,{$from:r,$to:s}=n;return!n.empty&&r.sameParent(s)?!1:q5(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():H5(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},LH=(t,e)=>{var n;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-r.parentOffset-2);return!(s.index()===s.parent.childCount-1||((n=s.nodeAfter)==null?void 0:n.type.name)!==t)},V5=Pt.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&eb(t,n)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&eb(t,n)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&Zx(t,n,r)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&Zx(t,n,r)&&(e=!0)}),e}}}}),KN=/^(\s*)(\d+)\.\s+(.*)$/,zH=/^\s/;function PH(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n],i=s.match(KN);if(!i)break;const[,o,l,d]=i,f=o.length;let p=d,g=n+1;const y=[s];for(;g<t.length;){const m=t[g];if(m.match(KN))break;if(m.trim()==="")y.push(m),p+=`
`,g+=1;else if(m.match(zH))y.push(m),p+=`
${m.slice(f+2)}`,g+=1;else break}e.push({indent:f,number:parseInt(l,10),content:p.trim(),raw:y.join(`
`)}),r=g,n=g}return[e,r]}function K5(t,e,n){var r;const s=[];let i=0;for(;i<t.length;){const o=t[i];if(o.indent===e){const l=o.content.split(`
`),d=((r=l[0])==null?void 0:r.trim())||"",f=[];d&&f.push({type:"paragraph",raw:d,tokens:n.inlineTokens(d)});const p=l.slice(1).join(`
`).trim();if(p){const m=n.blockTokens(p);f.push(...m)}let g=i+1;const y=[];for(;g<t.length&&t[g].indent>e;)y.push(t[g]),g+=1;if(y.length>0){const m=Math.min(...y.map(v=>v.indent)),b=K5(y,m,n);f.push({type:"list",ordered:!0,start:y[0].number,items:b,raw:y.map(v=>v.raw).join(`
`)})}s.push({type:"list_item",raw:o.raw,tokens:f}),i=g}else i+=1}return s}function BH(t,e){return t.map(n=>{if(n.type!=="list_item")return e.parseChildren([n])[0];const r=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(s=>{if(s.type==="paragraph"||s.type==="list"||s.type==="blockquote"||s.type==="code")r.push(...e.parseChildren([s]));else if(s.type==="text"&&s.tokens){const i=e.parseChildren([s]);r.push({type:"paragraph",content:i})}else{const i=e.parseChildren([s]);i.length>0&&r.push(...i)}}),{type:"listItem",content:r}})}var FH="listItem",QN="textStyle",WN=/^(\d+)\.\s$/,Q5=kr.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",Zt(this.options.HTMLAttributes,n),0]:["ol",Zt(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const n=t.start||1,r=t.items?BH(t.items,e):[];return n!==1?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=e?.index;return n!==void 0?n:-1},tokenize:(t,e,n)=>{var r;const s=t.split(`
`),[i,o]=PH(s);if(i.length===0)return;const l=K5(i,0,n);return l.length===0?void 0:{type:"list",ordered:!0,start:((r=i[0])==null?void 0:r.number)||1,items:l,raw:s.slice(0,o).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(FH,this.editor.getAttributes(QN)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Kl({find:WN,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Kl({find:WN,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(QN)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),UH=/^\s*(\[([( |x])?\])\s$/,$H=kr.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",Zt(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const r=e.parseChildren(t.nestedTokens);n.push(...r)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;const s=`- [${(n=t.attrs)!=null&&n.checked?"x":" "}] `;return Rv(t,e,s)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:r})=>{const s=document.createElement("li"),i=document.createElement("label"),o=document.createElement("span"),l=document.createElement("input"),d=document.createElement("div"),f=p=>{var g,y;l.ariaLabel=((y=(g=this.options.a11y)==null?void 0:g.checkboxLabel)==null?void 0:y.call(g,p,l.checked))||`Task item checkbox for ${p.textContent||"empty task item"}`};return f(t),i.contentEditable="false",l.type="checkbox",l.addEventListener("mousedown",p=>p.preventDefault()),l.addEventListener("change",p=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){l.checked=!l.checked;return}const{checked:g}=p.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:y})=>{const m=n();if(typeof m!="number")return!1;const b=y.doc.nodeAt(m);return y.setNodeMarkup(m,void 0,{...b?.attrs,checked:g}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,g)||(l.checked=!l.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([p,g])=>{s.setAttribute(p,g)}),s.dataset.checked=t.attrs.checked,l.checked=t.attrs.checked,i.append(l,o),s.append(i,d),Object.entries(e).forEach(([p,g])=>{s.setAttribute(p,g)}),{dom:s,contentDOM:d,update:p=>p.type!==this.type?!1:(s.dataset.checked=p.attrs.checked,l.checked=p.attrs.checked,f(p),!0)}}},addInputRules(){return[Kl({find:UH,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),qH=kr.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",Zt(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return n!==void 0?n:-1},tokenize(t,e,n){const r=i=>{const o=qx(i,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:l=>({indentLevel:l[1].length,mainContent:l[4],checked:l[3].toLowerCase()==="x"}),createToken:(l,d)=>({type:"taskItem",raw:"",mainContent:l.mainContent,indentLevel:l.indentLevel,checked:l.checked,text:l.mainContent,tokens:n.inlineTokens(l.mainContent),nestedTokens:d}),customNestedParser:r},n);return o?[{type:"taskList",raw:o.raw,items:o.items}]:n.blockTokens(i)},s=qx(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:i=>({indentLevel:i[1].length,mainContent:i[4],checked:i[3].toLowerCase()==="x"}),createToken:(i,o)=>({type:"taskItem",raw:"",mainContent:i.mainContent,indentLevel:i.indentLevel,checked:i.checked,text:i.mainContent,tokens:n.inlineTokens(i.mainContent),nestedTokens:o}),customNestedParser:r},n);if(s)return{type:"taskList",raw:s.raw,items:s.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});Pt.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(P5.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(B5.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(V5.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(Q5.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push($H.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(qH.configure(this.options.taskList)),t}});var HH=kr.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Zt(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const n=t.tokens||[];return n.length===1&&n[0].type==="image"?e.parseChildren([n[0]]):e.createNode("paragraph",void 0,e.parseInline(n))},renderMarkdown:(t,e)=>!t||!Array.isArray(t.content)?"":e.renderChildren(t.content),addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),VH=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,KH=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,QH=wo.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Zt(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Vl({find:VH,type:this.type})]},addPasteRules(){return[ao({find:KH,type:this.type})]}}),WH=kr.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),YH=wo.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",Zt(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,n){const s=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!s)return;const i=s[2].trim();return{type:"underline",raw:s[0],text:i,tokens:n.inlineTokens(i)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function GH(t={}){return new _t({view(e){return new XH(e,t)}})}class XH{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let i=o=>{this[s](o)};return e.dom.addEventListener(s,i),{name:s,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,s=this.editorView.dom,i=s.getBoundingClientRect(),o=i.width/s.offsetWidth,l=i.height/s.offsetHeight;if(n){let g=e.nodeBefore,y=e.nodeAfter;if(g||y){let m=this.editorView.nodeDOM(this.cursorPos-(g?g.nodeSize:0));if(m){let b=m.getBoundingClientRect(),v=g?b.bottom:b.top;g&&y&&(v=(v+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let w=this.width/2*l;r={left:b.left,right:b.right,top:v-w,bottom:v+w}}}}if(!r){let g=this.editorView.coordsAtPos(this.cursorPos),y=this.width/2*o;r={left:g.left-y,right:g.left+y,top:g.top,bottom:g.bottom}}let d=this.editorView.dom.offsetParent;this.element||(this.element=d.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let f,p;if(!d||d==document.body&&getComputedStyle(d).position=="static")f=-pageXOffset,p=-pageYOffset;else{let g=d.getBoundingClientRect(),y=g.width/d.offsetWidth,m=g.height/d.offsetHeight;f=g.left-d.scrollLeft*y,p=g.top-d.scrollTop*m}this.element.style.left=(r.left-f)/o+"px",this.element.style.top=(r.top-p)/l+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),s=r&&r.type.spec.disableDropCursor,i=typeof s=="function"?s(this.editorView,n,e):s;if(n&&!i){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=G3(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class Lt extends Ge{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return Lt.valid(r)?new Lt(r):Ge.near(r)}content(){return Ae.empty}eq(e){return e instanceof Lt&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Lt(e.resolve(n.pos))}getBookmark(){return new Vv(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!JH(e)||!ZH(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let s=n.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&Lt.valid(e))return e;let s=e.pos,i=null;for(let o=e.depth;;o--){let l=e.node(o);if(n>0?e.indexAfter(o)<l.childCount:e.index(o)>0){i=l.child(n>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;s+=n;let d=e.doc.resolve(s);if(Lt.valid(d))return d}for(;;){let o=n>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!Be.isSelectable(i)){e=e.doc.resolve(s+i.nodeSize*n),r=!1;continue e}break}i=o,s+=n;let l=e.doc.resolve(s);if(Lt.valid(l))return l}return null}}}Lt.prototype.visible=!1;Lt.findFrom=Lt.findGapCursorFrom;Ge.jsonID("gapcursor",Lt);class Vv{constructor(e){this.pos=e}map(e){return new Vv(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return Lt.valid(n)?new Lt(n):Ge.near(n)}}function W5(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function JH(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||W5(s.type))return!0;if(s.inlineContent)return!1}}return!0}function ZH(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||W5(s.type))return!0;if(s.inlineContent)return!1}}return!0}function eV(){return new _t({props:{decorations:sV,createSelectionBetween(t,e,n){return e.pos==n.pos&&Lt.valid(n)?new Lt(n):null},handleClick:nV,handleKeyDown:tV,handleDOMEvents:{beforeinput:rV}}})}const tV=GM({ArrowLeft:Zf("horiz",-1),ArrowRight:Zf("horiz",1),ArrowUp:Zf("vert",-1),ArrowDown:Zf("vert",1)});function Zf(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,i){let o=r.selection,l=e>0?o.$to:o.$from,d=o.empty;if(o instanceof qe){if(!i.endOfTextblock(n)||l.depth==0)return!1;d=!1,l=r.doc.resolve(e>0?l.after():l.before())}let f=Lt.findGapCursorFrom(l,e,d);return f?(s&&s(r.tr.setSelection(new Lt(f))),!0):!1}}function nV(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!Lt.valid(r))return!1;let s=t.posAtCoords({left:n.clientX,top:n.clientY});return s&&s.inside>-1&&Be.isSelectable(t.state.doc.nodeAt(s.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Lt(r))),!0)}function rV(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Lt))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let s=Ne.empty;for(let o=r.length-1;o>=0;o--)s=Ne.from(r[o].createAndFill(null,s));let i=t.state.tr.replace(n.pos,n.pos,new Ae(s,0,0));return i.setSelection(qe.near(i.doc.resolve(n.pos+1))),t.dispatch(i),!1}function sV(t){if(!(t.selection instanceof Lt))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Rt.create(t.doc,[zn.widget(t.selection.head,e,{key:"gapcursor"})])}var wp=200,hn=function(){};hn.prototype.append=function(e){return e.length?(e=hn.from(e),!this.length&&e||e.length<wp&&this.leafAppend(e)||this.length<wp&&e.leafPrepend(this)||this.appendInner(e)):this};hn.prototype.prepend=function(e){return e.length?hn.from(e).append(this):this};hn.prototype.appendInner=function(e){return new iV(this,e)};hn.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?hn.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};hn.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};hn.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};hn.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,o){return s.push(e(i,o))},n,r),s};hn.from=function(e){return e instanceof hn?e:e&&e.length?new Y5(e):hn.empty};var Y5=(function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new e(this.values.slice(s,i))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,i,o,l){for(var d=i;d<o;d++)if(s(this.values[d],l+d)===!1)return!1},e.prototype.forEachInvertedInner=function(s,i,o,l){for(var d=i-1;d>=o;d--)if(s(this.values[d],l+d)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=wp)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=wp)return new e(s.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e})(hn);hn.empty=new Y5([]);var iV=(function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,i,o){var l=this.left.length;if(s<l&&this.left.forEachInner(r,s,Math.min(i,l),o)===!1||i>l&&this.right.forEachInner(r,Math.max(s-l,0),Math.min(this.length,i)-l,o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,i,o){var l=this.left.length;if(s>l&&this.right.forEachInvertedInner(r,s-l,Math.max(i,l)-l,o+l)===!1||i<l&&this.left.forEachInvertedInner(r,Math.min(s,l),i,o)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e})(hn);const aV=500;class is{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;n&&(s=this.remapping(r,this.items.length),i=s.maps.length);let o=e.tr,l,d,f=[],p=[];return this.items.forEach((g,y)=>{if(!g.step){s||(s=this.remapping(r,y+1),i=s.maps.length),i--,p.push(g);return}if(s){p.push(new vs(g.map));let m=g.step.map(s.slice(i)),b;m&&o.maybeStep(m).doc&&(b=o.mapping.maps[o.mapping.maps.length-1],f.push(new vs(b,void 0,void 0,f.length+p.length))),i--,b&&s.appendMap(b,i)}else o.maybeStep(g.step);if(g.selection)return l=s?g.selection.map(s.slice(i)):g.selection,d=new is(this.items.slice(0,r).append(p.reverse().concat(f)),this.eventCount-1),!1},this.items.length,0),{remaining:d,transform:o,selection:l}}addTransform(e,n,r,s){let i=[],o=this.eventCount,l=this.items,d=!s&&l.length?l.get(l.length-1):null;for(let p=0;p<e.steps.length;p++){let g=e.steps[p].invert(e.docs[p]),y=new vs(e.mapping.maps[p],g,n),m;(m=d&&d.merge(y))&&(y=m,p?i.pop():l=l.slice(0,l.length-1)),i.push(y),n&&(o++,n=void 0),s||(d=y)}let f=o-r.depth;return f>lV&&(l=oV(l,f),o-=f),new is(l.append(i),o)}remapping(e,n){let r=new $u;return this.items.forEach((s,i)=>{let o=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,o)},e,n),r}addMaps(e){return this.eventCount==0?this:new is(this.items.append(e.map(n=>new vs(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-n),i=e.mapping,o=e.steps.length,l=this.eventCount;this.items.forEach(y=>{y.selection&&l--},s);let d=n;this.items.forEach(y=>{let m=i.getMirror(--d);if(m==null)return;o=Math.min(o,m);let b=i.maps[m];if(y.step){let v=e.steps[m].invert(e.docs[m]),w=y.selection&&y.selection.map(i.slice(d+1,m));w&&l++,r.push(new vs(b,v,w))}else r.push(new vs(b))},s);let f=[];for(let y=n;y<o;y++)f.push(new vs(i.maps[y]));let p=this.items.slice(0,s).append(f).append(r),g=new is(p,l);return g.emptyItemCount()>aV&&(g=g.compress(this.items.length-r.length)),g}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,s=[],i=0;return this.items.forEach((o,l)=>{if(l>=e)s.push(o),o.selection&&i++;else if(o.step){let d=o.step.map(n.slice(r)),f=d&&d.getMap();if(r--,f&&n.appendMap(f,r),d){let p=o.selection&&o.selection.map(n.slice(r));p&&i++;let g=new vs(f.invert(),d,p),y,m=s.length-1;(y=s.length&&s[m].merge(g))?s[m]=y:s.push(g)}}else o.map&&r--},this.items.length,0),new is(hn.from(s.reverse()),i)}}is.empty=new is(hn.empty,0);function oV(t,e){let n;return t.forEach((r,s)=>{if(r.selection&&e--==0)return n=s,!1}),t.slice(n)}class vs{constructor(e,n,r,s){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new vs(n.getMap().invert(),n,this.selection)}}}class Qi{constructor(e,n,r,s,i){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const lV=20;function cV(t,e,n,r){let s=n.getMeta(Ya),i;if(s)return s.historyState;n.getMeta(fV)&&(t=new Qi(t.done,t.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(Ya))return o.getMeta(Ya).redo?new Qi(t.done.addTransform(n,void 0,r,dh(e)),t.undone,YN(n.mapping.maps),t.prevTime,t.prevComposition):new Qi(t.done,t.undone.addTransform(n,void 0,r,dh(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=n.getMeta("composition"),d=t.prevTime==0||!o&&t.prevComposition!=l&&(t.prevTime<(n.time||0)-r.newGroupDelay||!uV(n,t.prevRanges)),f=o?gy(t.prevRanges,n.mapping):YN(n.mapping.maps);return new Qi(t.done.addTransform(n,d?e.selection.getBookmark():void 0,r,dh(e)),is.empty,f,n.time,l??t.prevComposition)}else return(i=n.getMeta("rebased"))?new Qi(t.done.rebased(n,i),t.undone.rebased(n,i),gy(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Qi(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),gy(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function uV(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(n=!0)}),n}function YN(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,s,i,o)=>e.push(i,o));return e}function gy(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let s=e.map(t[r],1),i=e.map(t[r+1],-1);s<=i&&n.push(s,i)}return n}function dV(t,e,n){let r=dh(e),s=Ya.get(e).spec.config,i=(n?t.undone:t.done).popEvent(e,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),l=(n?t.done:t.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),d=new Qi(n?l:i.remaining,n?i.remaining:l,null,0,-1);return i.transform.setSelection(o).setMeta(Ya,{redo:n,historyState:d})}let my=!1,GN=null;function dh(t){let e=t.plugins;if(GN!=e){my=!1,GN=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){my=!0;break}}return my}const Ya=new sn("history"),fV=new sn("closeHistory");function hV(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new _t({key:Ya,state:{init(){return new Qi(is.empty,is.empty,null,0,-1)},apply(e,n,r){return cV(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,s=r=="historyUndo"?X5:r=="historyRedo"?J5:null;return!s||!e.editable?!1:(n.preventDefault(),s(e.state,e.dispatch))}}}})}function G5(t,e){return(n,r)=>{let s=Ya.getState(n);if(!s||(t?s.undone:s.done).eventCount==0)return!1;if(r){let i=dV(s,n,t);i&&r(e?i.scrollIntoView():i)}return!0}}const X5=G5(!1,!0),J5=G5(!0,!0);Pt.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=t?.node||this.editor.state.doc;if((t?.mode||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=t=>{const e=t?.node||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let t=!1;return[new _t({key:new sn("characterCount"),appendTransaction:(e,n,r)=>{if(t)return;const s=this.options.limit;if(s==null||s===0){t=!0;return}const i=this.storage.characters({node:r.doc});if(i>s){const o=i-s,l=0,d=o;console.warn(`[CharacterCount] Initial content exceeded limit of ${s} characters. Content was automatically trimmed.`);const f=r.tr.deleteRange(l,d);return t=!0,f}t=!0},filterTransaction:(e,n)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const s=this.storage.characters({node:n.doc}),i=this.storage.characters({node:e.doc});if(i<=r||s>r&&i>r&&i<=s)return!0;if(s>r&&i>r&&i>s||!e.getMeta("paste"))return!1;const l=e.selection.$head.pos,d=i-r,f=l-d,p=l;return e.deleteRange(f,p),!(this.storage.characters({node:e.doc})>r)}})]}});var pV=Pt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[GH(this.options)]}});Pt.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new _t({key:new sn("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:s}=e,i=[];if(!n||!r)return Rt.create(t,[]);let o=0;this.options.mode==="deepest"&&t.descendants((d,f)=>{if(d.isText)return;if(!(s>=f&&s<=f+d.nodeSize-1))return!1;o+=1});let l=0;return t.descendants((d,f)=>{if(d.isText||!(s>=f&&s<=f+d.nodeSize-1))return!1;if(l+=1,this.options.mode==="deepest"&&o-l>0||this.options.mode==="shallowest"&&l>1)return this.options.mode==="deepest";i.push(zn.node(f,f+d.nodeSize,{class:this.options.className}))}),Rt.create(t,i)}}})]}});var gV=Pt.create({name:"gapCursor",addProseMirrorPlugins(){return[eV()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=gt(Pe(t,"allowGapCursor",n)))!=null?e:null}}});Pt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new _t({key:new sn("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,s=[];if(!n)return null;const i=this.editor.isEmpty;return t.descendants((o,l)=>{const d=r>=l&&r<=l+o.nodeSize,f=!o.isLeaf&&rg(o);if((d||!this.options.showOnlyCurrent)&&f){const p=[this.options.emptyNodeClass];i&&p.push(this.options.emptyEditorClass);const g=zn.node(l,l+o.nodeSize,{class:p.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:o,pos:l,hasAnchor:d}):this.options.placeholder});s.push(g)}return this.options.includeChildren}),Rt.create(t,s)}}})]}});Pt.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new _t({key:new sn("selection"),props:{decorations(n){return n.selection.empty||t.isFocused||!t.isEditable||f5(n.selection)||t.view.dragging?null:Rt.create(n.doc,[zn.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});function XN({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||e?.type===t}var mV=Pt.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new sn(this.name),n=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,s])=>s).filter(s=>(this.options.notAfter||[]).concat(n).includes(s.name));return[new _t({key:e,appendTransaction:(s,i,o)=>{const{doc:l,tr:d,schema:f}=o,p=e.getState(o),g=l.content.size,y=f.nodes[n];if(p)return d.insert(g,y.create())},state:{init:(s,i)=>{const o=i.tr.doc.lastChild;return!XN({node:o,types:r})},apply:(s,i)=>{if(!s.docChanged||s.getMeta("__uniqueIDTransaction"))return i;const o=s.doc.lastChild;return!XN({node:o,types:r})}}})]}}),yV=Pt.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>X5(t,e),redo:()=>({state:t,dispatch:e})=>J5(t,e)}},addProseMirrorPlugins(){return[hV(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),xV=Pt.create({name:"starterKit",addExtensions(){var t,e,n,r;const s=[];return this.options.bold!==!1&&s.push(Vq.configure(this.options.bold)),this.options.blockquote!==!1&&s.push(Fq.configure(this.options.blockquote)),this.options.bulletList!==!1&&s.push(P5.configure(this.options.bulletList)),this.options.code!==!1&&s.push(Wq.configure(this.options.code)),this.options.codeBlock!==!1&&s.push(Xq.configure(this.options.codeBlock)),this.options.document!==!1&&s.push(Jq.configure(this.options.document)),this.options.dropcursor!==!1&&s.push(pV.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&s.push(gV.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&s.push(Zq.configure(this.options.hardBreak)),this.options.heading!==!1&&s.push(eH.configure(this.options.heading)),this.options.undoRedo!==!1&&s.push(yV.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&s.push(tH.configure(this.options.horizontalRule)),this.options.italic!==!1&&s.push(aH.configure(this.options.italic)),this.options.listItem!==!1&&s.push(B5.configure(this.options.listItem)),this.options.listKeymap!==!1&&s.push(V5.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&s.push(RH.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&s.push(Q5.configure(this.options.orderedList)),this.options.paragraph!==!1&&s.push(HH.configure(this.options.paragraph)),this.options.strike!==!1&&s.push(QH.configure(this.options.strike)),this.options.text!==!1&&s.push(WH.configure(this.options.text)),this.options.underline!==!1&&s.push(YH.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&s.push(mV.configure((r=this.options)==null?void 0:r.trailingNode)),s}}),Kv=xV;function bV({entry:t,index:e,onPersonNameChange:n,onReferenceChange:r,onDelete:s}){const{t:i}=ke("queue"),{attributes:o,listeners:l,setNodeRef:d,transform:f,transition:p,isDragging:g}=xo({id:t.id}),y={transform:cs.Transform.toString(f),transition:p},{translation:m}=Qb(),{data:b=[]}=Fp(m?.id??0),[v,w]=C.useState(t.referenceInput);C.useEffect(()=>{const j=setTimeout(()=>{if(!v.trim()){r(v,null);return}if(b.length===0)return;const M=ZE({input:v,books:b});r(v,M)},300);return()=>clearTimeout(j)},[v,b,r]);const S=t.parsedResult?.status==="valid",T=t.parsedResult&&t.parsedResult.status!=="valid";return u.jsxs("div",{ref:d,style:y,className:`flex items-start gap-2 p-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg ${g?"opacity-50 shadow-lg":""}`,children:[u.jsx("button",{type:"button",...o,...l,className:"cursor-grab active:cursor-grabbing p-1 mt-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors flex-shrink-0",children:u.jsx(or,{className:"w-4 h-4 text-gray-400"})}),u.jsxs("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mt-2 flex-shrink-0 w-6",children:[e+1,"."]}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx("input",{type:"text",value:t.personName,onChange:j=>n(j.target.value),placeholder:i("verseteTineri.personNamePlaceholder"),className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("input",{type:"text",value:v,onChange:j=>w(j.target.value),placeholder:i("biblePassage.referencePlaceholder"),className:`w-full px-3 py-1.5 text-sm border rounded bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:ring-2 focus:border-transparent ${T?"border-red-300 dark:border-red-600 focus:ring-red-500":S?"border-teal-300 dark:border-teal-600 focus:ring-teal-500":"border-gray-300 dark:border-gray-600 focus:ring-indigo-500"}`}),t.parsedResult&&u.jsx("div",{className:"flex items-center gap-1 text-xs",children:S?u.jsxs(u.Fragment,{children:[u.jsx(wb,{size:12,className:"text-teal-600 dark:text-teal-400"}),u.jsx("span",{className:"text-teal-700 dark:text-teal-300",children:t.parsedResult.formattedReference})]}):u.jsxs(u.Fragment,{children:[u.jsx(vh,{size:12,className:"text-red-500"}),u.jsx("span",{className:"text-red-600 dark:text-red-400",children:i(t.parsedResult.errorKey)})]})})]})]}),u.jsx("button",{type:"button",onClick:s,className:"p-1.5 mt-1 hover:bg-red-100 dark:hover:bg-red-900/20 rounded transition-colors flex-shrink-0",title:i("verseteTineri.removeEntry"),children:u.jsx(Bn,{className:"w-4 h-4 text-gray-400 hover:text-red-500"})})]})}function vV({entries:t,onEntriesChange:e}){const{t:n}=ke("queue"),r=ho(sr(pi),sr(hi,{coordinateGetter:bo})),s=f=>{const{active:p,over:g}=f;if(g&&p.id!==g.id){const y=t.findIndex(v=>v.id===p.id),m=t.findIndex(v=>v.id===g.id),b=tc(t,y,m).map((v,w)=>({...v,sortOrder:w}));e(b)}},i=()=>{const f={id:`temp-${Date.now()}`,personName:"",referenceInput:"",parsedResult:null,sortOrder:t.length};e([...t,f])},o=C.useCallback((f,p)=>{const g=t.map(y=>y.id===f?{...y,personName:p}:y);e(g)},[t,e]),l=C.useCallback((f,p,g)=>{const y=t.map(m=>m.id===f?{...m,referenceInput:p,parsedResult:g}:m);e(y)},[t,e]),d=C.useCallback(f=>{const p=t.filter(g=>g.id!==f).map((g,y)=>({...g,sortOrder:y}));e(p)},[t,e]);return u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[u.jsx(Bl,{size:16}),u.jsx("span",{children:n("verseteTineri.entriesCount",{count:t.length})})]}),t.length>0?u.jsx(go,{sensors:r,collisionDetection:po,onDragEnd:s,children:u.jsx(yo,{items:t.map(f=>f.id),strategy:mo,children:u.jsx("div",{className:"space-y-2",children:t.map((f,p)=>u.jsx(bV,{entry:f,index:p,onPersonNameChange:g=>o(f.id,g),onReferenceChange:(g,y)=>l(f.id,g,y),onDelete:()=>d(f.id)},f.id))})})}):u.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-center border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg",children:[u.jsx(Bl,{className:"w-8 h-8 text-gray-400 mb-2"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n("verseteTineri.noEntries")})]}),u.jsxs("button",{type:"button",onClick:i,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-400 hover:border-indigo-400 hover:text-indigo-600 dark:hover:border-indigo-500 dark:hover:text-indigo-400 transition-colors",children:[u.jsx(Xt,{size:18}),n("verseteTineri.addEntry")]})]})}const wV=[{type:"announcement",icon:lo},{type:"versete_tineri",icon:ds}];function tb({isOpen:t,onClose:e,afterItemId:n,editingItem:r,initialTemplate:s,onSaved:i}){const{t:o}=ke("queue"),{showToast:l}=mt(),d=C.useRef(null),f=C8(),p=R8(),g=N8(),{translation:y}=Qb(),m=!!r,[b,v]=C.useState("announcement"),[w,S]=C.useState(""),[T,j]=C.useState([]),M=Dv({extensions:[Kv.configure({heading:{levels:[1,2]}}),_v.configure({types:["heading","paragraph"]})],content:"",onUpdate:({editor:A})=>{S(A.getHTML())},editorProps:{attributes:{class:"min-h-[150px] p-4 focus:outline-none bg-white dark:bg-gray-900 prose prose-sm dark:prose-invert max-w-none",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}}});C.useEffect(()=>{t?(d.current?.showModal(),r?(v(r.slideType??"announcement"),S(r.slideContent??""),M?.commands.setContent(r.slideContent??""),j([])):(v(s??"announcement"),S(""),M?.commands.setContent(""),j([]))):d.current?.close()},[t,M,r,s]);const _=async()=>{if(b==="versete_tineri"){const A=T.filter(P=>P.personName.trim()&&P.parsedResult?.status==="valid");if(A.length===0){l(o("verseteTineri.errorNoValidEntries"),"error");return}if(!y){l(o("verseteTineri.errorNoTranslation"),"error");return}const F=A.map(P=>({personName:P.personName.trim(),translationId:y.id,bookCode:P.parsedResult.bookCode,bookName:P.parsedResult.bookName,startChapter:P.parsedResult.startChapter,startVerse:P.parsedResult.startVerse,endChapter:P.parsedResult.endChapter,endVerse:P.parsedResult.endVerse}));(await g.mutateAsync({entries:F,afterItemId:n})).success?(l(o("messages.slideInserted"),"success"),i?.(),e()):l(o("messages.error"),"error");return}if(!w.trim()){l(o("insertSlide.errorEmpty"),"error");return}m&&r?(await p.mutateAsync({id:r.id,slideType:b,slideContent:w})).success?(l(o("messages.slideUpdated"),"success"),i?.(),e()):l(o("messages.error"),"error"):(await f.mutateAsync({slideType:b,slideContent:w,afterItemId:n})).success?(l(o("messages.slideInserted"),"success"),i?.(),e()):l(o("messages.error"),"error")},R=()=>{!f.isPending&&!p.isPending&&!g.isPending&&e()},O=f.isPending||p.isPending||g.isPending,L=A=>{A.target===d.current&&R()};return u.jsx("dialog",{ref:d,onCancel:R,onClick:L,className:"fixed inset-0 m-auto w-full max-w-xl p-0 rounded-lg bg-white dark:bg-gray-800 backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col max-h-[80vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:o(m?"insertSlide.editTitle":"insertSlide.title")}),u.jsx("button",{type:"button",onClick:R,disabled:O,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[(m||!s)&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o("insertSlide.selectTemplate")}),u.jsx("div",{className:"flex gap-2",children:wV.map(({type:A,icon:F})=>u.jsxs("button",{type:"button",onClick:()=>v(A),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg border transition-colors ${b===A?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300":"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[u.jsx(F,{size:18}),u.jsx("span",{className:"text-sm font-medium",children:o(`slideTemplates.${A}`)})]},A))})]}),b==="versete_tineri"?u.jsx(vV,{entries:T,onEntriesChange:j}):u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o("insertSlide.content")}),u.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 dark:bg-gray-900 rounded-t-lg border border-b-0 border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:()=>M?.chain().focus().toggleBold().run(),className:`px-2 py-1 rounded text-sm font-bold ${M?.isActive("bold")?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"B"}),u.jsx("button",{type:"button",onClick:()=>M?.chain().focus().toggleItalic().run(),className:`px-2 py-1 rounded text-sm italic ${M?.isActive("italic")?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"I"}),u.jsx("div",{className:"w-px h-5 bg-gray-300 dark:bg-gray-600 mx-1"}),u.jsx("button",{type:"button",onClick:()=>M?.chain().focus().toggleHeading({level:1}).run(),className:`px-2 py-1 rounded text-sm ${M?.isActive("heading",{level:1})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"H1"}),u.jsx("button",{type:"button",onClick:()=>M?.chain().focus().toggleHeading({level:2}).run(),className:`px-2 py-1 rounded text-sm ${M?.isActive("heading",{level:2})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"H2"})]}),u.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-b-lg overflow-hidden",children:u.jsx(Ov,{editor:M})})]})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:R,disabled:O,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg disabled:opacity-50",children:o("actions.cancel")}),u.jsxs("button",{type:"button",onClick:_,disabled:O||(b==="versete_tineri"?T.length===0:!w.trim()),className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:[O&&u.jsx(Qe,{size:18,className:"animate-spin"}),o(m?"insertSlide.save":"insertSlide.insert")]})]})]})})}const dd=C.forwardRef(function({onEditSong:e,onEditSlide:n,onAddToSchedule:r,onInsertSongAfter:s,onInsertBibleVerseAfter:i,onInsertBiblePassageAfter:o,onInsertSlideAfter:l,onRemove:d},f){const{t:p}=ke("queue"),[g,y]=C.useState(!1),[m,b]=C.useState(!1),v=C.useRef(null),w=C.useRef(null),S=C.useRef(null);C.useImperativeHandle(f,()=>({openMenu:()=>y(!0)})),C.useEffect(()=>{if(!g)return;const R=O=>{v.current&&!v.current.contains(O.target)&&w.current&&!w.current.contains(O.target)&&y(!1)};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[g]),C.useEffect(()=>{if(!g)return;const R=O=>{O.key==="Escape"&&y(!1)};return document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[g]),C.useEffect(()=>{m?S.current?.showModal():S.current?.close()},[m]);const T=R=>{y(!1),R()},j=()=>{y(!1),b(!0)},M=R=>{b(!1),R()},_=()=>{b(!1)};return u.jsxs("div",{className:"relative",children:[u.jsx("button",{ref:w,type:"button",onClick:()=>y(!g),className:"flex-shrink-0 p-1.5 rounded text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:p("actions.moreOptions"),children:u.jsx(Op,{size:16})}),g&&u.jsxs("div",{ref:v,className:"absolute right-0 top-full mt-1 z-50 min-w-[160px] bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-1",children:[e&&u.jsxs("button",{type:"button",onClick:()=>T(e),className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(M2,{size:14}),p("actions.editSong")]}),n&&u.jsxs("button",{type:"button",onClick:()=>T(n),className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(M2,{size:14}),p("actions.editSlide")]}),r&&u.jsxs("button",{type:"button",onClick:()=>T(r),className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(bh,{size:14}),p("actions.addToSchedule")]}),u.jsxs("button",{type:"button",onClick:j,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(jD,{size:14}),p("actions.insertAfter")]}),u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1"}),u.jsxs("button",{type:"button",onClick:()=>T(d),className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-left text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:[u.jsx(Bn,{size:14}),p("actions.remove")]})]}),u.jsx("dialog",{ref:S,onCancel:_,onClick:R=>{R.target===S.current&&_()},className:"fixed inset-0 m-auto w-full max-w-sm p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:p("actions.insertAfter")}),u.jsx("button",{type:"button",onClick:_,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"p-4 space-y-2",children:[u.jsxs("button",{type:"button",onClick:()=>M(s),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center",children:u.jsx(ha,{size:20,className:"text-indigo-600 dark:text-indigo-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:p("addToQueue.searchSong")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:p("addToQueue.searchSongDescription")})]})]}),i&&u.jsxs("button",{type:"button",onClick:()=>M(i),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:u.jsx(wr,{size:20,className:"text-blue-600 dark:text-blue-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:p("addToQueue.bibleVerse")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:p("addToQueue.bibleVerseDescription")})]})]}),o&&u.jsxs("button",{type:"button",onClick:()=>M(o),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-teal-100 dark:bg-teal-900/30 flex items-center justify-center",children:u.jsx(Ap,{size:20,className:"text-teal-600 dark:text-teal-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:p("addToQueue.biblePassage")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:p("addToQueue.biblePassageDescription")})]})]}),u.jsxs("button",{type:"button",onClick:()=>M(()=>l("announcement")),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center",children:u.jsx(lo,{size:20,className:"text-orange-600 dark:text-orange-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:p("addToQueue.announcement")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:p("addToQueue.announcementDescription")})]})]}),u.jsxs("button",{type:"button",onClick:()=>M(()=>l("versete_tineri")),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:u.jsx(ds,{size:20,className:"text-green-600 dark:text-green-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:p("addToQueue.verseteTineri")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:p("addToQueue.verseteTineriDescription")})]})]})]})]})})]})});function SV({item:t,isActive:e,onRemove:n,onClick:r,onInsertSongAfter:s,onInsertBibleVerseAfter:i,onInsertBiblePassageAfter:o,onInsertSlideAfter:l,dragHandleProps:d}){const{t:f}=ke("queue"),p=C.useRef(null),g=y=>{y.preventDefault(),p.current?.openMenu()};return u.jsx("div",{className:`rounded-lg border transition-all ${e?"border-green-400 bg-green-50/50 dark:bg-green-900/10":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"}`,children:u.jsxs("div",{className:"flex items-center gap-2 p-3",onContextMenu:g,children:[u.jsx("div",{...d,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(or,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsxs("button",{type:"button",onClick:r,className:"flex-1 flex items-center gap-3 min-w-0 text-left",children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${e?"bg-green-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:u.jsx(wr,{size:16})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:`font-medium text-sm ${e?"text-green-900 dark:text-green-100":"text-gray-900 dark:text-white"}`,children:t.bibleReference||f("bible.verse")}),t.bibleTranslation&&u.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400",children:t.bibleTranslation})]}),t.bibleText&&u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:t.bibleText})]})]}),u.jsx(dd,{ref:p,onInsertSongAfter:s,onInsertBibleVerseAfter:i,onInsertBiblePassageAfter:o,onInsertSlideAfter:l,onRemove:n})]})})}function kV({verse:t,verseIndex:e,isActive:n,onClick:r}){const s=C.useRef(null);Yb(s,n);const i=t.text.length>100?`${t.text.slice(0,100)}...`:t.text;return u.jsx("button",{ref:s,type:"button",onClick:r,className:`w-full text-left p-2 pl-10 rounded-lg border transition-all ${n?"border-teal-600 bg-teal-50 dark:bg-teal-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 bg-white dark:bg-gray-800"}`,children:u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium ${n?"bg-teal-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:e+1}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:`text-xs font-medium mb-0.5 ${n?"text-teal-700 dark:text-teal-300":"text-gray-500 dark:text-gray-400"}`,children:t.reference}),u.jsx("div",{className:`text-sm line-clamp-2 ${n?"text-teal-900 dark:text-teal-100":"text-gray-700 dark:text-gray-300"}`,children:i})]})]})})}function CV({item:t,isExpanded:e,activeVerseId:n,activeQueueItemId:r,onToggleExpand:s,onRemove:i,onVerseClick:o,onPassageClick:l,onInsertSongAfter:d,onInsertBibleVerseAfter:f,onInsertBiblePassageAfter:p,onInsertSlideAfter:g,dragHandleProps:y}){const{t:m}=ke("queue"),b=C.useRef(null),v=t.id===r,w=v&&t.biblePassageVerses.some(T=>T.id===n),S=T=>{T.preventDefault(),b.current?.openMenu()};return u.jsxs("div",{className:`rounded-lg border transition-all ${w?"border-teal-400 bg-teal-50/50 dark:bg-teal-900/10":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"}`,children:[u.jsxs("div",{className:"flex items-center gap-2 p-3",onContextMenu:S,children:[u.jsx("div",{...y,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(or,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsx("button",{type:"button",onClick:s,className:"flex-shrink-0 p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",title:m(e?"actions.collapse":"actions.expand"),children:e?u.jsx(Es,{size:16,className:"text-gray-500"}):u.jsx(Ms,{size:16,className:"text-gray-500"})}),u.jsxs("button",{type:"button",onClick:l,className:"flex items-center gap-3 flex-1 min-w-0 text-left",children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${w?"bg-teal-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:u.jsx(wr,{size:16})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("span",{className:`font-medium text-sm truncate ${w?"text-teal-900 dark:text-teal-100":"text-gray-900 dark:text-white"}`,children:t.biblePassageReference||m("biblePassage.passage")})}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:m("biblePassage.versesCount",{count:t.biblePassageVerses.length})})]})]}),u.jsx(dd,{ref:b,onInsertSongAfter:d,onInsertBibleVerseAfter:f,onInsertBiblePassageAfter:p,onInsertSlideAfter:g,onRemove:i})]}),e&&t.biblePassageVerses.length>0&&u.jsx("div",{className:"px-3 pb-3 space-y-1.5",children:t.biblePassageVerses.map((T,j)=>u.jsx(kV,{verse:T,verseIndex:j,isActive:v&&T.id===n,onClick:()=>o(T.id)},T.id))})]})}async function NV(){return(await Me("/api/schedules")).data??[]}async function TV(t){return(await Me(`/api/schedules/${t}`)).data??null}async function jV(t){const e=await Me("/api/schedules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function EV(t){return(await Me(`/api/schedules/${t}`,{method:"DELETE"})).data?.success??!1}async function MV(t){return(await Me(`/api/schedules/search?q=${encodeURIComponent(t)}`)).data??[]}async function AV(t,e){const n=await Me(`/api/schedules/${t}/items`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return n.error?{success:!1,error:n.error}:{success:!0,data:n.data}}async function RV(t,e){return(await Me(`/api/schedules/${t}/items/${e}`,{method:"DELETE"})).data?.success??!1}async function _V(t,e,n){const r=await Me(`/api/schedules/${t}/items/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return r.error?{success:!1,error:r.error}:{success:!0,data:r.data}}async function OV(t,e){return(await Me(`/api/schedules/${t}/items/reorder`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).data?.success??!1}async function DV(t){return(await Me(`/api/schedules/${t}/import-to-queue`,{method:"POST"})).data?.success??!1}function og(){const t=Le();return Ie({mutationFn:({scheduleId:e,input:n})=>AV(e,n),onSuccess:(e,{scheduleId:n})=>{t.invalidateQueries({queryKey:["schedules"]}),t.invalidateQueries({queryKey:["schedule",n]})}})}function IV(){const t=Le();return Ie({mutationFn:e=>EV(e),onSuccess:()=>{t.invalidateQueries({queryKey:["schedules"]})}})}function Z5(){const t=Le();return Ie({mutationFn:e=>DV(e),onSuccess:()=>{t.invalidateQueries({queryKey:["queue"]})}})}function eA(){const t=Le();return Ie({mutationFn:({scheduleId:e,itemId:n})=>RV(e,n),onSuccess:(e,{scheduleId:n})=>{t.invalidateQueries({queryKey:["schedules"]}),t.invalidateQueries({queryKey:["schedule",n]})}})}function tA(){const t=Le();return Ie({mutationFn:({scheduleId:e,input:n})=>OV(e,n),onSuccess:(e,{scheduleId:n})=>{t.invalidateQueries({queryKey:["schedule",n]})}})}function LV(t){return lt({queryKey:["schedule",t],queryFn:()=>TV(t),enabled:t>0})}function zV(){return lt({queryKey:["schedules"],queryFn:NV})}function PV(t){return lt({queryKey:["schedules","search",t],queryFn:()=>MV(t),enabled:t.length>0})}function BV(){const t=Le();return Ie({mutationFn:({scheduleId:e,itemId:n,input:r})=>_V(e,n,r),onSuccess:(e,{scheduleId:n})=>{t.invalidateQueries({queryKey:["schedule",n]})}})}function nA(){const t=Le();return Ie({mutationFn:e=>jV(e),onSuccess:e=>{e.success&&(t.invalidateQueries({queryKey:["schedules"]}),e.data?.id&&t.invalidateQueries({queryKey:["schedule",e.data.id]}))}})}function FV({isOpen:t,onClose:e,onCreated:n}){const{t:r}=ke("schedules"),{showToast:s}=mt(),i=C.useRef(null),o=C.useRef(null),[l,d]=C.useState(""),f=nA();C.useEffect(()=>{t?(i.current?.showModal(),setTimeout(()=>o.current?.focus(),100)):(i.current?.close(),d(""))},[t]),C.useEffect(()=>{const y=i.current;if(!y)return;const m=b=>{b.preventDefault(),f.isPending||e()};return y.addEventListener("cancel",m),()=>y.removeEventListener("cancel",m)},[e,f.isPending]);const p=async y=>{if(y.preventDefault(),!l.trim())return;const m=await f.mutateAsync({title:l.trim()});m.success&&m.data?(s(r("messages.saved"),"success"),n?.(),e()):s(r("messages.error"),"error")},g=()=>{f.isPending||e()};return u.jsx("dialog",{ref:i,className:"fixed inset-0 m-auto w-full max-w-sm p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:y=>{y.target===i.current&&g()},onKeyDown:y=>{y.key==="Escape"&&g()},children:u.jsxs("form",{onSubmit:p,className:"flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r("modal.createTitle")}),u.jsx("button",{type:"button",onClick:g,disabled:f.isPending,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"p-4",children:[u.jsx("label",{htmlFor:"schedule-title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("modal.scheduleName")}),u.jsx("input",{ref:o,id:"schedule-title",type:"text",value:l,onChange:y=>d(y.target.value),disabled:f.isPending,placeholder:r("editor.titlePlaceholder"),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white disabled:opacity-50",autoComplete:"off"})]}),u.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:g,disabled:f.isPending,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50",children:r("modal.cancel")}),u.jsxs("button",{type:"submit",disabled:!l.trim()||f.isPending,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors disabled:opacity-50",children:[f.isPending&&u.jsx(Qe,{size:16,className:"animate-spin"}),r("modal.create")]})]})]})})}function UV({schedule:t,onClick:e}){const{t:n,i18n:r}=ke("schedules"),s=i=>new Date(i).toLocaleDateString(r.language,{year:"numeric",month:"short",day:"numeric"});return u.jsxs("button",{type:"button",onClick:e,className:"w-full flex items-center justify-between p-4 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:border-indigo-300 dark:hover:border-indigo-600 hover:shadow-sm transition-all text-left group",children:[u.jsxs("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[u.jsx("div",{className:"p-2 bg-indigo-50 dark:bg-indigo-900/30 rounded-lg flex-shrink-0",children:u.jsx(Rp,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.title}),t.description&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-0.5 line-clamp-1",children:t.description}),u.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(Ij,{className:"w-3 h-3 text-gray-400"}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:n("itemCount",{count:t.itemCount})})]}),t.createdAt&&u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(_p,{className:"w-3 h-3 text-gray-400"}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s(t.createdAt)})]})]}),t.matchedContent&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-1",dangerouslySetInnerHTML:{__html:t.matchedContent}})]})]}),u.jsx(Ms,{className:"w-5 h-5 text-gray-400 group-hover:text-indigo-500 transition-colors flex-shrink-0 ml-2"})]})}function Qv({onScheduleClick:t}){const{t:e}=ke("schedules"),[n,r]=C.useState(""),{data:s,isLoading:i}=zV(),{data:o,isLoading:l}=PV(n),d=n.length>0,f=d?l:i,p=C.useMemo(()=>d&&o?o.map(g=>({id:g.id,title:g.title,description:g.description,itemCount:g.itemCount,matchedContent:g.matchedContent})):[...s??[]].sort((g,y)=>y.createdAt-g.createdAt).map(g=>({id:g.id,title:g.title,description:g.description,itemCount:g.itemCount,createdAt:g.createdAt})),[d,o,s]);return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Yl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",value:n,onChange:g=>r(g.target.value),placeholder:e("search.placeholder"),className:"w-full pl-10 pr-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors"})]}),f?u.jsx("div",{className:"grid gap-3",children:[1,2,3].map(g=>u.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"},g))}):p.length===0?u.jsxs("div",{className:"text-center py-12 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx(Rp,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:d?e("search.noResults",{query:n}):e("noSchedules")}),!d&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:e("noSchedulesDescription")})]}):u.jsxs("div",{className:"grid gap-3",children:[d&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e("search.resultsCount",{count:p.length})}),p.map(g=>u.jsx(UV,{schedule:g,onClick:()=>t(g.id)},g.id))]})]})}function Wv({isOpen:t,songId:e,onClose:n,onAdded:r}){const{t:s}=ke("schedules"),{showToast:i}=mt(),o=C.useRef(null),l=og(),[d,f]=C.useState(!1);C.useEffect(()=>{t?o.current?.showModal():o.current?.close()},[t]),C.useEffect(()=>{const m=o.current;if(!m)return;const b=v=>{v.preventDefault(),l.isPending||n()};return m.addEventListener("cancel",b),()=>m.removeEventListener("cancel",b)},[n,l.isPending]);const p=async m=>{(await l.mutateAsync({scheduleId:m,input:{songId:e}})).success?(i(s("messages.itemAdded"),"success"),r?.(m),n()):i(s("messages.error"),"error")},g=()=>{f(!1)},y=()=>{l.isPending||n()};return u.jsxs(u.Fragment,{children:[u.jsx("dialog",{ref:o,className:"fixed inset-0 m-auto w-full max-w-lg p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:m=>{m.target===o.current&&y()},onKeyDown:m=>{m.key==="Escape"&&y()},children:u.jsxs("div",{className:"flex flex-col max-h-[80vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s("modal.addSongTitle")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("modal.addSongDescription")})]}),u.jsx("button",{type:"button",onClick:y,disabled:l.isPending,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:l.isPending?u.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("modal.adding")})]}):u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:()=>f(!0),className:"w-full flex items-center justify-center gap-2 px-4 py-3 mb-4 text-white bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 rounded-lg transition-colors font-medium",children:[u.jsx(Xt,{size:20}),s("modal.createNew")]}),u.jsx(Qv,{onScheduleClick:p})]})})]})}),u.jsx(FV,{isOpen:d,onClose:()=>f(!1),onCreated:g})]})}function $V({onAddSong:t,onAddBibleVerse:e,onAddBiblePassage:n,onAddSlide:r}){const{t:s}=ke("queue"),[i,o]=C.useState(!1),l=C.useRef(null);C.useEffect(()=>{i?l.current?.showModal():l.current?.close()},[i]);const d=p=>{o(!1),p()},f=()=>{o(!1)};return u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:()=>o(!0),className:"flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-white bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 rounded-md transition-colors",children:[u.jsx(Xt,{size:14}),s("addToQueue.button")]}),u.jsx("dialog",{ref:l,onCancel:f,onClick:p=>{p.target===l.current&&f()},className:"fixed inset-0 m-auto w-full max-w-sm p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s("addToQueue.title")}),u.jsx("button",{type:"button",onClick:f,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"p-4 space-y-2",children:[u.jsxs("button",{type:"button",onClick:()=>d(t),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center",children:u.jsx(ha,{size:20,className:"text-indigo-600 dark:text-indigo-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:s("addToQueue.searchSong")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("addToQueue.searchSongDescription")})]})]}),e&&u.jsxs("button",{type:"button",onClick:()=>d(e),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:u.jsx(wr,{size:20,className:"text-blue-600 dark:text-blue-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:s("addToQueue.bibleVerse")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("addToQueue.bibleVerseDescription")})]})]}),n&&u.jsxs("button",{type:"button",onClick:()=>d(n),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-teal-100 dark:bg-teal-900/30 flex items-center justify-center",children:u.jsx(Ap,{size:20,className:"text-teal-600 dark:text-teal-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:s("addToQueue.biblePassage")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("addToQueue.biblePassageDescription")})]})]}),u.jsxs("button",{type:"button",onClick:()=>d(()=>r("announcement")),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center",children:u.jsx(lo,{size:20,className:"text-orange-600 dark:text-orange-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:s("addToQueue.announcement")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("addToQueue.announcementDescription")})]})]}),u.jsxs("button",{type:"button",onClick:()=>d(()=>r("versete_tineri")),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:u.jsx(ds,{size:20,className:"text-green-600 dark:text-green-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:s("addToQueue.verseteTineri")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("addToQueue.verseteTineriDescription")})]})]})]})]})})]})}const qV=[{type:"announcement",icon:lo},{type:"versete_tineri",icon:ds}];function nb({isOpen:t,onClose:e,scheduleId:n,afterItemId:r,editingItem:s,initialTemplate:i,onSaved:o}){const{t:l}=ke("queue"),{showToast:d}=mt(),f=C.useRef(null),p=og(),g=BV(),y=!!s,[m,b]=C.useState("announcement"),[v,w]=C.useState(""),S=Dv({extensions:[Kv.configure({heading:{levels:[1,2]}}),_v.configure({types:["heading","paragraph"]})],content:"",onUpdate:({editor:R})=>{w(R.getHTML())},editorProps:{attributes:{class:"min-h-[150px] p-4 focus:outline-none bg-white dark:bg-gray-900 prose prose-sm dark:prose-invert max-w-none",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}}});C.useEffect(()=>{t?(f.current?.showModal(),s?(b(s.slideType??"announcement"),w(s.slideContent??""),S?.commands.setContent(s.slideContent??"")):(b(i??"announcement"),w(""),S?.commands.setContent(""))):f.current?.close()},[t,S,s,i]);const T=async()=>{if(!v.trim()){d(l("insertSlide.errorEmpty"),"error");return}y&&s?(await g.mutateAsync({scheduleId:n,itemId:s.id,input:{slideType:m,slideContent:v}})).success?(d(l("messages.slideUpdated"),"success"),o?.(),e()):d(l("messages.error"),"error"):(await p.mutateAsync({scheduleId:n,input:{slideType:m,slideContent:v,afterItemId:r}})).success?(d(l("messages.slideInserted"),"success"),o?.(),e()):d(l("messages.error"),"error")},j=()=>{!p.isPending&&!g.isPending&&e()},M=p.isPending||g.isPending,_=R=>{R.target===f.current&&j()};return u.jsx("dialog",{ref:f,onCancel:j,onClick:_,className:"fixed inset-0 m-auto w-full max-w-xl p-0 rounded-lg bg-white dark:bg-gray-800 backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col max-h-[80vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:l(y?"insertSlide.editTitle":"insertSlide.title")}),u.jsx("button",{type:"button",onClick:j,disabled:M,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[(y||!i)&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:l("insertSlide.selectTemplate")}),u.jsx("div",{className:"flex gap-2",children:qV.map(({type:R,icon:O})=>u.jsxs("button",{type:"button",onClick:()=>b(R),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg border transition-colors ${m===R?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300":"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[u.jsx(O,{size:18}),u.jsx("span",{className:"text-sm font-medium",children:l(`slideTemplates.${R}`)})]},R))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:l("insertSlide.content")}),u.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 dark:bg-gray-900 rounded-t-lg border border-b-0 border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:()=>S?.chain().focus().toggleBold().run(),className:`px-2 py-1 rounded text-sm font-bold ${S?.isActive("bold")?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"B"}),u.jsx("button",{type:"button",onClick:()=>S?.chain().focus().toggleItalic().run(),className:`px-2 py-1 rounded text-sm italic ${S?.isActive("italic")?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"I"}),u.jsx("div",{className:"w-px h-5 bg-gray-300 dark:bg-gray-600 mx-1"}),u.jsx("button",{type:"button",onClick:()=>S?.chain().focus().toggleHeading({level:1}).run(),className:`px-2 py-1 rounded text-sm ${S?.isActive("heading",{level:1})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"H1"}),u.jsx("button",{type:"button",onClick:()=>S?.chain().focus().toggleHeading({level:2}).run(),className:`px-2 py-1 rounded text-sm ${S?.isActive("heading",{level:2})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"H2"})]}),u.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-b-lg overflow-hidden",children:u.jsx(Ov,{editor:S})})]})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsxs("button",{type:"button",onClick:j,disabled:M,className:"flex items-center gap-2 px-4 py-2 text-white bg-gray-600 hover:bg-gray-700 dark:bg-gray-500 dark:hover:bg-gray-600 rounded-lg disabled:opacity-50 transition-colors",children:[u.jsx(nt,{size:16}),l("actions.cancel")]}),u.jsxs("button",{type:"button",onClick:T,disabled:M||!v.trim(),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors",children:[M?u.jsx(Qe,{size:16,className:"animate-spin"}):y?u.jsx(rd,{size:16}):u.jsx(Xt,{size:16}),l(y?"insertSlide.save":"insertSlide.insert")]})]})]})})}function HV({item:t,onRemove:e,onEditSlide:n,onInsertSongAfter:r,onInsertSlideAfter:s,dragHandleProps:i}){const{t:o}=ke("queue"),[l,d]=C.useState(!1),f=C.useRef(null),p=t.slideType==="announcement",g=p?lo:ds,y=p?"bg-orange-100 dark:bg-orange-900/30":"bg-green-100 dark:bg-green-900/30",m=p?"text-orange-600 dark:text-orange-400":"text-green-600 dark:text-green-400",b=t.slideContent?.replace(/<[^>]*>/g,"").substring(0,100);return u.jsx("div",{className:"rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:u.jsxs("div",{className:"flex items-center gap-2 p-3",children:[u.jsx("div",{...i,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(or,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsxs("button",{type:"button",onClick:n,className:"flex items-center gap-3 flex-1 min-w-0 text-left",children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${y}`,children:u.jsx(g,{size:16,className:m})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-white",children:o(`slideTemplates.${t.slideType}`)}),b&&u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:b})]})]}),u.jsxs("div",{className:"relative",ref:f,children:[u.jsx("button",{type:"button",onClick:()=>d(!l),className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(Op,{size:16,className:"text-gray-500"})}),l&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>d(!1)}),u.jsxs("div",{className:"absolute right-0 top-full mt-1 z-20 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg py-1",children:[u.jsxs("button",{type:"button",onClick:()=>{d(!1),n()},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(Xa,{size:14}),o("actions.editSlide")]}),u.jsxs("button",{type:"button",onClick:()=>{d(!1),r()},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(Xt,{size:14}),o("actions.insertAfter")]}),u.jsx("hr",{className:"my-1 border-gray-200 dark:border-gray-700"}),u.jsxs("button",{type:"button",onClick:()=>{d(!1),e()},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:[u.jsx(Bn,{size:14}),o("actions.remove")]})]})]})]})]})})}function VV({item:t,onRemove:e,onEditSong:n,onInsertSongAfter:r,onInsertSlideAfter:s,dragHandleProps:i}){const{t:o}=ke("queue"),[l,d]=C.useState(!0),[f,p]=C.useState(!1),g=C.useRef(null);return u.jsxs("div",{className:"rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 p-3",children:[u.jsx("div",{...i,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(or,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsx("button",{type:"button",onClick:()=>d(!l),className:"flex-shrink-0 p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",title:o(l?"actions.collapse":"actions.expand"),children:l?u.jsx(Es,{size:16,className:"text-gray-500"}):u.jsx(Ms,{size:16,className:"text-gray-500"})}),u.jsxs("button",{type:"button",onClick:n,className:"flex items-center gap-3 flex-1 min-w-0 text-left",children:[u.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 flex items-center justify-center",children:u.jsx(ha,{size:16})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"font-medium text-sm truncate text-gray-900 dark:text-white",children:t.song?.title}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t.slides.length," slides",t.song?.categoryName&&`  ${t.song.categoryName}`]})]})]}),u.jsxs("div",{className:"relative",ref:g,children:[u.jsx("button",{type:"button",onClick:()=>p(!f),className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(Op,{size:16,className:"text-gray-500"})}),f&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>p(!1)}),u.jsxs("div",{className:"absolute right-0 top-full mt-1 z-20 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg py-1",children:[u.jsxs("button",{type:"button",onClick:()=>{p(!1),n()},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(Xa,{size:14}),o("actions.editSong")]}),u.jsxs("button",{type:"button",onClick:()=>{p(!1),r()},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(Xt,{size:14}),o("actions.insertAfter")]}),u.jsx("hr",{className:"my-1 border-gray-200 dark:border-gray-700"}),u.jsxs("button",{type:"button",onClick:()=>{p(!1),e()},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:[u.jsx(Bn,{size:14}),o("actions.remove")]})]})]})]})]}),l&&t.slides.length>0&&u.jsx("div",{className:"px-3 pb-3 space-y-1.5",children:t.slides.map((y,m)=>u.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 dark:bg-gray-900/50 rounded-lg text-sm",children:[u.jsx("span",{className:"flex-shrink-0 w-5 h-5 rounded bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 text-xs flex items-center justify-center",children:m+1}),u.jsxs("span",{className:"text-gray-600 dark:text-gray-400 line-clamp-1",children:[y.content.replace(/<[^>]*>/g,"").substring(0,60),y.content.length>60?"...":""]})]},y.id))})]})}function KV({scheduleId:t,item:e,onEditSong:n,onEditSlide:r,onInsertSongAfter:s,onInsertSlideAfter:i,onRemoveItem:o}){const{showToast:l}=mt(),{t:d}=ke("schedules"),f=eA(),{attributes:p,listeners:g,setNodeRef:y,transform:m,transition:b}=xo({id:e.id}),v={transform:cs.Transform.toString(m),transition:b},w=async()=>{o?o(e.id):await f.mutateAsync({scheduleId:t,itemId:e.id})&&l(d("messages.itemRemoved"),"success")};return e.itemType==="slide"?u.jsx("div",{ref:y,style:v,children:u.jsx(HV,{item:e,onRemove:w,onEditSlide:()=>r(e),onInsertSongAfter:()=>s(e.id),onInsertSlideAfter:S=>i(e.id,S),dragHandleProps:{...p,...g}})}):u.jsx("div",{ref:y,style:v,children:u.jsx(VV,{item:e,onRemove:w,onEditSong:()=>e.songId&&n(e.songId),onInsertSongAfter:()=>s(e.id),onInsertSlideAfter:S=>i(e.id,S),dragHandleProps:{...p,...g}})})}function QV({scheduleId:t,items:e,isLoading:n,onReorder:r,onRemoveItem:s}){const{t:i}=ke("schedules"),{showToast:o}=mt(),l=tA(),d=og(),[f,p]=C.useState(null),[g,y]=C.useState(null),[m,b]=C.useState(null),[v,w]=C.useState(null),[S,T]=C.useState("announcement"),j=ho(sr(pi),sr(hi,{coordinateGetter:bo})),M=R=>{const{active:O,over:L}=R;if(L&&O.id!==L.id&&e){const A=e.findIndex(H=>H.id===O.id),F=e.findIndex(H=>H.id===L.id);if(A!==-1&&F!==-1)if(r)r(A,F);else{const H=[...e],[P]=H.splice(A,1);H.splice(F,0,P),l.mutate({scheduleId:t,input:{itemIds:H.map(B=>B.id)}})}}},_=async R=>{(await d.mutateAsync({scheduleId:t,input:{songId:R,afterItemId:v??void 0}})).success&&o(i("messages.itemAdded"),"success"),w(null)};return n?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"})}):!e||e.length===0?u.jsxs("div",{className:"text-center py-8 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx(Ij,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:i("editor.noItems")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:i("editor.addFirstItem")})]}):u.jsxs(u.Fragment,{children:[u.jsx(go,{sensors:j,collisionDetection:po,onDragEnd:M,children:u.jsx(yo,{items:e.map(R=>R.id),strategy:mo,children:u.jsx("div",{className:"space-y-2",children:e.map(R=>u.jsx(KV,{scheduleId:t,item:R,onEditSong:p,onEditSlide:y,onInsertSongAfter:w,onInsertSlideAfter:(O,L)=>{b(O),T(L)},onRemoveItem:s},R.id))})})}),f!==null&&u.jsx(dA,{isOpen:f!==null,songId:f,onClose:()=>p(null),onSaved:()=>{}}),m!==null&&u.jsx(nb,{isOpen:m!==null,afterItemId:m,initialTemplate:S,scheduleId:t,onClose:()=>b(null),onSaved:()=>{}}),u.jsx(lg,{isOpen:v!==null,onClose:()=>w(null),onSongSelect:_,hideAddToQueue:!0}),g!==null&&u.jsx(nb,{isOpen:g!==null,editingItem:{id:g.id,slideType:g.slideType,slideContent:g.slideContent},scheduleId:t,onClose:()=>y(null),onSaved:()=>{}})]})}function WV({scheduleId:t,onBack:e,onDeleted:n,onScheduleCreated:r}){const{t:s}=ke("schedules"),{showToast:i}=mt(),o=ar(),{data:l,isLoading:d}=LV(t??void 0),f=nA(),p=IV(),g=og(),y=Z5(),m=tA(),b=eA(),[v,w]=C.useState(""),[S,T]=C.useState(""),[j,M]=C.useState([]),[_,R]=C.useState(!1),[O,L]=C.useState(!1),[A,F]=C.useState("announcement"),[H,P]=C.useState(!1),[B,E]=C.useState(null),K=t??B,q=C.useRef(null),V=C.useRef(null);C.useEffect(()=>{l?(w(l.title),T(l.description??""),M(l.items??[])):t===null&&(w(""),T(""),M([]),V.current?.focus())},[l,t]),C.useEffect(()=>{H?q.current?.showModal():q.current?.close()},[H]);const ie=me=>{w(me)},Y=me=>{T(me)},X=C.useCallback(async(me,Se)=>{if(!me.trim())return null;const Oe=await f.mutateAsync({id:K??void 0,title:me.trim(),description:Se.trim()||null});if(Oe.success&&Oe.data){const He=Oe.data.id;return t===null&&He&&(E(He),r?.(He)),He}return null},[K,t,f,r]);C.useEffect(()=>{if(!v.trim())return;const me=setTimeout(()=>{X(v,S)},500);return()=>clearTimeout(me)},[v,S,X]);const I=async()=>{if(!K)return;(await p.mutateAsync(K)).success?(i(s("messages.deleted"),"success"),P(!1),n?.(),e()):i(s("messages.error"),"error")},U=async()=>K!==null?K:await X(v,S),te=async()=>{await U()!==null&&R(!0)},Z=async me=>{await U()!==null&&(F(me),L(!0))},re=async me=>{const Se=K;if(!Se)return;(await g.mutateAsync({scheduleId:Se,input:{songId:me}})).success&&i(s("messages.itemAdded"),"success")},se=async(me,Se)=>{if(!K)return;const Oe=[...j],[He]=Oe.splice(me,1);Oe.splice(Se,0,He),M(Oe),await m.mutateAsync({scheduleId:K,input:{itemIds:Oe.map(ut=>ut.id)}})},ge=async me=>{K&&(M(Se=>Se.filter(Oe=>Oe.id!==me)),await b.mutateAsync({scheduleId:K,itemId:me}))},be=async()=>{if(!K)return;await y.mutateAsync(K)?(i(s("messages.importedToQueue"),"success"),o({to:"/present"})):i(s("messages.error"),"error")};return d&&t!==null?u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600"})}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("button",{type:"button",onClick:e,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 dark:bg-gray-500 dark:hover:bg-gray-600 rounded-lg transition-colors",children:[u.jsx(ed,{size:16}),s("actions.back")]}),u.jsx("div",{className:"flex items-center gap-2",children:K!==null&&u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:be,disabled:y.isPending,className:"flex items-center gap-2 px-3 py-1.5 text-sm text-white bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 rounded-lg transition-colors disabled:opacity-50",children:[y.isPending?u.jsx(Qe,{size:16,className:"animate-spin"}):u.jsx(cI,{size:16}),s("actions.importToQueue")]}),u.jsx("button",{type:"button",onClick:()=>P(!0),className:"p-2 text-white bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 rounded-lg transition-colors",children:u.jsx(Bn,{size:16})})]})})]}),u.jsxs("div",{className:"space-y-3 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsx("input",{ref:V,type:"text",value:v,onChange:me=>ie(me.target.value),placeholder:s("editor.titlePlaceholder"),className:"w-full px-0 py-1 text-xl font-semibold bg-transparent border-0 border-b-2 border-transparent focus:border-indigo-500 focus:ring-0 text-gray-900 dark:text-white placeholder-gray-400 transition-colors"}),u.jsx("textarea",{value:S,onChange:me=>Y(me.target.value),placeholder:s("editor.descriptionPlaceholder"),rows:2,className:"w-full px-0 py-1 bg-transparent border-0 resize-none focus:ring-0 text-gray-600 dark:text-gray-400 placeholder-gray-400"})]}),u.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:s("editor.items")}),u.jsx($V,{onAddSong:te,onAddSlide:Z})]}),K!==null?u.jsx(QV,{scheduleId:K,items:j,isLoading:d,onReorder:se,onRemoveItem:ge}):u.jsxs("div",{className:"text-center py-8 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:s("editor.noItems")}),u.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:s("editor.addFirstItem")})]})]}),u.jsx(lg,{isOpen:_,onClose:()=>R(!1),onSongSelect:re,hideAddToQueue:!0}),K!==null&&u.jsx(nb,{isOpen:O,onClose:()=>L(!1),scheduleId:K,initialTemplate:A}),u.jsx("dialog",{ref:q,onCancel:()=>P(!1),onClick:me=>{me.target===q.current&&P(!1)},className:"fixed inset-0 m-auto w-full max-w-sm p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",children:u.jsxs("div",{className:"p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:s("modal.deleteTitle")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:s("modal.deleteMessage")}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsxs("button",{type:"button",onClick:()=>P(!1),className:"flex items-center gap-2 px-4 py-2 text-white bg-gray-600 hover:bg-gray-700 dark:bg-gray-500 dark:hover:bg-gray-600 rounded-lg transition-colors",children:[u.jsx(nt,{size:16}),s("actions.cancel",{ns:"common"})]}),u.jsxs("button",{type:"button",onClick:I,disabled:p.isPending,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors",children:[p.isPending?u.jsx(Qe,{size:16,className:"animate-spin"}):u.jsx(Bn,{size:16}),s("actions.delete")]})]})]})})]})}function YV({isOpen:t,onClose:e,onImported:n}){const{t:r}=ke(["schedules","queue"]),{showToast:s}=mt(),i=C.useRef(null),o=Z5();C.useEffect(()=>{t?i.current?.showModal():i.current?.close()},[t]),C.useEffect(()=>{const f=i.current;if(!f)return;const p=g=>{g.preventDefault(),o.isPending||e()};return f.addEventListener("cancel",p),()=>f.removeEventListener("cancel",p)},[e,o.isPending]);const l=async f=>{await o.mutateAsync(f)?(s(r("schedules:messages.importedToQueue"),"success"),n?.(),e()):s(r("schedules:messages.error"),"error")},d=()=>{o.isPending||e()};return u.jsx("dialog",{ref:i,className:"fixed inset-0 m-auto w-full max-w-lg p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:f=>{f.target===i.current&&d()},onKeyDown:f=>{f.key==="Escape"&&d()},children:u.jsxs("div",{className:"flex flex-col max-h-[80vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r("queue:importSchedule.title")}),u.jsx("button",{type:"button",onClick:d,disabled:o.isPending,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o.isPending?u.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:r("queue:importSchedule.importing")})]}):u.jsx(Qv,{onScheduleClick:l})})]})})}const GV={announcement:lo,versete_tineri:ds};function XV(t){return new DOMParser().parseFromString(t,"text/html").body.textContent||""}function JV({item:t,isActive:e,onRemove:n,onClick:r,onEditSlide:s,onInsertSongAfter:i,onInsertBibleVerseAfter:o,onInsertBiblePassageAfter:l,onInsertSlideAfter:d,dragHandleProps:f}){const{t:p}=ke("queue"),g=C.useRef(null),y=t.slideType?GV[t.slideType]:ds,m=t.slideContent?XV(t.slideContent):"",b=v=>{v.preventDefault(),g.current?.openMenu()};return u.jsx("div",{className:`rounded-lg border transition-all ${e?"border-indigo-400 bg-indigo-50/50 dark:bg-indigo-900/10":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"}`,children:u.jsxs("div",{className:"flex items-center gap-2 p-3",onContextMenu:b,children:[u.jsx("div",{...f,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(or,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsxs("button",{type:"button",onClick:r,className:"flex-1 flex items-center gap-3 min-w-0 text-left",children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${e?"bg-indigo-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:u.jsx(y,{size:16})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:`font-medium text-sm ${e?"text-indigo-900 dark:text-indigo-100":"text-gray-900 dark:text-white"}`,children:t.slideType&&p(`slideTemplates.${t.slideType}`)}),m&&u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:m})]})]}),u.jsx(dd,{ref:g,onEditSlide:s,onInsertSongAfter:i,onInsertBibleVerseAfter:o,onInsertBiblePassageAfter:l,onInsertSlideAfter:d,onRemove:n})]})})}function ZV({slide:t,slideIndex:e,isActive:n,onClick:r}){const s=C.useRef(null);Yb(s,n);const i=t.content.replace(/<[^>]*>/g," ").replace(/\s+/g," ").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&#(\d+);/g,(o,l)=>String.fromCharCode(l)).replace(/&#x([0-9a-fA-F]+);/g,(o,l)=>String.fromCharCode(parseInt(l,16))).trim()||"Empty slide";return u.jsx("button",{ref:s,type:"button",onClick:r,className:`w-full text-left p-2 pl-10 rounded-lg border transition-all ${n?"border-indigo-600 bg-indigo-50 dark:bg-indigo-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 bg-white dark:bg-gray-800"}`,children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium ${n?"bg-indigo-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:e+1}),u.jsx("div",{className:`flex-1 min-w-0 text-sm line-clamp-1 ${n?"text-indigo-900 dark:text-indigo-100":"text-gray-700 dark:text-gray-300"}`,children:i})]})})}function eK({item:t,isExpanded:e,activeSlideId:n,activeQueueItemId:r,onToggleExpand:s,onRemove:i,onSlideClick:o,onSongClick:l,onEditSong:d,onAddToSchedule:f,onInsertSongAfter:p,onInsertBibleVerseAfter:g,onInsertBiblePassageAfter:y,onInsertSlideAfter:m,dragHandleProps:b}){const{t:v}=ke("queue"),w=C.useRef(null),S=t.id===r,T=S&&t.slides.some(M=>M.id===n),j=M=>{M.preventDefault(),w.current?.openMenu()};return u.jsxs("div",{className:`rounded-lg border transition-all ${T?"border-indigo-400 bg-indigo-50/50 dark:bg-indigo-900/10":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"}`,children:[u.jsxs("div",{className:"flex items-center gap-2 p-3",onContextMenu:j,children:[u.jsx("div",{...b,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(or,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsx("button",{type:"button",onClick:s,className:"flex-shrink-0 p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",title:v(e?"actions.collapse":"actions.expand"),children:e?u.jsx(Es,{size:16,className:"text-gray-500"}):u.jsx(Ms,{size:16,className:"text-gray-500"})}),u.jsxs("button",{type:"button",onClick:l,className:"flex items-center gap-3 flex-1 min-w-0 text-left",children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${T?"bg-indigo-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:u.jsx(ha,{size:16})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:`font-medium text-sm truncate ${T?"text-indigo-900 dark:text-indigo-100":"text-gray-900 dark:text-white"}`,children:t.song?.title}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t.slides.length," slides",t.song?.categoryName&&`  ${t.song.categoryName}`]})]})]}),u.jsx(dd,{ref:w,onEditSong:d,onAddToSchedule:f,onInsertSongAfter:p,onInsertBibleVerseAfter:g,onInsertBiblePassageAfter:y,onInsertSlideAfter:m,onRemove:i})]}),e&&t.slides.length>0&&u.jsx("div",{className:"px-3 pb-3 space-y-1.5",children:t.slides.map((M,_)=>u.jsx(ZV,{slide:M,slideIndex:_,isActive:S&&M.id===n,onClick:()=>o(M.id)},M.id))})]})}function tK({entry:t,entryIndex:e,isActive:n,onClick:r}){const s=C.useRef(null);Yb(s,n);const i=t.text.length>80?`${t.text.slice(0,80)}...`:t.text;return u.jsx("button",{ref:s,type:"button",onClick:r,className:`w-full text-left p-2 pl-10 rounded-lg border transition-all ${n?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 bg-white dark:bg-gray-800"}`,children:u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium ${n?"bg-purple-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:e+1}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:`text-xs font-medium mb-0.5 ${n?"text-purple-700 dark:text-purple-300":"text-gray-500 dark:text-gray-400"}`,children:t.reference}),u.jsx("div",{className:`text-sm line-clamp-2 ${n?"text-purple-900 dark:text-purple-100":"text-gray-700 dark:text-gray-300"}`,children:i}),u.jsx("div",{className:`text-xs mt-1 italic ${n?"text-purple-600 dark:text-purple-400":"text-gray-400 dark:text-gray-500"}`,children:t.personName})]})]})})}function nK({item:t,isExpanded:e,activeEntryId:n,activeQueueItemId:r,onToggleExpand:s,onRemove:i,onEntryClick:o,onItemClick:l,onInsertSongAfter:d,onInsertBibleVerseAfter:f,onInsertBiblePassageAfter:p,onInsertSlideAfter:g,dragHandleProps:y}){const{t:m}=ke("queue"),b=C.useRef(null),v=t.id===r,w=v&&t.verseteTineriEntries.some(T=>T.id===n),S=T=>{T.preventDefault(),b.current?.openMenu()};return u.jsxs("div",{className:`rounded-lg border transition-all ${w?"border-purple-400 bg-purple-50/50 dark:bg-purple-900/10":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"}`,children:[u.jsxs("div",{className:"flex items-center gap-2 p-3",onContextMenu:S,children:[u.jsx("div",{...y,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(or,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsx("button",{type:"button",onClick:s,className:"flex-shrink-0 p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",title:m(e?"actions.collapse":"actions.expand"),children:e?u.jsx(Es,{size:16,className:"text-gray-500"}):u.jsx(Ms,{size:16,className:"text-gray-500"})}),u.jsxs("button",{type:"button",onClick:l,className:"flex items-center gap-3 flex-1 min-w-0 text-left",children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${w?"bg-purple-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:u.jsx(Bl,{size:16})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("span",{className:`font-medium text-sm truncate ${w?"text-purple-900 dark:text-purple-100":"text-gray-900 dark:text-white"}`,children:m("slideTemplates.versete_tineri")})}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:m("verseteTineri.entriesCount",{count:t.verseteTineriEntries.length})})]})]}),u.jsx(dd,{ref:b,onInsertSongAfter:d,onInsertBibleVerseAfter:f,onInsertBiblePassageAfter:p,onInsertSlideAfter:g,onRemove:i})]}),e&&t.verseteTineriEntries.length>0&&u.jsx("div",{className:"px-3 pb-3 space-y-1.5",children:t.verseteTineriEntries.map((T,j)=>u.jsx(tK,{entry:T,entryIndex:j,isActive:v&&T.id===n,onClick:()=>o(T.id)},T.id))})]})}function rK({item:t,activeSlideId:e,activeVerseId:n,activeEntryId:r,activeQueueItemId:s,onSlideClick:i,onVerseClick:o,onEntryClick:l,onSongClick:d,onPassageClick:f,onVerseteTineriClick:p,onEditSong:g,onEditSlide:y,onAddToSchedule:m,onInsertSongAfter:b,onInsertBibleVerseAfter:v,onInsertBiblePassageAfter:w,onInsertSlideAfter:S,onStandaloneSlideClick:T}){const{showToast:j}=mt(),{t:M}=ke("queue"),_=T8(),R=JE(),{attributes:O,listeners:L,setNodeRef:A,transform:F,transition:H}=xo({id:t.id}),P={transform:cs.Transform.toString(F),transition:H},B=()=>{R.mutate({id:t.id,expanded:!t.isExpanded})},E=async()=>{await _.mutateAsync(t.id)&&j(M("messages.removed"),"success")};if(t.itemType==="slide"&&t.slideType==="versete_tineri")return u.jsx("div",{ref:A,style:P,children:u.jsx(nK,{item:t,isExpanded:t.isExpanded,activeEntryId:r,activeQueueItemId:s,onToggleExpand:B,onRemove:E,onEntryClick:l,onItemClick:p,onInsertSongAfter:()=>b(t.id),onInsertBibleVerseAfter:v?()=>v(t.id):void 0,onInsertBiblePassageAfter:w?()=>w(t.id):void 0,onInsertSlideAfter:K=>S(t.id,K),dragHandleProps:{...O,...L}})});if(t.itemType==="slide"){const K=t.id===s&&e===null;return u.jsx("div",{ref:A,style:P,children:u.jsx(JV,{item:t,isActive:K,onRemove:E,onClick:T,onEditSlide:()=>y(t),onInsertSongAfter:()=>b(t.id),onInsertBibleVerseAfter:v?()=>v(t.id):void 0,onInsertBiblePassageAfter:w?()=>w(t.id):void 0,onInsertSlideAfter:q=>S(t.id,q),dragHandleProps:{...O,...L}})})}if(t.itemType==="bible"){const K=t.id===s&&e===null;return u.jsx("div",{ref:A,style:P,children:u.jsx(SV,{item:t,isActive:K,onRemove:E,onClick:T,onInsertSongAfter:()=>b(t.id),onInsertBibleVerseAfter:v?()=>v(t.id):void 0,onInsertBiblePassageAfter:w?()=>w(t.id):void 0,onInsertSlideAfter:q=>S(t.id,q),dragHandleProps:{...O,...L}})})}return t.itemType==="bible_passage"?u.jsx("div",{ref:A,style:P,children:u.jsx(CV,{item:t,isExpanded:t.isExpanded,activeVerseId:n,activeQueueItemId:s,onToggleExpand:B,onRemove:E,onVerseClick:o,onPassageClick:f,onInsertSongAfter:()=>b(t.id),onInsertBibleVerseAfter:v?()=>v(t.id):void 0,onInsertBiblePassageAfter:w?()=>w(t.id):void 0,onInsertSlideAfter:K=>S(t.id,K),dragHandleProps:{...O,...L}})}):u.jsx("div",{ref:A,style:P,children:u.jsx(eK,{item:t,isExpanded:t.isExpanded,activeSlideId:e,activeQueueItemId:s,onToggleExpand:B,onRemove:E,onSlideClick:i,onSongClick:d,onEditSong:()=>t.songId&&g(t.songId),onAddToSchedule:t.songId?()=>m(t.songId):void 0,onInsertSongAfter:()=>b(t.id),onInsertBibleVerseAfter:v?()=>v(t.id):void 0,onInsertBiblePassageAfter:w?()=>w(t.id):void 0,onInsertSlideAfter:K=>S(t.id,K),dragHandleProps:{...O,...L}})})}function sK({activeSlideId:t,activeVerseId:e,activeEntryId:n,activeQueueItemId:r,onSlideClick:s,onVerseClick:i,onEntryClick:o,hideHeader:l=!1}){const{t:d}=ke("queue"),{showToast:f}=mt(),{data:p,isLoading:g}=Up(),y=j8(),m=XE(),b=JE(),[v,w]=C.useState(!1),[S,T]=C.useState(null),[j,M]=C.useState(null),[_,R]=C.useState(null),[O,L]=C.useState(null),[A,F]=C.useState(null),[H,P]=C.useState("announcement"),[B,E]=C.useState(null);C.useEffect(()=>{if(t&&p){const se=p.find(ge=>ge.itemType==="song"&&ge.slides.some(be=>be.id===t));se&&!se.isExpanded&&b.mutate({id:se.id,expanded:!0})}},[t,p,b]);const K=ho(sr(pi),sr(hi,{coordinateGetter:bo})),q=se=>{const{active:ge,over:be}=se;if(be&&ge.id!==be.id&&p){const me=p.findIndex(Oe=>Oe.id===ge.id),Se=p.findIndex(Oe=>Oe.id===be.id);if(me!==-1&&Se!==-1){const Oe=[...p],[He]=Oe.splice(me,1);Oe.splice(Se,0,He),y.mutate({itemIds:Oe.map(ut=>ut.id)})}}},V=(se,ge)=>{const be=p?.find(me=>me.id===se);be&&!be.isExpanded&&b.mutate({id:se,expanded:!0}),s(se,ge)},ie=se=>{s(se,-1)},Y=se=>{se.isExpanded||b.mutate({id:se.id,expanded:!0}),se.slides.length>0&&s(se.id,se.slides[0].id)},X=(se,ge)=>{const be=p?.find(me=>me.id===se);be&&!be.isExpanded&&b.mutate({id:se,expanded:!0}),i(se,ge)},I=se=>{se.isExpanded||b.mutate({id:se.id,expanded:!0}),se.biblePassageVerses&&se.biblePassageVerses.length>0&&i(se.id,se.biblePassageVerses[0].id)},U=(se,ge)=>{const be=p?.find(me=>me.id===se);be&&!be.isExpanded&&b.mutate({id:se,expanded:!0}),o(se,ge)},te=se=>{se.isExpanded||b.mutate({id:se.id,expanded:!0}),se.verseteTineriEntries&&se.verseteTineriEntries.length>0&&o(se.id,se.verseteTineriEntries[0].id)},Z=async()=>{w(!1),await m.mutateAsync()&&f(d("messages.cleared"),"success")};if(g)return u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"})});if(!p||p.length===0)return u.jsxs("div",{className:"text-center py-8",children:[u.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:d("empty")}),u.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:d("emptyDescription")})]});const re=p.length;return u.jsxs(u.Fragment,{children:[!l&&u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:d("itemCount",{count:re})}),u.jsxs("button",{type:"button",onClick:()=>w(!0),className:"flex items-center gap-1.5 px-2 py-1 text-xs text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",children:[u.jsx(Bn,{size:14}),d("actions.clear")]})]}),u.jsx(go,{sensors:K,collisionDetection:po,onDragEnd:q,children:u.jsx(yo,{items:p.map(se=>se.id),strategy:mo,children:u.jsx("div",{className:"space-y-2",children:p.map(se=>u.jsx(rK,{item:se,activeSlideId:t,activeVerseId:e,activeEntryId:n,activeQueueItemId:r,onSlideClick:ge=>V(se.id,ge),onVerseClick:ge=>X(se.id,ge),onEntryClick:ge=>U(se.id,ge),onSongClick:()=>Y(se),onPassageClick:()=>I(se),onVerseteTineriClick:()=>te(se),onEditSong:T,onEditSlide:M,onAddToSchedule:E,onInsertSongAfter:L,onInsertBiblePassageAfter:F,onInsertSlideAfter:(ge,be)=>{R(ge),P(be)},onStandaloneSlideClick:()=>ie(se.id)},se.id))})})}),u.jsx(di,{isOpen:v,title:d("confirmClear.title"),message:d("confirmClear.message"),confirmLabel:d("actions.clear"),onConfirm:Z,onCancel:()=>w(!1),variant:"danger"}),S!==null&&u.jsx(dA,{isOpen:S!==null,songId:S,onClose:()=>T(null),onSaved:()=>{}}),_!==null&&u.jsx(tb,{isOpen:_!==null,afterItemId:_,initialTemplate:H,onClose:()=>R(null),onSaved:()=>{}}),u.jsx(lg,{isOpen:O!==null,afterItemId:O??void 0,onClose:()=>L(null)}),u.jsx(e3,{isOpen:A!==null,afterItemId:A??void 0,onClose:()=>F(null)}),j!==null&&u.jsx(tb,{isOpen:j!==null,editingItem:j,onClose:()=>M(null),onSaved:()=>{}}),B!==null&&u.jsx(Wv,{isOpen:B!==null,songId:B,onClose:()=>E(null)})]})}function iK({isOpen:t,onClose:e,onSaved:n}){const{t:r}=ke("queue"),{showToast:s}=mt(),i=C.useRef(null),o=C.useRef(null),[l,d]=C.useState(""),f=E8();C.useEffect(()=>{t?(i.current?.showModal(),setTimeout(()=>o.current?.focus(),100)):(i.current?.close(),d(""))},[t]),C.useEffect(()=>{const y=i.current;if(!y)return;const m=b=>{b.preventDefault(),f.isPending||e()};return y.addEventListener("cancel",m),()=>y.removeEventListener("cancel",m)},[e,f.isPending]);const p=async y=>{if(y.preventDefault(),!l.trim())return;const m=await f.mutateAsync(l.trim());m.success&&m.data?(s(r("messages.savedAsProgram"),"success"),n?.(m.data.scheduleId),e()):s(r("messages.error"),"error")},g=()=>{f.isPending||e()};return u.jsx("dialog",{ref:i,className:"fixed inset-0 m-auto w-full max-w-sm p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:y=>{y.target===i.current&&g()},onKeyDown:y=>{y.key==="Escape"&&g()},children:u.jsxs("form",{onSubmit:p,className:"flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r("saveAsProgram.title")}),u.jsx("button",{type:"button",onClick:g,disabled:f.isPending,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"p-4",children:[u.jsx("label",{htmlFor:"program-title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("saveAsProgram.nameLabel")}),u.jsx("input",{ref:o,id:"program-title",type:"text",value:l,onChange:y=>d(y.target.value),disabled:f.isPending,placeholder:r("saveAsProgram.namePlaceholder"),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white disabled:opacity-50",autoComplete:"off"})]}),u.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:g,disabled:f.isPending,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50",children:r("saveAsProgram.cancel")}),u.jsxs("button",{type:"submit",disabled:!l.trim()||f.isPending,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors disabled:opacity-50",children:[f.isPending&&u.jsx(Qe,{size:16,className:"animate-spin"}),r("saveAsProgram.save")]})]})]})})}const aK={linear:"linear",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",bounce:"cubic-bezier(0.68, -0.55, 0.265, 1.55)"};function eh({children:t,animationIn:e,animationOut:n,isVisible:r,className:s="",style:i={}}){const[o,l]=C.useState(r),[d,f]=C.useState("idle");if(C.useEffect(()=>{if(r)l(!0),f("in");else if(o){f("out");const w=n?.duration||300;setTimeout(()=>{l(!1),f("idle")},w)}},[r,n?.duration,o]),!o)return null;const p=d==="in"?e:n,g=p?.type||"none",y=p?.duration||300,m=p?.delay||0,b=p?.easing||"easeOut",v=()=>{if(g==="none"||d==="idle")return{opacity:r?1:0};const w=aK[b]||"ease-out",S=`all ${y}ms ${w} ${m}ms`,T=d==="in",j={};switch(g){case"fade":j.opacity=T?1:0;break;case"slide-up":j.transform=T?"translateY(0)":"translateY(-20px)",j.opacity=T?1:0;break;case"slide-down":j.transform=T?"translateY(0)":"translateY(20px)",j.opacity=T?1:0;break;case"slide-left":j.transform=T?"translateX(0)":"translateX(-20px)",j.opacity=T?1:0;break;case"slide-right":j.transform=T?"translateX(0)":"translateX(20px)",j.opacity=T?1:0;break;case"zoom":j.transform=T?"scale(1)":"scale(0.8)",j.opacity=T?1:0;break;case"blur":j.filter=T?"blur(0)":"blur(10px)",j.opacity=T?1:0;break}return{transition:S,...j}};return u.jsx("div",{className:s,style:{...i,...v()},children:t})}const rA=20;function oK(t){const{measureElement:e,text:n,maxWidth:r,maxHeight:s,minFontSize:i,maxFontSize:o,lineHeight:l}=t,d=1,f=e.style.fontSize,p=e.style.whiteSpace,g=e.style.wordWrap,y=e.style.width,m=e.style.height,b=e.style.lineHeight,v=e.style.overflow,w=e.textContent;try{if(e.style.whiteSpace="pre-wrap",e.style.wordWrap="break-word",e.style.width=`${r}px`,e.style.height="auto",e.style.lineHeight=`${l}`,e.style.overflow="visible",e.textContent=n,e.style.fontSize=`${i}px`,e.scrollHeight>s)return{fontSize:i,fits:!1};if(e.style.fontSize=`${o}px`,e.scrollHeight<=s)return{fontSize:o,fits:!0};let S=i,T=o,j=0;for(;T-S>d&&j<rA;){j++;const M=Math.floor((S+T)/2);e.style.fontSize=`${M}px`,e.scrollHeight<=s?S=M:T=M}return{fontSize:S,fits:!0}}finally{e.style.fontSize=f,e.style.whiteSpace=p,e.style.wordWrap=g,e.style.width=y,e.style.height=m,e.style.lineHeight=b,e.style.overflow=v,e.textContent=w}}function lK(t){const{measureElement:e,text:n,maxWidth:r,minFontSize:s,maxFontSize:i,lineHeight:o}=t,l=1,d=n.split(`
`).filter(T=>T.trim()!=="");if(d.length===0)return{fontSize:i,fits:!0};const f=e.style.fontSize,p=e.style.whiteSpace,g=e.style.width,y=e.style.height,m=e.style.lineHeight,b=e.textContent,v=e.style.display,w=e.style.position,S=e.style.visibility;try{e.style.display="inline-block",e.style.position="absolute",e.style.visibility="hidden",e.style.whiteSpace="nowrap",e.style.width="auto",e.style.height="auto",e.style.lineHeight=`${o}`;let T=i;for(const j of d){if(e.textContent=j,e.style.fontSize=`${i}px`,e.scrollWidth<=r)continue;let _=s,R=i,O=0;for(;R-_>l&&O<rA;){O++;const L=Math.floor((_+R)/2);e.style.fontSize=`${L}px`,e.scrollWidth<=r?_=L:R=L}T=Math.min(T,_)}return{fontSize:Math.max(T,s),fits:!0}}finally{e.style.fontSize=f,e.style.whiteSpace=p,e.style.width=g,e.style.height=y,e.style.lineHeight=m,e.style.display=v,e.style.position=w,e.style.visibility=S,e.textContent=b}}function ss(t,e,n){return e==="%"?t/100*n:t}function cK(t,e){return e===0?0:t/e*100}function yy(t,e,n,r){return e===n?t:e==="%"?ss(t,"%",r):cK(t,r)}function gl(t){return Math.round(t*10)/10}function Ua(t){return{fontFamily:t.fontFamily,color:t.color,fontWeight:t.bold?"bold":"normal",fontStyle:t.italic?"italic":"normal",textDecoration:t.underline?"underline":"none",textAlign:t.alignment,lineHeight:t.lineHeight,textShadow:t.shadow?"2px 2px 4px rgba(0,0,0,0.5)":"none"}}function Gu(t){switch(t.type){case"transparent":return{backgroundColor:"transparent"};case"color":return{backgroundColor:t.color||"#000000",opacity:t.opacity??1};case"image":return{backgroundImage:t.imageUrl?`url(${t.imageUrl})`:"none",backgroundSize:"cover",backgroundPosition:"center",opacity:t.opacity??1};case"video":return{backgroundColor:"transparent"};default:return{backgroundColor:"#000000"}}}function uK(){return{top:{enabled:!0,value:0,unit:"%"},bottom:{enabled:!1,value:0,unit:"%"},left:{enabled:!0,value:0,unit:"%"},right:{enabled:!1,value:0,unit:"%"}}}function dK(){return{width:100,widthUnit:"%",height:100,heightUnit:"%"}}function Wr(t,e,n,r){const s=t??uK(),i=e??dK(),o=s.left.enabled?ss(s.left.value,s.left.unit,n):0,l=s.right.enabled?ss(s.right.value,s.right.unit,n):0;let d,f;s.left.enabled&&s.right.enabled?(d=o,f=n-o-l):s.left.enabled?(d=o,f=ss(i.width,i.widthUnit,n)):s.right.enabled?(f=ss(i.width,i.widthUnit,n),d=n-l-f):(d=0,f=ss(i.width,i.widthUnit,n));const p=s.top.enabled?ss(s.top.value,s.top.unit,r):0,g=s.bottom.enabled?ss(s.bottom.value,s.bottom.unit,r):0;let y,m;return s.top.enabled&&s.bottom.enabled?(y=p,m=r-p-g):s.top.enabled?(y=p,m=ss(i.height,i.heightUnit,r)):s.bottom.enabled?(m=ss(i.height,i.heightUnit,r),y=r-g-m):(y=0,m=ss(i.height,i.heightUnit,r)),{x:d,y,width:f,height:m}}const JN={space:"  ",dash:"  ",pipe:" | "};function fK(t){return JN[t]??JN.space}function sA(t,e){const n=t.split(`
`).filter(i=>i.trim()!=="");if(n.length<=1)return t.trim();const r=fK(e),s=[];for(let i=0;i<n.length;i+=2){const o=n[i].trim(),l=n[i+1]?.trim();l?s.push(`${o}${r}${l}`):s.push(o)}return s.join(`
`)}function lu(t){return t.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&nbsp;/g," ").replace(/&#(\d+);/g,(e,n)=>String.fromCharCode(Number(n))).replace(/&#x([0-9a-fA-F]+);/g,(e,n)=>String.fromCharCode(parseInt(n,16)))}function iA(t){return t.replace(/<\/p>\s*<p[^>]*>/gi,`
`).replace(/<br\s*\/?>/gi,`
`).replace(/<(p|div|h[1-6])[^>]*>/gi,"").replace(/<\/(p|div|h[1-6])>/gi,`
`)}function hK(t){const e=iA(t),n=[],r=/<mark([^>]*)>(.*?)<\/mark>/gis;let s=0,i;for(;(i=r.exec(e))!==null;){if(i.index>s){const g=e.slice(s,i.index),y=lu(g.replace(/<[^>]*>/g,""));y&&n.push({text:y})}const o=i[1],l=i[2];let d;const f=o.match(/data-color=["']([^"']+)["']/);if(f)d=f[1];else{const g=o.match(/style=["'][^"']*background-color:\s*([^;"']+)/i);g&&(d=g[1].trim())}const p=lu(l.replace(/<[^>]*>/g,""));p&&n.push({text:p,highlightColor:d}),s=i.index+i[0].length}if(s<e.length){const o=e.slice(s),l=lu(o.replace(/<[^>]*>/g,""));l&&n.push({text:l})}if(n.length===0){const o=lu(e.replace(/<[^>]*>/g,""));o&&n.push({text:o})}return n}function pK(t){const e=iA(t);return lu(e.replace(/<[^>]*>/g,"")).replace(/\n{3,}/g,`

`).trim()}function gK(t,e){const n=t.map(l=>l.text).join(""),r=sA(n,e);if(!t.some(l=>l.highlightColor))return[{text:r}];const i=[];let o=0;for(const l of t){const d=l.text.length;let f="";for(let p=0;p<d&&o<r.length;p++){const g=l.text[p],y=r[o];g!==`
`&&g===y&&(f+=y,o++)}f&&i.push({text:f,highlightColor:l.highlightColor})}if(o<r.length){const l=r.slice(o);l&&(i.length>0?i[i.length-1].text+=l:i.push({text:l}))}return i}function mK(t){return t.length===0?null:t.some(n=>n.highlightColor)?t.map((n,r)=>n.highlightColor?u.jsx("span",{style:{backgroundColor:n.highlightColor,borderRadius:"2px",padding:"0 2px"},children:n.text},r):u.jsx("span",{children:n.text},r)):t.map(n=>n.text).join("")}function si({content:t,style:e,containerWidth:n,containerHeight:r,isHtml:s=!1}){const i=C.useRef(null),[o,l]=C.useState(null),d=C.useRef(t),f=C.useMemo(()=>s?pK(t):t,[t,s]),p=C.useMemo(()=>s?hK(t):[{text:t}],[t,s]),g=d.current!==t;g&&(d.current=t,o!==null&&e.autoScale&&l(null));const[y,m]=C.useState(p);C.useLayoutEffect(()=>{if(!i.current)return;const S=i.current,T=n,j=r;if(T<=0||j<=0)return;let M=f,_=p;if(e.compressLines&&(M=sA(f,e.lineSeparator??"space"),_=gK(p,e.lineSeparator??"space")),m(_),!e.autoScale){l(e.maxFontSize);return}const R=e.minFontSize??12,O=e.lineHeight??1.3,L=e.fitLineToWidth?lK({measureElement:S,text:M,maxWidth:T,minFontSize:R,maxFontSize:e.maxFontSize,lineHeight:O}):oK({measureElement:S,text:M,maxWidth:T,maxHeight:j,minFontSize:R,maxFontSize:e.maxFontSize,lineHeight:O});l(L.fontSize)},[f,p,e.autoScale,e.maxFontSize,e.minFontSize,e.compressLines,e.lineSeparator,e.fitLineToWidth,e.lineHeight,n,r]);const b=!g&&(o!==null||!e.autoScale),v=o??e.maxFontSize,w={...Ua(e),fontSize:`${v}px`,width:"100%",height:"100%",display:"flex",alignItems:e.verticalAlignment==="top"?"flex-start":e.verticalAlignment==="bottom"?"flex-end":"center",justifyContent:e.alignment==="center"?"center":e.alignment==="right"?"flex-end":"flex-start",overflow:"hidden",wordWrap:e.fitLineToWidth?"normal":"break-word",whiteSpace:e.fitLineToWidth?"pre":"pre-wrap",visibility:b?"visible":"hidden"};return u.jsx("div",{ref:i,style:w,children:mK(y)})}function aA({screen:t,contentType:e,contentData:n,containerWidth:r,containerHeight:s,showClock:i=!0,isVisible:o=!0,nextSlideData:l,fillContainer:d=!1}){const f=t.contentConfigs[e],p=d?r:t.width,g=d?s:t.height,y=r/p,m=s/g,b=Math.min(y,m),v=p*b,w=g*b,S=(r-v)/2,T=(s-w)/2,j=()=>{if(!f||!("mainText"in f)||!n?.mainText)return null;const A=f.mainText;if(A.hidden)return null;const F=Wr(A.constraints,A.size,p,g),H={x:F.x*b,y:F.y*b,width:F.width*b,height:F.height*b};return u.jsx(eh,{animationIn:"animationIn"in A?A.animationIn:void 0,animationOut:"animationOut"in A?A.animationOut:void 0,isVisible:!0,style:{position:"absolute",left:H.x,top:H.y,width:H.width,height:H.height},children:u.jsx(si,{content:n.mainText,style:{...A.style,maxFontSize:A.style.maxFontSize*b},containerWidth:H.width,containerHeight:H.height,isHtml:!0})},"mainText")},M=()=>{if(!f||!("contentText"in f)||!n?.contentText)return null;const A=f.contentText;if(A.hidden)return null;const F=Wr(A.constraints,A.size,p,g),H={x:F.x*b,y:F.y*b,width:F.width*b,height:F.height*b},E=f.includeReferenceInContent&&n.referenceText?`${n.referenceText} ${n.contentText}`:n.contentText;return u.jsx(eh,{animationIn:"animationIn"in A?A.animationIn:void 0,animationOut:"animationOut"in A?A.animationOut:void 0,isVisible:!0,style:{position:"absolute",left:H.x,top:H.y,width:H.width,height:H.height},children:u.jsx(si,{content:E,style:{...A.style,maxFontSize:A.style.maxFontSize*b},containerWidth:H.width,containerHeight:H.height,isHtml:!1})},"contentText")},_=()=>{if(!f||!("referenceText"in f)||!n?.referenceText)return null;const A=f.referenceText;if(A.hidden||f.includeReferenceInContent)return null;const H=Wr(A.constraints,A.size,p,g),P={x:H.x*b,y:H.y*b,width:H.width*b,height:H.height*b};return u.jsx(eh,{animationIn:"animationIn"in A?A.animationIn:void 0,animationOut:"animationOut"in A?A.animationOut:void 0,isVisible:!0,style:{position:"absolute",left:P.x,top:P.y,width:P.width,height:P.height},children:u.jsx(si,{content:n.referenceText,style:{...A.style,maxFontSize:A.style.maxFontSize*b},containerWidth:P.width,containerHeight:P.height,isHtml:!1})},"referenceText")},R=()=>{if(!f||!("personLabel"in f)||!n?.personLabel)return null;const A=f.personLabel;if(A.hidden)return null;const F=Wr(A.constraints,A.size,p,g),H={x:F.x*b,y:F.y*b,width:F.width*b,height:F.height*b};return u.jsx(eh,{animationIn:"animationIn"in A?A.animationIn:void 0,animationOut:"animationOut"in A?A.animationOut:void 0,isVisible:!0,style:{position:"absolute",left:H.x,top:H.y,width:H.width,height:H.height},children:u.jsx(si,{content:n.personLabel,style:{...A.style,maxFontSize:A.style.maxFontSize*b},containerWidth:H.width,containerHeight:H.height,isHtml:!1})},"personLabel")},O=()=>{if(!i)return null;const A=f&&"clock"in f?f.clock:t.globalSettings.clockConfig;if(!A?.enabled||A.hidden)return null;const F=Wr(A.constraints,A.size,p,g),H=new Date,P=A.showSeconds?H.toLocaleTimeString("ro-RO",{hour12:!1}):H.toLocaleTimeString("ro-RO",{hour:"2-digit",minute:"2-digit",hour12:!1});return u.jsx("div",{className:"absolute overflow-hidden flex items-center justify-end",style:{left:F.x*b,top:F.y*b,width:F.width*b,height:F.height*b,...Ua(A.style),fontSize:A.style.maxFontSize*b},children:P},"clock")},L=()=>{if(t.type!=="stage"||!t.nextSlideConfig?.enabled)return null;const A=t.nextSlideConfig;if(A.hidden)return null;const F=Wr(A.constraints,A.size,p,g),H={x:F.x*b,y:F.y*b,width:F.width*b,height:F.height*b},P=16*b;A.labelStyle.maxFontSize*b+8*b;const B=()=>{if(l?.verseteTineriSummary){const{entries:K,hasMore:q}=l.verseteTineriSummary;return u.jsxs("span",{style:{...Ua(A.contentStyle),fontSize:A.contentStyle.maxFontSize*b},children:[K.map((V,ie)=>u.jsxs("span",{children:[V.personName," - ",V.reference,ie<K.length-1&&"  "]},ie)),q&&" ..."]})}const E=l?.preview||"";return E?u.jsx("span",{style:{...Ua(A.contentStyle),fontSize:A.contentStyle.maxFontSize*b},dangerouslySetInnerHTML:{__html:E}}):null};return u.jsxs("div",{className:"absolute overflow-hidden",style:{left:H.x,top:H.y,width:H.width,height:H.height,padding:P,display:"flex",flexDirection:"column",...Gu(A.background)},children:[u.jsx("div",{style:{...Ua(A.labelStyle),fontSize:A.labelStyle.maxFontSize*b,flexShrink:0},children:A.labelText}),u.jsx("div",{style:{marginTop:8*b,flex:1,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:B()})]},"nextSlide")};return u.jsx("div",{className:"relative overflow-hidden",style:{width:r,height:s},children:u.jsxs("div",{className:"absolute",style:{left:S,top:T,width:v,height:w,position:"relative"},children:[o&&u.jsxs(u.Fragment,{children:[j(),M(),_(),R()]}),O(),L()]})})}function yK({screen:t,contentType:e,contentData:n,showClock:r=!0}){const s=C.useRef(null),[i,o]=C.useState({width:400,height:225});C.useEffect(()=>{const f=()=>{if(!s.current)return;const p=s.current.getBoundingClientRect();p.width>0&&p.height>0&&o({width:p.width,height:p.height})};if(f(),s.current){const p=new ResizeObserver(f);return p.observe(s.current),()=>p.disconnect()}},[]);const d=t.contentConfigs[e]?.background||t.contentConfigs.empty?.background;return u.jsx("div",{ref:s,className:"absolute inset-0 overflow-hidden",style:d?Gu(d):{backgroundColor:"#000000"},children:u.jsx(aA,{screen:t,contentType:e,contentData:n,containerWidth:i.width,containerHeight:i.height,showClock:r,isVisible:!0})})}function Yv(){Xl();const{data:t}=fi(),{data:e}=Ub(),n=C.useMemo(()=>e&&e.filter(p=>p.type==="primary").sort((p,g)=>p.sortOrder-g.sortOrder)[0]||null,[e]),{data:r}=qb(n?.id??void 0),[s,i]=C.useState("empty"),[o,l]=C.useState({});C.useEffect(()=>{(async()=>{if(!t){l({}),i("empty");return}if(t.isHidden){l({}),i("empty");return}if(t.temporaryContent){const g=t.temporaryContent;if(g.type==="bible"){const y=g.data.reference.replace(/\s*-\s*[A-Z]+\s*$/,"");i("bible"),l({referenceText:y,contentText:g.data.text});return}if(g.type==="song"){const y=g.data.slides[g.data.currentSlideIndex];if(y){i("song"),l({mainText:y.content});return}}}try{const g=await fetch(`${Ct()}/api/queue`,{cache:"no-store",headers:{"Cache-Control":"no-cache"},credentials:"include"});if(!g.ok){l({}),i("empty");return}const m=(await g.json()).data||[];if(t.currentSongSlideId)for(const b of m){const v=b.slides?.find(w=>w.id===t.currentSongSlideId);if(v){i("song"),l({mainText:v.content});return}}if(t.currentQueueItemId&&!t.currentSongSlideId){const b=m.find(v=>v.id===t.currentQueueItemId);if(b){if(b.itemType==="slide"){if(b.slideType==="versete_tineri"&&b.verseteTineriEntries){const v=t.currentVerseteTineriEntryId,w=v?b.verseteTineriEntries.find(S=>S.id===v):b.verseteTineriEntries[0];if(w){i("versete_tineri"),l({personLabel:w.person||"",referenceText:w.reference,contentText:w.text});return}}i("announcement"),l({mainText:b.slideContent||""});return}if(b.itemType==="bible"){const v=(b.bibleReference||"").replace(/\s*-\s*[A-Z]+\s*$/,"");i("bible"),l({referenceText:v,contentText:b.bibleText||""});return}if(b.itemType==="bible_passage"){const v=t.currentBiblePassageVerseId,w=v?b.biblePassageVerses?.find(S=>S.id===v):b.biblePassageVerses?.[0];if(w){i("bible_passage"),l({referenceText:w.reference,contentText:w.text});return}}}}l({}),i("empty")}catch{l({}),i("empty")}})()},[t?.currentSongSlideId,t?.currentQueueItemId,t?.currentBiblePassageVerseId,t?.currentVerseteTineriEntryId,t?.isHidden,t?.temporaryContent,t?.updatedAt]);const f=!(Object.keys(o).length>0)||t?.isHidden;return r?u.jsx("div",{className:"relative w-full aspect-video rounded-lg overflow-hidden shadow-lg",children:u.jsx(yK,{screen:r,contentType:s,contentData:o,showClock:f})}):u.jsx("div",{className:"relative w-full aspect-video rounded-lg overflow-hidden shadow-lg bg-gray-800 flex items-center justify-center",children:u.jsx("div",{className:"text-gray-400 text-sm",children:"Loading..."})})}function xK(){const{t}=ke(["presentation","queue"]),{showToast:e}=mt();Xl(),tP();const{data:n}=fi(),{data:r}=Up(),s=XE(),[i,o]=C.useState(!1),[l,d]=C.useState(!1),[f,p]=C.useState(!1),[g,y]=C.useState("announcement"),[m,b]=C.useState(!1),[v,w]=C.useState(!1),[S,T]=C.useState(!1),j=ar(),M=PE(),_=zp(),R=$b(),O=dP(),L=!!n?.currentQueueItemId||!!n?.currentSongSlideId,A=async()=>{await M.mutateAsync("prev")},F=async()=>{await M.mutateAsync("next")},H=async()=>{(n?.lastSongSlideId||n?.currentQueueItemId)&&await R.mutateAsync()},P=async()=>{await _.mutateAsync()},B=async(se,ge)=>{const be=ge===-1;await O.mutateAsync({currentQueueItemId:se,currentSongSlideId:be?null:ge,currentBiblePassageVerseId:null,isHidden:!1})},E=async(se,ge)=>{await O.mutateAsync({currentQueueItemId:se,currentSongSlideId:null,currentBiblePassageVerseId:ge,currentVerseteTineriEntryId:null,isHidden:!1})},K=async(se,ge)=>{await O.mutateAsync({currentQueueItemId:se,currentSongSlideId:null,currentBiblePassageVerseId:null,currentVerseteTineriEntryId:ge,isHidden:!1})},q=async()=>{o(!1),await _.mutateAsync(),await s.mutateAsync()&&e(t("queue:messages.cleared"),"success")},V=()=>{d(!0)},ie=se=>{y(se),p(!0)},Y=()=>{b(!0)},X=()=>{T(!0)},I=se=>{j({to:"/schedules/$scheduleId",params:{scheduleId:String(se)}})},U=n?.isHidden??!1,te=!!n?.currentSongSlideId||!!n?.currentQueueItemId||!!n?.lastSongSlideId,Z=L,re=M.isPending;return u.jsxs("div",{className:"flex flex-col h-full gap-3",children:[u.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 flex-1 min-h-0",children:[u.jsxs("div",{className:"lg:w-2/3 space-y-3 overflow-auto",children:[u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Sh,{size:20,className:"text-indigo-600"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("presentation:controlRoom.title")})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-md ${U?"bg-gray-100 dark:bg-gray-700":"bg-red-100 dark:bg-red-900/30"}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${U?"bg-gray-400 dark:bg-gray-500":"bg-red-500 animate-pulse"}`}),u.jsx("span",{className:`text-xs font-semibold ${U?"text-gray-400 dark:text-gray-500":"text-red-600 dark:text-red-400"}`,children:"LIVE"})]}),U?u.jsxs("button",{type:"button",onClick:H,disabled:!te||R.isPending,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 transition-colors",title:`${t("presentation:controls.show")} (F10)`,children:[R.isPending?u.jsx(Qe,{size:18,className:"animate-spin"}):u.jsx(ua,{size:18}),u.jsx("span",{children:t("presentation:controls.show")}),u.jsx("span",{className:"text-xs opacity-75",children:"(F10)"})]}):u.jsxs("button",{type:"button",onClick:P,disabled:_.isPending,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 transition-colors",title:`${t("presentation:controls.hide")} (Esc)`,children:[_.isPending?u.jsx(Qe,{size:18,className:"animate-spin"}):u.jsx(Wl,{size:18}),u.jsx("span",{children:t("presentation:controls.hide")}),u.jsx("span",{className:"text-xs opacity-75",children:"(Esc)"})]})]})]}),u.jsx(Yv,{})]}),u.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:u.jsxs("div",{className:"flex items-center justify-center gap-3 flex-wrap",children:[u.jsxs("button",{type:"button",onClick:A,disabled:!Z||re,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",title:t("presentation:controls.prev"),children:[u.jsx(Nj,{size:20}),u.jsx("span",{children:t("presentation:controls.prev")})]}),u.jsxs("button",{type:"button",onClick:F,disabled:!Z||re,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",title:t("presentation:controls.next"),children:[u.jsx("span",{children:t("presentation:controls.next")}),u.jsx(Ms,{size:20})]})]})})]}),u.jsx("div",{className:"lg:w-1/3 flex flex-col min-h-0 flex-1 lg:flex-initial",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 flex-1 flex flex-col min-h-0 overflow-hidden",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 pb-3 flex-shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("queue:title")}),r&&r.length>0&&u.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",t("queue:songCount",{count:r.length}),")"]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(bB,{onAddSong:V,onAddBiblePassage:X,onAddSlide:ie,onImportSchedule:Y}),r&&r.length>0&&u.jsx("button",{type:"button",onClick:()=>w(!0),className:"p-1.5 text-white bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 rounded-lg transition-colors",title:t("queue:actions.saveAsProgram"),children:u.jsx(rd,{size:18})}),r&&r.length>0&&u.jsx("button",{type:"button",onClick:()=>o(!0),className:"p-1.5 text-white bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 rounded-lg transition-colors",children:u.jsx(Bn,{size:18})})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin min-h-0 px-4 pb-4",children:u.jsx(sK,{activeSlideId:n?.currentSongSlideId??null,activeVerseId:n?.currentBiblePassageVerseId??null,activeEntryId:n?.currentVerseteTineriEntryId??null,activeQueueItemId:n?.currentQueueItemId??null,onSlideClick:B,onVerseClick:E,onEntryClick:K,hideHeader:!0})})]})})]}),u.jsx(di,{isOpen:i,title:t("queue:confirmClear.title"),message:t("queue:confirmClear.message"),confirmLabel:t("queue:actions.clear"),onConfirm:q,onCancel:()=>o(!1),variant:"danger"}),u.jsx(lg,{isOpen:l,onClose:()=>d(!1)}),u.jsx(tb,{isOpen:f,onClose:()=>p(!1),initialTemplate:g}),u.jsx(YV,{isOpen:m,onClose:()=>b(!1)}),u.jsx(iK,{isOpen:v,onClose:()=>w(!1),onSaved:I}),u.jsx(e3,{isOpen:S,onClose:()=>T(!1)})]})}const ZN=5;function oA(t){return t.replace(/<[^>]*>/g," ").trim()}function lA(t){return oA(t)}function bK(t){return t.replace(/\s*-\s*[A-Z]+\s*$/,"").trim()}function Au(t,e){return`${bK(t||"")}: ${e||""}`}function vK(t){return oA(t||"")}function wK(t){return{entries:t.slice(0,ZN).map(n=>({personName:n.personName,reference:n.reference})),hasMore:t.length>ZN}}function SK(t){return`${t.personName} - ${t.reference}`}function ml(t){if(t)switch(t.itemType){case"song":{const e=t.slides?.[0];return e?{contentType:"song",preview:lA(e.content)}:void 0}case"bible":return{contentType:"bible",preview:Au(t.bibleReference,t.bibleText)};case"bible_passage":{const e=t.biblePassageVerses?.[0];return e?{contentType:"bible_passage",preview:Au(e.reference,e.text)}:void 0}case"slide":{if(t.slideType==="versete_tineri"){const e=t.verseteTineriEntries||[];return e.length===0?void 0:{contentType:"versete_tineri",preview:e.map(n=>n.personName).join(", "),verseteTineriSummary:wK(e)}}return{contentType:"announcement",preview:vK(t.slideContent)}}default:return}}function kK(t){const{queueItems:e,presentationState:n,nextBibleVerse:r}=t,{currentQueueItemId:s,currentSongSlideId:i,currentBiblePassageVerseId:o,currentVerseteTineriEntryId:l}=n;if(!s||e.length===0)return;const d=e.findIndex(g=>g.id===s);if(d===-1)return;const f=e[d],p=e[d+1];if(f.itemType==="song"&&i){const g=f.slides||[],y=g.findIndex(m=>m.id===i);if(y!==-1&&y<g.length-1){const m=g[y+1];return{contentType:"song",preview:lA(m.content)}}return ml(p)}if(f.itemType==="bible_passage"){const g=f.biblePassageVerses||[],y=o||g[0]?.id;if(y){const m=g.findIndex(b=>b.id===y);if(m!==-1&&m<g.length-1){const b=g[m+1];return{contentType:"bible_passage",preview:Au(b.reference,b.text)}}}return p?ml(p):r?{contentType:"bible",preview:Au(`${r.bookName} ${r.chapter}:${r.verse}`,r.text)}:void 0}if(f.itemType==="slide"&&f.slideType==="versete_tineri"){const g=f.verseteTineriEntries||[],y=l||g[0]?.id;if(y){const m=g.findIndex(b=>b.id===y);if(m!==-1&&m<g.length-1){const b=g[m+1];return{contentType:"versete_tineri",preview:SK(b)}}}return ml(p)}return f.itemType==="bible"?p?ml(p):r?{contentType:"bible",preview:Au(`${r.bookName} ${r.chapter}:${r.verse}`,r.text)}:void 0:(f.itemType==="slide"&&f.slideType==="announcement",ml(p))}function CK({screenId:t}){Xl();const{data:e}=fi(),{data:n,isLoading:r,isError:s}=qb(t),i=$E(),o=C.useRef(null),[l,d]=C.useState(null),[f,p]=C.useState("empty"),[g,y]=C.useState(),[m,b]=C.useState(!1),[v,w]=C.useState(!1),S=C.useRef(null),T=C.useRef(!1),[j,M]=C.useState({width:0,height:0});C.useEffect(()=>{const B=()=>{o.current&&M({width:o.current.clientWidth,height:o.current.clientHeight})};B();const E=new ResizeObserver(B);return o.current&&E.observe(o.current),()=>E.disconnect()},[n]),C.useEffect(()=>{let B=null;const E=async()=>{if(dn())try{const{getCurrentWebviewWindow:q}=await kn(async()=>{const{getCurrentWebviewWindow:Y}=await import("./webviewWindow-YTEqKU76.js");return{getCurrentWebviewWindow:Y}},__vite__mapDeps([0,1,2,3])),V=q(),ie=await V.isFullscreen();b(ie),B=await V.listen("tauri://resize",async()=>{const Y=await V.isMaximized(),X=await V.isFullscreen();Y&&!X&&!T.current&&(await Mh(V,!0),b(!0),n&&i.mutate({id:n.id,name:n.name,type:n.type,isFullscreen:!0})),!Y&&T.current&&setTimeout(()=>{T.current=!1},500),b(await V.isFullscreen())})}catch{}},K=()=>{if(!dn()){const q=document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement;b(!!q)}};return E(),document.addEventListener("fullscreenchange",K),document.addEventListener("webkitfullscreenchange",K),document.addEventListener("MSFullscreenChange",K),()=>{document.removeEventListener("fullscreenchange",K),document.removeEventListener("webkitfullscreenchange",K),document.removeEventListener("MSFullscreenChange",K),B&&B()}},[n,i]);const _=async B=>{try{if(B){const E=document.documentElement;E.requestFullscreen?await E.requestFullscreen():E.webkitRequestFullscreen?await E.webkitRequestFullscreen():E.msRequestFullscreen&&await E.msRequestFullscreen()}else document.fullscreenElement&&(document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.msExitFullscreen&&await document.msExitFullscreen());return!0}catch(E){return console.error("[useBrowserFullscreen] Error:",E),!1}},R=C.useCallback(async()=>{const B=!m;console.log(`[toggleFullscreen] Toggling fullscreen to: ${B}`),B||(T.current=!0);let E=!1;if(dn())try{const{getCurrentWebviewWindow:K}=await kn(async()=>{const{getCurrentWebviewWindow:ie}=await import("./webviewWindow-YTEqKU76.js");return{getCurrentWebviewWindow:ie}},__vite__mapDeps([0,1,2,3])),q=K();console.log("[toggleFullscreen] Got window:",q?.label),await Mh(q,B)?(b(B),E=!0,console.log("[toggleFullscreen] Tauri fullscreen set successfully")):(console.log("[toggleFullscreen] Tauri methods failed, trying browser fullscreen fallback..."),E=await _(B),E&&(b(B),console.log("[toggleFullscreen] Browser fullscreen fallback succeeded")))}catch(K){console.error("[toggleFullscreen] Tauri fullscreen threw error, trying browser fallback:",K),E=await _(B),E&&(b(B),console.log("[toggleFullscreen] Browser fullscreen fallback succeeded after error"))}else E=await _(B),E&&b(B);E||console.error("[toggleFullscreen] All fullscreen methods failed"),n&&i.mutate({id:n.id,name:n.name,type:n.type,isFullscreen:B})},[m,n,i]),O=C.useCallback(B=>{B.clientY<60&&(w(!0),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{w(!1)},3e3))},[]);C.useEffect(()=>()=>{S.current&&clearTimeout(S.current)},[]),C.useEffect(()=>{const B=document.documentElement.style.backgroundColor,E=document.body.style.backgroundColor;return document.documentElement.style.backgroundColor="transparent",document.body.style.backgroundColor="transparent",()=>{document.documentElement.style.backgroundColor=B,document.body.style.backgroundColor=E}},[]),C.useEffect(()=>{const B=E=>{E.key==="F11"&&(E.preventDefault(),R())};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[R]);const[,L]=C.useState(0);if(C.useEffect(()=>{const B=setInterval(()=>L(E=>E+1),1e3);return()=>clearInterval(B)},[]),C.useEffect(()=>{(async()=>{if(!e){d(null),p("empty");return}if(e.isHidden){d(null),p("empty");return}if(e.temporaryContent){const E=e.temporaryContent;if(E.type==="bible"){const K=E.data.reference.replace(/\s*-\s*[A-Z]+\s*$/,"");p("bible"),d({referenceText:K,contentText:E.data.text}),y(void 0);return}if(E.type==="song"){const K=E.data.slides[E.data.currentSlideIndex];if(K){if(p("song"),d({mainText:K.content}),n?.type==="stage"){const q=E.data.slides[E.data.currentSlideIndex+1];y(q?{contentType:"song",preview:q.content}:void 0)}else y(void 0);return}}}try{const E=await fetch(`${Ct()}/api/queue`,{cache:"no-store",headers:{"Cache-Control":"no-cache"},credentials:"include"});if(!E.ok){d(null),p("empty"),y(void 0);return}const q=(await E.json()).data||[];let V="empty",ie=null;if(e.currentSongSlideId)for(const Y of q){const X=Y.slides?.find(I=>I.id===e.currentSongSlideId);if(X){V="song",ie={mainText:X.content};break}}if(!ie&&e.currentQueueItemId&&!e.currentSongSlideId){const Y=q.find(X=>X.id===e.currentQueueItemId);if(Y){if(Y.itemType==="slide"){if(Y.slideType==="versete_tineri"&&Y.verseteTineriEntries){const X=e.currentVerseteTineriEntryId,I=X?Y.verseteTineriEntries.find(U=>U.id===X):Y.verseteTineriEntries[0];I&&(V="versete_tineri",ie={personLabel:I.personName||"",referenceText:I.reference,contentText:I.text})}ie||(V="announcement",ie={mainText:Y.slideContent||""})}else if(Y.itemType==="bible"){const X=(Y.bibleReference||"").replace(/\s*-\s*[A-Z]+\s*$/,"");V="bible",ie={referenceText:X,contentText:Y.bibleText||""}}else if(Y.itemType==="bible_passage"){const X=e.currentBiblePassageVerseId,I=X?Y.biblePassageVerses?.find(U=>U.id===X):Y.biblePassageVerses?.[0];I&&(V="bible_passage",ie={referenceText:I.reference,contentText:I.text})}}}if(p(V),d(ie),n?.type==="stage"){let Y=null;const X=q.findIndex(Z=>Z.id===e.currentQueueItemId),I=X!==-1&&X<q.length-1,U=q[X];if(!I&&U){let Z=null;if(U.itemType==="bible")Z=U.bibleVerseId;else if(U.itemType==="bible_passage"){const re=U.biblePassageVerses||[],se=e.currentBiblePassageVerseId?re.findIndex(be=>be.id===e.currentBiblePassageVerseId):0;se===re.length-1&&(Z=re[se]?.verseId??null)}if(Z)try{Y=await VP(Z)}catch{}}const te=kK({queueItems:q,presentationState:e,nextBibleVerse:Y});y(te)}else y(void 0)}catch{d(null),p("empty"),y(void 0)}})()},[e?.currentSongSlideId,e?.currentQueueItemId,e?.currentBiblePassageVerseId,e?.currentVerseteTineriEntryId,e?.isHidden,e?.temporaryContent,e?.updatedAt,n?.type]),s)return u.jsx("div",{className:"w-screen h-screen",style:{backgroundColor:"black",background:"transparent"}});if(r||!n)return u.jsx("div",{className:"w-screen h-screen",style:{backgroundColor:"black",background:"transparent"}});const F=l!==null&&!e?.isHidden,P=n.contentConfigs[f]?.background||n.contentConfigs.empty?.background;return u.jsxs("div",{ref:o,className:"w-screen h-screen overflow-hidden cursor-default",style:P?Gu(P):{backgroundColor:"#000000"},onDoubleClick:R,onMouseMove:O,children:[u.jsx("div",{className:`fixed top-0 right-0 z-50 p-2 transition-opacity duration-300 ${v?"opacity-100":"opacity-0 pointer-events-none"}`,onMouseEnter:()=>{S.current&&clearTimeout(S.current),w(!0)},onMouseLeave:()=>{S.current=setTimeout(()=>{w(!1)},1e3)},children:u.jsx("button",{type:"button",onClick:R,className:"p-2 rounded-lg bg-black/50 hover:bg-black/70 text-white transition-colors",title:m?"Exit fullscreen":"Enter fullscreen",children:m?u.jsx(wI,{size:20}):u.jsx(gI,{size:20})})}),j.width>0&&j.height>0&&u.jsx(aA,{screen:n,contentType:f,contentData:l,containerWidth:j.width,containerHeight:j.height,showClock:!0,isVisible:F,nextSlideData:g,fillContainer:!0})]})}const NK=()=>({song:{},bible:{},bible_passage:{},announcement:{},versete_tineri:{},empty:{}});function TK(){const[t,e]=C.useState(null),[n,r]=C.useState("song"),[s,i]=C.useState(null),[o,l]=C.useState(1),[d,f]=C.useState(!1),[p,g]=C.useState(NK),y=C.useCallback(R=>{e(R),f(!1)},[]),m=C.useCallback(R=>{e(R)},[]),b=C.useCallback((R,O)=>{e(L=>L&&{...L,contentConfigs:{...L.contentConfigs,[R]:O}}),f(!0)},[]),v=C.useCallback(R=>{e(O=>O&&{...O,nextSlideConfig:R}),f(!0)},[]),w=C.useCallback(R=>{e(O=>O&&{...O,globalSettings:R}),f(!0)},[]),S=C.useCallback(()=>{i(null)},[]),T=C.useCallback(()=>{f(!1)},[]),j=C.useCallback((R,O,L)=>{g(A=>({...A,[R]:{...A[R],[O]:L}}))},[]),M=C.useCallback(R=>{g(O=>({...O,[R]:{}}))},[]),_=C.useMemo(()=>({setScreen:y,setScreenExternal:m,setSelectedContentType:r,setSelectedElement:i,setZoom:l,updateContentConfig:b,updateNextSlideConfig:v,updateGlobalSettings:w,clearSelection:S,markClean:T,setPreviewText:j,resetPreviewTexts:M}),[y,m,r,i,l,b,v,w,S,T,j,M]);return[{screen:t,selectedContentType:n,selectedElement:s,zoom:o,isDirty:d,previewTexts:p},_]}const jK={song:{main:`Aleluia, Aleluia!
Mrire Domnului!
Aleluia, Aleluia!
Slvit s fie El!`},bible:{reference:"Ioan 3:16",main:"Fiindc att de mult a iubit Dumnezeu lumea, c a dat pe singurul Lui Fiu, pentru ca oricine crede n El s nu piar, ci s aib via venic."},bible_passage:{reference:"Psalmul 23:1-3",main:"Domnul este Pstorul meu: nu voi duce lips de nimic. El m pate n puni verzi i m duce la ape de odihn; mi nvioreaz sufletul."},announcement:{main:"<h1>Anun Important</h1><p>Program special duminica viitoare!</p>"},versete_tineri:{person:"Andrei Popescu",reference:"Romani 8:28",main:"De alt parte, tim c toate lucrurile lucreaz mpreun spre binele celor ce iubesc pe Dumnezeu."},empty:{}};function yl({x:t,y:e,width:n,height:r,constraints:s,size:i,isSelected:o,isHidden:l=!1,onClick:d,onConstraintChange:f,onSizeChange:p,canvasWidth:g,canvasHeight:y,screenWidth:m,screenHeight:b,canvasRef:v,children:w}){const S=C.useRef(null),[T,j]=C.useState(!1),[M,_]=C.useState({x:0,y:0}),[R,O]=C.useState({x:t,y:e}),L=C.useRef(R),[A,F]=C.useState(null),[H,P]=C.useState({width:n,height:r}),B=C.useRef(H),[E,K]=C.useState({x:0,y:0,width:0,height:0,posX:0,posY:0}),q=g/m;C.useEffect(()=>{O({x:t,y:e})},[t,e]),C.useEffect(()=>{L.current=R},[R]),C.useEffect(()=>{P({width:n,height:r})},[n,r]),C.useEffect(()=>{B.current=H},[H]);const V=C.useCallback(I=>{I.stopPropagation(),d();const U=v.current?.getBoundingClientRect();if(!U)return;const te=I.clientX-U.left,Z=I.clientY-U.top;j(!0),_({x:te-R.x,y:Z-R.y})},[d,R,v]),ie=C.useCallback((I,U)=>{I.stopPropagation(),I.preventDefault(),F(U),K({x:I.clientX,y:I.clientY,width:H.width,height:H.height,posX:R.x,posY:R.y})},[H,R]),Y=C.useCallback((I,U,te)=>U==="%"?I/te*100:I,[]);C.useEffect(()=>{if(!T)return;const I=te=>{const Z=v.current?.getBoundingClientRect();if(!Z)return;const re=te.clientX-Z.left,se=te.clientY-Z.top,ge=re-M.x,be=se-M.y;O({x:ge,y:be})},U=()=>{j(!1);const te=L.current.x/q,Z=L.current.y/q,re=B.current.width/q,se=B.current.height/q,ge={...s};s.left.enabled&&(ge.left={...s.left,value:Y(te,s.left.unit,m)}),s.right.enabled&&(ge.right={...s.right,value:Y(m-te-re,s.right.unit,m)}),s.top.enabled&&(ge.top={...s.top,value:Y(Z,s.top.unit,b)}),s.bottom.enabled&&(ge.bottom={...s.bottom,value:Y(b-Z-se,s.bottom.unit,b)}),f(ge)};return document.addEventListener("mousemove",I),document.addEventListener("mouseup",U),()=>{document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",U)}},[T,M,s,f,Y,v,q,m,b]),C.useEffect(()=>{if(!A)return;const I=te=>{const Z=te.clientX-E.x,re=te.clientY-E.y;let se=E.width,ge=E.height,be=E.posX,me=E.posY;A==="n"?(ge=Math.max(30,E.height-re),me=E.posY+re):A==="s"?ge=Math.max(30,E.height+re):A==="e"?se=Math.max(50,E.width+Z):A==="w"?(se=Math.max(50,E.width-Z),be=E.posX+Z):A==="se"?(se=Math.max(50,E.width+Z),ge=Math.max(30,E.height+re)):A==="sw"?(se=Math.max(50,E.width-Z),ge=Math.max(30,E.height+re),be=E.posX+Z):A==="ne"?(se=Math.max(50,E.width+Z),ge=Math.max(30,E.height-re),me=E.posY+re):A==="nw"&&(se=Math.max(50,E.width-Z),ge=Math.max(30,E.height-re),be=E.posX+Z,me=E.posY+re),P({width:se,height:ge}),O({x:be,y:me})},U=()=>{F(null);const te=L.current.x/q,Z=L.current.y/q,re=B.current.width/q,se=B.current.height/q,ge={...s},be=s.left.enabled&&s.right.enabled,me=s.top.enabled&&s.bottom.enabled;(A==="w"||A==="nw"||A==="sw")&&s.left.enabled&&(ge.left={...s.left,value:Y(te,s.left.unit,m)}),(A==="e"||A==="ne"||A==="se")&&s.right.enabled&&(ge.right={...s.right,value:Y(m-te-re,s.right.unit,m)}),(A==="n"||A==="nw"||A==="ne")&&s.top.enabled&&(ge.top={...s.top,value:Y(Z,s.top.unit,b)}),(A==="s"||A==="sw"||A==="se")&&s.bottom.enabled&&(ge.bottom={...s.bottom,value:Y(b-Z-se,s.bottom.unit,b)}),f(ge);const Se={...i};be||(Se.width=Y(re,i.widthUnit,m)),me||(Se.height=Y(se,i.heightUnit,b)),p(Se)};return document.addEventListener("mousemove",I),document.addEventListener("mouseup",U),()=>{document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",U)}},[A,E,s,i,f,p,Y,q,m,b]);const X=()=>o?"2px solid #6366f1":l?"2px dashed rgba(239, 68, 68, 0.5)":"1px dashed rgba(255,255,255,0.3)";return u.jsxs("div",{ref:S,className:`absolute cursor-move ${T||A?"z-50":""}`,style:{left:R.x,top:R.y,width:H.width,height:H.height,border:X(),boxSizing:"border-box",opacity:l?.4:1},onMouseDown:V,onClick:I=>I.stopPropagation(),children:[w,o&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"absolute -right-1 -bottom-1 w-3 h-3 bg-indigo-500 cursor-se-resize rounded-sm",onMouseDown:I=>ie(I,"se")}),u.jsx("div",{className:"absolute -left-1 -bottom-1 w-3 h-3 bg-indigo-500 cursor-sw-resize rounded-sm",onMouseDown:I=>ie(I,"sw")}),u.jsx("div",{className:"absolute -right-1 -top-1 w-3 h-3 bg-indigo-500 cursor-ne-resize rounded-sm",onMouseDown:I=>ie(I,"ne")}),u.jsx("div",{className:"absolute -left-1 -top-1 w-3 h-3 bg-indigo-500 cursor-nw-resize rounded-sm",onMouseDown:I=>ie(I,"nw")}),u.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -top-1 w-6 h-2 bg-indigo-500 cursor-n-resize rounded-sm",onMouseDown:I=>ie(I,"n")}),u.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -bottom-1 w-6 h-2 bg-indigo-500 cursor-s-resize rounded-sm",onMouseDown:I=>ie(I,"s")}),u.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 -left-1 w-2 h-6 bg-indigo-500 cursor-w-resize rounded-sm",onMouseDown:I=>ie(I,"w")}),u.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 -right-1 w-2 h-6 bg-indigo-500 cursor-e-resize rounded-sm",onMouseDown:I=>ie(I,"e")})]})]})}function EK({screen:t,contentType:e,selectedElement:n,zoom:r,previewTexts:s,onSelectElement:i,onUpdateElement:o}){const l=C.useRef(null),d=C.useRef(null),[f,p]=C.useState({width:800,height:450}),g=t.contentConfigs[e],y=jK[e],m=t.width,b=t.height,v=C.useMemo(()=>({main:s?.main||y?.main,reference:s?.reference||y?.reference,person:s?.person||y?.person}),[e,s,y]);C.useEffect(()=>{const R=()=>{if(!l.current)return;const O=l.current,L=O.clientWidth-40,A=O.clientHeight-40,F=m/b;let H=L,P=H/F;P>A&&(P=A,H=P*F),p({width:H*r,height:P*r})};return R(),window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[m,b,r]);const w=f.width/m,S=()=>{i(null)},T=C.useCallback(R=>O=>{o(R,{constraints:O})},[o]),j=C.useCallback(R=>O=>{o(R,{size:O})},[o]),M=C.useMemo(()=>{const R=[];if("mainText"in g){const L=g.mainText,A=Wr(L.constraints,L.size,m,b);R.push(u.jsx(yl,{x:A.x*w,y:A.y*w,width:A.width*w,height:A.height*w,constraints:L.constraints,size:L.size,isSelected:n?.type==="mainText",isHidden:L.hidden,onClick:()=>i({type:"mainText"}),onConstraintChange:T("mainText"),onSizeChange:j("mainText"),canvasWidth:f.width,canvasHeight:f.height,screenWidth:m,screenHeight:b,canvasRef:d,children:u.jsx(si,{content:v?.main??"Main Content",style:{...L.style,maxFontSize:L.style.maxFontSize*w},containerWidth:A.width*w,containerHeight:A.height*w,isHtml:!0})},"mainText"))}if("contentText"in g){const L=g.contentText,A=Wr(L.constraints,L.size,m,b),P=g.includeReferenceInContent&&v?.reference?`${v.reference} ${v?.main??"Content Text"}`:v?.main??"Content Text";R.push(u.jsx(yl,{x:A.x*w,y:A.y*w,width:A.width*w,height:A.height*w,constraints:L.constraints,size:L.size,isSelected:n?.type==="contentText",isHidden:L.hidden,onClick:()=>i({type:"contentText"}),onConstraintChange:T("contentText"),onSizeChange:j("contentText"),canvasWidth:f.width,canvasHeight:f.height,screenWidth:m,screenHeight:b,canvasRef:d,children:u.jsx(si,{content:P,style:{...L.style,maxFontSize:L.style.maxFontSize*w},containerWidth:A.width*w,containerHeight:A.height*w})},"contentText"))}if("referenceText"in g){const L=g.referenceText,A=Wr(L.constraints,L.size,m,b),H=g.includeReferenceInContent;R.push(u.jsx(yl,{x:A.x*w,y:A.y*w,width:A.width*w,height:A.height*w,constraints:L.constraints,size:L.size,isSelected:n?.type==="referenceText",isHidden:L.hidden||H,onClick:()=>i({type:"referenceText"}),onConstraintChange:T("referenceText"),onSizeChange:j("referenceText"),canvasWidth:f.width,canvasHeight:f.height,screenWidth:m,screenHeight:b,canvasRef:d,children:u.jsx(si,{content:v?.reference??"Reference",style:{...L.style,maxFontSize:L.style.maxFontSize*w},containerWidth:A.width*w,containerHeight:A.height*w})},"referenceText"))}if("personLabel"in g){const L=g.personLabel,A=Wr(L.constraints,L.size,m,b);R.push(u.jsx(yl,{x:A.x*w,y:A.y*w,width:A.width*w,height:A.height*w,constraints:L.constraints,size:L.size,isSelected:n?.type==="personLabel",isHidden:L.hidden,onClick:()=>i({type:"personLabel"}),onConstraintChange:T("personLabel"),onSizeChange:j("personLabel"),canvasWidth:f.width,canvasHeight:f.height,screenWidth:m,screenHeight:b,canvasRef:d,children:u.jsx(si,{content:v?.person??"Person Name",style:{...L.style,maxFontSize:L.style.maxFontSize*w},containerWidth:A.width*w,containerHeight:A.height*w})},"personLabel"))}const O="clock"in g?g.clock:t.globalSettings.clockConfig;if(O?.enabled){const L=O.size??{width:10,widthUnit:"%",height:5,heightUnit:"%"},A=Wr(O.constraints,L,m,b);R.push(u.jsx(yl,{x:A.x*w,y:A.y*w,width:A.width*w,height:A.height*w,constraints:O.constraints,size:L,isSelected:n?.type==="clock",isHidden:O.hidden,onClick:()=>i({type:"clock"}),onConstraintChange:T("clock"),onSizeChange:j("clock"),canvasWidth:f.width,canvasHeight:f.height,screenWidth:m,screenHeight:b,canvasRef:d,children:u.jsx(si,{content:O.showSeconds?"12:34:56":"12:34",style:{...O.style,maxFontSize:O.style.maxFontSize*w},containerWidth:A.width*w,containerHeight:A.height*w})},"clock"))}if(t.type==="stage"&&t.nextSlideConfig?.enabled){const L=t.nextSlideConfig,A=Wr(L.constraints,L.size,m,b);R.push(u.jsx(yl,{x:A.x*w,y:A.y*w,width:A.width*w,height:A.height*w,constraints:L.constraints,size:L.size,isSelected:n?.type==="nextSlide",isHidden:L.hidden,onClick:()=>i({type:"nextSlide"}),onConstraintChange:T("nextSlide"),onSizeChange:j("nextSlide"),canvasWidth:f.width,canvasHeight:f.height,screenWidth:m,screenHeight:b,canvasRef:d,children:u.jsxs("div",{className:"w-full h-full p-4",style:Gu(L.background),children:[u.jsx("div",{style:{...Ua(L.labelStyle),fontSize:L.labelStyle.maxFontSize*w},children:L.labelText}),u.jsx("div",{className:"mt-2",style:{...Ua(L.contentStyle),fontSize:L.contentStyle.maxFontSize*w},children:"Next slide content preview..."})]})},"nextSlide"))}return R},[t,g,v,n,i,f,w,m,b,T,j]),_="background"in g?g.background:t.globalSettings.defaultBackground;return u.jsx("div",{ref:l,className:"flex-1 flex items-center justify-center bg-gray-100 dark:bg-gray-900 overflow-auto p-4",onClick:S,children:u.jsx("div",{ref:d,className:"relative rounded-lg overflow-hidden shadow-2xl border border-gray-300 dark:border-gray-600",style:{width:f.width,height:f.height,...Gu(_)},onClick:R=>R.stopPropagation(),children:M})})}const Wt=C.forwardRef(({checked:t,onCheckedChange:e,label:n,disabled:r,className:s="",id:i},o)=>{const l=i||`checkbox-${Math.random().toString(36).slice(2,9)}`;return u.jsxs("label",{htmlFor:l,className:`flex items-center gap-2 cursor-pointer ${r?"opacity-50 cursor-not-allowed":""} ${s}`,children:[u.jsx("input",{ref:o,type:"checkbox",id:l,checked:t,onChange:d=>e?.(d.target.checked),disabled:r,className:"w-4 h-4 rounded border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-indigo-600 focus:ring-indigo-500 focus:ring-offset-white dark:focus:ring-offset-gray-900"}),n&&u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:n})]})});Wt.displayName="Checkbox";const pt=C.forwardRef(({className:t="",children:e,...n},r)=>u.jsx("label",{ref:r,className:`block text-sm font-medium text-gray-700 dark:text-gray-300 ${t}`,...n,children:e}));pt.displayName="Label";const rb=C.forwardRef(({value:t=[0],onValueChange:e,min:n=0,max:r=100,step:s=1,disabled:i,className:o=""},l)=>u.jsxs("div",{className:`flex items-center gap-3 ${o}`,children:[u.jsx("input",{ref:l,type:"range",value:t[0],onChange:d=>e?.([parseFloat(d.target.value)]),min:n,max:r,step:s,disabled:i,className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed"}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 w-12 text-right",children:t[0]})]}));rb.displayName="Slider";function MK({constraints:t,size:e,screenWidth:n,screenHeight:r,onChange:s}){const{t:i}=ke("presentation"),o=(m,b)=>{s({...t,[m]:b},e)},l=m=>{s(t,{...e,...m})},d=t.left.enabled&&t.right.enabled,f=t.top.enabled&&t.bottom.enabled,p=m=>{const b=t[m],v=b.unit==="%"?"px":"%",w=m==="left"||m==="right"?n:r,S=yy(b.value,b.unit,v,w);o(m,{...b,value:S,unit:v})},g=()=>{const m=e.widthUnit==="%"?"px":"%",b=yy(e.width,e.widthUnit,m,n);l({width:b,widthUnit:m})},y=()=>{const m=e.heightUnit==="%"?"px":"%",b=yy(e.height,e.heightUnit,m,r);l({height:b,heightUnit:m})};return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"relative w-full aspect-video bg-gray-100 dark:bg-gray-800 rounded border border-gray-200 dark:border-gray-700 p-4",children:[u.jsx("div",{className:"absolute inset-8 border-2 border-dashed border-gray-400 dark:border-gray-500 rounded flex items-center justify-center",children:u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:i("screens.position.element","Element")})}),u.jsx("button",{type:"button",onClick:()=>o("top",{...t.top,enabled:!t.top.enabled}),className:`
            absolute top-2 left-1/2 -translate-x-1/2 w-4 h-4 rounded-full border-2
            transition-all duration-150
            ${t.top.enabled?"bg-indigo-600 border-indigo-600":"bg-white dark:bg-gray-900 border-gray-300 dark:border-gray-600"}
          `,title:i("screens.position.top","Top")}),t.top.enabled&&u.jsxs("div",{className:"absolute top-7 left-1/2 -translate-x-1/2 flex items-center gap-0.5 bg-white/90 dark:bg-gray-900/90 rounded overflow-hidden",children:[u.jsx("input",{type:"number",value:gl(t.top.value),onChange:m=>o("top",{...t.top,value:parseFloat(m.target.value)||0}),step:"0.1",className:"w-10 h-5 text-[10px] text-indigo-600 dark:text-indigo-400 font-medium bg-transparent px-1 text-center border-0 focus:outline-none focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onClick:m=>m.stopPropagation()}),u.jsx("button",{type:"button",onClick:m=>{m.stopPropagation(),p("top")},className:"h-5 px-1 text-[10px] text-indigo-500 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/30",children:t.top.unit})]}),u.jsx("button",{type:"button",onClick:()=>o("bottom",{...t.bottom,enabled:!t.bottom.enabled}),className:`
            absolute bottom-2 left-1/2 -translate-x-1/2 w-4 h-4 rounded-full border-2
            transition-all duration-150
            ${t.bottom.enabled?"bg-indigo-600 border-indigo-600":"bg-white dark:bg-gray-900 border-gray-300 dark:border-gray-600"}
          `,title:i("screens.position.bottom","Bottom")}),t.bottom.enabled&&u.jsxs("div",{className:"absolute bottom-7 left-1/2 -translate-x-1/2 flex items-center gap-0.5 bg-white/90 dark:bg-gray-900/90 rounded overflow-hidden",children:[u.jsx("input",{type:"number",value:gl(t.bottom.value),onChange:m=>o("bottom",{...t.bottom,value:parseFloat(m.target.value)||0}),step:"0.1",className:"w-10 h-5 text-[10px] text-indigo-600 dark:text-indigo-400 font-medium bg-transparent px-1 text-center border-0 focus:outline-none focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onClick:m=>m.stopPropagation()}),u.jsx("button",{type:"button",onClick:m=>{m.stopPropagation(),p("bottom")},className:"h-5 px-1 text-[10px] text-indigo-500 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/30",children:t.bottom.unit})]}),u.jsx("button",{type:"button",onClick:()=>o("left",{...t.left,enabled:!t.left.enabled}),className:`
            absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border-2
            transition-all duration-150
            ${t.left.enabled?"bg-indigo-600 border-indigo-600":"bg-white dark:bg-gray-900 border-gray-300 dark:border-gray-600"}
          `,title:i("screens.position.left","Left")}),t.left.enabled&&u.jsxs("div",{className:"absolute left-7 top-1/2 -translate-y-1/2 flex items-center gap-0.5 bg-white/90 dark:bg-gray-900/90 rounded overflow-hidden",children:[u.jsx("input",{type:"number",value:gl(t.left.value),onChange:m=>o("left",{...t.left,value:parseFloat(m.target.value)||0}),step:"0.1",className:"w-10 h-5 text-[10px] text-indigo-600 dark:text-indigo-400 font-medium bg-transparent px-1 text-center border-0 focus:outline-none focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onClick:m=>m.stopPropagation()}),u.jsx("button",{type:"button",onClick:m=>{m.stopPropagation(),p("left")},className:"h-5 px-1 text-[10px] text-indigo-500 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/30",children:t.left.unit})]}),u.jsx("button",{type:"button",onClick:()=>o("right",{...t.right,enabled:!t.right.enabled}),className:`
            absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border-2
            transition-all duration-150
            ${t.right.enabled?"bg-indigo-600 border-indigo-600":"bg-white dark:bg-gray-900 border-gray-300 dark:border-gray-600"}
          `,title:i("screens.position.right","Right")}),t.right.enabled&&u.jsxs("div",{className:"absolute right-7 top-1/2 -translate-y-1/2 flex items-center gap-0.5 bg-white/90 dark:bg-gray-900/90 rounded overflow-hidden",children:[u.jsx("input",{type:"number",value:gl(t.right.value),onChange:m=>o("right",{...t.right,value:parseFloat(m.target.value)||0}),step:"0.1",className:"w-10 h-5 text-[10px] text-indigo-600 dark:text-indigo-400 font-medium bg-transparent px-1 text-center border-0 focus:outline-none focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onClick:m=>m.stopPropagation()}),u.jsx("button",{type:"button",onClick:m=>{m.stopPropagation(),p("right")},className:"h-5 px-1 text-[10px] text-indigo-500 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/30",children:t.right.unit})]}),t.top.enabled&&u.jsx("div",{className:"absolute top-6 left-1/2 w-0.5 h-2 bg-indigo-600 -translate-x-1/2"}),t.bottom.enabled&&u.jsx("div",{className:"absolute bottom-6 left-1/2 w-0.5 h-2 bg-indigo-600 -translate-x-1/2"}),t.left.enabled&&u.jsx("div",{className:"absolute left-6 top-1/2 h-0.5 w-2 bg-indigo-600 -translate-y-1/2"}),t.right.enabled&&u.jsx("div",{className:"absolute right-6 top-1/2 h-0.5 w-2 bg-indigo-600 -translate-y-1/2"})]}),u.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-200 dark:border-gray-700",children:[!d&&u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:i("screens.position.width","Width")}),u.jsxs("div",{className:"flex items-center gap-0.5 mt-1 bg-gray-100 dark:bg-gray-800 rounded overflow-hidden",children:[u.jsx("input",{type:"number",value:gl(e.width),onChange:m=>l({width:parseFloat(m.target.value)||0}),step:"0.1",className:"w-20 h-8 text-sm text-gray-900 dark:text-gray-100 font-medium bg-transparent px-2 text-center border-0 focus:outline-none focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"}),u.jsx("button",{type:"button",onClick:g,className:"h-8 px-2 text-sm text-indigo-600 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/30 font-medium",children:e.widthUnit})]})]}),d&&u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 italic",children:i("screens.position.stretchHorizontal","Width stretches between left and right constraints")}),!f&&u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:i("screens.position.height","Height")}),u.jsxs("div",{className:"flex items-center gap-0.5 mt-1 bg-gray-100 dark:bg-gray-800 rounded overflow-hidden",children:[u.jsx("input",{type:"number",value:gl(e.height),onChange:m=>l({height:parseFloat(m.target.value)||0}),step:"0.1",className:"w-20 h-8 text-sm text-gray-900 dark:text-gray-100 font-medium bg-transparent px-2 text-center border-0 focus:outline-none focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"}),u.jsx("button",{type:"button",onClick:y,className:"h-8 px-2 text-sm text-indigo-600 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/30 font-medium",children:e.heightUnit})]})]}),f&&u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 italic",children:i("screens.position.stretchVertical","Height stretches between top and bottom constraints")})]})]})}function Fr({title:t,icon:e,children:n,defaultOpen:r=!0}){const[s,i]=C.useState(r);return u.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-800",children:[u.jsxs("button",{className:"flex items-center w-full px-4 py-3 text-left hover:bg-gray-100 dark:hover:bg-gray-800/50",onClick:()=>i(!s),children:[s?u.jsx(Es,{className:"w-4 h-4 mr-2 text-gray-500 dark:text-gray-400"}):u.jsx(Ms,{className:"w-4 h-4 mr-2 text-gray-500 dark:text-gray-400"}),u.jsx(e,{className:"w-4 h-4 mr-2 text-gray-500 dark:text-gray-400"}),u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-200",children:t})]}),s&&u.jsx("div",{className:"px-4 pb-4 space-y-4",children:n})]})}const xy=[{value:"system-ui",label:"System Default"},{value:"Arial",label:"Arial"},{value:"Georgia",label:"Georgia"},{value:"Times New Roman",label:"Times New Roman"},{value:"Verdana",label:"Verdana"}],eT=[{value:"none",label:"None"},{value:"fade",label:"Fade"},{value:"slide-left",label:"Slide Left"},{value:"slide-right",label:"Slide Right"},{value:"slide-up",label:"Slide Up"},{value:"slide-down",label:"Slide Down"},{value:"zoom",label:"Zoom"},{value:"blur",label:"Blur"}],AK=[{value:"transparent",label:"Transparent"},{value:"color",label:"Solid Color"},{value:"image",label:"Image"},{value:"video",label:"Video"}],RK=[{value:"space",key:"space"},{value:"dash",key:"dash"},{value:"pipe",key:"pipe"}];function _K({screen:t,contentType:e,selectedElement:n,previewTexts:r,onSetPreviewText:s,onResetPreviewTexts:i,onUpdateContentConfig:o,onUpdateNextSlideConfig:l,onUpdateGlobalSettings:d}){const{t:f}=ke("presentation"),p=t.contentConfigs[e],g=(w,S)=>{const T=JSON.parse(JSON.stringify(p));let j=T;for(let M=0;M<w.length-1;M++)j=j[w[M]];j[w[w.length-1]]=S,o(e,T)},y=w=>{const S=JSON.parse(JSON.stringify(p));for(const{path:T,value:j}of w){let M=S;for(let _=0;_<T.length-1;_++)M=M[T[_]];M[T[T.length-1]]=j}o(e,S)},b=(()=>{if(!n)return null;switch(n.type){case"mainText":return"mainText"in p?{path:["mainText"],config:p.mainText}:null;case"contentText":return"contentText"in p?{path:["contentText"],config:p.contentText}:null;case"referenceText":return"referenceText"in p?{path:["referenceText"],config:p.referenceText}:null;case"personLabel":return"personLabel"in p?{path:["personLabel"],config:p.personLabel}:null;case"clock":return"clock"in p&&p.clock?{path:["clock"],config:p.clock}:null;case"nextSlide":return t.nextSlideConfig?{path:[],config:t.nextSlideConfig,isNextSlide:!0}:null;default:return null}})(),v=(w,S)=>{t.nextSlideConfig&&l({...t.nextSlideConfig,[w]:{...t.nextSlideConfig[w],...S}})};return u.jsx("div",{className:"w-80 bg-white dark:bg-gray-900 border-l border-gray-200 dark:border-gray-800 overflow-y-auto",children:n&&b?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-800/50",children:u.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-200 capitalize",children:n.type.replace(/([A-Z])/g," $1").trim()})}),"constraints"in b.config&&u.jsx(Fr,{title:"Position",icon:CI,children:u.jsx(MK,{constraints:b.config.constraints,size:b.config.size??{width:10,widthUnit:"%",height:5,heightUnit:"%"},screenWidth:t.width,screenHeight:t.height,onChange:(w,S)=>{b.isNextSlide?l({...t.nextSlideConfig,constraints:w,size:S}):y([{path:[...b.path,"constraints"],value:w},{path:[...b.path,"size"],value:S}])}})}),"constraints"in b.config&&u.jsx(Fr,{title:f("screens.panels.visibility"),icon:ua,defaultOpen:!1,children:u.jsx(Wt,{checked:b.config.hidden??!1,onCheckedChange:w=>{b.isNextSlide?l({...t.nextSlideConfig,hidden:!!w}):g([...b.path,"hidden"],!!w)},label:f("screens.visibility.hideElement")})}),"style"in b.config&&u.jsx(Fr,{title:"Text Style",icon:_f,children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Font Family"}),u.jsx(Mn,{value:b.config.style.fontFamily,onChange:w=>{const S={...b.config.style,fontFamily:w};g([...b.path,"style"],S)},options:xy,className:"w-full"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(Wt,{checked:b.config.style.autoScale??!0,onCheckedChange:w=>{const S={...b.config.style,autoScale:!!w};g([...b.path,"style"],S)},label:f("screens.textStyle.autoScale")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 ml-6",children:f("screens.textStyle.autoScaleDescription")})]}),u.jsxs("div",{children:[u.jsxs(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:[b.config.style.autoScale??!0?f("screens.textStyle.maxFontSize"):f("screens.textStyle.fontSize")," ","(px)"]}),u.jsx(xr,{type:"number",value:b.config.style.maxFontSize,onChange:w=>{const S={...b.config.style,maxFontSize:parseInt(w.target.value)||24};g([...b.path,"style"],S)},className:"h-8"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Color"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"color",value:b.config.style.color,onChange:w=>{const S={...b.config.style,color:w.target.value};g([...b.path,"style"],S)},className:"w-10 h-8 rounded cursor-pointer"}),u.jsx(xr,{value:b.config.style.color,onChange:w=>{const S={...b.config.style,color:w.target.value};g([...b.path,"style"],S)},className:"h-8 flex-1"})]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Wt,{checked:b.config.style.bold,onCheckedChange:w=>{const S={...b.config.style,bold:w};g([...b.path,"style"],S)},label:"Bold"}),u.jsx(Wt,{checked:b.config.style.italic,onCheckedChange:w=>{const S={...b.config.style,italic:w};g([...b.path,"style"],S)},label:"Italic"}),u.jsx(Wt,{checked:b.config.style.underline,onCheckedChange:w=>{const S={...b.config.style,underline:w};g([...b.path,"style"],S)},label:"Underline"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Horizontal Alignment"}),u.jsx("div",{className:"flex gap-2 mt-1",children:["left","center","right"].map(w=>u.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded ${b.config.style.alignment===w?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{const S={...b.config.style,alignment:w};g([...b.path,"style"],S)},children:w.charAt(0).toUpperCase()+w.slice(1)},w))})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Vertical Alignment"}),u.jsx("div",{className:"flex gap-2 mt-1",children:["top","middle","bottom"].map(w=>u.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded ${b.config.style.verticalAlignment===w?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{const S={...b.config.style,verticalAlignment:w};g([...b.path,"style"],S)},children:w.charAt(0).toUpperCase()+w.slice(1)},w))})]})]})}),"labelStyle"in b.config&&b.isNextSlide&&u.jsx(Fr,{title:"Title Style",icon:_f,children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Font Family"}),u.jsx(Mn,{value:b.config.labelStyle.fontFamily,onChange:w=>{v("labelStyle",{fontFamily:w})},options:xy,className:"w-full"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Max Font Size (px)"}),u.jsx(xr,{type:"number",value:b.config.labelStyle.maxFontSize,onChange:w=>{v("labelStyle",{maxFontSize:parseInt(w.target.value)||24})},className:"h-8"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Color"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"color",value:b.config.labelStyle.color,onChange:w=>{v("labelStyle",{color:w.target.value})},className:"w-10 h-8 rounded cursor-pointer"}),u.jsx(xr,{value:b.config.labelStyle.color,onChange:w=>{v("labelStyle",{color:w.target.value})},className:"h-8 flex-1"})]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Wt,{checked:b.config.labelStyle.bold,onCheckedChange:w=>{v("labelStyle",{bold:!!w})},label:"Bold"}),u.jsx(Wt,{checked:b.config.labelStyle.italic,onCheckedChange:w=>{v("labelStyle",{italic:!!w})},label:"Italic"}),u.jsx(Wt,{checked:b.config.labelStyle.underline,onCheckedChange:w=>{v("labelStyle",{underline:!!w})},label:"Underline"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Horizontal Alignment"}),u.jsx("div",{className:"flex gap-2 mt-1",children:["left","center","right"].map(w=>u.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded ${b.config.labelStyle.alignment===w?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{v("labelStyle",{alignment:w})},children:w.charAt(0).toUpperCase()+w.slice(1)},w))})]}),u.jsx(Wt,{checked:b.config.labelStyle.shadow??!1,onCheckedChange:w=>{v("labelStyle",{shadow:!!w})},label:"Shadow"})]})}),"contentStyle"in b.config&&b.isNextSlide&&u.jsx(Fr,{title:"Content Style",icon:_f,children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Font Family"}),u.jsx(Mn,{value:b.config.contentStyle.fontFamily,onChange:w=>{v("contentStyle",{fontFamily:w})},options:xy,className:"w-full"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Max Font Size (px)"}),u.jsx(xr,{type:"number",value:b.config.contentStyle.maxFontSize,onChange:w=>{v("contentStyle",{maxFontSize:parseInt(w.target.value)||24})},className:"h-8"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Color"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"color",value:b.config.contentStyle.color,onChange:w=>{v("contentStyle",{color:w.target.value})},className:"w-10 h-8 rounded cursor-pointer"}),u.jsx(xr,{value:b.config.contentStyle.color,onChange:w=>{v("contentStyle",{color:w.target.value})},className:"h-8 flex-1"})]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Wt,{checked:b.config.contentStyle.bold,onCheckedChange:w=>{v("contentStyle",{bold:!!w})},label:"Bold"}),u.jsx(Wt,{checked:b.config.contentStyle.italic,onCheckedChange:w=>{v("contentStyle",{italic:!!w})},label:"Italic"}),u.jsx(Wt,{checked:b.config.contentStyle.underline,onCheckedChange:w=>{v("contentStyle",{underline:!!w})},label:"Underline"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Horizontal Alignment"}),u.jsx("div",{className:"flex gap-2 mt-1",children:["left","center","right"].map(w=>u.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded ${b.config.contentStyle.alignment===w?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{v("contentStyle",{alignment:w})},children:w.charAt(0).toUpperCase()+w.slice(1)},w))})]}),u.jsx(Wt,{checked:b.config.contentStyle.shadow??!1,onCheckedChange:w=>{v("contentStyle",{shadow:!!w})},label:"Shadow"})]})}),"animationIn"in b.config&&u.jsx(Fr,{title:"Animation",icon:UD,defaultOpen:!1,children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400 mb-1 block",children:"Animation In"}),u.jsx(Mn,{value:b.config.animationIn.type,onChange:w=>{const S={...b.config.animationIn,type:w};g([...b.path,"animationIn"],S)},options:eT,className:"w-full mb-2"}),u.jsx("div",{className:"space-y-2",children:u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Duration (ms)"}),u.jsx(rb,{value:[b.config.animationIn.duration],onValueChange:([w])=>{const S={...b.config.animationIn,duration:w};g([...b.path,"animationIn"],S)},min:0,max:1e3,step:50})]})})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400 mb-1 block",children:"Animation Out"}),u.jsx(Mn,{value:b.config.animationOut.type,onChange:w=>{const S={...b.config.animationOut,type:w};g([...b.path,"animationOut"],S)},options:eT,className:"w-full mb-2"}),u.jsx("div",{className:"space-y-2",children:u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Duration (ms)"}),u.jsx(rb,{value:[b.config.animationOut.duration],onValueChange:([w])=>{const S={...b.config.animationOut,duration:w};g([...b.path,"animationOut"],S)},min:0,max:1e3,step:50})]})})]})]})}),n?.type==="clock"&&u.jsx(Fr,{title:"Clock Settings",icon:_p,children:u.jsxs("div",{className:"space-y-3",children:[u.jsx(Wt,{checked:b.config.showSeconds,onCheckedChange:w=>{g([...b.path,"showSeconds"],!!w)},label:"Show seconds"}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Format"}),u.jsx("div",{className:"flex gap-2 mt-1",children:["24h","12h"].map(w=>u.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded ${b.config.format===w?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{g([...b.path,"format"],w)},children:w},w))})]}),u.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[u.jsx(Wt,{checked:b.config.style.compressLines??!1,onCheckedChange:w=>{const S={...b.config.style,compressLines:!!w};g([...b.path,"style"],S)},label:f("screens.textStyle.compressLines")}),b.config.style.compressLines&&u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:f("screens.textStyle.lineSeparator")}),u.jsx(Mn,{value:b.config.style.lineSeparator??"space",onChange:w=>{const S={...b.config.style,lineSeparator:w};g([...b.path,"style"],S)},options:RK.map(w=>({value:w.value,label:f(`screens.textStyle.separators.${w.key}`)})),className:"w-full"})]}),u.jsx(Wt,{checked:b.config.style.fitLineToWidth??!1,onCheckedChange:w=>{const S={...b.config.style,fitLineToWidth:!!w};g([...b.path,"style"],S)},label:f("screens.textStyle.fitLineToWidth")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 ml-6",children:f("screens.textStyle.fitLineToWidthDescription")})]})]})}),"style"in b.config&&u.jsx(Fr,{title:f("screens.editor.previewText"),icon:ua,defaultOpen:!1,children:u.jsxs("div",{className:"space-y-3",children:[u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:f("screens.editor.previewTextDescription")}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:f("screens.editor.customPreviewText")}),u.jsx("textarea",{className:"w-full h-24 px-3 py-2 text-sm border rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:f("screens.editor.previewTextPlaceholder"),value:(()=>{if(!n||!r)return"";switch(n.type){case"mainText":case"contentText":return r.main??"";case"referenceText":return r.reference??"";case"personLabel":return r.person??"";default:return""}})(),onChange:w=>{if(!(!n||!s))switch(n.type){case"mainText":case"contentText":s("main",w.target.value);break;case"referenceText":s("reference",w.target.value);break;case"personLabel":s("person",w.target.value);break}}})]}),r&&(r.main||r.reference||r.person)&&u.jsx(it,{variant:"ghost",size:"sm",onClick:()=>i?.(),children:f("screens.editor.resetPreviewText")})]})})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-800/50",children:u.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-200",children:"Screen Settings"})}),u.jsx(Fr,{title:"Screen Size",icon:ui,children:u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Width (px)"}),u.jsx(xr,{type:"number",value:t.width,disabled:!0,className:"h-8"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Height (px)"}),u.jsx(xr,{type:"number",value:t.height,disabled:!0,className:"h-8"})]})]})}),u.jsx(Fr,{title:"Background",icon:Fj,children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Type"}),u.jsx(Mn,{value:p.background.type,onChange:w=>{o(e,{...p,background:{...p.background,type:w}})},options:AK,className:"w-full"})]}),p.background.type==="color"&&u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Color"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"color",value:p.background.color??"#000000",onChange:w=>{o(e,{...p,background:{...p.background,color:w.target.value}})},className:"w-10 h-8 rounded cursor-pointer"}),u.jsx(xr,{value:p.background.color??"#000000",onChange:w=>{o(e,{...p,background:{...p.background,color:w.target.value}})},className:"h-8 flex-1"})]})]}),(p.background.type==="image"||p.background.type==="video")&&u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"URL"}),u.jsx(xr,{value:p.background.type==="image"?p.background.imageUrl??"":p.background.videoUrl??"",onChange:w=>{o(e,{...p,background:{...p.background,...p.background.type==="image"?{imageUrl:w.target.value}:{videoUrl:w.target.value}}})},placeholder:"Enter URL...",className:"h-8"})]})]})}),(e==="bible"||e==="bible_passage")&&u.jsx(Fr,{title:f("screens.bibleOptions.title"),icon:ui,defaultOpen:!1,children:u.jsxs("div",{className:"space-y-3",children:[u.jsx(Wt,{checked:p.includeReferenceInContent??!1,onCheckedChange:w=>{o(e,{...p,includeReferenceInContent:!!w})},label:f("screens.bibleOptions.includeReferenceInContent")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 ml-6",children:f("screens.bibleOptions.includeReferenceInContentDescription")})]})}),u.jsx(Fr,{title:"Clock",icon:_f,defaultOpen:!1,children:u.jsxs("div",{className:"space-y-3",children:[u.jsx(Wt,{checked:t.globalSettings.clockEnabled,onCheckedChange:w=>{d({...t.globalSettings,clockEnabled:!!w})},label:"Show clock on all slides"}),t.globalSettings.clockEnabled&&t.globalSettings.clockConfig&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Format"}),u.jsx("div",{className:"flex gap-2 mt-1",children:["24h","12h"].map(w=>u.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded ${t.globalSettings.clockConfig?.format===w?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{d({...t.globalSettings,clockConfig:{...t.globalSettings.clockConfig,format:w}})},children:w},w))})]}),u.jsx(Wt,{checked:t.globalSettings.clockConfig.showSeconds,onCheckedChange:w=>{d({...t.globalSettings,clockConfig:{...t.globalSettings.clockConfig,showSeconds:!!w}})},label:"Show seconds"})]})]})})]})})}const OK=[{value:"song",label:"Song"},{value:"bible",label:"Bible Verse"},{value:"bible_passage",label:"Bible Passage"},{value:"announcement",label:"Announcement"},{value:"versete_tineri",label:"Versete Tineri"},{value:"empty",label:"Empty / Clock"}];function DK({screen:t,onSave:e,onClose:n}){const[r,s]=TK(),{send:i}=Xl(),o=Le(),l=C.useRef(0),d=C.useRef(!1),f=C.useRef(0),p=C.useRef(0);C.useEffect(()=>{s.setScreen(t),p.current=Date.now()},[]),C.useEffect(()=>{const S=Lu(t.id),T=o.getQueryCache().subscribe(j=>{if(j.type==="updated"&&j.query.queryKey[0]===S[0]&&j.query.queryKey[1]===S[1]){if(f.current>p.current){p.current=f.current;return}if(d.current){d.current=!1;return}const M=j.query.state.data;M&&(s.setScreenExternal(M),p.current=Date.now())}});return()=>T()},[t.id,o,s]),C.useEffect(()=>{if(!r.screen||!r.isDirty)return;const S=()=>{d.current=!0,i({type:"screen_config_preview",payload:{screenId:r.screen.id,config:r.screen}}),l.current=Date.now()},j=Date.now()-l.current;if(j<100){const M=setTimeout(S,100-j);return()=>clearTimeout(M)}S()},[r.screen,r.isDirty,i]);const g=C.useCallback(()=>{s.setZoom(Math.min(r.zoom+.25,2))},[r.zoom,s]),y=C.useCallback(()=>{s.setZoom(Math.max(r.zoom-.25,.5))},[r.zoom,s]),m=C.useCallback(()=>{s.setZoom(1)},[s]),b=C.useCallback(async()=>{if(r.screen){f.current=Date.now();try{await e(r.screen),s.markClean(),p.current=f.current,i({type:"screen_config_preview",payload:{screenId:r.screen.id,config:r.screen}})}catch{throw f.current=p.current,new Error("Save failed")}}},[r.screen,e,s,i]),v=C.useCallback(()=>{r.screen&&i({type:"screen_config_preview",payload:{screenId:r.screen.id,config:t}}),n()},[r.screen,t,i,n]),w=C.useCallback((S,T)=>{if(!r.screen)return;const M={...r.screen.contentConfigs[r.selectedContentType]};if(S==="mainText"&&"mainText"in M)M.mainText={...M.mainText,...T.constraints&&{constraints:T.constraints},...T.size&&{size:T.size}};else if(S==="contentText"&&"contentText"in M)M.contentText={...M.contentText,...T.constraints&&{constraints:T.constraints},...T.size&&{size:T.size}};else if(S==="referenceText"&&"referenceText"in M)M.referenceText={...M.referenceText,...T.constraints&&{constraints:T.constraints},...T.size&&{size:T.size}};else if(S==="personLabel"&&"personLabel"in M)M.personLabel={...M.personLabel,...T.constraints&&{constraints:T.constraints},...T.size&&{size:T.size}};else if(S==="clock"&&"clock"in M&&M.clock)M.clock={...M.clock,...T.constraints&&{constraints:T.constraints},...T.size&&{size:T.size}};else if(S==="nextSlide"&&r.screen.nextSlideConfig){s.updateNextSlideConfig({...r.screen.nextSlideConfig,...T.constraints&&{constraints:T.constraints},...T.size&&{size:T.size}});return}s.updateContentConfig(r.selectedContentType,M)},[r.screen,r.selectedContentType,s]);return r.screen?u.jsxs("div",{className:"flex flex-col h-full bg-gray-50 dark:bg-gray-950",children:[u.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:r.screen.name}),u.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 capitalize",children:r.screen.type})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Preview:"}),u.jsx(Mn,{value:r.selectedContentType,onChange:S=>{s.setSelectedContentType(S),s.clearSelection()},options:OK,className:"w-48"})]}),u.jsxs("div",{className:"flex items-center gap-1 border-l border-gray-200 dark:border-gray-700 pl-4",children:[u.jsx(it,{variant:"ghost",size:"icon",onClick:y,disabled:r.zoom<=.5,children:u.jsx(j6,{className:"w-4 h-4"})}),u.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 w-12 text-center",children:[Math.round(r.zoom*100),"%"]}),u.jsx(it,{variant:"ghost",size:"icon",onClick:g,disabled:r.zoom>=2,children:u.jsx(N6,{className:"w-4 h-4"})}),u.jsx(it,{variant:"ghost",size:"icon",onClick:m,children:u.jsx(KI,{className:"w-4 h-4"})})]}),u.jsxs("div",{className:"flex items-center gap-2 border-l border-gray-200 dark:border-gray-700 pl-4",children:[u.jsxs(it,{variant:"primary",onClick:b,disabled:!r.isDirty,children:[u.jsx(rd,{className:"w-4 h-4 mr-2"}),"Save"]}),u.jsx(it,{variant:"ghost",onClick:v,children:u.jsx(nt,{className:"w-4 h-4"})})]})]})]}),u.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[u.jsx(EK,{screen:r.screen,contentType:r.selectedContentType,selectedElement:r.selectedElement,zoom:r.zoom,previewTexts:r.previewTexts[r.selectedContentType],onSelectElement:s.setSelectedElement,onUpdateElement:w}),u.jsx(_K,{screen:r.screen,contentType:r.selectedContentType,selectedElement:r.selectedElement,previewTexts:r.previewTexts[r.selectedContentType],onSetPreviewText:(S,T)=>s.setPreviewText(r.selectedContentType,S,T),onResetPreviewTexts:()=>s.resetPreviewTexts(r.selectedContentType),onUpdateContentConfig:s.updateContentConfig,onUpdateNextSlideConfig:s.updateNextSlideConfig,onUpdateGlobalSettings:s.updateGlobalSettings})]})]}):u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading..."})})}const cA=C.forwardRef(({checked:t=!1,onCheckedChange:e,disabled:n,className:r="",id:s},i)=>{const o=s||`switch-${Math.random().toString(36).slice(2,9)}`;return u.jsx("button",{ref:i,type:"button",role:"switch","aria-checked":t,id:o,disabled:n,onClick:()=>e?.(!t),className:`
          relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent
          transition-colors duration-200 ease-in-out
          focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-gray-900
          ${t?"bg-indigo-600":"bg-gray-200 dark:bg-gray-700"}
          ${n?"opacity-50 cursor-not-allowed":""}
          ${r}
        `,children:u.jsx("span",{className:`
            pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0
            transition duration-200 ease-in-out
            ${t?"translate-x-5":"translate-x-0"}
          `})})});cA.displayName="Switch";const IK=[{value:"primary",label:"Primary / Audience"},{value:"stage",label:"Stage Monitor"},{value:"livestream",label:"Live Stream"}],LK={primary:"bg-blue-600",stage:"bg-purple-600",livestream:"bg-green-600"};function zK(){const{showToast:t}=mt(),{data:e,isLoading:n}=Ub(),r=$E(),s=eP(),i=Zz(),[o,l]=C.useState(!1),[d,f]=C.useState(""),[p,g]=C.useState("primary"),[y,m]=C.useState(null),[b,v]=C.useState(null),[w,S]=C.useState(new Set),{data:T}=qb(y),j=()=>{f(""),g("primary"),l(!0)},M=async()=>{if(d.trim())try{const B=await r.mutateAsync({name:d.trim(),type:p});l(!1),B&&m(B.id),t("Screen created successfully","success")}catch{t("Failed to create screen","error")}},_=B=>{m(B.id)},R=C.useCallback(async B=>{try{await i.mutateAsync({screenId:B.id,globalSettings:B.globalSettings,contentConfigs:B.contentConfigs,nextSlideConfig:B.type==="stage"?B.nextSlideConfig:void 0}),t("Screen saved successfully","success")}catch{t("Failed to save screen","error")}},[i,t]),O=()=>{m(null)},L=B=>{v(B)},A=async B=>{const E=w.has(B.id);try{E?(await fC(B.id),S(K=>{const q=new Set(K);return q.delete(B.id),q}),t(`Window "${B.name}" closed`,"success")):(await zE(B.id,"native",B.isFullscreen,B.name),S(K=>new Set(K).add(B.id)),t(`Window "${B.name}" opened`,"success"))}catch{t("Failed to toggle window","error")}},F=async B=>{const E=`${mx()}/screen/${B.id}`;try{await navigator.clipboard.writeText(E),t("URL copied to clipboard","success")}catch{t("Failed to copy URL","error")}},H=async B=>{const E=`${mx()}/screen/${B.id}`;await Wz(E)},P=async()=>{if(b)try{await fC(b.id),S(B=>{const E=new Set(B);return E.delete(b.id),E}),await s.mutateAsync(b.id),v(null),t("Screen deleted successfully","success")}catch{t("Failed to delete screen","error")}};return n?u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600"})}):y&&T?u.jsx("div",{className:"fixed inset-0 z-50 bg-gray-50 dark:bg-gray-950",children:u.jsx(DK,{screen:T,onSave:R,onClose:O})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(Sh,{size:24,className:"text-indigo-600"}),u.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Screens"})]}),u.jsxs(it,{onClick:j,variant:"primary",children:[u.jsx(Xt,{size:20,className:"mr-2"}),"Add Screen"]})]}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Configure screens for different display purposes. Each screen type has its own layout and configuration options."}),e&&e.length>0?u.jsx("div",{className:"space-y-3",children:e.map(B=>u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 p-3 md:p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[u.jsx("div",{className:`w-3 h-3 rounded-full flex-shrink-0 ${w.has(B.id)?"bg-green-500":"bg-gray-400"}`}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate",children:B.name}),u.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[u.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full text-white ${LK[B.type]}`,children:B.type}),u.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[B.width,"",B.height]})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2 md:gap-3 flex-wrap",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 hidden md:inline",children:w.has(B.id)?"Open":"Closed"}),u.jsx(cA,{checked:w.has(B.id),onCheckedChange:()=>A(B)})]}),u.jsx("div",{className:"hidden md:block h-6 w-px bg-gray-200 dark:bg-gray-700"}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(it,{variant:"ghost",size:"sm",onClick:()=>H(B),title:"Open in new tab",children:u.jsx(Dp,{size:16})}),u.jsx(it,{variant:"ghost",size:"sm",onClick:()=>F(B),title:"Copy URL to clipboard",children:u.jsx(td,{size:16})}),u.jsxs(it,{variant:"secondary",size:"sm",onClick:()=>_(B),title:"Edit screen",children:[u.jsx(Hj,{size:16}),u.jsx("span",{className:"hidden md:inline ml-1",children:"Edit"})]}),u.jsx(it,{variant:"ghost",size:"sm",onClick:()=>L(B),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",title:"Delete screen",children:u.jsx(Bn,{size:16})})]})]})]},B.id))}):u.jsxs("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsx(Sh,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-4"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No screens configured"}),u.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Add your first screen to configure how content is displayed."}),u.jsxs(it,{onClick:j,variant:"primary",children:[u.jsx(Xt,{size:20,className:"mr-2"}),"Add First Screen"]})]}),o&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md mx-4 p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Add New Screen"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Screen Name"}),u.jsx("input",{type:"text",value:d,onChange:B=>f(B.target.value),placeholder:"e.g., Main Projector",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",autoFocus:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Screen Type"}),u.jsx(Mn,{value:p,onChange:B=>g(B),options:IK,className:"w-full"})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[u.jsx(it,{variant:"ghost",onClick:()=>l(!1),children:"Cancel"}),u.jsxs(it,{variant:"primary",onClick:M,disabled:!d.trim()||r.isPending,children:[r.isPending&&u.jsx(Qe,{size:16,className:"animate-spin mr-2"}),"Create & Configure"]})]})]})}),b&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-sm mx-4 p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Screen?"}),u.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:['Are you sure you want to delete "',b.name,'"? This action cannot be undone.']}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx(it,{variant:"ghost",onClick:()=>v(null),children:"Cancel"}),u.jsxs(it,{variant:"danger",onClick:P,disabled:s.isPending,children:[s.isPending&&u.jsx(Qe,{size:16,className:"animate-spin mr-2"}),"Delete"]})]})]})})]})}function PK({songId:t,onPrevSlide:e,onNextSlide:n,canNavigatePrev:r,canNavigateNext:s}){const{t:i}=ke(["songs","bible"]);Xl();const{data:o}=fi(),l=UE(),d=FE(),f=o?.temporaryContent?.type==="song"&&o.temporaryContent.data.songId===t,g=!(o?.isHidden??!0)&&f,y=async()=>{await l.mutateAsync()},m=async()=>{f?await d.mutateAsync({direction:"prev"}):e()},b=async()=>{f?await d.mutateAsync({direction:"next"}):n()};return u.jsxs("div",{className:"flex flex-col lg:h-full bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"flex items-center justify-end p-2 lg:p-3 border-b border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-md ${g?"bg-red-100 dark:bg-red-900/30":"bg-gray-100 dark:bg-gray-700"}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${g?"bg-red-500 animate-pulse":"bg-gray-400 dark:bg-gray-500"}`}),u.jsx("span",{className:`text-xs font-semibold ${g?"text-red-600 dark:text-red-400":"text-gray-400 dark:text-gray-500"}`,children:"LIVE"})]}),g?u.jsxs("button",{type:"button",onClick:y,disabled:l.isPending,className:"flex items-center gap-1.5 px-2 lg:px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 transition-colors",title:`${i("bible:controls.hide")} (Esc)`,children:[l.isPending?u.jsx(Qe,{size:18,className:"animate-spin"}):u.jsx(Wl,{size:18}),u.jsx("span",{className:"hidden sm:inline",children:i("bible:controls.hide")}),u.jsx("span",{className:"text-xs opacity-75 hidden sm:inline",children:"(Esc)"})]}):u.jsxs("button",{type:"button",disabled:!0,className:"flex items-center gap-1.5 px-2 lg:px-3 py-1.5 text-sm text-gray-400 dark:text-gray-500 rounded-lg border border-gray-300 dark:border-gray-600 opacity-50 cursor-not-allowed",children:[u.jsx(ua,{size:18}),u.jsx("span",{className:"hidden sm:inline",children:i("bible:controls.show")})]})]})}),u.jsxs("div",{className:"p-2 lg:p-3 lg:flex-1 lg:min-h-0 flex flex-col",children:[u.jsx("div",{className:"w-full lg:flex-1 lg:min-h-0 lg:flex lg:items-center lg:justify-center",children:u.jsx(Yv,{})}),u.jsxs("div",{className:"flex items-center justify-center gap-2 pt-2 lg:pt-3 flex-shrink-0",children:[u.jsxs("button",{type:"button",onClick:m,disabled:!r||d.isPending||l.isPending,className:"flex items-center gap-1.5 px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",title:i("bible:controls.prev"),children:[u.jsx(Sb,{size:18}),u.jsx("span",{className:"text-sm",children:i("bible:controls.prev")})]}),u.jsxs("button",{type:"button",onClick:b,disabled:!s||d.isPending||l.isPending,className:"flex items-center gap-1.5 px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",title:i("bible:controls.next"),children:[u.jsx("span",{className:"text-sm",children:i("bible:controls.next")}),u.jsx(Es,{size:18})]})]})]})]})}function BK({slide:t,index:e,onContentChange:n,onClone:r,onDelete:s}){const{t:i}=ke("songs"),{attributes:o,listeners:l,setNodeRef:d,transform:f,transition:p,isDragging:g}=xo({id:t.id}),y={transform:cs.Transform.toString(f),transition:p},m=Dv({extensions:[Kv.configure({heading:{levels:[1,2,3]}}),_v.configure({types:["heading","paragraph"]})],content:t.content,editorProps:{attributes:{class:"min-h-[100px] p-4 focus:outline-none",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}},onUpdate:({editor:b})=>{n(b.getHTML())}});return C.useEffect(()=>{m&&t.content!==m.getHTML()&&m.commands.setContent(t.content)},[m,t.content]),u.jsxs("div",{ref:d,style:y,className:`bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden ${g?"opacity-50 shadow-lg":""}`,children:[u.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",...o,...l,className:"cursor-grab active:cursor-grabbing p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",children:u.jsx(or,{className:"w-4 h-4 text-gray-400"})}),u.jsxs("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:[i("editor.slideNumber",{number:e+1}),t.label&&u.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-indigo-100 dark:bg-indigo-900/50 text-indigo-700 dark:text-indigo-300 rounded text-xs font-semibold",children:t.label})]})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{type:"button",onClick:r,className:"p-1.5 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",title:i("actions.cloneSlide"),children:u.jsx(td,{className:"w-4 h-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"})}),u.jsx("button",{type:"button",onClick:s,className:"p-1.5 hover:bg-red-100 dark:hover:bg-red-900/20 rounded transition-colors",title:i("actions.delete"),children:u.jsx(Bn,{className:"w-4 h-4 text-gray-400 hover:text-red-500"})})]})]}),u.jsxs("div",{className:"flex items-center gap-1 px-3 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:()=>m?.chain().focus().toggleBold().run(),className:`px-2.5 py-1 rounded text-sm font-bold ${m?.isActive("bold")?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:"B"}),u.jsx("button",{type:"button",onClick:()=>m?.chain().focus().toggleItalic().run(),className:`px-2.5 py-1 rounded text-sm font-medium italic ${m?.isActive("italic")?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:"I"}),u.jsx("div",{className:"w-px h-5 bg-gray-300 dark:bg-gray-600 mx-1"}),u.jsx("button",{type:"button",onClick:()=>m?.chain().focus().toggleHeading({level:1}).run(),className:`px-2.5 py-1 rounded text-sm font-medium ${m?.isActive("heading",{level:1})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:"H1"}),u.jsx("button",{type:"button",onClick:()=>m?.chain().focus().toggleHeading({level:2}).run(),className:`px-2.5 py-1 rounded text-sm font-medium ${m?.isActive("heading",{level:2})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:"H2"}),u.jsx("div",{className:"w-px h-5 bg-gray-300 dark:bg-gray-600 mx-1"}),u.jsx("button",{type:"button",onClick:()=>m?.chain().focus().setTextAlign("left").run(),className:`px-2.5 py-1 rounded text-sm ${m?.isActive({textAlign:"left"})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:""}),u.jsx("button",{type:"button",onClick:()=>m?.chain().focus().setTextAlign("center").run(),className:`px-2.5 py-1 rounded text-sm ${m?.isActive({textAlign:"center"})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:""}),u.jsx("button",{type:"button",onClick:()=>m?.chain().focus().setTextAlign("right").run(),className:`px-2.5 py-1 rounded text-sm ${m?.isActive({textAlign:"right"})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:""}),u.jsx("div",{className:"w-px h-5 bg-gray-300 dark:bg-gray-600 mx-1"}),u.jsx("button",{type:"button",onClick:()=>m?.chain().focus().undo().run(),disabled:!m?.can().undo(),className:"p-1.5 rounded text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed",title:i("editor.undo"),children:u.jsx(d6,{className:"w-4 h-4"})}),u.jsx("button",{type:"button",onClick:()=>m?.chain().focus().redo().run(),disabled:!m?.can().redo(),className:"p-1.5 rounded text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed",title:i("editor.redo"),children:u.jsx(qI,{className:"w-4 h-4"})})]}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50",children:u.jsx(Ov,{editor:m,className:"prose prose-sm dark:prose-invert max-w-none [&_.ProseMirror]:text-gray-900 [&_.ProseMirror]:dark:text-gray-100"})})]})}function uA({slides:t,onSlidesChange:e}){const{t:n}=ke("songs"),[r,s]=C.useState(null),i=ho(sr(pi),sr(hi,{coordinateGetter:bo})),o=g=>{const{active:y,over:m}=g;if(m&&y.id!==m.id){const b=t.findIndex(S=>S.id===y.id),v=t.findIndex(S=>S.id===m.id),w=tc(t,b,v).map((S,T)=>({...S,sortOrder:T}));e(w)}},l=()=>{const g={id:`temp-${Date.now()}`,content:"",sortOrder:t.length};e([...t,g])},d=(g,y)=>{const m=t.map(b=>b.id===g?{...b,content:y}:b);e(m)},f=g=>{const y=t.findIndex(v=>v.id===g.id),m={id:`temp-${Date.now()}`,content:g.content,sortOrder:y+1},b=[...t.slice(0,y+1),m,...t.slice(y+1)].map((v,w)=>({...v,sortOrder:w}));e(b)},p=()=>{if(!r)return;const g=t.filter(y=>y.id!==r.id).map((y,m)=>({...y,sortOrder:m}));e(g),s(null)};return u.jsxs("div",{className:"space-y-4",children:[t.length>0?u.jsx(go,{sensors:i,collisionDetection:po,onDragEnd:o,children:u.jsx(yo,{items:t.map(g=>g.id),strategy:mo,children:u.jsx("div",{className:"space-y-3",children:t.map((g,y)=>u.jsx(BK,{slide:g,index:y,onContentChange:m=>d(g.id,m),onClone:()=>f(g),onDelete:()=>s(g)},g.id))})})}):u.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg",children:[u.jsx(zD,{className:"w-10 h-10 text-gray-400 mb-3"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n("editor.noSlides")})]}),u.jsxs("button",{type:"button",onClick:l,className:"w-full flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-400 hover:border-indigo-400 hover:text-indigo-600 dark:hover:border-indigo-500 dark:hover:text-indigo-400 transition-colors",children:[u.jsx(Xt,{size:20}),n("actions.addSlide")]}),u.jsx(di,{isOpen:!!r,onCancel:()=>s(null),onConfirm:p,title:n("modal.deleteSlideTitle"),message:n("modal.deleteSlideMessage"),confirmLabel:n("actions.delete"),cancelLabel:n("common:buttons.cancel","Cancel"),variant:"danger"})]})}const FK={author:null,copyright:null,ccli:null,key:null,tempo:null,timeSignature:null,theme:null,altTheme:null,hymnNumber:null,keyLine:null,presentationOrder:null,sourceFilename:null};function UK({isNew:t,isLoading:e,isSaving:n,isDeleting:r,isDirty:s=!0,songId:i,title:o,categoryId:l,slides:d,metadata:f=FK,presentationCount:p=0,lastManualEdit:g,onTitleChange:y,onCategoryChange:m,onSlidesChange:b,onMetadataChange:v,onSave:w,onDelete:S,onBack:T}){const{t:j}=ke(["songs","queue"]),M=ar(),{showToast:_}=mt(),[R,O]=C.useState(!1),[L,A]=C.useState(!1),[F,H]=C.useState(!1),[P,B]=C.useState(!1),[E,K]=C.useState(null),[q,V]=C.useState(!1),ie=C.useRef(null),Y=BE();C.useEffect(()=>{P?ie.current?.showModal():ie.current?.close()},[P]);const X=async()=>{if(i)try{await Y.mutateAsync({songId:i,slideIndex:0}),_(j("queue:messages.presenting"),"success"),M({to:"/songs/$songId",params:{songId:String(i)}})}catch{_(j("queue:messages.error"),"error")}},I=()=>{i&&(s?(K("present"),B(!0)):X())},U=()=>{i&&(s?(K("addToSchedule"),B(!0)):H(!0))},te=async()=>{V(!0);const Se=await w();V(!1),B(!1),Se&&(E==="present"?X():E==="addToSchedule"&&H(!0)),K(null)},Z=()=>{B(!1),E==="present"?X():E==="addToSchedule"&&H(!0),K(null)},re=()=>{B(!1),K(null)},se=Se=>{M({to:"/schedules/$scheduleId",params:{scheduleId:String(Se)}})},ge=Se=>{const Oe=Se.map((He,ut)=>({id:`temp-${Date.now()}-${ut}`,content:`<p>${He.replace(/\n/g,"<br>")}</p>`,sortOrder:d.length+ut}));b([...d,...Oe])},be=(Se,Oe)=>{v&&v(Se,Oe||null)},me=f.author||f.hymnNumber||f.key;return u.jsxs("div",{className:"space-y-6 [scrollbar-gutter:stable] [scrollbar-width:none] [&::-webkit-scrollbar]:hidden",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{type:"button",onClick:T,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:u.jsx(ed,{size:20,className:"text-gray-600 dark:text-gray-400"})}),u.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e?u.jsx("span",{className:"inline-block w-48 h-8 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}):t?j("actions.create"):o||j("editor.titlePlaceholder")})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[!t&&i&&u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:U,disabled:e,className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50 transition-colors",title:j("songs:actions.addToSchedule"),children:[u.jsx(bh,{size:20}),u.jsx("span",{className:"hidden sm:inline",children:j("songs:actions.addToSchedule")})]}),u.jsxs("button",{type:"button",onClick:I,disabled:e||Y.isPending,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors",title:j("queue:actions.presentNow"),children:[u.jsx(kb,{size:20}),u.jsx("span",{className:"hidden sm:inline",children:j("queue:actions.presentNow")})]})]}),!t&&S&&u.jsx("button",{type:"button",onClick:S,disabled:r||e,className:"p-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors disabled:opacity-50",title:j("songs:actions.delete"),children:r?u.jsx(Qe,{size:20,className:"animate-spin"}):u.jsx(Bn,{size:20})}),u.jsxs("button",{type:"button",onClick:w,disabled:n||e||!o.trim()||!s,className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors",children:[n?u.jsx(Qe,{size:20,className:"animate-spin"}):u.jsx(rd,{size:20}),j("songs:actions.save")]})]})]}),u.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("editor.titlePlaceholder").replace("...","")}),e?u.jsx("div",{className:"w-full h-10 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}):u.jsx("input",{id:"title",type:"text",value:o,onChange:Se=>y(Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white",placeholder:j("editor.titlePlaceholder")})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"keyLine",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.keyLine")}),e?u.jsx("div",{className:"w-full h-10 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}):u.jsx("input",{id:"keyLine",type:"text",value:f.keyLine||"",onChange:Se=>be("keyLine",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white",placeholder:j("metadata.keyLinePlaceholder")})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("category.name")}),e?u.jsx("div",{className:"w-full h-10 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}):u.jsx(Bp,{value:l,onChange:m})]}),u.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[u.jsxs("button",{type:"button",onClick:()=>A(!L),className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",children:[L?u.jsx(Sb,{size:16}):u.jsx(Es,{size:16}),j("metadata.detailsSection"),!L&&me&&u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:[f.author,f.hymnNumber&&`#${f.hymnNumber}`,f.key].filter(Boolean).join("  ")})]}),L&&!e&&u.jsxs("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"author",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.author")}),u.jsx("input",{id:"author",type:"text",value:f.author||"",onChange:Se=>be("author",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"copyright",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.copyright")}),u.jsx("input",{id:"copyright",type:"text",value:f.copyright||"",onChange:Se=>be("copyright",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"ccli",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.ccli")}),u.jsx("input",{id:"ccli",type:"text",value:f.ccli||"",onChange:Se=>be("ccli",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"hymnNumber",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.hymnNumber")}),u.jsx("input",{id:"hymnNumber",type:"text",value:f.hymnNumber||"",onChange:Se=>be("hymnNumber",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"key",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.key")}),u.jsx("input",{id:"key",type:"text",value:f.key||"",onChange:Se=>be("key",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm",placeholder:j("metadata.keyPlaceholder")})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"tempo",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.tempo")}),u.jsx("input",{id:"tempo",type:"text",value:f.tempo||"",onChange:Se=>be("tempo",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"timeSignature",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.timeSignature")}),u.jsx("input",{id:"timeSignature",type:"text",value:f.timeSignature||"",onChange:Se=>be("timeSignature",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"theme",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.theme")}),u.jsx("input",{id:"theme",type:"text",value:f.theme||"",onChange:Se=>be("theme",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"altTheme",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.altTheme")}),u.jsx("input",{id:"altTheme",type:"text",value:f.altTheme||"",onChange:Se=>be("altTheme",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),f.sourceFilename&&u.jsxs("div",{className:"sm:col-span-2",children:[u.jsx("label",{htmlFor:"sourceFilename",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.sourceFilename")}),u.jsx("input",{id:"sourceFilename",type:"text",value:f.sourceFilename||"",readOnly:!0,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-400 text-sm cursor-not-allowed"})]}),f.presentationOrder&&u.jsxs("div",{className:"sm:col-span-2",children:[u.jsx("label",{htmlFor:"presentationOrder",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.presentationOrder")}),u.jsx("input",{id:"presentationOrder",type:"text",value:f.presentationOrder||"",readOnly:!0,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-400 text-sm cursor-not-allowed"})]}),!t&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"presentationCount",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.presentationCount")}),u.jsx("input",{id:"presentationCount",type:"text",value:p,readOnly:!0,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-400 text-sm cursor-not-allowed"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"lastManualEdit",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.lastManualEdit")}),u.jsx("input",{id:"lastManualEdit",type:"text",value:g?new Date(g).toLocaleString():j("metadata.neverEdited"),readOnly:!0,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-400 text-sm cursor-not-allowed"})]})]})]})]})]})}),u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[u.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-gray-50 dark:bg-gray-900/50 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[j("editor.slides")," (",e?"-":d.length,")"]}),u.jsxs("button",{type:"button",onClick:()=>O(!0),disabled:e,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 rounded-lg transition-colors disabled:opacity-50",children:[u.jsx(Ru,{className:"w-5 h-5"}),j("actions.importFromText")]})]}),u.jsx("div",{className:"p-6 bg-gray-100 dark:bg-gray-900/30",children:e?u.jsxs("div",{className:"space-y-3",children:[u.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}),u.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"})]}):u.jsx(uA,{slides:d,onSlidesChange:b})})]}),u.jsx(_P,{isOpen:R,onClose:()=>O(!1),onImport:ge}),i&&u.jsx(Wv,{isOpen:F,songId:i,onClose:()=>H(!1),onAdded:se}),u.jsx("dialog",{ref:ie,className:"fixed inset-0 m-auto w-full max-w-md p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:Se=>{Se.target===ie.current&&!q&&re()},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:j(q?"songs:actions.save":"songs:modal.unsavedChangesTitle")}),!q&&u.jsx("button",{type:"button",onClick:re,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsx("div",{className:"p-4",children:q?u.jsxs("div",{className:"flex flex-col items-center justify-center py-4 gap-3",children:[u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:j("songs:messages.saving")})]}):u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:j("songs:modal.unsavedBeforeActionMessage")})}),!q&&u.jsxs("div",{className:"flex flex-col gap-2 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:te,className:"w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors",children:j("songs:modal.saveAndContinue")}),u.jsx("button",{type:"button",onClick:Z,className:"w-full px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:j("songs:modal.continueWithoutSaving")}),u.jsx("button",{type:"button",onClick:re,className:"w-full px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors",children:j("songs:modal.cancel")})]})]})})]})}const $K={author:null,copyright:null,ccli:null,key:null,tempo:null,timeSignature:null,theme:null,altTheme:null,hymnNumber:null,keyLine:null,presentationOrder:null,sourceFilename:null};function dA({isOpen:t,onClose:e,songId:n,onSaved:r}){const{t:s}=ke(["songs","common"]),{showToast:i}=mt(),o=C.useRef(null),{data:l,isLoading:d}=Hb(n),f=Kb(),[p,g]=C.useState(""),[y,m]=C.useState(null),[b,v]=C.useState([]),[w,S]=C.useState($K),[T,j]=C.useState(!1);C.useEffect(()=>{l&&t&&(g(l.title),m(l.categoryId),v(l.slides.map(L=>({id:L.id,content:L.content,sortOrder:L.sortOrder,label:L.label}))),S({author:l.author,copyright:l.copyright,ccli:l.ccli,key:l.key,tempo:l.tempo,timeSignature:l.timeSignature,theme:l.theme,altTheme:l.altTheme,hymnNumber:l.hymnNumber,keyLine:l.keyLine,presentationOrder:l.presentationOrder,sourceFilename:l.sourceFilename}),j(!0))},[l,t]),C.useEffect(()=>{t||j(!1)},[t]),C.useEffect(()=>{t?o.current?.showModal():o.current?.close()},[t]);const M=C.useCallback(async()=>{if(!p.trim())return;const L=await f.mutateAsync({id:n,title:p.trim(),categoryId:y,slides:b.map((A,F)=>({id:typeof A.id=="number"?A.id:void 0,content:A.content,sortOrder:F,label:A.label})),author:w.author,copyright:w.copyright,ccli:w.ccli,key:w.key,tempo:w.tempo,timeSignature:w.timeSignature,theme:w.theme,altTheme:w.altTheme,hymnNumber:w.hymnNumber,keyLine:w.keyLine,presentationOrder:w.presentationOrder});L.success&&L.data?(i(s("songs:messages.saved"),"success"),v(L.data.slides.map(A=>({id:A.id,content:A.content,sortOrder:A.sortOrder,label:A.label}))),S({author:L.data.author,copyright:L.data.copyright,ccli:L.data.ccli,key:L.data.key,tempo:L.data.tempo,timeSignature:L.data.timeSignature,theme:L.data.theme,altTheme:L.data.altTheme,hymnNumber:L.data.hymnNumber,keyLine:L.data.keyLine,presentationOrder:L.data.presentationOrder}),r?.(),e()):i(s("songs:messages.error"),"error")},[p,y,b,w,n,f,i,s,r,e]);C.useEffect(()=>{if(!t)return;const L=A=>{(A.metaKey||A.ctrlKey)&&A.key==="s"&&(A.preventDefault(),f.isPending||M())};return document.addEventListener("keydown",L),()=>document.removeEventListener("keydown",L)},[t,M,f.isPending]);const _=()=>{f.isPending||e()},R=L=>{L.target===o.current&&_()},O=d||!T;return u.jsx("dialog",{ref:o,onCancel:_,onClick:R,className:"fixed inset-0 m-auto w-full max-w-4xl p-0 rounded-lg bg-white dark:bg-gray-800 backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:O?u.jsx("span",{className:"inline-block w-48 h-6 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}):p||s("songs:editor.titlePlaceholder")}),u.jsx("button",{type:"button",onClick:_,disabled:f.isPending,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"modal-title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:s("songs:editor.titlePlaceholder").replace("...","")}),O?u.jsx("div",{className:"w-full h-10 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}):u.jsx("input",{id:"modal-title",type:"text",value:p,onChange:L=>g(L.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white",placeholder:s("songs:editor.titlePlaceholder")})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:s("songs:category.name")}),O?u.jsx("div",{className:"w-full h-10 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}):u.jsx(Bp,{value:y,onChange:m})]})]}),u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:[s("songs:editor.slides")," (",O?"-":b.length,")"]}),O?u.jsxs("div",{className:"space-y-3",children:[u.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}),u.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"})]}):u.jsx(uA,{slides:b,onSlidesChange:v})]})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:_,disabled:f.isPending,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg disabled:opacity-50",children:s("common:buttons.cancel")}),u.jsxs("button",{type:"button",onClick:M,disabled:f.isPending||O||!p.trim(),className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:[f.isPending?u.jsx(Qe,{size:18,className:"animate-spin"}):u.jsx(rd,{size:18}),s("songs:actions.save")]})]})]})})}const by=50;function fA({onSongClick:t,searchQuery:e="",onSearchChange:n}){const{t:r}=ke("songs"),s=C.useRef(null),[i,o]=C.useState(e),{data:l,isLoading:d}=MP(),{data:f,isLoading:p}=jP(i),{data:g}=Pp();C.useEffect(()=>{o(e)},[e]),C.useEffect(()=>{s.current?.focus()},[]);const y=i.length>0,m=y?p:d,{displaySongs:b,totalCount:v}=C.useMemo(()=>{let T;return y&&f?T=f.map(j=>({id:j.id,title:j.title,categoryId:j.categoryId,categoryName:j.categoryName,highlightedTitle:j.highlightedTitle,matchedContent:j.matchedContent})):T=l?.map(j=>({id:j.id,title:j.title,categoryId:j.categoryId,categoryName:g?.find(M=>M.id===j.categoryId)?.name??null}))??[],{displaySongs:T.slice(0,by),totalCount:T.length}},[y,f,l,g]),w=T=>{const j=T.target.value;o(j),n?.(j)},S=v>by;return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Yl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{ref:s,type:"text",value:i,onChange:w,placeholder:r("search.placeholder"),className:"w-full pl-10 pr-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors"})]}),m?u.jsx("div",{className:"grid gap-3",children:[1,2,3].map(T=>u.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"},T))}):b.length===0?u.jsxs("div",{className:"text-center py-12 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx(ha,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:y?r("search.noResults",{query:i}):r("noSongs")}),!y&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:r("noSongsDescription")})]}):u.jsxs("div",{className:"grid gap-3",children:[u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:y?r("search.resultsCount",{count:v}):r("search.showingCount",{showing:b.length,total:v})}),b.map(T=>u.jsx(OP,{song:T,onClick:()=>t(T.id)},T.id)),S&&u.jsx("p",{className:"text-center text-sm text-gray-400 dark:text-gray-500 py-2",children:r("search.moreResults",{count:v-by})})]})]})}function lg({isOpen:t,onClose:e,afterItemId:n,onSongAdded:r,onSongSelect:s,hideAddToQueue:i}){const{t:o}=ke(["queue","songs"]),{showToast:l}=mt(),d=C.useRef(null),f=S8(),[p,g]=C.useState(!1),m=!!(s||i)?p:f.isPending;C.useEffect(()=>{t?d.current?.showModal():d.current?.close()},[t]),C.useEffect(()=>{const w=d.current;if(!w)return;const S=T=>{T.preventDefault(),m||e()};return w.addEventListener("cancel",S),()=>w.removeEventListener("cancel",S)},[e,m]);const b=async w=>{if(s){g(!0);try{await s(w),e()}finally{g(!1)}return}(await f.mutateAsync({songId:w,afterItemId:n})).success?(l(o("queue:messages.added"),"success"),r?.(),e()):l(o("queue:messages.error"),"error")},v=()=>{m||e()};return u.jsx("dialog",{ref:d,className:"fixed inset-0 m-auto w-full max-w-lg p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:w=>{w.target===d.current&&v()},onKeyDown:w=>{w.key==="Escape"&&v()},children:u.jsxs("div",{className:"flex flex-col max-h-[80vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:o("queue:addToQueue.searchSong")}),u.jsx("button",{type:"button",onClick:v,disabled:m,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:m?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"})}):u.jsx(fA,{onSongClick:b})})]})})}const qK=100;function HK(t){const e=document.createElement("textarea");return e.innerHTML=t,e.value}function VK(t){const e=t.replace(/<\/p>\s*<p>/gi,`
`).replace(/<br\s*\/?>/gi,`
`).replace(/<[^>]*>/g,"").trim();return HK(e)}function KK({song:t,presentedSlideIndex:e,isLoading:n,onSlideClick:r}){const s=C.useRef(null),i=C.useRef(null);if(C.useEffect(()=>{if(s.current&&i.current){const l=i.current,f=s.current.getBoundingClientRect(),p=l.getBoundingClientRect(),g=f.top-p.top+l.scrollTop,y=Math.max(0,g-qK);l.scrollTo({top:y,behavior:"smooth"})}},[e]),n)return u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600 dark:text-indigo-400"})});const o=[...t.slides].sort((l,d)=>l.sortOrder-d.sortOrder);return u.jsx("div",{className:"flex flex-col h-full",children:u.jsx("div",{ref:i,className:"flex-1 min-h-0 space-y-1 overflow-hidden lg:overflow-y-auto px-0.5 py-0.5",children:o.map((l,d)=>{const f=d===e,p=d+1,g=()=>f?"bg-green-100 dark:bg-green-900/50 ring-2 ring-green-500":"hover:bg-gray-100 dark:hover:bg-gray-700",y=()=>f?"text-green-700 dark:text-green-300":"text-gray-500 dark:text-gray-400",m=()=>f?"text-green-900 dark:text-green-100":"text-gray-700 dark:text-gray-200",b=VK(l.content);return u.jsxs("button",{ref:f?s:null,type:"button",onClick:()=>r(l,d),className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${g()}`,children:[u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx("span",{className:`font-semibold text-sm min-w-[24px] ${y()}`,children:p}),u.jsx("span",{className:`text-sm whitespace-pre-line ${m()}`,children:b})]}),l.label&&u.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 ml-8 mt-1 block",children:l.label})]},l.id)})})})}function QK({synonym:t,onEdit:e,onDelete:n}){const{t:r}=ke("settings");return u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"flex-1 min-w-0",children:u.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.primary}),u.jsx(dD,{size:14,className:"text-gray-400 dark:text-gray-500 shrink-0"}),u.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:t.synonyms.join(", ")})]})}),u.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[u.jsx("button",{type:"button",onClick:e,className:"p-2 text-gray-500 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors",title:r("sections.synonyms.actions.edit"),children:u.jsx(Xa,{size:16})}),u.jsx("button",{type:"button",onClick:n,className:"p-2 text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors",title:r("sections.synonyms.actions.delete"),children:u.jsx(Bn,{size:16})})]})]})}function WK({isOpen:t,synonym:e,onSubmit:n,onCancel:r,isLoading:s}){const{t:i}=ke("settings"),o=C.useRef(null),l=C.useRef(null),[d,f]=C.useState(e?.primary??""),[p,g]=C.useState(e?.synonyms.join(", ")??"");C.useEffect(()=>{t?(o.current?.showModal(),l.current?.focus()):o.current?.close()},[t]),C.useEffect(()=>{f(e?.primary??""),g(e?.synonyms.join(", ")??"")},[e]);const y=b=>{if(b.preventDefault(),d.trim()&&p.trim()){const v=p.split(",").map(w=>w.trim().toLowerCase()).filter(w=>w.length>0);v.length>0&&n(d.trim().toLowerCase(),v)}},m=b=>{b.target===o.current&&r()};return u.jsx("dialog",{ref:o,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-md w-full",onClose:r,onClick:m,children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:i(e?"sections.synonyms.modals.edit.title":"sections.synonyms.modals.create.title")}),u.jsx("button",{type:"button",onClick:r,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:u.jsx(nt,{size:20})})]}),u.jsxs("form",{onSubmit:y,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("sections.synonyms.primaryTerm")}),u.jsx("input",{ref:l,type:"text",value:d,onChange:b=>f(b.target.value),placeholder:i("sections.synonyms.primaryTermPlaceholder"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("sections.synonyms.synonymTerms")}),u.jsx("input",{type:"text",value:p,onChange:b=>g(b.target.value),placeholder:i("sections.synonyms.synonymTermsPlaceholder"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0}),u.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:i("sections.synonyms.synonymTermsHint")})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:i("common:buttons.cancel","Cancel")}),u.jsx("button",{type:"submit",disabled:s||!d.trim()||!p.trim(),className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors disabled:opacity-50",children:i(e?"sections.synonyms.modals.edit.submit":"sections.synonyms.modals.create.submit")})]})]})]})})}const hA="search_synonyms";async function cg(){const t=await uo("app_settings",hA);if(!t)return{groups:[]};try{return JSON.parse(t.value)}catch{return{groups:[]}}}async function Gv(t){return await fo("app_settings",{key:hA,value:JSON.stringify(t)})}async function YK(t){const e=await cg(),n={...t,id:crypto.randomUUID()};return e.groups.push(n),await Gv(e)}async function GK(t){const e=await cg(),n=e.groups.findIndex(r=>r.id===t.id);return n===-1?!1:(e.groups[n]=t,await Gv(e))}async function XK(t){const e=await cg();return e.groups=e.groups.filter(n=>n.id!==t),await Gv(e)}function JK(){const t=Le();return Ie({mutationFn:XK,onSuccess:e=>{e&&t.invalidateQueries({queryKey:["synonyms"]})}})}function ZK(){return lt({queryKey:["synonyms"],queryFn:async()=>(await cg()).groups})}function eQ(){const t=Le();return Ie({mutationFn:async e=>{if(e.id){const n={id:e.id,primary:e.primary,synonyms:e.synonyms};return await GK(n)}return await YK({primary:e.primary,synonyms:e.synonyms})},onSuccess:e=>{e&&t.invalidateQueries({queryKey:["synonyms"]})}})}function tQ(){const{t}=ke("settings"),{showToast:e}=mt(),{data:n,isLoading:r,error:s}=ZK(),i=eQ(),o=JK(),[l,d]=C.useState({type:"none"}),f=async(y,m)=>{await i.mutateAsync({primary:y,synonyms:m})?(d({type:"none"}),e(t("sections.synonyms.toast.created"),"success")):e(t("sections.synonyms.toast.error"),"error")},p=async(y,m)=>{if(l.type!=="edit")return;await i.mutateAsync({id:l.synonym.id,primary:y,synonyms:m})?(d({type:"none"}),e(t("sections.synonyms.toast.updated"),"success")):e(t("sections.synonyms.toast.error"),"error")},g=async()=>{if(l.type!=="delete")return;await o.mutateAsync(l.synonym.id)?(d({type:"none"}),e(t("sections.synonyms.toast.deleted"),"success")):e(t("sections.synonyms.toast.error"),"error")};return r?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s?u.jsx("div",{className:"text-center py-8 text-red-500",children:t("sections.synonyms.toast.error")}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.synonyms.title")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("sections.synonyms.description")})]}),u.jsxs("button",{type:"button",onClick:()=>d({type:"create"}),className:"flex items-center gap-2 px-3 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors text-sm whitespace-nowrap shrink-0",children:[u.jsx(Xt,{size:16}),t("sections.synonyms.addSynonym")]})]}),n&&n.length>0?u.jsx("div",{className:"space-y-2",children:n.map(y=>u.jsx(QK,{synonym:y,onEdit:()=>d({type:"edit",synonym:y}),onDelete:()=>d({type:"delete",synonym:y})},y.id))}):u.jsxs("div",{className:"text-center py-12 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx(Yl,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:t("sections.synonyms.noSynonyms")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:t("sections.synonyms.noSynonymsDescription")})]}),(l.type==="create"||l.type==="edit")&&u.jsx(WK,{isOpen:!0,synonym:l.type==="edit"?l.synonym:void 0,onSubmit:l.type==="create"?f:p,onCancel:()=>d({type:"none"}),isLoading:i.isPending}),l.type==="delete"&&u.jsx(di,{isOpen:!0,title:t("sections.synonyms.modals.delete.title"),message:t("sections.synonyms.modals.delete.message",{primary:l.synonym.primary}),confirmLabel:t("sections.synonyms.modals.delete.confirm"),cancelLabel:t("common:buttons.cancel","Cancel"),onConfirm:g,onCancel:()=>d({type:"none"}),variant:"danger"})]})}function nQ({isOpen:t,onConfirm:e,onCancel:n}){const{t:r}=ke("settings"),s=C.useRef(null),[i,o]=C.useState("all"),[l,d]=C.useState(null);C.useEffect(()=>{const g=s.current;g&&(t?g.showModal():g.close())},[t]),C.useEffect(()=>{t||(o("all"),d(null))},[t]);const f=g=>{g.target===s.current&&n()},p=()=>{e(i==="all"?null:l)};return u.jsx("dialog",{ref:s,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:n,onClick:f,children:u.jsxs("div",{className:"p-6 min-w-[400px] max-w-lg",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(wh,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r("sections.importExport.export.title")})]}),u.jsx("button",{type:"button",onClick:n,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded transition-colors",children:u.jsx(nt,{className:"w-5 h-5"})})]}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:r("sections.importExport.export.description")}),u.jsxs("div",{className:"space-y-4 mb-6",children:[u.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[u.jsx("input",{type:"radio",name:"exportScope",checked:i==="all",onChange:()=>o("all"),className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600"}),u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:r("sections.importExport.export.allSongs")})]}),u.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[u.jsx("input",{type:"radio",name:"exportScope",checked:i==="category",onChange:()=>o("category"),className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600"}),u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:r("sections.importExport.export.byCategory")})]}),i==="category"&&u.jsx("div",{className:"ml-7",children:u.jsx(Bp,{value:l,onChange:d,placeholder:r("sections.importExport.export.selectCategory")})})]}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:r("common:buttons.cancel",{ns:"common"})}),u.jsx("button",{type:"button",onClick:p,disabled:i==="category"&&l===null,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:r("sections.importExport.export.button")})]})]})})}function rQ({isOpen:t,progress:e}){const{t:n}=ke("settings");if(!t)return null;const r=()=>{if(!e)return n("sections.importExport.export.exporting");switch(e.phase){case"fetching":return n("sections.importExport.export.fetching");case"generating":return n("sections.importExport.export.generating");case"zipping":return n("sections.importExport.export.zipping");case"saving":return n("sections.importExport.export.saving");default:return n("sections.importExport.export.exporting")}},s=e&&e.total>0?Math.round(e.current/e.total*100):0;return u.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[u.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),u.jsx("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-8 max-w-md w-full mx-4",children:u.jsxs("div",{className:"flex flex-col items-center gap-6",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Qe,{className:"w-16 h-16 text-indigo-600 animate-spin"}),e&&e.total>0&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsxs("span",{className:"text-sm font-semibold text-indigo-600",children:[s,"%"]})})]}),u.jsxs("div",{className:"text-center space-y-2",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r()}),e&&e.total>0&&u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n("sections.importExport.export.processingProgress",{current:e.current,total:e.total})}),e.currentSong&&u.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 truncate max-w-xs",children:e.currentSong})]})]}),u.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:u.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${s}%`}})})]})})]})}async function pA(t={}){return typeof t=="object"&&Object.freeze(t),await Yt("plugin:dialog|open",{options:t})}async function gA(t={}){return typeof t=="object"&&Object.freeze(t),await Yt("plugin:dialog|save",{options:t})}var tT;(function(t){t[t.Audio=1]="Audio",t[t.Cache=2]="Cache",t[t.Config=3]="Config",t[t.Data=4]="Data",t[t.LocalData=5]="LocalData",t[t.Document=6]="Document",t[t.Download=7]="Download",t[t.Picture=8]="Picture",t[t.Public=9]="Public",t[t.Video=10]="Video",t[t.Resource=11]="Resource",t[t.Temp=12]="Temp",t[t.AppConfig=13]="AppConfig",t[t.AppData=14]="AppData",t[t.AppLocalData=15]="AppLocalData",t[t.AppCache=16]="AppCache",t[t.AppLog=17]="AppLog",t[t.Desktop=18]="Desktop",t[t.Executable=19]="Executable",t[t.Font=20]="Font",t[t.Home=21]="Home",t[t.Runtime=22]="Runtime",t[t.Template=23]="Template"})(tT||(tT={}));var nT;(function(t){t[t.Start=0]="Start",t[t.Current=1]="Current",t[t.End=2]="End"})(nT||(nT={}));function sQ(t){return{isFile:t.isFile,isDirectory:t.isDirectory,isSymlink:t.isSymlink,size:t.size,mtime:t.mtime!==null?new Date(t.mtime):null,atime:t.atime!==null?new Date(t.atime):null,birthtime:t.birthtime!==null?new Date(t.birthtime):null,readonly:t.readonly,fileAttributes:t.fileAttributes,dev:t.dev,ino:t.ino,mode:t.mode,nlink:t.nlink,uid:t.uid,gid:t.gid,rdev:t.rdev,blksize:t.blksize,blocks:t.blocks}}function iQ(t){const e=new Uint8ClampedArray(t),n=e.byteLength;let r=0;for(let s=0;s<n;s++){const i=e[s];r*=256,r+=i}return r}class aQ extends WL{async read(e){if(e.byteLength===0)return 0;const n=await Yt("plugin:fs|read",{rid:this.rid,len:e.byteLength}),r=iQ(n.slice(-8)),s=n instanceof ArrayBuffer?new Uint8Array(n):n;return e.set(s.slice(0,s.length-8)),r===0?null:r}async seek(e,n){return await Yt("plugin:fs|seek",{rid:this.rid,offset:e,whence:n})}async stat(){const e=await Yt("plugin:fs|fstat",{rid:this.rid});return sQ(e)}async truncate(e){await Yt("plugin:fs|ftruncate",{rid:this.rid,len:e})}async write(e){return await Yt("plugin:fs|write",{rid:this.rid,data:e})}}async function oQ(t,e){if(t instanceof URL&&t.protocol!=="file:")throw new TypeError("Must be a file URL.");const n=await Yt("plugin:fs|open",{path:t instanceof URL?t.toString():t,options:e});return new aQ(n)}async function cu(t,e){if(t instanceof URL&&t.protocol!=="file:")throw new TypeError("Must be a file URL.");const n=await Yt("plugin:fs|read_file",{path:t instanceof URL?t.toString():t,options:e});return n instanceof ArrayBuffer?new Uint8Array(n):Uint8Array.from(n)}async function lQ(t,e,n){if(t instanceof URL&&t.protocol!=="file:")throw new TypeError("Must be a file URL.");if(e instanceof ReadableStream){const r=await oQ(t,{read:!1,create:!0,write:!0,...n}),s=e.getReader();try{for(;;){const{done:i,value:o}=await s.read();if(i)break;await r.write(o)}}finally{s.releaseLock(),await r.close()}}else await Yt("plugin:fs|write_file",e,{headers:{path:encodeURIComponent(t instanceof URL?t.toString():t),options:JSON.stringify(n)}})}async function cQ(t){const e=new URLSearchParams;t!==null&&e.set("categoryId",String(t));const n=e.toString(),r=n?`/api/songs/export?${n}`:"/api/songs/export";return(await Me(r)).data??[]}function th(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var vy={exports:{}};var rT;function uQ(){return rT||(rT=1,(function(t,e){(function(n){t.exports=n()})(function(){return(function n(r,s,i){function o(f,p){if(!s[f]){if(!r[f]){var g=typeof th=="function"&&th;if(!p&&g)return g(f,!0);if(l)return l(f,!0);var y=new Error("Cannot find module '"+f+"'");throw y.code="MODULE_NOT_FOUND",y}var m=s[f]={exports:{}};r[f][0].call(m.exports,function(b){var v=r[f][1][b];return o(v||b)},m,m.exports,n,r,s,i)}return s[f].exports}for(var l=typeof th=="function"&&th,d=0;d<i.length;d++)o(i[d]);return o})({1:[function(n,r,s){var i=n("./utils"),o=n("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(d){for(var f,p,g,y,m,b,v,w=[],S=0,T=d.length,j=T,M=i.getTypeOf(d)!=="string";S<d.length;)j=T-S,g=M?(f=d[S++],p=S<T?d[S++]:0,S<T?d[S++]:0):(f=d.charCodeAt(S++),p=S<T?d.charCodeAt(S++):0,S<T?d.charCodeAt(S++):0),y=f>>2,m=(3&f)<<4|p>>4,b=1<j?(15&p)<<2|g>>6:64,v=2<j?63&g:64,w.push(l.charAt(y)+l.charAt(m)+l.charAt(b)+l.charAt(v));return w.join("")},s.decode=function(d){var f,p,g,y,m,b,v=0,w=0,S="data:";if(d.substr(0,S.length)===S)throw new Error("Invalid base64 input, it looks like a data url.");var T,j=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===l.charAt(64)&&j--,d.charAt(d.length-2)===l.charAt(64)&&j--,j%1!=0)throw new Error("Invalid base64 input, bad content length.");for(T=o.uint8array?new Uint8Array(0|j):new Array(0|j);v<d.length;)f=l.indexOf(d.charAt(v++))<<2|(y=l.indexOf(d.charAt(v++)))>>4,p=(15&y)<<4|(m=l.indexOf(d.charAt(v++)))>>2,g=(3&m)<<6|(b=l.indexOf(d.charAt(v++))),T[w++]=f,m!==64&&(T[w++]=p),b!==64&&(T[w++]=g);return T}},{"./support":30,"./utils":32}],2:[function(n,r,s){var i=n("./external"),o=n("./stream/DataWorker"),l=n("./stream/Crc32Probe"),d=n("./stream/DataLengthProbe");function f(p,g,y,m,b){this.compressedSize=p,this.uncompressedSize=g,this.crc32=y,this.compression=m,this.compressedContent=b}f.prototype={getContentWorker:function(){var p=new o(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),g=this;return p.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),p},getCompressedWorker:function(){return new o(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(p,g,y){return p.pipe(new l).pipe(new d("uncompressedSize")).pipe(g.compressWorker(y)).pipe(new d("compressedSize")).withStreamInfo("compression",g)},r.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,s){var i=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,s){var i=n("./utils"),o=(function(){for(var l,d=[],f=0;f<256;f++){l=f;for(var p=0;p<8;p++)l=1&l?3988292384^l>>>1:l>>>1;d[f]=l}return d})();r.exports=function(l,d){return l!==void 0&&l.length?i.getTypeOf(l)!=="string"?(function(f,p,g,y){var m=o,b=y+g;f^=-1;for(var v=y;v<b;v++)f=f>>>8^m[255&(f^p[v])];return-1^f})(0|d,l,l.length,0):(function(f,p,g,y){var m=o,b=y+g;f^=-1;for(var v=y;v<b;v++)f=f>>>8^m[255&(f^p.charCodeAt(v))];return-1^f})(0|d,l,l.length,0):0}},{"./utils":32}],5:[function(n,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,r,s){var i=null;i=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=n("pako"),l=n("./utils"),d=n("./stream/GenericWorker"),f=i?"uint8array":"array";function p(g,y){d.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=y,this.meta={}}s.magic="\b\0",l.inherits(p,d),p.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(f,g.data),!1)},p.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},p.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},p.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(y){g.push({data:y,meta:g.meta})}},s.compressWorker=function(g){return new p("Deflate",g)},s.uncompressWorker=function(){return new p("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,s){function i(m,b){var v,w="";for(v=0;v<b;v++)w+=String.fromCharCode(255&m),m>>>=8;return w}function o(m,b,v,w,S,T){var j,M,_=m.file,R=m.compression,O=T!==f.utf8encode,L=l.transformTo("string",T(_.name)),A=l.transformTo("string",f.utf8encode(_.name)),F=_.comment,H=l.transformTo("string",T(F)),P=l.transformTo("string",f.utf8encode(F)),B=A.length!==_.name.length,E=P.length!==F.length,K="",q="",V="",ie=_.dir,Y=_.date,X={crc32:0,compressedSize:0,uncompressedSize:0};b&&!v||(X.crc32=m.crc32,X.compressedSize=m.compressedSize,X.uncompressedSize=m.uncompressedSize);var I=0;b&&(I|=8),O||!B&&!E||(I|=2048);var U=0,te=0;ie&&(U|=16),S==="UNIX"?(te=798,U|=(function(re,se){var ge=re;return re||(ge=se?16893:33204),(65535&ge)<<16})(_.unixPermissions,ie)):(te=20,U|=(function(re){return 63&(re||0)})(_.dosPermissions)),j=Y.getUTCHours(),j<<=6,j|=Y.getUTCMinutes(),j<<=5,j|=Y.getUTCSeconds()/2,M=Y.getUTCFullYear()-1980,M<<=4,M|=Y.getUTCMonth()+1,M<<=5,M|=Y.getUTCDate(),B&&(q=i(1,1)+i(p(L),4)+A,K+="up"+i(q.length,2)+q),E&&(V=i(1,1)+i(p(H),4)+P,K+="uc"+i(V.length,2)+V);var Z="";return Z+=`
\0`,Z+=i(I,2),Z+=R.magic,Z+=i(j,2),Z+=i(M,2),Z+=i(X.crc32,4),Z+=i(X.compressedSize,4),Z+=i(X.uncompressedSize,4),Z+=i(L.length,2),Z+=i(K.length,2),{fileRecord:g.LOCAL_FILE_HEADER+Z+L+K,dirRecord:g.CENTRAL_FILE_HEADER+i(te,2)+Z+i(H.length,2)+"\0\0\0\0"+i(U,4)+i(w,4)+L+K+H}}var l=n("../utils"),d=n("../stream/GenericWorker"),f=n("../utf8"),p=n("../crc32"),g=n("../signature");function y(m,b,v,w){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=v,this.encodeFileName=w,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(y,d),y.prototype.push=function(m){var b=m.meta.percent||0,v=this.entriesCount,w=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,d.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:v?(b+100*(v-w-1))/v:100}}))},y.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var b=this.streamFiles&&!m.file.dir;if(b){var v=o(m,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(m){this.accumulate=!1;var b=this.streamFiles&&!m.file.dir,v=o(m,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),b)this.push({data:(function(w){return g.DATA_DESCRIPTOR+i(w.crc32,4)+i(w.compressedSize,4)+i(w.uncompressedSize,4)})(m),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var m=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var v=this.bytesWritten-m,w=(function(S,T,j,M,_){var R=l.transformTo("string",_(M));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(S,2)+i(S,2)+i(T,4)+i(j,4)+i(R.length,2)+R})(this.dirRecords.length,v,m,this.zipComment,this.encodeFileName);this.push({data:w,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(m){this._sources.push(m);var b=this;return m.on("data",function(v){b.processChunk(v)}),m.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),m.on("error",function(v){b.error(v)}),this},y.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},y.prototype.error=function(m){var b=this._sources;if(!d.prototype.error.call(this,m))return!1;for(var v=0;v<b.length;v++)try{b[v].error(m)}catch{}return!0},y.prototype.lock=function(){d.prototype.lock.call(this);for(var m=this._sources,b=0;b<m.length;b++)m[b].lock()},r.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,s){var i=n("../compressions"),o=n("./ZipFileWorker");s.generateWorker=function(l,d,f){var p=new o(d.streamFiles,f,d.platform,d.encodeFileName),g=0;try{l.forEach(function(y,m){g++;var b=(function(T,j){var M=T||j,_=i[M];if(!_)throw new Error(M+" is not a valid compression method !");return _})(m.options.compression,d.compression),v=m.options.compressionOptions||d.compressionOptions||{},w=m.dir,S=m.date;m._compressWorker(b,v).withStreamInfo("file",{name:y,dir:w,date:S,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(p)}),p.entriesCount=g}catch(y){p.error(y)}return p}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new i;for(var l in this)typeof this[l]!="function"&&(o[l]=this[l]);return o}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(o,l){return new i().loadAsync(o,l)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,s){var i=n("./utils"),o=n("./external"),l=n("./utf8"),d=n("./zipEntries"),f=n("./stream/Crc32Probe"),p=n("./nodejsUtils");function g(y){return new o.Promise(function(m,b){var v=y.decompressed.getContentWorker().pipe(new f);v.on("error",function(w){b(w)}).on("end",function(){v.streamInfo.crc32!==y.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}r.exports=function(y,m){var b=this;return m=i.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),p.isNode&&p.isStream(y)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",y,!0,m.optimizedBinaryString,m.base64).then(function(v){var w=new d(m);return w.load(v),w}).then(function(v){var w=[o.Promise.resolve(v)],S=v.files;if(m.checkCRC32)for(var T=0;T<S.length;T++)w.push(g(S[T]));return o.Promise.all(w)}).then(function(v){for(var w=v.shift(),S=w.files,T=0;T<S.length;T++){var j=S[T],M=j.fileNameStr,_=i.resolve(j.fileNameStr);b.file(_,j.decompressed,{binary:!0,optimizedBinaryString:!0,date:j.date,dir:j.dir,comment:j.fileCommentStr.length?j.fileCommentStr:null,unixPermissions:j.unixPermissions,dosPermissions:j.dosPermissions,createFolders:m.createFolders}),j.dir||(b.file(_).unsafeOriginalName=M)}return w.zipComment.length&&(b.comment=w.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,s){var i=n("../utils"),o=n("../stream/GenericWorker");function l(d,f){o.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(f)}i.inherits(l,o),l.prototype._bindStream=function(d){var f=this;(this._stream=d).pause(),d.on("data",function(p){f.push({data:p,meta:{percent:0}})}).on("error",function(p){f.isPaused?this.generatedError=p:f.error(p)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},l.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,s){var i=n("readable-stream").Readable;function o(l,d,f){i.call(this,d),this._helper=l;var p=this;l.on("data",function(g,y){p.push(g)||p._helper.pause(),f&&f(y)}).on("error",function(g){p.emit("error",g)}).on("end",function(){p.push(null)})}n("../utils").inherits(o,i),o.prototype._read=function(){this._helper.resume()},r.exports=o},{"../utils":32,"readable-stream":16}],14:[function(n,r,s){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,o);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,o)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var o=new Buffer(i);return o.fill(0),o},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,s){function i(_,R,O){var L,A=l.getTypeOf(R),F=l.extend(O||{},p);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(_=S(_)),F.createFolders&&(L=w(_))&&T.call(this,L,!0);var H=A==="string"&&F.binary===!1&&F.base64===!1;O&&O.binary!==void 0||(F.binary=!H),(R instanceof g&&R.uncompressedSize===0||F.dir||!R||R.length===0)&&(F.base64=!1,F.binary=!0,R="",F.compression="STORE",A="string");var P=null;P=R instanceof g||R instanceof d?R:b.isNode&&b.isStream(R)?new v(_,R):l.prepareContent(_,R,F.binary,F.optimizedBinaryString,F.base64);var B=new y(_,P,F);this.files[_]=B}var o=n("./utf8"),l=n("./utils"),d=n("./stream/GenericWorker"),f=n("./stream/StreamHelper"),p=n("./defaults"),g=n("./compressedObject"),y=n("./zipObject"),m=n("./generate"),b=n("./nodejsUtils"),v=n("./nodejs/NodejsStreamInputAdapter"),w=function(_){_.slice(-1)==="/"&&(_=_.substring(0,_.length-1));var R=_.lastIndexOf("/");return 0<R?_.substring(0,R):""},S=function(_){return _.slice(-1)!=="/"&&(_+="/"),_},T=function(_,R){return R=R!==void 0?R:p.createFolders,_=S(_),this.files[_]||i.call(this,_,null,{dir:!0,createFolders:R}),this.files[_]};function j(_){return Object.prototype.toString.call(_)==="[object RegExp]"}var M={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(_){var R,O,L;for(R in this.files)L=this.files[R],(O=R.slice(this.root.length,R.length))&&R.slice(0,this.root.length)===this.root&&_(O,L)},filter:function(_){var R=[];return this.forEach(function(O,L){_(O,L)&&R.push(L)}),R},file:function(_,R,O){if(arguments.length!==1)return _=this.root+_,i.call(this,_,R,O),this;if(j(_)){var L=_;return this.filter(function(F,H){return!H.dir&&L.test(F)})}var A=this.files[this.root+_];return A&&!A.dir?A:null},folder:function(_){if(!_)return this;if(j(_))return this.filter(function(A,F){return F.dir&&_.test(A)});var R=this.root+_,O=T.call(this,R),L=this.clone();return L.root=O.name,L},remove:function(_){_=this.root+_;var R=this.files[_];if(R||(_.slice(-1)!=="/"&&(_+="/"),R=this.files[_]),R&&!R.dir)delete this.files[_];else for(var O=this.filter(function(A,F){return F.name.slice(0,_.length)===_}),L=0;L<O.length;L++)delete this.files[O[L].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(_){var R,O={};try{if((O=l.extend(_||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=O.type.toLowerCase(),O.compression=O.compression.toUpperCase(),O.type==="binarystring"&&(O.type="string"),!O.type)throw new Error("No output type specified.");l.checkSupport(O.type),O.platform!=="darwin"&&O.platform!=="freebsd"&&O.platform!=="linux"&&O.platform!=="sunos"||(O.platform="UNIX"),O.platform==="win32"&&(O.platform="DOS");var L=O.comment||this.comment||"";R=m.generateWorker(this,O,L)}catch(A){(R=new d("error")).error(A)}return new f(R,O.type||"string",O.mimeType)},generateAsync:function(_,R){return this.generateInternalStream(_).accumulate(R)},generateNodeStream:function(_,R){return(_=_||{}).type||(_.type="nodebuffer"),this.generateInternalStream(_).toNodejsStream(R)}};r.exports=M},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,s){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,s){var i=n("./DataReader");function o(l){i.call(this,l);for(var d=0;d<this.data.length;d++)l[d]=255&l[d]}n("../utils").inherits(o,i),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var d=l.charCodeAt(0),f=l.charCodeAt(1),p=l.charCodeAt(2),g=l.charCodeAt(3),y=this.length-4;0<=y;--y)if(this.data[y]===d&&this.data[y+1]===f&&this.data[y+2]===p&&this.data[y+3]===g)return y-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var d=l.charCodeAt(0),f=l.charCodeAt(1),p=l.charCodeAt(2),g=l.charCodeAt(3),y=this.readData(4);return d===y[0]&&f===y[1]&&p===y[2]&&g===y[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,d},r.exports=o},{"../utils":32,"./DataReader":18}],18:[function(n,r,s){var i=n("../utils");function o(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var d,f=0;for(this.checkOffset(l),d=this.index+l-1;d>=this.index;d--)f=(f<<8)+this.byteAt(d);return this.index+=l,f},readString:function(l){return i.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},r.exports=o},{"../utils":32}],19:[function(n,r,s){var i=n("./Uint8ArrayReader");function o(l){i.call(this,l)}n("../utils").inherits(o,i),o.prototype.readData=function(l){this.checkOffset(l);var d=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,d},r.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,s){var i=n("./DataReader");function o(l){i.call(this,l)}n("../utils").inherits(o,i),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},o.prototype.readData=function(l){this.checkOffset(l);var d=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,d},r.exports=o},{"../utils":32,"./DataReader":18}],21:[function(n,r,s){var i=n("./ArrayReader");function o(l){i.call(this,l)}n("../utils").inherits(o,i),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,d},r.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,s){var i=n("../utils"),o=n("../support"),l=n("./ArrayReader"),d=n("./StringReader"),f=n("./NodeBufferReader"),p=n("./Uint8ArrayReader");r.exports=function(g){var y=i.getTypeOf(g);return i.checkSupport(y),y!=="string"||o.uint8array?y==="nodebuffer"?new f(g):o.uint8array?new p(i.transformTo("uint8array",g)):new l(i.transformTo("array",g)):new d(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,s){var i=n("./GenericWorker"),o=n("../utils");function l(d){i.call(this,"ConvertWorker to "+d),this.destType=d}o.inherits(l,i),l.prototype.processChunk=function(d){this.push({data:o.transformTo(this.destType,d.data),meta:d.meta})},r.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,s){var i=n("./GenericWorker"),o=n("../crc32");function l(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(l,i),l.prototype.processChunk=function(d){this.streamInfo.crc32=o(d.data,this.streamInfo.crc32||0),this.push(d)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,s){var i=n("../utils"),o=n("./GenericWorker");function l(d){o.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}i.inherits(l,o),l.prototype.processChunk=function(d){if(d){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+d.data.length}o.prototype.processChunk.call(this,d)},r.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,s){var i=n("../utils"),o=n("./GenericWorker");function l(d){o.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(p){f.dataIsReady=!0,f.data=p,f.max=p&&p.length||0,f.type=i.getTypeOf(p),f.isPaused||f._tickAndRepeat()},function(p){f.error(p)})}i.inherits(l,o),l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,f);break;case"uint8array":d=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":d=this.data.slice(this.index,f)}return this.index=f,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,s){function i(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,l){return this._listeners[o].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,l){if(this._listeners[o])for(var d=0;d<this._listeners[o].length;d++)this._listeners[o][d].call(this,l)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var l=this;return o.on("data",function(d){l.processChunk(d)}),o.on("end",function(){l.end()}),o.on("error",function(d){l.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,l){return this.extraStreamInfo[o]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},r.exports=i},{}],29:[function(n,r,s){var i=n("../utils"),o=n("./ConvertWorker"),l=n("./GenericWorker"),d=n("../base64"),f=n("../support"),p=n("../external"),g=null;if(f.nodestream)try{g=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(b,v){return new p.Promise(function(w,S){var T=[],j=b._internalType,M=b._outputType,_=b._mimeType;b.on("data",function(R,O){T.push(R),v&&v(O)}).on("error",function(R){T=[],S(R)}).on("end",function(){try{var R=(function(O,L,A){switch(O){case"blob":return i.newBlob(i.transformTo("arraybuffer",L),A);case"base64":return d.encode(L);default:return i.transformTo(O,L)}})(M,(function(O,L){var A,F=0,H=null,P=0;for(A=0;A<L.length;A++)P+=L[A].length;switch(O){case"string":return L.join("");case"array":return Array.prototype.concat.apply([],L);case"uint8array":for(H=new Uint8Array(P),A=0;A<L.length;A++)H.set(L[A],F),F+=L[A].length;return H;case"nodebuffer":return Buffer.concat(L);default:throw new Error("concat : unsupported type '"+O+"'")}})(j,T),_);w(R)}catch(O){S(O)}T=[]}).resume()})}function m(b,v,w){var S=v;switch(v){case"blob":case"arraybuffer":S="uint8array";break;case"base64":S="string"}try{this._internalType=S,this._outputType=v,this._mimeType=w,i.checkSupport(S),this._worker=b.pipe(new o(S)),b.lock()}catch(T){this._worker=new l("error"),this._worker.error(T)}}m.prototype={accumulate:function(b){return y(this,b)},on:function(b,v){var w=this;return b==="data"?this._worker.on(b,function(S){v.call(w,S.data,S.meta)}):this._worker.on(b,function(){i.delay(v,arguments,w)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},b)}},r.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(i),s.blob=o.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,s){for(var i=n("./utils"),o=n("./support"),l=n("./nodejsUtils"),d=n("./stream/GenericWorker"),f=new Array(256),p=0;p<256;p++)f[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;f[254]=f[254]=1;function g(){d.call(this,"utf-8 decode"),this.leftOver=null}function y(){d.call(this,"utf-8 encode")}s.utf8encode=function(m){return o.nodebuffer?l.newBufferFrom(m,"utf-8"):(function(b){var v,w,S,T,j,M=b.length,_=0;for(T=0;T<M;T++)(64512&(w=b.charCodeAt(T)))==55296&&T+1<M&&(64512&(S=b.charCodeAt(T+1)))==56320&&(w=65536+(w-55296<<10)+(S-56320),T++),_+=w<128?1:w<2048?2:w<65536?3:4;for(v=o.uint8array?new Uint8Array(_):new Array(_),T=j=0;j<_;T++)(64512&(w=b.charCodeAt(T)))==55296&&T+1<M&&(64512&(S=b.charCodeAt(T+1)))==56320&&(w=65536+(w-55296<<10)+(S-56320),T++),w<128?v[j++]=w:(w<2048?v[j++]=192|w>>>6:(w<65536?v[j++]=224|w>>>12:(v[j++]=240|w>>>18,v[j++]=128|w>>>12&63),v[j++]=128|w>>>6&63),v[j++]=128|63&w);return v})(m)},s.utf8decode=function(m){return o.nodebuffer?i.transformTo("nodebuffer",m).toString("utf-8"):(function(b){var v,w,S,T,j=b.length,M=new Array(2*j);for(v=w=0;v<j;)if((S=b[v++])<128)M[w++]=S;else if(4<(T=f[S]))M[w++]=65533,v+=T-1;else{for(S&=T===2?31:T===3?15:7;1<T&&v<j;)S=S<<6|63&b[v++],T--;1<T?M[w++]=65533:S<65536?M[w++]=S:(S-=65536,M[w++]=55296|S>>10&1023,M[w++]=56320|1023&S)}return M.length!==w&&(M.subarray?M=M.subarray(0,w):M.length=w),i.applyFromCharCode(M)})(m=i.transformTo(o.uint8array?"uint8array":"array",m))},i.inherits(g,d),g.prototype.processChunk=function(m){var b=i.transformTo(o.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var v=b;(b=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),b.set(v,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var w=(function(T,j){var M;for((j=j||T.length)>T.length&&(j=T.length),M=j-1;0<=M&&(192&T[M])==128;)M--;return M<0||M===0?j:M+f[T[M]]>j?M:j})(b),S=b;w!==b.length&&(o.uint8array?(S=b.subarray(0,w),this.leftOver=b.subarray(w,b.length)):(S=b.slice(0,w),this.leftOver=b.slice(w,b.length))),this.push({data:s.utf8decode(S),meta:m.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=g,i.inherits(y,d),y.prototype.processChunk=function(m){this.push({data:s.utf8encode(m.data),meta:m.meta})},s.Utf8EncodeWorker=y},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,s){var i=n("./support"),o=n("./base64"),l=n("./nodejsUtils"),d=n("./external");function f(v){return v}function p(v,w){for(var S=0;S<v.length;++S)w[S]=255&v.charCodeAt(S);return w}n("setimmediate"),s.newBlob=function(v,w){s.checkSupport("blob");try{return new Blob([v],{type:w})}catch{try{var S=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return S.append(v),S.getBlob(w)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(v,w,S){var T=[],j=0,M=v.length;if(M<=S)return String.fromCharCode.apply(null,v);for(;j<M;)w==="array"||w==="nodebuffer"?T.push(String.fromCharCode.apply(null,v.slice(j,Math.min(j+S,M)))):T.push(String.fromCharCode.apply(null,v.subarray(j,Math.min(j+S,M)))),j+=S;return T.join("")},stringifyByChar:function(v){for(var w="",S=0;S<v.length;S++)w+=String.fromCharCode(v[S]);return w},applyCanBeUsed:{uint8array:(function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}})()}};function y(v){var w=65536,S=s.getTypeOf(v),T=!0;if(S==="uint8array"?T=g.applyCanBeUsed.uint8array:S==="nodebuffer"&&(T=g.applyCanBeUsed.nodebuffer),T)for(;1<w;)try{return g.stringifyByChunk(v,S,w)}catch{w=Math.floor(w/2)}return g.stringifyByChar(v)}function m(v,w){for(var S=0;S<v.length;S++)w[S]=v[S];return w}s.applyFromCharCode=y;var b={};b.string={string:f,array:function(v){return p(v,new Array(v.length))},arraybuffer:function(v){return b.string.uint8array(v).buffer},uint8array:function(v){return p(v,new Uint8Array(v.length))},nodebuffer:function(v){return p(v,l.allocBuffer(v.length))}},b.array={string:y,array:f,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return l.newBufferFrom(v)}},b.arraybuffer={string:function(v){return y(new Uint8Array(v))},array:function(v){return m(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:f,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return l.newBufferFrom(new Uint8Array(v))}},b.uint8array={string:y,array:function(v){return m(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:f,nodebuffer:function(v){return l.newBufferFrom(v)}},b.nodebuffer={string:y,array:function(v){return m(v,new Array(v.length))},arraybuffer:function(v){return b.nodebuffer.uint8array(v).buffer},uint8array:function(v){return m(v,new Uint8Array(v.length))},nodebuffer:f},s.transformTo=function(v,w){if(w=w||"",!v)return w;s.checkSupport(v);var S=s.getTypeOf(w);return b[S][v](w)},s.resolve=function(v){for(var w=v.split("/"),S=[],T=0;T<w.length;T++){var j=w[T];j==="."||j===""&&T!==0&&T!==w.length-1||(j===".."?S.pop():S.push(j))}return S.join("/")},s.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":i.nodebuffer&&l.isBuffer(v)?"nodebuffer":i.uint8array&&v instanceof Uint8Array?"uint8array":i.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(v){if(!i[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(v){var w,S,T="";for(S=0;S<(v||"").length;S++)T+="\\x"+((w=v.charCodeAt(S))<16?"0":"")+w.toString(16).toUpperCase();return T},s.delay=function(v,w,S){setImmediate(function(){v.apply(S||null,w||[])})},s.inherits=function(v,w){function S(){}S.prototype=w.prototype,v.prototype=new S},s.extend=function(){var v,w,S={};for(v=0;v<arguments.length;v++)for(w in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],w)&&S[w]===void 0&&(S[w]=arguments[v][w]);return S},s.prepareContent=function(v,w,S,T,j){return d.Promise.resolve(w).then(function(M){return i.blob&&(M instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(M))!==-1)&&typeof FileReader<"u"?new d.Promise(function(_,R){var O=new FileReader;O.onload=function(L){_(L.target.result)},O.onerror=function(L){R(L.target.error)},O.readAsArrayBuffer(M)}):M}).then(function(M){var _=s.getTypeOf(M);return _?(_==="arraybuffer"?M=s.transformTo("uint8array",M):_==="string"&&(j?M=o.decode(M):S&&T!==!0&&(M=(function(R){return p(R,i.uint8array?new Uint8Array(R.length):new Array(R.length))})(M))),M):d.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,s){var i=n("./reader/readerFor"),o=n("./utils"),l=n("./signature"),d=n("./zipEntry"),f=n("./support");function p(g){this.files=[],this.loadOptions=g}p.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(y)+", expected "+o.pretty(g)+")")}},isSignature:function(g,y){var m=this.reader.index;this.reader.setIndex(g);var b=this.reader.readString(4)===y;return this.reader.setIndex(m),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),y=f.uint8array?"uint8array":"array",m=o.transformTo(y,g);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,y,m,b=this.zip64EndOfCentralSize-44;0<b;)g=this.reader.readInt(2),y=this.reader.readInt(4),m=this.reader.readData(y),this.zip64ExtensibleData[g]={id:g,length:y,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,y;for(g=0;g<this.files.length;g++)y=this.files[g],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(g=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var y=g;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var b=y-m;if(0<b)this.isSignature(y,l.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(g){this.reader=i(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=p},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,s){var i=n("./reader/readerFor"),o=n("./utils"),l=n("./compressedObject"),d=n("./crc32"),f=n("./utf8"),p=n("./compressions"),g=n("./support");function y(m,b){this.options=m,this.loadOptions=b}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var b,v;if(m.skip(22),this.fileNameLength=m.readInt(2),v=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((b=(function(w){for(var S in p)if(Object.prototype.hasOwnProperty.call(p,S)&&p[S].magic===w)return p[S];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,b,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var b=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(b),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=i(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var b,v,w,S=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<S;)b=m.readInt(2),v=m.readInt(2),w=m.readData(v),this.extraFields[b]={id:b,length:v,value:w};m.setIndex(S)},handleUTF8:function(){var m=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var v=o.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var w=this.findExtraFieldUnicodeComment();if(w!==null)this.fileCommentStr=w;else{var S=o.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(S)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var b=i(m.value);return b.readInt(1)!==1||d(this.fileName)!==b.readInt(4)?null:f.utf8decode(b.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var b=i(m.value);return b.readInt(1)!==1||d(this.fileComment)!==b.readInt(4)?null:f.utf8decode(b.readData(m.length-5))}return null}},r.exports=y},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,s){function i(b,v,w){this.name=b,this.dir=w.dir,this.date=w.date,this.comment=w.comment,this.unixPermissions=w.unixPermissions,this.dosPermissions=w.dosPermissions,this._data=v,this._dataBinary=w.binary,this.options={compression:w.compression,compressionOptions:w.compressionOptions}}var o=n("./stream/StreamHelper"),l=n("./stream/DataWorker"),d=n("./utf8"),f=n("./compressedObject"),p=n("./stream/GenericWorker");i.prototype={internalStream:function(b){var v=null,w="string";try{if(!b)throw new Error("No output type specified.");var S=(w=b.toLowerCase())==="string"||w==="text";w!=="binarystring"&&w!=="text"||(w="string"),v=this._decompressWorker();var T=!this._dataBinary;T&&!S&&(v=v.pipe(new d.Utf8EncodeWorker)),!T&&S&&(v=v.pipe(new d.Utf8DecodeWorker))}catch(j){(v=new p("error")).error(j)}return new o(v,w,"")},async:function(b,v){return this.internalStream(b).accumulate(v)},nodeStream:function(b,v){return this.internalStream(b||"nodebuffer").toNodejsStream(v)},_compressWorker:function(b,v){if(this._data instanceof f&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var w=this._decompressWorker();return this._dataBinary||(w=w.pipe(new d.Utf8EncodeWorker)),f.createWorkerFrom(w,b,v)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof p?this._data:new l(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<g.length;m++)i.prototype[g[m]]=y;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,s){(function(i){var o,l,d=i.MutationObserver||i.WebKitMutationObserver;if(d){var f=0,p=new d(b),g=i.document.createTextNode("");p.observe(g,{characterData:!0}),o=function(){g.data=f=++f%2}}else if(i.setImmediate||i.MessageChannel===void 0)o="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var v=i.document.createElement("script");v.onreadystatechange=function(){b(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},i.document.documentElement.appendChild(v)}:function(){setTimeout(b,0)};else{var y=new i.MessageChannel;y.port1.onmessage=b,o=function(){y.port2.postMessage(0)}}var m=[];function b(){var v,w;l=!0;for(var S=m.length;S;){for(w=m,m=[],v=-1;++v<S;)w[v]();S=m.length}l=!1}r.exports=function(v){m.push(v)!==1||l||o()}}).call(this,typeof Tf<"u"?Tf:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,s){var i=n("immediate");function o(){}var l={},d=["REJECTED"],f=["FULFILLED"],p=["PENDING"];function g(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,S!==o&&v(this,S)}function y(S,T,j){this.promise=S,typeof T=="function"&&(this.onFulfilled=T,this.callFulfilled=this.otherCallFulfilled),typeof j=="function"&&(this.onRejected=j,this.callRejected=this.otherCallRejected)}function m(S,T,j){i(function(){var M;try{M=T(j)}catch(_){return l.reject(S,_)}M===S?l.reject(S,new TypeError("Cannot resolve promise with itself")):l.resolve(S,M)})}function b(S){var T=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof T=="function")return function(){T.apply(S,arguments)}}function v(S,T){var j=!1;function M(O){j||(j=!0,l.reject(S,O))}function _(O){j||(j=!0,l.resolve(S,O))}var R=w(function(){T(_,M)});R.status==="error"&&M(R.value)}function w(S,T){var j={};try{j.value=S(T),j.status="success"}catch(M){j.status="error",j.value=M}return j}(r.exports=g).prototype.finally=function(S){if(typeof S!="function")return this;var T=this.constructor;return this.then(function(j){return T.resolve(S()).then(function(){return j})},function(j){return T.resolve(S()).then(function(){throw j})})},g.prototype.catch=function(S){return this.then(null,S)},g.prototype.then=function(S,T){if(typeof S!="function"&&this.state===f||typeof T!="function"&&this.state===d)return this;var j=new this.constructor(o);return this.state!==p?m(j,this.state===f?S:T,this.outcome):this.queue.push(new y(j,S,T)),j},y.prototype.callFulfilled=function(S){l.resolve(this.promise,S)},y.prototype.otherCallFulfilled=function(S){m(this.promise,this.onFulfilled,S)},y.prototype.callRejected=function(S){l.reject(this.promise,S)},y.prototype.otherCallRejected=function(S){m(this.promise,this.onRejected,S)},l.resolve=function(S,T){var j=w(b,T);if(j.status==="error")return l.reject(S,j.value);var M=j.value;if(M)v(S,M);else{S.state=f,S.outcome=T;for(var _=-1,R=S.queue.length;++_<R;)S.queue[_].callFulfilled(T)}return S},l.reject=function(S,T){S.state=d,S.outcome=T;for(var j=-1,M=S.queue.length;++j<M;)S.queue[j].callRejected(T);return S},g.resolve=function(S){return S instanceof this?S:l.resolve(new this(o),S)},g.reject=function(S){var T=new this(o);return l.reject(T,S)},g.all=function(S){var T=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=S.length,M=!1;if(!j)return this.resolve([]);for(var _=new Array(j),R=0,O=-1,L=new this(o);++O<j;)A(S[O],O);return L;function A(F,H){T.resolve(F).then(function(P){_[H]=P,++R!==j||M||(M=!0,l.resolve(L,_))},function(P){M||(M=!0,l.reject(L,P))})}},g.race=function(S){var T=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=S.length,M=!1;if(!j)return this.resolve([]);for(var _=-1,R=new this(o);++_<j;)O=S[_],T.resolve(O).then(function(L){M||(M=!0,l.resolve(R,L))},function(L){M||(M=!0,l.reject(R,L))});var O;return R}},{immediate:36}],38:[function(n,r,s){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,s){var i=n("./zlib/deflate"),o=n("./utils/common"),l=n("./utils/strings"),d=n("./zlib/messages"),f=n("./zlib/zstream"),p=Object.prototype.toString,g=0,y=-1,m=0,b=8;function v(S){if(!(this instanceof v))return new v(S);this.options=o.assign({level:y,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},S||{});var T=this.options;T.raw&&0<T.windowBits?T.windowBits=-T.windowBits:T.gzip&&0<T.windowBits&&T.windowBits<16&&(T.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var j=i.deflateInit2(this.strm,T.level,T.method,T.windowBits,T.memLevel,T.strategy);if(j!==g)throw new Error(d[j]);if(T.header&&i.deflateSetHeader(this.strm,T.header),T.dictionary){var M;if(M=typeof T.dictionary=="string"?l.string2buf(T.dictionary):p.call(T.dictionary)==="[object ArrayBuffer]"?new Uint8Array(T.dictionary):T.dictionary,(j=i.deflateSetDictionary(this.strm,M))!==g)throw new Error(d[j]);this._dict_set=!0}}function w(S,T){var j=new v(T);if(j.push(S,!0),j.err)throw j.msg||d[j.err];return j.result}v.prototype.push=function(S,T){var j,M,_=this.strm,R=this.options.chunkSize;if(this.ended)return!1;M=T===~~T?T:T===!0?4:0,typeof S=="string"?_.input=l.string2buf(S):p.call(S)==="[object ArrayBuffer]"?_.input=new Uint8Array(S):_.input=S,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new o.Buf8(R),_.next_out=0,_.avail_out=R),(j=i.deflate(_,M))!==1&&j!==g)return this.onEnd(j),!(this.ended=!0);_.avail_out!==0&&(_.avail_in!==0||M!==4&&M!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(o.shrinkBuf(_.output,_.next_out))):this.onData(o.shrinkBuf(_.output,_.next_out)))}while((0<_.avail_in||_.avail_out===0)&&j!==1);return M===4?(j=i.deflateEnd(this.strm),this.onEnd(j),this.ended=!0,j===g):M!==2||(this.onEnd(g),!(_.avail_out=0))},v.prototype.onData=function(S){this.chunks.push(S)},v.prototype.onEnd=function(S){S===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=S,this.msg=this.strm.msg},s.Deflate=v,s.deflate=w,s.deflateRaw=function(S,T){return(T=T||{}).raw=!0,w(S,T)},s.gzip=function(S,T){return(T=T||{}).gzip=!0,w(S,T)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,s){var i=n("./zlib/inflate"),o=n("./utils/common"),l=n("./utils/strings"),d=n("./zlib/constants"),f=n("./zlib/messages"),p=n("./zlib/zstream"),g=n("./zlib/gzheader"),y=Object.prototype.toString;function m(v){if(!(this instanceof m))return new m(v);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},v||{});var w=this.options;w.raw&&0<=w.windowBits&&w.windowBits<16&&(w.windowBits=-w.windowBits,w.windowBits===0&&(w.windowBits=-15)),!(0<=w.windowBits&&w.windowBits<16)||v&&v.windowBits||(w.windowBits+=32),15<w.windowBits&&w.windowBits<48&&(15&w.windowBits)==0&&(w.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var S=i.inflateInit2(this.strm,w.windowBits);if(S!==d.Z_OK)throw new Error(f[S]);this.header=new g,i.inflateGetHeader(this.strm,this.header)}function b(v,w){var S=new m(w);if(S.push(v,!0),S.err)throw S.msg||f[S.err];return S.result}m.prototype.push=function(v,w){var S,T,j,M,_,R,O=this.strm,L=this.options.chunkSize,A=this.options.dictionary,F=!1;if(this.ended)return!1;T=w===~~w?w:w===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof v=="string"?O.input=l.binstring2buf(v):y.call(v)==="[object ArrayBuffer]"?O.input=new Uint8Array(v):O.input=v,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new o.Buf8(L),O.next_out=0,O.avail_out=L),(S=i.inflate(O,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&A&&(R=typeof A=="string"?l.string2buf(A):y.call(A)==="[object ArrayBuffer]"?new Uint8Array(A):A,S=i.inflateSetDictionary(this.strm,R)),S===d.Z_BUF_ERROR&&F===!0&&(S=d.Z_OK,F=!1),S!==d.Z_STREAM_END&&S!==d.Z_OK)return this.onEnd(S),!(this.ended=!0);O.next_out&&(O.avail_out!==0&&S!==d.Z_STREAM_END&&(O.avail_in!==0||T!==d.Z_FINISH&&T!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(j=l.utf8border(O.output,O.next_out),M=O.next_out-j,_=l.buf2string(O.output,j),O.next_out=M,O.avail_out=L-M,M&&o.arraySet(O.output,O.output,j,M,0),this.onData(_)):this.onData(o.shrinkBuf(O.output,O.next_out)))),O.avail_in===0&&O.avail_out===0&&(F=!0)}while((0<O.avail_in||O.avail_out===0)&&S!==d.Z_STREAM_END);return S===d.Z_STREAM_END&&(T=d.Z_FINISH),T===d.Z_FINISH?(S=i.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===d.Z_OK):T!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(O.avail_out=0))},m.prototype.onData=function(v){this.chunks.push(v)},m.prototype.onEnd=function(v){v===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},s.Inflate=m,s.inflate=b,s.inflateRaw=function(v,w){return(w=w||{}).raw=!0,b(v,w)},s.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(d){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var p=f.shift();if(p){if(typeof p!="object")throw new TypeError(p+"must be non-object");for(var g in p)p.hasOwnProperty(g)&&(d[g]=p[g])}}return d},s.shrinkBuf=function(d,f){return d.length===f?d:d.subarray?d.subarray(0,f):(d.length=f,d)};var o={arraySet:function(d,f,p,g,y){if(f.subarray&&d.subarray)d.set(f.subarray(p,p+g),y);else for(var m=0;m<g;m++)d[y+m]=f[p+m]},flattenChunks:function(d){var f,p,g,y,m,b;for(f=g=0,p=d.length;f<p;f++)g+=d[f].length;for(b=new Uint8Array(g),f=y=0,p=d.length;f<p;f++)m=d[f],b.set(m,y),y+=m.length;return b}},l={arraySet:function(d,f,p,g,y){for(var m=0;m<g;m++)d[y+m]=f[p+m]},flattenChunks:function(d){return[].concat.apply([],d)}};s.setTyped=function(d){d?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,o)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,l))},s.setTyped(i)},{}],42:[function(n,r,s){var i=n("./common"),o=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var d=new i.Buf8(256),f=0;f<256;f++)d[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function p(g,y){if(y<65537&&(g.subarray&&l||!g.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(g,y));for(var m="",b=0;b<y;b++)m+=String.fromCharCode(g[b]);return m}d[254]=d[254]=1,s.string2buf=function(g){var y,m,b,v,w,S=g.length,T=0;for(v=0;v<S;v++)(64512&(m=g.charCodeAt(v)))==55296&&v+1<S&&(64512&(b=g.charCodeAt(v+1)))==56320&&(m=65536+(m-55296<<10)+(b-56320),v++),T+=m<128?1:m<2048?2:m<65536?3:4;for(y=new i.Buf8(T),v=w=0;w<T;v++)(64512&(m=g.charCodeAt(v)))==55296&&v+1<S&&(64512&(b=g.charCodeAt(v+1)))==56320&&(m=65536+(m-55296<<10)+(b-56320),v++),m<128?y[w++]=m:(m<2048?y[w++]=192|m>>>6:(m<65536?y[w++]=224|m>>>12:(y[w++]=240|m>>>18,y[w++]=128|m>>>12&63),y[w++]=128|m>>>6&63),y[w++]=128|63&m);return y},s.buf2binstring=function(g){return p(g,g.length)},s.binstring2buf=function(g){for(var y=new i.Buf8(g.length),m=0,b=y.length;m<b;m++)y[m]=g.charCodeAt(m);return y},s.buf2string=function(g,y){var m,b,v,w,S=y||g.length,T=new Array(2*S);for(m=b=0;m<S;)if((v=g[m++])<128)T[b++]=v;else if(4<(w=d[v]))T[b++]=65533,m+=w-1;else{for(v&=w===2?31:w===3?15:7;1<w&&m<S;)v=v<<6|63&g[m++],w--;1<w?T[b++]=65533:v<65536?T[b++]=v:(v-=65536,T[b++]=55296|v>>10&1023,T[b++]=56320|1023&v)}return p(T,b)},s.utf8border=function(g,y){var m;for((y=y||g.length)>g.length&&(y=g.length),m=y-1;0<=m&&(192&g[m])==128;)m--;return m<0||m===0?y:m+d[g[m]]>y?m:y}},{"./common":41}],43:[function(n,r,s){r.exports=function(i,o,l,d){for(var f=65535&i|0,p=i>>>16&65535|0,g=0;l!==0;){for(l-=g=2e3<l?2e3:l;p=p+(f=f+o[d++]|0)|0,--g;);f%=65521,p%=65521}return f|p<<16|0}},{}],44:[function(n,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,s){var i=(function(){for(var o,l=[],d=0;d<256;d++){o=d;for(var f=0;f<8;f++)o=1&o?3988292384^o>>>1:o>>>1;l[d]=o}return l})();r.exports=function(o,l,d,f){var p=i,g=f+d;o^=-1;for(var y=f;y<g;y++)o=o>>>8^p[255&(o^l[y])];return-1^o}},{}],46:[function(n,r,s){var i,o=n("../utils/common"),l=n("./trees"),d=n("./adler32"),f=n("./crc32"),p=n("./messages"),g=0,y=4,m=0,b=-2,v=-1,w=4,S=2,T=8,j=9,M=286,_=30,R=19,O=2*M+1,L=15,A=3,F=258,H=F+A+1,P=42,B=113,E=1,K=2,q=3,V=4;function ie(z,fe){return z.msg=p[fe],fe}function Y(z){return(z<<1)-(4<z?9:0)}function X(z){for(var fe=z.length;0<=--fe;)z[fe]=0}function I(z){var fe=z.state,ue=fe.pending;ue>z.avail_out&&(ue=z.avail_out),ue!==0&&(o.arraySet(z.output,fe.pending_buf,fe.pending_out,ue,z.next_out),z.next_out+=ue,fe.pending_out+=ue,z.total_out+=ue,z.avail_out-=ue,fe.pending-=ue,fe.pending===0&&(fe.pending_out=0))}function U(z,fe){l._tr_flush_block(z,0<=z.block_start?z.block_start:-1,z.strstart-z.block_start,fe),z.block_start=z.strstart,I(z.strm)}function te(z,fe){z.pending_buf[z.pending++]=fe}function Z(z,fe){z.pending_buf[z.pending++]=fe>>>8&255,z.pending_buf[z.pending++]=255&fe}function re(z,fe){var ue,W,Q=z.max_chain_length,ee=z.strstart,pe=z.prev_length,we=z.nice_match,ae=z.strstart>z.w_size-H?z.strstart-(z.w_size-H):0,xe=z.window,Ce=z.w_mask,Te=z.prev,De=z.strstart+F,Ze=xe[ee+pe-1],Ue=xe[ee+pe];z.prev_length>=z.good_match&&(Q>>=2),we>z.lookahead&&(we=z.lookahead);do if(xe[(ue=fe)+pe]===Ue&&xe[ue+pe-1]===Ze&&xe[ue]===xe[ee]&&xe[++ue]===xe[ee+1]){ee+=2,ue++;do;while(xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&ee<De);if(W=F-(De-ee),ee=De-F,pe<W){if(z.match_start=fe,we<=(pe=W))break;Ze=xe[ee+pe-1],Ue=xe[ee+pe]}}while((fe=Te[fe&Ce])>ae&&--Q!=0);return pe<=z.lookahead?pe:z.lookahead}function se(z){var fe,ue,W,Q,ee,pe,we,ae,xe,Ce,Te=z.w_size;do{if(Q=z.window_size-z.lookahead-z.strstart,z.strstart>=Te+(Te-H)){for(o.arraySet(z.window,z.window,Te,Te,0),z.match_start-=Te,z.strstart-=Te,z.block_start-=Te,fe=ue=z.hash_size;W=z.head[--fe],z.head[fe]=Te<=W?W-Te:0,--ue;);for(fe=ue=Te;W=z.prev[--fe],z.prev[fe]=Te<=W?W-Te:0,--ue;);Q+=Te}if(z.strm.avail_in===0)break;if(pe=z.strm,we=z.window,ae=z.strstart+z.lookahead,xe=Q,Ce=void 0,Ce=pe.avail_in,xe<Ce&&(Ce=xe),ue=Ce===0?0:(pe.avail_in-=Ce,o.arraySet(we,pe.input,pe.next_in,Ce,ae),pe.state.wrap===1?pe.adler=d(pe.adler,we,Ce,ae):pe.state.wrap===2&&(pe.adler=f(pe.adler,we,Ce,ae)),pe.next_in+=Ce,pe.total_in+=Ce,Ce),z.lookahead+=ue,z.lookahead+z.insert>=A)for(ee=z.strstart-z.insert,z.ins_h=z.window[ee],z.ins_h=(z.ins_h<<z.hash_shift^z.window[ee+1])&z.hash_mask;z.insert&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[ee+A-1])&z.hash_mask,z.prev[ee&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=ee,ee++,z.insert--,!(z.lookahead+z.insert<A)););}while(z.lookahead<H&&z.strm.avail_in!==0)}function ge(z,fe){for(var ue,W;;){if(z.lookahead<H){if(se(z),z.lookahead<H&&fe===g)return E;if(z.lookahead===0)break}if(ue=0,z.lookahead>=A&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+A-1])&z.hash_mask,ue=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),ue!==0&&z.strstart-ue<=z.w_size-H&&(z.match_length=re(z,ue)),z.match_length>=A)if(W=l._tr_tally(z,z.strstart-z.match_start,z.match_length-A),z.lookahead-=z.match_length,z.match_length<=z.max_lazy_match&&z.lookahead>=A){for(z.match_length--;z.strstart++,z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+A-1])&z.hash_mask,ue=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart,--z.match_length!=0;);z.strstart++}else z.strstart+=z.match_length,z.match_length=0,z.ins_h=z.window[z.strstart],z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+1])&z.hash_mask;else W=l._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++;if(W&&(U(z,!1),z.strm.avail_out===0))return E}return z.insert=z.strstart<A-1?z.strstart:A-1,fe===y?(U(z,!0),z.strm.avail_out===0?q:V):z.last_lit&&(U(z,!1),z.strm.avail_out===0)?E:K}function be(z,fe){for(var ue,W,Q;;){if(z.lookahead<H){if(se(z),z.lookahead<H&&fe===g)return E;if(z.lookahead===0)break}if(ue=0,z.lookahead>=A&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+A-1])&z.hash_mask,ue=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),z.prev_length=z.match_length,z.prev_match=z.match_start,z.match_length=A-1,ue!==0&&z.prev_length<z.max_lazy_match&&z.strstart-ue<=z.w_size-H&&(z.match_length=re(z,ue),z.match_length<=5&&(z.strategy===1||z.match_length===A&&4096<z.strstart-z.match_start)&&(z.match_length=A-1)),z.prev_length>=A&&z.match_length<=z.prev_length){for(Q=z.strstart+z.lookahead-A,W=l._tr_tally(z,z.strstart-1-z.prev_match,z.prev_length-A),z.lookahead-=z.prev_length-1,z.prev_length-=2;++z.strstart<=Q&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+A-1])&z.hash_mask,ue=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),--z.prev_length!=0;);if(z.match_available=0,z.match_length=A-1,z.strstart++,W&&(U(z,!1),z.strm.avail_out===0))return E}else if(z.match_available){if((W=l._tr_tally(z,0,z.window[z.strstart-1]))&&U(z,!1),z.strstart++,z.lookahead--,z.strm.avail_out===0)return E}else z.match_available=1,z.strstart++,z.lookahead--}return z.match_available&&(W=l._tr_tally(z,0,z.window[z.strstart-1]),z.match_available=0),z.insert=z.strstart<A-1?z.strstart:A-1,fe===y?(U(z,!0),z.strm.avail_out===0?q:V):z.last_lit&&(U(z,!1),z.strm.avail_out===0)?E:K}function me(z,fe,ue,W,Q){this.good_length=z,this.max_lazy=fe,this.nice_length=ue,this.max_chain=W,this.func=Q}function Se(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*O),this.dyn_dtree=new o.Buf16(2*(2*_+1)),this.bl_tree=new o.Buf16(2*(2*R+1)),X(this.dyn_ltree),X(this.dyn_dtree),X(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(L+1),this.heap=new o.Buf16(2*M+1),X(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*M+1),X(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Oe(z){var fe;return z&&z.state?(z.total_in=z.total_out=0,z.data_type=S,(fe=z.state).pending=0,fe.pending_out=0,fe.wrap<0&&(fe.wrap=-fe.wrap),fe.status=fe.wrap?P:B,z.adler=fe.wrap===2?0:1,fe.last_flush=g,l._tr_init(fe),m):ie(z,b)}function He(z){var fe=Oe(z);return fe===m&&(function(ue){ue.window_size=2*ue.w_size,X(ue.head),ue.max_lazy_match=i[ue.level].max_lazy,ue.good_match=i[ue.level].good_length,ue.nice_match=i[ue.level].nice_length,ue.max_chain_length=i[ue.level].max_chain,ue.strstart=0,ue.block_start=0,ue.lookahead=0,ue.insert=0,ue.match_length=ue.prev_length=A-1,ue.match_available=0,ue.ins_h=0})(z.state),fe}function ut(z,fe,ue,W,Q,ee){if(!z)return b;var pe=1;if(fe===v&&(fe=6),W<0?(pe=0,W=-W):15<W&&(pe=2,W-=16),Q<1||j<Q||ue!==T||W<8||15<W||fe<0||9<fe||ee<0||w<ee)return ie(z,b);W===8&&(W=9);var we=new Se;return(z.state=we).strm=z,we.wrap=pe,we.gzhead=null,we.w_bits=W,we.w_size=1<<we.w_bits,we.w_mask=we.w_size-1,we.hash_bits=Q+7,we.hash_size=1<<we.hash_bits,we.hash_mask=we.hash_size-1,we.hash_shift=~~((we.hash_bits+A-1)/A),we.window=new o.Buf8(2*we.w_size),we.head=new o.Buf16(we.hash_size),we.prev=new o.Buf16(we.w_size),we.lit_bufsize=1<<Q+6,we.pending_buf_size=4*we.lit_bufsize,we.pending_buf=new o.Buf8(we.pending_buf_size),we.d_buf=1*we.lit_bufsize,we.l_buf=3*we.lit_bufsize,we.level=fe,we.strategy=ee,we.method=ue,He(z)}i=[new me(0,0,0,0,function(z,fe){var ue=65535;for(ue>z.pending_buf_size-5&&(ue=z.pending_buf_size-5);;){if(z.lookahead<=1){if(se(z),z.lookahead===0&&fe===g)return E;if(z.lookahead===0)break}z.strstart+=z.lookahead,z.lookahead=0;var W=z.block_start+ue;if((z.strstart===0||z.strstart>=W)&&(z.lookahead=z.strstart-W,z.strstart=W,U(z,!1),z.strm.avail_out===0)||z.strstart-z.block_start>=z.w_size-H&&(U(z,!1),z.strm.avail_out===0))return E}return z.insert=0,fe===y?(U(z,!0),z.strm.avail_out===0?q:V):(z.strstart>z.block_start&&(U(z,!1),z.strm.avail_out),E)}),new me(4,4,8,4,ge),new me(4,5,16,8,ge),new me(4,6,32,32,ge),new me(4,4,16,16,be),new me(8,16,32,32,be),new me(8,16,128,128,be),new me(8,32,128,256,be),new me(32,128,258,1024,be),new me(32,258,258,4096,be)],s.deflateInit=function(z,fe){return ut(z,fe,T,15,8,0)},s.deflateInit2=ut,s.deflateReset=He,s.deflateResetKeep=Oe,s.deflateSetHeader=function(z,fe){return z&&z.state?z.state.wrap!==2?b:(z.state.gzhead=fe,m):b},s.deflate=function(z,fe){var ue,W,Q,ee;if(!z||!z.state||5<fe||fe<0)return z?ie(z,b):b;if(W=z.state,!z.output||!z.input&&z.avail_in!==0||W.status===666&&fe!==y)return ie(z,z.avail_out===0?-5:b);if(W.strm=z,ue=W.last_flush,W.last_flush=fe,W.status===P)if(W.wrap===2)z.adler=0,te(W,31),te(W,139),te(W,8),W.gzhead?(te(W,(W.gzhead.text?1:0)+(W.gzhead.hcrc?2:0)+(W.gzhead.extra?4:0)+(W.gzhead.name?8:0)+(W.gzhead.comment?16:0)),te(W,255&W.gzhead.time),te(W,W.gzhead.time>>8&255),te(W,W.gzhead.time>>16&255),te(W,W.gzhead.time>>24&255),te(W,W.level===9?2:2<=W.strategy||W.level<2?4:0),te(W,255&W.gzhead.os),W.gzhead.extra&&W.gzhead.extra.length&&(te(W,255&W.gzhead.extra.length),te(W,W.gzhead.extra.length>>8&255)),W.gzhead.hcrc&&(z.adler=f(z.adler,W.pending_buf,W.pending,0)),W.gzindex=0,W.status=69):(te(W,0),te(W,0),te(W,0),te(W,0),te(W,0),te(W,W.level===9?2:2<=W.strategy||W.level<2?4:0),te(W,3),W.status=B);else{var pe=T+(W.w_bits-8<<4)<<8;pe|=(2<=W.strategy||W.level<2?0:W.level<6?1:W.level===6?2:3)<<6,W.strstart!==0&&(pe|=32),pe+=31-pe%31,W.status=B,Z(W,pe),W.strstart!==0&&(Z(W,z.adler>>>16),Z(W,65535&z.adler)),z.adler=1}if(W.status===69)if(W.gzhead.extra){for(Q=W.pending;W.gzindex<(65535&W.gzhead.extra.length)&&(W.pending!==W.pending_buf_size||(W.gzhead.hcrc&&W.pending>Q&&(z.adler=f(z.adler,W.pending_buf,W.pending-Q,Q)),I(z),Q=W.pending,W.pending!==W.pending_buf_size));)te(W,255&W.gzhead.extra[W.gzindex]),W.gzindex++;W.gzhead.hcrc&&W.pending>Q&&(z.adler=f(z.adler,W.pending_buf,W.pending-Q,Q)),W.gzindex===W.gzhead.extra.length&&(W.gzindex=0,W.status=73)}else W.status=73;if(W.status===73)if(W.gzhead.name){Q=W.pending;do{if(W.pending===W.pending_buf_size&&(W.gzhead.hcrc&&W.pending>Q&&(z.adler=f(z.adler,W.pending_buf,W.pending-Q,Q)),I(z),Q=W.pending,W.pending===W.pending_buf_size)){ee=1;break}ee=W.gzindex<W.gzhead.name.length?255&W.gzhead.name.charCodeAt(W.gzindex++):0,te(W,ee)}while(ee!==0);W.gzhead.hcrc&&W.pending>Q&&(z.adler=f(z.adler,W.pending_buf,W.pending-Q,Q)),ee===0&&(W.gzindex=0,W.status=91)}else W.status=91;if(W.status===91)if(W.gzhead.comment){Q=W.pending;do{if(W.pending===W.pending_buf_size&&(W.gzhead.hcrc&&W.pending>Q&&(z.adler=f(z.adler,W.pending_buf,W.pending-Q,Q)),I(z),Q=W.pending,W.pending===W.pending_buf_size)){ee=1;break}ee=W.gzindex<W.gzhead.comment.length?255&W.gzhead.comment.charCodeAt(W.gzindex++):0,te(W,ee)}while(ee!==0);W.gzhead.hcrc&&W.pending>Q&&(z.adler=f(z.adler,W.pending_buf,W.pending-Q,Q)),ee===0&&(W.status=103)}else W.status=103;if(W.status===103&&(W.gzhead.hcrc?(W.pending+2>W.pending_buf_size&&I(z),W.pending+2<=W.pending_buf_size&&(te(W,255&z.adler),te(W,z.adler>>8&255),z.adler=0,W.status=B)):W.status=B),W.pending!==0){if(I(z),z.avail_out===0)return W.last_flush=-1,m}else if(z.avail_in===0&&Y(fe)<=Y(ue)&&fe!==y)return ie(z,-5);if(W.status===666&&z.avail_in!==0)return ie(z,-5);if(z.avail_in!==0||W.lookahead!==0||fe!==g&&W.status!==666){var we=W.strategy===2?(function(ae,xe){for(var Ce;;){if(ae.lookahead===0&&(se(ae),ae.lookahead===0)){if(xe===g)return E;break}if(ae.match_length=0,Ce=l._tr_tally(ae,0,ae.window[ae.strstart]),ae.lookahead--,ae.strstart++,Ce&&(U(ae,!1),ae.strm.avail_out===0))return E}return ae.insert=0,xe===y?(U(ae,!0),ae.strm.avail_out===0?q:V):ae.last_lit&&(U(ae,!1),ae.strm.avail_out===0)?E:K})(W,fe):W.strategy===3?(function(ae,xe){for(var Ce,Te,De,Ze,Ue=ae.window;;){if(ae.lookahead<=F){if(se(ae),ae.lookahead<=F&&xe===g)return E;if(ae.lookahead===0)break}if(ae.match_length=0,ae.lookahead>=A&&0<ae.strstart&&(Te=Ue[De=ae.strstart-1])===Ue[++De]&&Te===Ue[++De]&&Te===Ue[++De]){Ze=ae.strstart+F;do;while(Te===Ue[++De]&&Te===Ue[++De]&&Te===Ue[++De]&&Te===Ue[++De]&&Te===Ue[++De]&&Te===Ue[++De]&&Te===Ue[++De]&&Te===Ue[++De]&&De<Ze);ae.match_length=F-(Ze-De),ae.match_length>ae.lookahead&&(ae.match_length=ae.lookahead)}if(ae.match_length>=A?(Ce=l._tr_tally(ae,1,ae.match_length-A),ae.lookahead-=ae.match_length,ae.strstart+=ae.match_length,ae.match_length=0):(Ce=l._tr_tally(ae,0,ae.window[ae.strstart]),ae.lookahead--,ae.strstart++),Ce&&(U(ae,!1),ae.strm.avail_out===0))return E}return ae.insert=0,xe===y?(U(ae,!0),ae.strm.avail_out===0?q:V):ae.last_lit&&(U(ae,!1),ae.strm.avail_out===0)?E:K})(W,fe):i[W.level].func(W,fe);if(we!==q&&we!==V||(W.status=666),we===E||we===q)return z.avail_out===0&&(W.last_flush=-1),m;if(we===K&&(fe===1?l._tr_align(W):fe!==5&&(l._tr_stored_block(W,0,0,!1),fe===3&&(X(W.head),W.lookahead===0&&(W.strstart=0,W.block_start=0,W.insert=0))),I(z),z.avail_out===0))return W.last_flush=-1,m}return fe!==y?m:W.wrap<=0?1:(W.wrap===2?(te(W,255&z.adler),te(W,z.adler>>8&255),te(W,z.adler>>16&255),te(W,z.adler>>24&255),te(W,255&z.total_in),te(W,z.total_in>>8&255),te(W,z.total_in>>16&255),te(W,z.total_in>>24&255)):(Z(W,z.adler>>>16),Z(W,65535&z.adler)),I(z),0<W.wrap&&(W.wrap=-W.wrap),W.pending!==0?m:1)},s.deflateEnd=function(z){var fe;return z&&z.state?(fe=z.state.status)!==P&&fe!==69&&fe!==73&&fe!==91&&fe!==103&&fe!==B&&fe!==666?ie(z,b):(z.state=null,fe===B?ie(z,-3):m):b},s.deflateSetDictionary=function(z,fe){var ue,W,Q,ee,pe,we,ae,xe,Ce=fe.length;if(!z||!z.state||(ee=(ue=z.state).wrap)===2||ee===1&&ue.status!==P||ue.lookahead)return b;for(ee===1&&(z.adler=d(z.adler,fe,Ce,0)),ue.wrap=0,Ce>=ue.w_size&&(ee===0&&(X(ue.head),ue.strstart=0,ue.block_start=0,ue.insert=0),xe=new o.Buf8(ue.w_size),o.arraySet(xe,fe,Ce-ue.w_size,ue.w_size,0),fe=xe,Ce=ue.w_size),pe=z.avail_in,we=z.next_in,ae=z.input,z.avail_in=Ce,z.next_in=0,z.input=fe,se(ue);ue.lookahead>=A;){for(W=ue.strstart,Q=ue.lookahead-(A-1);ue.ins_h=(ue.ins_h<<ue.hash_shift^ue.window[W+A-1])&ue.hash_mask,ue.prev[W&ue.w_mask]=ue.head[ue.ins_h],ue.head[ue.ins_h]=W,W++,--Q;);ue.strstart=W,ue.lookahead=A-1,se(ue)}return ue.strstart+=ue.lookahead,ue.block_start=ue.strstart,ue.insert=ue.lookahead,ue.lookahead=0,ue.match_length=ue.prev_length=A-1,ue.match_available=0,z.next_in=we,z.input=ae,z.avail_in=pe,ue.wrap=ee,m},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,s){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,s){r.exports=function(i,o){var l,d,f,p,g,y,m,b,v,w,S,T,j,M,_,R,O,L,A,F,H,P,B,E,K;l=i.state,d=i.next_in,E=i.input,f=d+(i.avail_in-5),p=i.next_out,K=i.output,g=p-(o-i.avail_out),y=p+(i.avail_out-257),m=l.dmax,b=l.wsize,v=l.whave,w=l.wnext,S=l.window,T=l.hold,j=l.bits,M=l.lencode,_=l.distcode,R=(1<<l.lenbits)-1,O=(1<<l.distbits)-1;e:do{j<15&&(T+=E[d++]<<j,j+=8,T+=E[d++]<<j,j+=8),L=M[T&R];t:for(;;){if(T>>>=A=L>>>24,j-=A,(A=L>>>16&255)===0)K[p++]=65535&L;else{if(!(16&A)){if((64&A)==0){L=M[(65535&L)+(T&(1<<A)-1)];continue t}if(32&A){l.mode=12;break e}i.msg="invalid literal/length code",l.mode=30;break e}F=65535&L,(A&=15)&&(j<A&&(T+=E[d++]<<j,j+=8),F+=T&(1<<A)-1,T>>>=A,j-=A),j<15&&(T+=E[d++]<<j,j+=8,T+=E[d++]<<j,j+=8),L=_[T&O];n:for(;;){if(T>>>=A=L>>>24,j-=A,!(16&(A=L>>>16&255))){if((64&A)==0){L=_[(65535&L)+(T&(1<<A)-1)];continue n}i.msg="invalid distance code",l.mode=30;break e}if(H=65535&L,j<(A&=15)&&(T+=E[d++]<<j,(j+=8)<A&&(T+=E[d++]<<j,j+=8)),m<(H+=T&(1<<A)-1)){i.msg="invalid distance too far back",l.mode=30;break e}if(T>>>=A,j-=A,(A=p-g)<H){if(v<(A=H-A)&&l.sane){i.msg="invalid distance too far back",l.mode=30;break e}if(B=S,(P=0)===w){if(P+=b-A,A<F){for(F-=A;K[p++]=S[P++],--A;);P=p-H,B=K}}else if(w<A){if(P+=b+w-A,(A-=w)<F){for(F-=A;K[p++]=S[P++],--A;);if(P=0,w<F){for(F-=A=w;K[p++]=S[P++],--A;);P=p-H,B=K}}}else if(P+=w-A,A<F){for(F-=A;K[p++]=S[P++],--A;);P=p-H,B=K}for(;2<F;)K[p++]=B[P++],K[p++]=B[P++],K[p++]=B[P++],F-=3;F&&(K[p++]=B[P++],1<F&&(K[p++]=B[P++]))}else{for(P=p-H;K[p++]=K[P++],K[p++]=K[P++],K[p++]=K[P++],2<(F-=3););F&&(K[p++]=K[P++],1<F&&(K[p++]=K[P++]))}break}}break}}while(d<f&&p<y);d-=F=j>>3,T&=(1<<(j-=F<<3))-1,i.next_in=d,i.next_out=p,i.avail_in=d<f?f-d+5:5-(d-f),i.avail_out=p<y?y-p+257:257-(p-y),l.hold=T,l.bits=j}},{}],49:[function(n,r,s){var i=n("../utils/common"),o=n("./adler32"),l=n("./crc32"),d=n("./inffast"),f=n("./inftrees"),p=1,g=2,y=0,m=-2,b=1,v=852,w=592;function S(P){return(P>>>24&255)+(P>>>8&65280)+((65280&P)<<8)+((255&P)<<24)}function T(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function j(P){var B;return P&&P.state?(B=P.state,P.total_in=P.total_out=B.total=0,P.msg="",B.wrap&&(P.adler=1&B.wrap),B.mode=b,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new i.Buf32(v),B.distcode=B.distdyn=new i.Buf32(w),B.sane=1,B.back=-1,y):m}function M(P){var B;return P&&P.state?((B=P.state).wsize=0,B.whave=0,B.wnext=0,j(P)):m}function _(P,B){var E,K;return P&&P.state?(K=P.state,B<0?(E=0,B=-B):(E=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?m:(K.window!==null&&K.wbits!==B&&(K.window=null),K.wrap=E,K.wbits=B,M(P))):m}function R(P,B){var E,K;return P?(K=new T,(P.state=K).window=null,(E=_(P,B))!==y&&(P.state=null),E):m}var O,L,A=!0;function F(P){if(A){var B;for(O=new i.Buf32(512),L=new i.Buf32(32),B=0;B<144;)P.lens[B++]=8;for(;B<256;)P.lens[B++]=9;for(;B<280;)P.lens[B++]=7;for(;B<288;)P.lens[B++]=8;for(f(p,P.lens,0,288,O,0,P.work,{bits:9}),B=0;B<32;)P.lens[B++]=5;f(g,P.lens,0,32,L,0,P.work,{bits:5}),A=!1}P.lencode=O,P.lenbits=9,P.distcode=L,P.distbits=5}function H(P,B,E,K){var q,V=P.state;return V.window===null&&(V.wsize=1<<V.wbits,V.wnext=0,V.whave=0,V.window=new i.Buf8(V.wsize)),K>=V.wsize?(i.arraySet(V.window,B,E-V.wsize,V.wsize,0),V.wnext=0,V.whave=V.wsize):(K<(q=V.wsize-V.wnext)&&(q=K),i.arraySet(V.window,B,E-K,q,V.wnext),(K-=q)?(i.arraySet(V.window,B,E-K,K,0),V.wnext=K,V.whave=V.wsize):(V.wnext+=q,V.wnext===V.wsize&&(V.wnext=0),V.whave<V.wsize&&(V.whave+=q))),0}s.inflateReset=M,s.inflateReset2=_,s.inflateResetKeep=j,s.inflateInit=function(P){return R(P,15)},s.inflateInit2=R,s.inflate=function(P,B){var E,K,q,V,ie,Y,X,I,U,te,Z,re,se,ge,be,me,Se,Oe,He,ut,z,fe,ue,W,Q=0,ee=new i.Buf8(4),pe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return m;(E=P.state).mode===12&&(E.mode=13),ie=P.next_out,q=P.output,X=P.avail_out,V=P.next_in,K=P.input,Y=P.avail_in,I=E.hold,U=E.bits,te=Y,Z=X,fe=y;e:for(;;)switch(E.mode){case b:if(E.wrap===0){E.mode=13;break}for(;U<16;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}if(2&E.wrap&&I===35615){ee[E.check=0]=255&I,ee[1]=I>>>8&255,E.check=l(E.check,ee,2,0),U=I=0,E.mode=2;break}if(E.flags=0,E.head&&(E.head.done=!1),!(1&E.wrap)||(((255&I)<<8)+(I>>8))%31){P.msg="incorrect header check",E.mode=30;break}if((15&I)!=8){P.msg="unknown compression method",E.mode=30;break}if(U-=4,z=8+(15&(I>>>=4)),E.wbits===0)E.wbits=z;else if(z>E.wbits){P.msg="invalid window size",E.mode=30;break}E.dmax=1<<z,P.adler=E.check=1,E.mode=512&I?10:12,U=I=0;break;case 2:for(;U<16;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}if(E.flags=I,(255&E.flags)!=8){P.msg="unknown compression method",E.mode=30;break}if(57344&E.flags){P.msg="unknown header flags set",E.mode=30;break}E.head&&(E.head.text=I>>8&1),512&E.flags&&(ee[0]=255&I,ee[1]=I>>>8&255,E.check=l(E.check,ee,2,0)),U=I=0,E.mode=3;case 3:for(;U<32;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}E.head&&(E.head.time=I),512&E.flags&&(ee[0]=255&I,ee[1]=I>>>8&255,ee[2]=I>>>16&255,ee[3]=I>>>24&255,E.check=l(E.check,ee,4,0)),U=I=0,E.mode=4;case 4:for(;U<16;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}E.head&&(E.head.xflags=255&I,E.head.os=I>>8),512&E.flags&&(ee[0]=255&I,ee[1]=I>>>8&255,E.check=l(E.check,ee,2,0)),U=I=0,E.mode=5;case 5:if(1024&E.flags){for(;U<16;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}E.length=I,E.head&&(E.head.extra_len=I),512&E.flags&&(ee[0]=255&I,ee[1]=I>>>8&255,E.check=l(E.check,ee,2,0)),U=I=0}else E.head&&(E.head.extra=null);E.mode=6;case 6:if(1024&E.flags&&(Y<(re=E.length)&&(re=Y),re&&(E.head&&(z=E.head.extra_len-E.length,E.head.extra||(E.head.extra=new Array(E.head.extra_len)),i.arraySet(E.head.extra,K,V,re,z)),512&E.flags&&(E.check=l(E.check,K,re,V)),Y-=re,V+=re,E.length-=re),E.length))break e;E.length=0,E.mode=7;case 7:if(2048&E.flags){if(Y===0)break e;for(re=0;z=K[V+re++],E.head&&z&&E.length<65536&&(E.head.name+=String.fromCharCode(z)),z&&re<Y;);if(512&E.flags&&(E.check=l(E.check,K,re,V)),Y-=re,V+=re,z)break e}else E.head&&(E.head.name=null);E.length=0,E.mode=8;case 8:if(4096&E.flags){if(Y===0)break e;for(re=0;z=K[V+re++],E.head&&z&&E.length<65536&&(E.head.comment+=String.fromCharCode(z)),z&&re<Y;);if(512&E.flags&&(E.check=l(E.check,K,re,V)),Y-=re,V+=re,z)break e}else E.head&&(E.head.comment=null);E.mode=9;case 9:if(512&E.flags){for(;U<16;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}if(I!==(65535&E.check)){P.msg="header crc mismatch",E.mode=30;break}U=I=0}E.head&&(E.head.hcrc=E.flags>>9&1,E.head.done=!0),P.adler=E.check=0,E.mode=12;break;case 10:for(;U<32;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}P.adler=E.check=S(I),U=I=0,E.mode=11;case 11:if(E.havedict===0)return P.next_out=ie,P.avail_out=X,P.next_in=V,P.avail_in=Y,E.hold=I,E.bits=U,2;P.adler=E.check=1,E.mode=12;case 12:if(B===5||B===6)break e;case 13:if(E.last){I>>>=7&U,U-=7&U,E.mode=27;break}for(;U<3;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}switch(E.last=1&I,U-=1,3&(I>>>=1)){case 0:E.mode=14;break;case 1:if(F(E),E.mode=20,B!==6)break;I>>>=2,U-=2;break e;case 2:E.mode=17;break;case 3:P.msg="invalid block type",E.mode=30}I>>>=2,U-=2;break;case 14:for(I>>>=7&U,U-=7&U;U<32;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}if((65535&I)!=(I>>>16^65535)){P.msg="invalid stored block lengths",E.mode=30;break}if(E.length=65535&I,U=I=0,E.mode=15,B===6)break e;case 15:E.mode=16;case 16:if(re=E.length){if(Y<re&&(re=Y),X<re&&(re=X),re===0)break e;i.arraySet(q,K,V,re,ie),Y-=re,V+=re,X-=re,ie+=re,E.length-=re;break}E.mode=12;break;case 17:for(;U<14;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}if(E.nlen=257+(31&I),I>>>=5,U-=5,E.ndist=1+(31&I),I>>>=5,U-=5,E.ncode=4+(15&I),I>>>=4,U-=4,286<E.nlen||30<E.ndist){P.msg="too many length or distance symbols",E.mode=30;break}E.have=0,E.mode=18;case 18:for(;E.have<E.ncode;){for(;U<3;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}E.lens[pe[E.have++]]=7&I,I>>>=3,U-=3}for(;E.have<19;)E.lens[pe[E.have++]]=0;if(E.lencode=E.lendyn,E.lenbits=7,ue={bits:E.lenbits},fe=f(0,E.lens,0,19,E.lencode,0,E.work,ue),E.lenbits=ue.bits,fe){P.msg="invalid code lengths set",E.mode=30;break}E.have=0,E.mode=19;case 19:for(;E.have<E.nlen+E.ndist;){for(;me=(Q=E.lencode[I&(1<<E.lenbits)-1])>>>16&255,Se=65535&Q,!((be=Q>>>24)<=U);){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}if(Se<16)I>>>=be,U-=be,E.lens[E.have++]=Se;else{if(Se===16){for(W=be+2;U<W;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}if(I>>>=be,U-=be,E.have===0){P.msg="invalid bit length repeat",E.mode=30;break}z=E.lens[E.have-1],re=3+(3&I),I>>>=2,U-=2}else if(Se===17){for(W=be+3;U<W;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}U-=be,z=0,re=3+(7&(I>>>=be)),I>>>=3,U-=3}else{for(W=be+7;U<W;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}U-=be,z=0,re=11+(127&(I>>>=be)),I>>>=7,U-=7}if(E.have+re>E.nlen+E.ndist){P.msg="invalid bit length repeat",E.mode=30;break}for(;re--;)E.lens[E.have++]=z}}if(E.mode===30)break;if(E.lens[256]===0){P.msg="invalid code -- missing end-of-block",E.mode=30;break}if(E.lenbits=9,ue={bits:E.lenbits},fe=f(p,E.lens,0,E.nlen,E.lencode,0,E.work,ue),E.lenbits=ue.bits,fe){P.msg="invalid literal/lengths set",E.mode=30;break}if(E.distbits=6,E.distcode=E.distdyn,ue={bits:E.distbits},fe=f(g,E.lens,E.nlen,E.ndist,E.distcode,0,E.work,ue),E.distbits=ue.bits,fe){P.msg="invalid distances set",E.mode=30;break}if(E.mode=20,B===6)break e;case 20:E.mode=21;case 21:if(6<=Y&&258<=X){P.next_out=ie,P.avail_out=X,P.next_in=V,P.avail_in=Y,E.hold=I,E.bits=U,d(P,Z),ie=P.next_out,q=P.output,X=P.avail_out,V=P.next_in,K=P.input,Y=P.avail_in,I=E.hold,U=E.bits,E.mode===12&&(E.back=-1);break}for(E.back=0;me=(Q=E.lencode[I&(1<<E.lenbits)-1])>>>16&255,Se=65535&Q,!((be=Q>>>24)<=U);){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}if(me&&(240&me)==0){for(Oe=be,He=me,ut=Se;me=(Q=E.lencode[ut+((I&(1<<Oe+He)-1)>>Oe)])>>>16&255,Se=65535&Q,!(Oe+(be=Q>>>24)<=U);){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}I>>>=Oe,U-=Oe,E.back+=Oe}if(I>>>=be,U-=be,E.back+=be,E.length=Se,me===0){E.mode=26;break}if(32&me){E.back=-1,E.mode=12;break}if(64&me){P.msg="invalid literal/length code",E.mode=30;break}E.extra=15&me,E.mode=22;case 22:if(E.extra){for(W=E.extra;U<W;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}E.length+=I&(1<<E.extra)-1,I>>>=E.extra,U-=E.extra,E.back+=E.extra}E.was=E.length,E.mode=23;case 23:for(;me=(Q=E.distcode[I&(1<<E.distbits)-1])>>>16&255,Se=65535&Q,!((be=Q>>>24)<=U);){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}if((240&me)==0){for(Oe=be,He=me,ut=Se;me=(Q=E.distcode[ut+((I&(1<<Oe+He)-1)>>Oe)])>>>16&255,Se=65535&Q,!(Oe+(be=Q>>>24)<=U);){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}I>>>=Oe,U-=Oe,E.back+=Oe}if(I>>>=be,U-=be,E.back+=be,64&me){P.msg="invalid distance code",E.mode=30;break}E.offset=Se,E.extra=15&me,E.mode=24;case 24:if(E.extra){for(W=E.extra;U<W;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}E.offset+=I&(1<<E.extra)-1,I>>>=E.extra,U-=E.extra,E.back+=E.extra}if(E.offset>E.dmax){P.msg="invalid distance too far back",E.mode=30;break}E.mode=25;case 25:if(X===0)break e;if(re=Z-X,E.offset>re){if((re=E.offset-re)>E.whave&&E.sane){P.msg="invalid distance too far back",E.mode=30;break}se=re>E.wnext?(re-=E.wnext,E.wsize-re):E.wnext-re,re>E.length&&(re=E.length),ge=E.window}else ge=q,se=ie-E.offset,re=E.length;for(X<re&&(re=X),X-=re,E.length-=re;q[ie++]=ge[se++],--re;);E.length===0&&(E.mode=21);break;case 26:if(X===0)break e;q[ie++]=E.length,X--,E.mode=21;break;case 27:if(E.wrap){for(;U<32;){if(Y===0)break e;Y--,I|=K[V++]<<U,U+=8}if(Z-=X,P.total_out+=Z,E.total+=Z,Z&&(P.adler=E.check=E.flags?l(E.check,q,Z,ie-Z):o(E.check,q,Z,ie-Z)),Z=X,(E.flags?I:S(I))!==E.check){P.msg="incorrect data check",E.mode=30;break}U=I=0}E.mode=28;case 28:if(E.wrap&&E.flags){for(;U<32;){if(Y===0)break e;Y--,I+=K[V++]<<U,U+=8}if(I!==(4294967295&E.total)){P.msg="incorrect length check",E.mode=30;break}U=I=0}E.mode=29;case 29:fe=1;break e;case 30:fe=-3;break e;case 31:return-4;case 32:default:return m}return P.next_out=ie,P.avail_out=X,P.next_in=V,P.avail_in=Y,E.hold=I,E.bits=U,(E.wsize||Z!==P.avail_out&&E.mode<30&&(E.mode<27||B!==4))&&H(P,P.output,P.next_out,Z-P.avail_out)?(E.mode=31,-4):(te-=P.avail_in,Z-=P.avail_out,P.total_in+=te,P.total_out+=Z,E.total+=Z,E.wrap&&Z&&(P.adler=E.check=E.flags?l(E.check,q,Z,P.next_out-Z):o(E.check,q,Z,P.next_out-Z)),P.data_type=E.bits+(E.last?64:0)+(E.mode===12?128:0)+(E.mode===20||E.mode===15?256:0),(te==0&&Z===0||B===4)&&fe===y&&(fe=-5),fe)},s.inflateEnd=function(P){if(!P||!P.state)return m;var B=P.state;return B.window&&(B.window=null),P.state=null,y},s.inflateGetHeader=function(P,B){var E;return P&&P.state?(2&(E=P.state).wrap)==0?m:((E.head=B).done=!1,y):m},s.inflateSetDictionary=function(P,B){var E,K=B.length;return P&&P.state?(E=P.state).wrap!==0&&E.mode!==11?m:E.mode===11&&o(1,B,K,0)!==E.check?-3:H(P,B,K,K)?(E.mode=31,-4):(E.havedict=1,y):m},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,s){var i=n("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(p,g,y,m,b,v,w,S){var T,j,M,_,R,O,L,A,F,H=S.bits,P=0,B=0,E=0,K=0,q=0,V=0,ie=0,Y=0,X=0,I=0,U=null,te=0,Z=new i.Buf16(16),re=new i.Buf16(16),se=null,ge=0;for(P=0;P<=15;P++)Z[P]=0;for(B=0;B<m;B++)Z[g[y+B]]++;for(q=H,K=15;1<=K&&Z[K]===0;K--);if(K<q&&(q=K),K===0)return b[v++]=20971520,b[v++]=20971520,S.bits=1,0;for(E=1;E<K&&Z[E]===0;E++);for(q<E&&(q=E),P=Y=1;P<=15;P++)if(Y<<=1,(Y-=Z[P])<0)return-1;if(0<Y&&(p===0||K!==1))return-1;for(re[1]=0,P=1;P<15;P++)re[P+1]=re[P]+Z[P];for(B=0;B<m;B++)g[y+B]!==0&&(w[re[g[y+B]]++]=B);if(O=p===0?(U=se=w,19):p===1?(U=o,te-=257,se=l,ge-=257,256):(U=d,se=f,-1),P=E,R=v,ie=B=I=0,M=-1,_=(X=1<<(V=q))-1,p===1&&852<X||p===2&&592<X)return 1;for(;;){for(L=P-ie,F=w[B]<O?(A=0,w[B]):w[B]>O?(A=se[ge+w[B]],U[te+w[B]]):(A=96,0),T=1<<P-ie,E=j=1<<V;b[R+(I>>ie)+(j-=T)]=L<<24|A<<16|F|0,j!==0;);for(T=1<<P-1;I&T;)T>>=1;if(T!==0?(I&=T-1,I+=T):I=0,B++,--Z[P]==0){if(P===K)break;P=g[y+w[B]]}if(q<P&&(I&_)!==M){for(ie===0&&(ie=q),R+=E,Y=1<<(V=P-ie);V+ie<K&&!((Y-=Z[V+ie])<=0);)V++,Y<<=1;if(X+=1<<V,p===1&&852<X||p===2&&592<X)return 1;b[M=I&_]=q<<24|V<<16|R-v|0}}return I!==0&&(b[R+I]=P-ie<<24|64<<16|0),S.bits=q,0}},{"../utils/common":41}],51:[function(n,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,s){var i=n("../utils/common"),o=0,l=1;function d(Q){for(var ee=Q.length;0<=--ee;)Q[ee]=0}var f=0,p=29,g=256,y=g+1+p,m=30,b=19,v=2*y+1,w=15,S=16,T=7,j=256,M=16,_=17,R=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],L=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=new Array(2*(y+2));d(H);var P=new Array(2*m);d(P);var B=new Array(512);d(B);var E=new Array(256);d(E);var K=new Array(p);d(K);var q,V,ie,Y=new Array(m);function X(Q,ee,pe,we,ae){this.static_tree=Q,this.extra_bits=ee,this.extra_base=pe,this.elems=we,this.max_length=ae,this.has_stree=Q&&Q.length}function I(Q,ee){this.dyn_tree=Q,this.max_code=0,this.stat_desc=ee}function U(Q){return Q<256?B[Q]:B[256+(Q>>>7)]}function te(Q,ee){Q.pending_buf[Q.pending++]=255&ee,Q.pending_buf[Q.pending++]=ee>>>8&255}function Z(Q,ee,pe){Q.bi_valid>S-pe?(Q.bi_buf|=ee<<Q.bi_valid&65535,te(Q,Q.bi_buf),Q.bi_buf=ee>>S-Q.bi_valid,Q.bi_valid+=pe-S):(Q.bi_buf|=ee<<Q.bi_valid&65535,Q.bi_valid+=pe)}function re(Q,ee,pe){Z(Q,pe[2*ee],pe[2*ee+1])}function se(Q,ee){for(var pe=0;pe|=1&Q,Q>>>=1,pe<<=1,0<--ee;);return pe>>>1}function ge(Q,ee,pe){var we,ae,xe=new Array(w+1),Ce=0;for(we=1;we<=w;we++)xe[we]=Ce=Ce+pe[we-1]<<1;for(ae=0;ae<=ee;ae++){var Te=Q[2*ae+1];Te!==0&&(Q[2*ae]=se(xe[Te]++,Te))}}function be(Q){var ee;for(ee=0;ee<y;ee++)Q.dyn_ltree[2*ee]=0;for(ee=0;ee<m;ee++)Q.dyn_dtree[2*ee]=0;for(ee=0;ee<b;ee++)Q.bl_tree[2*ee]=0;Q.dyn_ltree[2*j]=1,Q.opt_len=Q.static_len=0,Q.last_lit=Q.matches=0}function me(Q){8<Q.bi_valid?te(Q,Q.bi_buf):0<Q.bi_valid&&(Q.pending_buf[Q.pending++]=Q.bi_buf),Q.bi_buf=0,Q.bi_valid=0}function Se(Q,ee,pe,we){var ae=2*ee,xe=2*pe;return Q[ae]<Q[xe]||Q[ae]===Q[xe]&&we[ee]<=we[pe]}function Oe(Q,ee,pe){for(var we=Q.heap[pe],ae=pe<<1;ae<=Q.heap_len&&(ae<Q.heap_len&&Se(ee,Q.heap[ae+1],Q.heap[ae],Q.depth)&&ae++,!Se(ee,we,Q.heap[ae],Q.depth));)Q.heap[pe]=Q.heap[ae],pe=ae,ae<<=1;Q.heap[pe]=we}function He(Q,ee,pe){var we,ae,xe,Ce,Te=0;if(Q.last_lit!==0)for(;we=Q.pending_buf[Q.d_buf+2*Te]<<8|Q.pending_buf[Q.d_buf+2*Te+1],ae=Q.pending_buf[Q.l_buf+Te],Te++,we===0?re(Q,ae,ee):(re(Q,(xe=E[ae])+g+1,ee),(Ce=O[xe])!==0&&Z(Q,ae-=K[xe],Ce),re(Q,xe=U(--we),pe),(Ce=L[xe])!==0&&Z(Q,we-=Y[xe],Ce)),Te<Q.last_lit;);re(Q,j,ee)}function ut(Q,ee){var pe,we,ae,xe=ee.dyn_tree,Ce=ee.stat_desc.static_tree,Te=ee.stat_desc.has_stree,De=ee.stat_desc.elems,Ze=-1;for(Q.heap_len=0,Q.heap_max=v,pe=0;pe<De;pe++)xe[2*pe]!==0?(Q.heap[++Q.heap_len]=Ze=pe,Q.depth[pe]=0):xe[2*pe+1]=0;for(;Q.heap_len<2;)xe[2*(ae=Q.heap[++Q.heap_len]=Ze<2?++Ze:0)]=1,Q.depth[ae]=0,Q.opt_len--,Te&&(Q.static_len-=Ce[2*ae+1]);for(ee.max_code=Ze,pe=Q.heap_len>>1;1<=pe;pe--)Oe(Q,xe,pe);for(ae=De;pe=Q.heap[1],Q.heap[1]=Q.heap[Q.heap_len--],Oe(Q,xe,1),we=Q.heap[1],Q.heap[--Q.heap_max]=pe,Q.heap[--Q.heap_max]=we,xe[2*ae]=xe[2*pe]+xe[2*we],Q.depth[ae]=(Q.depth[pe]>=Q.depth[we]?Q.depth[pe]:Q.depth[we])+1,xe[2*pe+1]=xe[2*we+1]=ae,Q.heap[1]=ae++,Oe(Q,xe,1),2<=Q.heap_len;);Q.heap[--Q.heap_max]=Q.heap[1],(function(Ue,$t){var Jr,Bt,fs,dt,qt,Cn,Nt=$t.dyn_tree,Co=$t.max_code,No=$t.stat_desc.static_tree,sc=$t.stat_desc.has_stree,mi=$t.stat_desc.extra_bits,Rs=$t.stat_desc.extra_base,vt=$t.stat_desc.max_length,Tt=0;for(dt=0;dt<=w;dt++)Ue.bl_count[dt]=0;for(Nt[2*Ue.heap[Ue.heap_max]+1]=0,Jr=Ue.heap_max+1;Jr<v;Jr++)vt<(dt=Nt[2*Nt[2*(Bt=Ue.heap[Jr])+1]+1]+1)&&(dt=vt,Tt++),Nt[2*Bt+1]=dt,Co<Bt||(Ue.bl_count[dt]++,qt=0,Rs<=Bt&&(qt=mi[Bt-Rs]),Cn=Nt[2*Bt],Ue.opt_len+=Cn*(dt+qt),sc&&(Ue.static_len+=Cn*(No[2*Bt+1]+qt)));if(Tt!==0){do{for(dt=vt-1;Ue.bl_count[dt]===0;)dt--;Ue.bl_count[dt]--,Ue.bl_count[dt+1]+=2,Ue.bl_count[vt]--,Tt-=2}while(0<Tt);for(dt=vt;dt!==0;dt--)for(Bt=Ue.bl_count[dt];Bt!==0;)Co<(fs=Ue.heap[--Jr])||(Nt[2*fs+1]!==dt&&(Ue.opt_len+=(dt-Nt[2*fs+1])*Nt[2*fs],Nt[2*fs+1]=dt),Bt--)}})(Q,ee),ge(xe,Ze,Q.bl_count)}function z(Q,ee,pe){var we,ae,xe=-1,Ce=ee[1],Te=0,De=7,Ze=4;for(Ce===0&&(De=138,Ze=3),ee[2*(pe+1)+1]=65535,we=0;we<=pe;we++)ae=Ce,Ce=ee[2*(we+1)+1],++Te<De&&ae===Ce||(Te<Ze?Q.bl_tree[2*ae]+=Te:ae!==0?(ae!==xe&&Q.bl_tree[2*ae]++,Q.bl_tree[2*M]++):Te<=10?Q.bl_tree[2*_]++:Q.bl_tree[2*R]++,xe=ae,Ze=(Te=0)===Ce?(De=138,3):ae===Ce?(De=6,3):(De=7,4))}function fe(Q,ee,pe){var we,ae,xe=-1,Ce=ee[1],Te=0,De=7,Ze=4;for(Ce===0&&(De=138,Ze=3),we=0;we<=pe;we++)if(ae=Ce,Ce=ee[2*(we+1)+1],!(++Te<De&&ae===Ce)){if(Te<Ze)for(;re(Q,ae,Q.bl_tree),--Te!=0;);else ae!==0?(ae!==xe&&(re(Q,ae,Q.bl_tree),Te--),re(Q,M,Q.bl_tree),Z(Q,Te-3,2)):Te<=10?(re(Q,_,Q.bl_tree),Z(Q,Te-3,3)):(re(Q,R,Q.bl_tree),Z(Q,Te-11,7));xe=ae,Ze=(Te=0)===Ce?(De=138,3):ae===Ce?(De=6,3):(De=7,4)}}d(Y);var ue=!1;function W(Q,ee,pe,we){Z(Q,(f<<1)+(we?1:0),3),(function(ae,xe,Ce,Te){me(ae),te(ae,Ce),te(ae,~Ce),i.arraySet(ae.pending_buf,ae.window,xe,Ce,ae.pending),ae.pending+=Ce})(Q,ee,pe)}s._tr_init=function(Q){ue||((function(){var ee,pe,we,ae,xe,Ce=new Array(w+1);for(ae=we=0;ae<p-1;ae++)for(K[ae]=we,ee=0;ee<1<<O[ae];ee++)E[we++]=ae;for(E[we-1]=ae,ae=xe=0;ae<16;ae++)for(Y[ae]=xe,ee=0;ee<1<<L[ae];ee++)B[xe++]=ae;for(xe>>=7;ae<m;ae++)for(Y[ae]=xe<<7,ee=0;ee<1<<L[ae]-7;ee++)B[256+xe++]=ae;for(pe=0;pe<=w;pe++)Ce[pe]=0;for(ee=0;ee<=143;)H[2*ee+1]=8,ee++,Ce[8]++;for(;ee<=255;)H[2*ee+1]=9,ee++,Ce[9]++;for(;ee<=279;)H[2*ee+1]=7,ee++,Ce[7]++;for(;ee<=287;)H[2*ee+1]=8,ee++,Ce[8]++;for(ge(H,y+1,Ce),ee=0;ee<m;ee++)P[2*ee+1]=5,P[2*ee]=se(ee,5);q=new X(H,O,g+1,y,w),V=new X(P,L,0,m,w),ie=new X(new Array(0),A,0,b,T)})(),ue=!0),Q.l_desc=new I(Q.dyn_ltree,q),Q.d_desc=new I(Q.dyn_dtree,V),Q.bl_desc=new I(Q.bl_tree,ie),Q.bi_buf=0,Q.bi_valid=0,be(Q)},s._tr_stored_block=W,s._tr_flush_block=function(Q,ee,pe,we){var ae,xe,Ce=0;0<Q.level?(Q.strm.data_type===2&&(Q.strm.data_type=(function(Te){var De,Ze=4093624447;for(De=0;De<=31;De++,Ze>>>=1)if(1&Ze&&Te.dyn_ltree[2*De]!==0)return o;if(Te.dyn_ltree[18]!==0||Te.dyn_ltree[20]!==0||Te.dyn_ltree[26]!==0)return l;for(De=32;De<g;De++)if(Te.dyn_ltree[2*De]!==0)return l;return o})(Q)),ut(Q,Q.l_desc),ut(Q,Q.d_desc),Ce=(function(Te){var De;for(z(Te,Te.dyn_ltree,Te.l_desc.max_code),z(Te,Te.dyn_dtree,Te.d_desc.max_code),ut(Te,Te.bl_desc),De=b-1;3<=De&&Te.bl_tree[2*F[De]+1]===0;De--);return Te.opt_len+=3*(De+1)+5+5+4,De})(Q),ae=Q.opt_len+3+7>>>3,(xe=Q.static_len+3+7>>>3)<=ae&&(ae=xe)):ae=xe=pe+5,pe+4<=ae&&ee!==-1?W(Q,ee,pe,we):Q.strategy===4||xe===ae?(Z(Q,2+(we?1:0),3),He(Q,H,P)):(Z(Q,4+(we?1:0),3),(function(Te,De,Ze,Ue){var $t;for(Z(Te,De-257,5),Z(Te,Ze-1,5),Z(Te,Ue-4,4),$t=0;$t<Ue;$t++)Z(Te,Te.bl_tree[2*F[$t]+1],3);fe(Te,Te.dyn_ltree,De-1),fe(Te,Te.dyn_dtree,Ze-1)})(Q,Q.l_desc.max_code+1,Q.d_desc.max_code+1,Ce+1),He(Q,Q.dyn_ltree,Q.dyn_dtree)),be(Q),we&&me(Q)},s._tr_tally=function(Q,ee,pe){return Q.pending_buf[Q.d_buf+2*Q.last_lit]=ee>>>8&255,Q.pending_buf[Q.d_buf+2*Q.last_lit+1]=255&ee,Q.pending_buf[Q.l_buf+Q.last_lit]=255&pe,Q.last_lit++,ee===0?Q.dyn_ltree[2*pe]++:(Q.matches++,ee--,Q.dyn_ltree[2*(E[pe]+g+1)]++,Q.dyn_dtree[2*U(ee)]++),Q.last_lit===Q.lit_bufsize-1},s._tr_align=function(Q){Z(Q,2,3),re(Q,j,H),(function(ee){ee.bi_valid===16?(te(ee,ee.bi_buf),ee.bi_buf=0,ee.bi_valid=0):8<=ee.bi_valid&&(ee.pending_buf[ee.pending++]=255&ee.bi_buf,ee.bi_buf>>=8,ee.bi_valid-=8)})(Q)}},{"../utils/common":41}],53:[function(n,r,s){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,s){(function(i){(function(o,l){if(!o.setImmediate){var d,f,p,g,y=1,m={},b=!1,v=o.document,w=Object.getPrototypeOf&&Object.getPrototypeOf(o);w=w&&w.setTimeout?w:o,d={}.toString.call(o.process)==="[object process]"?function(M){process.nextTick(function(){T(M)})}:(function(){if(o.postMessage&&!o.importScripts){var M=!0,_=o.onmessage;return o.onmessage=function(){M=!1},o.postMessage("","*"),o.onmessage=_,M}})()?(g="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",j,!1):o.attachEvent("onmessage",j),function(M){o.postMessage(g+M,"*")}):o.MessageChannel?((p=new MessageChannel).port1.onmessage=function(M){T(M.data)},function(M){p.port2.postMessage(M)}):v&&"onreadystatechange"in v.createElement("script")?(f=v.documentElement,function(M){var _=v.createElement("script");_.onreadystatechange=function(){T(M),_.onreadystatechange=null,f.removeChild(_),_=null},f.appendChild(_)}):function(M){setTimeout(T,0,M)},w.setImmediate=function(M){typeof M!="function"&&(M=new Function(""+M));for(var _=new Array(arguments.length-1),R=0;R<_.length;R++)_[R]=arguments[R+1];var O={callback:M,args:_};return m[y]=O,d(y),y++},w.clearImmediate=S}function S(M){delete m[M]}function T(M){if(b)setTimeout(T,0,M);else{var _=m[M];if(_){b=!0;try{(function(R){var O=R.callback,L=R.args;switch(L.length){case 0:O();break;case 1:O(L[0]);break;case 2:O(L[0],L[1]);break;case 3:O(L[0],L[1],L[2]);break;default:O.apply(l,L)}})(_)}finally{S(M),b=!1}}}}function j(M){M.source===o&&typeof M.data=="string"&&M.data.indexOf(g)===0&&T(+M.data.slice(g.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Tf<"u"?Tf:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(vy)),vy.exports}var dQ=uQ();const Xv=Ql(dQ);function fQ(t){return t.replace(/[<>:"/\\|?*]/g,"").replace(/\s+/g," ").trim().slice(0,200)}async function hQ(t,e){const n=new Xv;for(let r=0;r<t.length;r++){const{filename:s,xmlContent:i}=t[r],o=fQ(s);n.file(`${o}`,i),e?.(r+1,t.length)}return n.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}})}function pQ(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function Ur(t,e){return e?`  <${t}>${pQ(e)}</${t}>
`:""}function gQ(t){let e=t.replace(/<br\s*\/?>/gi,`
`).replace(/<\/p>/gi,`
`).replace(/<p>/gi,"");return e=e.replace(/<[^>]+>/g,""),e=e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&apos;/g,"'").replace(/&nbsp;/g," "),e.replace(/\n+$/,"")}function mQ(t){if(!t||t.length===0)return"";const e=[];for(const n of t){n.label&&e.push(`[${n.label}]`);const s=gQ(n.content).split(`
`).filter(i=>i.trim());for(const i of s)e.push(` ${i}`)}return e.join(`
`)}function yQ(t){const e=[];e.push(`<?xml version="1.0" encoding="UTF-8"?>
`),e.push(`<song>
`),e.push(Ur("title",t.title)),e.push(Ur("author",t.author)),e.push(Ur("copyright",t.copyright)),e.push(Ur("ccli",t.ccli)),e.push(Ur("key",t.key)),e.push(Ur("tempo",t.tempo)),e.push(Ur("timesig",t.timeSignature)),e.push(Ur("theme",t.theme)),e.push(Ur("alttheme",t.altTheme)),e.push(Ur("hymn_number",t.hymnNumber)),e.push(Ur("key_line",t.keyLine)),e.push(Ur("presentation",t.presentationOrder));const n=mQ(t.slides);return n&&(e.push(`  <lyrics>
`),e.push(n),e.push(`
  </lyrics>
`)),e.push(`</song>
`),e.join("")}function xQ(){const[t,e]=C.useState(!1),[n,r]=C.useState(null);return{exportSongs:C.useCallback(async i=>{const l=`songs-export-${new Date().toISOString().split("T")[0]}.zip`,d=await gA({defaultPath:l,filters:[{name:"ZIP Archive",extensions:["zip"]}]});if(!d)return{success:!1,cancelled:!0,songCount:0,filename:""};e(!0),r({phase:"fetching",current:0,total:0});try{const f=await cQ(i.categoryId);if(f.length===0)return{success:!1,songCount:0,filename:"",error:"No songs to export"};r({phase:"generating",current:0,total:f.length});const p=f.map((m,b)=>(r({phase:"generating",current:b+1,total:f.length,currentSong:m.title}),{filename:m.title,xmlContent:yQ(m)}));r({phase:"zipping",current:0,total:p.length});const g=await hQ(p,(m,b)=>{r({phase:"zipping",current:m,total:b})});r({phase:"saving",current:0,total:1});const y=await g.arrayBuffer();return await lQ(d,new Uint8Array(y)),r({phase:"saving",current:1,total:1}),{success:!0,songCount:f.length,filename:d}}catch(f){return{success:!1,songCount:0,filename:"",error:f instanceof Error?f.message:String(f)}}finally{e(!1),r(null)}},[]),isPending:t,progress:n}}const bQ="https://download.resursecrestine.ro/programe-crestine/cantece-resurse-crestine-opensong-standard.zip",sT="Resurse Crestine";function vQ(){const{t}=ke("settings"),{showToast:e}=mt(),{batchImport:n,isPending:r,progress:s}=RQ(),{exportSongs:i,isPending:o,progress:l}=xQ(),{data:d}=Pp(),{mutateAsync:f}=Vb(),[p,g]=C.useState({type:"none"}),[y,m]=C.useState([]),[b,v]=C.useState(null),[w,S]=C.useState(!1),[T,j]=C.useState(null),[M,_]=C.useState({useFirstVerseAsTitle:!0,overwriteDuplicates:!1}),R=async()=>{try{const B=await pA({multiple:!0});if(B&&B.length>0){g({type:"importProgress"}),v(null);const E=await KQ(B,K=>{v(K)});v(null),E.songs.length>0?(m(E.songs),j(null),_({useFirstVerseAsTitle:!0,overwriteDuplicates:!1}),g({type:"importConfirm"})):g({type:"noSongs"})}}catch(B){g({type:"none"}),v(null),e(t("sections.importExport.toast.importFailed",{error:String(B)}),"error")}},O=async(B,E)=>{const K=await n({songs:y.map(q=>{const V="metadata"in q.parsed?q.parsed.metadata:void 0;let ie;if(E.useFirstVerseAsTitle&&q.parsed.slides.length>0){const X=q.parsed.slides[0].text.split(`
`)[0]?.trim();ie=Xu(X||q.parsed.title)}else q.sourceFilename?ie=q.sourceFilename.replace(/\.[^.]+$/,"")||q.parsed.title:ie=q.parsed.title;return{title:ie,slides:q.parsed.slides.map((Y,X)=>({content:Y.htmlContent,sortOrder:X,label:"label"in Y?Y.label:null})),sourceFilename:q.sourceFilename,author:V?.author,copyright:V?.copyright,ccli:V?.ccli,key:V?.key,tempo:V?.tempo,timeSignature:V?.timeSignature,theme:V?.theme,altTheme:V?.altTheme,hymnNumber:V?.hymnNumber,keyLine:V?.keyLine,presentationOrder:V?.presentationOrder}}),categoryId:B},{overwriteDuplicates:E.overwriteDuplicates});g({type:"none"}),m([]),K.songIds.length>0&&e(t("sections.importExport.toast.importSuccess",{count:K.songIds.length}),"success")},L=()=>{g({type:"none"}),m([])},A=()=>{g({type:"exportOptions"})},F=async B=>{g({type:"none"});const E=await i({categoryId:B});E.cancelled||(E.success?e(t("sections.importExport.toast.exportSuccess",{count:E.songCount}),"success"):e(t("sections.importExport.toast.exportFailed",{error:E.error}),"error"))},H=()=>{g({type:"none"})},P=async()=>{S(!0),g({type:"importProgress"}),v({phase:"downloading",current:0,total:null,currentFile:"Resurse Crestine archive"});try{const B=await LQ(bQ,(V,ie)=>{v({phase:"downloading",current:V,total:ie,currentFile:"Resurse Crestine archive"})}),E=await QQ(B,V=>{v(V)});if(v(null),E.songs.length===0){g({type:"noSongs"}),S(!1);return}let K=null;const q=d?.find(V=>V.name===sT);if(q)K=q.id;else{const V=await f({name:sT});V.success&&V.category&&(K=V.category.id)}m(E.songs),j(K),_({useFirstVerseAsTitle:!0,overwriteDuplicates:!0}),g({type:"importConfirm"})}catch(B){g({type:"none"}),v(null),e(t("sections.importExport.toast.importFailed",{error:String(B)}),"error")}finally{S(!1)}};return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.importExport.title")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:t("sections.importExport.description")})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(Ru,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}),u.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:t("sections.importExport.import.title")})]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:t("sections.importExport.import.description")}),u.jsx("button",{type:"button",onClick:R,className:"w-full px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:t("sections.importExport.import.button")}),u.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-2",children:t("sections.importExport.import.supportedFormats")})]}),u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(nd,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}),u.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:t("sections.importExport.resurseCrestine.title")})]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:t("sections.importExport.resurseCrestine.description")}),u.jsx("button",{type:"button",onClick:P,disabled:w,className:"w-full px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:t(w?"sections.importExport.resurseCrestine.importing":"sections.importExport.resurseCrestine.button")}),u.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-2",children:t("sections.importExport.resurseCrestine.note")})]}),u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(wh,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}),u.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:t("sections.importExport.export.title")})]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:t("sections.importExport.export.description")}),u.jsx("button",{type:"button",onClick:A,className:"w-full px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:t("sections.importExport.export.button")})]})]}),u.jsx(CQ,{isOpen:p.type==="importProgress",progress:b}),u.jsx(kQ,{isOpen:p.type==="importConfirm",songs:y.map(B=>B.parsed),onConfirm:O,onCancel:L,isPending:r,progress:s,defaultCategoryId:T,defaultUseFirstVerseAsTitle:M.useFirstVerseAsTitle,defaultOverwriteDuplicates:M.overwriteDuplicates}),u.jsx(qE,{isOpen:p.type==="noSongs",title:t("sections.importExport.import.noSongsTitle"),message:t("sections.importExport.import.noSongsMessage"),onClose:()=>g({type:"none"})}),u.jsx(nQ,{isOpen:p.type==="exportOptions",onConfirm:F,onCancel:H}),u.jsx(rQ,{isOpen:o,progress:l})]})}function wQ({isOpen:t,onClose:e}){const{t:n}=ke("songs"),r=C.useRef(null);C.useEffect(()=>{t?r.current?.showModal():r.current?.close()},[t]),C.useEffect(()=>{const i=r.current;if(!i)return;const o=l=>{l.preventDefault(),e()};return i.addEventListener("cancel",o),()=>i.removeEventListener("cancel",o)},[e]);const s=i=>{i.target===r.current&&e()};return u.jsx("dialog",{ref:r,className:"fixed inset-0 m-auto w-full max-w-4xl p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:s,children:u.jsxs("div",{className:"flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n("settings.title")}),u.jsx("button",{type:"button",onClick:e,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:u.jsx(RP,{})}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:u.jsx(vQ,{})}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:u.jsx(tQ,{})})]})]})})}function SQ({isOpen:t,onDiscard:e,onCancel:n}){const{t:r}=ke(["songs","common"]),s=C.useRef(null);C.useEffect(()=>{const o=s.current;o&&(t?o.showModal():o.close())},[t]);const i=o=>{o.target===s.current&&n()};return u.jsx("dialog",{ref:s,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:n,onClick:i,children:u.jsxs("div",{className:"p-6 min-w-[300px] max-w-md",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:r("songs:modal.unsavedChangesTitle")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:r("songs:modal.unsavedChangesMessage")}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:r("common:buttons.cancel")}),u.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:r("songs:modal.discardChanges")})]})]})})}function kQ({isOpen:t,songs:e,onConfirm:n,onCancel:r,isPending:s,progress:i=0,defaultCategoryId:o=null,defaultUseFirstVerseAsTitle:l=!0,defaultOverwriteDuplicates:d=!1}){const{t:f}=ke("songs"),p=C.useRef(null),[g,y]=C.useState(o),[m,b]=C.useState(d),[v,w]=C.useState(l),[S,T]=C.useState(!1);C.useEffect(()=>{const R=p.current;R&&(t?R.showModal():R.close())},[t]),C.useEffect(()=>{t&&(y(o),b(d),w(l),T(!1))},[t,o,d,l]);const j=R=>{R.target===p.current&&!s&&r()},M=()=>{n(g,{overwriteDuplicates:m,useFirstVerseAsTitle:v,skipManuallyEdited:S})},_=e.length;return u.jsx("dialog",{ref:p,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:r,onClick:j,children:u.jsxs("div",{className:"p-6 min-w-[400px] max-w-lg",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Ru,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:f("batchImport.title")})]}),u.jsx("button",{type:"button",onClick:r,disabled:s,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded transition-colors disabled:opacity-50",children:u.jsx(nt,{className:"w-5 h-5"})})]}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:f("batchImport.description",{count:_})}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:f("batchImport.categoryLabel")}),u.jsx(Bp,{value:g,onChange:y,disabled:s})]}),u.jsxs("div",{className:"mb-4 space-y-3",children:[u.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:v,onChange:R=>w(R.target.checked),disabled:s,className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"}),u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:f("batchImport.useFirstVerseAsTitle")})]}),u.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:m,onChange:R=>b(R.target.checked),disabled:s,className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"}),u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:f("batchImport.overwriteDuplicates")})]}),u.jsxs("label",{className:`flex items-center gap-2 ${m?"cursor-pointer":"opacity-50"}`,children:[u.jsx("input",{type:"checkbox",checked:S,onChange:R=>T(R.target.checked),disabled:s||!m,className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"}),u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:f("batchImport.skipManuallyEdited")})]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:f("batchImport.songsList")}),u.jsx("div",{className:"max-h-48 overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg",children:u.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:e.map((R,O)=>u.jsxs("li",{className:"px-3 py-2 text-sm text-gray-900 dark:text-gray-100",children:[O+1,". ",R.title]},`${R.title}-${O}`))})})]}),s?u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex items-center justify-center gap-3",children:[u.jsx(Qe,{className:"w-5 h-5 text-indigo-600 animate-spin"}),u.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[f("batchImport.saving")," ",i,"%"]})]}),u.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:u.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${i}%`}})})]}):u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:f("common:buttons.cancel",{ns:"common"})}),u.jsx("button",{type:"button",onClick:M,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:f("batchImport.confirmButton",{count:_})})]})]})})}function CQ({isOpen:t,progress:e}){const{t:n}=ke("songs");if(!t)return null;const r=()=>{if(!e)return n("batchImport.processing");switch(e.phase){case"downloading":return n("batchImport.downloading");case"extracting":return n("batchImport.extracting");case"converting":return n("batchImport.converting");case"parsing":return n("batchImport.parsing");case"saving":return n("batchImport.saving");default:return n("batchImport.processing")}},s=e&&e.total!==null&&e.total>0,i=s?Math.round(e.current/e.total*100):0,o=l=>l<1024?`${l} B`:l<1024*1024?`${(l/1024).toFixed(1)} KB`:`${(l/(1024*1024)).toFixed(1)} MB`;return u.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[u.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),u.jsx("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-8 max-w-md w-full mx-4",children:u.jsxs("div",{className:"flex flex-col items-center gap-6",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Qe,{className:"w-16 h-16 text-indigo-600 animate-spin"}),s&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsxs("span",{className:"text-sm font-semibold text-indigo-600",children:[i,"%"]})})]}),u.jsxs("div",{className:"text-center space-y-2",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r()}),e&&u.jsxs(u.Fragment,{children:[e.phase==="downloading"?u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s?`${o(e.current)} / ${o(e.total)}`:o(e.current)}):s&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n("batchImport.processingProgress",{current:e.current,total:e.total})}),e.currentFile&&u.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 truncate max-w-xs",children:e.currentFile})]})]}),u.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:u.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ease-out ${s?"bg-indigo-600":"bg-indigo-600 animate-pulse"}`,style:{width:s?`${i}%`:"100%"}})})]})})]})}function Xu(t){if(!t.trim())return"Untitled Song";let e=t.replace(/^[^\p{L}]+/u,"");return e=e.replace(/[^\p{L}\p{N}\s\-\u2013\u2014]/gu,"").trim(),e||"Untitled Song"}function iT(t){return(t.split(/[/\\]/).pop()||t).replace(/\.[^.]+$/,"")}function NQ(t){if(!t.trim())return null;const e=t.split(`
`)[0].trim();if(!e)return null;const n=Xu(e);return n==="Untitled Song"?null:n}async function ta(t,e){const n=await Xv.loadAsync(t),r=[],s=Object.keys(n.files).filter(o=>o.match(/ppt\/slides\/slide\d+\.xml$/)).sort((o,l)=>{const d=Number.parseInt(o.match(/slide(\d+)/)?.[1]||"0"),f=Number.parseInt(l.match(/slide(\d+)/)?.[1]||"0");return d-f});for(const o of s){const l=await n.file(o)?.async("string");if(l){const d=Number.parseInt(o.match(/slide(\d+)/)?.[1]||"0"),{text:f,htmlContent:p}=TQ(l);f.trim()&&r.push({slideNumber:d,text:f,htmlContent:p})}}let i="Imported Song";if(r.length>0){const o=NQ(r[0].text);o&&(i=o)}return i==="Imported Song"&&(e?i=Xu(iT(e)):t instanceof File&&t.name&&(i=Xu(iT(t.name)))),{title:i,slides:r}}function TQ(t){const n=new DOMParser().parseFromString(t,"application/xml"),r="http://schemas.openxmlformats.org/drawingml/2006/main",s=n.getElementsByTagNameNS(r,"p"),i=[];for(let d=0;d<s.length;d++){const f=s[d],p=jQ(f,r);for(const g of p)g.trim()&&i.push(g.trim())}const o=i.join(`
`),l=i.map(d=>`<p>${EQ(d)}</p>`).join("");return{text:o,htmlContent:l}}function jQ(t,e){const n=[];let r="";const s=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,null);let i=s.currentNode;for(;i;){if(i.nodeType===Node.ELEMENT_NODE){const o=i;o.localName==="br"&&o.namespaceURI===e&&(r.trim()&&n.push(r.trim()),r="")}else if(i.nodeType===Node.TEXT_NODE){const o=i.parentElement;if(o?.localName==="t"&&o.namespaceURI===e){const l=i.textContent||"";if(l.includes(`
`)){const d=l.split(`
`);for(let f=0;f<d.length;f++)r+=d[f],f<d.length-1&&(r.trim()&&n.push(r.trim()),r="")}else r+=l}}i=s.nextNode()}return r.trim()&&n.push(r.trim()),n}function EQ(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}const MQ=C.createContext({isDragging:!1});function AQ({children:t}){const{t:e}=ke("songs"),n=ar(),[r,s]=C.useState(!1),i=C.useRef(0),o=Kb(),l=C.useCallback(async(d,f)=>{const p=await o.mutateAsync({title:d.title,sourceFilename:f,slides:d.slides.map((g,y)=>({content:g.htmlContent,sortOrder:y}))});p.success&&p.data&&n({to:"/songs/$songId",params:{songId:String(p.data.id)}})},[n,o]);return C.useEffect(()=>{if(!(typeof window<"u"&&"__TAURI_INTERNALS__"in window))return;async function f(){try{const p=await Yt("get_pending_import");if(p&&p.toLowerCase().endsWith(".pptx")){const g=await cu(p),y=await ta(g.buffer,p);await l(y,p)}}catch(p){console.error("[pptx-import] Failed to handle pending import:",p)}}f()},[l]),C.useEffect(()=>{const d=y=>{y.preventDefault(),i.current++,y.dataTransfer?.items&&Array.from(y.dataTransfer.items).some(b=>b.kind==="file")&&s(!0)},f=y=>{y.preventDefault(),y.dataTransfer&&(y.dataTransfer.dropEffect="copy")},p=y=>{y.preventDefault(),i.current--,i.current===0&&s(!1)},g=async y=>{if(y.preventDefault(),i.current=0,s(!1),!y.dataTransfer?.files)return;const b=Array.from(y.dataTransfer.files).find(v=>v.name.toLowerCase().endsWith(".pptx"));if(b)try{const v=await ta(b),w=b.path;await l(v,w||null)}catch(v){console.error("[pptx-import] Failed to parse PPTX:",v)}};return document.addEventListener("dragenter",d),document.addEventListener("dragover",f),document.addEventListener("dragleave",p),document.addEventListener("drop",g),()=>{document.removeEventListener("dragenter",d),document.removeEventListener("dragover",f),document.removeEventListener("dragleave",p),document.removeEventListener("drop",g)}},[l]),u.jsxs(MQ.Provider,{value:{isDragging:r},children:[t,r&&u.jsx("div",{className:"fixed inset-0 z-50 bg-indigo-500/20 border-4 border-dashed border-indigo-500 pointer-events-none flex items-center justify-center",children:u.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-8 shadow-xl",children:u.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:e("pptxImport.dropHint")})})})]})}const wy=200;function RQ(){const t=Le(),[e,n]=C.useState(!1),[r,s]=C.useState(0);return{batchImport:async(o,l)=>{n(!0),s(0);const d=[];let f=0,p=0,g=0;try{for(let y=0;y<o.songs.length;y+=wy){const m=o.songs.slice(y,y+wy),b=await fetch(`${Ct()}/api/songs/batch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({songs:m.map(S=>({title:S.title,categoryId:o.categoryId,sourceFilename:S.sourceFilename,slides:S.slides,author:S.author,copyright:S.copyright,ccli:S.ccli,key:S.key,tempo:S.tempo,timeSignature:S.timeSignature,theme:S.theme,altTheme:S.altTheme,hymnNumber:S.hymnNumber,keyLine:S.keyLine,presentationOrder:S.presentationOrder})),categoryId:o.categoryId,overwriteDuplicates:l?.overwriteDuplicates??!1,skipManuallyEdited:l?.skipManuallyEdited??!1})});if(!b.ok){const S=await b.json().catch(()=>({}));throw new Error(S.error||`Batch import failed: ${b.statusText}`)}const v=await b.json();d.push(...v.data.songIds),f+=v.data.successCount,p+=v.data.failedCount,g+=v.data.skippedCount;const w=Math.min(y+wy,o.songs.length);s(Math.round(w/o.songs.length*100))}t.invalidateQueries({queryKey:["songs"]})}finally{n(!1),s(0)}return{successCount:f,failedCount:p,skippedCount:g,songIds:d}},isPending:e,progress:r}}class Sp extends Error{constructor(){super("LibreOffice is not installed"),this.name="LibreOfficeNotInstalledError"}}function _Q(t){const e=new Uint8Array(t);let n="";for(let r=0;r<e.byteLength;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function OQ(t){const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n.buffer}async function sb(t){const e=_Q(t),n=await fetch(`${Ct()}/api/convert/ppt-to-pptx`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:e})});if(!n.ok){const s=await n.json().catch(()=>({}));throw s.errorCode==="LIBREOFFICE_NOT_INSTALLED"?new Sp:new Error(s.error||"Conversion failed")}const r=await n.json();return OQ(r.data)}const DQ=typeof window<"u"&&"__TAURI_INTERNALS__"in window,IQ=DQ?vE:window.fetch.bind(window);async function LQ(t,e){const n=await IQ(t,{method:"GET",redirect:"follow"});if(!n.ok)throw new Error(`Failed to download: ${n.status} ${n.statusText}`);const r=n.headers.get("content-length"),s=r?parseInt(r,10):null,i=n.body?.getReader();if(!i)throw new Error("Failed to get response reader");const o=[];let l=0;for(;;){const{done:p,value:g}=await i.read();if(p)break;o.push(g),l+=g.length,e?.(l,s)}const d=new Uint8Array(l);let f=0;for(const p of o)d.set(p,f),f+=p.length;return d.buffer}const Sy=10;function zQ(t){const e=t.split(/[/\\]/).pop()||"",n=t.toLowerCase();return n.includes("__macosx")||n.includes(".ds_store")||e.startsWith(".")?!1:n.endsWith(".xml")||!e.includes(".")}function PQ(t){const e=t.trim();return e.startsWith("<song")&&e.includes("<lyrics>")}async function ky(t,e,n){const r=[];for(let s=0;s<t.length;s+=n){const i=t.slice(s,s+n),o=await Promise.all(i.map(e));r.push(...o)}return r}async function Jv(t,e){const n=[],r=[],s=[],i=[];try{const o=await Xv.loadAsync(t),d=Object.keys(o.files).filter(T=>!o.files[T].dir).map(T=>({path:T,file:o.files[T]})),f=d.length;let p=0;const g=[],y=[],m=[],b=[];for(const T of d){const j=T.path.toLowerCase();j.endsWith(".pptx")?g.push(T):j.endsWith(".ppt")?y.push(T):j.endsWith(".zip")?b.push(T):zQ(T.path)&&m.push(T)}const v=await ky(g,async T=>{try{const j=await T.file.async("arraybuffer"),M=T.path.split(/[/\\]/).pop()||T.path;return p++,e?.(p,f),{success:!0,data:{filename:M,data:j,sourcePath:T.path}}}catch(j){p++,e?.(p,f);const M=j instanceof Error?j.message:"Unknown error";return{success:!1,error:`Failed to extract ${T.path}: ${M}`}}},Sy);for(const T of v)T.success?n.push(T.data):i.push(T.error);const w=await ky(y,async T=>{try{const j=await T.file.async("arraybuffer"),M=T.path.split(/[/\\]/).pop()||T.path;return p++,e?.(p,f),{success:!0,data:{filename:M,data:j,sourcePath:T.path}}}catch(j){p++,e?.(p,f);const M=j instanceof Error?j.message:"Unknown error";return{success:!1,error:`Failed to extract ${T.path}: ${M}`}}},Sy);for(const T of w)T.success?r.push(T.data):i.push(T.error);const S=await ky(m,async T=>{try{const j=await T.file.async("uint8array"),M=new TextDecoder().decode(j);return p++,e?.(p,f),PQ(M)?{success:!0,data:{filename:T.path.split(/[/\\]/).pop()||T.path,content:M,sourcePath:T.path}}:{success:!1,error:null}}catch(j){p++,e?.(p,f);const M=j instanceof Error?j.message:"Unknown error";return{success:!1,error:`Failed to extract ${T.path}: ${M}`}}},Sy);for(const T of S)T.success&&T.data?s.push(T.data):T.error&&i.push(T.error);for(const T of b)try{const j=await T.file.async("arraybuffer"),M=await Jv(j,(_,R)=>{e?.(p+_,f+R)});n.push(...M.pptxFiles),r.push(...M.pptFiles),s.push(...M.opensongFiles),i.push(...M.errors),p++,e?.(p,f)}catch(j){p++,e?.(p,f);const M=j instanceof Error?j.message:"Unknown error";i.push(`Failed to process nested ZIP ${T.path}: ${M}`)}}catch(o){const l=o instanceof Error?o.message:"Unknown error";i.push(`Failed to open ZIP archive: ${l}`)}return{pptxFiles:n,pptFiles:r,opensongFiles:s,errors:i}}function BQ(t){return(t.split(/[/\\]/).pop()||t).replace(/\.[^.]+$/,"")}function FQ(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function $r(t,e){return t.querySelector(e)?.textContent?.trim()||null}function UQ(t,e){const n=$r(t,"title")||(e?BQ(e):"Untitled Song"),r=Xu(n),s={author:$r(t,"author"),copyright:$r(t,"copyright"),ccli:$r(t,"ccli"),key:$r(t,"key"),tempo:$r(t,"tempo"),timeSignature:$r(t,"timesig"),theme:$r(t,"theme"),altTheme:$r(t,"alttheme"),hymnNumber:$r(t,"hymn_number"),keyLine:$r(t,"key_line"),presentationOrder:$r(t,"presentation")};return{title:r,metadata:s}}function $Q(t){const e=[],n=t.split(`
`);let r=null;for(const s of n){const o=s.trim().match(/^\[([A-Z]\d*)\]$/);if(o)r&&r.lines.length>0&&e.push(r),r={label:o[1],lines:[]};else if(r){const d=(s.startsWith(" ")?s.substring(1):s).trim();d&&r.lines.push(d)}}return r&&r.lines.length>0&&e.push(r),e}function qQ(t,e){const n=[],r=new Map;for(const o of t)r.set(o.label,o);let s;e&&e.trim()?s=e.trim().split(/\s+/):s=t.map(o=>o.label);let i=1;for(const o of s){const l=r.get(o);if(l){const d=l.lines.join(`
`),f=l.lines.map(p=>`<p>${FQ(p)}</p>`).join("");n.push({slideNumber:i,text:d,htmlContent:f,label:l.label}),i++}}return n}function ib(t,e){const r=new DOMParser().parseFromString(t,"application/xml"),s=r.querySelector("parsererror");if(s)throw new Error(`Invalid XML: ${s.textContent}`);const i=r.querySelector("song");if(!i)throw new Error("Invalid OpenSong file: missing <song> element");const{title:o,metadata:l}=UQ(i,e),f=i.querySelector("lyrics")?.textContent||"",p=$Q(f),g=qQ(p,l.presentationOrder);return{title:o,slides:g,metadata:l,verses:p}}function Cy(t){if(!t)return null;const e=t.split(/[/\\]/);return e[e.length-1]||null}const xl=5;function HQ(t){const e=t.split(/[/\\]/).pop()||"";return t.toLowerCase().endsWith(".xml")||!e.includes(".")}function VQ(t){const e=t.trim();return e.startsWith("<song")&&e.includes("<lyrics>")}async function bl(t,e,n,r){const s=[],i=t.length;for(let o=0;o<t.length;o+=n){const l=t.slice(o,o+n),d=await Promise.all(l.map((f,p)=>e(f,o+p)));s.push(...d),r?.(Math.min(o+n,i),i)}return s}async function KQ(t,e){const n=[],r=[],s=[],i=[],o=[],l=[];for(const p of t){const g=p.toLowerCase();g.endsWith(".pptx")?i.push(p):g.endsWith(".ppt")?s.push(p):g.endsWith(".zip")?o.push(p):HQ(p)&&l.push(p)}const d=s.length+i.length+o.length+l.length;let f=0;if(s.length>0){e?.({phase:"converting",current:0,total:s.length,currentFile:"PPT files"});const p=await bl(s,async g=>{try{const y=await cu(g),m=await sb(y.buffer);return{success:!0,data:{parsed:await ta(m,g),sourceFilename:Cy(g),sourceFormat:"pptx"}}}catch(y){if(y instanceof Sp)return{success:!1,error:"LIBREOFFICE_NOT_INSTALLED"};const m=y instanceof Error?y.message:"Unknown error";return{success:!1,error:`Failed to convert ${g.split(/[/\\]/).pop()||g}: ${m}`}}},xl,(g,y)=>{e?.({phase:"converting",current:g,total:y,currentFile:"PPT files"})});for(const g of p)g.success?n.push(g.data):r.push(g.error)}for(const p of o){e?.({phase:"extracting",current:f,total:d,currentFile:p.split(/[/\\]/).pop()});try{const g=await cu(p),y=await Jv(g.buffer,(m,b)=>{e?.({phase:"extracting",current:m,total:b,currentFile:p.split(/[/\\]/).pop()})});if(r.push(...y.errors),y.pptxFiles.length>0){e?.({phase:"parsing",current:0,total:y.pptxFiles.length,currentFile:"PPTX files"});const m=await bl(y.pptxFiles,async b=>{try{return{success:!0,data:{parsed:await ta(b.data,b.filename),sourceFilename:b.filename,sourceFormat:"pptx"}}}catch(v){const w=v instanceof Error?v.message:"Unknown error";return{success:!1,error:`Failed to parse ${b.filename}: ${w}`}}},xl,(b,v)=>{e?.({phase:"parsing",current:b,total:v,currentFile:"PPTX files"})});for(const b of m)b.success?n.push(b.data):r.push(b.error)}if(y.pptFiles.length>0){e?.({phase:"converting",current:0,total:y.pptFiles.length,currentFile:"PPT files from ZIP"});const m=await bl(y.pptFiles,async b=>{try{const v=await sb(b.data);return{success:!0,data:{parsed:await ta(v,b.filename),sourceFilename:b.filename,sourceFormat:"pptx"}}}catch(v){if(v instanceof Sp)return{success:!1,error:"LIBREOFFICE_NOT_INSTALLED"};const w=v instanceof Error?v.message:"Unknown error";return{success:!1,error:`Failed to convert ${b.filename}: ${w}`}}},xl,(b,v)=>{e?.({phase:"converting",current:b,total:v,currentFile:"PPT files from ZIP"})});for(const b of m)b.success?n.push(b.data):r.push(b.error)}if(y.opensongFiles.length>0){e?.({phase:"parsing",current:0,total:y.opensongFiles.length,currentFile:"OpenSong files"});const m=await bl(y.opensongFiles,async b=>{try{return{success:!0,data:{parsed:ib(b.content,b.filename),sourceFilename:b.filename,sourceFormat:"opensong"}}}catch(v){const w=v instanceof Error?v.message:"Unknown error";return{success:!1,error:`Failed to parse ${b.filename}: ${w}`}}},xl,(b,v)=>{e?.({phase:"parsing",current:b,total:v,currentFile:"OpenSong files"})});for(const b of m)b.success?n.push(b.data):r.push(b.error)}}catch(g){const y=g instanceof Error?g.message:"Unknown error",m=p.split(/[/\\]/).pop()||p;r.push(`Failed to read ${m}: ${y}`)}f++}if(i.length>0){e?.({phase:"parsing",current:0,total:i.length,currentFile:"PPTX files"});const p=await bl(i,async g=>{try{const y=await cu(g);return{success:!0,data:{parsed:await ta(y.buffer,g),sourceFilename:Cy(g),sourceFormat:"pptx"}}}catch(y){const m=y instanceof Error?y.message:"Unknown error";return{success:!1,error:`Failed to process ${g.split(/[/\\]/).pop()||g}: ${m}`}}},xl,(g,y)=>{e?.({phase:"parsing",current:g,total:y,currentFile:"PPTX files"})});for(const g of p)g.success?n.push(g.data):r.push(g.error)}if(l.length>0){e?.({phase:"parsing",current:0,total:l.length,currentFile:"OpenSong files"});const p=await bl(l,async g=>{try{const y=await cu(g),m=new TextDecoder().decode(y);return VQ(m)?{success:!0,data:{parsed:ib(m,g),sourceFilename:Cy(g),sourceFormat:"opensong"}}:{success:!1,error:`${g.split(/[/\\]/).pop()||g}: Not a valid OpenSong file`}}catch(y){const m=y instanceof Error?y.message:"Unknown error";return{success:!1,error:`Failed to parse ${g.split(/[/\\]/).pop()||g} as OpenSong: ${m}`}}},xl,(g,y)=>{e?.({phase:"parsing",current:g,total:y,currentFile:"OpenSong files"})});for(const g of p)g.success?n.push(g.data):g.error&&!g.error.includes("Not a valid OpenSong")&&r.push(g.error)}return{songs:n,errors:r}}const Ny=5;async function Ty(t,e,n,r){const s=[],i=t.length;for(let o=0;o<t.length;o+=n){const l=t.slice(o,o+n),d=await Promise.all(l.map((f,p)=>e(f,o+p)));s.push(...d),r?.(Math.min(o+n,i),i)}return s}async function QQ(t,e){const n=[],r=[];e?.({phase:"extracting",current:0,total:1,currentFile:"ZIP archive"});const s=await Jv(t,(i,o)=>{e?.({phase:"extracting",current:i,total:o,currentFile:"ZIP archive"})});if(r.push(...s.errors),s.pptxFiles.length>0){e?.({phase:"parsing",current:0,total:s.pptxFiles.length,currentFile:"PPTX files"});const i=await Ty(s.pptxFiles,async o=>{try{return{success:!0,data:{parsed:await ta(o.data,o.filename),sourceFilename:o.filename,sourceFormat:"pptx"}}}catch(l){const d=l instanceof Error?l.message:"Unknown error";return{success:!1,error:`Failed to parse ${o.filename}: ${d}`}}},Ny,(o,l)=>{e?.({phase:"parsing",current:o,total:l,currentFile:"PPTX files"})});for(const o of i)o.success?n.push(o.data):r.push(o.error)}if(s.pptFiles.length>0){e?.({phase:"converting",current:0,total:s.pptFiles.length,currentFile:"PPT files"});const i=await Ty(s.pptFiles,async o=>{try{const l=await sb(o.data);return{success:!0,data:{parsed:await ta(l,o.filename),sourceFilename:o.filename,sourceFormat:"pptx"}}}catch(l){if(l instanceof Sp)return{success:!1,error:"LIBREOFFICE_NOT_INSTALLED"};const d=l instanceof Error?l.message:"Unknown error";return{success:!1,error:`Failed to convert ${o.filename}: ${d}`}}},Ny,(o,l)=>{e?.({phase:"converting",current:o,total:l,currentFile:"PPT files"})});for(const o of i)o.success?n.push(o.data):r.push(o.error)}if(s.opensongFiles.length>0){e?.({phase:"parsing",current:0,total:s.opensongFiles.length,currentFile:"OpenSong files"});const i=await Ty(s.opensongFiles,async o=>{try{return{success:!0,data:{parsed:ib(o.content,o.filename),sourceFilename:o.filename,sourceFormat:"opensong"}}}catch(l){const d=l instanceof Error?l.message:"Unknown error";return{success:!1,error:`Failed to parse ${o.filename}: ${d}`}}},Ny,(o,l)=>{e?.({phase:"parsing",current:o,total:l,currentFile:"OpenSong files"})});for(const o of i)o.success?n.push(o.data):r.push(o.error)}return{songs:n,errors:r}}const mA="language";function WQ(){return navigator.language.toLowerCase().startsWith("ro")?"ro":"en"}async function YQ(){const t=await uo("app_settings",mA);if(!t)return null;const e=t.value;return e==="system"||e==="en"||e==="ro"?e:null}async function GQ(t){return await fo("app_settings",{key:mA,value:t})}function jy(t){return!t||t==="system"?WQ():t}const yA=C.createContext(void 0);function XQ({children:t}){const{i18n:e}=ke(),[n,r]=C.useState("system"),[s,i]=C.useState("en"),[o,l]=C.useState(!0);C.useEffect(()=>{async function f(){try{const g=await YQ()||"system",y=jy(g);r(g),i(y),await e.changeLanguage(y)}catch{const g=jy("system");i(g),await e.changeLanguage(g)}finally{l(!1)}}f()},[e]);const d=async f=>{try{const p=jy(f);await GQ(f)&&(r(f),i(p),await e.changeLanguage(p),localStorage.setItem("church-hub-language",p))}catch{}};return u.jsx(yA.Provider,{value:{language:s,preference:n,setLanguagePreference:d,isLoading:o},children:t})}function JQ(){const t=C.useContext(yA);if(t===void 0)throw new Error("useI18n must be used within an I18nProvider");return t}async function ZQ(){return(await Me("/api/users")).data}async function eW(t){return(await Me("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).data}async function tW(t,e){return(await Me(`/api/users/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).data}async function nW(t){return(await Me(`/api/users/${t}`,{method:"DELETE"})).data.success}async function rW(t,e){return(await Me(`/api/users/${t}/permissions`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({permissions:e})})).data}async function sW(t){return(await Me(`/api/users/${t}/regenerate-token`,{method:"POST"})).data}async function iW(){try{return(await Me("/api/auth/me")).data}catch{return null}}function aW(t){return`${Ct()}/api/auth/user/${encodeURIComponent(t)}`}function oW(t,e){return`http://${e}:3000/api/auth/user/${encodeURIComponent(t)}`}async function lW(){return(await Me("/api/network/interfaces")).data}function cW(t){return t.startsWith("custom_page.")&&t.endsWith(".view")}const ab=["songs.view","songs.create","songs.edit","songs.delete","songs.add_to_queue","songs.present_now","bible.view","bible.import","bible.delete","bible.add_to_queue","bible.present_now","control_room.view","control_room.control","programs.view","programs.create","programs.edit","programs.delete","programs.import_to_queue","queue.view","queue.add","queue.remove","queue.reorder","queue.clear","settings.view","settings.edit","displays.view","displays.create","displays.edit","displays.delete","users.view","users.create","users.edit","users.delete"],vl={songs:["songs.view","songs.create","songs.edit","songs.delete","songs.add_to_queue","songs.present_now"],bible:["bible.view","bible.import","bible.delete","bible.add_to_queue","bible.present_now"],control_room:["control_room.view","control_room.control"],programs:["programs.view","programs.create","programs.edit","programs.delete","programs.import_to_queue"],queue:["queue.view","queue.add","queue.remove","queue.reorder","queue.clear"],settings:["settings.view","settings.edit"],displays:["displays.view","displays.create","displays.edit","displays.delete"],users:["users.view","users.create","users.edit","users.delete"]},ob={admin:ab,presenter:["control_room.view","control_room.control","songs.view","songs.add_to_queue","songs.present_now","bible.view","bible.add_to_queue","bible.present_now","queue.view","queue.add","queue.remove","queue.reorder","programs.view","programs.import_to_queue","displays.view"],viewer:["control_room.view","songs.view","bible.view","programs.view","queue.view","displays.view"],queue_manager:["queue.view","queue.add","queue.remove","queue.reorder","queue.clear","songs.view","songs.add_to_queue","programs.view","programs.import_to_queue","control_room.view"]},xA=C.createContext(void 0);function uW({children:t}){const[e,n]=C.useState(null),[r,s]=C.useState(!0),i=async()=>{try{const b=await iW();n(b)}catch{n(null)}finally{s(!1)}};C.useEffect(()=>{i()},[]);const o=e?.permissions??[],l=e?.isApp??!1,d=l?ab:o,f=b=>l?!0:(cW(b),d.includes(b)),p=b=>l?!0:b.some(v=>f(v)),g=b=>l?!0:b.every(v=>f(v)),y=l||ab.every(b=>d.includes(b)),m={permissions:d,hasPermission:f,hasAnyPermission:p,hasAllPermissions:g,isAdmin:y,isApp:l,isAuthenticated:e!==null,isLoading:r,userId:e?.id??null,userName:e?.name??null,refresh:i};return u.jsx(xA.Provider,{value:m,children:t})}function bA(){const t=C.useContext(xA);if(t===void 0)throw new Error("usePermissions must be used within a PermissionsProvider");return t}const dW=new UL({defaultOptions:{queries:{refetchOnWindowFocus:!1,refetchOnReconnect:!0,gcTime:1e4*60,retry:3},mutations:{retry:0}}});function vA({children:t}){return u.jsx($L,{client:dW,children:t})}const wA="theme";function SA(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"}async function fW(){const t=await uo("app_settings",wA);if(!t)return null;const e=t.value;return e==="system"||e==="light"||e==="dark"?e:null}async function hW(t){return await fo("app_settings",{key:wA,value:t})}function aT(t){return!t||t==="system"?SA():t}const kA=C.createContext(void 0);function CA({children:t}){const[e,n]=C.useState("system"),[r,s]=C.useState("dark"),[i,o]=C.useState(!0);C.useEffect(()=>{async function d(){try{const p=await fW()||"system",g=aT(p);n(p),s(g)}catch{const p=SA();s(p)}finally{o(!1)}}d()},[]),C.useEffect(()=>{const d=document.documentElement,f=document.body;d.classList.remove("light","dark"),d.classList.add(r),f.classList.remove("light","dark"),f.classList.add(r),localStorage.setItem("church-hub-theme",r)},[r]),C.useEffect(()=>{if(e!=="system")return;const d=window.matchMedia("(prefers-color-scheme: dark)"),f=p=>{const g=p.matches?"dark":"light";s(g)};return d.addEventListener("change",f),()=>d.removeEventListener("change",f)},[e]);const l=async d=>{try{const f=aT(d);await hW(d)&&(n(d),s(f))}catch{}};return u.jsx(kA.Provider,{value:{theme:r,preference:e,setThemePreference:l,isLoading:i},children:t})}function pW(){const t=C.useContext(kA);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t}function gW(t){const e=[/(?:youtube\.com\/watch\?v=|youtube\.com\/watch\?.*&v=)([a-zA-Z0-9_-]{11})/,/youtu\.be\/([a-zA-Z0-9_-]{11})/,/youtube\.com\/embed\/([a-zA-Z0-9_-]{11})/,/youtube\.com\/v\/([a-zA-Z0-9_-]{11})/,/youtube\.com\/shorts\/([a-zA-Z0-9_-]{11})/];for(const n of e){const r=t.match(n);if(r?.[1])return r[1]}return null}function mW(t){return t.includes("youtube.com")||t.includes("youtu.be")||t.includes("youtube-nocookie.com")}function yW(t){const e=gW(t);return e?`https://www.youtube-nocookie.com/embed/${e}?autoplay=0&rel=0`:null}function NA(t){if(mW(t)){const e=yW(t);if(e)return e}return t}const TA=new Map;let Ln=null,oT=null;const xW="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36";function bW(t){return`custom-page-${t}`}async function Zv(){const e=document.querySelector("aside")?.getBoundingClientRect().width??256;try{const{getCurrentWindow:n}=await kn(async()=>{const{getCurrentWindow:f}=await import("./window-BtdqqXmO.js").then(p=>p.w);return{getCurrentWindow:f}},__vite__mapDeps([3,2])),r=n(),s=await r.innerSize(),i=await r.scaleFactor(),o=s.width/i,l=s.height/i;return{x:e,y:0,width:o-e,height:l}}catch{return{x:e,y:0,width:window.innerWidth-e,height:window.innerHeight}}}async function jA(){if(Ln)try{const{Webview:t}=await kn(async()=>{const{Webview:i}=await import("./webview-lznaJHrX.js");return{Webview:i}},__vite__mapDeps([1,2,3])),{LogicalPosition:e,LogicalSize:n}=await kn(async()=>{const{LogicalPosition:i,LogicalSize:o}=await import("./dpi-BIcrl0fe.js");return{LogicalPosition:i,LogicalSize:o}},[]),r=await t.getByLabel(Ln);if(!r)return;const s=await Zv();await r.setPosition(new e(s.x,s.y)),await r.setSize(new n(s.width,s.height))}catch{}}function lT(){if(oT)return;let t=null;const e=()=>{t&&clearTimeout(t),t=setTimeout(jA,100)};window.addEventListener("resize",e),oT=()=>{window.removeEventListener("resize",e),t&&clearTimeout(t)}}async function vW(t,e){if(!dn())return;const n=bW(t),r=NA(e);try{const{Webview:s}=await kn(async()=>{const{Webview:y}=await import("./webview-lznaJHrX.js");return{Webview:y}},__vite__mapDeps([1,2,3])),{getCurrentWindow:i}=await kn(async()=>{const{getCurrentWindow:y}=await import("./window-BtdqqXmO.js").then(m=>m.w);return{getCurrentWindow:y}},__vite__mapDeps([3,2])),{LogicalPosition:o,LogicalSize:l}=await kn(async()=>{const{LogicalPosition:y,LogicalSize:m}=await import("./dpi-BIcrl0fe.js");return{LogicalPosition:y,LogicalSize:m}},[]);Ln&&Ln!==n&&await e1(Ln);const d=await Zv(),f=await s.getByLabel(n);if(f){await f.setPosition(new o(d.x,d.y)),await f.setSize(new l(d.width,d.height)),await f.show(),await f.setFocus(),Ln=n,lT();return}const p=i(),g=new s(p,n,{url:r,x:d.x,y:d.y,width:d.width,height:d.height,userAgent:xW});await new Promise((y,m)=>{g.once("tauri://created",()=>{y()}),g.once("tauri://error",b=>{m(new Error(`Failed to create webview: ${b}`))})}),TA.set(n,g),Ln=n,lT(),p.onResized(jA)}catch(s){throw s}}async function e1(t){try{const{Webview:e}=await kn(async()=>{const{Webview:s}=await import("./webview-lznaJHrX.js");return{Webview:s}},__vite__mapDeps([1,2,3])),{LogicalPosition:n}=await kn(async()=>{const{LogicalPosition:s}=await import("./dpi-BIcrl0fe.js");return{LogicalPosition:s}},[]),r=await e.getByLabel(t);if(!r)return;await r.setPosition(new n(-9999,-9999));try{await r.hide()}catch{}Ln===t&&(Ln=null)}catch{Ln===t&&(Ln=null)}}async function wW(){if(!dn())return;const t=Ln;t&&await e1(t)}async function EA(){if(!dn())return;const t=Array.from(TA.keys());for(const e of t)await e1(e);Ln=null}async function SW(){if(!(!dn()||!Ln))try{const{Webview:t}=await kn(async()=>{const{Webview:i}=await import("./webview-lznaJHrX.js");return{Webview:i}},__vite__mapDeps([1,2,3])),{LogicalPosition:e,LogicalSize:n}=await kn(async()=>{const{LogicalPosition:i,LogicalSize:o}=await import("./dpi-BIcrl0fe.js");return{LogicalPosition:i,LogicalSize:o}},[]),r=await t.getByLabel(Ln);if(!r)return;const s=await Zv();await r.setPosition(new e(s.x,s.y)),await r.setSize(new n(s.width,s.height))}catch{}}function cT(t){const e=t.match(/^\/custom-page\/(.+)$/);return e?e[1]:null}function kW(){const t=jp(),[e]=C.useState(()=>dn()),n=C.useRef(t.pathname);return C.useEffect(()=>{if(!e)return;const r=t.pathname,s=cT(n.current),i=cT(r);s!==null&&!(i!==null)&&EA(),n.current=r},[t.pathname,e]),null}function CW({isCollapsed:t}){return u.jsxs("div",{className:"flex items-center justify-center gap-3 px-4 py-4 border-b border-gray-200 dark:border-gray-800",children:[u.jsx("img",{src:"/logo192.png",alt:"Church Hub",className:"flex-shrink-0",style:{width:t?32:40,height:t?32:40}}),!t&&u.jsx("h1",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Church Hub"})]})}function uT({icon:t,label:e,to:n,isCollapsed:r,isActive:s,className:i="",disabled:o=!1,onClick:l}){const d=`
    flex items-center gap-3 px-4 py-3 rounded-lg transition-all
    ${r?"md:justify-center":""}
    ${i}
  `,f=s?"bg-indigo-50 dark:bg-indigo-950 text-indigo-600 dark:text-indigo-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800",p="opacity-50 cursor-not-allowed text-gray-400 dark:text-gray-600",g=u.jsxs(u.Fragment,{children:[u.jsx(t,{size:20,className:"flex-shrink-0"}),u.jsx("span",{className:"text-sm font-medium md:hidden",children:e}),!r&&u.jsx("span",{className:"text-sm font-medium hidden md:inline",children:e})]});return o?u.jsx("div",{className:`${d} ${p}`,title:r?e:void 0,children:g}):u.jsx(xb,{to:n,className:`${d} ${f}`,title:r?e:void 0,onClick:l,children:g})}const t1={present:{id:"present",icon:t6,labelKey:"sidebar:navigation.present",to:"/present",permission:"control_room.view"},songs:{id:"songs",icon:ha,labelKey:"sidebar:navigation.songs",to:"/songs",permission:"songs.view"},bible:{id:"bible",icon:wr,labelKey:"sidebar:navigation.bible",to:"/bible",permission:"bible.view"},schedules:{id:"schedules",icon:Rp,labelKey:"sidebar:navigation.schedules",to:"/schedules",permission:"programs.view"},livestream:{id:"livestream",icon:UI,labelKey:"sidebar:navigation.livestream",to:"/livestream",permission:"settings.view"},settings:{id:"settings",icon:ui,labelKey:"sidebar:navigation.settings",to:"/settings",permission:"settings.view"}},Ey={version:1,items:[{id:"present",type:"builtin",builtinId:"present",order:0,isVisible:!0},{id:"songs",type:"builtin",builtinId:"songs",order:1,isVisible:!0},{id:"bible",type:"builtin",builtinId:"bible",order:2,isVisible:!0},{id:"schedules",type:"builtin",builtinId:"schedules",order:3,isVisible:!0},{id:"livestream",type:"builtin",builtinId:"livestream",order:4,isVisible:!0}]},NW=["Globe","Link","ExternalLink","FileText","Video","Image","Bookmark","Star","Heart","Home","Users","Calendar","MessageSquare","Phone","Mail","Map","Compass","Search","Clock","Bell","Layers","Grid","List","Folder"],MA="sidebar_configuration",TW={Globe:nd,Link:Dj,ExternalLink:Dp,FileText:ds,Video:Qj,Image:_j,Bookmark:kj,Star:Kj,Heart:Aj,Home:Rj,Users:Bl,Calendar:Cj,MessageSquare:Bj,Phone:Uj,Mail:zj,Map:Pj,Compass:Tj,Search:Yl,Clock:_p,Bell:Sj,Layers:Oj,Grid:Mj,List:Lj,Folder:Ej};function jW({value:t,onChange:e}){const{t:n}=ke("settings");return u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-sm font-medium text-gray-900 dark:text-white",children:n("sections.sidebar.fields.icon")}),u.jsx("div",{className:"grid grid-cols-6 gap-2 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:NW.map(r=>{const s=TW[r],i=t===r;return u.jsx("button",{type:"button",onClick:()=>e(r),className:`
                p-2.5 rounded-lg transition-all flex items-center justify-center
                ${i?"bg-indigo-100 dark:bg-indigo-900/50 text-indigo-600 dark:text-indigo-400 ring-2 ring-indigo-500":"bg-white dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-600"}
              `,title:r,children:u.jsx(s,{size:20})},r)})}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:n("sections.sidebar.fields.selectIcon")})]})}function EW(t){try{return new URL(t),!0}catch{return!1}}function dT({isOpen:t,editingPage:e,onSubmit:n,onClose:r}){const{t:s}=ke("settings"),i=C.useRef(null),o=C.useRef(null),[l,d]=C.useState(""),[f,p]=C.useState(""),[g,y]=C.useState("Globe"),[m,b]=C.useState(!1),[v,w]=C.useState({}),S=!!e;C.useEffect(()=>{t&&(e?(d(e.title),p(e.url),y(e.iconName),b(e.useIframeEmbedding??!1)):(d(""),p(""),y("Globe"),b(!1)),w({}))},[t,e]),C.useEffect(()=>{const _=i.current;_&&(t?(_.showModal(),setTimeout(()=>o.current?.focus(),50)):_.close())},[t]);const T=_=>{_.target===i.current&&r()},j=()=>{const _={};return l.trim()||(_.title=s("sections.sidebar.validation.titleRequired")),f.trim()?EW(f)||(_.url=s("sections.sidebar.validation.urlInvalid")):_.url=s("sections.sidebar.validation.urlRequired"),w(_),Object.keys(_).length===0},M=_=>{_.preventDefault(),j()&&n({id:e?.id,title:l.trim(),url:f.trim(),iconName:g,useIframeEmbedding:m})};return u.jsx("dialog",{ref:i,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-lg w-full",onClose:r,onClick:T,children:u.jsxs("form",{onSubmit:M,className:"p-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:s(S?"sections.sidebar.modals.edit.title":"sections.sidebar.modals.create.title")}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{htmlFor:"custom-page-title",className:"text-sm font-medium text-gray-900 dark:text-white",children:s("sections.sidebar.fields.title")}),u.jsx("input",{ref:o,id:"custom-page-title",type:"text",value:l,onChange:_=>d(_.target.value),placeholder:s("sections.sidebar.fields.titlePlaceholder"),className:`
                block w-full px-3 py-2.5 bg-white dark:bg-gray-700
                border text-gray-900 dark:text-white text-sm rounded-lg
                focus:ring-indigo-500 focus:border-indigo-500
                placeholder:text-gray-500 dark:placeholder:text-gray-400
                ${v.title?"border-red-500":"border-gray-300 dark:border-gray-600"}
              `}),v.title&&u.jsx("p",{className:"text-sm text-red-500",children:v.title})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{htmlFor:"custom-page-url",className:"text-sm font-medium text-gray-900 dark:text-white",children:s("sections.sidebar.fields.url")}),u.jsx("input",{id:"custom-page-url",type:"text",value:f,onChange:_=>p(_.target.value),placeholder:s("sections.sidebar.fields.urlPlaceholder"),className:`
                block w-full px-3 py-2.5 bg-white dark:bg-gray-700
                border text-gray-900 dark:text-white text-sm rounded-lg
                focus:ring-indigo-500 focus:border-indigo-500
                placeholder:text-gray-500 dark:placeholder:text-gray-400
                ${v.url?"border-red-500":"border-gray-300 dark:border-gray-600"}
              `}),v.url&&u.jsx("p",{className:"text-sm text-red-500",children:v.url}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s("sections.sidebar.fields.urlHint")})]}),u.jsx(jW,{value:g,onChange:y}),u.jsxs("div",{className:"flex items-start gap-3 pt-2",children:[u.jsx("input",{id:"use-iframe-embedding",type:"checkbox",checked:m,onChange:_=>b(_.target.checked),className:"mt-1 h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx("label",{htmlFor:"use-iframe-embedding",className:"text-sm font-medium text-gray-900 dark:text-white cursor-pointer",children:s("sections.sidebar.fields.useIframeEmbedding")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s("sections.sidebar.fields.useIframeEmbeddingHint")})]})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:s("common:buttons.cancel",{defaultValue:"Cancel"})}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:s(S?"sections.sidebar.modals.edit.submit":"sections.sidebar.modals.create.submit")})]})]})})}function MW(t){const e=Object.keys(t1),n=new Set(t.items.map(s=>s.id)),r=e.filter(s=>!n.has(s)).map((s,i)=>({id:s,type:"builtin",builtinId:s,order:t.items.length+i,isVisible:!0}));return r.length===0?t:{...t,items:[...t.items,...r]}}function AW(t){if(typeof t!="object"||t===null)return!1;const e=t;return!(e.version!==1||!Array.isArray(e.items))}async function RW(){const t=await uo("app_settings",MA);if(!t)return Ey;try{const e=JSON.parse(t.value);return AW(e)?MW(e):Ey}catch{return Ey}}async function _W(t){return fo("app_settings",{key:MA,value:JSON.stringify(t)})}function OW(){return`custom_${Date.now()}_${Math.random().toString(36).substring(2,9)}`}function DW(t){return`custom_page.${t}.view`}const wl=["settings","sidebar_configuration"];function n1(){const t=Le(),{data:e,isLoading:n,error:r}=lt({queryKey:wl,queryFn:RW,staleTime:300*1e3}),s=Ie({mutationFn:_W,onMutate:async i=>{await t.cancelQueries({queryKey:wl});const o=t.getQueryData(wl);return t.setQueryData(wl,i),{previousConfig:o}},onError:(i,o,l)=>{l?.previousConfig&&t.setQueryData(wl,l.previousConfig)},onSettled:()=>{t.invalidateQueries({queryKey:wl})}});return{config:e,isLoading:n,error:r,updateConfig:s}}function IW({pageId:t}){const{t:e}=ke("settings"),{config:n,isLoading:r}=n1(),[s,i]=C.useState(!0),[o,l]=C.useState(null),[d]=C.useState(()=>dn()),f=n?.items.find(y=>y.id===t&&y.type==="custom"),p=C.useMemo(()=>f?.url?NA(f.url):null,[f?.url]),g=!d||f?.useIframeEmbedding;return C.useEffect(()=>{i(!0),l(null)},[t]),C.useEffect(()=>{g&&d&&wW()},[g,d,t]),C.useEffect(()=>{if(!f||!d||g){g||i(!1);return}const m=setTimeout(async()=>{try{await vW(f.id,f.url),i(!1),l(null)}catch(b){l(String(b)),i(!1)}},150);return()=>{clearTimeout(m)}},[f?.id,f?.url,d,g]),r?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600"})}):f?g?u.jsx("div",{className:"-m-4 md:-m-6 h-[calc(100%+2rem)] md:h-[calc(100%+3rem)] flex flex-col",children:u.jsx("iframe",{src:p??f.url,title:f.title,className:"flex-1 w-full border-0",sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-downloads",allow:"clipboard-write; clipboard-read; fullscreen"})}):!s&&!o?null:u.jsx("div",{className:"-m-4 md:-m-6 h-[calc(100%+2rem)] md:h-[calc(100%+3rem)] flex flex-col",children:u.jsxs("div",{className:"flex-1 relative bg-white dark:bg-gray-900",children:[s&&!o&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50 dark:bg-gray-800 z-10",children:u.jsxs("div",{className:"flex flex-col items-center gap-3",children:[u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e("sections.sidebar.loadingPage",{defaultValue:"Loading page..."})})]})}),o&&u.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-800 gap-4 p-8",children:[u.jsx(vh,{className:"w-12 h-12 text-red-500"}),u.jsxs("div",{className:"text-center max-w-md",children:[u.jsx("p",{className:"text-gray-900 dark:text-white font-medium mb-2",children:e("sections.sidebar.loadError",{defaultValue:"Failed to load page"})}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:o})]})]})]})}):u.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[u.jsx(vh,{className:"w-12 h-12 text-gray-400"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e("sections.sidebar.pageNotFound",{defaultValue:"Page not found"})})]})}const AA={Globe:nd,Link:Dj,ExternalLink:Dp,FileText:ds,Video:Qj,Image:_j,Bookmark:kj,Star:Kj,Heart:Aj,Home:Rj,Users:Bl,Calendar:Cj,MessageSquare:Bj,Phone:Uj,Mail:zj,Map:Pj,Compass:Tj,Search:Yl,Clock:_p,Bell:Sj,Layers:Oj,Grid:Mj,List:Lj,Folder:Ej};function LW(t){const{t:e}=ke();return C.useMemo(()=>{if(!t)return[];const n=[];for(const r of t.filter(s=>s.isVisible).sort((s,i)=>s.order-i.order))if(r.type==="builtin"){const s=t1[r.builtinId];if(!s)continue;n.push({id:r.id,icon:s.icon,label:e(s.labelKey),to:s.to,permission:s.permission,isCustom:!1})}else{const s=AA[r.iconName]??nd;n.push({id:r.id,icon:s,label:r.title,to:`/custom-page/${r.id}`,permission:DW(r.id),isCustom:!0})}return n},[t,e])}function zW(t){return AA[t]??nd}function PW({item:t,onToggleVisibility:e,onEdit:n,onDelete:r}){const{t:s}=ke(["settings","sidebar"]),{attributes:i,listeners:o,setNodeRef:l,transform:d,transition:f,isDragging:p}=xo({id:t.id}),g={transform:cs.Transform.toString(d),transition:f,opacity:p?.5:1},y=t.type==="builtin",m=t.type==="custom";let b,v;if(y){const w=t1[t.builtinId];b=w?.icon,v=s(w?.labelKey??"")}else b=zW(t.iconName),v=t.title;return u.jsxs("div",{ref:l,style:g,className:`
        flex items-center gap-3 p-3 bg-white dark:bg-gray-800
        border border-gray-200 dark:border-gray-700 rounded-lg
        ${p?"shadow-lg ring-2 ring-indigo-500":""}
        ${t.isVisible?"":"opacity-60"}
      `,children:[u.jsx("button",{type:"button",className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 cursor-grab active:cursor-grabbing",...i,...o,children:u.jsx(or,{size:20})}),b&&u.jsx("div",{className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-md bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400",children:u.jsx(b,{size:18})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate",children:v}),u.jsx("span",{className:`
              text-xs px-1.5 py-0.5 rounded
              ${y?"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400":"bg-indigo-100 dark:bg-indigo-900/50 text-indigo-600 dark:text-indigo-400"}
            `,children:s(y?"settings:sections.sidebar.builtIn":"settings:sections.sidebar.custom")})]}),m&&u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 truncate block",children:t.url})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{type:"button",onClick:e,className:`
            p-2 rounded-lg transition-colors
            ${t.isVisible?"text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20":"text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"}
          `,title:t.isVisible?s("settings:sections.sidebar.visible"):s("settings:sections.sidebar.hidden"),children:t.isVisible?u.jsx(ua,{size:18}):u.jsx(Wl,{size:18})}),m&&n&&u.jsx("button",{type:"button",onClick:n,className:"p-2 text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 rounded-lg transition-colors",title:s("common:buttons.edit",{defaultValue:"Edit"}),children:u.jsx(Xa,{size:18})}),m&&r&&u.jsx("button",{type:"button",onClick:r,className:"p-2 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:s("common:buttons.delete",{defaultValue:"Delete"}),children:u.jsx(Bn,{size:18})})]})]})}function BW(){const{t}=ke("settings"),{showToast:e}=mt(),{config:n,isLoading:r,updateConfig:s}=n1(),[i,o]=C.useState(!1),[l,d]=C.useState(null),[f,p]=C.useState(null),g=ho(sr(pi),sr(hi,{coordinateGetter:bo})),y=j=>{const{active:M,over:_}=j;if(!_||!n||M.id===_.id)return;const R=[...n.items],O=R.findIndex(H=>H.id===M.id),L=R.findIndex(H=>H.id===_.id);if(O===-1||L===-1)return;const[A]=R.splice(O,1);R.splice(L,0,A);const F=R.map((H,P)=>({...H,order:P}));s.mutate({...n,items:F},{onSuccess:()=>{e(t("sections.sidebar.toast.saved"),"success")},onError:()=>{e(t("sections.sidebar.toast.error"),"error")}})},m=j=>{if(!n)return;const M=n.items.map(_=>_.id===j?{..._,isVisible:!_.isVisible}:_);s.mutate({...n,items:M},{onSuccess:()=>{e(t("sections.sidebar.toast.saved"),"success")},onError:()=>{e(t("sections.sidebar.toast.error"),"error")}})},b=j=>{if(!n)return;const M={id:OW(),type:"custom",title:j.title,url:j.url,iconName:j.iconName,useIframeEmbedding:j.useIframeEmbedding,order:n.items.length,isVisible:!0},_=[...n.items,M];s.mutate({...n,items:_},{onSuccess:()=>{o(!1),e(t("sections.sidebar.toast.customPageCreated"),"success")},onError:()=>{e(t("sections.sidebar.toast.error"),"error")}})},v=j=>{if(!n||!j.id)return;const M=n.items.map(_=>_.id===j.id&&_.type==="custom"?{..._,title:j.title,url:j.url,iconName:j.iconName,useIframeEmbedding:j.useIframeEmbedding}:_);s.mutate({...n,items:M},{onSuccess:()=>{d(null),e(t("sections.sidebar.toast.customPageUpdated"),"success")},onError:()=>{e(t("sections.sidebar.toast.error"),"error")}})},w=()=>{if(!n||!f)return;const j=n.items.filter(M=>M.id!==f).map((M,_)=>({...M,order:_}));s.mutate({...n,items:j},{onSuccess:()=>{p(null),e(t("sections.sidebar.toast.customPageDeleted"),"success")},onError:()=>{e(t("sections.sidebar.toast.error"),"error")}})},S=n?.items?[...n.items].filter(j=>j.id!=="settings").sort((j,M)=>j.order-M.order):[],T=f?S.find(j=>j.id===f&&j.type==="custom"):null;return r?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"})}):u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[u.jsx(AI,{className:"w-5 h-5"}),t("sections.sidebar.title")]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t("sections.sidebar.description")})]}),u.jsxs("button",{type:"button",onClick:()=>o(!0),className:"flex items-center gap-2 px-3 py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-medium rounded-lg transition-colors",children:[u.jsx(Xt,{size:16}),t("sections.sidebar.addCustomPage")]})]}),u.jsx(go,{sensors:g,collisionDetection:po,onDragEnd:y,children:u.jsx(yo,{items:S.map(j=>j.id),strategy:mo,children:u.jsx("div",{className:"space-y-2",children:S.map(j=>u.jsx(PW,{item:j,onToggleVisibility:()=>m(j.id),onEdit:j.type==="custom"?()=>d(j):void 0,onDelete:j.type==="custom"?()=>p(j.id):void 0},j.id))})})}),u.jsx(dT,{isOpen:i,onSubmit:b,onClose:()=>o(!1)}),u.jsx(dT,{isOpen:!!l,editingPage:l,onSubmit:v,onClose:()=>d(null)}),u.jsx(di,{isOpen:!!f,title:t("sections.sidebar.modals.delete.title"),message:t("sections.sidebar.modals.delete.message",{name:T?.title??""}),confirmLabel:t("sections.sidebar.modals.delete.confirm"),onConfirm:w,onCancel:()=>p(null),variant:"danger"})]})}function FW(){const[t,e]=C.useState(!1),[n,r]=C.useState(!1),s=jp(),{t:i}=ke(["sidebar","common"]),{hasPermission:o}=bA(),{config:l}=n1(),f=LW(l?.items).filter(y=>y.id==="settings"?!1:y.isCustom||y.permission?o(y.permission):!0),p=o("settings.view"),g=C.useCallback(y=>{y.startsWith("/custom-page/")||EA()},[]);return C.useEffect(()=>{r(!1)},[s.pathname]),C.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[n]),C.useEffect(()=>{const y=setTimeout(()=>{SW()},350);return()=>clearTimeout(y)},[t]),u.jsxs(u.Fragment,{children:[u.jsxs("header",{className:"md:hidden fixed top-0 left-0 right-0 z-40 flex items-center justify-between px-4 py-3 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("img",{src:"/logo192.png",alt:"Church Hub",className:"w-8 h-8"}),u.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Church Hub"})]}),u.jsx("button",{onClick:()=>r(!0),className:"p-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":i("sidebar:actions.openMenu"),children:u.jsx(xI,{size:24})})]}),n&&u.jsx("div",{className:"md:hidden fixed inset-0 z-40 bg-black/50 backdrop-blur-sm",onClick:()=>r(!1)}),u.jsxs("aside",{className:`
          fixed md:relative z-50 md:z-auto
          flex flex-col h-full bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800
          transition-all duration-300 ease-in-out
          w-72 md:w-auto top-0 left-0
          ${t?"md:w-20":"md:w-64"}
          ${n?"translate-x-0":"-translate-x-full md:translate-x-0"}
        `,children:[u.jsxs("div",{className:"md:hidden flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("img",{src:"/logo192.png",alt:"Church Hub",className:"w-8 h-8"}),u.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Church Hub"})]}),u.jsx("button",{onClick:()=>r(!1),className:"p-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":i("sidebar:actions.closeMenu"),children:u.jsx(nt,{size:24})})]}),u.jsx("div",{className:"hidden md:block",children:u.jsx(CW,{isCollapsed:t})}),u.jsxs("nav",{className:"flex-1 flex flex-col gap-2 p-3 overflow-y-auto",children:[f.map(y=>u.jsx(uT,{icon:y.icon,label:y.label,to:y.to,isCollapsed:t,isActive:s.pathname===y.to||s.pathname.startsWith(`${y.to}/`),className:"md:flex",onClick:()=>g(y.to)},y.id)),p&&u.jsx("div",{className:"mt-auto",children:u.jsx(uT,{icon:ui,label:i("sidebar:navigation.settings"),to:"/settings",isCollapsed:t,isActive:s.pathname==="/settings"||s.pathname.startsWith("/settings/"),className:"md:flex",onClick:()=>g("/settings")})})]}),u.jsx("div",{className:"p-3 border-t border-gray-200 dark:border-gray-800 space-y-2",children:u.jsx("button",{onClick:()=>e(!t),className:`hidden md:flex w-full items-center gap-3 px-4 py-3 rounded-lg
              text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800
              transition-colors`,title:i(t?"sidebar:actions.expand":"sidebar:actions.collapseSidebar"),children:t?u.jsx(Ms,{size:20,className:"flex-shrink-0"}):u.jsxs(u.Fragment,{children:[u.jsx(Nj,{size:20,className:"flex-shrink-0"}),u.jsx("span",{className:"text-sm font-medium",children:i("sidebar:actions.collapse")})]})})})]})]})}function UW({children:t}){return jp().pathname.startsWith("/screen/")?u.jsx(u.Fragment,{children:t}):u.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-50 dark:bg-gray-950",children:[u.jsx(kW,{}),u.jsx(FW,{}),u.jsx("main",{className:"flex-1 overflow-y-auto [scrollbar-gutter:stable] scrollbar-thin bg-gray-50 dark:bg-gray-950 pt-14 md:pt-0",children:u.jsx("div",{className:"p-4 md:p-6 h-full",children:t})})]})}const{slice:$W,forEach:qW}=[];function HW(t){return qW.call($W.call(arguments,1),e=>{if(e)for(const n in e)t[n]===void 0&&(t[n]=e[n])}),t}function VW(t){return typeof t!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(n=>n.test(t))}const fT=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,KW=function(t,e){const r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},s=encodeURIComponent(e);let i=`${t}=${s}`;if(r.maxAge>0){const o=r.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");i+=`; Max-Age=${Math.floor(o)}`}if(r.domain){if(!fT.test(r.domain))throw new TypeError("option domain is invalid");i+=`; Domain=${r.domain}`}if(r.path){if(!fT.test(r.path))throw new TypeError("option path is invalid");i+=`; Path=${r.path}`}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");i+=`; Expires=${r.expires.toUTCString()}`}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return r.partitioned&&(i+="; Partitioned"),i},hT={create(t,e,n,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};n&&(s.expires=new Date,s.expires.setTime(s.expires.getTime()+n*60*1e3)),r&&(s.domain=r),document.cookie=KW(t,e,s)},read(t){const e=`${t}=`,n=document.cookie.split(";");for(let r=0;r<n.length;r++){let s=n[r];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return s.substring(e.length,s.length)}return null},remove(t,e){this.create(t,"",-1,e)}};var QW={name:"cookie",lookup(t){let{lookupCookie:e}=t;if(e&&typeof document<"u")return hT.read(e)||void 0},cacheUserLanguage(t,e){let{lookupCookie:n,cookieMinutes:r,cookieDomain:s,cookieOptions:i}=e;n&&typeof document<"u"&&hT.create(n,t,r,s,i)}},WW={name:"querystring",lookup(t){let{lookupQuerystring:e}=t,n;if(typeof window<"u"){let{search:r}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(r=window.location.hash.substring(window.location.hash.indexOf("?")));const i=r.substring(1).split("&");for(let o=0;o<i.length;o++){const l=i[o].indexOf("=");l>0&&i[o].substring(0,l)===e&&(n=i[o].substring(l+1))}}return n}},YW={name:"hash",lookup(t){let{lookupHash:e,lookupFromHashIndex:n}=t,r;if(typeof window<"u"){const{hash:s}=window.location;if(s&&s.length>2){const i=s.substring(1);if(e){const o=i.split("&");for(let l=0;l<o.length;l++){const d=o[l].indexOf("=");d>0&&o[l].substring(0,d)===e&&(r=o[l].substring(d+1))}}if(r)return r;if(!r&&n>-1){const o=s.match(/\/([a-zA-Z-]*)/g);return Array.isArray(o)?o[typeof n=="number"?n:0]?.replace("/",""):void 0}}}return r}};let Sl=null;const pT=()=>{if(Sl!==null)return Sl;try{if(Sl=typeof window<"u"&&window.localStorage!==null,!Sl)return!1;const t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{Sl=!1}return Sl};var GW={name:"localStorage",lookup(t){let{lookupLocalStorage:e}=t;if(e&&pT())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupLocalStorage:n}=e;n&&pT()&&window.localStorage.setItem(n,t)}};let kl=null;const gT=()=>{if(kl!==null)return kl;try{if(kl=typeof window<"u"&&window.sessionStorage!==null,!kl)return!1;const t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{kl=!1}return kl};var XW={name:"sessionStorage",lookup(t){let{lookupSessionStorage:e}=t;if(e&&gT())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupSessionStorage:n}=e;n&&gT()&&window.sessionStorage.setItem(n,t)}},JW={name:"navigator",lookup(t){const e=[];if(typeof navigator<"u"){const{languages:n,userLanguage:r,language:s}=navigator;if(n)for(let i=0;i<n.length;i++)e.push(n[i]);r&&e.push(r),s&&e.push(s)}return e.length>0?e:void 0}},ZW={name:"htmlTag",lookup(t){let{htmlTag:e}=t,n;const r=e||(typeof document<"u"?document.documentElement:null);return r&&typeof r.getAttribute=="function"&&(n=r.getAttribute("lang")),n}},eY={name:"path",lookup(t){let{lookupFromPathIndex:e}=t;if(typeof window>"u")return;const n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(n)?n[typeof e=="number"?e:0]?.replace("/",""):void 0}},tY={name:"subdomain",lookup(t){let{lookupFromSubdomainIndex:e}=t;const n=typeof e=="number"?e+1:1,r=typeof window<"u"&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(r)return r[n]}};let RA=!1;try{document.cookie,RA=!0}catch{}const _A=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];RA||_A.splice(1,1);const nY=()=>({order:_A,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t});class OA{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,n)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=HW(n,this.options||{},nY()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=s=>s.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=r,this.addDetector(QW),this.addDetector(WW),this.addDetector(GW),this.addDetector(XW),this.addDetector(JW),this.addDetector(ZW),this.addDetector(eY),this.addDetector(tY),this.addDetector(YW)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,n=[];return e.forEach(r=>{if(this.detectors[r]){let s=this.detectors[r].lookup(this.options);s&&typeof s=="string"&&(s=[s]),s&&(n=n.concat(s))}}),n=n.filter(r=>r!=null&&!VW(r)).map(r=>this.options.convertDetectedLanguage(r)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}cacheUserLanguage(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;n&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||n.forEach(r=>{this.detectors[r]&&this.detectors[r].cacheUserLanguage(e,this.options)}))}}OA.type="languageDetector";const rY="Bible",sY={placeholder:'Search verses (e.g., "Gen 1:1" or "In the beginning")',hint:'Type a reference like "Gen 1:1" or search for text',noResults:"No results found",searching:"Searching...",directReference:"Direct reference",resultsCount:"{{count}} verse found",resultsCount_other:"{{count}} verses found"},iY={back:"Back",oldTestament:"Old Testament",newTestament:"New Testament",noBooks:"No books available"},aY={title:"Bible Queue",empty:"No verses in queue",removed:"Verse removed from queue",remove:"Remove"},oY={title:"Preview",prev:"Prev",next:"Next",prevVerse:"Previous verse",nextVerse:"Next verse",show:"Show",hide:"Hide"},lY={title:"Keyboard Shortcuts",navigate:"Navigate verses",back:"Go back",hide:"Hide display",present:"Present verse"},cY={presentNow:"Present now",addToQueue:"Add to queue",import:"Import",importFirst:"Import Bible Translation",settings:"Settings",openSettings:"Open Settings"},uY={title:"No Bible translations",description:"Import a Bible translation in USFX XML format to get started.",noTranslationsSelected:"No translations selected",noTranslationsSelectedDescription:"Go to Settings > Bible Translations to select which translations to use."},dY={title:"Bible Settings",import:{title:"Import Translation",description:"Import a Bible translation from an USFX XML file.",button:"Select File",formatTitle:"Required Format: USFX XML",formatDescription:"The Bible translation must be in USFX (Unified Standard Format XML) format. This is a standardized format used for Scripture encoding.",structureTitle:"File Structure Example:",hints:{rootElement:"Root element must be <usfx>",bookElement:'Each book uses <book id="XXX"> with standard abbreviations (GEN, EXO, etc.)',chapterElement:'Chapters use <c id="N"> where N is the chapter number',verseElement:'Verses use <v id="N">text</v> where N is the verse number'}}},fY={select:"Select translation",loading:"Loading translations..."},hY={title:rY,search:sY,navigation:iY,queue:aY,controls:oY,shortcuts:lY,actions:cY,empty:uY,import:{title:"Import Bible Translation",error:"Failed to import translation",errorTitle:"Import Error",success:"Translation imported successfully"},settings:dY,translation:fY},pY={goBack:"Go back",startOver:"Start Over",cancel:"Cancel",confirm:"Confirm",delete:"Delete",save:"Save",ok:"OK"},gY={pageNotFound:"The page you are looking for does not exist.",noPermission:"You don't have permission to access this page.",noPermissionTitle:"Access Denied",contactAdmin:"Please contact your administrator if you believe this is an error."},mY={system:"System",lightMode:"Light mode",darkMode:"Dark mode",toggleTheme:"Toggle theme"},yY={buttons:pY,errors:gY,theme:mY},xY="Live Stream",bY={notConnected:"YouTube not connected",connected:"Connected as {{channelName}}",login:"Login with YouTube",logout:"Disconnect YouTube",authenticating:"Authenticating...",loggingOut:"Logging out...",clickToConnect:"Click to connect to YouTube",clickToDisconnect:"Click to disconnect from YouTube",openGuide:"Setup Guide",settings:"YouTube Settings",titleTemplate:"Title Template",description:"Description",privacyStatus:"Privacy",privacyPublic:"Public",privacyUnlisted:"Unlisted",privacyPrivate:"Private",streamKey:"Stream Key",selectStreamKey:"Select stream key",playlist:"Playlist ID",startScene:"Start Scene",setup:{title:"YouTube Live Setup",templateTitle:"Use Previous Broadcast Settings",templateDescription:"Select settings from a past broadcast:",noTemplates:"No past broadcasts found",noTemplatesHint:"Create a live stream in YouTube Studio first. After your broadcast ends, it will appear here.",completedAt:"Completed",usingTemplate:"Using broadcast settings",usingTemplateHint:"These settings will be applied to your next broadcast.",firstTimeTitle:"First time streaming?",firstTimeDescription:"Create a live stream directly in YouTube Studio. Configure your stream settings, go live from OBS, and your broadcast will be saved here for future use.",openYouTubeStudio:"Open YouTube Studio",close:"Close"}},vY={connected:"OBS Connected",disconnected:"OBS Disconnected",connecting:"Connecting...",connect:"Connect to OBS",disconnect:"Disconnect",disconnecting:"Disconnecting...",clickToConnect:"Click to connect to OBS",clickToDisconnect:"Click to disconnect from OBS",openGuide:"Setup Guide",settings:"OBS Settings",host:"Host",port:"Port",password:"Password",autoConnect:"Auto-connect on startup",setup:{title:"OBS WebSocket Setup",helpLink:"Need help connecting?",step1Title:"Step 1: Install OBS WebSocket",step1Description:"OBS WebSocket is required for Church Hub to control OBS Studio. For OBS 28+, it's built-in. For older versions, download and install it:",downloadLink:"Download OBS WebSocket from GitHub",step2Title:"Step 2: Enable WebSocket Server",step2Instruction1:"Open OBS Studio",step2Instruction2:"Go to Tools  WebSocket Server Settings",step2Instruction3:'Check "Enable WebSocket server" and set the password below',step3Title:"Step 3: Configure Password",step3Description:"Copy this password and paste it in OBS WebSocket Server Settings:",copy:"Copy",copied:"Copied!",noteTitle:"Note:",noteDescription:"Make sure to use the same password in OBS. Church Hub will automatically use this password when connecting.",saveAndClose:"Save & Close"}},wY={startStream:"Start Stream",stopStream:"Stop Stream",isLive:"LIVE",notStreaming:"Not Streaming",starting:"Starting...",stopping:"Stopping...",progress:{creating_broadcast:"Creating broadcast",waiting_for_ready:"Waiting for YouTube",delay_before_stream:"Preparing stream",starting_obs:"Starting OBS",completed:"Stream started",error:"Error starting stream"}},SY={currentBroadcast:"Current Broadcast",noBroadcast:"No active broadcast",loading:"Loading broadcast info...",copyMessage:"Copy Message",messageCopied:"Message copied to clipboard",copyToClipboard:"Copy to clipboard",copied:"Copied!",openInYouTube:"Open in YouTube",watchLive:"Watch Live",openStudio:"YouTube Studio"},kY={title:"Scenes",settings:"Scene Settings",sceneSettings:"Scene Settings",displayName:"Display Name",visible:"Visible",hidden:"Hidden",current:"Current",shortcuts:"Keyboard Shortcuts",addShortcut:"Add Shortcut",removeShortcut:"Remove",recordShortcut:"Press keys...",clickToRecord:"Click to record",recording:"Recording...",noShortcuts:"No shortcuts assigned",shortcutConflict:'Already used by "{{scene}}"',streamSceneSettings:"Stream Scene Settings",useAsStartScene:"Use as stream start scene",useAsStartSceneDescription:"This scene will be activated before the stream starts",useAsStopScene:"Use as stream stop scene",useAsStopSceneDescription:"This scene will be activated after the stream stops",autoSceneSettings:"Auto-Switch Settings",autoSceneDescription:"Switch to this scene when showing:",contentTypes:{song:"Songs",bible:"Bible Verse",biblePassage:"Bible Passage",announcement:"Announcements",verseteTineri:"Versete Tineri",empty:"Empty / Clock"},mixerActions:"Mixer Channel Actions",mixerActionsDescription:"Configure mixer channels when this scene activates:",unmute:"Unmute",mute:"Mute",selectChannels:"Select channels...",selectContentTypes:"Select content types...",addMore:"Add more..."},CY={title:"Mixer",connected:"Mixer Connected",disconnected:"Mixer Disconnected",reconnecting:"Reconnecting...",testing:"Testing...",enable:"Enable Mixer",disable:"Disable Mixer",settings:"Mixer Settings",setup:{title:"Mixer Setup",connectionSettings:"Connection Settings",host:"Host IP",port:"Port",enableControl:"Enable Mixer Control",channelConfiguration:"Channel Configuration",channelCount:"Number of Channels",channelPlaceholder:"Channel label",testConnection:"Test Connection",testing:"Testing...",testSuccess:"Connection successful!",testFailed:"Connection failed",save:"Save"}},NY={obsConnectionFailed:"Failed to connect to OBS",obsNotRunning:"Cannot connect to OBS. Make sure OBS is running and WebSocket server is enabled (Tools  WebSocket Server Settings).",obsAuthFailed:"OBS authentication failed. Check your WebSocket password in OBS settings.",obsTimeout:"Connection to OBS timed out. Check that the host and port are correct.",youtubeAuthFailed:"YouTube authentication failed",youtubeSessionExpired:"Your YouTube session has expired. Please reconnect.",youtubeReauthRequired:"YouTube requires you to sign in again",broadcastFailed:"Failed to create broadcast",sceneSwitchFailed:"Failed to switch scene",startStreamFailed:"Failed to start stream",stopStreamFailed:"Failed to stop stream"},TY={title:xY,youtube:bY,obs:vY,stream:wY,broadcast:SY,scenes:kY,mixer:CY,errors:NY},jY={title:"Screens",description:"Configure screens for different display purposes. Each screen type has its own layout and configuration options.",addScreen:"Add Screen",addFirstScreen:"Add First Screen",noScreens:"No screens configured",noScreensDescription:"Add your first screen to configure how content is displayed.",screenName:"Screen Name",screenNamePlaceholder:"e.g., Main Projector",screenType:"Screen Type",screenTypes:{primary:"Primary / Audience",stage:"Stage Monitor",livestream:"Live Stream"},createAndConfigure:"Create & Configure",deleteConfirmTitle:"Delete Screen?",deleteConfirmMessage:'Are you sure you want to delete "{{name}}"? This action cannot be undone.',editor:{preview:"Preview",zoom:"Zoom",resetZoom:"Reset Zoom",save:"Save",unsavedChanges:"Unsaved changes",previewText:"Preview Text",previewTextDescription:"Customize the preview text to test how your styling looks with different content.",customPreviewText:"Custom Text",previewTextPlaceholder:"Enter custom preview text (multiline supported)...",resetPreviewText:"Reset to Default"},contentTypes:{song:"Song",bible:"Bible Verse",bible_passage:"Bible Passage",announcement:"Announcement",versete_tineri:"Versete Tineri",empty:"Empty / Clock"},panels:{position:"Position & Size",textStyle:"Text Style",animation:"Animation",background:"Background",general:"General Settings",nextSlide:"Next Slide Section",visibility:"Visibility"},visibility:{hideElement:"Hide element"},position:{x:"X Position",y:"Y Position",width:"Width",height:"Height",unit:"Unit",pixels:"Pixels",percent:"Percent",constraints:"Constraints",element:"Element",top:"Top",bottom:"Bottom",left:"Left",right:"Right",stretchHorizontal:"Width stretches between left and right constraints",stretchVertical:"Height stretches between top and bottom constraints"},textStyle:{fontFamily:"Font Family",maxFontSize:"Max Font Size",autoScale:"Auto Scale",autoScaleDescription:"Automatically scales text to fit the container. When disabled, uses a fixed font size.",fontSize:"Font Size",color:"Color",bold:"Bold",italic:"Italic",underline:"Underline",horizontalAlignment:"Horizontal Alignment",verticalAlignment:"Vertical Alignment",left:"Left",center:"Center",right:"Right",top:"Top",middle:"Middle",bottom:"Bottom",lineHeight:"Line Height",shadow:"Text Shadow",compressLines:"Compress Lines",lineSeparator:"Line Separator",separators:{space:"Double Space",dash:"Em Dash ()",pipe:"Pipe (|)"},fitLineToWidth:"Fit Each Line to Width",fitLineToWidthDescription:"Prevents line wrapping - each line scales to fit container width"},animation:{animationIn:"Animation In",animationOut:"Animation Out",type:"Type",duration:"Duration",delay:"Delay",easing:"Easing",types:{none:"None",fade:"Fade",slideUp:"Slide Up",slideDown:"Slide Down",slideLeft:"Slide Left",slideRight:"Slide Right",scale:"Scale",blur:"Blur"},easings:{linear:"Linear",easeIn:"Ease In",easeOut:"Ease Out",easeInOut:"Ease In Out",bounce:"Bounce"}},background:{type:"Type",types:{transparent:"Transparent",color:"Solid Color",image:"Image",video:"Video"},color:"Color",imageUrl:"Image URL",videoUrl:"Video URL",opacity:"Opacity"},general:{screenSize:"Screen Size",width:"Width",height:"Height",clockEnabled:"Show Clock",defaultBackground:"Default Background"},nextSlide:{enabled:"Show Next Slide Section",labelText:"Label Text",labelStyle:"Label Style",contentStyle:"Content Style"},bibleOptions:{title:"Bible Options",includeReferenceInContent:"Include reference in content",includeReferenceInContentDescription:"Prepends the Bible reference to the verse content and hides the separate reference element"},nativeWindow:"Native Window",messages:{screenCreated:"Screen created successfully",screenCreateFailed:"Failed to create screen",screenSaved:"Screen saved successfully",screenSaveFailed:"Failed to save screen",screenDeleted:"Screen deleted successfully",screenDeleteFailed:"Failed to delete screen"},renderer:{loading:"Loading screen configuration...",error:"Failed to load screen",notFound:"Screen not found"}},EY={title:"Displays",description:"Configure output displays for your presentations. Each display can have its own theme and settings.",add:"Add Display",addFirst:"Add Your First Display",edit:"Edit Display",empty:"No Displays",emptyDescription:"Create displays to output your presentations to different screens or windows.",name:"Display Name",namePlaceholder:"e.g., Main Screen, Stage Monitor",activeLabel:"Display is active",active:"Active",inactive:"Inactive",activate:"Activate",deactivate:"Deactivate",editTheme:"Edit Theme",openWindow:"Open Display Window",deleteConfirmTitle:"Delete Display?",deleteConfirmMessage:'Are you sure you want to delete "{{name}}"? This action cannot be undone.',openMode:"Open Mode",openModes:{browser:"Browser",native:"Native Window"},fullscreenLabel:"Open in fullscreen by default"},MY={title:"Display Theme",backgroundType:"Background Type",backgrounds:{transparent:"Transparent",color:"Solid Color",image:"Image"},backgroundColor:"Background Color",backgroundImage:"Image URL",textColor:"Text Color",fontFamily:"Font Family",padding:"Padding",preview:"Preview",sampleText:"Sample Text"},AY={save:"Save",cancel:"Cancel",delete:"Delete",close:"Close"},RY={displaySaved:"Display saved successfully",displaySaveFailed:"Failed to save display",displayDeleted:"Display deleted",displayDeleteFailed:"Failed to delete display",displayActivated:"Display activated",displayDeactivated:"Display deactivated",displayToggleFailed:"Failed to toggle display status",themeSaved:"Theme saved successfully",themeSaveFailed:"Failed to save theme"},_Y={start:"Start",stop:"Stop",prev:"Previous",next:"Next",clear:"Clear Slide",show:"Show",hide:"Hide",screenHidden:"Screen is hidden",screenDisplayed:"Screen is displayed"},OY={title:"Control Room",selectProgram:"Select a program",presenting:"Presenting",notPresenting:"Not presenting",connected:"Connected",connecting:"Connecting...",disconnected:"Disconnected",openDisplay:"Open Display",slides:"Slides",noSlides:"No slides in this program",preview:"Preview"},DY={screens:jY,displays:EY,theme:MY,actions:AY,messages:RY,controls:_Y,controlRoom:OY},IY="Queue",LY="Queue is empty",zY="Add songs to start presenting",PY="{{count}} song",BY="{{count}} songs",FY="{{count}} item",UY="{{count}} items",$Y={addToQueue:"Add to Queue",presentNow:"Present Now",remove:"Remove",clear:"Clear Queue",expand:"Expand",collapse:"Collapse",editSong:"Edit",editSlide:"Edit Slide",insertSlide:"Insert Slide After",insertAfter:"Insert After",moreOptions:"More options",cancel:"Cancel",addToSchedule:"Add to Schedule",saveAsProgram:"Save as Program"},qY={button:"Add",title:"Add to Queue",searchSong:"Search Song",searchSongDescription:"Find and add an existing song",bibleVerse:"Bible Verse",bibleVerseDescription:"Search and add a Bible verse",biblePassage:"Bible Passage",biblePassageDescription:"Add a range of Bible verses",announcement:"Announcement",announcementDescription:"Create a custom announcement slide",verseteTineri:"Versete Tineri",verseteTineriDescription:"Add a youth verse slide",importSchedule:"Import Schedule",importScheduleDescription:"Add all items from a saved schedule"},HY={added:"Added to queue",removed:"Removed from queue",cleared:"Queue cleared",presenting:"Now presenting",error:"An error occurred",slideInserted:"Slide inserted",slideUpdated:"Slide updated",savedAsProgram:"Queue saved as program",biblePassageInserted:"Bible passage added to queue",verseteTineriInserted:"Youth verses added to queue"},VY={title:"Save Queue as Program",nameLabel:"Program Name",namePlaceholder:"Enter program name",save:"Save",cancel:"Cancel"},KY={title:"Clear Queue?",message:"This will remove all items from the queue."},QY={announcement:"Announcement",versete_tineri:"Versete tineri"},WY={title:"Insert Slide",editTitle:"Edit Slide",selectTemplate:"Select template",content:"Content",insert:"Insert",save:"Save",errorEmpty:"Please add content to the slide"},YY={title:"Import Schedule",description:"Add all items from a saved schedule to the queue"},GY={title:"Add Bible Passage",translation:"Translation",reference:"Reference",referencePlaceholder:"e.g., Gen 1:1-5 or Ioan 3:16",referenceHint:"Enter book, chapter, and verse range",valid:"Valid",add:"Add to Queue",passage:"Bible Passage",errors:{empty:"Please enter a reference",invalid_format:"Invalid format. Try: Gen 1:1 or Gen 1:1-5",book_not_found:"Book not found",invalid_chapter:"Invalid chapter number",end_before_start:"End must be after start"}},XY={title:"Youth Verses",addEntry:"Add Entry",personName:"Person Name",personNamePlaceholder:"Enter name...",bibleReference:"Bible Reference",bibleReferencePlaceholder:"e.g., John 3:16",entriesCount_one:"{{count}} entry",entriesCount_other:"{{count}} entries",removeEntry:"Remove entry",noEntries:"No entries added yet",addFirstEntry:"Add an entry to get started"},JY={title:IY,empty:LY,emptyDescription:zY,songCount_one:PY,songCount_other:BY,itemCount_one:FY,itemCount_other:UY,actions:$Y,addToQueue:qY,messages:HY,saveAsProgram:VY,confirmClear:KY,slideTemplates:QY,insertSlide:WY,importSchedule:YY,biblePassage:GY,verseteTineri:XY},ZY="Schedules",eG={create:"New Schedule",save:"Save",delete:"Delete",back:"Back to Schedules",addItem:"Add",importToQueue:"Import to Queue"},tG={titlePlaceholder:"Enter schedule title...",descriptionPlaceholder:"Add a description (optional)...",items:"Items",noItems:"No items yet",addFirstItem:"Add songs or slides to build your schedule"},nG={placeholder:"Search schedules...",noResults:'No schedules found for "{{query}}"',resultsCount:"{{count}} schedules found"},rG={saved:"Schedule saved successfully",deleted:"Schedule deleted successfully",itemAdded:"Item added to schedule",itemRemoved:"Item removed from schedule",importedToQueue:"Schedule imported to queue",error:"An error occurred"},sG={deleteTitle:"Delete Schedule",deleteMessage:"Are you sure you want to delete this schedule? This action cannot be undone.",importTitle:"Import Schedule",unsavedChangesTitle:"Unsaved Changes",unsavedChangesMessage:"You have unsaved changes. Are you sure you want to leave?",discardChanges:"Lose changes",addSongTitle:"Add to Schedule",addSongDescription:"Select a schedule to add this song",adding:"Adding...",createTitle:"New Schedule",scheduleName:"Schedule name",create:"Create",cancel:"Cancel",createNew:"Create new schedule"},iG="No schedules yet",aG="Create your first schedule to plan your presentations",oG="{{count}} item",lG="{{count}} items",cG="Created {{date}}",uG={title:ZY,actions:eG,editor:tG,search:nG,messages:rG,modal:sG,noSchedules:iG,noSchedulesDescription:aG,itemCount_one:oG,itemCount_other:lG,createdAt:cG},dG="Settings",fG=JSON.parse(`{"appearance":{"title":"Appearance"},"bible":{"title":"Bible Translations","description":"Select up to 3 translations to display. Drag to reorder.","addTranslation":"Add Translation","primary":"Primary","secondary":"Secondary","tertiary":"Tertiary","noTranslations":"No translations selected","noTranslationsDescription":"Add a Bible translation to get started","maxReached":"Maximum 3 translations","translationsSelected":"translations selected","modals":{"add":{"title":"Add Translation","selectLabel":"Select a translation","submit":"Add"}},"toast":{"saved":"Translations saved","removed":"Translation removed","added":"Translation added","error":"An error occurred"}},"application":{"title":"Application Settings","description":"Configure your Church Hub preferences here"},"language":{"title":"Language","description":"Select your preferred language","options":{"system":"System Default","english":"English","romanian":"Romanian"}},"theme":{"title":"Theme","description":"Choose your preferred color theme","options":{"system":"System Default","light":"Light","dark":"Dark"}},"shortcuts":{"title":"Keyboard Shortcuts","description":"Configure global keyboard shortcuts for quick actions. These shortcuts work from anywhere in the application.","actions":{"startLive":{"label":"Start Live Stream","description":"Start the YouTube live stream (only when ready)"},"stopLive":{"label":"Stop Live Stream","description":"Stop the current YouTube live stream"},"searchSong":{"label":"Search Songs","description":"Navigate to songs and focus the search input"},"searchBible":{"label":"Search Bible","description":"Navigate to Bible and focus the search input"}},"addShortcut":"Add Shortcut","noShortcuts":"No shortcuts configured","enabled":"Enabled","disabled":"Disabled","clickToRecord":"Click to record","recording":"Recording...","recordShortcut":"Press keys...","recordShortcutOrMidi":"Press key or MIDI button...","removeShortcut":"Remove","conflicts":{"global":"Already used by \\"{{action}}\\"","scene":"Already used by scene \\"{{scene}}\\""},"midi":{"title":"MIDI Controller","description":"Use hardware MIDI controllers for shortcuts with LED feedback","notSupported":"Web MIDI API is not supported in this browser. MIDI controller features are unavailable.","inputDevice":"Input Device","outputDevice":"Output Device (LEDs)","selectDevice":"Select device...","noInputDevices":"No MIDI input devices detected","noOutputDevices":"No MIDI output devices detected","refresh":"Refresh devices","requestPermission":"Grant MIDI Access","permissionError":"MIDI access denied: {{error}}","fullyConnected":"Input and output connected","inputOnly":"Input connected (no LED feedback)","outputOnly":"Output connected (no triggers)"}},"users":{"title":"Authorized Users","description":"Manage users that can access your Church Hub","addUser":"Add User","noUsers":"No users configured","noUsersDescription":"Add a user to allow external access to your Church Hub","userName":"User Name","userNamePlaceholder":"e.g., John's Tablet","permissions":"permissions","permissionsSelected":"permissions selected","status":"Status","active":"Active","inactive":"Inactive","lastUsed":"Last used","never":"Never","createdAt":"Created","roleTemplate":"Role Template","roles":{"admin":"Administrator","presenter":"Presenter","viewer":"Viewer","queue_manager":"Queue Manager"},"groups":{"songs":"Songs","control_room":"Control Room","programs":"Programs","queue":"Queue","settings":"Settings","displays":"Displays","users":"User Management"},"permissionLabels":{"songs.view":"View songs","songs.create":"Create songs","songs.edit":"Edit songs","songs.delete":"Delete songs","songs.add_to_queue":"Add songs to queue","songs.present_now":"Present songs immediately","control_room.view":"View control room","control_room.control":"Control presentation","programs.view":"View programs","programs.create":"Create programs","programs.edit":"Edit programs","programs.delete":"Delete programs","programs.import_to_queue":"Import programs to queue","queue.view":"View queue","queue.add":"Add items to queue","queue.remove":"Remove items from queue","queue.reorder":"Reorder queue items","queue.clear":"Clear queue","settings.view":"View settings","settings.edit":"Edit settings","displays.view":"View displays","displays.create":"Create displays","displays.edit":"Edit displays","displays.delete":"Delete displays","users.view":"View users","users.create":"Create users","users.edit":"Edit users","users.delete":"Delete users"},"actions":{"edit":"Edit","delete":"Delete","regenerateToken":"Regenerate Token","showQRCode":"Show QR Code","deactivate":"Deactivate","activate":"Activate","copyUrl":"Copy URL"},"modals":{"cancel":"Cancel","create":{"title":"Add New User","submit":"Create User"},"edit":{"title":"Edit User","submit":"Save Changes"},"delete":{"title":"Delete User","message":"Are you sure you want to delete \\"{{name}}\\"? This action cannot be undone.","confirm":"Delete"},"qrCode":{"title":"Scan QR Code","userName":"User","description":"Scan this QR code with the device you want to authorize","networkInterface":"Network Interface","warning":"This token will only be shown once. Save it if needed.","manualUrl":"Or visit this URL manually:","done":"Done"},"regenerate":{"title":"Regenerate Token","message":"This will invalidate the current token for \\"{{name}}\\". The user will need to be re-authenticated.","confirm":"Regenerate"}},"toast":{"created":"User created successfully","updated":"User updated successfully","deleted":"User deleted successfully","tokenRegenerated":"Token regenerated successfully","urlCopied":"URL copied to clipboard","error":"An error occurred"}},"categories":{"title":"Song Categories","description":"Manage song categories and their search priority. Higher position = higher priority in search results.","addCategory":"Add Category","noCategories":"No categories configured","noCategoriesDescription":"Add a category to organize your songs","categoryName":"Category Name","categoryNamePlaceholder":"e.g., Worship, Hymns, Christmas","priority":"Priority","value":"Value","actions":{"edit":"Edit","delete":"Delete"},"modals":{"create":{"title":"Add New Category","submit":"Create Category"},"edit":{"title":"Edit Category","submit":"Save Changes"},"delete":{"title":"Delete Category","message":"Are you sure you want to delete \\"{{name}}\\"? Songs in this category will become uncategorized.","confirm":"Delete"}},"toast":{"created":"Category created successfully","updated":"Category updated successfully","deleted":"Category deleted successfully","reordered":"Category order updated","error":"An error occurred"}},"synonyms":{"title":"Search Synonyms","description":"Define word synonyms to improve search results. When you search for one word, results with its synonyms will also appear.","addSynonym":"Add Synonym","noSynonyms":"No synonyms configured","noSynonymsDescription":"Add synonyms to find songs with alternative spellings","primaryTerm":"Primary Term","primaryTermPlaceholder":"e.g., cristos","synonymTerms":"Synonym Terms","synonymTermsPlaceholder":"e.g., hristos, christ","synonymTermsHint":"Separate multiple synonyms with commas","actions":{"edit":"Edit","delete":"Delete"},"modals":{"create":{"title":"Add New Synonym","submit":"Create Synonym"},"edit":{"title":"Edit Synonym","submit":"Save Changes"},"delete":{"title":"Delete Synonym","message":"Are you sure you want to delete the synonym group for \\"{{primary}}\\"?","confirm":"Delete"}},"toast":{"created":"Synonym created successfully","updated":"Synonym updated successfully","deleted":"Synonym deleted successfully","error":"An error occurred"}},"importExport":{"title":"Import & Export Songs","description":"Import songs from files or export your song library","import":{"title":"Import Songs","description":"Import songs from OpenSong XML, PPTX, or ZIP files","button":"Select Files","supportedFormats":"Supported: OpenSong XML, PPTX, PPT, ZIP","noSongsTitle":"No Songs Found","noSongsMessage":"No valid songs were found in the selected files."},"export":{"title":"Export Songs","description":"Export songs to OpenSong XML format in a ZIP archive","button":"Export Songs","allSongs":"All songs","byCategory":"By category","selectCategory":"Select a category","exporting":"Exporting...","fetching":"Exporting songs...","generating":"Generating XML files...","zipping":"Creating ZIP archive...","saving":"Saving file...","processingProgress":"Processing {{current}} of {{total}}"},"resurseCrestine":{"title":"Import from Resurse Crestine","description":"Download and import songs from Resurse Crestine website","button":"Import from Resurse Crestine","importing":"Importing...","note":"Songs will be imported to the 'Resurse Crestine' category with first verse as title"},"toast":{"importSuccess":"Successfully imported {{count}} songs","importFailed":"Import failed: {{error}}","exportSuccess":"Successfully exported {{count}} songs","exportFailed":"Export failed: {{error}}"}},"apiDocs":{"title":"API Documentation","description":"Access the REST API documentation for developers","link":"Open API Docs"},"systemToken":{"title":"System API Token","description":"Use this token to access the API with superuser privileges from external applications. This section is only visible on localhost.","token":"Token","showToken":"Show Token","loading":"Loading...","show":"Show token","hide":"Hide token","copy":"Copy to clipboard","regenerate":"Regenerate Token","regenerating":"Regenerating...","regenerateWarning":"Regenerating will invalidate the current token","createdAt":"Created","lastUsed":"Last used","never":"Never","toast":{"copied":"Token copied to clipboard","regenerated":"System token regenerated successfully","fetchError":"Failed to fetch system token","regenerateError":"Failed to regenerate system token"}},"sidebar":{"title":"Sidebar Configuration","description":"Customize sidebar menu items, their order, and add custom pages","builtIn":"Built-in","custom":"Custom Page","addCustomPage":"Add Custom Page","visible":"Visible","hidden":"Hidden","pageNotFound":"Page not found","openInNewTab":"Open in new tab","openInWindow":"Open in window","openInBrowser":"Open in browser","loadingPage":"Loading page...","loadError":"This page cannot be embedded","loadErrorDescription":"Some websites block embedding for security reasons. Open in a new tab instead.","nativeWindowTitle":"External page opened in native window","nativeWindowDescription":"This page has been opened in a separate window to ensure full functionality. Click the button above to reopen it if needed.","fields":{"title":"Title","titlePlaceholder":"e.g., Church Calendar","url":"URL","urlPlaceholder":"https://example.com/calendar","urlHint":"The URL will be embedded in an iframe","icon":"Icon","selectIcon":"Select an icon for the sidebar","useIframeEmbedding":"Use iframe embedding","useIframeEmbeddingHint":"Embed using an iframe instead of native webview. Recommended for sites like YouTube that support iframe embedding."},"validation":{"titleRequired":"Title is required","urlRequired":"URL is required","urlInvalid":"Please enter a valid URL"},"modals":{"create":{"title":"Add Custom Page","submit":"Add Page"},"edit":{"title":"Edit Custom Page","submit":"Save Changes"},"delete":{"title":"Delete Custom Page","message":"Are you sure you want to delete \\"{{name}}\\"?","confirm":"Delete"}},"toast":{"saved":"Sidebar configuration saved","customPageCreated":"Custom page added","customPageUpdated":"Custom page updated","customPageDeleted":"Custom page deleted","error":"An error occurred"}},"apiUrl":{"title":"Server Connection","label":"Server URL","hint":"Enter the auth URL from your Church Hub (e.g., http://192.168.1.100:3000/api/auth/user/usr_TOKEN)","settingsDescription":"Configure the server your mobile app connects to","testConnection":"Test Connection","testing":"Testing...","retry":"Retry","save":"Save & Continue","saved":"Server URL saved successfully","connectionSuccess":"Connection successful","authTokenDetected":"Authentication token detected","setup":{"title":"Connect to Server","description":"Scan the QR code or paste the authentication URL from your Church Hub"},"errors":{"emptyUrl":"Please enter a server URL","invalidUrl":"Please enter a valid URL (e.g., http://192.168.1.100:3000/api/auth/user/usr_TOKEN)","connectionFailed":"Could not connect to the server. Please check the URL and try again.","testFirst":"Please test the connection before saving"}},"database":{"title":"Database Management","description":"Manage your SQLite database backup and location","path":"Database Path","copyPath":"Copy path","openFolder":"Open in File Explorer","size":"Size","export":{"title":"Export Database","description":"Create a backup copy of your database","button":"Export Database","exporting":"Exporting..."},"import":{"title":"Import Database","description":"Restore from a backup file","button":"Import Database","importing":"Importing...","confirm":{"title":"Import Database","message":"This will replace your current database with the selected file. A backup of your current database will be created. The application will need to be restarted after import.","warning":"This action cannot be undone.","confirm":"Import","cancel":"Cancel"}},"toast":{"pathCopied":"Database path copied to clipboard","exportSuccess":"Database exported successfully to {{path}}","exportFailed":"Failed to export database: {{error}}","openFolderFailed":"Failed to open file explorer","importSuccess":"Database imported successfully. Please restart the application.","importFailed":"Failed to import database: {{error}}"}}}`),hG={title:dG,sections:fG},pG={home:"Home",dashboard:"Dashboard",schedules:"Schedules",songs:"Songs",bible:"Bible",present:"Control Room",livestream:"Live Stream",settings:"Settings"},gG={collapse:"Collapse",expand:"Expand sidebar",collapseSidebar:"Collapse sidebar",openMenu:"Open menu",closeMenu:"Close menu"},mG={navigation:pG,actions:gG},yG="Songs",xG={create:"New Song",save:"Save",delete:"Delete",back:"Back to Songs",import:"Import",importFromText:"Import from Text",addSlide:"Add Slide",cloneSlide:"Clone Slide",addToSchedule:"Add to Schedule"},bG={titlePlaceholder:"Enter song title...",categoryPlaceholder:"Select category...",slides:"Slides",slideNumber:"Slide {{number}}",emptySlide:"Empty slide - click to edit",noSlides:"No slides yet",saveFirst:"Save the song to add slides",undo:"Undo",redo:"Redo"},vG={placeholder:"Search songs...",noResults:'No songs found for "{{query}}"',resultsCount:"{{count}} songs found",showingCount:"Showing {{showing}} of {{total}} songs",moreResults:"{{count}} more songs not shown. Use search to find specific songs."},wG={none:"No Category",create:"Create",name:"Category"},SG={saving:"Saving song...",saved:"Song saved successfully",deleted:"Song deleted successfully",error:"An error occurred",slideSaved:"Slide saved",slideDeleted:"Slide deleted",slideCloned:"Slide cloned",reorderFailed:"Failed to reorder slides",categoryCreated:"Category created"},kG={deleteTitle:"Delete Song",deleteMessage:"Are you sure you want to delete this song? This action cannot be undone.",deleteSlideTitle:"Delete Slide",deleteSlideMessage:"Are you sure you want to delete this slide?",unsavedChangesTitle:"Unsaved Changes",unsavedChangesMessage:"You have unsaved changes. Are you sure you want to leave this page?",unsavedBeforeActionMessage:"You have unsaved changes. What would you like to do?",discardChanges:"Lose changes",saveAndContinue:"Save and continue",continueWithoutSaving:"Continue without saving",cancel:"Cancel"},CG="No songs yet",NG="Create your first song to get started",TG={title:"Import PowerPoint",description:"Found {{count}} slides. Import as a new song?",songTitle:"Song Title",createSong:"Create Song",dropHint:"Drop PPTX file to import as song",slideNumber:"Slide {{number}}"},jG={title:"Import Songs",description:"Ready to import {{count}} song(s)",categoryLabel:"Category (optional)",songsList:"Songs to import:",confirmButton:"Import {{count}} Song(s)",importing:"Importing...",noSongsFound:"No song files found",noSongsFoundDescription:"The selected files could not be parsed as songs. Please make sure you're importing valid song files (OpenSong XML or PowerPoint files).",successMessage:"Successfully imported {{count}} song(s)",processing:"Processing files...",processingProgress:"Processing: {{current}} of {{total}} files",downloading:"Downloading...",extracting:"Extracting archive...",converting:"Converting PPT files...",convertingProgress:"Converting: {{current}} of {{total}} PPT files",parsing:"Parsing songs...",saving:"Saving to database...",useFirstVerseAsTitle:"Use first verse as title",overwriteDuplicates:"Overwrite existing songs with same title",skipManuallyEdited:"Skip songs that were manually edited",libreOfficeNotInstalled:"LibreOffice is required to import .ppt files",libreOfficeNotInstalledDescription:"Please install LibreOffice from https://www.libreoffice.org to enable .ppt file import. Alternatively, convert your files to .pptx format first."},EG={title:"Songs Settings"},MG={backToSongs:"Back",edit:"Edit",slides:"Slides",noSlides:"No slides",slideNumber:"Slide {{number}}"},AG={detailsSection:"Details",author:"Author",copyright:"Copyright",ccli:"CCLI Number",hymnNumber:"Hymn Number",key:"Musical Key",keyPlaceholder:"C Major",tempo:"Tempo",timeSignature:"Time Signature",theme:"Theme",altTheme:"Alternative Theme",keyLine:"Key Line",keyLinePlaceholder:"Enter a memorable line from the song...",presentationOrder:"Presentation Order",sourceFilename:"Source File",presentationCount:"Times Presented",lastManualEdit:"Last Manual Edit",neverEdited:"Never edited"},RG={title:yG,actions:xG,editor:bG,search:vG,import:{title:"Import from Text",description:"Paste your song text below. Each paragraph will become a separate slide.",placeholder:"Paste song lyrics here...",preview:"Preview: {{count}} slides",confirm:"Import",cancel:"Cancel"},category:wG,messages:SG,modal:kG,noSongs:CG,noSongsDescription:NG,pptxImport:TG,batchImport:jG,settings:EG,preview:MG,metadata:AG},_G="Biblie",OG={placeholder:'Cauta versete (ex: "Gen 1:1" sau "La inceput")',hint:'Scrie o referinta precum "Gen 1:1" sau cauta un text',noResults:"Niciun rezultat gasit",searching:"Se cauta...",directReference:"Referinta directa",resultsCount:"{{count}} verset gasit",resultsCount_other:"{{count}} versete gasite"},DG={back:"Inapoi",oldTestament:"Vechiul Testament",newTestament:"Noul Testament",noBooks:"Nicio carte disponibila"},IG={title:"Lista versete",empty:"Niciun verset in lista",removed:"Versetul a fost eliminat din lista",remove:"Elimina"},LG={title:"Previzualizare",prev:"Ant.",next:"Urm.",prevVerse:"Versetul anterior",nextVerse:"Versetul urmator",show:"Afiseaza",hide:"Ascunde"},zG={title:"Scurtaturi tastatura",navigate:"Navigheaza versete",back:"Inapoi",hide:"Ascunde afisajul",present:"Prezinta versetul"},PG={presentNow:"Prezinta acum",addToQueue:"Adauga in lista",import:"Importa",importFirst:"Importa traducere Biblie",settings:"Setari",openSettings:"Deschide Setari"},BG={title:"Nicio traducere disponibila",description:"Importa o traducere a Bibliei in format USFX XML pentru a incepe.",noTranslationsSelected:"Nicio traducere selectata",noTranslationsSelectedDescription:"Mergi la Setari > Traduceri Biblice pentru a selecta traducerile dorite."},FG={title:"Setari Biblie",import:{title:"Importa Traducere",description:"Importa o traducere a Bibliei dintr-un fisier USFX XML.",button:"Selecteaza Fisier",formatTitle:"Format Necesar: USFX XML",formatDescription:"Traducerea Bibliei trebuie sa fie in format USFX (Unified Standard Format XML). Acesta este un format standardizat folosit pentru codificarea Scripturii.",structureTitle:"Exemplu Structura Fisier:",hints:{rootElement:"Elementul radacina trebuie sa fie <usfx>",bookElement:'Fiecare carte foloseste <book id="XXX"> cu abrevieri standard (GEN, EXO, etc.)',chapterElement:'Capitolele folosesc <c id="N"> unde N este numarul capitolului',verseElement:'Versetele folosesc <v id="N">text</v> unde N este numarul versetului'}}},UG={select:"Selecteaza traducerea",loading:"Se incarca traducerile..."},$G={title:_G,search:OG,navigation:DG,queue:IG,controls:LG,shortcuts:zG,actions:PG,empty:BG,import:{title:"Importa traducere Biblie",error:"Importul traducerii a esuat",errorTitle:"Eroare la import",success:"Traducerea a fost importata cu succes"},settings:FG,translation:UG},qG={goBack:"napoi",startOver:"ncepe din nou",cancel:"Anuleaz",confirm:"Confirm",delete:"terge",save:"Salveaz",ok:"OK"},HG={pageNotFound:"Pagina pe care o cutai nu exist.",noPermission:"Nu avei permisiunea de a accesa aceast pagin.",noPermissionTitle:"Acces interzis",contactAdmin:"V rugm s contactai administratorul dac credei c aceasta este o eroare."},VG={system:"Sistem",lightMode:"Mod luminos",darkMode:"Mod ntunecat",toggleTheme:"Schimb tema"},KG={buttons:qG,errors:HG,theme:VG},QG="Live Stream",WG={notConnected:"YouTube neconectat",connected:"Conectat ca {{channelName}}",login:"Conecteaza-te cu YouTube",logout:"Deconecteaza YouTube",authenticating:"Se autentifica...",loggingOut:"Se deconecteaza...",clickToConnect:"Click pentru a te conecta la YouTube",clickToDisconnect:"Click pentru a te deconecta de la YouTube",openGuide:"Ghid de configurare",settings:"Setari YouTube",titleTemplate:"Sablon titlu",description:"Descriere",privacyStatus:"Confidentialitate",privacyPublic:"Public",privacyUnlisted:"Nelistat",privacyPrivate:"Privat",streamKey:"Cheie Stream",selectStreamKey:"Selecteaza cheia stream",playlist:"ID Playlist",startScene:"Scena de start",setup:{title:"Configurare YouTube Live",templateTitle:"Foloseste setari din transmisii anterioare",templateDescription:"Selecteaza setari dintr-o transmisie anterioara:",noTemplates:"Nicio transmisie anterioara gasita",noTemplatesHint:"Creeaza o transmisie live in YouTube Studio. Dupa ce transmisia se incheie, va aparea aici.",completedAt:"Finalizat",usingTemplate:"Foloseste setarile transmisiei",usingTemplateHint:"Aceste setari vor fi aplicate urmatoarei tale transmisii.",firstTimeTitle:"Prima transmisie?",firstTimeDescription:"Creeaza o transmisie live direct in YouTube Studio. Configureaza setarile, porneste live-ul din OBS, iar transmisia va fi salvata aici pentru utilizare viitoare.",openYouTubeStudio:"Deschide YouTube Studio",close:"Inchide"}},YG={connected:"OBS Conectat",disconnected:"OBS Deconectat",connecting:"Se conecteaza...",connect:"Conecteaza la OBS",disconnect:"Deconecteaza",disconnecting:"Se deconecteaza...",clickToConnect:"Click pentru a te conecta la OBS",clickToDisconnect:"Click pentru a te deconecta de la OBS",openGuide:"Ghid de configurare",settings:"Setari OBS",host:"Host",port:"Port",password:"Parola",autoConnect:"Auto-conectare la pornire",setup:{title:"Configurare OBS WebSocket",helpLink:"Ai nevoie de ajutor pentru conectare?",step1Title:"Pasul 1: Instaleaza OBS WebSocket",step1Description:"OBS WebSocket este necesar pentru ca Church Hub sa controleze OBS Studio. Pentru OBS 28+, este inclus. Pentru versiuni mai vechi, descarca si instaleaza:",downloadLink:"Descarca OBS WebSocket de pe GitHub",step2Title:"Pasul 2: Activeaza Serverul WebSocket",step2Instruction1:"Deschide OBS Studio",step2Instruction2:"Mergi la Tools  WebSocket Server Settings",step2Instruction3:'Bifeaza "Enable WebSocket server" si seteaza parola de mai jos',step3Title:"Pasul 3: Configureaza Parola",step3Description:"Copiaza aceasta parola si paste-o in OBS WebSocket Server Settings:",copy:"Copiaza",copied:"Copiat!",noteTitle:"Nota:",noteDescription:"Asigura-te ca folosesti aceeasi parola in OBS. Church Hub va folosi automat aceasta parola la conectare.",saveAndClose:"Salveaza si Inchide"}},GG={startStream:"Porneste live-ul",stopStream:"Opreste Stream",isLive:"LIVE",notStreaming:"Nu transmite",starting:"Se porneste...",stopping:"Se opreste...",progress:{creating_broadcast:"Se creeaza transmisia",waiting_for_ready:"Se asteapta YouTube",delay_before_stream:"Se pregateste stream-ul",starting_obs:"Se porneste OBS",completed:"Stream pornit",error:"Eroare la pornirea stream-ului"}},XG={currentBroadcast:"Transmisie curenta",noBroadcast:"Nicio transmisie activa",loading:"Se incarca informatiile transmisiei...",copyMessage:"Copiaza mesaj",messageCopied:"Mesaj copiat",copyToClipboard:"Copiaza in clipboard",copied:"Copiat!",openInYouTube:"Deschide in YouTube",watchLive:"Vizualizare Live",openStudio:"YouTube Studio"},JG={title:"Scene",settings:"Setari scene",sceneSettings:"Setari scena",displayName:"Nume afisat",visible:"Vizibila",hidden:"Ascunsa",current:"Curenta",shortcuts:"Scurtaturi de tastatura",addShortcut:"Adauga scurtatura",removeShortcut:"Sterge",recordShortcut:"Apasa taste...",clickToRecord:"Click pentru a inregistra",recording:"Se inregistreaza...",noShortcuts:"Nicio scurtatura atribuita",shortcutConflict:'Deja folosita de "{{scene}}"',streamSceneSettings:"Setari scena stream",useAsStartScene:"Foloseste ca scena de start",useAsStartSceneDescription:"Aceasta scena va fi activata inainte de inceperea stream-ului",useAsStopScene:"Foloseste ca scena de stop",useAsStopSceneDescription:"Aceasta scena va fi activata dupa oprirea stream-ului",autoSceneSettings:"Setari auto-switch",autoSceneDescription:"Schimba la aceasta scena cand afisezi:",contentTypes:{song:"Cantari",bible:"Verset biblic",biblePassage:"Pasaj biblic",announcement:"Anunturi",verseteTineri:"Versete Tineri",empty:"Gol / Ceas"},mixerActions:"Actiuni Mixer",mixerActionsDescription:"Configureaza canalele mixerului cand aceasta scena se activeaza:",unmute:"Porneste",mute:"Opreste",selectChannels:"Selecteaza canale...",selectContentTypes:"Selecteaza tipuri de continut...",addMore:"Adauga..."},ZG={title:"Mixer",connected:"Mixer Conectat",disconnected:"Mixer Deconectat",reconnecting:"Se reconecteaza...",testing:"Se testeaza...",enable:"Activeaza Mixer",disable:"Dezactiveaza Mixer",settings:"Setari Mixer",setup:{title:"Configurare Mixer",connectionSettings:"Setari Conexiune",host:"Adresa IP",port:"Port",enableControl:"Activeaza controlul mixerului",channelConfiguration:"Configurare Canale",channelCount:"Numar de canale",channelPlaceholder:"Eticheta canal",testConnection:"Testeaza conexiunea",testing:"Se testeaza...",testSuccess:"Conexiune reusita!",testFailed:"Conexiune esuata",save:"Salveaza"}},eX={obsConnectionFailed:"Conectarea la OBS a esuat",obsNotRunning:"Nu se poate conecta la OBS. Asigura-te ca OBS ruleaza si serverul WebSocket este activat (Tools  WebSocket Server Settings).",obsAuthFailed:"Autentificarea OBS a esuat. Verifica parola WebSocket din setarile OBS.",obsTimeout:"Conexiunea la OBS a expirat. Verifica daca host-ul si portul sunt corecte.",youtubeAuthFailed:"Autentificarea YouTube a esuat",youtubeSessionExpired:"Sesiunea YouTube a expirat. Te rugam sa te reconectezi.",youtubeReauthRequired:"YouTube necesita autentificare din nou",broadcastFailed:"Crearea transmisiei a esuat",sceneSwitchFailed:"Schimbarea scenei a esuat",startStreamFailed:"Pornirea stream-ului a esuat",stopStreamFailed:"Oprirea stream-ului a esuat"},tX={title:QG,youtube:WG,obs:YG,stream:GG,broadcast:XG,scenes:JG,mixer:ZG,errors:eX},nX={title:"Ecrane",description:"Configurai ecrane pentru diferite scopuri de afiare. Fiecare tip de ecran are propriile opiuni de configurare.",addScreen:"Adaug Ecran",addFirstScreen:"Adaug Primul Ecran",noScreens:"Niciun ecran configurat",noScreensDescription:"Adaug primul tu ecran pentru a configura cum este afiat coninutul.",screenName:"Nume Ecran",screenNamePlaceholder:"ex: Proiector Principal",screenType:"Tip Ecran",screenTypes:{primary:"Principal / Audien",stage:"Monitor Scen",livestream:"Transmisie Live"},createAndConfigure:"Creeaz i Configureaz",deleteConfirmTitle:"terge Ecranul?",deleteConfirmMessage:'Eti sigur c vrei s tergi "{{name}}"? Aceast aciune nu poate fi anulat.',editor:{preview:"Previzualizare",zoom:"Zoom",resetZoom:"Reseteaz Zoom",save:"Salveaz",unsavedChanges:"Modificri nesalvate",previewText:"Text Previzualizare",previewTextDescription:"Personalizai textul de previzualizare pentru a testa cum arat stilul cu coninut diferit.",customPreviewText:"Text Personalizat",previewTextPlaceholder:"Introducei text personalizat (multiline suportat)...",resetPreviewText:"Reseteaz la Implicit"},contentTypes:{song:"Cntec",bible:"Verset Biblic",bible_passage:"Pasaj Biblic",announcement:"Anun",versete_tineri:"Versete Tineri",empty:"Gol / Ceas"},panels:{position:"Poziie i Dimensiune",textStyle:"Stil Text",animation:"Animaie",background:"Fundal",general:"Setri Generale",nextSlide:"Seciune Slide Urmtor",visibility:"Vizibilitate"},visibility:{hideElement:"Ascunde elementul"},position:{x:"Poziie X",y:"Poziie Y",width:"Lime",height:"nlime",unit:"Unitate",pixels:"Pixeli",percent:"Procent",constraints:"Constrngeri",element:"Element",top:"Sus",bottom:"Jos",left:"Stnga",right:"Dreapta",stretchHorizontal:"Limea se ntinde ntre constrngerile stnga i dreapta",stretchVertical:"nlimea se ntinde ntre constrngerile sus i jos"},textStyle:{fontFamily:"Familie Font",maxFontSize:"Dimensiune Max Font",autoScale:"Scalare Automat",autoScaleDescription:"Scaleaz automat textul pentru a ncpea n container. Cnd este dezactivat, folosete o dimensiune fix.",fontSize:"Dimensiune Font",color:"Culoare",bold:"Bold",italic:"Italic",underline:"Subliniat",horizontalAlignment:"Aliniere Orizontal",verticalAlignment:"Aliniere Vertical",left:"Stnga",center:"Centru",right:"Dreapta",top:"Sus",middle:"Mijloc",bottom:"Jos",lineHeight:"nlime Linie",shadow:"Umbr Text",compressLines:"Comprim Liniile",lineSeparator:"Separator Linii",separators:{space:"Spaiu Dublu",dash:"Liniu Em ()",pipe:"Bar Vertical (|)"},fitLineToWidth:"Potrivete Fiecare Linie la Lime",fitLineToWidthDescription:"Previne ntreruperea liniilor - fiecare linie se scaleaz pentru a ncpea"},animation:{animationIn:"Animaie Intrare",animationOut:"Animaie Ieire",type:"Tip",duration:"Durat",delay:"ntrziere",easing:"Easing",types:{none:"Niciunul",fade:"Fade",slideUp:"Alunecare Sus",slideDown:"Alunecare Jos",slideLeft:"Alunecare Stnga",slideRight:"Alunecare Dreapta",scale:"Scalare",blur:"Blur"},easings:{linear:"Liniar",easeIn:"Ease In",easeOut:"Ease Out",easeInOut:"Ease In Out",bounce:"Bounce"}},background:{type:"Tip",types:{transparent:"Transparent",color:"Culoare Solid",image:"Imagine",video:"Video"},color:"Culoare",imageUrl:"URL Imagine",videoUrl:"URL Video",opacity:"Opacitate"},general:{screenSize:"Dimensiune Ecran",width:"Lime",height:"nlime",clockEnabled:"Afieaz Ceas",defaultBackground:"Fundal Implicit"},nextSlide:{enabled:"Afieaz Seciunea Slide Urmtor",labelText:"Text Etichet",labelStyle:"Stil Etichet",contentStyle:"Stil Coninut"},bibleOptions:{title:"Opiuni Biblie",includeReferenceInContent:"Include referina n coninut",includeReferenceInContentDescription:"Adaug referina biblic la nceputul versetului i ascunde elementul separat de referin"},nativeWindow:"Fereastr nativ",messages:{screenCreated:"Ecran creat cu succes",screenCreateFailed:"Eroare la crearea ecranului",screenSaved:"Ecran salvat cu succes",screenSaveFailed:"Eroare la salvarea ecranului",screenDeleted:"Ecran ters cu succes",screenDeleteFailed:"Eroare la tergerea ecranului"},renderer:{loading:"Se ncarc configuraia ecranului...",error:"Eroare la ncrcarea ecranului",notFound:"Ecranul nu a fost gsit"}},rX={title:"Ecrane",description:"Configurai ecranele de ieire pentru prezentrile dumneavoastr. Fiecare ecran poate avea propria tem i setri.",add:"Adaug Ecran",addFirst:"Adaug Primul Ecran",edit:"Editeaz Ecran",empty:"Niciun Ecran",emptyDescription:"Creai ecrane pentru a proiecta prezentrile pe diferite monitoare sau ferestre.",name:"Nume Ecran",namePlaceholder:"ex: Ecran Principal, Monitor Scen",activeLabel:"Ecranul este activ",active:"Activ",inactive:"Inactiv",activate:"Activeaz",deactivate:"Dezactiveaz",editTheme:"Editeaz Tema",openWindow:"Deschide Fereastra Ecran",deleteConfirmTitle:"tergei Ecranul?",deleteConfirmMessage:'Suntei sigur c dorii s tergei "{{name}}"? Aceast aciune nu poate fi anulat.',openMode:"Mod Deschidere",openModes:{browser:"Browser",native:"Fereastr Nativ"},fullscreenLabel:"Deschide n ecran complet implicit"},sX={title:"Tema Ecranului",backgroundType:"Tip Fundal",backgrounds:{transparent:"Transparent",color:"Culoare Solid",image:"Imagine"},backgroundColor:"Culoare Fundal",backgroundImage:"URL Imagine",textColor:"Culoare Text",fontFamily:"Familie Font",padding:"Spaiere",preview:"Previzualizare",sampleText:"Text Exemplu"},iX={save:"Salveaz",cancel:"Anuleaz",delete:"terge",close:"nchide"},aX={displaySaved:"Ecran salvat cu succes",displaySaveFailed:"Eroare la salvarea ecranului",displayDeleted:"Ecran ters",displayDeleteFailed:"Eroare la tergerea ecranului",displayActivated:"Ecran activat",displayDeactivated:"Ecran dezactivat",displayToggleFailed:"Eroare la schimbarea strii ecranului",themeSaved:"Tema salvat cu succes",themeSaveFailed:"Eroare la salvarea temei"},oX={start:"Pornete",stop:"Oprete",prev:"Anterior",next:"Urmtor",clear:"Golete Slide",show:"Afieaz",hide:"Ascunde",screenHidden:"Ecranul este ascuns",screenDisplayed:"Ecranul este afiat"},lX={title:"Camer de Control",selectProgram:"Selecteaz un program",presenting:"n prezentare",notPresenting:"Nu prezint",connected:"Conectat",connecting:"Se conecteaz...",disconnected:"Deconectat",openDisplay:"Deschide Ecran",slides:"Slide-uri",noSlides:"Niciun slide n acest program",preview:"Previzualizare"},cX={screens:nX,displays:rX,theme:sX,actions:iX,messages:aX,controls:oX,controlRoom:lX},uX="Coad",dX="Coada este goal",fX="Adaug cntri pentru a ncepe prezentarea",hX="{{count}} cntare",pX="{{count}} cntri",gX="{{count}} cntri",mX="{{count}} element",yX="{{count}} elemente",xX="{{count}} elemente",bX={addToQueue:"Adaug n coad",presentNow:"Prezint acum",remove:"terge",clear:"Golete coada",expand:"Extinde",collapse:"Restrnge",editSong:"Editeaz",editSlide:"Editeaz slide-ul",insertSlide:"Insereaz slide dup",insertAfter:"Insereaz dup",moreOptions:"Mai multe opiuni",cancel:"Anuleaz",addToSchedule:"Adaug n program",saveAsProgram:"Salveaz ca program"},vX={button:"Adaug",title:"Adaug n coad",searchSong:"Caut cntare",searchSongDescription:"Gsete i adaug o cntare existent",bibleVerse:"Verset Biblic",bibleVerseDescription:"Caut i adaug un verset din Biblie",biblePassage:"Pasaj Biblic",biblePassageDescription:"Adaug un interval de versete",announcement:"Anun",announcementDescription:"Creeaz un slide de anun personalizat",verseteTineri:"Versete Tineri",verseteTineriDescription:"Adaug un slide cu versete pentru tineri",importSchedule:"Import Program",importScheduleDescription:"Adaug toate elementele dintr-un program salvat"},wX={added:"Adugat n coad",removed:"ters din coad",cleared:"Coada a fost golit",presenting:"Se prezint acum",error:"A aprut o eroare",slideInserted:"Slide-ul a fost inserat",slideUpdated:"Slide-ul a fost actualizat",savedAsProgram:"Coada a fost salvat ca program",biblePassageInserted:"Pasajul biblic a fost adugat n coad",verseteTineriInserted:"Versetele tineri au fost adugate n coad"},SX={title:"Salveaz coada ca program",nameLabel:"Nume program",namePlaceholder:"Introdu numele programului",save:"Salveaz",cancel:"Anuleaz"},kX={title:"Goleti coada?",message:"Aceasta va terge toate elementele din coad."},CX={announcement:"Anun",versete_tineri:"Versete tineri"},NX={title:"Insereaz slide",editTitle:"Editeaz slide-ul",selectTemplate:"Selecteaz ablonul",content:"Coninut",insert:"Insereaz",save:"Salveaz",errorEmpty:"Te rugm s adaugi coninut slide-ului"},TX={title:"Import Program",description:"Adaug toate elementele dintr-un program salvat n coad"},jX={title:"Adaug Pasaj Biblic",translation:"Traducere",reference:"Referin",referencePlaceholder:"ex: Gen 1:1-5 sau Ioan 3:16",referenceHint:"Introdu cartea, capitolul i intervalul de versete",valid:"Valid",add:"Adaug n coad",passage:"Pasaj Biblic",errors:{empty:"Te rugm s introduci o referin",invalid_format:"Format invalid. ncearc: Gen 1:1 sau Gen 1:1-5",book_not_found:"Cartea nu a fost gsit",invalid_chapter:"Numr de capitol invalid",end_before_start:"Sfritul trebuie s fie dup nceput"}},EX={title:"Versete Tineri",addEntry:"Adaug intrare",personName:"Nume persoan",personNamePlaceholder:"Introdu numele...",bibleReference:"Referin biblic",bibleReferencePlaceholder:"ex: Ioan 3:16",entriesCount_one:"{{count}} intrare",entriesCount_few:"{{count}} intrri",entriesCount_other:"{{count}} intrri",removeEntry:"terge intrare",noEntries:"Nu exist intrri",addFirstEntry:"Adaug o intrare pentru a ncepe"},MX={title:uX,empty:dX,emptyDescription:fX,songCount_one:hX,songCount_few:pX,songCount_other:gX,itemCount_one:mX,itemCount_few:yX,itemCount_other:xX,actions:bX,addToQueue:vX,messages:wX,saveAsProgram:SX,confirmClear:kX,slideTemplates:CX,insertSlide:NX,importSchedule:TX,biblePassage:jX,verseteTineri:EX},AX="Programe",RX={create:"Program Nou",save:"Salveaza",delete:"Sterge",back:"Inapoi la Programe",addItem:"Adauga",importToQueue:"Adauga in Coada"},_X={titlePlaceholder:"Introdu titlul programului...",descriptionPlaceholder:"Adauga o descriere (optional)...",items:"Elemente",noItems:"Niciun element inca",addFirstItem:"Adauga cantari sau slide-uri pentru a construi programul"},OX={placeholder:"Cauta programe...",noResults:'Nu s-au gasit programe pentru "{{query}}"',resultsCount:"{{count}} programe gasite"},DX={saved:"Programul a fost salvat cu succes",deleted:"Programul a fost sters cu succes",itemAdded:"Element adaugat la program",itemRemoved:"Element eliminat din program",importedToQueue:"Programul a fost importat in coada",error:"A aparut o eroare"},IX={deleteTitle:"Sterge Programul",deleteMessage:"Esti sigur ca vrei sa stergi acest program? Aceasta actiune nu poate fi anulata.",importTitle:"Importa Program",unsavedChangesTitle:"Modificari Nesalvate",unsavedChangesMessage:"Ai modificari nesalvate. Esti sigur ca vrei sa parasesti aceasta pagina?",discardChanges:"Pierde modificarile",addSongTitle:"Adauga in Program",addSongDescription:"Selecteaza un program pentru a adauga aceasta cantare",adding:"Se adauga...",createTitle:"Program Nou",scheduleName:"Numele programului",create:"Creeaza",cancel:"Anuleaza",createNew:"Creeaza program nou"},LX="Niciun program inca",zX="Creeaza primul tau program pentru a planifica prezentarile",PX="{{count}} element",BX="{{count}} elemente",FX="Creat pe {{date}}",UX={title:AX,actions:RX,editor:_X,search:OX,messages:DX,modal:IX,noSchedules:LX,noSchedulesDescription:zX,itemCount_one:PX,itemCount_other:BX,createdAt:FX},$X="Setri",qX=JSON.parse(`{"appearance":{"title":"Aspect"},"bible":{"title":"Traduceri Biblice","description":"Selecteaz pn la 3 traduceri pentru afiare. Trage pentru a reordona.","addTranslation":"Adaug Traducere","primary":"Principal","secondary":"Secundar","tertiary":"Teriar","noTranslations":"Nicio traducere selectat","noTranslationsDescription":"Adaug o traducere biblic pentru a ncepe","maxReached":"Maximum 3 traduceri","translationsSelected":"traduceri selectate","modals":{"add":{"title":"Adaug Traducere","selectLabel":"Selecteaz o traducere","submit":"Adaug"}},"toast":{"saved":"Traduceri salvate","removed":"Traducere eliminat","added":"Traducere adugat","error":"A aprut o eroare"}},"application":{"title":"Setri aplicaie","description":"Configureaz preferinele tale pentru Church Hub"},"language":{"title":"Limb","description":"Selecteaz limba preferat","options":{"system":"Implicit din sistem","english":"Englez","romanian":"Romn"}},"theme":{"title":"Tem","description":"Alege tema de culoare preferat","options":{"system":"Implicit din sistem","light":"Luminos","dark":"ntunecat"}},"shortcuts":{"title":"Scurtturi de Tastatur","description":"Configureaz scurtturi globale de tastatur pentru aciuni rapide. Aceste scurtturi funcioneaz de oriunde n aplicaie.","actions":{"startLive":{"label":"Pornete Transmisiunea","description":"Pornete transmisiunea YouTube (doar cnd este pregtit)"},"stopLive":{"label":"Oprete Transmisiunea","description":"Oprete transmisiunea YouTube curent"},"searchSong":{"label":"Caut Cntri","description":"Navigheaz la cntri i focuseaz cmpul de cutare"},"searchBible":{"label":"Caut n Biblie","description":"Navigheaz la Biblie i focuseaz cmpul de cutare"}},"addShortcut":"Adaug Scurttur","noShortcuts":"Nicio scurttur configurat","enabled":"Activat","disabled":"Dezactivat","clickToRecord":"Click pentru nregistrare","recording":"nregistrare...","recordShortcut":"Apas tastele...","recordShortcutOrMidi":"Apas tast sau buton MIDI...","removeShortcut":"terge","conflicts":{"global":"Folosit deja de \\"{{action}}\\"","scene":"Folosit deja de scena \\"{{scene}}\\""},"midi":{"title":"Controller MIDI","description":"Folosete controllere MIDI hardware pentru scurtturi cu feedback LED","notSupported":"API-ul Web MIDI nu este suportat n acest browser. Funciile controller MIDI nu sunt disponibile.","inputDevice":"Dispozitiv Intrare","outputDevice":"Dispozitiv Ieire (LED-uri)","selectDevice":"Selecteaz dispozitiv...","noInputDevices":"Niciun dispozitiv MIDI de intrare detectat","noOutputDevices":"Niciun dispozitiv MIDI de ieire detectat","refresh":"Remprospteaz dispozitive","requestPermission":"Acord Acces MIDI","permissionError":"Acces MIDI refuzat: {{error}}","fullyConnected":"Intrare i ieire conectate","inputOnly":"Intrare conectat (fr feedback LED)","outputOnly":"Ieire conectat (fr declanatoare)"}},"users":{"title":"Utilizatori autorizai","description":"Administreaz utilizatorii care pot accesa Church Hub","addUser":"Adaug utilizator","noUsers":"Niciun utilizator configurat","noUsersDescription":"Adaug un utilizator pentru a permite acces extern la Church Hub","userName":"Nume utilizator","userNamePlaceholder":"ex., Tableta lui Ion","permissions":"permisiuni","permissionsSelected":"permisiuni selectate","status":"Stare","active":"Activ","inactive":"Inactiv","lastUsed":"Ultima utilizare","never":"Niciodat","createdAt":"Creat la","roleTemplate":"ablon rol","roles":{"admin":"Administrator","presenter":"Prezentator","viewer":"Vizualizator","queue_manager":"Manager coad"},"groups":{"songs":"Cntri","control_room":"Camer de control","programs":"Programe","queue":"Coad","settings":"Setri","displays":"Afiaje","users":"Administrare utilizatori"},"permissionLabels":{"songs.view":"Vizualizare cntri","songs.create":"Creare cntri","songs.edit":"Editare cntri","songs.delete":"tergere cntri","songs.add_to_queue":"Adugare cntri n coad","songs.present_now":"Prezentare cntri imediat","control_room.view":"Vizualizare camer de control","control_room.control":"Control prezentare","programs.view":"Vizualizare programe","programs.create":"Creare programe","programs.edit":"Editare programe","programs.delete":"tergere programe","programs.import_to_queue":"Import programe n coad","queue.view":"Vizualizare coad","queue.add":"Adugare n coad","queue.remove":"Eliminare din coad","queue.reorder":"Reordonare coad","queue.clear":"Golire coad","settings.view":"Vizualizare setri","settings.edit":"Editare setri","displays.view":"Vizualizare afiaje","displays.create":"Creare afiaje","displays.edit":"Editare afiaje","displays.delete":"tergere afiaje","users.view":"Vizualizare utilizatori","users.create":"Creare utilizatori","users.edit":"Editare utilizatori","users.delete":"tergere utilizatori"},"actions":{"edit":"Editeaz","delete":"terge","regenerateToken":"Regenereaz token","showQRCode":"Afieaz cod QR","deactivate":"Dezactiveaz","activate":"Activeaz","copyUrl":"Copiaz URL"},"modals":{"cancel":"Anuleaz","create":{"title":"Adaug utilizator nou","submit":"Creeaz utilizator"},"edit":{"title":"Editeaz utilizator","submit":"Salveaz modificrile"},"delete":{"title":"terge utilizator","message":"Eti sigur c vrei s tergi \\"{{name}}\\"? Aceast aciune nu poate fi anulat.","confirm":"terge"},"qrCode":{"title":"Scaneaz codul QR","userName":"Utilizator","description":"Scaneaz acest cod QR cu dispozitivul pe care vrei s l autorizezi","networkInterface":"Interfa de reea","warning":"Acest token va fi afiat o singur dat. Salveaz-l dac este necesar.","manualUrl":"Sau viziteaz manual acest URL:","done":"Gata"},"regenerate":{"title":"Regenereaz token","message":"Aceasta va invalida tokenul curent pentru \\"{{name}}\\". Utilizatorul va trebui re-autentificat.","confirm":"Regenereaz"}},"toast":{"created":"Utilizator creat cu succes","updated":"Utilizator actualizat cu succes","deleted":"Utilizator ters cu succes","tokenRegenerated":"Token regenerat cu succes","urlCopied":"URL copiat n clipboard","error":"A aprut o eroare"}},"categories":{"title":"Categorii Cntri","description":"Administreaz categoriile de cntri i prioritatea lor n cutare. Poziie mai sus = prioritate mai mare n rezultatele cutrii.","addCategory":"Adaug Categorie","noCategories":"Nicio categorie configurat","noCategoriesDescription":"Adaug o categorie pentru a organiza cntrile tale","categoryName":"Nume Categorie","categoryNamePlaceholder":"ex., nchinare, Imnuri, Crciun","priority":"Prioritate","value":"Prioritate","actions":{"edit":"Editeaz","delete":"terge"},"modals":{"create":{"title":"Adaug Categorie Nou","submit":"Creeaz Categorie"},"edit":{"title":"Editeaz Categorie","submit":"Salveaz Modificrile"},"delete":{"title":"terge Categorie","message":"Eti sigur c vrei s tergi \\"{{name}}\\"? Cntrile din aceast categorie vor deveni necategorizate.","confirm":"terge"}},"toast":{"created":"Categorie creat cu succes","updated":"Categorie actualizat cu succes","deleted":"Categorie tears cu succes","reordered":"Ordinea categoriilor actualizat","error":"A aprut o eroare"}},"synonyms":{"title":"Sinonime Cutare","description":"Definete sinonime pentru cuvinte pentru a mbunti rezultatele cutrii. Cnd caui un cuvnt, vor aprea i rezultatele cu sinonimele acestuia.","addSynonym":"Adaug Sinonim","noSynonyms":"Niciun sinonim configurat","noSynonymsDescription":"Adaug sinonime pentru a gsi cntri cu ortografii alternative","primaryTerm":"Termen Principal","primaryTermPlaceholder":"ex., cristos","synonymTerms":"Termeni Sinonimi","synonymTermsPlaceholder":"ex., hristos, christ","synonymTermsHint":"Separ sinonimele multiple cu virgul","actions":{"edit":"Editeaz","delete":"terge"},"modals":{"create":{"title":"Adaug Sinonim Nou","submit":"Creeaz Sinonim"},"edit":{"title":"Editeaz Sinonim","submit":"Salveaz Modificrile"},"delete":{"title":"terge Sinonim","message":"Eti sigur c vrei s tergi grupul de sinonime pentru \\"{{primary}}\\"?","confirm":"terge"}},"toast":{"created":"Sinonim creat cu succes","updated":"Sinonim actualizat cu succes","deleted":"Sinonim ters cu succes","error":"A aprut o eroare"}},"importExport":{"title":"Import & Export Cntri","description":"Import cntri din fiiere sau export biblioteca de cntri","import":{"title":"Import Cntri","description":"Import cntri din fiiere OpenSong XML, PPTX sau ZIP","button":"Selecteaz Fiiere","supportedFormats":"Formate acceptate: OpenSong XML, PPTX, PPT, ZIP","noSongsTitle":"Nicio Cntare Gsit","noSongsMessage":"Nu s-au gsit cntri valide n fiierele selectate."},"export":{"title":"Export Cntri","description":"Export cntrile n format OpenSong XML ntr-o arhiv ZIP","button":"Export Cntri","allSongs":"Toate cntrile","byCategory":"Dup categorie","selectCategory":"Selecteaz o categorie","exporting":"Se export...","fetching":"Se export cntrile...","generating":"Se genereaz fiierele XML...","zipping":"Se creeaz arhiva ZIP...","saving":"Se salveaz fiierul...","processingProgress":"Se proceseaz {{current}} din {{total}}"},"resurseCrestine":{"title":"Import din Resurse Crestine","description":"Descarc i import cntri de pe site-ul Resurse Crestine","button":"Import din Resurse Crestine","importing":"Se import...","note":"Cntrile vor fi importate n categoria 'Resurse Crestine' cu primul vers ca titlu"},"toast":{"importSuccess":"S-au importat cu succes {{count}} cntri","importFailed":"Importul a euat: {{error}}","exportSuccess":"S-au exportat cu succes {{count}} cntri","exportFailed":"Exportul a euat: {{error}}"}},"apiDocs":{"title":"Documentatie API","description":"Acceseaza documentatia API REST pentru dezvoltatori","link":"Deschide Documentatia API"},"systemToken":{"title":"Token API de Sistem","description":"Foloseste acest token pentru a accesa API-ul cu privilegii de superutilizator din aplicatii externe. Aceasta sectiune este vizibila doar pe localhost.","token":"Token","showToken":"Afiseaza Token","loading":"Se incarca...","show":"Afiseaza token","hide":"Ascunde token","copy":"Copiaza in clipboard","regenerate":"Regenereaza Token","regenerating":"Se regenereaza...","regenerateWarning":"Regenerarea va invalida tokenul curent","createdAt":"Creat","lastUsed":"Ultima utilizare","never":"Niciodata","toast":{"copied":"Token copiat in clipboard","regenerated":"Token de sistem regenerat cu succes","fetchError":"Nu s-a putut obtine tokenul de sistem","regenerateError":"Nu s-a putut regenera tokenul de sistem"}},"sidebar":{"title":"Configurare Bar Lateral","description":"Personalizeaz elementele meniului din bara lateral, ordinea lor i adaug pagini personalizate","builtIn":"Predefinit","custom":"Pagin Personalizat","addCustomPage":"Adaug Pagin Personalizat","visible":"Vizibil","hidden":"Ascuns","pageNotFound":"Pagina nu a fost gsit","openInNewTab":"Deschide n tab nou","openInWindow":"Deschide n fereastr","openInBrowser":"Deschide n browser","loadingPage":"Se ncarc pagina...","loadError":"Aceast pagin nu poate fi ncorporat","loadErrorDescription":"Unele site-uri web blocheaz ncorporarea din motive de securitate. Deschide ntr-un tab nou.","nativeWindowTitle":"Pagina extern deschis n fereastr nativ","nativeWindowDescription":"Aceast pagin a fost deschis ntr-o fereastr separat pentru a asigura funcionalitatea complet. Apas butonul de mai sus pentru a o redeschide dac este necesar.","fields":{"title":"Titlu","titlePlaceholder":"ex., Calendar Biseric","url":"URL","urlPlaceholder":"https://exemplu.com/calendar","urlHint":"URL-ul va fi ncorporat ntr-un iframe","icon":"Pictogram","selectIcon":"Selecteaz o pictogram pentru bara lateral","useIframeEmbedding":"Folosete ncorporare iframe","useIframeEmbeddingHint":"ncorporeaz folosind un iframe n loc de webview nativ. Recomandat pentru site-uri ca YouTube care suport ncorporarea iframe."},"validation":{"titleRequired":"Titlul este obligatoriu","urlRequired":"URL-ul este obligatoriu","urlInvalid":"Te rog introdu un URL valid"},"modals":{"create":{"title":"Adaug Pagin Personalizat","submit":"Adaug Pagina"},"edit":{"title":"Editeaz Pagin Personalizat","submit":"Salveaz Modificrile"},"delete":{"title":"terge Pagin Personalizat","message":"Eti sigur c vrei s tergi \\"{{name}}\\"?","confirm":"terge"}},"toast":{"saved":"Configurare bar lateral salvat","customPageCreated":"Pagin personalizat adugat","customPageUpdated":"Pagin personalizat actualizat","customPageDeleted":"Pagin personalizat tears","error":"A aprut o eroare"}},"apiUrl":{"title":"Conexiune Server","label":"URL Server","hint":"Introdu URL-ul de autentificare din Church Hub (ex., http://192.168.1.100:3000/api/auth/user/usr_TOKEN)","settingsDescription":"Configureaz serverul la care se conecteaz aplicaia mobil","testConnection":"Testeaz Conexiunea","testing":"Se testeaz...","retry":"Rencearc","save":"Salveaz i Continu","saved":"URL-ul serverului salvat cu succes","connectionSuccess":"Conexiune reuit","authTokenDetected":"Token de autentificare detectat","setup":{"title":"Conectare la Server","description":"Scaneaz codul QR sau lipete URL-ul de autentificare din Church Hub"},"errors":{"emptyUrl":"Te rugm s introduci un URL de server","invalidUrl":"Te rugm s introduci un URL valid (ex., http://192.168.1.100:3000/api/auth/user/usr_TOKEN)","connectionFailed":"Nu s-a putut conecta la server. Verific URL-ul i ncearc din nou.","testFirst":"Te rugm s testezi conexiunea nainte de a salva"}},"database":{"title":"Administrare Baz de Date","description":"Administreaz locaia i backup-ul bazei de date SQLite","path":"Calea Bazei de Date","copyPath":"Copiaz calea","openFolder":"Deschide n Explorator","size":"Dimensiune","export":{"title":"Export Baza de Date","description":"Creeaz o copie de siguran a bazei de date","button":"Export Baza de Date","exporting":"Se export..."},"import":{"title":"Import Baza de Date","description":"Restaureaz dintr-o copie de siguran","button":"Import Baza de Date","importing":"Se import...","confirm":{"title":"Import Baza de Date","message":"Aceasta va nlocui baza de date curent cu fiierul selectat. O copie de siguran a bazei de date curente va fi creat. Aplicaia va trebui repornit dup import.","warning":"Aceast aciune nu poate fi anulat.","confirm":"Import","cancel":"Anuleaz"}},"toast":{"pathCopied":"Calea bazei de date copiat n clipboard","exportSuccess":"Baza de date exportat cu succes n {{path}}","exportFailed":"Exportul a euat: {{error}}","openFolderFailed":"Nu s-a putut deschide exploratorul de fiiere","importSuccess":"Baza de date importat cu succes. Te rugm s reporneti aplicaia.","importFailed":"Importul a euat: {{error}}"}}}`),HX={title:$X,sections:qX},VX={home:"Acas",dashboard:"Panou",schedules:"Programe",songs:"Cntri",bible:"Biblie",present:"Camera de control",livestream:"Live Stream",settings:"Setri"},KX={collapse:"Restrnge",expand:"Extinde bara lateral",collapseSidebar:"Restrnge bara lateral",openMenu:"Deschide meniu",closeMenu:"nchide meniu"},QX={navigation:VX,actions:KX},WX="Cntri",YX={create:"Cntare nou",save:"Salveaz",delete:"terge",back:"napoi la cntri",import:"Import",importFromText:"Import din text",addSlide:"Adaug slide",cloneSlide:"Cloneaz slide",addToSchedule:"Adaug n program"},GX={titlePlaceholder:"Introdu titlul cntrii...",categoryPlaceholder:"Selecteaz categoria...",slides:"Slide-uri",slideNumber:"Slide {{number}}",emptySlide:"Slide gol - click pentru a edita",noSlides:"Nu exist slide-uri nc",saveFirst:"Salveaz cntarea pentru a aduga slide-uri",undo:"Anuleaz",redo:"Ref"},XX={placeholder:"Caut cntri...",noResults:'Nu s-au gsit cntri pentru "{{query}}"',resultsCount:"{{count}} cntri gsite",showingCount:"Se afieaz {{showing}} din {{total}} cntri",moreResults:"{{count}} cntri n plus nu sunt afiate. Folosete cutarea pentru a gsi cntri specifice."},JX={none:"Fr categorie",create:"Creeaz",name:"Categorie"},ZX={saving:"Se salveaz cntarea...",saved:"Cntarea a fost salvat cu succes",deleted:"Cntarea a fost tears cu succes",error:"A aprut o eroare",slideSaved:"Slide salvat",slideDeleted:"Slide ters",slideCloned:"Slide clonat",reorderFailed:"Nu s-a putut reordona slide-urile",categoryCreated:"Categoria a fost creat"},eJ={deleteTitle:"terge cntarea",deleteMessage:"Eti sigur c vrei s tergi aceast cntare? Aceast aciune nu poate fi anulat.",deleteSlideTitle:"terge slide",deleteSlideMessage:"Eti sigur c vrei s tergi acest slide?",unsavedChangesTitle:"Modificri nesalvate",unsavedChangesMessage:"Ai modificri nesalvate. Eti sigur c vrei s prseti pagina?",unsavedBeforeActionMessage:"Ai modificri nesalvate. Ce vrei s faci?",discardChanges:"Pierde modificrile",saveAndContinue:"Salveaz i continu",continueWithoutSaving:"Continu fr a salva",cancel:"Anuleaz"},tJ="Nu exist cntri nc",nJ="Creeaz prima ta cntare pentru a ncepe",rJ={title:"Import PowerPoint",description:"S-au gsit {{count}} slide-uri. Import ca o cntare nou?",songTitle:"Titlul cntrii",createSong:"Creeaz cntare",dropHint:"Trage fiierul PPTX pentru a importa ca cntare",slideNumber:"Slide {{number}}"},sJ={title:"Import cntri",description:"Pregtit pentru importul a {{count}} cntare/cntri",categoryLabel:"Categorie (opional)",songsList:"Cntri de importat:",confirmButton:"Import {{count}} cntare/cntri",importing:"Se import...",noSongsFound:"Nu s-au gsit fiiere de cntri",noSongsFoundDescription:"Fiierele selectate nu au putut fi interpretate ca i cntri. Te rugm s te asiguri c importezi fiiere de cntri valide (OpenSong XML sau fiiere PowerPoint).",successMessage:"S-au importat cu succes {{count}} cntare/cntri",processing:"Se proceseaz fiierele...",processingProgress:"Procesare: {{current}} din {{total}} fiiere",downloading:"Se descarc...",extracting:"Se extrage arhiva...",converting:"Se convertesc fiierele PPT...",convertingProgress:"Conversie: {{current}} din {{total}} fiiere PPT",parsing:"Se parseaz cntrile...",saving:"Se salveaz n baza de date...",useFirstVerseAsTitle:"Folosete primul vers ca titlu",overwriteDuplicates:"Suprascrie cntrile existente cu acelai titlu",skipManuallyEdited:"Sari peste cntrile editate manual",libreOfficeNotInstalled:"LibreOffice este necesar pentru a importa fiiere .ppt",libreOfficeNotInstalledDescription:"Te rugm s instalezi LibreOffice de la https://www.libreoffice.org pentru a activa importul fiierelor .ppt. Alternativ, convertete fiierele n format .pptx mai nti."},iJ={title:"Setri cntri"},aJ={backToSongs:"napoi",edit:"Editeaz",slides:"Slide-uri",noSlides:"Fr slide-uri",slideNumber:"Slide {{number}}"},oJ={detailsSection:"Detalii",author:"Autor",copyright:"Drepturi de autor",ccli:"Numr CCLI",hymnNumber:"Numr imn",key:"Tonalitate",keyPlaceholder:"Do Major",tempo:"Tempo",timeSignature:"Msur",theme:"Tem",altTheme:"Tem alternativ",keyLine:"Gama melodie",keyLinePlaceholder:"Introdu un vers memorabil din cntare...",presentationOrder:"Ordinea prezentrii",sourceFilename:"Fiier surs",presentationCount:"Numr prezentri",lastManualEdit:"Ultima editare manual",neverEdited:"Needitat"},lJ={title:WX,actions:YX,editor:GX,search:XX,import:{title:"Import din text",description:"Introdu textul cntecului mai jos. Fiecare paragraf va deveni un slide separat.",placeholder:"Introdu versurile aici...",preview:"Previzualizare: {{count}} slide-uri",confirm:"Import",cancel:"Anuleaz"},category:JX,messages:ZX,modal:eJ,noSongs:tJ,noSongsDescription:nJ,pptxImport:rJ,batchImport:sJ,settings:iJ,preview:aJ,metadata:oJ},cJ={en:{bible:hY,common:yY,livestream:TY,presentation:DY,queue:JY,schedules:uG,sidebar:mG,settings:hG,songs:RG},ro:{bible:$G,common:KG,livestream:tX,presentation:cX,queue:MX,schedules:UX,sidebar:QX,settings:HX,songs:lJ}};qn.use(OA).use(iL).init({resources:cJ,fallbackLng:"en",defaultNS:"common",ns:["bible","common","livestream","presentation","queue","schedules","sidebar","settings","songs"],detection:{order:["localStorage","navigator"],caches:["localStorage"],lookupLocalStorage:"church-hub-language"},interpolation:{escapeValue:!1},react:{useSuspense:!0}});const Hn=LO({component:hJ});function uJ(){return Jz(),null}function dJ(){return u.jsx(CA,{children:u.jsx(vA,{children:u.jsx(bb,{})})})}function fJ(){return u.jsx(CA,{children:u.jsx(vA,{children:u.jsx(uW,{children:u.jsx(XQ,{children:u.jsxs(hL,{children:[u.jsx(zz,{children:u.jsx(Sz,{children:u.jsxs(AQ,{children:[u.jsx(uJ,{}),u.jsx(Rz,{}),u.jsx(UW,{children:u.jsx(bb,{})})]})})}),null]})})})})})}function hJ(){return jp().pathname.startsWith("/screen/")?u.jsx(dJ,{}):u.jsx(fJ,{})}function pJ(){const{t}=ke("common");return u.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] p-8 text-center",children:[u.jsx(JI,{className:"w-16 h-16 text-gray-400 dark:text-gray-600 mb-4"}),u.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:t("errors.noPermissionTitle")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4 max-w-md",children:t("errors.noPermission")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:t("errors.contactAdmin")})]})}function fd({permission:t,children:e}){const{hasPermission:n,isLoading:r}=bA();return r?u.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):n(t)?u.jsx(u.Fragment,{children:e}):u.jsx(pJ,{})}const gJ=Rn("/songs/")({component:mJ,validateSearch:t=>({q:typeof t.q=="string"?t.q:void 0,fromSong:t.fromSong===!0||t.fromSong==="true"})});function mJ(){const{t}=ke("songs"),e=ar(),{q:n="",fromSong:r}=Zu({from:"/songs/"}),[s,i]=C.useState(!1),{data:o}=fi(),{data:l}=Up(),d=C.useRef(!1);C.useEffect(()=>{if(d.current||r||!o)return;let g=null;if(o.temporaryContent?.type==="song")g=o.temporaryContent.data.songId;else if(o.currentQueueItemId&&l){const y=l.find(m=>m.id===o.currentQueueItemId);y?.itemType==="song"&&y.songId&&(g=y.songId)}g&&(d.current=!0,e({to:"/songs/$songId",params:{songId:String(g)},search:{q:n||void 0}}))},[o,l,e,n,r]);const f=g=>{e({to:"/songs/$songId",params:{songId:String(g)},search:{q:n||void 0}})},p=g=>{e({to:"/songs/",search:{q:g||void 0},replace:!0})};return u.jsx(fd,{permission:"songs.view",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:t("title")}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("button",{type:"button",onClick:()=>e({to:"/songs/$songId",params:{songId:"new"}}),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors",children:[u.jsx(Xt,{className:"w-5 h-5"}),t("actions.create")]}),u.jsx("button",{type:"button",onClick:()=>i(!0),className:"px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-600 dark:text-gray-400 transition-colors",title:t("settings.title"),children:u.jsx(ui,{className:"w-5 h-5"})})]})]}),u.jsx(fA,{onSongClick:f,searchQuery:n,onSearchChange:p}),u.jsx(wQ,{isOpen:s,onClose:()=>i(!1)})]})})}function yJ(){const[t,e]=C.useState(!1);return{exportDatabase:C.useCallback(async()=>{const s=`church-hub-backup-${new Date().toISOString().split("T")[0]}.db`,i=await gA({defaultPath:s,filters:[{name:"SQLite Database",extensions:["db"]}]});if(!i)return{success:!1,cancelled:!0};e(!0);try{const o=await Me("/api/database/export",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({destinationPath:i})});return o.error?{success:!1,error:o.error}:{success:!0,path:o.data?.exportedPath||i}}catch(o){return{success:!1,error:o instanceof Error?o.message:String(o)}}finally{e(!1)}},[]),isPending:t}}function xJ(){const[t,e]=C.useState(!1),[n,r]=C.useState(null),s=C.useCallback(async()=>{const o=await pA({multiple:!1,filters:[{name:"SQLite Database",extensions:["db","sqlite"]}]});return typeof o=="string"?(r(o),o):(r(null),null)},[]),i=C.useCallback(async o=>{e(!0);try{const l=await Me("/api/database/import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourcePath:o})});return l.error?{success:!1,error:l.error}:{success:!0,requiresRestart:l.data?.requiresRestart}}catch(l){return{success:!1,error:l instanceof Error?l.message:String(l)}}finally{e(!1),r(null)}},[]);return{selectFile:s,importDatabase:i,isPending:t,selectedPath:n}}function bJ(t){if(t===0)return"0 B";const e=1024,n=["B","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(e));return`${Number.parseFloat((t/e**r).toFixed(2))} ${n[r]}`}function vJ(){const{t}=ke("settings"),{showToast:e}=mt(),[n,r]=C.useState(null),[s,i]=C.useState(!0),[o,l]=C.useState(!1),[d,f]=C.useState(null),{exportDatabase:p,isPending:g}=yJ(),{selectFile:y,importDatabase:m,isPending:b}=xJ(),v=C.useCallback(async()=>{i(!0);try{const R=await Me("/api/database/info");R.data&&r(R.data)}catch{}finally{i(!1)}},[]);C.useEffect(()=>{v()},[v]);const w=C.useCallback(()=>{n?.path&&(navigator.clipboard.writeText(n.path),e(t("sections.database.toast.pathCopied"),"success"))},[n?.path,e,t]),S=C.useCallback(async()=>{if(n?.path)try{await Yt("plugin:opener|reveal_item_in_dir",{path:n.path})}catch{e(t("sections.database.toast.openFolderFailed"),"error")}},[n?.path,e,t]),T=C.useCallback(async()=>{const R=await p();R.cancelled||(R.success?e(t("sections.database.toast.exportSuccess",{path:R.path}),"success"):e(t("sections.database.toast.exportFailed",{error:R.error}),"error"))},[p,e,t]),j=C.useCallback(async()=>{const R=await y();R&&(f(R),l(!0))},[y]),M=C.useCallback(async()=>{if(!d)return;l(!1);const R=await m(d);f(null),R.success?e(t("sections.database.toast.importSuccess"),"success"):e(t("sections.database.toast.importFailed",{error:R.error}),"error")},[d,m,e,t]),_=C.useCallback(()=>{l(!1),f(null)},[]);return u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:t("sections.database.title")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:t("sections.database.description")}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:t("sections.database.path")}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:w,disabled:s||!n?.path,className:"p-1.5 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 disabled:opacity-50",title:t("sections.database.copyPath"),children:u.jsx(td,{className:"w-4 h-4"})}),u.jsx("button",{type:"button",onClick:S,disabled:s||!n?.path,className:"p-1.5 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 disabled:opacity-50",title:t("sections.database.openFolder"),children:u.jsx(jj,{className:"w-4 h-4"})})]})]}),u.jsx("code",{className:"block text-sm font-mono bg-gray-100 dark:bg-gray-900 p-2 rounded break-all",children:s?"...":n?.path||"N/A"}),n&&u.jsx("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:u.jsxs("span",{children:[t("sections.database.size"),":"," ",bJ(n.sizeBytes)]})})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"p-2 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg",children:u.jsx(wh,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t("sections.database.export.title")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:t("sections.database.export.description")}),u.jsxs("button",{type:"button",onClick:T,disabled:g||s||b,className:"mt-3 inline-flex items-center gap-2 px-3 py-1.5 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50 text-sm",children:[u.jsx(wh,{className:"w-4 h-4"}),t(g?"sections.database.export.exporting":"sections.database.export.button")]})]})]})}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"p-2 bg-amber-100 dark:bg-amber-900/30 rounded-lg",children:u.jsx(R2,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t("sections.database.import.title")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:t("sections.database.import.description")}),u.jsxs("button",{type:"button",onClick:j,disabled:b||s||g,className:"mt-3 inline-flex items-center gap-2 px-3 py-1.5 bg-amber-600 text-white rounded-md hover:bg-amber-700 disabled:opacity-50 text-sm",children:[u.jsx(R2,{className:"w-4 h-4"}),t(b?"sections.database.import.importing":"sections.database.import.button")]})]})]})})]})]}),o&&u.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[u.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:_,onKeyDown:R=>R.key==="Escape"&&_()}),u.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx("div",{className:"p-2 bg-amber-100 dark:bg-amber-900/30 rounded-full",children:u.jsx(l6,{className:"w-6 h-6 text-amber-600 dark:text-amber-400"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.database.import.confirm.title")}),u.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:t("sections.database.import.confirm.message")}),u.jsx("p",{className:"mt-2 text-sm font-medium text-amber-600 dark:text-amber-400",children:t("sections.database.import.confirm.warning")})]})]}),u.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[u.jsx("button",{type:"button",onClick:_,className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:t("sections.database.import.confirm.cancel")}),u.jsx("button",{type:"button",onClick:M,className:"px-4 py-2 text-sm bg-amber-600 text-white hover:bg-amber-700 rounded-md",children:t("sections.database.import.confirm.confirm")})]})]})]})]})}function wJ(){const{t}=ke("settings"),{showToast:e}=mt(),[n,r]=C.useState(null),[s,i]=C.useState(!1),[o,l]=C.useState(!1),[d,f]=C.useState(!1),p=C.useCallback(async()=>{i(!0);try{const b=await Me("/api/system-token");r(b.data),l(!0)}catch{e(t("sections.systemToken.toast.fetchError"),"error")}finally{i(!1)}},[t,e]),g=async()=>{f(!0);try{const b=await Me("/api/system-token/regenerate",{method:"POST"});r(v=>v?{...v,token:b.data.token,lastUsedAt:null}:{token:b.data.token,lastUsedAt:null,createdAt:new Date().toISOString()}),l(!0),e(t("sections.systemToken.toast.regenerated"),"success")}catch{e(t("sections.systemToken.toast.regenerateError"),"error")}finally{f(!1)}},y=()=>{n?.token&&(navigator.clipboard.writeText(n.token),e(t("sections.systemToken.toast.copied"),"success"))},m=b=>b?new Date(b).toLocaleString():t("sections.systemToken.never");return u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:t("sections.systemToken.title")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:t("sections.systemToken.description")}),!n&&!o?u.jsxs("button",{type:"button",onClick:p,disabled:s,className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 text-sm",children:[u.jsx(tI,{className:"w-4 h-4"}),t(s?"sections.systemToken.loading":"sections.systemToken.showToken")]}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:t("sections.systemToken.token")}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>l(!o),className:"p-1.5 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",title:t(o?"sections.systemToken.hide":"sections.systemToken.show"),children:o?u.jsx(Wl,{className:"w-4 h-4"}):u.jsx(ua,{className:"w-4 h-4"})}),u.jsx("button",{type:"button",onClick:y,className:"p-1.5 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",title:t("sections.systemToken.copy"),children:u.jsx(td,{className:"w-4 h-4"})})]})]}),u.jsx("code",{className:"block text-sm font-mono bg-gray-100 dark:bg-gray-900 p-2 rounded break-all",children:o?n?.token:n?.token.replace(/./g,"*")})]}),n&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 space-y-1",children:[u.jsxs("p",{children:[t("sections.systemToken.createdAt"),":"," ",m(n.createdAt)]}),u.jsxs("p",{children:[t("sections.systemToken.lastUsed"),":"," ",m(n.lastUsedAt)]})]}),u.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[u.jsxs("button",{type:"button",onClick:g,disabled:d,className:"inline-flex items-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50 text-sm",children:[u.jsx(Cb,{className:`w-4 h-4 ${d?"animate-spin":""}`}),t(d?"sections.systemToken.regenerating":"sections.systemToken.regenerate")]}),u.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400",children:t("sections.systemToken.regenerateWarning")})]})]})]})}function SJ({user:t,onEdit:e,onDelete:n,onShowQR:r,onRegenerateToken:s,onToggleActive:i}){const{t:o}=ke("settings"),[l,d]=C.useState(!1),f=g=>g?new Date(g*1e3).toLocaleDateString():o("sections.users.never"),p=t.permissions.length;return u.jsx("div",{className:`relative border rounded-lg p-4 ${t.isActive?"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800":"border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 opacity-60"}`,children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h3",{className:"text-base font-medium text-gray-900 dark:text-white truncate",children:t.name}),u.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${t.isActive?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-400"}`,children:t.isActive?o("sections.users.active"):o("sections.users.inactive")})]}),t.roleName&&u.jsx("p",{className:"mt-1 text-sm text-indigo-600 dark:text-indigo-400",children:o(`sections.users.roles.${t.roleName}`,t.roleName)}),u.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[o("sections.users.lastUsed"),": ",f(t.lastUsedAt)]}),u.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[p," ",o("sections.users.permissions").toLowerCase()]})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{onClick:()=>r(t),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:o("sections.users.actions.showQRCode"),children:u.jsx(A2,{size:20,className:"text-indigo-600 dark:text-indigo-400"})}),u.jsx("button",{onClick:()=>d(!l),className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(Op,{size:20,className:"text-gray-500 dark:text-gray-400"})}),l&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>d(!1)}),u.jsxs("div",{className:"absolute right-0 mt-1 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-20",children:[u.jsxs("button",{onClick:()=>{r(t),d(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(A2,{size:16}),o("sections.users.actions.showQRCode")]}),u.jsxs("button",{onClick:()=>{e(t),d(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(Hj,{size:16}),o("sections.users.actions.edit")]}),u.jsxs("button",{onClick:()=>{s(t),d(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(Cb,{size:16}),o("sections.users.actions.regenerateToken")]}),u.jsx("button",{onClick:()=>{i(t),d(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:t.isActive?u.jsxs(u.Fragment,{children:[u.jsx(zI,{size:16}),o("sections.users.actions.deactivate")]}):u.jsxs(u.Fragment,{children:[u.jsx($j,{size:16}),o("sections.users.actions.activate")]})}),u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700"}),u.jsxs("button",{onClick:()=>{n(t),d(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:[u.jsx(Bn,{size:16}),o("sections.users.actions.delete")]})]})]})]})]})})}const kJ=["songs","control_room","programs","queue","settings","displays","users"];function CJ({permissions:t,onChange:e,disabled:n,selectedRole:r,onRoleChange:s}){const{t:i}=ke("settings"),[o,l]=C.useState(new Set(["songs","control_room"])),d=v=>{const w=new Set(o);w.has(v)?w.delete(v):w.add(v),l(w)},f=(v,w)=>{e(w?[...t,v]:t.filter(S=>S!==v)),s&&s(null)},p=(v,w)=>{const S=vl[v];if(w){const T=new Set([...t,...S]);e(Array.from(T))}else e(t.filter(T=>!S.includes(T)));s&&s(null)},g=v=>{s&&s(v),v&&e([...ob[v]])},y=v=>vl[v].every(w=>t.includes(w)),m=v=>{const w=vl[v],S=w.filter(T=>t.includes(T)).length;return S>0&&S<w.length},b=v=>vl[v].filter(w=>t.includes(w)).length;return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("sections.users.roleTemplate")}),u.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.keys(ob).map(v=>u.jsx("button",{type:"button",onClick:()=>g(v),disabled:n,className:`px-3 py-2 text-sm rounded-lg border transition-colors ${r===v?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300":"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:border-indigo-300 dark:hover:border-indigo-700 hover:bg-gray-50 dark:hover:bg-gray-800"} disabled:opacity-50 disabled:cursor-not-allowed`,children:i(`sections.users.roles.${v}`)},v))})]}),u.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:kJ.map(v=>{const w=o.has(v),S=y(v),T=m(v),j=b(v),M=vl[v].length;return u.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:[u.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 dark:bg-gray-800/50",children:[u.jsx("button",{type:"button",onClick:()=>d(v),className:"p-0.5 hover:bg-gray-200 dark:hover:bg-gray-700 rounded",children:w?u.jsx(Es,{size:16,className:"text-gray-500"}):u.jsx(Ms,{size:16,className:"text-gray-500"})}),u.jsx("input",{type:"checkbox",checked:S,ref:_=>{_&&(_.indeterminate=T)},onChange:_=>p(v,_.target.checked),disabled:n,className:`w-4 h-4 text-indigo-600 rounded border-gray-300
                    focus:ring-indigo-500 disabled:opacity-50 cursor-pointer
                    disabled:cursor-not-allowed`}),u.jsx("button",{type:"button",onClick:()=>d(v),className:"flex-1 text-left text-sm font-medium text-gray-900 dark:text-white",children:i(`sections.users.groups.${v}`)}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[j,"/",M]})]}),w&&u.jsx("div",{className:"px-3 py-2 space-y-2 bg-white dark:bg-gray-800",children:vl[v].map(_=>u.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:t.includes(_),onChange:R=>f(_,R.target.checked),disabled:n,className:`w-4 h-4 text-indigo-600 rounded border-gray-300
                          focus:ring-indigo-500 disabled:opacity-50 cursor-pointer
                          disabled:cursor-not-allowed ml-6`}),u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:i(`sections.users.permissionLabels.${_}`)})]},_))})]},v)})}),u.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-right",children:[t.length," ",i("sections.users.permissionsSelected")]})]})}function NJ({user:t,onSubmit:e,onCancel:n,isLoading:r}){const{t:s}=ke("settings"),[i,o]=C.useState(t?.name??""),[l,d]=C.useState(t?.permissions??[]),[f,p]=C.useState(()=>{if(!t?.permissions)return null;for(const[m,b]of Object.entries(ob))if(b.length===t.permissions.length&&b.every(v=>t.permissions.includes(v)))return m;return null}),g=m=>{m.preventDefault(),i.trim()&&e({name:i.trim(),permissions:l})},y=!!t;return u.jsxs("form",{onSubmit:g,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"user-name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:s("sections.users.userName")}),u.jsx("input",{id:"user-name",type:"text",value:i,onChange:m=>o(m.target.value),placeholder:s("sections.users.userNamePlaceholder"),disabled:r,className:`block w-full px-3 py-2 bg-white dark:bg-gray-800
            border border-gray-300 dark:border-gray-600 rounded-lg
            text-gray-900 dark:text-white
            focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500
            disabled:opacity-50`,autoFocus:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:s("sections.users.permissions")}),u.jsx(CJ,{permissions:l,onChange:d,disabled:r,selectedRole:f,onRoleChange:p})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:n,disabled:r,className:`px-4 py-2 text-gray-700 dark:text-gray-300
            hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg
            transition-colors disabled:opacity-50`,children:s("sections.users.modals.cancel")}),u.jsx("button",{type:"submit",disabled:r||!i.trim(),className:`px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg
            transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,children:r?u.jsxs("span",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s(y?"sections.users.modals.edit.submit":"sections.users.modals.create.submit")]}):s(y?"sections.users.modals.edit.submit":"sections.users.modals.create.submit")})]})]})}const rc=["users"];function TJ(){return lt({queryKey:rc,queryFn:ZQ})}function jJ(){const t=Le();return Ie({mutationFn:e=>eW(e),onSuccess:()=>{t.invalidateQueries({queryKey:rc})}})}function EJ(){const t=Le();return Ie({mutationFn:e=>nW(e),onSuccess:()=>{t.invalidateQueries({queryKey:rc})}})}var Cl={},My,mT;function MJ(){return mT||(mT=1,My=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),My}var Ay={},$i={},yT;function So(){if(yT)return $i;yT=1;let t;const e=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return $i.getSymbolSize=function(r){if(!r)throw new Error('"version" cannot be null or undefined');if(r<1||r>40)throw new Error('"version" should be in range from 1 to 40');return r*4+17},$i.getSymbolTotalCodewords=function(r){return e[r]},$i.getBCHDigit=function(n){let r=0;for(;n!==0;)r++,n>>>=1;return r},$i.setToSJISFunction=function(r){if(typeof r!="function")throw new Error('"toSJISFunc" is not a valid function.');t=r},$i.isKanjiModeEnabled=function(){return typeof t<"u"},$i.toSJIS=function(r){return t(r)},$i}var Ry={},xT;function r1(){return xT||(xT=1,(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+n)}}t.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},t.from=function(r,s){if(t.isValid(r))return r;try{return e(r)}catch{return s}}})(Ry)),Ry}var _y,bT;function AJ(){if(bT)return _y;bT=1;function t(){this.buffer=[],this.length=0}return t.prototype={get:function(e){const n=Math.floor(e/8);return(this.buffer[n]>>>7-e%8&1)===1},put:function(e,n){for(let r=0;r<n;r++)this.putBit((e>>>n-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),e&&(this.buffer[n]|=128>>>this.length%8),this.length++}},_y=t,_y}var Oy,vT;function RJ(){if(vT)return Oy;vT=1;function t(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}return t.prototype.set=function(e,n,r,s){const i=e*this.size+n;this.data[i]=r,s&&(this.reservedBit[i]=!0)},t.prototype.get=function(e,n){return this.data[e*this.size+n]},t.prototype.xor=function(e,n,r){this.data[e*this.size+n]^=r},t.prototype.isReserved=function(e,n){return this.reservedBit[e*this.size+n]},Oy=t,Oy}var Dy={},wT;function _J(){return wT||(wT=1,(function(t){const e=So().getSymbolSize;t.getRowColCoords=function(r){if(r===1)return[];const s=Math.floor(r/7)+2,i=e(r),o=i===145?26:Math.ceil((i-13)/(2*s-2))*2,l=[i-7];for(let d=1;d<s-1;d++)l[d]=l[d-1]-o;return l.push(6),l.reverse()},t.getPositions=function(r){const s=[],i=t.getRowColCoords(r),o=i.length;for(let l=0;l<o;l++)for(let d=0;d<o;d++)l===0&&d===0||l===0&&d===o-1||l===o-1&&d===0||s.push([i[l],i[d]]);return s}})(Dy)),Dy}var Iy={},ST;function OJ(){if(ST)return Iy;ST=1;const t=So().getSymbolSize,e=7;return Iy.getPositions=function(r){const s=t(r);return[[0,0],[s-e,0],[0,s-e]]},Iy}var Ly={},kT;function DJ(){return kT||(kT=1,(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(s){return s!=null&&s!==""&&!isNaN(s)&&s>=0&&s<=7},t.from=function(s){return t.isValid(s)?parseInt(s,10):void 0},t.getPenaltyN1=function(s){const i=s.size;let o=0,l=0,d=0,f=null,p=null;for(let g=0;g<i;g++){l=d=0,f=p=null;for(let y=0;y<i;y++){let m=s.get(g,y);m===f?l++:(l>=5&&(o+=e.N1+(l-5)),f=m,l=1),m=s.get(y,g),m===p?d++:(d>=5&&(o+=e.N1+(d-5)),p=m,d=1)}l>=5&&(o+=e.N1+(l-5)),d>=5&&(o+=e.N1+(d-5))}return o},t.getPenaltyN2=function(s){const i=s.size;let o=0;for(let l=0;l<i-1;l++)for(let d=0;d<i-1;d++){const f=s.get(l,d)+s.get(l,d+1)+s.get(l+1,d)+s.get(l+1,d+1);(f===4||f===0)&&o++}return o*e.N2},t.getPenaltyN3=function(s){const i=s.size;let o=0,l=0,d=0;for(let f=0;f<i;f++){l=d=0;for(let p=0;p<i;p++)l=l<<1&2047|s.get(f,p),p>=10&&(l===1488||l===93)&&o++,d=d<<1&2047|s.get(p,f),p>=10&&(d===1488||d===93)&&o++}return o*e.N3},t.getPenaltyN4=function(s){let i=0;const o=s.data.length;for(let d=0;d<o;d++)i+=s.data[d];return Math.abs(Math.ceil(i*100/o/5)-10)*e.N4};function n(r,s,i){switch(r){case t.Patterns.PATTERN000:return(s+i)%2===0;case t.Patterns.PATTERN001:return s%2===0;case t.Patterns.PATTERN010:return i%3===0;case t.Patterns.PATTERN011:return(s+i)%3===0;case t.Patterns.PATTERN100:return(Math.floor(s/2)+Math.floor(i/3))%2===0;case t.Patterns.PATTERN101:return s*i%2+s*i%3===0;case t.Patterns.PATTERN110:return(s*i%2+s*i%3)%2===0;case t.Patterns.PATTERN111:return(s*i%3+(s+i)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}t.applyMask=function(s,i){const o=i.size;for(let l=0;l<o;l++)for(let d=0;d<o;d++)i.isReserved(d,l)||i.xor(d,l,n(s,d,l))},t.getBestMask=function(s,i){const o=Object.keys(t.Patterns).length;let l=0,d=1/0;for(let f=0;f<o;f++){i(f),t.applyMask(f,s);const p=t.getPenaltyN1(s)+t.getPenaltyN2(s)+t.getPenaltyN3(s)+t.getPenaltyN4(s);t.applyMask(f,s),p<d&&(d=p,l=f)}return l}})(Ly)),Ly}var nh={},CT;function DA(){if(CT)return nh;CT=1;const t=r1(),e=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return nh.getBlocksCount=function(s,i){switch(i){case t.L:return e[(s-1)*4+0];case t.M:return e[(s-1)*4+1];case t.Q:return e[(s-1)*4+2];case t.H:return e[(s-1)*4+3];default:return}},nh.getTotalCodewordsCount=function(s,i){switch(i){case t.L:return n[(s-1)*4+0];case t.M:return n[(s-1)*4+1];case t.Q:return n[(s-1)*4+2];case t.H:return n[(s-1)*4+3];default:return}},nh}var zy={},nu={},NT;function IJ(){if(NT)return nu;NT=1;const t=new Uint8Array(512),e=new Uint8Array(256);return(function(){let r=1;for(let s=0;s<255;s++)t[s]=r,e[r]=s,r<<=1,r&256&&(r^=285);for(let s=255;s<512;s++)t[s]=t[s-255]})(),nu.log=function(r){if(r<1)throw new Error("log("+r+")");return e[r]},nu.exp=function(r){return t[r]},nu.mul=function(r,s){return r===0||s===0?0:t[e[r]+e[s]]},nu}var TT;function LJ(){return TT||(TT=1,(function(t){const e=IJ();t.mul=function(r,s){const i=new Uint8Array(r.length+s.length-1);for(let o=0;o<r.length;o++)for(let l=0;l<s.length;l++)i[o+l]^=e.mul(r[o],s[l]);return i},t.mod=function(r,s){let i=new Uint8Array(r);for(;i.length-s.length>=0;){const o=i[0];for(let d=0;d<s.length;d++)i[d]^=e.mul(s[d],o);let l=0;for(;l<i.length&&i[l]===0;)l++;i=i.slice(l)}return i},t.generateECPolynomial=function(r){let s=new Uint8Array([1]);for(let i=0;i<r;i++)s=t.mul(s,new Uint8Array([1,e.exp(i)]));return s}})(zy)),zy}var Py,jT;function zJ(){if(jT)return Py;jT=1;const t=LJ();function e(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return e.prototype.initialize=function(r){this.degree=r,this.genPoly=t.generateECPolynomial(this.degree)},e.prototype.encode=function(r){if(!this.genPoly)throw new Error("Encoder not initialized");const s=new Uint8Array(r.length+this.degree);s.set(r);const i=t.mod(s,this.genPoly),o=this.degree-i.length;if(o>0){const l=new Uint8Array(this.degree);return l.set(i,o),l}return i},Py=e,Py}var By={},Fy={},Uy={},ET;function IA(){return ET||(ET=1,Uy.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}),Uy}var ys={},MT;function LA(){if(MT)return ys;MT=1;const t="[0-9]+",e="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const r="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;ys.KANJI=new RegExp(n,"g"),ys.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),ys.BYTE=new RegExp(r,"g"),ys.NUMERIC=new RegExp(t,"g"),ys.ALPHANUMERIC=new RegExp(e,"g");const s=new RegExp("^"+n+"$"),i=new RegExp("^"+t+"$"),o=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return ys.testKanji=function(d){return s.test(d)},ys.testNumeric=function(d){return i.test(d)},ys.testAlphanumeric=function(d){return o.test(d)},ys}var AT;function ko(){return AT||(AT=1,(function(t){const e=IA(),n=LA();t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},t.getBestModeForData=function(i){return n.testNumeric(i)?t.NUMERIC:n.testAlphanumeric(i)?t.ALPHANUMERIC:n.testKanji(i)?t.KANJI:t.BYTE},t.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},t.isValid=function(i){return i&&i.bit&&i.ccBits};function r(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+s)}}t.from=function(i,o){if(t.isValid(i))return i;try{return r(i)}catch{return o}}})(Fy)),Fy}var RT;function PJ(){return RT||(RT=1,(function(t){const e=So(),n=DA(),r=r1(),s=ko(),i=IA(),o=7973,l=e.getBCHDigit(o);function d(y,m,b){for(let v=1;v<=40;v++)if(m<=t.getCapacity(v,b,y))return v}function f(y,m){return s.getCharCountIndicator(y,m)+4}function p(y,m){let b=0;return y.forEach(function(v){const w=f(v.mode,m);b+=w+v.getBitsLength()}),b}function g(y,m){for(let b=1;b<=40;b++)if(p(y,b)<=t.getCapacity(b,m,s.MIXED))return b}t.from=function(m,b){return i.isValid(m)?parseInt(m,10):b},t.getCapacity=function(m,b,v){if(!i.isValid(m))throw new Error("Invalid QR Code version");typeof v>"u"&&(v=s.BYTE);const w=e.getSymbolTotalCodewords(m),S=n.getTotalCodewordsCount(m,b),T=(w-S)*8;if(v===s.MIXED)return T;const j=T-f(v,m);switch(v){case s.NUMERIC:return Math.floor(j/10*3);case s.ALPHANUMERIC:return Math.floor(j/11*2);case s.KANJI:return Math.floor(j/13);case s.BYTE:default:return Math.floor(j/8)}},t.getBestVersionForData=function(m,b){let v;const w=r.from(b,r.M);if(Array.isArray(m)){if(m.length>1)return g(m,w);if(m.length===0)return 1;v=m[0]}else v=m;return d(v.mode,v.getLength(),w)},t.getEncodedBits=function(m){if(!i.isValid(m)||m<7)throw new Error("Invalid QR Code version");let b=m<<12;for(;e.getBCHDigit(b)-l>=0;)b^=o<<e.getBCHDigit(b)-l;return m<<12|b}})(By)),By}var $y={},_T;function BJ(){if(_T)return $y;_T=1;const t=So(),e=1335,n=21522,r=t.getBCHDigit(e);return $y.getEncodedBits=function(i,o){const l=i.bit<<3|o;let d=l<<10;for(;t.getBCHDigit(d)-r>=0;)d^=e<<t.getBCHDigit(d)-r;return(l<<10|d)^n},$y}var qy={},Hy,OT;function FJ(){if(OT)return Hy;OT=1;const t=ko();function e(n){this.mode=t.NUMERIC,this.data=n.toString()}return e.getBitsLength=function(r){return 10*Math.floor(r/3)+(r%3?r%3*3+1:0)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(r){let s,i,o;for(s=0;s+3<=this.data.length;s+=3)i=this.data.substr(s,3),o=parseInt(i,10),r.put(o,10);const l=this.data.length-s;l>0&&(i=this.data.substr(s),o=parseInt(i,10),r.put(o,l*3+1))},Hy=e,Hy}var Vy,DT;function UJ(){if(DT)return Vy;DT=1;const t=ko(),e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(r){this.mode=t.ALPHANUMERIC,this.data=r}return n.getBitsLength=function(s){return 11*Math.floor(s/2)+6*(s%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(s){let i;for(i=0;i+2<=this.data.length;i+=2){let o=e.indexOf(this.data[i])*45;o+=e.indexOf(this.data[i+1]),s.put(o,11)}this.data.length%2&&s.put(e.indexOf(this.data[i]),6)},Vy=n,Vy}var Ky,IT;function $J(){if(IT)return Ky;IT=1;const t=ko();function e(n){this.mode=t.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return e.getBitsLength=function(r){return r*8},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(n){for(let r=0,s=this.data.length;r<s;r++)n.put(this.data[r],8)},Ky=e,Ky}var Qy,LT;function qJ(){if(LT)return Qy;LT=1;const t=ko(),e=So();function n(r){this.mode=t.KANJI,this.data=r}return n.getBitsLength=function(s){return s*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let s;for(s=0;s<this.data.length;s++){let i=e.toSJIS(this.data[s]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[s]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),r.put(i,13)}},Qy=n,Qy}var Wy={exports:{}},zT;function HJ(){return zT||(zT=1,(function(t){var e={single_source_shortest_paths:function(n,r,s){var i={},o={};o[r]=0;var l=e.PriorityQueue.make();l.push(r,0);for(var d,f,p,g,y,m,b,v,w;!l.empty();){d=l.pop(),f=d.value,g=d.cost,y=n[f]||{};for(p in y)y.hasOwnProperty(p)&&(m=y[p],b=g+m,v=o[p],w=typeof o[p]>"u",(w||v>b)&&(o[p]=b,l.push(p,b),i[p]=f))}if(typeof s<"u"&&typeof o[s]>"u"){var S=["Could not find a path from ",r," to ",s,"."].join("");throw new Error(S)}return i},extract_shortest_path_from_predecessor_list:function(n,r){for(var s=[],i=r;i;)s.push(i),n[i],i=n[i];return s.reverse(),s},find_path:function(n,r,s){var i=e.single_source_shortest_paths(n,r,s);return e.extract_shortest_path_from_predecessor_list(i,s)},PriorityQueue:{make:function(n){var r=e.PriorityQueue,s={},i;n=n||{};for(i in r)r.hasOwnProperty(i)&&(s[i]=r[i]);return s.queue=[],s.sorter=n.sorter||r.default_sorter,s},default_sorter:function(n,r){return n.cost-r.cost},push:function(n,r){var s={value:n,cost:r};this.queue.push(s),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(Wy)),Wy.exports}var PT;function VJ(){return PT||(PT=1,(function(t){const e=ko(),n=FJ(),r=UJ(),s=$J(),i=qJ(),o=LA(),l=So(),d=HJ();function f(S){return unescape(encodeURIComponent(S)).length}function p(S,T,j){const M=[];let _;for(;(_=S.exec(j))!==null;)M.push({data:_[0],index:_.index,mode:T,length:_[0].length});return M}function g(S){const T=p(o.NUMERIC,e.NUMERIC,S),j=p(o.ALPHANUMERIC,e.ALPHANUMERIC,S);let M,_;return l.isKanjiModeEnabled()?(M=p(o.BYTE,e.BYTE,S),_=p(o.KANJI,e.KANJI,S)):(M=p(o.BYTE_KANJI,e.BYTE,S),_=[]),T.concat(j,M,_).sort(function(O,L){return O.index-L.index}).map(function(O){return{data:O.data,mode:O.mode,length:O.length}})}function y(S,T){switch(T){case e.NUMERIC:return n.getBitsLength(S);case e.ALPHANUMERIC:return r.getBitsLength(S);case e.KANJI:return i.getBitsLength(S);case e.BYTE:return s.getBitsLength(S)}}function m(S){return S.reduce(function(T,j){const M=T.length-1>=0?T[T.length-1]:null;return M&&M.mode===j.mode?(T[T.length-1].data+=j.data,T):(T.push(j),T)},[])}function b(S){const T=[];for(let j=0;j<S.length;j++){const M=S[j];switch(M.mode){case e.NUMERIC:T.push([M,{data:M.data,mode:e.ALPHANUMERIC,length:M.length},{data:M.data,mode:e.BYTE,length:M.length}]);break;case e.ALPHANUMERIC:T.push([M,{data:M.data,mode:e.BYTE,length:M.length}]);break;case e.KANJI:T.push([M,{data:M.data,mode:e.BYTE,length:f(M.data)}]);break;case e.BYTE:T.push([{data:M.data,mode:e.BYTE,length:f(M.data)}])}}return T}function v(S,T){const j={},M={start:{}};let _=["start"];for(let R=0;R<S.length;R++){const O=S[R],L=[];for(let A=0;A<O.length;A++){const F=O[A],H=""+R+A;L.push(H),j[H]={node:F,lastCount:0},M[H]={};for(let P=0;P<_.length;P++){const B=_[P];j[B]&&j[B].node.mode===F.mode?(M[B][H]=y(j[B].lastCount+F.length,F.mode)-y(j[B].lastCount,F.mode),j[B].lastCount+=F.length):(j[B]&&(j[B].lastCount=F.length),M[B][H]=y(F.length,F.mode)+4+e.getCharCountIndicator(F.mode,T))}}_=L}for(let R=0;R<_.length;R++)M[_[R]].end=0;return{map:M,table:j}}function w(S,T){let j;const M=e.getBestModeForData(S);if(j=e.from(T,M),j!==e.BYTE&&j.bit<M.bit)throw new Error('"'+S+'" cannot be encoded with mode '+e.toString(j)+`.
 Suggested mode is: `+e.toString(M));switch(j===e.KANJI&&!l.isKanjiModeEnabled()&&(j=e.BYTE),j){case e.NUMERIC:return new n(S);case e.ALPHANUMERIC:return new r(S);case e.KANJI:return new i(S);case e.BYTE:return new s(S)}}t.fromArray=function(T){return T.reduce(function(j,M){return typeof M=="string"?j.push(w(M,null)):M.data&&j.push(w(M.data,M.mode)),j},[])},t.fromString=function(T,j){const M=g(T,l.isKanjiModeEnabled()),_=b(M),R=v(_,j),O=d.find_path(R.map,"start","end"),L=[];for(let A=1;A<O.length-1;A++)L.push(R.table[O[A]].node);return t.fromArray(m(L))},t.rawSplit=function(T){return t.fromArray(g(T,l.isKanjiModeEnabled()))}})(qy)),qy}var BT;function KJ(){if(BT)return Ay;BT=1;const t=So(),e=r1(),n=AJ(),r=RJ(),s=_J(),i=OJ(),o=DJ(),l=DA(),d=zJ(),f=PJ(),p=BJ(),g=ko(),y=VJ();function m(R,O){const L=R.size,A=i.getPositions(O);for(let F=0;F<A.length;F++){const H=A[F][0],P=A[F][1];for(let B=-1;B<=7;B++)if(!(H+B<=-1||L<=H+B))for(let E=-1;E<=7;E++)P+E<=-1||L<=P+E||(B>=0&&B<=6&&(E===0||E===6)||E>=0&&E<=6&&(B===0||B===6)||B>=2&&B<=4&&E>=2&&E<=4?R.set(H+B,P+E,!0,!0):R.set(H+B,P+E,!1,!0))}}function b(R){const O=R.size;for(let L=8;L<O-8;L++){const A=L%2===0;R.set(L,6,A,!0),R.set(6,L,A,!0)}}function v(R,O){const L=s.getPositions(O);for(let A=0;A<L.length;A++){const F=L[A][0],H=L[A][1];for(let P=-2;P<=2;P++)for(let B=-2;B<=2;B++)P===-2||P===2||B===-2||B===2||P===0&&B===0?R.set(F+P,H+B,!0,!0):R.set(F+P,H+B,!1,!0)}}function w(R,O){const L=R.size,A=f.getEncodedBits(O);let F,H,P;for(let B=0;B<18;B++)F=Math.floor(B/3),H=B%3+L-8-3,P=(A>>B&1)===1,R.set(F,H,P,!0),R.set(H,F,P,!0)}function S(R,O,L){const A=R.size,F=p.getEncodedBits(O,L);let H,P;for(H=0;H<15;H++)P=(F>>H&1)===1,H<6?R.set(H,8,P,!0):H<8?R.set(H+1,8,P,!0):R.set(A-15+H,8,P,!0),H<8?R.set(8,A-H-1,P,!0):H<9?R.set(8,15-H-1+1,P,!0):R.set(8,15-H-1,P,!0);R.set(A-8,8,1,!0)}function T(R,O){const L=R.size;let A=-1,F=L-1,H=7,P=0;for(let B=L-1;B>0;B-=2)for(B===6&&B--;;){for(let E=0;E<2;E++)if(!R.isReserved(F,B-E)){let K=!1;P<O.length&&(K=(O[P]>>>H&1)===1),R.set(F,B-E,K),H--,H===-1&&(P++,H=7)}if(F+=A,F<0||L<=F){F-=A,A=-A;break}}}function j(R,O,L){const A=new n;L.forEach(function(E){A.put(E.mode.bit,4),A.put(E.getLength(),g.getCharCountIndicator(E.mode,R)),E.write(A)});const F=t.getSymbolTotalCodewords(R),H=l.getTotalCodewordsCount(R,O),P=(F-H)*8;for(A.getLengthInBits()+4<=P&&A.put(0,4);A.getLengthInBits()%8!==0;)A.putBit(0);const B=(P-A.getLengthInBits())/8;for(let E=0;E<B;E++)A.put(E%2?17:236,8);return M(A,R,O)}function M(R,O,L){const A=t.getSymbolTotalCodewords(O),F=l.getTotalCodewordsCount(O,L),H=A-F,P=l.getBlocksCount(O,L),B=A%P,E=P-B,K=Math.floor(A/P),q=Math.floor(H/P),V=q+1,ie=K-q,Y=new d(ie);let X=0;const I=new Array(P),U=new Array(P);let te=0;const Z=new Uint8Array(R.buffer);for(let me=0;me<P;me++){const Se=me<E?q:V;I[me]=Z.slice(X,X+Se),U[me]=Y.encode(I[me]),X+=Se,te=Math.max(te,Se)}const re=new Uint8Array(A);let se=0,ge,be;for(ge=0;ge<te;ge++)for(be=0;be<P;be++)ge<I[be].length&&(re[se++]=I[be][ge]);for(ge=0;ge<ie;ge++)for(be=0;be<P;be++)re[se++]=U[be][ge];return re}function _(R,O,L,A){let F;if(Array.isArray(R))F=y.fromArray(R);else if(typeof R=="string"){let K=O;if(!K){const q=y.rawSplit(R);K=f.getBestVersionForData(q,L)}F=y.fromString(R,K||40)}else throw new Error("Invalid data");const H=f.getBestVersionForData(F,L);if(!H)throw new Error("The amount of data is too big to be stored in a QR Code");if(!O)O=H;else if(O<H)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+H+`.
`);const P=j(O,L,F),B=t.getSymbolSize(O),E=new r(B);return m(E,O),b(E),v(E,O),S(E,L,0),O>=7&&w(E,O),T(E,P),isNaN(A)&&(A=o.getBestMask(E,S.bind(null,E,L))),o.applyMask(A,E),S(E,L,A),{modules:E,version:O,errorCorrectionLevel:L,maskPattern:A,segments:F}}return Ay.create=function(O,L){if(typeof O>"u"||O==="")throw new Error("No input text");let A=e.M,F,H;return typeof L<"u"&&(A=e.from(L.errorCorrectionLevel,e.M),F=f.from(L.version),H=o.from(L.maskPattern),L.toSJISFunc&&t.setToSJISFunction(L.toSJISFunc)),_(O,F,A,H)},Ay}var Yy={},Gy={},FT;function zA(){return FT||(FT=1,(function(t){function e(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let r=n.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+n);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(i){return[i,i]}))),r.length===6&&r.push("F","F");const s=parseInt(r.join(""),16);return{r:s>>24&255,g:s>>16&255,b:s>>8&255,a:s&255,hex:"#"+r.slice(0,6).join("")}}t.getOptions=function(r){r||(r={}),r.color||(r.color={});const s=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,i=r.width&&r.width>=21?r.width:void 0,o=r.scale||4;return{width:i,scale:i?4:o,margin:s,color:{dark:e(r.color.dark||"#000000ff"),light:e(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},t.getScale=function(r,s){return s.width&&s.width>=r+s.margin*2?s.width/(r+s.margin*2):s.scale},t.getImageWidth=function(r,s){const i=t.getScale(r,s);return Math.floor((r+s.margin*2)*i)},t.qrToImageData=function(r,s,i){const o=s.modules.size,l=s.modules.data,d=t.getScale(o,i),f=Math.floor((o+i.margin*2)*d),p=i.margin*d,g=[i.color.light,i.color.dark];for(let y=0;y<f;y++)for(let m=0;m<f;m++){let b=(y*f+m)*4,v=i.color.light;if(y>=p&&m>=p&&y<f-p&&m<f-p){const w=Math.floor((y-p)/d),S=Math.floor((m-p)/d);v=g[l[w*o+S]?1:0]}r[b++]=v.r,r[b++]=v.g,r[b++]=v.b,r[b]=v.a}}})(Gy)),Gy}var UT;function QJ(){return UT||(UT=1,(function(t){const e=zA();function n(s,i,o){s.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(i,o,l){let d=l,f=o;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),o||(f=r()),d=e.getOptions(d);const p=e.getImageWidth(i.modules.size,d),g=f.getContext("2d"),y=g.createImageData(p,p);return e.qrToImageData(y.data,i,d),n(g,f,p),g.putImageData(y,0,0),f},t.renderToDataURL=function(i,o,l){let d=l;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),d||(d={});const f=t.render(i,o,d),p=d.type||"image/png",g=d.rendererOpts||{};return f.toDataURL(p,g.quality)}})(Yy)),Yy}var Xy={},$T;function WJ(){if($T)return Xy;$T=1;const t=zA();function e(s,i){const o=s.a/255,l=i+'="'+s.hex+'"';return o<1?l+" "+i+'-opacity="'+o.toFixed(2).slice(1)+'"':l}function n(s,i,o){let l=s+i;return typeof o<"u"&&(l+=" "+o),l}function r(s,i,o){let l="",d=0,f=!1,p=0;for(let g=0;g<s.length;g++){const y=Math.floor(g%i),m=Math.floor(g/i);!y&&!f&&(f=!0),s[g]?(p++,g>0&&y>0&&s[g-1]||(l+=f?n("M",y+o,.5+m+o):n("m",d,0),d=0,f=!1),y+1<i&&s[g+1]||(l+=n("h",p),p=0)):d++}return l}return Xy.render=function(i,o,l){const d=t.getOptions(o),f=i.modules.size,p=i.modules.data,g=f+d.margin*2,y=d.color.light.a?"<path "+e(d.color.light,"fill")+' d="M0 0h'+g+"v"+g+'H0z"/>':"",m="<path "+e(d.color.dark,"stroke")+' d="'+r(p,f,d.margin)+'"/>',b='viewBox="0 0 '+g+" "+g+'"',w='<svg xmlns="http://www.w3.org/2000/svg" '+(d.width?'width="'+d.width+'" height="'+d.width+'" ':"")+b+' shape-rendering="crispEdges">'+y+m+`</svg>
`;return typeof l=="function"&&l(null,w),w},Xy}var qT;function YJ(){if(qT)return Cl;qT=1;const t=MJ(),e=KJ(),n=QJ(),r=WJ();function s(i,o,l,d,f){const p=[].slice.call(arguments,1),g=p.length,y=typeof p[g-1]=="function";if(!y&&!t())throw new Error("Callback required as last argument");if(y){if(g<2)throw new Error("Too few arguments provided");g===2?(f=l,l=o,o=d=void 0):g===3&&(o.getContext&&typeof f>"u"?(f=d,d=void 0):(f=d,d=l,l=o,o=void 0))}else{if(g<1)throw new Error("Too few arguments provided");return g===1?(l=o,o=d=void 0):g===2&&!o.getContext&&(d=l,l=o,o=void 0),new Promise(function(m,b){try{const v=e.create(l,d);m(i(v,o,d))}catch(v){b(v)}})}try{const m=e.create(l,d);f(null,i(m,o,d))}catch(m){f(m)}}return Cl.create=e.create,Cl.toCanvas=s.bind(null,n.render),Cl.toDataURL=s.bind(null,n.renderToDataURL),Cl.toString=s.bind(null,function(i,o,l){return r.render(i,l)}),Cl}var GJ=YJ();const XJ=Ql(GJ);function JJ(t){const[e,n]=C.useState(null),[r,s]=C.useState(null),[i,o]=C.useState(!1);return C.useEffect(()=>{if(!t){n(null),s(null);return}o(!0),s(null),XJ.toDataURL(t,{width:256,margin:2,color:{dark:"#000000",light:"#ffffff"}}).then(l=>{n(l),o(!1)}).catch(l=>{s(l),o(!1)})},[t]),{qrDataUrl:e,error:r,isLoading:i}}function ZJ(){const t=Le();return Ie({mutationFn:e=>sW(e),onSuccess:()=>{t.invalidateQueries({queryKey:rc})}})}function eZ(){const t=Le();return Ie({mutationFn:({id:e,permissions:n})=>rW(e,n),onSuccess:()=>{t.invalidateQueries({queryKey:rc})}})}function tZ(){const t=Le();return Ie({mutationFn:({id:e,input:n})=>tW(e,n),onSuccess:()=>{t.invalidateQueries({queryKey:rc})}})}function nZ({isOpen:t,userName:e,token:n,onClose:r}){const s=C.useRef(null),{t:i}=ke("settings"),{showToast:o}=mt(),[l,d]=C.useState([]),[f,p]=C.useState(null),g=C.useMemo(()=>l.map(S=>({value:S.address,label:`${S.name} - ${S.address}`})),[l]);C.useEffect(()=>{t&&lW().then(S=>{d(S),S.length>0&&!f&&p(S[0])}).catch(()=>{d([])})},[t,f]);const y=t?f?oW(n,f.address):aW(n):null,{qrDataUrl:m,isLoading:b}=JJ(y);C.useEffect(()=>{const S=s.current;S&&(t?S.showModal():S.close())},[t]);const v=async()=>{y&&(await navigator.clipboard.writeText(y),o(i("sections.users.toast.urlCopied"),"success"))},w=S=>{S.target===s.current&&r()};return u.jsx("dialog",{ref:s,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:r,onClick:w,children:u.jsxs("div",{className:"p-6 min-w-[350px] max-w-md",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:i("sections.users.modals.qrCode.title")}),u.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:u.jsx(nt,{size:20})})]}),u.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:[i("sections.users.modals.qrCode.userName"),":"," ",u.jsx("strong",{children:e})]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:i("sections.users.modals.qrCode.description")}),l.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("sections.users.modals.qrCode.networkInterface")}),u.jsx(Mn,{options:g,value:f?.address??null,onChange:S=>p(l.find(T=>T.address===S)??null),allowClear:!1})]}),u.jsx("div",{className:"flex justify-center mb-4 bg-white p-4 rounded-lg",children:b?u.jsx("div",{className:"w-64 h-64 flex items-center justify-center",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):m?u.jsx("img",{src:m,alt:"QR Code",className:"rounded-lg"}):null}),u.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3 mb-4",children:u.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:i("sections.users.modals.qrCode.warning")})}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:i("sections.users.modals.qrCode.manualUrl")}),u.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 dark:bg-gray-700 rounded-lg p-2",children:[u.jsx("code",{className:"text-xs flex-1 break-all text-gray-800 dark:text-gray-200",children:y}),u.jsx("button",{onClick:v,className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded",title:i("sections.users.actions.copyUrl"),children:u.jsx(td,{size:16,className:"text-gray-600 dark:text-gray-400"})})]}),u.jsx("div",{className:"flex justify-end mt-6",children:u.jsx("button",{onClick:r,className:`px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg
              transition-colors`,children:i("sections.users.modals.qrCode.done")})})]})})}function rZ(){const{t}=ke("settings"),{showToast:e}=mt(),{data:n,isLoading:r,error:s}=TJ(),i=jJ(),o=tZ(),l=EJ(),d=eZ(),f=ZJ(),[p,g]=C.useState({type:"none"}),y=C.useRef(null);C.useEffect(()=>{const j=y.current;j&&(p.type==="create"||p.type==="edit"?j.showModal():j.close())},[p.type]);const m=async j=>{try{const M=await i.mutateAsync(j);g({type:"qr",user:M.user}),e(t("sections.users.toast.created"),"success")}catch{e(t("sections.users.toast.error"),"error")}},b=async j=>{if(p.type==="edit")try{await o.mutateAsync({id:p.user.id,input:{name:j.name}}),await d.mutateAsync({id:p.user.id,permissions:j.permissions}),g({type:"none"}),e(t("sections.users.toast.updated"),"success")}catch{e(t("sections.users.toast.error"),"error")}},v=async()=>{if(p.type==="delete")try{await l.mutateAsync(p.user.id),g({type:"none"}),e(t("sections.users.toast.deleted"),"success")}catch{e(t("sections.users.toast.error"),"error")}},w=async()=>{if(p.type==="regenerate")try{const j=await f.mutateAsync(p.user.id);g({type:"qr",user:j.user}),e(t("sections.users.toast.tokenRegenerated"),"success")}catch{e(t("sections.users.toast.error"),"error")}},S=async j=>{try{await o.mutateAsync({id:j.id,input:{isActive:!j.isActive}}),e(t("sections.users.toast.updated"),"success")}catch{e(t("sections.users.toast.error"),"error")}},T=j=>{g({type:"qr",user:j})};return r?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s?u.jsx("div",{className:"text-center py-8 text-red-500",children:t("sections.users.toast.error")}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t("sections.users.title")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("sections.users.description")})]}),u.jsxs("button",{onClick:()=>g({type:"create"}),className:`flex items-center gap-2 px-3 py-2 bg-indigo-600 hover:bg-indigo-700
            text-white rounded-lg transition-colors text-sm`,children:[u.jsx(Xt,{size:16}),t("sections.users.addUser")]})]}),n&&n.length>0?u.jsx("div",{className:"grid gap-3",children:n.map(j=>u.jsx(SJ,{user:j,onEdit:M=>g({type:"edit",user:M}),onDelete:M=>g({type:"delete",user:M}),onShowQR:T,onRegenerateToken:M=>g({type:"regenerate",user:M}),onToggleActive:S},j.id))}):u.jsxs("div",{className:"text-center py-12 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx(Bl,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:t("sections.users.noUsers")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:t("sections.users.noUsersDescription")})]}),u.jsx("dialog",{ref:y,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-lg w-full max-h-[90vh] overflow-y-auto",onClose:()=>g({type:"none"}),onClick:j=>{j.target===y.current&&g({type:"none"})},children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:p.type==="create"?t("sections.users.modals.create.title"):t("sections.users.modals.edit.title")}),u.jsx("button",{onClick:()=>g({type:"none"}),className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:u.jsx(nt,{size:20})})]}),u.jsx(NJ,{user:p.type==="edit"?p.user:void 0,onSubmit:p.type==="create"?m:b,onCancel:()=>g({type:"none"}),isLoading:i.isPending||o.isPending},p.type==="edit"?p.user.id:"create")]})}),p.type==="qr"&&u.jsx(nZ,{isOpen:!0,userName:p.user.name,token:p.user.token,onClose:()=>g({type:"none"})}),p.type==="delete"&&u.jsx(di,{isOpen:!0,title:t("sections.users.modals.delete.title"),message:t("sections.users.modals.delete.message",{name:p.user.name}),confirmLabel:t("sections.users.modals.delete.confirm"),cancelLabel:t("sections.users.modals.cancel"),onConfirm:v,onCancel:()=>g({type:"none"}),variant:"danger"}),p.type==="regenerate"&&u.jsx(di,{isOpen:!0,title:t("sections.users.modals.regenerate.title"),message:t("sections.users.modals.regenerate.message",{name:p.user.name}),confirmLabel:t("sections.users.modals.regenerate.confirm"),cancelLabel:t("sections.users.modals.cancel"),onConfirm:w,onCancel:()=>g({type:"none"})})]})}const sZ=Rn("/settings/")({component:iZ});function iZ(){const{t}=ke("settings"),{preference:e,setLanguagePreference:n,isLoading:r}=JQ(),{preference:s,setThemePreference:i,isLoading:o}=pW(),l=[{value:"system",label:t("sections.language.options.system")},{value:"en",label:t("sections.language.options.english")},{value:"ro",label:t("sections.language.options.romanian")}],d=[{value:"system",label:t("sections.theme.options.system")},{value:"light",label:t("sections.theme.options.light")},{value:"dark",label:t("sections.theme.options.dark")}];return u.jsx(fd,{permission:"settings.view",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:t("title")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:t("sections.application.description")})]}),u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800 space-y-6",children:u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:t("sections.appearance.title")}),u.jsxs("div",{className:"space-y-2 mb-6",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(sI,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}),u.jsx("label",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t("sections.language.title")})]}),u.jsx(Mn,{options:l,value:e,onChange:f=>n(f),disabled:r,allowClear:!1}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-xs",children:t("sections.language.description")})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Fj,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}),u.jsx("label",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t("sections.theme.title")})]}),u.jsx(Mn,{options:d,value:s,onChange:f=>i(f),disabled:o,allowClear:!1}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-xs",children:t("sections.theme.description")})]})]})}),oo()&&u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800",children:u.jsx(pL,{})}),u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800",children:u.jsx(zK,{})}),u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800",children:u.jsx(BW,{})}),u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800",children:u.jsx(rZ,{})}),u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800",children:u.jsx(AE,{children:u.jsx(Bz,{})})}),u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800 space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.apiDocs.title")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:t("sections.apiDocs.description")})]}),u.jsxs("a",{href:"http://localhost:3000/api/docs",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-indigo-600 dark:text-indigo-400 hover:underline text-sm",children:[u.jsx(Dp,{className:"w-4 h-4"}),t("sections.apiDocs.link")]})]}),T2()&&u.jsxs(u.Fragment,{children:[u.jsx("hr",{className:"border-gray-200 dark:border-gray-700"}),u.jsx(wJ,{})]}),T2()&&u.jsxs(u.Fragment,{children:[u.jsx("hr",{className:"border-gray-200 dark:border-gray-700"}),u.jsx(vJ,{})]})]})]})})}const aZ=Rn("/schedules/")({component:oZ});function oZ(){const{t}=ke("schedules"),e=ar(),n=r=>{e({to:"/schedules/$scheduleId",params:{scheduleId:String(r)}})};return u.jsx(fd,{permission:"programs.view",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:t("title")}),u.jsxs("button",{type:"button",onClick:()=>e({to:"/schedules/$scheduleId",params:{scheduleId:"new"}}),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors",children:[u.jsx(Xt,{className:"w-5 h-5"}),t("actions.create")]})]}),u.jsx(Qv,{onScheduleClick:n})]})})}const lZ=Rn("/present/")({component:cZ});function cZ(){return u.jsx(fd,{permission:"control_room.view",children:u.jsx("div",{className:"h-full",children:u.jsx(xK,{})})})}const uZ={top:"bottom-full left-1/2 -translate-x-1/2 mb-2",bottom:"top-full left-1/2 -translate-x-1/2 mt-2",left:"right-full top-1/2 -translate-y-1/2 mr-2",right:"left-full top-1/2 -translate-y-1/2 ml-2"},dZ={top:"top-full left-1/2 -translate-x-1/2 border-t-gray-900 dark:border-t-gray-100 border-x-transparent border-b-transparent",bottom:"bottom-full left-1/2 -translate-x-1/2 border-b-gray-900 dark:border-b-gray-100 border-x-transparent border-t-transparent",left:"left-full top-1/2 -translate-y-1/2 border-l-gray-900 dark:border-l-gray-100 border-y-transparent border-r-transparent",right:"right-full top-1/2 -translate-y-1/2 border-r-gray-900 dark:border-r-gray-100 border-y-transparent border-l-transparent"};function Jy({content:t,children:e,position:n="top"}){const[r,s]=C.useState(!1);return u.jsxs("div",{className:"relative inline-flex",onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:[e,r&&u.jsxs("div",{className:`absolute z-50 pointer-events-none ${uZ[n]}`,children:[u.jsx("div",{className:"px-2 py-1 text-xs font-medium text-white dark:text-gray-900 bg-gray-900 dark:bg-gray-100 rounded shadow-lg whitespace-nowrap",children:t}),u.jsx("div",{className:`absolute w-0 h-0 border-4 ${dZ[n]}`})]})]})}function fZ({className:t}){return u.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})})}function hZ({className:t}){return u.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z"})})}function pZ({className:t}){return u.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),u.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})}function gZ({className:t}){return u.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("polyline",{points:"20 6 9 17 4 12"})})}function mZ({progress:t,t:e}){return t.step==="error"?u.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("span",{className:"text-sm text-red-600 dark:text-red-400",children:t.error||e("errors.startStreamFailed")})})}):t.step==="completed"?null:u.jsx("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e(`stream.progress.${t.step}`)}),u.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.progress,"%"]})]}),u.jsx("div",{className:"w-full h-2 bg-gray-300 dark:bg-gray-700 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-blue-600 dark:bg-blue-400 transition-all duration-300",style:{width:`${t.progress}%`}})}),u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:t.message})]})})}function yZ(){const{t}=ke("livestream"),{activeBroadcast:e,isLoadingBroadcast:n,isStopping:r,streamStartProgress:s}=Lp(),{isStreaming:i}=Ob(),{message:o,fetchMessage:l,copyMessage:d,copied:f,isLoading:p}=gz();if(C.useEffect(()=>{e?.url&&!o&&!p&&l(e.url).catch(()=>{})},[e?.url]),s&&s.step!=="completed")return u.jsx(mZ,{progress:s,t});if(n)return u.jsx("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:u.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t("broadcast.loading")})});if(!e||!i||r)return null;const g=o||e.url,m=(v=>{const w=v.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&]+)/);return w?w[1]:null})(e.url),b=m?`https://studio.youtube.com/video/${m}/livestreaming`:null;return u.jsx("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:"relative flex-1 px-3 py-2 pr-10 text-sm bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg whitespace-pre-wrap break-words",children:[g,u.jsx(Jy,{content:t(f?"broadcast.copied":"broadcast.copyToClipboard"),position:"left",children:u.jsx("button",{type:"button",onClick:()=>d(e.url),disabled:p,className:"absolute right-2 top-2 p-1.5 rounded-md text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?u.jsx(gZ,{className:"w-4 h-4 text-green-500"}):u.jsx(pZ,{className:"w-4 h-4"})})})]}),u.jsxs("div",{className:"flex gap-2 shrink-0",children:[u.jsx(Jy,{content:t("broadcast.watchLive"),position:"bottom",children:u.jsx(it,{variant:"ghost",size:"icon",onClick:()=>gx(e.url),className:"text-red-600 hover:text-red-700 dark:text-red-500 dark:hover:text-red-400",children:u.jsx(fZ,{className:"w-5 h-5"})})}),b&&u.jsx(Jy,{content:t("broadcast.openStudio"),position:"bottom",children:u.jsx(it,{variant:"ghost",size:"icon",onClick:()=>gx(b),className:"text-gray-600 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:u.jsx(hZ,{className:"w-5 h-5"})})})]})]})})}const xZ=[8,16,24,32];function bZ({isOpen:t,onClose:e}){const{t:n}=ke("livestream"),r=C.useRef(null),{config:s,update:i,isUpdating:o,testConnection:l,isTesting:d}=_b(),{channels:f,update:p,isUpdating:g}=NE(),[y,m]=C.useState(""),[b,v]=C.useState(10024),[w,S]=C.useState(16),[T,j]=C.useState({}),[M,_]=C.useState("idle");C.useEffect(()=>{s&&(m(s.host),v(s.port),S(s.channelCount))},[s]),C.useEffect(()=>{const F={};for(const H of f)F[H.channelNumber]=H.label;j(F)},[f]),C.useEffect(()=>{const F=r.current;F&&(t?F.showModal():F.close())},[t]);const R=F=>{F.target===r.current&&e()},O=async()=>{_("idle");try{const F=await l();_(F.success?"success":"error")}catch{_("error")}},L=(F,H)=>{j(P=>({...P,[F]:H}))},A=async()=>{i({host:y,port:b,isEnabled:s?.isEnabled??!1,channelCount:w});const F=Object.entries(T).filter(([,H])=>H.trim()!=="").map(([H,P])=>({channelNumber:Number.parseInt(H,10),label:P.trim()}));F.length>0&&p(F),e()};return u.jsx("dialog",{ref:r,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-lg w-full",onClose:e,onClick:R,children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n("mixer.setup.title")}),u.jsx("button",{type:"button",onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"space-y-6 max-h-[60vh] overflow-y-auto",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:n("mixer.setup.connectionSettings")}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-600 dark:text-gray-400 mb-1",children:n("mixer.setup.host")}),u.jsx("input",{type:"text",value:y,onChange:F=>m(F.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"192.168.0.50"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-600 dark:text-gray-400 mb-1",children:n("mixer.setup.port")}),u.jsx("input",{type:"number",value:b,onChange:F=>v(Number.parseInt(F.target.value,10)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"10024"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(it,{variant:"secondary",size:"sm",onClick:O,disabled:d||!y,children:n(d?"mixer.setup.testing":"mixer.setup.testConnection")}),M==="success"&&u.jsx("span",{className:"text-sm text-green-600 dark:text-green-400",children:n("mixer.setup.testSuccess")}),M==="error"&&u.jsx("span",{className:"text-sm text-red-600 dark:text-red-400",children:n("mixer.setup.testFailed")})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:n("mixer.setup.channelConfiguration")}),u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{className:"block text-sm text-gray-600 dark:text-gray-400 mb-1",children:n("mixer.setup.channelCount")}),u.jsx("select",{value:w,onChange:F=>S(Number.parseInt(F.target.value,10)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:xZ.map(F=>u.jsx("option",{value:F,children:F},F))})]}),u.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:Array.from({length:w},(F,H)=>H+1).map(F=>u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("span",{className:"w-8 text-sm text-gray-500 dark:text-gray-400 text-right",children:[F.toString().padStart(2,"0"),":"]}),u.jsx("input",{type:"text",value:T[F]||"",onChange:H=>L(F,H.target.value),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:`CH${F.toString().padStart(2,"0")}`})]},F))})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx(it,{variant:"ghost",onClick:e,children:n("common:buttons.cancel","Cancel")}),u.jsx(it,{onClick:A,disabled:o||g,children:n("mixer.setup.save")})]})]})})}const vZ=5e3,wZ=1e3;function SZ(){const{t}=ke("livestream"),{config:e,update:n,isUpdating:r,testConnection:s,isTesting:i}=_b(),[o,l]=C.useState(!1),[d,f]=C.useState(!1),[p,g]=C.useState("idle"),[y,m]=C.useState(!1),[b,v]=C.useState(!1),w=C.useRef(null),S=C.useRef(null),T=C.useRef(null),j=e?.isEnabled??!1,M=r||i||b&&!y;C.useEffect(()=>{if(!o)return;const B=E=>{w.current&&!w.current.contains(E.target)&&S.current&&!S.current.contains(E.target)&&l(!1)};return document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[o]),C.useEffect(()=>{if(!o)return;const B=E=>{E.key==="Escape"&&l(!1)};return document.addEventListener("keydown",B),()=>document.removeEventListener("keydown",B)},[o]);const _=C.useRef(!1),R=C.useRef(!1);C.useEffect(()=>{R.current=y},[y]);const O=C.useCallback(async()=>{if(!(!e?.host||_.current)){_.current=!0,R.current||v(!0);try{const B=await CE();B.success!==R.current&&m(B.success)}catch{R.current&&m(!1)}finally{_.current=!1,R.current||v(!1)}}},[e?.host]);C.useEffect(()=>{if(!j||!e?.host){R.current&&m(!1),T.current&&(clearTimeout(T.current),T.current=null);return}let B=!0;const E=async()=>{if(!B||(await O(),!B))return;const K=R.current?vZ:wZ;T.current=setTimeout(E,K)};return E(),()=>{B=!1,T.current&&(clearTimeout(T.current),T.current=null)}},[j,e?.host,O]);function L(){M||l(!o)}function A(){l(!1),f(!0)}async function F(){g("idle");try{const B=await s();g(B.success?"success":"error"),setTimeout(()=>g("idle"),3e3)}catch{g("error"),setTimeout(()=>g("idle"),3e3)}}function H(){e&&(n({...e,isEnabled:!e.isEnabled}),l(!1))}function P(){return i||b&&!y?t("mixer.testing"):j&&y?t("mixer.connected").replace("Mixer ",""):j&&!y?t("mixer.reconnecting"):t("mixer.disconnected").replace("Mixer ","")}return u.jsxs("div",{className:"relative",children:[u.jsxs("button",{ref:S,type:"button",onClick:L,disabled:M,className:`
          inline-flex items-center gap-1.5 sm:gap-2 px-2 py-1 sm:px-3 sm:py-1.5 rounded-full text-sm font-medium
          transition-all duration-200 ease-in-out
          ${y?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-900/50":j&&!y?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":i?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 cursor-wait":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}
          ${M?"opacity-75 cursor-wait":"cursor-pointer"}
        `,children:[u.jsxs("div",{className:"relative flex items-center gap-1.5 sm:gap-2",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})}),u.jsx("span",{className:"font-medium",children:t("mixer.title")})]}),u.jsx("span",{className:"text-xs opacity-75 hidden sm:inline",children:P()}),(i||j&&!y)&&u.jsx("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"})]}),o&&u.jsxs("div",{ref:w,className:"absolute left-0 top-full mt-2 z-50 min-w-[140px] bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-1.5 space-y-1",children:[u.jsxs("button",{type:"button",onClick:A,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),t("mixer.setup.title")]}),e?.host&&u.jsxs("button",{type:"button",onClick:F,disabled:i,className:`w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left rounded-lg transition-colors ${p==="success"?"text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20":p==="error"?"text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p==="success"?u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}):p==="error"?u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"})}),t(i?"mixer.setup.testing":p==="success"?"mixer.setup.testSuccess":p==="error"?"mixer.setup.testFailed":"mixer.setup.testConnection")]}),u.jsxs("button",{type:"button",onClick:H,disabled:r||!e?.host,className:`w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left rounded-lg transition-colors ${e?.host?j?"text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20":"text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20":"text-gray-400 dark:text-gray-500 cursor-not-allowed"}`,children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j?u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"}):u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.636 18.364a9 9 0 010-12.728m12.728 0a9 9 0 010 12.728M12 9v2m0 4h.01"})}),t(j?"mixer.disable":"mixer.enable")]})]}),u.jsx(bZ,{isOpen:d,onClose:()=>f(!1)})]})}function kZ(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let n=0;n<16;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}function CZ({isOpen:t,onClose:e}){const{t:n}=ke("livestream"),r=C.useRef(null),{config:s,update:i,isUpdating:o}=vz(),[l,d]=C.useState(!1),f=C.useMemo(()=>kZ(),[]),p=s?.password||f;C.useEffect(()=>{const b=r.current;b&&(t?b.showModal():b.close())},[t]);const g=b=>{b.target===r.current&&e()},y=async()=>{await navigator.clipboard.writeText(p),d(!0),setTimeout(()=>d(!1),2e3)},m=()=>{s?.password||i({host:s?.host||"localhost",port:s?.port||4455,password:f,autoConnect:s?.autoConnect??!0}),e()};return u.jsx("dialog",{ref:r,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-lg w-full",onClose:e,onClick:g,children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n("obs.setup.title")}),u.jsx("button",{type:"button",onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:n("obs.setup.step1Title")}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:n("obs.setup.step1Description")}),u.jsxs("a",{href:"https://github.com/obsproject/obs-websocket/releases",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-indigo-600 dark:text-indigo-400 hover:underline text-sm",children:[u.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"})}),n("obs.setup.downloadLink")]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:n("obs.setup.step2Title")}),u.jsxs("ol",{className:"text-sm text-gray-600 dark:text-gray-400 list-decimal list-inside space-y-1",children:[u.jsx("li",{children:n("obs.setup.step2Instruction1")}),u.jsx("li",{children:n("obs.setup.step2Instruction2")}),u.jsx("li",{children:n("obs.setup.step2Instruction3")})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:n("obs.setup.step3Title")}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:n("obs.setup.step3Description")}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("code",{className:"flex-1 px-3 py-2 bg-gray-100 dark:bg-gray-700 rounded text-sm font-mono text-gray-900 dark:text-gray-100 break-all",children:p}),u.jsx(it,{variant:"secondary",size:"sm",onClick:y,children:n(l?"obs.setup.copied":"obs.setup.copy")})]})]}),u.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:u.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[u.jsx("strong",{children:n("obs.setup.noteTitle")})," ",n("obs.setup.noteDescription")]})})]}),u.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx(it,{variant:"ghost",onClick:e,children:n("common:buttons.cancel","Cancel")}),u.jsx(it,{onClick:m,disabled:o,children:n("obs.setup.saveAndClose")})]})]})})}function NZ(){const{t}=ke("livestream"),{isConnected:e,isConnecting:n,isDisconnecting:r,connect:s,disconnect:i}=Ob(),[o,l]=C.useState(!1),[d,f]=C.useState(!1),p=C.useRef(null),g=C.useRef(null),y=n||r;C.useEffect(()=>{if(!d)return;const S=T=>{p.current&&!p.current.contains(T.target)&&g.current&&!g.current.contains(T.target)&&f(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[d]),C.useEffect(()=>{if(!d)return;const S=T=>{T.key==="Escape"&&f(!1)};return document.addEventListener("keydown",S),()=>document.removeEventListener("keydown",S)},[d]);function m(){y||f(!d)}function b(){f(!1),s()}function v(){f(!1),i()}function w(){f(!1),l(!0)}return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"relative",children:[u.jsxs("button",{ref:g,type:"button",onClick:m,disabled:y,className:`
            inline-flex items-center gap-1.5 sm:gap-2 px-2 py-1 sm:px-3 sm:py-1.5 rounded-full text-sm font-medium
            transition-all duration-200 ease-in-out
            ${e?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-900/50":n?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 cursor-wait":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}
            ${y?"opacity-75 cursor-wait":"cursor-pointer"}
          `,children:[u.jsxs("div",{className:"relative flex items-center gap-1.5 sm:gap-2",children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${e?"bg-green-500":n?"bg-yellow-500 animate-pulse":"bg-gray-400 dark:bg-gray-500"}`}),u.jsxs("span",{className:"font-medium",children:[u.jsx("span",{className:"sm:hidden",children:"OBS"}),u.jsx("span",{className:"hidden sm:inline",children:"OBS Studio"})]})]}),u.jsx("span",{className:"text-xs opacity-75 hidden sm:inline",children:n?t("obs.connecting"):r?t("obs.disconnect")+"...":e?t("obs.connected").replace("OBS ",""):t("obs.disconnected").replace("OBS ","")})]}),d&&u.jsx("div",{ref:p,className:"absolute left-0 top-full mt-2 z-50 min-w-[140px] bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-1.5 space-y-1",children:e?u.jsxs("button",{type:"button",onClick:v,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),t("obs.disconnect")]}):u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:b,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),t("obs.connect")]}),u.jsxs("button",{type:"button",onClick:w,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t("obs.openGuide")]})]})})]}),u.jsx(CZ,{isOpen:o,onClose:()=>l(!1)})]})}function TZ({scene:t,onSwitch:e}){const{t:n}=ke("livestream");return u.jsxs("div",{className:`
        relative p-4 rounded-lg border-2 transition-all cursor-pointer
        ${t.isCurrent?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-gray-300 dark:hover:border-gray-600"}
      `,onClick:()=>e(t.obsSceneName),children:[t.isCurrent&&u.jsx("div",{className:"absolute -top-2 -right-2 px-2 py-0.5 text-xs font-bold text-white bg-indigo-500 rounded-full",children:n("scenes.current")}),u.jsx("div",{children:u.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:t.displayName})})]})}function jZ({scene:t,onOpenSettings:e}){const{t:n}=ke("livestream"),{attributes:r,listeners:s,setNodeRef:i,transform:o,transition:l,isDragging:d}=xo({id:t.id}),f={transform:cs.Transform.toString(o),transition:l,opacity:d?.5:1},p=t.shortcuts&&t.shortcuts.length>0;return u.jsxs("div",{ref:i,style:f,className:`
        flex items-center gap-3 p-3 bg-white dark:bg-gray-800
        border border-gray-200 dark:border-gray-700 rounded-lg
        ${d?"shadow-lg ring-2 ring-indigo-500":""}
        ${t.isVisible?"":"opacity-60"}
      `,children:[u.jsx("button",{type:"button",className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 cursor-grab active:cursor-grabbing",...r,...s,children:u.jsx(or,{size:20})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate block",children:t.displayName}),u.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.displayName!==t.obsSceneName&&u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:t.obsSceneName}),p&&u.jsx("div",{className:"flex flex-wrap gap-1",children:t.shortcuts.map(g=>u.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded",children:OE(g)},g))})]})]}),u.jsx("button",{type:"button",onClick:e,className:"p-2 text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 rounded-lg transition-colors",title:n("scenes.settings"),children:u.jsx(ui,{size:18})})]})}const HT=[{value:"song",labelKey:"scenes.contentTypes.song"},{value:"bible",labelKey:"scenes.contentTypes.bible"},{value:"bible_passage",labelKey:"scenes.contentTypes.biblePassage"},{value:"announcement",labelKey:"scenes.contentTypes.announcement"},{value:"versete_tineri",labelKey:"scenes.contentTypes.verseteTineri"},{value:"empty",labelKey:"scenes.contentTypes.empty"}];function VT(t,e,n){for(const r of n)if(r.id!==e&&r.shortcuts?.includes(t))return{shortcut:t,conflictingSceneName:r.displayName};return null}function EZ({scene:t,allScenes:e,youtubeConfig:n,onUpdateYouTubeConfig:r,onClose:s,onSave:i}){const{t:o}=ke("livestream"),{config:l}=_b(),{channels:d}=NE(),f=Array.from({length:l?.channelCount??0},(X,I)=>{const U=I+1,te=d.find(Z=>Z.channelNumber===U);return{channelNumber:U,label:te?.label||""}}),[p,g]=C.useState(t.displayName),[y,m]=C.useState(t.isVisible),[b,v]=C.useState(t.shortcuts||[]),[w,S]=C.useState(t.contentTypes||[]),[T,j]=C.useState(t.mixerChannelActions?.mute||[]),[M,_]=C.useState(t.mixerChannelActions?.unmute||[]),[R,O]=C.useState({}),L=C.useCallback(()=>{v(X=>[...X,""])},[]),A=C.useCallback(X=>{v(I=>I.filter((U,te)=>te!==X)),O(I=>{const U={...I};return delete U[X],U})},[]),F=C.useCallback((X,I)=>{const U=[...b];U[X]=I,v(U);const te=VT(I,t.id,e);O(te?Z=>({...Z,[X]:o("scenes.shortcutConflict",{scene:te.conflictingSceneName})}):Z=>{const re={...Z};return delete re[X],re})},[b,t.id,e,o]),H=C.useCallback(()=>{const X=b.filter(U=>U.length>0);let I=!1;for(const U of X)if(VT(U,t.id,e)){I=!0;break}I||i({displayName:p.trim()||t.obsSceneName,isVisible:y,shortcuts:X,contentTypes:w,mixerChannelActions:{mute:T,unmute:M}})},[p,y,b,w,T,M,t,e,i]),P=n?.startSceneName===t.obsSceneName,B=n?.stopSceneName===t.obsSceneName,E=C.useCallback(()=>{r&&r(P?{startSceneName:null}:{startSceneName:t.obsSceneName,...B&&{stopSceneName:null}})},[P,B,t.obsSceneName,r]),K=C.useCallback(()=>{r&&r(B?{stopSceneName:null}:{stopSceneName:t.obsSceneName,...P&&{startSceneName:null}})},[P,B,t.obsSceneName,r]),q=C.useCallback(X=>{S(I=>I.includes(X)?I.filter(U=>U!==X):[...I,X])},[]),V=C.useCallback(X=>{j(I=>I.includes(X)?I.filter(U=>U!==X):[...I,X]),_(I=>I.filter(U=>U!==X))},[]),ie=C.useCallback(X=>{_(I=>I.includes(X)?I.filter(U=>U!==X):[...I,X]),j(I=>I.filter(U=>U!==X))},[]),Y=Object.keys(R).length>0;return u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/50",onClick:X=>X.target===X.currentTarget&&s(),children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md mx-4 max-h-[80vh] flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:o("scenes.sceneSettings",{defaultValue:"Scene Settings"})}),u.jsx("button",{type:"button",onClick:s,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:u.jsx(nt,{size:20})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o("scenes.displayName")}),u.jsx("input",{id:"displayName",type:"text",value:p,onChange:X=>g(X.target.value),placeholder:t.obsSceneName,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500"}),t.displayName!==t.obsSceneName&&u.jsxs("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["OBS: ",t.obsSceneName]})]}),u.jsx("div",{children:u.jsxs("button",{type:"button",onClick:()=>m(!y),className:`
                flex items-center gap-3 w-full px-3 py-2 rounded-lg transition-colors
                ${y?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}
              `,children:[y?u.jsx(ua,{size:20}):u.jsx(Wl,{size:20}),u.jsx("span",{className:"text-sm font-medium",children:o(y?"scenes.visible":"scenes.hidden")})]})}),u.jsxs("div",{children:[u.jsx("div",{className:"flex items-center justify-between mb-2",children:u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:o("scenes.shortcuts")})}),b.length===0?u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:o("scenes.noShortcuts")}):u.jsx("div",{className:"space-y-2 mb-2",children:b.map((X,I)=>u.jsxs("div",{children:[u.jsx(DE,{value:X,onChange:U=>F(I,U),onRemove:()=>A(I),error:R[I],namespace:"livestream"}),R[I]&&u.jsx("p",{className:"mt-1 text-xs text-red-500",children:R[I]})]},I))}),u.jsxs("button",{type:"button",onClick:L,className:"flex items-center gap-2 text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300",children:[u.jsx(Xt,{size:16}),o("scenes.addShortcut")]})]}),n&&r&&u.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:o("scenes.streamSceneSettings")}),u.jsxs("button",{type:"button",onClick:E,className:`
                  flex items-center gap-3 w-full px-3 py-2 rounded-lg transition-colors mb-2
                  ${P?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}
                `,children:[u.jsx(kb,{size:20}),u.jsxs("div",{className:"flex-1 text-left",children:[u.jsx("span",{className:"text-sm font-medium block",children:o("scenes.useAsStartScene")}),u.jsx("span",{className:"text-xs opacity-75",children:o("scenes.useAsStartSceneDescription")})]})]}),u.jsxs("button",{type:"button",onClick:K,className:`
                  flex items-center gap-3 w-full px-3 py-2 rounded-lg transition-colors
                  ${B?"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}
                `,children:[u.jsx(Vj,{size:20}),u.jsxs("div",{className:"flex-1 text-left",children:[u.jsx("span",{className:"text-sm font-medium block",children:o("scenes.useAsStopScene")}),u.jsx("span",{className:"text-xs opacity-75",children:o("scenes.useAsStopSceneDescription")})]})]})]}),u.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o("scenes.autoSceneSettings")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:o("scenes.autoSceneDescription")}),u.jsxs("div",{className:"flex flex-wrap gap-1.5 min-h-[36px] p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700",children:[w.map(X=>{const I=HT.find(U=>U.value===X);return u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-400 rounded-full",children:[I?o(I.labelKey):X,u.jsx("button",{type:"button",onClick:()=>q(X),className:"hover:text-indigo-900 dark:hover:text-indigo-200",children:u.jsx(nt,{size:12})})]},X)}),u.jsxs("select",{value:"",onChange:X=>{X.target.value&&q(X.target.value)},className:"flex-1 min-w-[100px] text-sm bg-transparent border-none outline-none text-gray-500 dark:text-gray-400 cursor-pointer",children:[u.jsx("option",{value:"",children:w.length===0?o("scenes.selectContentTypes"):o("scenes.addMore")}),HT.filter(X=>!w.includes(X.value)).map(({value:X,labelKey:I})=>u.jsx("option",{value:X,children:o(I)},X))]})]})]}),f.length>0&&u.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o("scenes.mixerActions")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:o("scenes.mixerActionsDescription")}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(x6,{size:16,className:"text-green-600 dark:text-green-400"}),u.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:o("scenes.unmute")})]}),u.jsxs("div",{className:"flex flex-wrap gap-1.5 min-h-[36px] p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700",children:[M.map(X=>{const I=f.find(U=>U.channelNumber.toString().padStart(2,"0")===X);return u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-full",children:[I?.label||`CH${X}`,u.jsx("button",{type:"button",onClick:()=>ie(X),className:"hover:text-green-900 dark:hover:text-green-200",children:u.jsx(nt,{size:12})})]},X)}),u.jsxs("select",{value:"",onChange:X=>{X.target.value&&ie(X.target.value)},className:"flex-1 min-w-[100px] text-sm bg-transparent border-none outline-none text-gray-500 dark:text-gray-400 cursor-pointer",children:[u.jsx("option",{value:"",children:M.length===0?o("scenes.selectChannels"):o("scenes.addMore")}),f.filter(X=>!M.includes(X.channelNumber.toString().padStart(2,"0"))).map(X=>{const I=X.channelNumber.toString().padStart(2,"0");return u.jsx("option",{value:I,children:X.label||`CH${I}`},I)})]})]})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(v6,{size:16,className:"text-red-600 dark:text-red-400"}),u.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:o("scenes.mute")})]}),u.jsxs("div",{className:"flex flex-wrap gap-1.5 min-h-[36px] p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700",children:[T.map(X=>{const I=f.find(U=>U.channelNumber.toString().padStart(2,"0")===X);return u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-full",children:[I?.label||`CH${X}`,u.jsx("button",{type:"button",onClick:()=>V(X),className:"hover:text-red-900 dark:hover:text-red-200",children:u.jsx(nt,{size:12})})]},X)}),u.jsxs("select",{value:"",onChange:X=>{X.target.value&&V(X.target.value)},className:"flex-1 min-w-[100px] text-sm bg-transparent border-none outline-none text-gray-500 dark:text-gray-400 cursor-pointer",children:[u.jsx("option",{value:"",children:T.length===0?o("scenes.selectChannels"):o("scenes.addMore")}),f.filter(X=>!T.includes(X.channelNumber.toString().padStart(2,"0"))).map(X=>{const I=X.channelNumber.toString().padStart(2,"0");return u.jsx("option",{value:I,children:X.label||`CH${I}`},I)})]})]})]})]})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:o("common:buttons.cancel",{defaultValue:"Cancel"})}),u.jsx("button",{type:"button",onClick:H,disabled:Y,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 disabled:cursor-not-allowed rounded-lg transition-colors",children:o("common:buttons.save",{defaultValue:"Save"})})]})]})})}function MZ({scenes:t,onClose:e,onReorder:n,onUpdateScene:r}){const{t:s}=ke("livestream"),[i,o]=C.useState(null),{config:l,update:d}=Ib(),f=ho(sr(pi),sr(hi,{coordinateGetter:bo})),p=C.useCallback(b=>{const{active:v,over:w}=b;if(w&&v.id!==w.id){const S=t.findIndex(M=>M.id===v.id),T=t.findIndex(M=>M.id===w.id),j=tc(t,S,T);n(j.map(M=>M.id))}},[t,n]),g=C.useCallback(b=>{o(b)},[]),y=C.useCallback(()=>{o(null)},[]),m=C.useCallback(b=>{i&&(r(i.id,b),o(null))},[i,r]);return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:b=>b.target===b.currentTarget&&e(),children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-lg mx-4 max-h-[80vh] flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s("scenes.settings")}),u.jsx("button",{type:"button",onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:u.jsx(nt,{size:20})})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:u.jsx(go,{sensors:f,collisionDetection:po,onDragEnd:p,children:u.jsx(yo,{items:t.map(b=>b.id),strategy:mo,children:u.jsx("div",{className:"space-y-2",children:t.map(b=>u.jsx(jZ,{scene:b,onOpenSettings:()=>g(b)},b.id))})})})})]})}),i&&u.jsx(EZ,{scene:i,allScenes:t,youtubeConfig:l,onUpdateYouTubeConfig:d,onClose:y,onSave:m})]})}function AZ(){const{t}=ke("livestream"),{scenes:e,isLoading:n,switchScene:r,reorderScenes:s,updateScene:i}=Db(),[o,l]=C.useState(!1),d=e.filter(g=>g.isVisible),f=C.useCallback(g=>{s(g)},[s]),p=C.useCallback((g,y)=>{i({id:g,data:y})},[i]);return n?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(g=>u.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"},g))}):d.length===0?u.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 rounded-lg",children:u.jsx("p",{children:"No scenes available. Connect to OBS to see scenes."})}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("scenes.title")}),u.jsx("button",{type:"button",onClick:()=>l(!0),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:t("scenes.settings"),children:u.jsx(ui,{size:20})})]}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:d.map(g=>u.jsx(TZ,{scene:g,onSwitch:r},g.id))})]}),o&&u.jsx(MZ,{scenes:e,onClose:()=>l(!1),onReorder:f,onUpdateScene:p})]})}function RZ(){const{t}=ke("livestream"),{isAuthenticated:e}=jE(),{isConnected:n,isStreaming:r}=Ob(),{start:s,stop:i,isStarting:o,isStopping:l,streamStartProgress:d}=Lp(),f=e&&n&&!r,p=n&&r,g=d&&d.step!=="completed"&&d.step!=="error";return u.jsx("div",{className:"flex items-center gap-2 sm:gap-4",children:r?u.jsx(it,{variant:"danger",size:"lg",onClick:()=>i(),disabled:!p||l,className:"text-sm sm:text-base px-3 sm:px-4",children:t(l?"stream.stopping":"stream.stopStream")}):u.jsx(it,{variant:"primary",size:"lg",onClick:()=>s(),disabled:!f||o||!!g,className:"text-sm sm:text-base px-3 sm:px-4",children:t(o||g?"stream.starting":"stream.startStream")})})}function _Z(t){return new Date(t).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}function OZ(t){switch(t){case"public":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"unlisted":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"private":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-400"}}function DZ({selectedBroadcastId:t,onSelectBroadcast:e,enabled:n=!0}){const{t:r}=ke("livestream"),{broadcasts:s,isLoading:i,refetch:o,isRefetching:l}=EE(n);return i?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"})}):u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r("youtube.setup.templateDescription")}),u.jsx(it,{variant:"ghost",size:"sm",onClick:()=>o(),disabled:l,className:"flex-shrink-0",children:l?u.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),s.length>0&&u.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:s.map(d=>u.jsx("button",{type:"button",onClick:()=>e(d),className:`w-full text-left p-3 rounded-lg border-2 transition-colors ${t===d.broadcastId?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:u.jsxs("div",{className:"flex items-start justify-between gap-2",children:[u.jsxs("div",{className:"min-w-0 flex-1",children:[u.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:d.title}),d.description&&u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5 truncate",children:d.description}),u.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:[r("youtube.setup.completedAt")," ",_Z(d.completedAt)]})]}),u.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium flex-shrink-0 ${OZ(d.privacyStatus)}`,children:r(`youtube.privacy${d.privacyStatus.charAt(0).toUpperCase()+d.privacyStatus.slice(1)}`)})]})},d.broadcastId))}),s.length===0&&u.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-800 rounded-lg p-3",children:[u.jsx("p",{className:"font-medium",children:r("youtube.setup.noTemplates")}),u.jsx("p",{className:"text-xs mt-1",children:r("youtube.setup.noTemplatesHint")})]})]})}function IZ({isOpen:t,onClose:e}){const{t:n}=ke("livestream"),r=C.useRef(null),{config:s,update:i,isUpdating:o}=Ib(),{broadcasts:l}=EE(t),[d,f]=C.useState(null),[p,g]=C.useState(null),[y,m]=C.useState(!1);C.useEffect(()=>{if(y||!s?.selectedBroadcastId||!l.length)return;const S=l.find(T=>T.broadcastId===s.selectedBroadcastId);S&&(f(S.broadcastId),g(S)),m(!0)},[s?.selectedBroadcastId,l,y]),C.useEffect(()=>{t||m(!1)},[t]);const b=S=>{f(S?.broadcastId??null),g(S),S&&i({titleTemplate:S.title,description:S.description,privacyStatus:S.privacyStatus,selectedBroadcastId:S.broadcastId})};C.useEffect(()=>{const S=r.current;S&&(t?S.showModal():S.close())},[t]);const v=S=>{S.target===r.current&&e()},w=()=>{gx("https://studio.youtube.com/channel/UC/livestreaming")};return u.jsx("dialog",{ref:r,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-lg w-full max-h-[90vh] overflow-hidden",onClose:e,onClick:v,children:u.jsxs("div",{className:"flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 pb-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n("youtube.setup.title")}),u.jsx("button",{type:"button",onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:n("youtube.setup.templateTitle")}),u.jsx(DZ,{selectedBroadcastId:d,onSelectBroadcast:b,enabled:t})]}),p&&u.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 border border-blue-200 dark:border-blue-800",children:[u.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[u.jsxs("strong",{children:[n("youtube.setup.usingTemplate"),":"]})," ",p.title]}),u.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-1",children:n("youtube.setup.usingTemplateHint")})]}),u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:n("youtube.setup.firstTimeTitle")}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:n("youtube.setup.firstTimeDescription")}),u.jsxs("button",{type:"button",onClick:w,className:"inline-flex items-center gap-2 text-red-600 dark:text-red-400 hover:underline text-sm font-medium",children:[u.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})}),n("youtube.setup.openYouTubeStudio")]})]})]}),u.jsx("div",{className:"flex justify-end gap-3 p-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:u.jsx(it,{variant:"ghost",onClick:e,disabled:o,children:n("youtube.setup.close")})})]})})}function LZ(){const{t}=ke("livestream"),{isAuthenticated:e,channelName:n,login:r,logout:s,isLoggingOut:i,isLoading:o,isAuthenticating:l}=jE(),{config:d}=Ib(),[f,p]=C.useState(!1),[g,y]=C.useState(!1),[m,b]=C.useState(e),v=C.useRef(null),w=C.useRef(null),S=o||i||l;C.useEffect(()=>{!m&&e&&!d?.selectedBroadcastId&&y(!0),b(e)},[e,m,d?.selectedBroadcastId]),C.useEffect(()=>{if(!f)return;const O=L=>{v.current&&!v.current.contains(L.target)&&w.current&&!w.current.contains(L.target)&&p(!1)};return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[f]),C.useEffect(()=>{if(!f)return;const O=L=>{L.key==="Escape"&&p(!1)};return document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)},[f]);function T(){S||p(!f)}function j(){p(!1),r()}function M(){p(!1),s()}function _(){p(!1),y(!0)}function R(){return l?t("youtube.authenticating"):i?t("youtube.loggingOut"):e&&n?n:e?t("youtube.connected").replace("{{channelName}}","").trim():t("youtube.notConnected").replace("YouTube ","")}return u.jsxs("div",{className:"relative",children:[u.jsxs("button",{ref:w,type:"button",onClick:T,disabled:S,className:`
          inline-flex items-center gap-1.5 sm:gap-2 px-2 py-1 sm:px-3 sm:py-1.5 rounded-full text-sm font-medium
          transition-all duration-200 ease-in-out
          ${e?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-900/50":l?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 cursor-wait":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}
          ${S?"opacity-75 cursor-wait":"cursor-pointer"}
        `,children:[u.jsxs("div",{className:"relative flex items-center gap-1.5 sm:gap-2",children:[u.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})}),u.jsxs("span",{className:"font-medium",children:[u.jsx("span",{className:"sm:hidden",children:"YT"}),u.jsx("span",{className:"hidden sm:inline",children:"YouTube"})]})]}),u.jsx("span",{className:"text-xs opacity-75 max-w-[120px] truncate hidden sm:inline",children:R()}),l&&u.jsx("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"})]}),f&&u.jsx("div",{ref:v,className:"absolute left-0 top-full mt-2 z-50 min-w-[140px] bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-1.5 space-y-1",children:e?u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:_,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t("youtube.openGuide")]}),u.jsxs("button",{type:"button",onClick:M,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),t("youtube.logout")]})]}):u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:j,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),t("youtube.login")]}),u.jsxs("button",{type:"button",onClick:_,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t("youtube.openGuide")]})]})}),u.jsx(IZ,{isOpen:g,onClose:()=>y(!1)})]})}function zZ(){const{t}=ke("livestream"),{isLive:e}=Lp();return kE(),u.jsxs("div",{className:"h-full overflow-auto p-4 md:p-6 space-y-4 md:space-y-6",children:[u.jsxs("div",{className:"flex flex-col gap-3 md:gap-4",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100",children:t("title")}),e&&u.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 px-1.5 sm:px-2 py-0.5 sm:py-1 bg-red-600 rounded-full animate-pulse",children:[u.jsx("div",{className:"w-1.5 sm:w-2 h-1.5 sm:h-2 bg-white rounded-full"}),u.jsx("span",{className:"text-[10px] sm:text-xs font-bold text-white",children:t("stream.isLive")})]})]}),u.jsx(RZ,{})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[u.jsx(LZ,{}),u.jsx(NZ,{}),u.jsx(SZ,{})]})]}),u.jsx(yZ,{}),u.jsx("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow",children:u.jsx(AZ,{})})]})}const PZ=Rn("/livestream/")({component:zZ}),BZ=Rn("/dashboard/")({component:FZ});function FZ(){return u.jsxs("div",{className:"space-y-6",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Dashboard"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Welcome"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Your dashboard is ready to use"})]})})]})}const UZ=Rn("/bible/")({component:$Z});function $Z(){const{t}=ke("bible"),{selectedTranslations:e,primaryTranslation:n,translations:r,isLoading:s}=Wb(),i=fP(),o=zp(),[l,d]=C.useState(!1),[f,p]=C.useState(40),[g,y]=C.useState(!1),m=C.useRef(null),b=C.useRef(!1),v=C.useRef(!1);C.useEffect(()=>{const Y=()=>{y(window.innerWidth>=1024)};return Y(),window.addEventListener("resize",Y),()=>window.removeEventListener("resize",Y)},[]);const w=C.useRef(null),S=JP(n?.id),{data:T}=fi(),{data:j}=Up(),M=j?.find(Y=>Y.id===T?.currentQueueItemId&&Y.itemType==="bible"&&Y.bibleVerseId),{data:_}=l8(M?.bibleVerseId??void 0),R=T?.temporaryContent?.type==="bible"?T.temporaryContent.data.translationId:void 0,{data:O=[]}=Fp(R);C.useEffect(()=>{n&&!S.state.translationId&&S.selectTranslation(n.id)},[n,S]),C.useEffect(()=>{if(!v.current){if(T?.temporaryContent?.type==="bible"){const Y=T.temporaryContent.data,X=O.find(I=>I.id===Y.bookId);X&&(v.current=!0,S.navigateToVerse({translationId:Y.translationId,bookId:Y.bookId,bookName:X.bookName,chapter:Y.chapter,verseIndex:Y.currentVerseIndex}));return}_&&(v.current=!0,S.navigateToVerse({translationId:_.translationId,bookId:_.bookId,bookName:_.bookName,chapter:_.chapter,verseIndex:_.verse-1}))}},[T,_,O,S]);const{data:L=[]}=GE(S.state.bookId,S.state.chapter),A=r.find(Y=>Y.id===S.state.translationId),F=C.useCallback(async(Y,X)=>{const I=xB(Y.bookName,Y.chapter,Y.verse,A?.abbreviation);await i.mutateAsync({verseId:Y.id,reference:I,text:Y.text,translationAbbreviation:A?.abbreviation||"",translationId:Y.translationId,bookId:Y.bookId,bookCode:Y.bookCode,chapter:Y.chapter,currentVerseIndex:X})},[A?.abbreviation,i]);C.useEffect(()=>{const{bookId:Y,chapter:X,presentedIndex:I}=S.state;if(!Y||!X||L.length===0)return;const U=w.current,te=U&&(U.bookId!==Y||U.chapter!==X);if(w.current={bookId:Y,chapter:X},te&&I!==null){const Z=Math.min(I,L.length-1),re=L[Z];re&&(Z!==I&&S.presentVerse(Z),F(re,Z))}},[S,L,F]);const H=C.useCallback(async(Y,X)=>{S.presentVerse(X),await F(Y,X)},[S,F]),P=C.useCallback(async Y=>{const X=Y.reference||`${Y.bookName} ${Y.chapter}:${Y.verse}`;await i.mutateAsync({verseId:Y.id,reference:X,text:Y.text,translationAbbreviation:A?.abbreviation||"",translationId:Y.translationId,bookId:Y.bookId,bookCode:Y.bookCode,chapter:Y.chapter,currentVerseIndex:Y.verse-1})},[A?.abbreviation,i]),B=C.useCallback(async()=>{const X=(S.state.presentedIndex??S.state.searchedIndex??-1)+1;if(X<L.length){S.nextVerse();const I=L[X];I&&await F(I,X);return}S.clearPresentation(),await o.mutateAsync()},[S,L,F,o]),E=C.useCallback(async()=>{const X=(S.state.presentedIndex??S.state.searchedIndex??0)-1;if(X>=0){S.previousVerse();const I=L[X];I&&await F(I,X)}},[S,L,F]),K=C.useCallback(async()=>{S.clearPresentation(),await o.mutateAsync()},[S,o]),q=C.useCallback(async()=>{const{searchedIndex:Y,presentedIndex:X}=S.state;if(Y!==null&&Y!==X){const I=L[Y];I&&(S.presentVerse(Y),await F(I,Y))}},[S,L,F]);XP({onNextVerse:B,onPreviousVerse:E,onGoBack:S.goBack,onHidePresentation:K,onPresentSearched:q,enabled:S.state.level==="verses"});const V=S.state.level==="verses"&&L.length>0,ie=C.useCallback(Y=>{Y.preventDefault(),b.current=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none";const X=U=>{if(!b.current||!m.current)return;const te=m.current.getBoundingClientRect(),Z=(U.clientX-te.left)/te.width*100;p(Math.min(80,Math.max(20,Z)))},I=()=>{b.current=!1,document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",X),document.removeEventListener("mouseup",I)};document.addEventListener("mousemove",X),document.addEventListener("mouseup",I)},[]);return u.jsx(fd,{permission:"bible.view",children:u.jsxs("div",{className:"flex flex-col h-full lg:overflow-hidden overflow-auto scrollbar-thin",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3 lg:mb-4 flex-shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(wr,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"}),u.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:t("title")})]}),u.jsxs("button",{type:"button",onClick:()=>d(!0),className:"flex items-center gap-2 px-2 py-1.5 lg:px-3 text-sm bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-lg transition-colors",children:[u.jsx(ui,{className:"w-4 h-4"}),u.jsx("span",{className:"hidden sm:inline",children:t("actions.settings")})]})]}),s?u.jsx("div",{className:"flex items-center justify-center flex-1",children:u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600 dark:text-indigo-400"})}):e.length>0?u.jsxs("div",{ref:m,className:"flex flex-col lg:flex-row lg:flex-1 lg:min-h-0 gap-3 lg:gap-0",children:[u.jsx("div",{className:"order-3 lg:order-1 lg:min-h-0 lg:h-full lg:flex-initial overflow-hidden",style:g?{width:`${f}%`}:void 0,children:u.jsx(c8,{navigation:S,onSelectVerse:H,onSelectSearchResult:P,onPresentSearched:q})}),u.jsx("div",{className:"hidden lg:flex items-center justify-center w-2 cursor-col-resize hover:bg-indigo-100 dark:hover:bg-indigo-900/30 transition-colors group",onMouseDown:ie,children:u.jsx(or,{size:16,className:"text-gray-400 group-hover:text-indigo-500 transition-colors"})}),u.jsx("div",{className:"order-1 lg:order-2 lg:min-h-0 lg:flex-1 overflow-hidden",style:g?{width:`${100-f}%`}:void 0,children:u.jsx(IP,{onPrevVerse:E,onNextVerse:B,canNavigate:V})})]}):r.length>0?u.jsxs("div",{className:"text-center py-12 flex-1 flex flex-col items-center justify-center",children:[u.jsx(wr,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:t("empty.noTranslationsSelected")}),u.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:t("empty.noTranslationsSelectedDescription")})]}):u.jsxs("div",{className:"text-center py-12 flex-1 flex flex-col items-center justify-center",children:[u.jsx(wr,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:t("empty.title")}),u.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:t("empty.description")}),u.jsxs("button",{type:"button",onClick:()=>d(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors",children:[u.jsx(ui,{className:"w-5 h-5"}),t("actions.openSettings")]})]}),u.jsx(yB,{isOpen:l,onClose:()=>d(!1)})]})})}const qZ=Rn("/(root)/")({beforeLoad:()=>{throw hb({to:"/present"})}}),PA=Rn("/screen/$screenId")({component:HZ});function HZ(){const{screenId:t}=PA.useParams(),e=Number.parseInt(t,10);return Number.isNaN(e)||e<=0?u.jsx("div",{className:"w-screen h-screen flex items-center justify-center bg-black text-white",children:u.jsx("p",{children:"Invalid screen ID"})}):u.jsx(CK,{screenId:e})}const BA=Rn("/schedules/$scheduleId")({component:VZ});function VZ(){const t=ar(),{scheduleId:e}=BA.useParams(),r=e==="new"?null:parseInt(e,10),s=()=>{t({to:"/schedules"})},i=o=>{t({to:"/schedules/$scheduleId",params:{scheduleId:String(o)},replace:!0})};return u.jsx(WV,{scheduleId:r,onBack:s,onDeleted:s,onScheduleCreated:i})}const FA=Rn("/custom-page/$pageId")({component:KZ});function KZ(){const{pageId:t}=FA.useParams();return u.jsx(IW,{pageId:t})}const UA=Rn("/songs/$songId/")({component:QZ,beforeLoad:({params:t})=>{if(t.songId==="new")throw hb({to:"/songs/$songId/edit",params:{songId:"new"}})}});function QZ(){const{t}=ke("songs"),e=ar(),{songId:n}=UA.useParams(),r=parseInt(n,10),{data:s,isLoading:i}=Hb(r),o=BE(),l=FE(),d=UE(),{data:f}=fi(),[p,g]=C.useState(40),[y,m]=C.useState(!1),[b,v]=C.useState(!1),w=C.useRef(null),S=C.useRef(!1);C.useEffect(()=>{const B=()=>{v(window.innerWidth>=1024)};return B(),window.addEventListener("resize",B),()=>window.removeEventListener("resize",B)},[]);const T=f?.temporaryContent?.type==="song"&&f.temporaryContent.data.songId===r?f.temporaryContent.data.currentSlideIndex:null,j=C.useCallback(async(B,E)=>{if(T===E){e({to:"/songs/",search:{fromSong:!0}});return}await o.mutateAsync({songId:r,slideIndex:E})},[r,o,T,e]),M=C.useCallback(()=>{e({to:"/songs/"})},[e]),_=C.useCallback(async()=>{T!==null&&T>0&&await l.mutateAsync({direction:"prev"})},[T,l]),R=C.useCallback(async()=>{T!==null&&await l.mutateAsync({direction:"next"})},[T,l]),O=C.useCallback(async()=>{await d.mutateAsync()},[d]),L=C.useCallback(()=>{e({to:"/songs/$songId/edit",params:{songId:n}})},[e,n]),A=C.useCallback(B=>{e({to:"/schedules/$scheduleId",params:{scheduleId:String(B)}})},[e]);EP({onNextSlide:R,onPreviousSlide:_,onHidePresentation:O,enabled:T!==null});const F=C.useCallback(B=>{B.preventDefault(),S.current=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none";const E=q=>{if(!S.current||!w.current)return;const V=w.current.getBoundingClientRect(),ie=(q.clientX-V.left)/V.width*100;g(Math.min(80,Math.max(20,ie)))},K=()=>{S.current=!1,document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",K)};document.addEventListener("mousemove",E),document.addEventListener("mouseup",K)},[]);if(i||!s)return u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600 dark:text-indigo-400"})});const H=T!==null&&T>0,P=T!==null;return u.jsxs("div",{className:"flex flex-col h-full lg:overflow-hidden overflow-auto scrollbar-thin",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3 lg:mb-4 flex-shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[u.jsx("button",{type:"button",onClick:M,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:u.jsx(ed,{size:20,className:"text-gray-600 dark:text-gray-400"})}),u.jsx("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900 dark:text-white",children:s.title})]}),u.jsxs("div",{className:"hidden lg:flex items-center gap-2",children:[u.jsxs("button",{type:"button",onClick:()=>m(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",title:t("actions.addToSchedule"),children:[u.jsx(bh,{size:20}),u.jsx("span",{children:t("actions.addToSchedule")})]}),u.jsxs("button",{type:"button",onClick:L,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors",children:[u.jsx(Xa,{size:16}),u.jsx("span",{children:t("preview.edit")})]})]})]}),u.jsxs("div",{ref:w,className:"flex flex-col lg:flex-row lg:flex-1 lg:min-h-0 gap-3 lg:gap-0",children:[u.jsx("div",{className:"order-3 lg:order-1 lg:min-h-0 lg:h-full lg:flex-initial overflow-hidden bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-3 lg:p-4",style:b?{width:`${p}%`}:void 0,children:u.jsx(KK,{song:s,presentedSlideIndex:T,isLoading:i,onSlideClick:j})}),u.jsx("div",{className:"hidden lg:flex items-center justify-center w-2 cursor-col-resize hover:bg-indigo-100 dark:hover:bg-indigo-900/30 transition-colors group",onMouseDown:F,children:u.jsx(or,{size:16,className:"text-gray-400 group-hover:text-indigo-500 transition-colors"})}),u.jsx("div",{className:"order-1 lg:order-2 lg:min-h-0 lg:flex-1 overflow-hidden",style:b?{width:`${100-p}%`}:void 0,children:u.jsx(PK,{songId:r,onPrevSlide:_,onNextSlide:R,canNavigatePrev:H,canNavigateNext:P})}),u.jsxs("div",{className:"order-2 lg:hidden flex items-center justify-center gap-2 py-2",children:[u.jsxs("button",{type:"button",onClick:()=>m(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",title:t("actions.addToSchedule"),children:[u.jsx(bh,{size:18}),u.jsx("span",{className:"text-sm",children:t("actions.addToSchedule")})]}),u.jsxs("button",{type:"button",onClick:L,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors",children:[u.jsx(Xa,{size:16}),u.jsx("span",{children:t("preview.edit")})]})]})]}),u.jsx(Wv,{isOpen:y,songId:r,onClose:()=>m(!1),onAdded:A})]})}const WZ={author:null,copyright:null,ccli:null,key:null,tempo:null,timeSignature:null,theme:null,altTheme:null,hymnNumber:null,keyLine:null,presentationOrder:null,sourceFilename:null},$A=Rn("/songs/$songId/edit")({component:YZ,validateSearch:t=>({q:typeof t.q=="string"?t.q:void 0})});function YZ(){const{t}=ke(["songs","common"]),e=ar(),{songId:n}=$A.useParams(),{q:r}=Zu({from:"/songs/$songId/edit"}),{showToast:s}=mt(),i=n==="new",o=i?null:parseInt(n,10),{data:l,isLoading:d}=Hb(o),f=Kb(),p=CP(),[g,y]=C.useState(""),[m,b]=C.useState(null),[v,w]=C.useState([]),[S,T]=C.useState(WZ),[j,M]=C.useState(!1),{setSavedState:_,isDirty:R}=TP(),O=R({title:g,categoryId:m,slides:v,metadata:S});C.useEffect(()=>{if(l){y(l.title),b(l.categoryId);const q=l.slides.map(ie=>({id:ie.id,content:ie.content,sortOrder:ie.sortOrder,label:ie.label}));w(q);const V={author:l.author,copyright:l.copyright,ccli:l.ccli,key:l.key,tempo:l.tempo,timeSignature:l.timeSignature,theme:l.theme,altTheme:l.altTheme,hymnNumber:l.hymnNumber,keyLine:l.keyLine,presentationOrder:l.presentationOrder,sourceFilename:l.sourceFilename};T(V),_({title:l.title,categoryId:l.categoryId,slides:q,metadata:V})}},[l,_]);const L=C.useCallback((q,V)=>{T(ie=>({...ie,[q]:V}))},[]),A=C.useCallback(async()=>{if(!g.trim())return!1;const q=await f.mutateAsync({id:o??void 0,title:g.trim(),categoryId:m,slides:v.map((V,ie)=>({id:typeof V.id=="number"?V.id:void 0,content:V.content,sortOrder:ie,label:V.label})),author:S.author,copyright:S.copyright,ccli:S.ccli,key:S.key,tempo:S.tempo,timeSignature:S.timeSignature,theme:S.theme,altTheme:S.altTheme,hymnNumber:S.hymnNumber,keyLine:S.keyLine,presentationOrder:S.presentationOrder});if(q.success&&q.data){s(t("songs:messages.saved"),"success");const V=q.data.slides.map(Y=>({id:Y.id,content:Y.content,sortOrder:Y.sortOrder,label:Y.label})),ie={author:q.data.author,copyright:q.data.copyright,ccli:q.data.ccli,key:q.data.key,tempo:q.data.tempo,timeSignature:q.data.timeSignature,theme:q.data.theme,altTheme:q.data.altTheme,hymnNumber:q.data.hymnNumber,keyLine:q.data.keyLine,presentationOrder:q.data.presentationOrder};return _({title:q.data.title,categoryId:q.data.categoryId,slides:V,metadata:ie}),i?e({to:"/songs/$songId",params:{songId:String(q.data.id)}}):(w(V),T(ie)),!0}else return s(t("songs:messages.error"),"error"),!1},[g,m,v,S,o,i,f,s,t,e,_]);C.useEffect(()=>{const q=V=>{(V.metaKey||V.ctrlKey)&&V.key==="s"&&(V.preventDefault(),f.isPending||A())};return document.addEventListener("keydown",q),()=>document.removeEventListener("keydown",q)},[A,f.isPending]);const F=C.useCallback(()=>{e(i?{to:"/songs/",search:{q:r}}:{to:"/songs/$songId",params:{songId:n}})},[e,r,n,i]),H=async()=>{if(!o)return;M(!1),await p.mutateAsync(o)?(s(t("songs:messages.deleted"),"success"),e({to:"/songs/",search:{q:r}})):s(t("songs:messages.error"),"error")},{showModal:P,handleCancel:B,handleDiscard:E}=AP({isDirty:O}),K=!i&&d;return u.jsxs(u.Fragment,{children:[u.jsx(UK,{isNew:i,isLoading:K,isSaving:f.isPending,isDeleting:p.isPending,isDirty:O,songId:o,title:g,categoryId:m,slides:v,metadata:S,presentationCount:l?.presentationCount,lastManualEdit:l?.lastManualEdit,onTitleChange:y,onCategoryChange:b,onSlidesChange:w,onMetadataChange:L,onSave:A,onDelete:i?void 0:()=>M(!0),onBack:F}),u.jsx(di,{isOpen:j,title:t("songs:modal.deleteTitle"),message:t("songs:modal.deleteMessage"),confirmLabel:t("songs:actions.delete"),cancelLabel:t("common:buttons.cancel"),onConfirm:H,onCancel:()=>M(!1),variant:"danger"}),u.jsx(SQ,{isOpen:P,onDiscard:E,onCancel:B})]})}const qA=Rn("/auth/youtube/callback")({validateSearch:t=>({accessToken:t.accessToken||"",refreshToken:t.refreshToken||"",expiresAt:t.expiresAt||"",channelId:t.channelId||"",channelName:t.channelName||"",error:t.error||""}),component:GZ});function GZ(){const{accessToken:t,refreshToken:e,expiresAt:n,channelId:r,channelName:s,error:i}=qA.useSearch(),o=ar(),[l,d]=C.useState("processing"),[f,p]=C.useState(null);return C.useEffect(()=>{async function g(){if(i){d("error"),p(i);return}if(!t||!e||!n){d("error"),p("Missing token data");return}try{await SE({accessToken:t,refreshToken:e,expiresAt:parseInt(n,10),channelId:r||void 0,channelName:s||void 0}),d("success"),setTimeout(()=>{o({to:"/livestream"})},1500)}catch(y){d("error"),p(y instanceof Error?y.message:"Failed to store tokens")}}g()},[t,e,n,i,o]),u.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background",children:u.jsxs("div",{className:"text-center",children:[l==="processing"&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"mb-4 h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent mx-auto"}),u.jsx("p",{className:"text-lg",children:"Connecting YouTube account..."})]}),l==="success"&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"mb-4 text-4xl",children:""}),u.jsx("p",{className:"text-lg text-green-600",children:"YouTube account connected successfully!"}),u.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Redirecting to livestream settings..."})]}),l==="error"&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"mb-4 text-4xl",children:""}),u.jsx("p",{className:"text-lg text-red-600",children:"Connection failed"}),u.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:f}),u.jsx("button",{onClick:()=>o({to:"/livestream"}),className:"mt-4 px-4 py-2 bg-primary text-primary-foreground rounded-md",children:"Go to Livestream Settings"})]})]})})}const XZ=gJ.update({id:"/songs/",path:"/songs/",getParentRoute:()=>Hn}),JZ=sZ.update({id:"/settings/",path:"/settings/",getParentRoute:()=>Hn}),ZZ=aZ.update({id:"/schedules/",path:"/schedules/",getParentRoute:()=>Hn}),eee=lZ.update({id:"/present/",path:"/present/",getParentRoute:()=>Hn}),tee=PZ.update({id:"/livestream/",path:"/livestream/",getParentRoute:()=>Hn}),nee=BZ.update({id:"/dashboard/",path:"/dashboard/",getParentRoute:()=>Hn}),ree=UZ.update({id:"/bible/",path:"/bible/",getParentRoute:()=>Hn}),see=qZ.update({id:"/(root)/",path:"/",getParentRoute:()=>Hn}),iee=PA.update({id:"/screen/$screenId",path:"/screen/$screenId",getParentRoute:()=>Hn}),aee=BA.update({id:"/schedules/$scheduleId",path:"/schedules/$scheduleId",getParentRoute:()=>Hn}),oee=FA.update({id:"/custom-page/$pageId",path:"/custom-page/$pageId",getParentRoute:()=>Hn}),lee=UA.update({id:"/songs/$songId/",path:"/songs/$songId/",getParentRoute:()=>Hn}),cee=$A.update({id:"/songs/$songId/edit",path:"/songs/$songId/edit",getParentRoute:()=>Hn}),uee=qA.update({id:"/auth/youtube/callback",path:"/auth/youtube/callback",getParentRoute:()=>Hn}),dee={CustomPagePageIdRoute:oee,SchedulesScheduleIdRoute:aee,ScreenScreenIdRoute:iee,rootIndexRoute:see,BibleIndexRoute:ree,DashboardIndexRoute:nee,LivestreamIndexRoute:tee,PresentIndexRoute:eee,SchedulesIndexRoute:ZZ,SettingsIndexRoute:JZ,SongsIndexRoute:XZ,AuthYoutubeCallbackRoute:uee,SongsSongIdEditRoute:cee,SongsSongIdIndexRoute:lee},fee=Hn._addFileChildren(dee)._addFileTypes();async function hee(){return await Yt("get_server_config")}const pee=VO({routeTree:fee,defaultPreload:"intent"}),HA=typeof window<"u"&&"__TAURI_INTERNALS__"in window,gee=performance.now(),In=t=>{console.log(`[client-startup] ${t}: ${(performance.now()-gee).toFixed(1)}ms`)};In("script_loaded");if(typeof window<"u"&&window.__htmlLoadTime){const t=performance.now()-window.__htmlLoadTime;console.log(`[client-startup] module_executed (time since HTML): ${t.toFixed(1)}ms`)}const lb=typeof window<"u"&&"__TAURI_INTERNALS__"in window;In(`tauri_check (isTauri=${lb})`);function kp(t){const e=document.getElementById("loading-status");e&&(e.textContent=t)}let KT=!1;function Dn(t){const e=document.getElementById("loading-logs");e&&(KT||(e.textContent="",KT=!0),e.textContent+=`${t}
`,e.scrollTop=e.scrollHeight)}function cb(){const t=document.getElementById("loading-screen");t&&(t.style.opacity="0",t.style.transition="opacity 0.3s ease-out",setTimeout(()=>t.remove(),300))}async function QT(t,e=60){const n=`${t}/ping`,r=performance.now(),s=lb?100:500;for(let i=1;i<=e;i++){try{const o=performance.now();if(Dn(`[${new Date().toLocaleTimeString()}] Checking server... (attempt ${i})`),(await fetch(n,{method:"GET",signal:AbortSignal.timeout(lb?500:2e3)})).ok){const d=(performance.now()-r).toFixed(1),f=(performance.now()-o).toFixed(1);return Dn(`[${new Date().toLocaleTimeString()}] Server is ready! (attempt took ${f}ms, total wait ${d}ms)`),console.log(`[client-startup] waitForServer success: attempt=${i}, attemptTime=${f}ms, totalWait=${d}ms`),kp("Server ready, loading app..."),!0}}catch(o){console.log(`[client-startup] waitForServer attempt ${i} failed:`,o)}i<e&&await new Promise(o=>setTimeout(o,s))}return Dn(`[${new Date().toLocaleTimeString()}] Server failed to start after ${e} attempts`),kp("Failed to connect to server"),!1}if(typeof window<"u")if(window.__appVersion="0.0.0",window.__envMode="production",HA)try{if(In("tauri_block_start"),Dn(`[${new Date().toLocaleTimeString()}] Church Hub starting...`),Dn(`[${new Date().toLocaleTimeString()}] Initializing Tauri context...`),oo())if(In("mobile_mode"),Dn(`[${new Date().toLocaleTimeString()}] Mobile mode detected`),bj())Dn(`[${new Date().toLocaleTimeString()}] API URL not configured - showing setup`),cb();else{const t=Ct();if(t){Dn(`[${new Date().toLocaleTimeString()}] API URL: ${t}`),kp("Connecting to server..."),In("before_waitForServer");const e=await QT(t,10);In("after_waitForServer"),e?Dn(`[${new Date().toLocaleTimeString()}] Connected! Mounting React application...`):(console.error("[router] Failed to connect to remote server"),Dn(`[${new Date().toLocaleTimeString()}] Failed to connect to server`))}}else{Dn(`[${new Date().toLocaleTimeString()}] Getting server configuration...`),In("before_getServerConfig");const t=await hee();In("after_getServerConfig"),t&&(window.__serverConfig={serverPort:t.serverPort},Dn(`[${new Date().toLocaleTimeString()}] Server port: ${t.serverPort}`)),kp("Waiting for server...");const e=Ct();Dn(`[${new Date().toLocaleTimeString()}] API URL: ${e}`),In("before_waitForServer");const n=await QT(e,5);In("after_waitForServer"),n?Dn(`[${new Date().toLocaleTimeString()}] Mounting React application...`):console.error("[router] Server failed to start")}}catch(t){console.error("[router] Error getting server config:",t),Dn(`[${new Date().toLocaleTimeString()}] Error: ${t}`)}else cb();In("before_react_mount");const WT=document.getElementById("app");function mee(){const[t,e]=St.useState(bj());return t?u.jsx(gL,{onComplete:()=>{e(!1),window.location.reload()}}):u.jsx(WO,{router:pee})}if(!WT.innerHTML){const t=nD.createRoot(WT);In("react_root_created"),t.render(u.jsx(mee,{})),In("react_render_called"),HA&&(cb(),In("loading_screen_hidden"))}In("script_complete");export{WL as R,iC as S,Yt as i,QL as t};
