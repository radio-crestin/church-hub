const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/webviewWindow-BLpYegvH.js","assets/webview-Cdqbqo1f.js","assets/dpi-Dqb_mONB.js","assets/window-D06WGgXh.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Of=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var N0={exports:{}},Jc={};var n2;function u4(){if(n2)return Jc;n2=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,s,i){var o=null;if(i!==void 0&&(o=""+i),s.key!==void 0&&(o=""+s.key),"key"in s){i={};for(var l in s)l!=="key"&&(i[l]=s[l])}else i=s;return s=i.ref,{$$typeof:t,type:r,key:o,ref:s!==void 0?s:null,props:i}}return Jc.Fragment=e,Jc.jsx=n,Jc.jsxs=n,Jc}var r2;function d4(){return r2||(r2=1,N0.exports=u4()),N0.exports}var u=d4();const ix=new WeakMap,f4=new WeakMap,bh={current:[]};let T0=!1,pu=0;const ou=new Set,If=new Map;function rj(t){for(const e of t){if(bh.current.includes(e))continue;bh.current.push(e),e.recompute();const n=f4.get(e);if(n)for(const r of n){const s=ix.get(r);s?.length&&rj(s)}}}function h4(t){const e={prevVal:t.prevState,currentVal:t.state};for(const n of t.listeners)n(e)}function p4(t){const e={prevVal:t.prevState,currentVal:t.state};for(const n of t.listeners)n(e)}function sj(t){if(pu>0&&!If.has(t)&&If.set(t,t.prevState),ou.add(t),!(pu>0)&&!T0)try{for(T0=!0;ou.size>0;){const e=Array.from(ou);ou.clear();for(const n of e){const r=If.get(n)??n.prevState;n.prevState=r,h4(n)}for(const n of e){const r=ix.get(n);r&&(bh.current.push(n),rj(r))}for(const n of e){const r=ix.get(n);if(r)for(const s of r)p4(s)}}}finally{T0=!1,bh.current=[],If.clear()}}function gu(t){pu++;try{t()}finally{if(pu--,pu===0){const e=ou.values().next().value;e&&sj(e)}}}function g4(t){return typeof t=="function"}class m4{constructor(e,n){this.listeners=new Set,this.subscribe=r=>{var s,i;this.listeners.add(r);const o=(i=(s=this.options)==null?void 0:s.onSubscribe)==null?void 0:i.call(s,r,this);return()=>{this.listeners.delete(r),o?.()}},this.prevState=e,this.state=e,this.options=n}setState(e){var n,r,s;this.prevState=this.state,(n=this.options)!=null&&n.updateFn?this.state=this.options.updateFn(this.prevState)(e):g4(e)?this.state=e(this.prevState):this.state=e,(s=(r=this.options)==null?void 0:r.onUpdate)==null||s.call(r),sj(this)}}const aa="__TSR_index",s2="popstate",i2="beforeunload";function y4(t){let e=t.getLocation();const n=new Set,r=o=>{e=t.getLocation(),n.forEach(l=>l({location:e,action:o}))},s=o=>{t.notifyOnIndexChange??!0?r(o):e=t.getLocation()},i=async({task:o,navigateOpts:l,...d})=>{if(l?.ignoreBlocker??!1){o();return}const p=t.getBlockers?.()??[],g=d.type==="PUSH"||d.type==="REPLACE";if(typeof document<"u"&&p.length&&g)for(const m of p){const y=vh(d.path,d.state);if(await m.blockerFn({currentLocation:e,nextLocation:y,action:d.type})){t.onBlocked?.();return}}o()};return{get location(){return e},get length(){return t.getLength()},subscribers:n,subscribe:o=>(n.add(o),()=>{n.delete(o)}),push:(o,l,d)=>{const f=e.state[aa];l=a2(f+1,l),i({task:()=>{t.pushState(o,l),r({type:"PUSH"})},navigateOpts:d,type:"PUSH",path:o,state:l})},replace:(o,l,d)=>{const f=e.state[aa];l=a2(f,l),i({task:()=>{t.replaceState(o,l),r({type:"REPLACE"})},navigateOpts:d,type:"REPLACE",path:o,state:l})},go:(o,l)=>{i({task:()=>{t.go(o),s({type:"GO",index:o})},navigateOpts:l,type:"GO"})},back:o=>{i({task:()=>{t.back(o?.ignoreBlocker??!1),s({type:"BACK"})},navigateOpts:o,type:"BACK"})},forward:o=>{i({task:()=>{t.forward(o?.ignoreBlocker??!1),s({type:"FORWARD"})},navigateOpts:o,type:"FORWARD"})},canGoBack:()=>e.state[aa]!==0,createHref:o=>t.createHref(o),block:o=>{if(!t.setBlockers)return()=>{};const l=t.getBlockers?.()??[];return t.setBlockers([...l,o]),()=>{const d=t.getBlockers?.()??[];t.setBlockers?.(d.filter(f=>f!==o))}},flush:()=>t.flush?.(),destroy:()=>t.destroy?.(),notify:r}}function a2(t,e){e||(e={});const n=gb();return{...e,key:n,__TSR_key:n,[aa]:t}}function x4(t){const e=typeof document<"u"?window:void 0,n=e.history.pushState,r=e.history.replaceState;let s=[];const i=()=>s,o=L=>s=L,l=(L=>L),d=(()=>vh(`${e.location.pathname}${e.location.search}${e.location.hash}`,e.history.state));if(!e.history.state?.__TSR_key&&!e.history.state?.key){const L=gb();e.history.replaceState({[aa]:0,key:L,__TSR_key:L},"")}let f=d(),p,g=!1,m=!1,y=!1,b=!1;const v=()=>f;let w,S;const T=()=>{w&&(O._ignoreSubscribers=!0,(w.isPush?e.history.pushState:e.history.replaceState)(w.state,"",w.href),O._ignoreSubscribers=!1,w=void 0,S=void 0,p=void 0)},j=(L,A,F)=>{const H=l(A);S||(p=f),f=vh(A,F),w={href:H,state:F,isPush:w?.isPush||L==="push"},S||(S=Promise.resolve().then(()=>T()))},M=L=>{f=d(),O.notify({type:L})},_=async()=>{if(m){m=!1;return}const L=d(),A=L.state[aa]-f.state[aa],F=A===1,H=A===-1,P=!F&&!H||g;g=!1;const B=P?"GO":H?"BACK":"FORWARD",E=P?{type:"GO",index:A}:{type:H?"BACK":"FORWARD"};if(y)y=!1;else{const K=i();if(typeof document<"u"&&K.length){for(const q of K)if(await q.blockerFn({currentLocation:f,nextLocation:L,action:B})){m=!0,e.history.go(1),O.notify(E);return}}}f=d(),O.notify(E)},R=L=>{if(b){b=!1;return}let A=!1;const F=i();if(typeof document<"u"&&F.length)for(const H of F){const P=H.enableBeforeUnload??!0;if(P===!0){A=!0;break}if(typeof P=="function"&&P()===!0){A=!0;break}}if(A)return L.preventDefault(),L.returnValue=""},O=y4({getLocation:v,getLength:()=>e.history.length,pushState:(L,A)=>j("push",L,A),replaceState:(L,A)=>j("replace",L,A),back:L=>(L&&(y=!0),b=!0,e.history.back()),forward:L=>{L&&(y=!0),b=!0,e.history.forward()},go:L=>{g=!0,e.history.go(L)},createHref:L=>l(L),flush:T,destroy:()=>{e.history.pushState=n,e.history.replaceState=r,e.removeEventListener(i2,R,{capture:!0}),e.removeEventListener(s2,_)},onBlocked:()=>{p&&f!==p&&(f=p)},getBlockers:i,setBlockers:o,notifyOnIndexChange:!1});return e.addEventListener(i2,R,{capture:!0}),e.addEventListener(s2,_),e.history.pushState=function(...L){const A=n.apply(e.history,L);return O._ignoreSubscribers||M("PUSH"),A},e.history.replaceState=function(...L){const A=r.apply(e.history,L);return O._ignoreSubscribers||M("REPLACE"),A},O}function vh(t,e){const n=t.indexOf("#"),r=t.indexOf("?"),s=gb();return{href:t,pathname:t.substring(0,n>0?r>0?Math.min(n,r):n:r>0?r:t.length),hash:n>-1?t.substring(n):"",search:r>-1?t.slice(r,n===-1?void 0:n):"",state:e||{[aa]:0,key:s,__TSR_key:s}}}function gb(){return(Math.random()+1).toString(36).substring(7)}function ax(t){return t[t.length-1]}function b4(t){return typeof t=="function"}function Ka(t,e){return b4(t)?t(e):t}const v4=Object.prototype.hasOwnProperty;function Hr(t,e){if(t===e)return t;const n=e,r=c2(t)&&c2(n);if(!r&&!(wh(t)&&wh(n)))return n;const s=r?t:o2(t);if(!s)return n;const i=r?n:o2(n);if(!i)return n;const o=s.length,l=i.length,d=r?new Array(l):{};let f=0;for(let p=0;p<l;p++){const g=r?p:i[p],m=t[g],y=n[g];if(m===y){d[g]=m,(r?p<o:v4.call(t,g))&&f++;continue}if(m===null||y===null||typeof m!="object"||typeof y!="object"){d[g]=y;continue}const b=Hr(m,y);d[g]=b,b===m&&f++}return o===l&&f===o?t:d}function o2(t){const e=[],n=Object.getOwnPropertyNames(t);for(const s of n){if(!Object.prototype.propertyIsEnumerable.call(t,s))return!1;e.push(s)}const r=Object.getOwnPropertySymbols(t);for(const s of r){if(!Object.prototype.propertyIsEnumerable.call(t,s))return!1;e.push(s)}return e}function wh(t){if(!l2(t))return!1;const e=t.constructor;if(typeof e>"u")return!0;const n=e.prototype;return!(!l2(n)||!n.hasOwnProperty("isPrototypeOf"))}function l2(t){return Object.prototype.toString.call(t)==="[object Object]"}function c2(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Qa(t,e,n){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let r=0,s=t.length;r<s;r++)if(!Qa(t[r],e[r],n))return!1;return!0}if(wh(t)&&wh(e)){const r=n?.ignoreUndefined??!0;if(n?.partial){for(const o in e)if((!r||e[o]!==void 0)&&!Qa(t[o],e[o],n))return!1;return!0}let s=0;if(!r)s=Object.keys(t).length;else for(const o in t)t[o]!==void 0&&s++;let i=0;for(const o in e)if((!r||e[o]!==void 0)&&(i++,i>s||!Qa(t[o],e[o],n)))return!1;return s===i}return!1}function Pl(t){let e,n;const r=new Promise((s,i)=>{e=s,n=i});return r.status="pending",r.resolve=s=>{r.status="resolved",r.value=s,e(s),t?.(s)},r.reject=s=>{r.status="rejected",n(s)},r}function oa(t){return!!(t&&typeof t=="object"&&typeof t.then=="function")}const w4=Array.from(new Map([["%","%25"],["\\","%5C"]]).values());function u2(t,e=w4){function n(s,i,o=0){for(let l=o;l<i.length;l++){const d=i[l].toUpperCase();if(s.includes(d)){const f=s.split(d),p=[];for(const g of f)p.push(n(g,i,l+1));return p.join(d)}}try{return decodeURI(s)}catch{return s.replaceAll(/%[0-9A-F]{2}/g,l=>{try{return decodeURI(l)}catch{return l}})}}if(t===""||!/%[0-9A-Fa-f]{2}/g.test(t))return t;const r=t.replaceAll(/%[0-9a-f]{2}/g,s=>s.toUpperCase());return n(r,e)}var S4="Invariant failed";function ui(t,e){if(!t)throw new Error(S4)}const Cs=0,eo=1,Bl=2,Fl=3;function oi(t){return mb(t.filter(e=>e!==void 0).join("/"))}function mb(t){return t.replace(/\/{2,}/g,"/")}function yb(t){return t==="/"?t:t.replace(/^\/{1,}/,"")}function la(t){return t==="/"?t:t.replace(/\/{1,}$/,"")}function uh(t){return la(yb(t))}function Sh(t,e){return t?.endsWith("/")&&t!=="/"&&t!==`${e}/`?t.slice(0,-1):t}function k4(t,e,n){return Sh(t,n)===Sh(e,n)}function C4(t){const{type:e,value:n}=t;if(e===Cs)return n;const{prefixSegment:r,suffixSegment:s}=t;if(e===eo){const i=n.substring(1);if(r&&s)return`${r}{$${i}}${s}`;if(r)return`${r}{$${i}}`;if(s)return`{$${i}}${s}`}if(e===Fl){const i=n.substring(1);return r&&s?`${r}{-$${i}}${s}`:r?`${r}{-$${i}}`:s?`{-$${i}}${s}`:`{-$${i}}`}if(e===Bl){if(r&&s)return`${r}{$}${s}`;if(r)return`${r}{$}`;if(s)return`{$}${s}`}return n}function N4({base:t,to:e,trailingSlash:n="never",parseCache:r}){let s=Ul(t,r).slice();const i=Ul(e,r);s.length>1&&ax(s)?.value==="/"&&s.pop();for(let d=0,f=i.length;d<f;d++){const p=i[d],g=p.value;g==="/"?d?d===f-1&&s.push(p):s=[p]:g===".."?s.pop():g==="."||s.push(p)}s.length>1&&(ax(s).value==="/"?n==="never"&&s.pop():n==="always"&&s.push({type:Cs,value:"/"}));const o=s.map(C4);return oi(o)}const Ul=(t,e)=>{if(!t)return[];const n=e?.get(t);if(n)return n;const r=R4(t);return e?.set(t,r),r},T4=/^\$.{1,}$/,j4=/^(.*?)\{(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,E4=/^(.*?)\{-(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,M4=/^\$$/,A4=/^(.*?)\{\$\}(.*)$/;function R4(t){t=mb(t);const e=[];if(t.slice(0,1)==="/"&&(t=t.substring(1),e.push({type:Cs,value:"/"})),!t)return e;const n=t.split("/").filter(Boolean);return e.push(...n.map(r=>{const s=r.match(A4);if(s){const l=s[1],d=s[2];return{type:Bl,value:"$",prefixSegment:l||void 0,suffixSegment:d||void 0}}const i=r.match(E4);if(i){const l=i[1],d=i[2],f=i[3];return{type:Fl,value:d,prefixSegment:l||void 0,suffixSegment:f||void 0}}const o=r.match(j4);if(o){const l=o[1],d=o[2],f=o[3];return{type:eo,value:""+d,prefixSegment:l||void 0,suffixSegment:f||void 0}}if(T4.test(r)){const l=r.substring(1);return{type:eo,value:"$"+l,prefixSegment:void 0,suffixSegment:void 0}}return M4.test(r)?{type:Bl,value:"$",prefixSegment:void 0,suffixSegment:void 0}:{type:Cs,value:r}})),t.slice(-1)==="/"&&(t=t.substring(1),e.push({type:Cs,value:"/"})),e}function Df({path:t,params:e,leaveWildcards:n,leaveParams:r,decodeCharMap:s,parseCache:i}){const o=Ul(t,i);function l(g){const m=e[g],y=typeof m=="string";return g==="*"||g==="_splat"?y?encodeURI(m):m:y?_4(m,s):m}let d=!1;const f={},p=oi(o.map(g=>{if(g.type===Cs)return g.value;if(g.type===Bl){f._splat=e._splat,f["*"]=e._splat;const m=g.prefixSegment||"",y=g.suffixSegment||"";if(!e._splat)return d=!0,n?`${m}${g.value}${y}`:m||y?`${m}${y}`:void 0;const b=l("_splat");return n?`${m}${g.value}${b??""}${y}`:`${m}${b}${y}`}if(g.type===eo){const m=g.value.substring(1);!d&&!(m in e)&&(d=!0),f[m]=e[m];const y=g.prefixSegment||"",b=g.suffixSegment||"";if(r){const v=l(g.value);return`${y}${g.value}${v??""}${b}`}return`${y}${l(m)??"undefined"}${b}`}if(g.type===Fl){const m=g.value.substring(1),y=g.prefixSegment||"",b=g.suffixSegment||"";if(!(m in e)||e[m]==null)return n?`${y}${m}${b}`:y||b?`${y}${b}`:void 0;if(f[m]=e[m],r){const v=l(g.value);return`${y}${g.value}${v??""}${b}`}return n?`${y}${m}${l(m)??""}${b}`:`${y}${l(m)??""}${b}`}return g.value}));return{usedParams:f,interpolatedPath:p,isMissingParams:d}}function _4(t,e){let n=encodeURIComponent(t);if(e)for(const[r,s]of e)n=n.replaceAll(r,s);return n}function ox(t,e,n){const r=O4(t,e,n);if(!(e.to&&!r))return r??{}}function O4(t,{to:e,fuzzy:n,caseSensitive:r},s){const i=e,o=Ul(t.startsWith("/")?t:`/${t}`,s),l=Ul(i.startsWith("/")?i:`/${i}`,s),d={};return I4(o,l,d,n,r)?d:void 0}function I4(t,e,n,r,s){let i=0,o=0;for(;i<t.length||o<e.length;){const l=t[i],d=e[o];if(d){if(d.type===Bl){const f=t.slice(i);let p;if(d.prefixSegment||d.suffixSegment){if(!l)return!1;const g=d.prefixSegment||"",m=d.suffixSegment||"",y=l.value;if("prefixSegment"in d&&!y.startsWith(g)||"suffixSegment"in d&&!t[t.length-1]?.value.endsWith(m))return!1;let b=decodeURI(oi(f.map(v=>v.value)));g&&b.startsWith(g)&&(b=b.slice(g.length)),m&&b.endsWith(m)&&(b=b.slice(0,b.length-m.length)),p=b}else p=decodeURI(oi(f.map(g=>g.value)));return n["*"]=p,n._splat=p,!0}if(d.type===Cs){if(d.value==="/"&&!l?.value){o++;continue}if(l){if(s){if(d.value!==l.value)return!1}else if(d.value.toLowerCase()!==l.value.toLowerCase())return!1;i++,o++;continue}else return!1}if(d.type===eo){if(!l||l.value==="/")return!1;let f="",p=!1;if(d.prefixSegment||d.suffixSegment){const g=d.prefixSegment||"",m=d.suffixSegment||"",y=l.value;if(g&&!y.startsWith(g)||m&&!y.endsWith(m))return!1;let b=y;g&&b.startsWith(g)&&(b=b.slice(g.length)),m&&b.endsWith(m)&&(b=b.slice(0,b.length-m.length)),f=decodeURIComponent(b),p=!0}else f=decodeURIComponent(l.value),p=!0;p&&(n[d.value.substring(1)]=f,i++),o++;continue}if(d.type===Fl){if(!l){o++;continue}if(l.value==="/"){o++;continue}let f="",p=!1;if(d.prefixSegment||d.suffixSegment){const g=d.prefixSegment||"",m=d.suffixSegment||"",y=l.value;if((!g||y.startsWith(g))&&(!m||y.endsWith(m))){let b=y;g&&b.startsWith(g)&&(b=b.slice(g.length)),m&&b.endsWith(m)&&(b=b.slice(0,b.length-m.length)),f=decodeURIComponent(b),p=!0}}else{let g=!0;for(let m=o+1;m<e.length;m++){const y=e[m];if(y?.type===Cs&&y.value===l.value){g=!1;break}if(y?.type===eo||y?.type===Bl){t.length<e.length&&(g=!1);break}}g&&(f=decodeURIComponent(l.value),p=!0)}p&&(n[d.value.substring(1)]=f,i++),o++;continue}}if(i<t.length&&o>=e.length)return n["**"]=oi(t.slice(i).map(f=>f.value)),!!r&&e[e.length-1]?.value!=="/";if(o<e.length&&i>=t.length){for(let f=o;f<e.length;f++)if(e[f]?.type!==Fl)return!1;break}break}return!0}const D4=.75,L4=1,z4=.5,P4=.4,B4=.25,F4=.2,U4=.05,$4=.02,q4=.01,d2=2e-4,f2=1e-4;function h2(t,e){return t.prefixSegment&&t.suffixSegment?e+U4+d2*t.prefixSegment.length+f2*t.suffixSegment.length:t.prefixSegment?e+$4+d2*t.prefixSegment.length:t.suffixSegment?e+q4+f2*t.suffixSegment.length:e}function H4(t){const e=[];return t.forEach((r,s)=>{if(r.isRoot||!r.path)return;const i=yb(r.fullPath);let o=Ul(i),l=0;for(;o.length>l+1&&o[l]?.value==="/";)l++;l>0&&(o=o.slice(l));let d=0,f=!1;const p=o.map((g,m)=>{if(g.value==="/")return D4;if(g.type===Cs)return L4;let y;g.type===eo?y=z4:g.type===Fl?(y=P4,d++):y=B4;for(let b=m+1;b<o.length;b++){const v=o[b];if(v.type===Cs&&v.value!=="/")return f=!0,h2(g,y+F4)}return h2(g,y)});e.push({child:r,trimmed:i,parsed:o,index:s,scores:p,optionalParamCount:d,hasStaticAfter:f})}),e.sort((r,s)=>{const i=Math.min(r.scores.length,s.scores.length);for(let o=0;o<i;o++)if(r.scores[o]!==s.scores[o])return s.scores[o]-r.scores[o];if(r.scores.length!==s.scores.length){if(r.optionalParamCount!==s.optionalParamCount){if(r.hasStaticAfter===s.hasStaticAfter)return r.optionalParamCount-s.optionalParamCount;if(r.hasStaticAfter&&!s.hasStaticAfter)return-1;if(!r.hasStaticAfter&&s.hasStaticAfter)return 1}return s.scores.length-r.scores.length}for(let o=0;o<i;o++)if(r.parsed[o].value!==s.parsed[o].value)return r.parsed[o].value>s.parsed[o].value?1:-1;return r.index-s.index}).map((r,s)=>(r.child.rank=s,r.child))}function V4({routeTree:t,initRoute:e}){const n={},r={},s=o=>{o.forEach((l,d)=>{e?.(l,d);const f=n[l.id];if(ui(!f,`Duplicate routes found with id: ${String(l.id)}`),n[l.id]=l,!l.isRoot&&l.path){const g=la(l.fullPath);(!r[g]||l.fullPath.endsWith("/"))&&(r[g]=l)}const p=l.children;p?.length&&s(p)})};s([t]);const i=H4(Object.values(n));return{routesById:n,routesByPath:r,flatRoutes:i}}function cs(t){return!!t?.isNotFound}function K4(){try{if(typeof window<"u"&&typeof window.sessionStorage=="object")return window.sessionStorage}catch{}}const kh="tsr-scroll-restoration-v1_3",Q4=(t,e)=>{let n;return(...r)=>{n||(n=setTimeout(()=>{t(...r),n=null},e))}};function W4(){const t=K4();if(!t)return null;const e=t.getItem(kh);let n=e?JSON.parse(e):{};return{state:n,set:r=>(n=Ka(r,n)||n,t.setItem(kh,JSON.stringify(n)))}}const Lf=W4(),lx=t=>t.state.__TSR_key||t.href;function Y4(t){const e=[];let n;for(;n=t.parentNode;)e.push(`${t.tagName}:nth-child(${Array.prototype.indexOf.call(n.children,t)+1})`),t=n;return`${e.reverse().join(" > ")}`.toLowerCase()}let Ch=!1;function ij({storageKey:t,key:e,behavior:n,shouldScrollRestoration:r,scrollToTopSelectors:s,location:i}){let o;try{o=JSON.parse(sessionStorage.getItem(t)||"{}")}catch(f){console.error(f);return}const l=e||window.history.state?.__TSR_key,d=o[l];Ch=!0;e:{if(r&&d&&Object.keys(d).length>0){for(const g in d){const m=d[g];if(g==="window")window.scrollTo({top:m.scrollY,left:m.scrollX,behavior:n});else if(g){const y=document.querySelector(g);y&&(y.scrollLeft=m.scrollX,y.scrollTop=m.scrollY)}}break e}const f=(i??window.location).hash.split("#",2)[1];if(f){const g=window.history.state?.__hashScrollIntoViewOptions??!0;if(g){const m=document.getElementById(f);m&&m.scrollIntoView(g)}break e}const p={top:0,left:0,behavior:n};if(window.scrollTo(p),s)for(const g of s){if(g==="window")continue;const m=typeof g=="function"?g():document.querySelector(g);m&&m.scrollTo(p)}}Ch=!1}function G4(t,e){if(!Lf&&!t.isServer||((t.options.scrollRestoration??!1)&&(t.isScrollRestoring=!0),t.isServer||t.isScrollRestorationSetup||!Lf))return;t.isScrollRestorationSetup=!0,Ch=!1;const r=t.options.getScrollRestorationKey||lx;window.history.scrollRestoration="manual";const s=i=>{if(Ch||!t.isScrollRestoring)return;let o="";if(i.target===document||i.target===window)o="window";else{const d=i.target.getAttribute("data-scroll-restoration-id");d?o=`[data-scroll-restoration-id="${d}"]`:o=Y4(i.target)}const l=r(t.state.location);Lf.set(d=>{const f=d[l]||={},p=f[o]||={};if(o==="window")p.scrollX=window.scrollX||0,p.scrollY=window.scrollY||0;else if(o){const g=document.querySelector(o);g&&(p.scrollX=g.scrollLeft||0,p.scrollY=g.scrollTop||0)}return d})};typeof document<"u"&&document.addEventListener("scroll",Q4(s,100),!0),t.subscribe("onRendered",i=>{const o=r(i.toLocation);if(!t.resetNextScroll){t.resetNextScroll=!0;return}typeof t.options.scrollRestoration=="function"&&!t.options.scrollRestoration({location:t.latestLocation})||(ij({storageKey:kh,key:o,behavior:t.options.scrollRestorationBehavior,shouldScrollRestoration:t.isScrollRestoring,scrollToTopSelectors:t.options.scrollToTopSelectors,location:t.history.location}),t.isScrollRestoring&&Lf.set(l=>(l[o]||={},l)))})}function X4(t){if(typeof document<"u"&&document.querySelector){const e=t.state.location.state.__hashScrollIntoViewOptions??!0;if(e&&t.state.location.hash!==""){const n=document.getElementById(t.state.location.hash);n&&n.scrollIntoView(e)}}}function J4(t,e=String){const n=new URLSearchParams;for(const r in t){const s=t[r];s!==void 0&&n.set(r,e(s))}return n.toString()}function j0(t){return t?t==="false"?!1:t==="true"?!0:+t*0===0&&+t+""===t?+t:t:""}function Z4(t){const e=new URLSearchParams(t),n={};for(const[r,s]of e.entries()){const i=n[r];i==null?n[r]=j0(s):Array.isArray(i)?i.push(j0(s)):n[r]=[i,j0(s)]}return n}const eO=nO(JSON.parse),tO=rO(JSON.stringify,JSON.parse);function nO(t){return e=>{e[0]==="?"&&(e=e.substring(1));const n=Z4(e);for(const r in n){const s=n[r];if(typeof s=="string")try{n[r]=t(s)}catch{}}return n}}function rO(t,e){const n=typeof e=="function";function r(s){if(typeof s=="object"&&s!==null)try{return t(s)}catch{}else if(n&&typeof s=="string")try{return e(s),t(s)}catch{}return s}return s=>{const i=J4(s,r);return i?`?${i}`:""}}const vr="__root__";function xb(t){if(t.statusCode=t.statusCode||t.code||307,!t.reloadDocument&&typeof t.href=="string")try{new URL(t.href),t.reloadDocument=!0}catch{}const e=new Headers(t.headers);t.href&&e.get("Location")===null&&e.set("Location",t.href);const n=new Response(null,{status:t.statusCode,headers:e});if(n.options=t,t.throw)throw n;return n}function Ss(t){return t instanceof Response&&!!t.options}function sO(t){const e=new Map;let n,r;const s=i=>{i.next&&(i.prev?(i.prev.next=i.next,i.next.prev=i.prev,i.next=void 0,r&&(r.next=i,i.prev=r)):(i.next.prev=void 0,n=i.next,i.next=void 0,r&&(i.prev=r,r.next=i)),r=i)};return{get(i){const o=e.get(i);if(o)return s(o),o.value},set(i,o){if(e.size>=t&&n){const d=n;e.delete(d.key),d.next&&(n=d.next,d.next.prev=void 0),d===r&&(r=void 0)}const l=e.get(i);if(l)l.value=o,s(l);else{const d={key:i,value:o,prev:r};r&&(r.next=d),r=d,n||(n=d),e.set(i,d)}}}}const dh=t=>{if(!t.rendered)return t.rendered=!0,t.onReady?.()},Rp=(t,e)=>!!(t.preload&&!t.router.state.matches.some(n=>n.id===e)),aj=(t,e)=>{const n=t.router.routesById[e.routeId??""]??t.router.routeTree;!n.options.notFoundComponent&&t.router.options?.defaultNotFoundComponent&&(n.options.notFoundComponent=t.router.options.defaultNotFoundComponent),ui(n.options.notFoundComponent);const r=t.matches.find(s=>s.routeId===n.id);ui(r,"Could not find match for route: "+n.id),t.updateMatch(r.id,s=>({...s,status:"notFound",error:e,isFetching:!1})),e.routerCode==="BEFORE_LOAD"&&n.parentRoute&&(e.routeId=n.parentRoute.id,aj(t,e))},ea=(t,e,n)=>{if(!(!Ss(n)&&!cs(n))){if(Ss(n)&&n.redirectHandled&&!n.options.reloadDocument)throw n;if(e){e._nonReactive.beforeLoadPromise?.resolve(),e._nonReactive.loaderPromise?.resolve(),e._nonReactive.beforeLoadPromise=void 0,e._nonReactive.loaderPromise=void 0;const r=Ss(n)?"redirected":"notFound";e._nonReactive.error=n,t.updateMatch(e.id,s=>({...s,status:r,isFetching:!1,error:n})),cs(n)&&!n.routeId&&(n.routeId=e.routeId),e._nonReactive.loadPromise?.resolve()}throw Ss(n)?(t.rendered=!0,n.options._fromLocation=t.location,n.redirectHandled=!0,n=t.router.resolveRedirect(n),n):(aj(t,n),n)}},oj=(t,e)=>{const n=t.router.getMatch(e);return!!(!t.router.isServer&&n._nonReactive.dehydrated||t.router.isServer&&n.ssr===!1)},Zc=(t,e,n,r)=>{const{id:s,routeId:i}=t.matches[e],o=t.router.looseRoutesById[i];if(n instanceof Promise)throw n;n.routerCode=r,t.firstBadMatchIndex??=e,ea(t,t.router.getMatch(s),n);try{o.options.onError?.(n)}catch(l){n=l,ea(t,t.router.getMatch(s),n)}t.updateMatch(s,l=>(l._nonReactive.beforeLoadPromise?.resolve(),l._nonReactive.beforeLoadPromise=void 0,l._nonReactive.loadPromise?.resolve(),{...l,error:n,status:"error",isFetching:!1,updatedAt:Date.now(),abortController:new AbortController}))},iO=(t,e,n,r)=>{const s=t.router.getMatch(e),i=t.matches[n-1]?.id,o=i?t.router.getMatch(i):void 0;if(t.router.isShell()){s.ssr=e===vr;return}if(o?.ssr===!1){s.ssr=!1;return}const l=y=>y===!0&&o?.ssr==="data-only"?"data-only":y,d=t.router.options.defaultSsr??!0;if(r.options.ssr===void 0){s.ssr=l(d);return}if(typeof r.options.ssr!="function"){s.ssr=l(r.options.ssr);return}const{search:f,params:p}=s,g={search:zf(f,s.searchError),params:zf(p,s.paramsError),location:t.location,matches:t.matches.map(y=>({index:y.index,pathname:y.pathname,fullPath:y.fullPath,staticData:y.staticData,id:y.id,routeId:y.routeId,search:zf(y.search,y.searchError),params:zf(y.params,y.paramsError),ssr:y.ssr}))},m=r.options.ssr(g);if(oa(m))return m.then(y=>{s.ssr=l(y??d)});s.ssr=l(m??d)},lj=(t,e,n,r)=>{if(r._nonReactive.pendingTimeout!==void 0)return;const s=n.options.pendingMs??t.router.options.defaultPendingMs;if(!!(t.onReady&&!t.router.isServer&&!Rp(t,e)&&(n.options.loader||n.options.beforeLoad||dj(n))&&typeof s=="number"&&s!==1/0&&(n.options.pendingComponent??t.router.options?.defaultPendingComponent))){const o=setTimeout(()=>{dh(t)},s);r._nonReactive.pendingTimeout=o}},aO=(t,e,n)=>{const r=t.router.getMatch(e);if(!r._nonReactive.beforeLoadPromise&&!r._nonReactive.loaderPromise)return;lj(t,e,n,r);const s=()=>{const i=t.router.getMatch(e);i.preload&&(i.status==="redirected"||i.status==="notFound")&&ea(t,i,i.error)};return r._nonReactive.beforeLoadPromise?r._nonReactive.beforeLoadPromise.then(s):s()},oO=(t,e,n,r)=>{const s=t.router.getMatch(e),i=s._nonReactive.loadPromise;s._nonReactive.loadPromise=Pl(()=>{i?.resolve()});const{paramsError:o,searchError:l}=s;o&&Zc(t,n,o,"PARSE_PARAMS"),l&&Zc(t,n,l,"VALIDATE_SEARCH"),lj(t,e,r,s);const d=new AbortController,f=t.matches[n-1]?.id,m={...(f?t.router.getMatch(f):void 0)?.context??t.router.options.context??void 0,...s.__routeContext};let y=!1;const b=()=>{y||(y=!0,t.updateMatch(e,O=>({...O,isFetching:"beforeLoad",fetchCount:O.fetchCount+1,abortController:d,context:m})))},v=()=>{s._nonReactive.beforeLoadPromise?.resolve(),s._nonReactive.beforeLoadPromise=void 0,t.updateMatch(e,O=>({...O,isFetching:!1}))};if(!r.options.beforeLoad){gu(()=>{b(),v()});return}s._nonReactive.beforeLoadPromise=Pl();const{search:w,params:S,cause:T}=s,j=Rp(t,e),M={search:w,abortController:d,params:S,preload:j,context:m,location:t.location,navigate:O=>t.router.navigate({...O,_fromLocation:t.location}),buildLocation:t.router.buildLocation,cause:j?"preload":T,matches:t.matches,...t.router.options.additionalContext},_=O=>{if(O===void 0){gu(()=>{b(),v()});return}(Ss(O)||cs(O))&&(b(),Zc(t,n,O,"BEFORE_LOAD")),gu(()=>{b(),t.updateMatch(e,L=>({...L,__beforeLoadContext:O,context:{...L.context,...O}})),v()})};let R;try{if(R=r.options.beforeLoad(M),oa(R))return b(),R.catch(O=>{Zc(t,n,O,"BEFORE_LOAD")}).then(_)}catch(O){b(),Zc(t,n,O,"BEFORE_LOAD")}_(R)},lO=(t,e)=>{const{id:n,routeId:r}=t.matches[e],s=t.router.looseRoutesById[r],i=()=>{if(t.router.isServer){const d=iO(t,n,e,s);if(oa(d))return d.then(l)}return l()},o=()=>oO(t,n,e,s),l=()=>{if(oj(t,n))return;const d=aO(t,n,s);return oa(d)?d.then(o):o()};return i()},mu=(t,e,n)=>{const r=t.router.getMatch(e);if(!r||!n.options.head&&!n.options.scripts&&!n.options.headers)return;const s={matches:t.matches,match:r,params:r.params,loaderData:r.loaderData};return Promise.all([n.options.head?.(s),n.options.scripts?.(s),n.options.headers?.(s)]).then(([i,o,l])=>{const d=i?.meta,f=i?.links,p=i?.scripts,g=i?.styles;return{meta:d,links:f,headScripts:p,headers:l,scripts:o,styles:g}})},cj=(t,e,n,r)=>{const s=t.matchPromises[n-1],{params:i,loaderDeps:o,abortController:l,cause:d}=t.router.getMatch(e);let f=t.router.options.context??{};for(let g=0;g<=n;g++){const m=t.matches[g];if(!m)continue;const y=t.router.getMatch(m.id);y&&(f={...f,...y.__routeContext??{},...y.__beforeLoadContext??{}})}const p=Rp(t,e);return{params:i,deps:o,preload:!!p,parentMatchPromise:s,abortController:l,context:f,location:t.location,navigate:g=>t.router.navigate({...g,_fromLocation:t.location}),cause:p?"preload":d,route:r,...t.router.options.additionalContext}},p2=async(t,e,n,r)=>{try{const s=t.router.getMatch(e);try{(!t.router.isServer||s.ssr===!0)&&uj(r);const i=r.options.loader?.(cj(t,e,n,r)),o=r.options.loader&&oa(i);if(!!(o||r._lazyPromise||r._componentsPromise||r.options.head||r.options.scripts||r.options.headers||s._nonReactive.minPendingPromise)&&t.updateMatch(e,g=>({...g,isFetching:"loader"})),r.options.loader){const g=o?await i:i;ea(t,t.router.getMatch(e),g),g!==void 0&&t.updateMatch(e,m=>({...m,loaderData:g}))}r._lazyPromise&&await r._lazyPromise;const d=mu(t,e,r),f=d?await d:void 0,p=s._nonReactive.minPendingPromise;p&&await p,r._componentsPromise&&await r._componentsPromise,t.updateMatch(e,g=>({...g,error:void 0,status:"success",isFetching:!1,updatedAt:Date.now(),...f}))}catch(i){let o=i;const l=s._nonReactive.minPendingPromise;l&&await l,cs(i)&&await r.options.notFoundComponent?.preload?.(),ea(t,t.router.getMatch(e),i);try{r.options.onError?.(i)}catch(p){o=p,ea(t,t.router.getMatch(e),p)}const d=mu(t,e,r),f=d?await d:void 0;t.updateMatch(e,p=>({...p,error:o,status:"error",isFetching:!1,...f}))}}catch(s){const i=t.router.getMatch(e);if(i){const o=mu(t,e,r);if(o){const l=await o;t.updateMatch(e,d=>({...d,...l}))}i._nonReactive.loaderPromise=void 0}ea(t,i,s)}},cO=async(t,e)=>{const{id:n,routeId:r}=t.matches[e];let s=!1,i=!1;const o=t.router.looseRoutesById[r];if(oj(t,n)){if(t.router.isServer){const f=mu(t,n,o);if(f){const p=await f;t.updateMatch(n,g=>({...g,...p}))}return t.router.getMatch(n)}}else{const f=t.router.getMatch(n);if(f._nonReactive.loaderPromise){if(f.status==="success"&&!t.sync&&!f.preload)return f;await f._nonReactive.loaderPromise;const p=t.router.getMatch(n),g=p._nonReactive.error||p.error;g&&ea(t,p,g)}else{const p=Date.now()-f.updatedAt,g=Rp(t,n),m=g?o.options.preloadStaleTime??t.router.options.defaultPreloadStaleTime??3e4:o.options.staleTime??t.router.options.defaultStaleTime??0,y=o.options.shouldReload,b=typeof y=="function"?y(cj(t,n,e,o)):y,v=!!g&&!t.router.state.matches.some(j=>j.id===n),w=t.router.getMatch(n);w._nonReactive.loaderPromise=Pl(),v!==w.preload&&t.updateMatch(n,j=>({...j,preload:v}));const{status:S,invalid:T}=w;if(s=S==="success"&&(T||(b??p>m)),!(g&&o.options.preload===!1))if(s&&!t.sync)i=!0,(async()=>{try{await p2(t,n,e,o);const j=t.router.getMatch(n);j._nonReactive.loaderPromise?.resolve(),j._nonReactive.loadPromise?.resolve(),j._nonReactive.loaderPromise=void 0}catch(j){Ss(j)&&await t.router.navigate(j.options)}})();else if(S!=="success"||s&&t.sync)await p2(t,n,e,o);else{const j=mu(t,n,o);if(j){const M=await j;t.updateMatch(n,_=>({..._,...M}))}}}}const l=t.router.getMatch(n);i||(l._nonReactive.loaderPromise?.resolve(),l._nonReactive.loadPromise?.resolve()),clearTimeout(l._nonReactive.pendingTimeout),l._nonReactive.pendingTimeout=void 0,i||(l._nonReactive.loaderPromise=void 0),l._nonReactive.dehydrated=void 0;const d=i?l.isFetching:!1;return d!==l.isFetching||l.invalid!==!1?(t.updateMatch(n,f=>({...f,isFetching:d,invalid:!1})),t.router.getMatch(n)):l};async function g2(t){const e=Object.assign(t,{matchPromises:[]});!e.router.isServer&&e.router.state.matches.some(n=>n._forcePending)&&dh(e);try{for(let s=0;s<e.matches.length;s++){const i=lO(e,s);oa(i)&&await i}const n=e.firstBadMatchIndex??e.matches.length;for(let s=0;s<n;s++)e.matchPromises.push(cO(e,s));await Promise.all(e.matchPromises);const r=dh(e);oa(r)&&await r}catch(n){if(cs(n)&&!e.preload){const r=dh(e);throw oa(r)&&await r,n}if(Ss(n))throw n}return e.matches}async function uj(t){if(!t._lazyLoaded&&t._lazyPromise===void 0&&(t.lazyFn?t._lazyPromise=t.lazyFn().then(e=>{const{id:n,...r}=e.options;Object.assign(t.options,r),t._lazyLoaded=!0,t._lazyPromise=void 0}):t._lazyLoaded=!0),!t._componentsLoaded&&t._componentsPromise===void 0){const e=()=>{const n=[];for(const r of fj){const s=t.options[r]?.preload;s&&n.push(s())}if(n.length)return Promise.all(n).then(()=>{t._componentsLoaded=!0,t._componentsPromise=void 0});t._componentsLoaded=!0,t._componentsPromise=void 0};t._componentsPromise=t._lazyPromise?t._lazyPromise.then(e):e()}return t._componentsPromise}function zf(t,e){return e?{status:"error",error:e}:{status:"success",value:t}}function dj(t){for(const e of fj)if(t.options[e]?.preload)return!0;return!1}const fj=["component","errorComponent","pendingComponent","notFoundComponent"];function uO(t){return{input:({url:e})=>{for(const n of t)e=hj(n,e);return e},output:({url:e})=>{for(let n=t.length-1;n>=0;n--)e=pj(t[n],e);return e}}}function dO(t){const e=uh(t.basepath),n=`/${e}`,r=`${n}/`,s=t.caseSensitive?n:n.toLowerCase(),i=t.caseSensitive?r:r.toLowerCase();return{input:({url:o})=>{const l=t.caseSensitive?o.pathname:o.pathname.toLowerCase();return l===s?o.pathname="/":l.startsWith(i)&&(o.pathname=o.pathname.slice(n.length)),o},output:({url:o})=>(o.pathname=oi(["/",e,o.pathname]),o)}}function hj(t,e){const n=t?.input?.({url:e});if(n){if(typeof n=="string")return new URL(n);if(n instanceof URL)return n}return e}function pj(t,e){const n=t?.output?.({url:e});if(n){if(typeof n=="string")return new URL(n);if(n instanceof URL)return n}return e}function Wa(t){const e=t.resolvedLocation,n=t.location,r=e?.pathname!==n.pathname,s=e?.href!==n.href,i=e?.hash!==n.hash;return{fromLocation:e,toLocation:n,pathChanged:r,hrefChanged:s,hashChanged:i}}class fO{constructor(e){this.tempLocationKey=`${Math.round(Math.random()*1e7)}`,this.resetNextScroll=!0,this.shouldViewTransition=void 0,this.isViewTransitionTypesSupported=void 0,this.subscribers=new Set,this.isScrollRestoring=!1,this.isScrollRestorationSetup=!1,this.startTransition=n=>n(),this.update=n=>{n.notFoundRoute&&console.warn("The notFoundRoute API is deprecated and will be removed in the next major version. See https://tanstack.com/router/v1/docs/framework/react/guide/not-found-errors#migrating-from-notfoundroute for more info.");const r=this.options,s=this.basepath??r?.basepath??"/",i=this.basepath===void 0,o=r?.rewrite;this.options={...r,...n},this.isServer=this.options.isServer??typeof document>"u",this.pathParamsDecodeCharMap=this.options.pathParamsAllowedCharacters?new Map(this.options.pathParamsAllowedCharacters.map(m=>[encodeURIComponent(m),m])):void 0,(!this.history||this.options.history&&this.options.history!==this.history)&&(this.options.history?this.history=this.options.history:this.isServer||(this.history=x4())),this.origin=this.options.origin,this.origin||(!this.isServer&&window?.origin&&window.origin!=="null"?this.origin=window.origin:this.origin="http://localhost"),this.history&&this.updateLatestLocation(),this.options.routeTree!==this.routeTree&&(this.routeTree=this.options.routeTree,this.buildRouteTree()),!this.__store&&this.latestLocation&&(this.__store=new m4(pO(this.latestLocation),{onUpdate:()=>{this.__store.state={...this.state,cachedMatches:this.state.cachedMatches.filter(m=>!["redirected"].includes(m.status))}}}),G4(this));let l=!1;const d=this.options.basepath??"/",f=this.options.rewrite;if(i||s!==d||o!==f){this.basepath=d;const m=[];uh(d)!==""&&m.push(dO({basepath:d})),f&&m.push(f),this.rewrite=m.length===0?void 0:m.length===1?m[0]:uO(m),this.history&&this.updateLatestLocation(),l=!0}l&&this.__store&&(this.__store.state={...this.state,location:this.latestLocation}),typeof window<"u"&&"CSS"in window&&typeof window.CSS?.supports=="function"&&(this.isViewTransitionTypesSupported=window.CSS.supports("selector(:active-view-transition-type(a)"))},this.updateLatestLocation=()=>{this.latestLocation=this.parseLocation(this.history.location,this.latestLocation)},this.buildRouteTree=()=>{const{routesById:n,routesByPath:r,flatRoutes:s}=V4({routeTree:this.routeTree,initRoute:(o,l)=>{o.init({originalIndex:l})}});this.routesById=n,this.routesByPath=r,this.flatRoutes=s;const i=this.options.notFoundRoute;i&&(i.init({originalIndex:99999999999}),this.routesById[i.id]=i)},this.subscribe=(n,r)=>{const s={eventType:n,fn:r};return this.subscribers.add(s),()=>{this.subscribers.delete(s)}},this.emit=n=>{this.subscribers.forEach(r=>{r.eventType===n.type&&r.fn(n)})},this.parseLocation=(n,r)=>{const s=({href:d,state:f})=>{const p=new URL(d,this.origin),g=hj(this.rewrite,p),m=this.options.parseSearch(g.search),y=this.options.stringifySearch(m);g.search=y;const b=g.href.replace(g.origin,""),{pathname:v,hash:w}=g;return{href:b,publicHref:d,url:g.href,pathname:u2(v),searchStr:y,search:Hr(r?.search,m),hash:w.split("#").reverse()[0]??"",state:Hr(r?.state,f)}},i=s(n),{__tempLocation:o,__tempKey:l}=i.state;if(o&&(!l||l===this.tempLocationKey)){const d=s(o);return d.state.key=i.state.key,d.state.__TSR_key=i.state.__TSR_key,delete d.state.__tempLocation,{...d,maskedLocation:i}}return i},this.resolvePathWithBase=(n,r)=>N4({base:n,to:mb(r),trailingSlash:this.options.trailingSlash,parseCache:this.parsePathnameCache}),this.matchRoutes=(n,r,s)=>typeof n=="string"?this.matchRoutesInternal({pathname:n,search:r},s):this.matchRoutesInternal(n,r),this.parsePathnameCache=sO(1e3),this.getMatchedRoutes=(n,r)=>gO({pathname:n,routePathname:r,caseSensitive:this.options.caseSensitive,routesByPath:this.routesByPath,routesById:this.routesById,flatRoutes:this.flatRoutes,parseCache:this.parsePathnameCache}),this.cancelMatch=n=>{const r=this.getMatch(n);r&&(r.abortController.abort(),clearTimeout(r._nonReactive.pendingTimeout),r._nonReactive.pendingTimeout=void 0)},this.cancelMatches=()=>{const n=this.state.matches.filter(i=>i.status==="pending"),r=this.state.matches.filter(i=>i.isFetching==="loader");new Set([...this.state.pendingMatches??[],...n,...r]).forEach(i=>{this.cancelMatch(i.id)})},this.buildLocation=n=>{const r=(i={})=>{const o=i._fromLocation||this.pendingBuiltLocation||this.latestLocation,l=this.matchRoutes(o,{_buildLocation:!0}),d=ax(l);i.from;const f=i.unsafeRelative==="path"?o.pathname:i.from??d.fullPath,p=this.resolvePathWithBase(f,"."),g=d.search,m={...d.params},y=i.to?this.resolvePathWithBase(p,`${i.to}`):this.resolvePathWithBase(p,"."),b=i.params===!1||i.params===null?{}:(i.params??!0)===!0?m:Object.assign(m,Ka(i.params,m)),v=Df({path:y,params:b,parseCache:this.parsePathnameCache}).interpolatedPath,w=this.matchRoutes(v,void 0,{_buildLocation:!0}).map(F=>this.looseRoutesById[F.routeId]);if(Object.keys(b).length>0)for(const F of w){const H=F.options.params?.stringify??F.options.stringifyParams;H&&Object.assign(b,H(b))}const S=u2(Df({path:y,params:b,leaveWildcards:!1,leaveParams:n.leaveParams,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath);let T=g;if(n._includeValidateSearch&&this.options.search?.strict){const F={};w.forEach(H=>{if(H.options.validateSearch)try{Object.assign(F,cx(H.options.validateSearch,{...F,...T}))}catch{}}),T=F}T=mO({search:T,dest:i,destRoutes:w,_includeValidateSearch:n._includeValidateSearch}),T=Hr(g,T);const j=this.options.stringifySearch(T),M=i.hash===!0?o.hash:i.hash?Ka(i.hash,o.hash):void 0,_=M?`#${M}`:"";let R=i.state===!0?o.state:i.state?Ka(i.state,o.state):{};R=Hr(o.state,R);const O=`${S}${j}${_}`,L=new URL(O,this.origin),A=pj(this.rewrite,L);return{publicHref:A.pathname+A.search+A.hash,href:O,url:A.href,pathname:S,search:T,searchStr:j,state:R,hash:M??"",unmaskOnReload:i.unmaskOnReload}},s=(i={},o)=>{const l=r(i);let d=o?r(o):void 0;if(!d){let f={};const p=this.options.routeMasks?.find(g=>{const m=ox(l.pathname,{to:g.from,caseSensitive:!1,fuzzy:!1},this.parsePathnameCache);return m?(f=m,!0):!1});if(p){const{from:g,...m}=p;o={from:n.from,...m,params:f},d=r(o)}}return d&&(l.maskedLocation=d),l};return n.mask?s(n,{from:n.from,...n.mask}):s(n)},this.commitLocation=({viewTransition:n,ignoreBlocker:r,...s})=>{const i=()=>{const d=["key","__TSR_key","__TSR_index","__hashScrollIntoViewOptions"];d.forEach(p=>{s.state[p]=this.latestLocation.state[p]});const f=Qa(s.state,this.latestLocation.state);return d.forEach(p=>{delete s.state[p]}),f},o=la(this.latestLocation.href)===la(s.href),l=this.commitLocationPromise;if(this.commitLocationPromise=Pl(()=>{l?.resolve()}),o&&i())this.load();else{let{maskedLocation:d,hashScrollIntoView:f,...p}=s;d&&(p={...d,state:{...d.state,__tempKey:void 0,__tempLocation:{...p,search:p.searchStr,state:{...p.state,__tempKey:void 0,__tempLocation:void 0,__TSR_key:void 0,key:void 0}}}},(p.unmaskOnReload??this.options.unmaskOnReload??!1)&&(p.state.__tempKey=this.tempLocationKey)),p.state.__hashScrollIntoViewOptions=f??this.options.defaultHashScrollIntoView??!0,this.shouldViewTransition=n,this.history[s.replace?"replace":"push"](p.publicHref,p.state,{ignoreBlocker:r})}return this.resetNextScroll=s.resetScroll??!0,this.history.subscribers.size||this.load(),this.commitLocationPromise},this.buildAndCommitLocation=({replace:n,resetScroll:r,hashScrollIntoView:s,viewTransition:i,ignoreBlocker:o,href:l,...d}={})=>{if(l){const g=this.history.location.state.__TSR_index,m=vh(l,{__TSR_index:n?g:g+1});d.to=m.pathname,d.search=this.options.parseSearch(m.search),d.hash=m.hash.slice(1)}const f=this.buildLocation({...d,_includeValidateSearch:!0});this.pendingBuiltLocation=f;const p=this.commitLocation({...f,viewTransition:i,replace:n,resetScroll:r,hashScrollIntoView:s,ignoreBlocker:o});return Promise.resolve().then(()=>{this.pendingBuiltLocation===f&&(this.pendingBuiltLocation=void 0)}),p},this.navigate=({to:n,reloadDocument:r,href:s,...i})=>{if(!r&&s)try{new URL(`${s}`),r=!0}catch{}return r?(s||(s=this.buildLocation({to:n,...i}).url),i.replace?window.location.replace(s):window.location.href=s,Promise.resolve()):this.buildAndCommitLocation({...i,href:s,to:n,_isNavigate:!0})},this.beforeLoad=()=>{if(this.cancelMatches(),this.updateLatestLocation(),this.isServer){const r=this.buildLocation({to:this.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0}),s=i=>{try{return encodeURI(decodeURI(i))}catch{return i}};if(uh(s(this.latestLocation.href))!==uh(s(r.href))){let i=r.url;throw this.origin&&i.startsWith(this.origin)&&(i=i.replace(this.origin,"")||"/"),xb({href:i})}}const n=this.matchRoutes(this.latestLocation);this.__store.setState(r=>({...r,status:"pending",statusCode:200,isLoading:!0,location:this.latestLocation,pendingMatches:n,cachedMatches:r.cachedMatches.filter(s=>!n.some(i=>i.id===s.id))}))},this.load=async n=>{let r,s,i;for(i=new Promise(l=>{this.startTransition(async()=>{try{this.beforeLoad();const d=this.latestLocation,f=this.state.resolvedLocation;this.state.redirect||this.emit({type:"onBeforeNavigate",...Wa({resolvedLocation:f,location:d})}),this.emit({type:"onBeforeLoad",...Wa({resolvedLocation:f,location:d})}),await g2({router:this,sync:n?.sync,matches:this.state.pendingMatches,location:d,updateMatch:this.updateMatch,onReady:async()=>{this.startTransition(()=>{this.startViewTransition(async()=>{let p=[],g=[],m=[];gu(()=>{this.__store.setState(y=>{const b=y.matches,v=y.pendingMatches||y.matches;return p=b.filter(w=>!v.some(S=>S.id===w.id)),g=v.filter(w=>!b.some(S=>S.id===w.id)),m=v.filter(w=>b.some(S=>S.id===w.id)),{...y,isLoading:!1,loadedAt:Date.now(),matches:v,pendingMatches:void 0,cachedMatches:[...y.cachedMatches,...p.filter(w=>w.status!=="error")]}}),this.clearExpiredCache()}),[[p,"onLeave"],[g,"onEnter"],[m,"onStay"]].forEach(([y,b])=>{y.forEach(v=>{this.looseRoutesById[v.routeId].options[b]?.(v)})})})})}})}catch(d){Ss(d)?(r=d,this.isServer||this.navigate({...r.options,replace:!0,ignoreBlocker:!0})):cs(d)&&(s=d),this.__store.setState(f=>({...f,statusCode:r?r.status:s?404:f.matches.some(p=>p.status==="error")?500:200,redirect:r}))}this.latestLoadPromise===i&&(this.commitLocationPromise?.resolve(),this.latestLoadPromise=void 0,this.commitLocationPromise=void 0),l()})}),this.latestLoadPromise=i,await i;this.latestLoadPromise&&i!==this.latestLoadPromise;)await this.latestLoadPromise;let o;this.hasNotFoundMatch()?o=404:this.__store.state.matches.some(l=>l.status==="error")&&(o=500),o!==void 0&&this.__store.setState(l=>({...l,statusCode:o}))},this.startViewTransition=n=>{const r=this.shouldViewTransition??this.options.defaultViewTransition;if(delete this.shouldViewTransition,r&&typeof document<"u"&&"startViewTransition"in document&&typeof document.startViewTransition=="function"){let s;if(typeof r=="object"&&this.isViewTransitionTypesSupported){const i=this.latestLocation,o=this.state.resolvedLocation,l=typeof r.types=="function"?r.types(Wa({resolvedLocation:o,location:i})):r.types;if(l===!1){n();return}s={update:n,types:l}}else s=n;document.startViewTransition(s)}else n()},this.updateMatch=(n,r)=>{this.startTransition(()=>{const s=this.state.pendingMatches?.some(i=>i.id===n)?"pendingMatches":this.state.matches.some(i=>i.id===n)?"matches":this.state.cachedMatches.some(i=>i.id===n)?"cachedMatches":"";s&&this.__store.setState(i=>({...i,[s]:i[s]?.map(o=>o.id===n?r(o):o)}))})},this.getMatch=n=>{const r=s=>s.id===n;return this.state.cachedMatches.find(r)??this.state.pendingMatches?.find(r)??this.state.matches.find(r)},this.invalidate=n=>{const r=s=>n?.filter?.(s)??!0?{...s,invalid:!0,...n?.forcePending||s.status==="error"?{status:"pending",error:void 0}:void 0}:s;return this.__store.setState(s=>({...s,matches:s.matches.map(r),cachedMatches:s.cachedMatches.map(r),pendingMatches:s.pendingMatches?.map(r)})),this.shouldViewTransition=!1,this.load({sync:n?.sync})},this.resolveRedirect=n=>{if(!n.options.href){const r=this.buildLocation(n.options);let s=r.url;this.origin&&s.startsWith(this.origin)&&(s=s.replace(this.origin,"")||"/"),n.options.href=r.href,n.headers.set("Location",s)}return n.headers.get("Location")||n.headers.set("Location",n.options.href),n},this.clearCache=n=>{const r=n?.filter;r!==void 0?this.__store.setState(s=>({...s,cachedMatches:s.cachedMatches.filter(i=>!r(i))})):this.__store.setState(s=>({...s,cachedMatches:[]}))},this.clearExpiredCache=()=>{const n=r=>{const s=this.looseRoutesById[r.routeId];if(!s.options.loader)return!0;const i=(r.preload?s.options.preloadGcTime??this.options.defaultPreloadGcTime:s.options.gcTime??this.options.defaultGcTime)??300*1e3;return r.status==="error"?!0:Date.now()-r.updatedAt>=i};this.clearCache({filter:n})},this.loadRouteChunk=uj,this.preloadRoute=async n=>{const r=this.buildLocation(n);let s=this.matchRoutes(r,{throwOnError:!0,preload:!0,dest:n});const i=new Set([...this.state.matches,...this.state.pendingMatches??[]].map(l=>l.id)),o=new Set([...i,...this.state.cachedMatches.map(l=>l.id)]);gu(()=>{s.forEach(l=>{o.has(l.id)||this.__store.setState(d=>({...d,cachedMatches:[...d.cachedMatches,l]}))})});try{return s=await g2({router:this,matches:s,location:r,preload:!0,updateMatch:(l,d)=>{i.has(l)?s=s.map(f=>f.id===l?d(f):f):this.updateMatch(l,d)}}),s}catch(l){if(Ss(l))return l.options.reloadDocument?void 0:await this.preloadRoute({...l.options,_fromLocation:r});cs(l)||console.error(l);return}},this.matchRoute=(n,r)=>{const s={...n,to:n.to?this.resolvePathWithBase(n.from||"",n.to):void 0,params:n.params||{},leaveParams:!0},i=this.buildLocation(s);if(r?.pending&&this.state.status!=="pending")return!1;const l=(r?.pending===void 0?!this.state.isLoading:r.pending)?this.latestLocation:this.state.resolvedLocation||this.state.location,d=ox(l.pathname,{...r,to:i.pathname},this.parsePathnameCache);return!d||n.params&&!Qa(d,n.params,{partial:!0})?!1:d&&(r?.includeSearch??!0)?Qa(l.search,i.search,{partial:!0})?d:!1:d},this.hasNotFoundMatch=()=>this.__store.state.matches.some(n=>n.status==="notFound"||n.globalNotFound),this.update({defaultPreloadDelay:50,defaultPendingMs:1e3,defaultPendingMinMs:500,context:void 0,...e,caseSensitive:e.caseSensitive??!1,notFoundMode:e.notFoundMode??"fuzzy",stringifySearch:e.stringifySearch??tO,parseSearch:e.parseSearch??eO}),typeof document<"u"&&(self.__TSR_ROUTER__=this)}isShell(){return!!this.options.isShell}isPrerendering(){return!!this.options.isPrerendering}get state(){return this.__store.state}get looseRoutesById(){return this.routesById}matchRoutesInternal(e,n){const{foundRoute:r,matchedRoutes:s,routeParams:i}=this.getMatchedRoutes(e.pathname,n?.dest?.to);let o=!1;(r?r.path!=="/"&&i["**"]:la(e.pathname))&&(this.options.notFoundRoute?s.push(this.options.notFoundRoute):o=!0);const l=(()=>{if(o){if(this.options.notFoundMode!=="root")for(let p=s.length-1;p>=0;p--){const g=s[p];if(g.children)return g.id}return vr}})(),d=[],f=p=>p?.id?p.context??this.options.context??void 0:this.options.context??void 0;return s.forEach((p,g)=>{const m=d[g-1],[y,b,v]=(()=>{const P=m?.search??e.search,B=m?._strictSearch??void 0;try{const E=cx(p.options.validateSearch,{...P})??void 0;return[{...P,...E},{...B,...E},void 0]}catch(E){let K=E;if(E instanceof Nh||(K=new Nh(E.message,{cause:E})),n?.throwOnError)throw K;return[P,{},K]}})(),w=p.options.loaderDeps?.({search:y})??"",S=w?JSON.stringify(w):"",{interpolatedPath:T,usedParams:j}=Df({path:p.fullPath,params:i,decodeCharMap:this.pathParamsDecodeCharMap}),M=Df({path:p.id,params:i,leaveWildcards:!0,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath+S,_=this.getMatch(M),R=this.state.matches.find(P=>P.routeId===p.id),O=_?._strictParams??j;let L;if(!_){const P=p.options.params?.parse??p.options.parseParams;if(P)try{Object.assign(O,P(O))}catch(B){if(L=new hO(B.message,{cause:B}),n?.throwOnError)throw L}}Object.assign(i,O);const A=R?"stay":"enter";let F;if(_)F={..._,cause:A,params:R?Hr(R.params,i):i,_strictParams:O,search:Hr(R?R.search:_.search,y),_strictSearch:b};else{const P=p.options.loader||p.options.beforeLoad||p.lazyFn||dj(p)?"pending":"success";F={id:M,index:g,routeId:p.id,params:R?Hr(R.params,i):i,_strictParams:O,pathname:T,updatedAt:Date.now(),search:R?Hr(R.search,y):y,_strictSearch:b,searchError:void 0,status:P,isFetching:!1,error:void 0,paramsError:L,__routeContext:void 0,_nonReactive:{loadPromise:Pl()},__beforeLoadContext:void 0,context:{},abortController:new AbortController,fetchCount:0,cause:A,loaderDeps:R?Hr(R.loaderDeps,w):w,invalid:!1,preload:!1,links:void 0,scripts:void 0,headScripts:void 0,meta:void 0,staticData:p.options.staticData||{},fullPath:p.fullPath}}n?.preload||(F.globalNotFound=l===p.id),F.searchError=v;const H=f(m);F.context={...H,...F.__routeContext,...F.__beforeLoadContext},d.push(F)}),d.forEach((p,g)=>{const m=this.looseRoutesById[p.routeId];if(!this.getMatch(p.id)&&n?._buildLocation!==!0){const b=d[g-1],v=f(b);if(m.options.context){const w={deps:p.loaderDeps,params:p.params,context:v??{},location:e,navigate:S=>this.navigate({...S,_fromLocation:e}),buildLocation:this.buildLocation,cause:p.cause,abortController:p.abortController,preload:!!p.preload,matches:d};p.__routeContext=m.options.context(w)??void 0}p.context={...v,...p.__routeContext,...p.__beforeLoadContext}}}),d}}class Nh extends Error{}class hO extends Error{}function pO(t){return{loadedAt:0,isLoading:!1,isTransitioning:!1,status:"idle",resolvedLocation:void 0,location:t,matches:[],pendingMatches:[],cachedMatches:[],statusCode:200}}function cx(t,e){if(t==null)return{};if("~standard"in t){const n=t["~standard"].validate(e);if(n instanceof Promise)throw new Nh("Async validation not supported");if(n.issues)throw new Nh(JSON.stringify(n.issues,void 0,2),{cause:n});return n.value}return"parse"in t?t.parse(e):typeof t=="function"?t(e):{}}function gO({pathname:t,routePathname:e,caseSensitive:n,routesByPath:r,routesById:s,flatRoutes:i,parseCache:o}){let l={};const d=la(t),f=y=>ox(d,{to:y.fullPath,caseSensitive:y.options?.caseSensitive??n,fuzzy:!0},o);let p=e!==void 0?r[e]:void 0;if(p)l=f(p);else{let y;for(const b of i){const v=f(b);if(v)if(b.path!=="/"&&v["**"])y||(y={foundRoute:b,routeParams:v});else{p=b,l=v;break}}!p&&y&&(p=y.foundRoute,l=y.routeParams)}let g=p||s[vr];const m=[g];for(;g.parentRoute;)g=g.parentRoute,m.push(g);return m.reverse(),{matchedRoutes:m,routeParams:l,foundRoute:p}}function mO({search:t,dest:e,destRoutes:n,_includeValidateSearch:r}){const s=n.reduce((l,d)=>{const f=[];if("search"in d.options)d.options.search?.middlewares&&f.push(...d.options.search.middlewares);else if(d.options.preSearchFilters||d.options.postSearchFilters){const p=({search:g,next:m})=>{let y=g;"preSearchFilters"in d.options&&d.options.preSearchFilters&&(y=d.options.preSearchFilters.reduce((v,w)=>w(v),g));const b=m(y);return"postSearchFilters"in d.options&&d.options.postSearchFilters?d.options.postSearchFilters.reduce((v,w)=>w(v),b):b};f.push(p)}if(r&&d.options.validateSearch){const p=({search:g,next:m})=>{const y=m(g);try{return{...y,...cx(d.options.validateSearch,y)??void 0}}catch{return y}};f.push(p)}return l.concat(f)},[])??[],i=({search:l})=>e.search?e.search===!0?l:Ka(e.search,l):{};s.push(i);const o=(l,d)=>{if(l>=s.length)return d;const f=s[l];return f({search:d,next:g=>o(l+1,g)})};return o(0,t)}const yO="Error preloading route! ";class gj{constructor(e){if(this.init=n=>{this.originalIndex=n.originalIndex;const r=this.options,s=!r?.path&&!r?.id;this.parentRoute=this.options.getParentRoute?.(),s?this._path=vr:this.parentRoute||ui(!1);let i=s?vr:r?.path;i&&i!=="/"&&(i=yb(i));const o=r?.id||i;let l=s?vr:oi([this.parentRoute.id===vr?"":this.parentRoute.id,o]);i===vr&&(i="/"),l!==vr&&(l=oi(["/",l]));const d=l===vr?"/":oi([this.parentRoute.fullPath,i]);this._path=i,this._id=l,this._fullPath=d,this._to=d},this.addChildren=n=>this._addFileChildren(n),this._addFileChildren=n=>(Array.isArray(n)&&(this.children=n),typeof n=="object"&&n!==null&&(this.children=Object.values(n)),this),this._addFileTypes=()=>this,this.updateLoader=n=>(Object.assign(this.options,n),this),this.update=n=>(Object.assign(this.options,n),this),this.lazy=n=>(this.lazyFn=n,this),this.options=e||{},this.isRoot=!e?.getParentRoute,e?.id&&e?.path)throw new Error("Route cannot have both an 'id' and a 'path' option.")}get to(){return this._to}get id(){return this._id}get path(){return this._path}get fullPath(){return this._fullPath}}class xO extends gj{constructor(e){super(e)}}var E0={exports:{}},Ve={};var m2;function bO(){if(m2)return Ve;m2=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),m=Symbol.iterator;function y(D){return D===null||typeof D!="object"?null:(D=m&&D[m]||D["@@iterator"],typeof D=="function"?D:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,w={};function S(D,U,te){this.props=D,this.context=U,this.refs=w,this.updater=te||b}S.prototype.isReactComponent={},S.prototype.setState=function(D,U){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,U,"setState")},S.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function T(){}T.prototype=S.prototype;function j(D,U,te){this.props=D,this.context=U,this.refs=w,this.updater=te||b}var M=j.prototype=new T;M.constructor=j,v(M,S.prototype),M.isPureReactComponent=!0;var _=Array.isArray;function R(){}var O={H:null,A:null,T:null,S:null},L=Object.prototype.hasOwnProperty;function A(D,U,te){var Z=te.ref;return{$$typeof:t,type:D,key:U,ref:Z!==void 0?Z:null,props:te}}function F(D,U){return A(D.type,U,D.props)}function H(D){return typeof D=="object"&&D!==null&&D.$$typeof===t}function P(D){var U={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(te){return U[te]})}var B=/\/+/g;function E(D,U){return typeof D=="object"&&D!==null&&D.key!=null?P(""+D.key):U.toString(36)}function K(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(R,R):(D.status="pending",D.then(function(U){D.status==="pending"&&(D.status="fulfilled",D.value=U)},function(U){D.status==="pending"&&(D.status="rejected",D.reason=U)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function q(D,U,te,Z,re){var se=typeof D;(se==="undefined"||se==="boolean")&&(D=null);var ge=!1;if(D===null)ge=!0;else switch(se){case"bigint":case"string":case"number":ge=!0;break;case"object":switch(D.$$typeof){case t:case e:ge=!0;break;case p:return ge=D._init,q(ge(D._payload),U,te,Z,re)}}if(ge)return re=re(D),ge=Z===""?"."+E(D,0):Z,_(re)?(te="",ge!=null&&(te=ge.replace(B,"$&/")+"/"),q(re,U,te,"",function(Se){return Se})):re!=null&&(H(re)&&(re=F(re,te+(re.key==null||D&&D.key===re.key?"":(""+re.key).replace(B,"$&/")+"/")+ge)),U.push(re)),1;ge=0;var be=Z===""?".":Z+":";if(_(D))for(var me=0;me<D.length;me++)Z=D[me],se=be+E(Z,me),ge+=q(Z,U,te,se,re);else if(me=y(D),typeof me=="function")for(D=me.call(D),me=0;!(Z=D.next()).done;)Z=Z.value,se=be+E(Z,me++),ge+=q(Z,U,te,se,re);else if(se==="object"){if(typeof D.then=="function")return q(K(D),U,te,Z,re);throw U=String(D),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return ge}function V(D,U,te){if(D==null)return D;var Z=[],re=0;return q(D,Z,"","",function(se){return U.call(te,se,re++)}),Z}function ie(D){if(D._status===-1){var U=D._result;U=U(),U.then(function(te){(D._status===0||D._status===-1)&&(D._status=1,D._result=te)},function(te){(D._status===0||D._status===-1)&&(D._status=2,D._result=te)}),D._status===-1&&(D._status=0,D._result=U)}if(D._status===1)return D._result.default;throw D._result}var Y=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)},X={map:V,forEach:function(D,U,te){V(D,function(){U.apply(this,arguments)},te)},count:function(D){var U=0;return V(D,function(){U++}),U},toArray:function(D){return V(D,function(U){return U})||[]},only:function(D){if(!H(D))throw Error("React.Children.only expected to receive a single React element child.");return D}};return Ve.Activity=g,Ve.Children=X,Ve.Component=S,Ve.Fragment=n,Ve.Profiler=s,Ve.PureComponent=j,Ve.StrictMode=r,Ve.Suspense=d,Ve.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Ve.__COMPILER_RUNTIME={__proto__:null,c:function(D){return O.H.useMemoCache(D)}},Ve.cache=function(D){return function(){return D.apply(null,arguments)}},Ve.cacheSignal=function(){return null},Ve.cloneElement=function(D,U,te){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var Z=v({},D.props),re=D.key;if(U!=null)for(se in U.key!==void 0&&(re=""+U.key),U)!L.call(U,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&U.ref===void 0||(Z[se]=U[se]);var se=arguments.length-2;if(se===1)Z.children=te;else if(1<se){for(var ge=Array(se),be=0;be<se;be++)ge[be]=arguments[be+2];Z.children=ge}return A(D.type,re,Z)},Ve.createContext=function(D){return D={$$typeof:o,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:i,_context:D},D},Ve.createElement=function(D,U,te){var Z,re={},se=null;if(U!=null)for(Z in U.key!==void 0&&(se=""+U.key),U)L.call(U,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(re[Z]=U[Z]);var ge=arguments.length-2;if(ge===1)re.children=te;else if(1<ge){for(var be=Array(ge),me=0;me<ge;me++)be[me]=arguments[me+2];re.children=be}if(D&&D.defaultProps)for(Z in ge=D.defaultProps,ge)re[Z]===void 0&&(re[Z]=ge[Z]);return A(D,se,re)},Ve.createRef=function(){return{current:null}},Ve.forwardRef=function(D){return{$$typeof:l,render:D}},Ve.isValidElement=H,Ve.lazy=function(D){return{$$typeof:p,_payload:{_status:-1,_result:D},_init:ie}},Ve.memo=function(D,U){return{$$typeof:f,type:D,compare:U===void 0?null:U}},Ve.startTransition=function(D){var U=O.T,te={};O.T=te;try{var Z=D(),re=O.S;re!==null&&re(te,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(R,Y)}catch(se){Y(se)}finally{U!==null&&te.types!==null&&(U.types=te.types),O.T=U}},Ve.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Ve.use=function(D){return O.H.use(D)},Ve.useActionState=function(D,U,te){return O.H.useActionState(D,U,te)},Ve.useCallback=function(D,U){return O.H.useCallback(D,U)},Ve.useContext=function(D){return O.H.useContext(D)},Ve.useDebugValue=function(){},Ve.useDeferredValue=function(D,U){return O.H.useDeferredValue(D,U)},Ve.useEffect=function(D,U){return O.H.useEffect(D,U)},Ve.useEffectEvent=function(D){return O.H.useEffectEvent(D)},Ve.useId=function(){return O.H.useId()},Ve.useImperativeHandle=function(D,U,te){return O.H.useImperativeHandle(D,U,te)},Ve.useInsertionEffect=function(D,U){return O.H.useInsertionEffect(D,U)},Ve.useLayoutEffect=function(D,U){return O.H.useLayoutEffect(D,U)},Ve.useMemo=function(D,U){return O.H.useMemo(D,U)},Ve.useOptimistic=function(D,U){return O.H.useOptimistic(D,U)},Ve.useReducer=function(D,U,te){return O.H.useReducer(D,U,te)},Ve.useRef=function(D){return O.H.useRef(D)},Ve.useState=function(D){return O.H.useState(D)},Ve.useSyncExternalStore=function(D,U,te){return O.H.useSyncExternalStore(D,U,te)},Ve.useTransition=function(){return O.H.useTransition()},Ve.version="19.2.0",Ve}var y2;function nd(){return y2||(y2=1,E0.exports=bO()),E0.exports}var C=nd();const St=Gl(C);function bb(t){const e=t.errorComponent??_p;return u.jsx(vO,{getResetKey:t.getResetKey,onCatch:t.onCatch,children:({error:n,reset:r})=>n?C.createElement(e,{error:n,reset:r}):t.children})}class vO extends C.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromProps(e){return{resetKey:e.getResetKey()}}static getDerivedStateFromError(e){return{error:e}}reset(){this.setState({error:null})}componentDidUpdate(e,n){n.error&&n.resetKey!==this.state.resetKey&&this.reset()}componentDidCatch(e,n){this.props.onCatch&&this.props.onCatch(e,n)}render(){return this.props.children({error:this.state.resetKey!==this.props.getResetKey()?null:this.state.error,reset:()=>{this.reset()}})}}function _p({error:t}){const[e,n]=C.useState(!1);return u.jsxs("div",{style:{padding:".5rem",maxWidth:"100%"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:".5rem"},children:[u.jsx("strong",{style:{fontSize:"1rem"},children:"Something went wrong!"}),u.jsx("button",{style:{appearance:"none",fontSize:".6em",border:"1px solid currentColor",padding:".1rem .2rem",fontWeight:"bold",borderRadius:".25rem"},onClick:()=>n(r=>!r),children:e?"Hide Error":"Show Error"})]}),u.jsx("div",{style:{height:".25rem"}}),e?u.jsx("div",{children:u.jsx("pre",{style:{fontSize:".7em",border:"1px solid red",borderRadius:".25rem",padding:".3rem",color:"red",overflow:"auto"},children:t.message?u.jsx("code",{children:t.message}):null})}):null]})}function wO({children:t,fallback:e=null}){return SO()?u.jsx(St.Fragment,{children:t}):u.jsx(St.Fragment,{children:e})}function SO(){return St.useSyncExternalStore(kO,()=>!0,()=>!1)}function kO(){return()=>{}}var M0={exports:{}},A0={},R0={exports:{}},_0={};var x2;function CO(){if(x2)return _0;x2=1;var t=nd();function e(g,m){return g===m&&(g!==0||1/g===1/m)||g!==g&&m!==m}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,s=t.useEffect,i=t.useLayoutEffect,o=t.useDebugValue;function l(g,m){var y=m(),b=r({inst:{value:y,getSnapshot:m}}),v=b[0].inst,w=b[1];return i(function(){v.value=y,v.getSnapshot=m,d(v)&&w({inst:v})},[g,y,m]),s(function(){return d(v)&&w({inst:v}),g(function(){d(v)&&w({inst:v})})},[g]),o(y),y}function d(g){var m=g.getSnapshot;g=g.value;try{var y=m();return!n(g,y)}catch{return!0}}function f(g,m){return m()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:l;return _0.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:p,_0}var b2;function mj(){return b2||(b2=1,R0.exports=CO()),R0.exports}var v2;function NO(){if(v2)return A0;v2=1;var t=nd(),e=mj();function n(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var r=typeof Object.is=="function"?Object.is:n,s=e.useSyncExternalStore,i=t.useRef,o=t.useEffect,l=t.useMemo,d=t.useDebugValue;return A0.useSyncExternalStoreWithSelector=function(f,p,g,m,y){var b=i(null);if(b.current===null){var v={hasValue:!1,value:null};b.current=v}else v=b.current;b=l(function(){function S(R){if(!T){if(T=!0,j=R,R=m(R),y!==void 0&&v.hasValue){var O=v.value;if(y(O,R))return M=O}return M=R}if(O=M,r(j,R))return O;var L=m(R);return y!==void 0&&y(O,L)?(j=R,O):(j=R,M=L)}var T=!1,j,M,_=g===void 0?null:g;return[function(){return S(p())},_===null?void 0:function(){return S(_())}]},[p,g,m,y]);var w=s(f,b[0],b[1]);return o(function(){v.hasValue=!0,v.value=w},[w]),d(w),w},A0}var w2;function TO(){return w2||(w2=1,M0.exports=NO()),M0.exports}var yj=TO();function jO(t,e=r=>r,n={}){const r=n.equal??EO;return yj.useSyncExternalStoreWithSelector(t.subscribe,()=>t.state,()=>t.state,e,r)}function EO(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[r,s]of t)if(!e.has(r)||!Object.is(s,e.get(r)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();const n=S2(t);if(n.length!==S2(e).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(e,n[r])||!Object.is(t[n[r]],e[n[r]]))return!1;return!0}function S2(t){return Object.keys(t).concat(Object.getOwnPropertySymbols(t))}const O0=C.createContext(null);function xj(){return typeof document>"u"?O0:window.__TSR_ROUTER_CONTEXT__?window.__TSR_ROUTER_CONTEXT__:(window.__TSR_ROUTER_CONTEXT__=O0,O0)}function or(t){const e=C.useContext(xj());return t?.warn,e}function Bn(t){const e=or({warn:t?.router===void 0}),n=t?.router||e,r=C.useRef(void 0);return jO(n.__store,s=>{if(t?.select){if(t.structuralSharing??n.options.defaultStructuralSharing){const i=Hr(r.current,t.select(s));return r.current=i,i}return t.select(s)}return s})}const Op=C.createContext(void 0),MO=C.createContext(void 0);function Ns(t){const e=C.useContext(t.from?MO:Op);return Bn({select:r=>{const s=r.matches.find(i=>t.from?t.from===i.routeId:i.id===e);if(ui(!((t.shouldThrow??!0)&&!s),`Could not find ${t.from?`an active match from "${t.from}"`:"a nearest match!"}`),s!==void 0)return t.select?t.select(s):s},structuralSharing:t.structuralSharing})}function vb(t){return Ns({from:t.from,strict:t.strict,structuralSharing:t.structuralSharing,select:e=>t.select?t.select(e.loaderData):e.loaderData})}function wb(t){const{select:e,...n}=t;return Ns({...n,select:r=>e?e(r.loaderDeps):r.loaderDeps})}function Sb(t){return Ns({from:t.from,shouldThrow:t.shouldThrow,structuralSharing:t.structuralSharing,strict:t.strict,select:e=>{const n=t.strict===!1?e.params:e._strictParams;return t.select?t.select(n):n}})}function rd(t){return Ns({from:t.from,strict:t.strict,shouldThrow:t.shouldThrow,structuralSharing:t.structuralSharing,select:e=>t.select?t.select(e.search):e.search})}function lr(t){const e=or();return C.useCallback(n=>e.navigate({...n,from:n.from??t?.from}),[t?.from,e])}var I0={exports:{}},jn={};var k2;function AO(){if(k2)return jn;k2=1;var t=nd();function e(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(d,f,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:g==null?null:""+g,children:d,containerInfo:f,implementation:p}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return jn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,jn.createPortal=function(d,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return i(d,f,null,p)},jn.flushSync=function(d){var f=o.T,p=r.p;try{if(o.T=null,r.p=2,d)return d()}finally{o.T=f,r.p=p,r.d.f()}},jn.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(d,f))},jn.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},jn.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var p=f.as,g=l(p,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,y=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?r.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:m,fetchPriority:y}):p==="script"&&r.d.X(d,{crossOrigin:g,integrity:m,fetchPriority:y,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},jn.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=l(f.as,f.crossOrigin);r.d.M(d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(d)},jn.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,g=l(p,f.crossOrigin);r.d.L(d,p,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},jn.preloadModule=function(d,f){if(typeof d=="string")if(f){var p=l(f.as,f.crossOrigin);r.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(d)},jn.requestFormReset=function(d){r.d.r(d)},jn.unstable_batchedUpdates=function(d,f){return d(f)},jn.useFormState=function(d,f,p){return o.H.useFormState(d,f,p)},jn.useFormStatus=function(){return o.H.useHostTransitionStatus()},jn.version="19.2.0",jn}var C2;function bj(){if(C2)return I0.exports;C2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),I0.exports=AO(),I0.exports}var ta=bj();const RO=Gl(ta),Pf=typeof window<"u"?C.useLayoutEffect:C.useEffect;function D0(t){const e=C.useRef({value:t,prev:null}),n=e.current.value;return t!==n&&(e.current={value:t,prev:n}),e.current.prev}function _O(t,e,n={},r={}){C.useEffect(()=>{if(!t.current||r.disabled||typeof IntersectionObserver!="function")return;const s=new IntersectionObserver(([i])=>{e(i)},n);return s.observe(t.current),()=>{s.disconnect()}},[e,n,r.disabled,t])}function OO(t){const e=C.useRef(null);return C.useImperativeHandle(t,()=>e.current,[]),e}function IO(t,e){const n=or(),[r,s]=C.useState(!1),i=C.useRef(!1),o=OO(e),{activeProps:l,inactiveProps:d,activeOptions:f,to:p,preload:g,preloadDelay:m,hashScrollIntoView:y,replace:b,startTransition:v,resetScroll:w,viewTransition:S,children:T,target:j,disabled:M,style:_,className:R,onClick:O,onFocus:L,onMouseEnter:A,onMouseLeave:F,onTouchStart:H,ignoreBlocker:P,params:B,search:E,hash:K,state:q,mask:V,reloadDocument:ie,unsafeRelative:Y,from:X,_fromLocation:D,...U}=t,te=Bn({select:xe=>xe.location.search,structuralSharing:!0}),Z=t.from,re=C.useMemo(()=>({...t,from:Z}),[n,te,Z,t._fromLocation,t.hash,t.to,t.search,t.params,t.state,t.mask,t.unsafeRelative]),se=C.useMemo(()=>n.buildLocation({...re}),[n,re]),ge=C.useMemo(()=>{if(M)return;let xe=se.maskedLocation?se.maskedLocation.url:se.url,Ce=!1;return n.origin&&(xe.startsWith(n.origin)?xe=n.history.createHref(xe.replace(n.origin,""))||"/":Ce=!0),{href:xe,external:Ce}},[M,se.maskedLocation,se.url,n.origin,n.history]),be=C.useMemo(()=>{if(ge?.external)return ge.href;try{return new URL(p),p}catch{}},[p,ge]),me=t.reloadDocument||be?!1:g??n.options.defaultPreload,Se=m??n.options.defaultPreloadDelay??0,Oe=Bn({select:xe=>{if(be)return!1;if(f?.exact){if(!k4(xe.location.pathname,se.pathname,n.basepath))return!1}else{const Ce=Sh(xe.location.pathname,n.basepath),Te=Sh(se.pathname,n.basepath);if(!(Ce.startsWith(Te)&&(Ce.length===Te.length||Ce[Te.length]==="/")))return!1}return(f?.includeSearch??!0)&&!Qa(xe.location.search,se.search,{partial:!f?.exact,ignoreUndefined:!f?.explicitUndefined})?!1:f?.includeHash?xe.location.hash===se.hash:!0}}),He=C.useCallback(()=>{n.preloadRoute({...re}).catch(xe=>{console.warn(xe),console.warn(yO)})},[n,re]),ut=C.useCallback(xe=>{xe?.isIntersecting&&He()},[He]);_O(o,ut,BO,{disabled:!!M||me!=="viewport"}),C.useEffect(()=>{i.current||!M&&me==="render"&&(He(),i.current=!0)},[M,He,me]);const z=xe=>{const Ce=xe.currentTarget.getAttribute("target"),Te=j!==void 0?j:Ce;if(!M&&!FO(xe)&&!xe.defaultPrevented&&(!Te||Te==="_self")&&xe.button===0){xe.preventDefault(),ta.flushSync(()=>{s(!0)});const Ie=n.subscribe("onResolved",()=>{Ie(),s(!1)});n.navigate({...re,replace:b,resetScroll:w,hashScrollIntoView:y,startTransition:v,viewTransition:S,ignoreBlocker:P})}};if(be)return{...U,ref:o,href:be,...T&&{children:T},...j&&{target:j},...M&&{disabled:M},..._&&{style:_},...R&&{className:R},...O&&{onClick:O},...L&&{onFocus:L},...A&&{onMouseEnter:A},...F&&{onMouseLeave:F},...H&&{onTouchStart:H}};const fe=xe=>{M||me&&He()},ue=fe,W=xe=>{if(!(M||!me))if(!Se)He();else{const Ce=xe.target;if(eu.has(Ce))return;const Te=setTimeout(()=>{eu.delete(Ce),He()},Se);eu.set(Ce,Te)}},Q=xe=>{if(M||!me||!Se)return;const Ce=xe.target,Te=eu.get(Ce);Te&&(clearTimeout(Te),eu.delete(Ce))},ee=Oe?Ka(l,{})??DO:L0,pe=Oe?L0:Ka(d,{})??L0,we=[R,ee.className,pe.className].filter(Boolean).join(" "),ae=(_||ee.style||pe.style)&&{..._,...ee.style,...pe.style};return{...U,...ee,...pe,href:ge?.href,ref:o,onClick:tu([O,z]),onFocus:tu([L,fe]),onMouseEnter:tu([A,W]),onMouseLeave:tu([F,Q]),onTouchStart:tu([H,ue]),disabled:!!M,target:j,...ae&&{style:ae},...we&&{className:we},...M&&LO,...Oe&&zO,...r&&PO}}const L0={},DO={className:"active"},LO={role:"link","aria-disabled":!0},zO={"data-status":"active","aria-current":"page"},PO={"data-transitioning":"transitioning"},eu=new WeakMap,BO={rootMargin:"100px"},tu=t=>e=>{for(const n of t)if(n){if(e.defaultPrevented)return;n(e)}},kb=C.forwardRef((t,e)=>{const{_asChild:n,...r}=t,{type:s,ref:i,...o}=IO(r,e),l=typeof r.children=="function"?r.children({isActive:o["data-status"]==="active"}):r.children;return n===void 0&&delete o.disabled,C.createElement(n||"a",{...o,ref:i},l)});function FO(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}let UO=class extends gj{constructor(e){super(e),this.useMatch=n=>Ns({select:n?.select,from:this.id,structuralSharing:n?.structuralSharing}),this.useRouteContext=n=>Ns({...n,from:this.id,select:r=>n?.select?n.select(r.context):r.context}),this.useSearch=n=>rd({select:n?.select,structuralSharing:n?.structuralSharing,from:this.id}),this.useParams=n=>Sb({select:n?.select,structuralSharing:n?.structuralSharing,from:this.id}),this.useLoaderDeps=n=>wb({...n,from:this.id}),this.useLoaderData=n=>vb({...n,from:this.id}),this.useNavigate=()=>lr({from:this.fullPath}),this.Link=St.forwardRef((n,r)=>u.jsx(kb,{ref:r,from:this.fullPath,...n})),this.$$typeof=Symbol.for("react.memo")}};function $O(t){return new UO(t)}class qO extends xO{constructor(e){super(e),this.useMatch=n=>Ns({select:n?.select,from:this.id,structuralSharing:n?.structuralSharing}),this.useRouteContext=n=>Ns({...n,from:this.id,select:r=>n?.select?n.select(r.context):r.context}),this.useSearch=n=>rd({select:n?.select,structuralSharing:n?.structuralSharing,from:this.id}),this.useParams=n=>Sb({select:n?.select,structuralSharing:n?.structuralSharing,from:this.id}),this.useLoaderDeps=n=>wb({...n,from:this.id}),this.useLoaderData=n=>vb({...n,from:this.id}),this.useNavigate=()=>lr({from:this.fullPath}),this.Link=St.forwardRef((n,r)=>u.jsx(kb,{ref:r,from:this.fullPath,...n})),this.$$typeof=Symbol.for("react.memo")}}function HO(t){return new qO(t)}function _n(t){return typeof t=="object"?new N2(t,{silent:!0}).createRoute(t):new N2(t,{silent:!0}).createRoute}class N2{constructor(e,n){this.path=e,this.createRoute=r=>{this.silent;const s=$O(r);return s.isRoot=!1,s},this.silent=n?.silent}}class T2{constructor(e){this.useMatch=n=>Ns({select:n?.select,from:this.options.id,structuralSharing:n?.structuralSharing}),this.useRouteContext=n=>Ns({from:this.options.id,select:r=>n?.select?n.select(r.context):r.context}),this.useSearch=n=>rd({select:n?.select,structuralSharing:n?.structuralSharing,from:this.options.id}),this.useParams=n=>Sb({select:n?.select,structuralSharing:n?.structuralSharing,from:this.options.id}),this.useLoaderDeps=n=>wb({...n,from:this.options.id}),this.useLoaderData=n=>vb({...n,from:this.options.id}),this.useNavigate=()=>{const n=or();return lr({from:n.routesById[this.options.id].fullPath})},this.options=e,this.$$typeof=Symbol.for("react.memo")}}function j2(t){return typeof t=="object"?new T2(t):e=>new T2({id:t,...e})}function VO(){const t=or(),e=C.useRef({router:t,mounted:!1}),[n,r]=C.useState(!1),{hasPendingMatches:s,isLoading:i}=Bn({select:g=>({isLoading:g.isLoading,hasPendingMatches:g.matches.some(m=>m.status==="pending")}),structuralSharing:!0}),o=D0(i),l=i||n||s,d=D0(l),f=i||s,p=D0(f);return t.startTransition=g=>{r(!0),C.startTransition(()=>{g(),r(!1)})},C.useEffect(()=>{const g=t.history.subscribe(t.load),m=t.buildLocation({to:t.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0});return la(t.latestLocation.href)!==la(m.href)&&t.commitLocation({...m,replace:!0}),()=>{g()}},[t,t.history]),Pf(()=>{if(typeof window<"u"&&t.ssr||e.current.router===t&&e.current.mounted)return;e.current={router:t,mounted:!0},(async()=>{try{await t.load()}catch(m){console.error(m)}})()},[t]),Pf(()=>{o&&!i&&t.emit({type:"onLoad",...Wa(t.state)})},[o,t,i]),Pf(()=>{p&&!f&&t.emit({type:"onBeforeRouteMount",...Wa(t.state)})},[f,p,t]),Pf(()=>{d&&!l&&(t.emit({type:"onResolved",...Wa(t.state)}),t.__store.setState(g=>({...g,status:"idle",resolvedLocation:g.location})),X4(t))},[l,d,t]),null}function KO(t){const e=Bn({select:n=>`not-found-${n.location.pathname}-${n.status}`});return u.jsx(bb,{getResetKey:()=>e,onCatch:(n,r)=>{if(cs(n))t.onCatch?.(n,r);else throw n},errorComponent:({error:n})=>{if(cs(n))return t.fallback?.(n);throw n},children:t.children})}function QO(){return u.jsx("p",{children:"Not Found"})}function El(t){return u.jsx(u.Fragment,{children:t.children})}function vj(t,e,n){return e.options.notFoundComponent?u.jsx(e.options.notFoundComponent,{data:n}):t.options.defaultNotFoundComponent?u.jsx(t.options.defaultNotFoundComponent,{data:n}):u.jsx(QO,{})}function WO({children:t}){const e=or();return e.isServer?u.jsx("script",{nonce:e.options.ssr?.nonce,className:"$tsr",dangerouslySetInnerHTML:{__html:[t].filter(Boolean).join(`
`)+";$_TSR.c()"}}):null}function YO(){const t=or();if(!t.isScrollRestoring||!t.isServer||typeof t.options.scrollRestoration=="function"&&!t.options.scrollRestoration({location:t.latestLocation}))return null;const n=(t.options.getScrollRestorationKey||lx)(t.latestLocation),r=n!==lx(t.latestLocation)?n:void 0,s={storageKey:kh,shouldScrollRestoration:!0};return r&&(s.key=r),u.jsx(WO,{children:`(${ij.toString()})(${JSON.stringify(s)})`})}const wj=C.memo(function({matchId:e}){const n=or(),r=Bn({select:S=>{const T=S.matches.find(j=>j.id===e);return ui(T),{routeId:T.routeId,ssr:T.ssr,_displayPending:T._displayPending}},structuralSharing:!0}),s=n.routesById[r.routeId],i=s.options.pendingComponent??n.options.defaultPendingComponent,o=i?u.jsx(i,{}):null,l=s.options.errorComponent??n.options.defaultErrorComponent,d=s.options.onCatch??n.options.defaultOnCatch,f=s.isRoot?s.options.notFoundComponent??n.options.notFoundRoute?.options.component:s.options.notFoundComponent,p=r.ssr===!1||r.ssr==="data-only",g=(!s.isRoot||s.options.wrapInSuspense||p)&&(s.options.wrapInSuspense??i??(s.options.errorComponent?.preload||p))?C.Suspense:El,m=l?bb:El,y=f?KO:El,b=Bn({select:S=>S.loadedAt}),v=Bn({select:S=>{const T=S.matches.findIndex(j=>j.id===e);return S.matches[T-1]?.routeId}}),w=s.isRoot?s.options.shellComponent??El:El;return u.jsxs(w,{children:[u.jsx(Op.Provider,{value:e,children:u.jsx(g,{fallback:o,children:u.jsx(m,{getResetKey:()=>b,errorComponent:l||_p,onCatch:(S,T)=>{if(cs(S))throw S;d?.(S,T)},children:u.jsx(y,{fallback:S=>{if(!f||S.routeId&&S.routeId!==r.routeId||!S.routeId&&!s.isRoot)throw S;return C.createElement(f,S)},children:p||r._displayPending?u.jsx(wO,{fallback:o,children:u.jsx(E2,{matchId:e})}):u.jsx(E2,{matchId:e})})})})}),v===vr&&n.options.scrollRestoration?u.jsxs(u.Fragment,{children:[u.jsx(GO,{}),u.jsx(YO,{})]}):null]})});function GO(){const t=or(),e=C.useRef(void 0);return u.jsx("script",{suppressHydrationWarning:!0,ref:n=>{n&&(e.current===void 0||e.current.href!==t.latestLocation.href)&&(t.emit({type:"onRendered",...Wa(t.state)}),e.current=t.latestLocation)}},t.latestLocation.state.__TSR_key)}const E2=C.memo(function({matchId:e}){const n=or(),{match:r,key:s,routeId:i}=Bn({select:d=>{const f=d.matches.find(b=>b.id===e),p=f.routeId,m=(n.routesById[p].options.remountDeps??n.options.defaultRemountDeps)?.({routeId:p,loaderDeps:f.loaderDeps,params:f._strictParams,search:f._strictSearch});return{key:m?JSON.stringify(m):void 0,routeId:p,match:{id:f.id,status:f.status,error:f.error,_forcePending:f._forcePending,_displayPending:f._displayPending}}},structuralSharing:!0}),o=n.routesById[i],l=C.useMemo(()=>{const d=o.options.component??n.options.defaultComponent;return d?u.jsx(d,{},s):u.jsx(Cb,{})},[s,o.options.component,n.options.defaultComponent]);if(r._displayPending)throw n.getMatch(r.id)?._nonReactive.displayPendingPromise;if(r._forcePending)throw n.getMatch(r.id)?._nonReactive.minPendingPromise;if(r.status==="pending"){const d=o.options.pendingMinMs??n.options.defaultPendingMinMs;if(d){const f=n.getMatch(r.id);if(f&&!f._nonReactive.minPendingPromise&&!n.isServer){const p=Pl();f._nonReactive.minPendingPromise=p,setTimeout(()=>{p.resolve(),f._nonReactive.minPendingPromise=void 0},d)}}throw n.getMatch(r.id)?._nonReactive.loadPromise}if(r.status==="notFound")return ui(cs(r.error)),vj(n,o,r.error);if(r.status==="redirected")throw ui(Ss(r.error)),n.getMatch(r.id)?._nonReactive.loadPromise;if(r.status==="error"){if(n.isServer){const d=(o.options.errorComponent??n.options.defaultErrorComponent)||_p;return u.jsx(d,{error:r.error,reset:void 0,info:{componentStack:""}})}throw r.error}return l}),Cb=C.memo(function(){const e=or(),n=C.useContext(Op),r=Bn({select:f=>f.matches.find(p=>p.id===n)?.routeId}),s=e.routesById[r],i=Bn({select:f=>{const g=f.matches.find(m=>m.id===n);return ui(g),g.globalNotFound}}),o=Bn({select:f=>{const p=f.matches,g=p.findIndex(m=>m.id===n);return p[g+1]?.id}}),l=e.options.defaultPendingComponent?u.jsx(e.options.defaultPendingComponent,{}):null;if(i)return vj(e,s,void 0);if(!o)return null;const d=u.jsx(wj,{matchId:o});return n===vr?u.jsx(C.Suspense,{fallback:l,children:d}):d});function XO(){const t=or(),n=t.routesById[vr].options.pendingComponent??t.options.defaultPendingComponent,r=n?u.jsx(n,{}):null,s=t.isServer||typeof document<"u"&&t.ssr?El:C.Suspense,i=u.jsxs(s,{fallback:r,children:[!t.isServer&&u.jsx(VO,{}),u.jsx(JO,{})]});return t.options.InnerWrap?u.jsx(t.options.InnerWrap,{children:i}):i}function JO(){const t=or(),e=Bn({select:s=>s.matches[0]?.id}),n=Bn({select:s=>s.loadedAt}),r=e?u.jsx(wj,{matchId:e}):null;return u.jsx(Op.Provider,{value:e,children:t.options.disableGlobalCatchBoundary?r:u.jsx(bb,{getResetKey:()=>n,errorComponent:_p,onCatch:s=>{s.message||s.toString()},children:r})})}const ZO=t=>new eI(t);class eI extends fO{constructor(e){super(e)}}typeof globalThis<"u"?(globalThis.createFileRoute=_n,globalThis.createLazyFileRoute=j2):typeof window<"u"&&(window.createFileRoute=_n,window.createLazyFileRoute=j2);function tI({router:t,children:e,...n}){Object.keys(n).length>0&&t.update({...t.options,...n,context:{...t.options.context,...n.context}});const r=xj(),s=u.jsx(r.Provider,{value:t,children:e});return t.options.Wrap?u.jsx(t.options.Wrap,{children:s}):s}function nI({router:t,...e}){return u.jsx(tI,{router:t,...e,children:u.jsx(XO,{})})}function rI(t,e){if(t===void 0)return{shouldBlockFn:()=>!0,withResolver:!1};if("shouldBlockFn"in t)return t;if(typeof t=="function")return{shouldBlockFn:async()=>await t(),enableBeforeUnload:!0,withResolver:!1};const n=!!(t.condition??!0),r=t.blockerFn;return{shouldBlockFn:async()=>n&&r!==void 0?await r():n,enableBeforeUnload:n,withResolver:r===void 0}}function sI(t,e){const{shouldBlockFn:n,enableBeforeUnload:r=!0,disabled:s=!1,withResolver:i=!1}=rI(t),o=or(),{history:l}=o,[d,f]=C.useState({status:"idle",current:void 0,next:void 0,action:void 0,proceed:void 0,reset:void 0});return C.useEffect(()=>{const p=async g=>{function m(T){const j=o.parseLocation(T),M=o.getMatchedRoutes(j.pathname,void 0);if(M.foundRoute===void 0)throw new Error(`No route found for location ${T.href}`);return{routeId:M.foundRoute.id,fullPath:M.foundRoute.fullPath,pathname:j.pathname,params:M.routeParams,search:j.search}}const y=m(g.currentLocation),b=m(g.nextLocation),v=await n({action:g.action,current:y,next:b});if(!i)return v;if(!v)return!1;const S=await new Promise(T=>{f({status:"blocked",current:y,next:b,action:g.action,proceed:()=>T(!1),reset:()=>T(!0)})});return f({status:"idle",current:void 0,next:void 0,action:void 0,proceed:void 0,reset:void 0}),S};return s?void 0:l.block({blockerFn:p,enableBeforeUnload:r})},[n,r,s,i,l,o]),d}function Ip(t){return Bn({select:e=>e.location})}function vn(t,e,n,r){if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)}function Ml(t,e,n,r,s){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var za,Pr,hl,Bf,fh;const M2="__TAURI_TO_IPC_KEY__";function iI(t,e=!1){return window.__TAURI_INTERNALS__.transformCallback(t,e)}class Sj{constructor(e){za.set(this,void 0),Pr.set(this,0),hl.set(this,[]),Bf.set(this,void 0),Ml(this,za,e||(()=>{})),this.id=iI(n=>{const r=n.index;if("end"in n){r==vn(this,Pr,"f")?this.cleanupCallback():Ml(this,Bf,r);return}const s=n.message;if(r==vn(this,Pr,"f")){for(vn(this,za,"f").call(this,s),Ml(this,Pr,vn(this,Pr,"f")+1);vn(this,Pr,"f")in vn(this,hl,"f");){const i=vn(this,hl,"f")[vn(this,Pr,"f")];vn(this,za,"f").call(this,i),delete vn(this,hl,"f")[vn(this,Pr,"f")],Ml(this,Pr,vn(this,Pr,"f")+1)}vn(this,Pr,"f")===vn(this,Bf,"f")&&this.cleanupCallback()}else vn(this,hl,"f")[r]=s})}cleanupCallback(){window.__TAURI_INTERNALS__.unregisterCallback(this.id)}set onmessage(e){Ml(this,za,e)}get onmessage(){return vn(this,za,"f")}[(za=new WeakMap,Pr=new WeakMap,hl=new WeakMap,Bf=new WeakMap,M2)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[M2]()}}async function Yt(t,e={},n){return window.__TAURI_INTERNALS__.invoke(t,e,n)}class aI{get rid(){return vn(this,fh,"f")}constructor(e){fh.set(this,void 0),Ml(this,fh,e)}async close(){return Yt("plugin:resources|close",{rid:this.rid})}}fh=new WeakMap;const Ff="Request cancelled";async function hi(t,e){const n=e?.signal;if(n?.aborted)throw new Error(Ff);const r=e?.maxRedirections,s=e?.connectTimeout,i=e?.proxy,o=e?.danger;e&&(delete e.maxRedirections,delete e.connectTimeout,delete e.proxy,delete e.danger);const l=e?.headers?e.headers instanceof Headers?e.headers:new Headers(e.headers):new Headers,d=new Request(t,e),f=await d.arrayBuffer(),p=f.byteLength!==0?Array.from(new Uint8Array(f)):null;for(const[R,O]of d.headers)l.get(R)||l.set(R,O);const m=(l instanceof Headers?Array.from(l.entries()):Array.isArray(l)?l:Object.entries(l)).map(([R,O])=>[R,typeof O=="string"?O:O.toString()]);if(n?.aborted)throw new Error(Ff);const y=await Yt("plugin:http|fetch",{clientConfig:{method:d.method,url:d.url,headers:m,data:p,maxRedirections:r,connectTimeout:s,proxy:i,danger:o}}),b=()=>Yt("plugin:http|fetch_cancel",{rid:y});if(n?.aborted)throw b(),new Error(Ff);n?.addEventListener("abort",()=>void b());const{status:v,statusText:w,url:S,headers:T,rid:j}=await Yt("plugin:http|fetch_send",{rid:y}),M=[101,103,204,205,304].includes(v)?null:new ReadableStream({start:R=>{const O=new Sj;O.onmessage=L=>{if(n?.aborted){R.error(Ff);return}const A=new Uint8Array(L),F=A[A.byteLength-1],H=A.slice(0,A.byteLength-1);if(F==1){R.close();return}R.enqueue(H)},Yt("plugin:http|fetch_read_body",{rid:j,streamChannel:O}).catch(L=>{R.error(L)})}}),_=new Response(M,{status:v,statusText:w});return Object.defineProperty(_,"url",{value:S}),Object.defineProperty(_,"headers",{value:new Headers(T)}),_}var z0={exports:{}},nu={},P0={exports:{}},B0={};var A2;function oI(){return A2||(A2=1,(function(t){function e(q,V){var ie=q.length;q.push(V);e:for(;0<ie;){var Y=ie-1>>>1,X=q[Y];if(0<s(X,V))q[Y]=V,q[ie]=X,ie=Y;else break e}}function n(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var V=q[0],ie=q.pop();if(ie!==V){q[0]=ie;e:for(var Y=0,X=q.length,D=X>>>1;Y<D;){var U=2*(Y+1)-1,te=q[U],Z=U+1,re=q[Z];if(0>s(te,ie))Z<X&&0>s(re,te)?(q[Y]=re,q[Z]=ie,Y=Z):(q[Y]=te,q[U]=ie,Y=U);else if(Z<X&&0>s(re,ie))q[Y]=re,q[Z]=ie,Y=Z;else break e}}return V}function s(q,V){var ie=q.sortIndex-V.sortIndex;return ie!==0?ie:q.id-V.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var d=[],f=[],p=1,g=null,m=3,y=!1,b=!1,v=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;function M(q){for(var V=n(f);V!==null;){if(V.callback===null)r(f);else if(V.startTime<=q)r(f),V.sortIndex=V.expirationTime,e(d,V);else break;V=n(f)}}function _(q){if(v=!1,M(q),!b)if(n(d)!==null)b=!0,R||(R=!0,P());else{var V=n(f);V!==null&&K(_,V.startTime-q)}}var R=!1,O=-1,L=5,A=-1;function F(){return w?!0:!(t.unstable_now()-A<L)}function H(){if(w=!1,R){var q=t.unstable_now();A=q;var V=!0;try{e:{b=!1,v&&(v=!1,T(O),O=-1),y=!0;var ie=m;try{t:{for(M(q),g=n(d);g!==null&&!(g.expirationTime>q&&F());){var Y=g.callback;if(typeof Y=="function"){g.callback=null,m=g.priorityLevel;var X=Y(g.expirationTime<=q);if(q=t.unstable_now(),typeof X=="function"){g.callback=X,M(q),V=!0;break t}g===n(d)&&r(d),M(q)}else r(d);g=n(d)}if(g!==null)V=!0;else{var D=n(f);D!==null&&K(_,D.startTime-q),V=!1}}break e}finally{g=null,m=ie,y=!1}V=void 0}}finally{V?P():R=!1}}}var P;if(typeof j=="function")P=function(){j(H)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,E=B.port2;B.port1.onmessage=H,P=function(){E.postMessage(null)}}else P=function(){S(H,0)};function K(q,V){O=S(function(){q(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_next=function(q){switch(m){case 1:case 2:case 3:var V=3;break;default:V=m}var ie=m;m=V;try{return q()}finally{m=ie}},t.unstable_requestPaint=function(){w=!0},t.unstable_runWithPriority=function(q,V){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ie=m;m=q;try{return V()}finally{m=ie}},t.unstable_scheduleCallback=function(q,V,ie){var Y=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?Y+ie:Y):ie=Y,q){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=ie+X,q={id:p++,callback:V,priorityLevel:q,startTime:ie,expirationTime:X,sortIndex:-1},ie>Y?(q.sortIndex=ie,e(f,q),n(d)===null&&q===n(f)&&(v?(T(O),O=-1):v=!0,K(_,ie-Y))):(q.sortIndex=X,e(d,q),b||y||(b=!0,R||(R=!0,P()))),q},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(q){var V=m;return function(){var ie=m;m=V;try{return q.apply(this,arguments)}finally{m=ie}}}})(B0)),B0}var R2;function lI(){return R2||(R2=1,P0.exports=oI()),P0.exports}var _2;function cI(){if(_2)return nu;_2=1;var t=lI(),e=nd(),n=bj();function r(a){var c="https://react.dev/errors/"+a;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function i(a){var c=a,h=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(h=c.return),a=c.return;while(a)}return c.tag===3?h:null}function o(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function l(a){if(a.tag===31){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function d(a){if(i(a)!==a)throw Error(r(188))}function f(a){var c=a.alternate;if(!c){if(c=i(a),c===null)throw Error(r(188));return c!==a?null:a}for(var h=a,x=c;;){var k=h.return;if(k===null)break;var N=k.alternate;if(N===null){if(x=k.return,x!==null){h=x;continue}break}if(k.child===N.child){for(N=k.child;N;){if(N===h)return d(k),a;if(N===x)return d(k),c;N=N.sibling}throw Error(r(188))}if(h.return!==x.return)h=k,x=N;else{for(var I=!1,$=k.child;$;){if($===h){I=!0,h=k,x=N;break}if($===x){I=!0,x=k,h=N;break}$=$.sibling}if(!I){for($=N.child;$;){if($===h){I=!0,h=N,x=k;break}if($===x){I=!0,x=N,h=k;break}$=$.sibling}if(!I)throw Error(r(189))}}if(h.alternate!==x)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?a:c}function p(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a;for(a=a.child;a!==null;){if(c=p(a),c!==null)return c;a=a.sibling}return null}var g=Object.assign,m=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),j=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function P(a){return a===null||typeof a!="object"?null:(a=H&&a[H]||a["@@iterator"],typeof a=="function"?a:null)}var B=Symbol.for("react.client.reference");function E(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===B?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case v:return"Fragment";case S:return"Profiler";case w:return"StrictMode";case _:return"Suspense";case R:return"SuspenseList";case A:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case b:return"Portal";case j:return a.displayName||"Context";case T:return(a._context.displayName||"Context")+".Consumer";case M:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case O:return c=a.displayName||null,c!==null?c:E(a.type)||"Memo";case L:c=a._payload,a=a._init;try{return E(a(c))}catch{}}return null}var K=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie={pending:!1,data:null,method:null,action:null},Y=[],X=-1;function D(a){return{current:a}}function U(a){0>X||(a.current=Y[X],Y[X]=null,X--)}function te(a,c){X++,Y[X]=a.current,a.current=c}var Z=D(null),re=D(null),se=D(null),ge=D(null);function be(a,c){switch(te(se,c),te(re,a),te(Z,null),c.nodeType){case 9:case 11:a=(a=c.documentElement)&&(a=a.namespaceURI)?Nk(a):0;break;default:if(a=c.tagName,c=c.namespaceURI)c=Nk(c),a=Tk(c,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}U(Z),te(Z,a)}function me(){U(Z),U(re),U(se)}function Se(a){a.memoizedState!==null&&te(ge,a);var c=Z.current,h=Tk(c,a.type);c!==h&&(te(re,a),te(Z,h))}function Oe(a){re.current===a&&(U(Z),U(re)),ge.current===a&&(U(ge),Wc._currentValue=ie)}var He,ut;function z(a){if(He===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);He=c&&c[1]||"",ut=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+He+a+ut}var fe=!1;function ue(a,c){if(!a||fe)return"";fe=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(de){var ce=de}Reflect.construct(a,[],ve)}else{try{ve.call()}catch(de){ce=de}a.call(ve.prototype)}}else{try{throw Error()}catch(de){ce=de}(ve=a())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(de){if(de&&ce&&typeof de.stack=="string")return[de.stack,ce.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var k=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");k&&k.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var N=x.DetermineComponentFrameRoot(),I=N[0],$=N[1];if(I&&$){var G=I.split(`
`),le=$.split(`
`);for(k=x=0;x<G.length&&!G[x].includes("DetermineComponentFrameRoot");)x++;for(;k<le.length&&!le[k].includes("DetermineComponentFrameRoot");)k++;if(x===G.length||k===le.length)for(x=G.length-1,k=le.length-1;1<=x&&0<=k&&G[x]!==le[k];)k--;for(;1<=x&&0<=k;x--,k--)if(G[x]!==le[k]){if(x!==1||k!==1)do if(x--,k--,0>k||G[x]!==le[k]){var he=`
`+G[x].replace(" at new "," at ");return a.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",a.displayName)),he}while(1<=x&&0<=k);break}}}finally{fe=!1,Error.prepareStackTrace=h}return(h=a?a.displayName||a.name:"")?z(h):""}function W(a,c){switch(a.tag){case 26:case 27:case 5:return z(a.type);case 16:return z("Lazy");case 13:return a.child!==c&&c!==null?z("Suspense Fallback"):z("Suspense");case 19:return z("SuspenseList");case 0:case 15:return ue(a.type,!1);case 11:return ue(a.type.render,!1);case 1:return ue(a.type,!0);case 31:return z("Activity");default:return""}}function Q(a){try{var c="",h=null;do c+=W(a,h),h=a,a=a.return;while(a);return c}catch(x){return`
Error generating stack: `+x.message+`
`+x.stack}}var ee=Object.prototype.hasOwnProperty,pe=t.unstable_scheduleCallback,we=t.unstable_cancelCallback,ae=t.unstable_shouldYield,xe=t.unstable_requestPaint,Ce=t.unstable_now,Te=t.unstable_getCurrentPriorityLevel,Ie=t.unstable_ImmediatePriority,Ze=t.unstable_UserBlockingPriority,Ue=t.unstable_NormalPriority,$t=t.unstable_LowPriority,Zr=t.unstable_IdlePriority,Bt=t.log,hs=t.unstable_setDisableYieldValue,dt=null,qt=null;function Nn(a){if(typeof Bt=="function"&&hs(a),qt&&typeof qt.setStrictMode=="function")try{qt.setStrictMode(dt,a)}catch{}}var Nt=Math.clz32?Math.clz32:lc,jo=Math.log,Eo=Math.LN2;function lc(a){return a>>>=0,a===0?32:31-(jo(a)/Eo|0)|0}var vi=256,_s=262144,vt=4194304;function Tt(a){var c=a&42;if(c!==0)return c;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function on(a,c,h){var x=a.pendingLanes;if(x===0)return 0;var k=0,N=a.suspendedLanes,I=a.pingedLanes;a=a.warmLanes;var $=x&134217727;return $!==0?(x=$&~N,x!==0?k=Tt(x):(I&=$,I!==0?k=Tt(I):h||(h=$&~a,h!==0&&(k=Tt(h))))):($=x&~N,$!==0?k=Tt($):I!==0?k=Tt(I):h||(h=x&~a,h!==0&&(k=Tt(h)))),k===0?0:c!==0&&c!==k&&(c&N)===0&&(N=k&-k,h=c&-c,N>=h||N===32&&(h&4194048)!==0)?c:k}function Kn(a,c){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&c)===0}function Qn(a,c){switch(a){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tn(){var a=vt;return vt<<=1,(vt&62914560)===0&&(vt=4194304),a}function Wn(a){for(var c=[],h=0;31>h;h++)c.push(a);return c}function Nr(a,c){a.pendingLanes|=c,c!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function en(a,c,h,x,k,N){var I=a.pendingLanes;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=h,a.entangledLanes&=h,a.errorRecoveryDisabledLanes&=h,a.shellSuspendCounter=0;var $=a.entanglements,G=a.expirationTimes,le=a.hiddenUpdates;for(h=I&~h;0<h;){var he=31-Nt(h),ve=1<<he;$[he]=0,G[he]=-1;var ce=le[he];if(ce!==null)for(le[he]=null,he=0;he<ce.length;he++){var de=ce[he];de!==null&&(de.lane&=-536870913)}h&=~ve}x!==0&&es(a,x,0),N!==0&&k===0&&a.tag!==0&&(a.suspendedLanes|=N&~(I&~c))}function es(a,c,h){a.pendingLanes|=c,a.suspendedLanes&=~c;var x=31-Nt(c);a.entangledLanes|=c,a.entanglements[x]=a.entanglements[x]|1073741824|h&261930}function dr(a,c){var h=a.entangledLanes|=c;for(a=a.entanglements;h;){var x=31-Nt(h),k=1<<x;k&c|a[x]&c&&(a[x]|=c),h&=~k}}function Tr(a,c){var h=c&-c;return h=(h&42)!==0?1:Os(h),(h&(a.suspendedLanes|c))!==0?0:h}function Os(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Is(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function ts(){var a=V.p;return a!==0?a:(a=window.event,a===void 0?32:Yk(a.type))}function wi(a,c){var h=V.p;try{return V.p=a,c()}finally{V.p=h}}var jr=Math.random().toString(36).slice(2),gn="__reactFiber$"+jr,Yn="__reactProps$"+jr,Mo="__reactContainer$"+jr,mg="__reactEvents$"+jr,Z5="__reactListeners$"+jr,eR="__reactHandles$"+jr,f1="__reactResources$"+jr,cc="__reactMarker$"+jr;function yg(a){delete a[gn],delete a[Yn],delete a[mg],delete a[Z5],delete a[eR]}function Ao(a){var c=a[gn];if(c)return c;for(var h=a.parentNode;h;){if(c=h[Mo]||h[gn]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(a=Ok(a);a!==null;){if(h=a[gn])return h;a=Ok(a)}return c}a=h,h=a.parentNode}return null}function Ro(a){if(a=a[gn]||a[Mo]){var c=a.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return a}return null}function uc(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a.stateNode;throw Error(r(33))}function _o(a){var c=a[f1];return c||(c=a[f1]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function ln(a){a[cc]=!0}var h1=new Set,p1={};function va(a,c){Oo(a,c),Oo(a+"Capture",c)}function Oo(a,c){for(p1[a]=c,a=0;a<c.length;a++)h1.add(c[a])}var tR=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),g1={},m1={};function nR(a){return ee.call(m1,a)?!0:ee.call(g1,a)?!1:tR.test(a)?m1[a]=!0:(g1[a]=!0,!1)}function vd(a,c,h){if(nR(c))if(h===null)a.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":a.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){a.removeAttribute(c);return}}a.setAttribute(c,""+h)}}function wd(a,c,h){if(h===null)a.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttribute(c,""+h)}}function Ds(a,c,h,x){if(x===null)a.removeAttribute(h);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(h);return}a.setAttributeNS(c,h,""+x)}}function Er(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function y1(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function rR(a,c,h){var x=Object.getOwnPropertyDescriptor(a.constructor.prototype,c);if(!a.hasOwnProperty(c)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var k=x.get,N=x.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return k.call(this)},set:function(I){h=""+I,N.call(this,I)}}),Object.defineProperty(a,c,{enumerable:x.enumerable}),{getValue:function(){return h},setValue:function(I){h=""+I},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function xg(a){if(!a._valueTracker){var c=y1(a)?"checked":"value";a._valueTracker=rR(a,c,""+a[c])}}function x1(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var h=c.getValue(),x="";return a&&(x=y1(a)?a.checked?"true":"false":a.value),a=x,a!==h?(c.setValue(a),!0):!1}function Sd(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var sR=/[\n"\\]/g;function Mr(a){return a.replace(sR,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function bg(a,c,h,x,k,N,I,$){a.name="",I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?a.type=I:a.removeAttribute("type"),c!=null?I==="number"?(c===0&&a.value===""||a.value!=c)&&(a.value=""+Er(c)):a.value!==""+Er(c)&&(a.value=""+Er(c)):I!=="submit"&&I!=="reset"||a.removeAttribute("value"),c!=null?vg(a,I,Er(c)):h!=null?vg(a,I,Er(h)):x!=null&&a.removeAttribute("value"),k==null&&N!=null&&(a.defaultChecked=!!N),k!=null&&(a.checked=k&&typeof k!="function"&&typeof k!="symbol"),$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?a.name=""+Er($):a.removeAttribute("name")}function b1(a,c,h,x,k,N,I,$){if(N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(a.type=N),c!=null||h!=null){if(!(N!=="submit"&&N!=="reset"||c!=null)){xg(a);return}h=h!=null?""+Er(h):"",c=c!=null?""+Er(c):h,$||c===a.value||(a.value=c),a.defaultValue=c}x=x??k,x=typeof x!="function"&&typeof x!="symbol"&&!!x,a.checked=$?a.checked:!!x,a.defaultChecked=!!x,I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(a.name=I),xg(a)}function vg(a,c,h){c==="number"&&Sd(a.ownerDocument)===a||a.defaultValue===""+h||(a.defaultValue=""+h)}function Io(a,c,h,x){if(a=a.options,c){c={};for(var k=0;k<h.length;k++)c["$"+h[k]]=!0;for(h=0;h<a.length;h++)k=c.hasOwnProperty("$"+a[h].value),a[h].selected!==k&&(a[h].selected=k),k&&x&&(a[h].defaultSelected=!0)}else{for(h=""+Er(h),c=null,k=0;k<a.length;k++){if(a[k].value===h){a[k].selected=!0,x&&(a[k].defaultSelected=!0);return}c!==null||a[k].disabled||(c=a[k])}c!==null&&(c.selected=!0)}}function v1(a,c,h){if(c!=null&&(c=""+Er(c),c!==a.value&&(a.value=c),h==null)){a.defaultValue!==c&&(a.defaultValue=c);return}a.defaultValue=h!=null?""+Er(h):""}function w1(a,c,h,x){if(c==null){if(x!=null){if(h!=null)throw Error(r(92));if(K(x)){if(1<x.length)throw Error(r(93));x=x[0]}h=x}h==null&&(h=""),c=h}h=Er(c),a.defaultValue=h,x=a.textContent,x===h&&x!==""&&x!==null&&(a.value=x),xg(a)}function Do(a,c){if(c){var h=a.firstChild;if(h&&h===a.lastChild&&h.nodeType===3){h.nodeValue=c;return}}a.textContent=c}var iR=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function S1(a,c,h){var x=c.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?x?a.setProperty(c,""):c==="float"?a.cssFloat="":a[c]="":x?a.setProperty(c,h):typeof h!="number"||h===0||iR.has(c)?c==="float"?a.cssFloat=h:a[c]=(""+h).trim():a[c]=h+"px"}function k1(a,c,h){if(c!=null&&typeof c!="object")throw Error(r(62));if(a=a.style,h!=null){for(var x in h)!h.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?a.setProperty(x,""):x==="float"?a.cssFloat="":a[x]="");for(var k in c)x=c[k],c.hasOwnProperty(k)&&h[k]!==x&&S1(a,k,x)}else for(var N in c)c.hasOwnProperty(N)&&S1(a,N,c[N])}function wg(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var aR=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),oR=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function kd(a){return oR.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Ls(){}var Sg=null;function kg(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Lo=null,zo=null;function C1(a){var c=Ro(a);if(c&&(a=c.stateNode)){var h=a[Yn]||null;e:switch(a=c.stateNode,c.type){case"input":if(bg(a,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),c=h.name,h.type==="radio"&&c!=null){for(h=a;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Mr(""+c)+'"][type="radio"]'),c=0;c<h.length;c++){var x=h[c];if(x!==a&&x.form===a.form){var k=x[Yn]||null;if(!k)throw Error(r(90));bg(x,k.value,k.defaultValue,k.defaultValue,k.checked,k.defaultChecked,k.type,k.name)}}for(c=0;c<h.length;c++)x=h[c],x.form===a.form&&x1(x)}break e;case"textarea":v1(a,h.value,h.defaultValue);break e;case"select":c=h.value,c!=null&&Io(a,!!h.multiple,c,!1)}}}var Cg=!1;function N1(a,c,h){if(Cg)return a(c,h);Cg=!0;try{var x=a(c);return x}finally{if(Cg=!1,(Lo!==null||zo!==null)&&(df(),Lo&&(c=Lo,a=zo,zo=Lo=null,C1(c),a)))for(c=0;c<a.length;c++)C1(a[c])}}function dc(a,c){var h=a.stateNode;if(h===null)return null;var x=h[Yn]||null;if(x===null)return null;h=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(a=a.type,x=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!x;break e;default:a=!1}if(a)return null;if(h&&typeof h!="function")throw Error(r(231,c,typeof h));return h}var zs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ng=!1;if(zs)try{var fc={};Object.defineProperty(fc,"passive",{get:function(){Ng=!0}}),window.addEventListener("test",fc,fc),window.removeEventListener("test",fc,fc)}catch{Ng=!1}var Si=null,Tg=null,Cd=null;function T1(){if(Cd)return Cd;var a,c=Tg,h=c.length,x,k="value"in Si?Si.value:Si.textContent,N=k.length;for(a=0;a<h&&c[a]===k[a];a++);var I=h-a;for(x=1;x<=I&&c[h-x]===k[N-x];x++);return Cd=k.slice(a,1<x?1-x:void 0)}function Nd(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function Td(){return!0}function j1(){return!1}function Gn(a){function c(h,x,k,N,I){this._reactName=h,this._targetInst=k,this.type=x,this.nativeEvent=N,this.target=I,this.currentTarget=null;for(var $ in a)a.hasOwnProperty($)&&(h=a[$],this[$]=h?h(N):N[$]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?Td:j1,this.isPropagationStopped=j1,this}return g(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Td)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Td)},persist:function(){},isPersistent:Td}),c}var wa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jd=Gn(wa),hc=g({},wa,{view:0,detail:0}),lR=Gn(hc),jg,Eg,pc,Ed=g({},hc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ag,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==pc&&(pc&&a.type==="mousemove"?(jg=a.screenX-pc.screenX,Eg=a.screenY-pc.screenY):Eg=jg=0,pc=a),jg)},movementY:function(a){return"movementY"in a?a.movementY:Eg}}),E1=Gn(Ed),cR=g({},Ed,{dataTransfer:0}),uR=Gn(cR),dR=g({},hc,{relatedTarget:0}),Mg=Gn(dR),fR=g({},wa,{animationName:0,elapsedTime:0,pseudoElement:0}),hR=Gn(fR),pR=g({},wa,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),gR=Gn(pR),mR=g({},wa,{data:0}),M1=Gn(mR),yR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vR(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=bR[a])?!!c[a]:!1}function Ag(){return vR}var wR=g({},hc,{key:function(a){if(a.key){var c=yR[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=Nd(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?xR[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ag,charCode:function(a){return a.type==="keypress"?Nd(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Nd(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),SR=Gn(wR),kR=g({},Ed,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),A1=Gn(kR),CR=g({},hc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ag}),NR=Gn(CR),TR=g({},wa,{propertyName:0,elapsedTime:0,pseudoElement:0}),jR=Gn(TR),ER=g({},Ed,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),MR=Gn(ER),AR=g({},wa,{newState:0,oldState:0}),RR=Gn(AR),_R=[9,13,27,32],Rg=zs&&"CompositionEvent"in window,gc=null;zs&&"documentMode"in document&&(gc=document.documentMode);var OR=zs&&"TextEvent"in window&&!gc,R1=zs&&(!Rg||gc&&8<gc&&11>=gc),_1=" ",O1=!1;function I1(a,c){switch(a){case"keyup":return _R.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function D1(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Po=!1;function IR(a,c){switch(a){case"compositionend":return D1(c);case"keypress":return c.which!==32?null:(O1=!0,_1);case"textInput":return a=c.data,a===_1&&O1?null:a;default:return null}}function DR(a,c){if(Po)return a==="compositionend"||!Rg&&I1(a,c)?(a=T1(),Cd=Tg=Si=null,Po=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return R1&&c.locale!=="ko"?null:c.data;default:return null}}var LR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function L1(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!LR[a.type]:c==="textarea"}function z1(a,c,h,x){Lo?zo?zo.push(x):zo=[x]:Lo=x,c=xf(c,"onChange"),0<c.length&&(h=new jd("onChange","change",null,h,x),a.push({event:h,listeners:c}))}var mc=null,yc=null;function zR(a){bk(a,0)}function Md(a){var c=uc(a);if(x1(c))return a}function P1(a,c){if(a==="change")return c}var B1=!1;if(zs){var _g;if(zs){var Og="oninput"in document;if(!Og){var F1=document.createElement("div");F1.setAttribute("oninput","return;"),Og=typeof F1.oninput=="function"}_g=Og}else _g=!1;B1=_g&&(!document.documentMode||9<document.documentMode)}function U1(){mc&&(mc.detachEvent("onpropertychange",$1),yc=mc=null)}function $1(a){if(a.propertyName==="value"&&Md(yc)){var c=[];z1(c,yc,a,kg(a)),N1(zR,c)}}function PR(a,c,h){a==="focusin"?(U1(),mc=c,yc=h,mc.attachEvent("onpropertychange",$1)):a==="focusout"&&U1()}function BR(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Md(yc)}function FR(a,c){if(a==="click")return Md(c)}function UR(a,c){if(a==="input"||a==="change")return Md(c)}function $R(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var fr=typeof Object.is=="function"?Object.is:$R;function xc(a,c){if(fr(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var h=Object.keys(a),x=Object.keys(c);if(h.length!==x.length)return!1;for(x=0;x<h.length;x++){var k=h[x];if(!ee.call(c,k)||!fr(a[k],c[k]))return!1}return!0}function q1(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function H1(a,c){var h=q1(a);a=0;for(var x;h;){if(h.nodeType===3){if(x=a+h.textContent.length,a<=c&&x>=c)return{node:h,offset:c-a};a=x}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=q1(h)}}function V1(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?V1(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function K1(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var c=Sd(a.document);c instanceof a.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)a=c.contentWindow;else break;c=Sd(a.document)}return c}function Ig(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}var qR=zs&&"documentMode"in document&&11>=document.documentMode,Bo=null,Dg=null,bc=null,Lg=!1;function Q1(a,c,h){var x=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Lg||Bo==null||Bo!==Sd(x)||(x=Bo,"selectionStart"in x&&Ig(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),bc&&xc(bc,x)||(bc=x,x=xf(Dg,"onSelect"),0<x.length&&(c=new jd("onSelect","select",null,c,h),a.push({event:c,listeners:x}),c.target=Bo)))}function Sa(a,c){var h={};return h[a.toLowerCase()]=c.toLowerCase(),h["Webkit"+a]="webkit"+c,h["Moz"+a]="moz"+c,h}var Fo={animationend:Sa("Animation","AnimationEnd"),animationiteration:Sa("Animation","AnimationIteration"),animationstart:Sa("Animation","AnimationStart"),transitionrun:Sa("Transition","TransitionRun"),transitionstart:Sa("Transition","TransitionStart"),transitioncancel:Sa("Transition","TransitionCancel"),transitionend:Sa("Transition","TransitionEnd")},zg={},W1={};zs&&(W1=document.createElement("div").style,"AnimationEvent"in window||(delete Fo.animationend.animation,delete Fo.animationiteration.animation,delete Fo.animationstart.animation),"TransitionEvent"in window||delete Fo.transitionend.transition);function ka(a){if(zg[a])return zg[a];if(!Fo[a])return a;var c=Fo[a],h;for(h in c)if(c.hasOwnProperty(h)&&h in W1)return zg[a]=c[h];return a}var Y1=ka("animationend"),G1=ka("animationiteration"),X1=ka("animationstart"),HR=ka("transitionrun"),VR=ka("transitionstart"),KR=ka("transitioncancel"),J1=ka("transitionend"),Z1=new Map,Pg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pg.push("scrollEnd");function ns(a,c){Z1.set(a,c),va(c,[a])}var Ad=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Ar=[],Uo=0,Bg=0;function Rd(){for(var a=Uo,c=Bg=Uo=0;c<a;){var h=Ar[c];Ar[c++]=null;var x=Ar[c];Ar[c++]=null;var k=Ar[c];Ar[c++]=null;var N=Ar[c];if(Ar[c++]=null,x!==null&&k!==null){var I=x.pending;I===null?k.next=k:(k.next=I.next,I.next=k),x.pending=k}N!==0&&ew(h,k,N)}}function _d(a,c,h,x){Ar[Uo++]=a,Ar[Uo++]=c,Ar[Uo++]=h,Ar[Uo++]=x,Bg|=x,a.lanes|=x,a=a.alternate,a!==null&&(a.lanes|=x)}function Fg(a,c,h,x){return _d(a,c,h,x),Od(a)}function Ca(a,c){return _d(a,null,null,c),Od(a)}function ew(a,c,h){a.lanes|=h;var x=a.alternate;x!==null&&(x.lanes|=h);for(var k=!1,N=a.return;N!==null;)N.childLanes|=h,x=N.alternate,x!==null&&(x.childLanes|=h),N.tag===22&&(a=N.stateNode,a===null||a._visibility&1||(k=!0)),a=N,N=N.return;return a.tag===3?(N=a.stateNode,k&&c!==null&&(k=31-Nt(h),a=N.hiddenUpdates,x=a[k],x===null?a[k]=[c]:x.push(c),c.lane=h|536870912),N):null}function Od(a){if(50<Uc)throw Uc=0,Ym=null,Error(r(185));for(var c=a.return;c!==null;)a=c,c=a.return;return a.tag===3?a.stateNode:null}var $o={};function QR(a,c,h,x){this.tag=a,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(a,c,h,x){return new QR(a,c,h,x)}function Ug(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Ps(a,c){var h=a.alternate;return h===null?(h=hr(a.tag,c,a.key,a.mode),h.elementType=a.elementType,h.type=a.type,h.stateNode=a.stateNode,h.alternate=a,a.alternate=h):(h.pendingProps=c,h.type=a.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=a.flags&65011712,h.childLanes=a.childLanes,h.lanes=a.lanes,h.child=a.child,h.memoizedProps=a.memoizedProps,h.memoizedState=a.memoizedState,h.updateQueue=a.updateQueue,c=a.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=a.sibling,h.index=a.index,h.ref=a.ref,h.refCleanup=a.refCleanup,h}function tw(a,c){a.flags&=65011714;var h=a.alternate;return h===null?(a.childLanes=0,a.lanes=c,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=h.childLanes,a.lanes=h.lanes,a.child=h.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=h.memoizedProps,a.memoizedState=h.memoizedState,a.updateQueue=h.updateQueue,a.type=h.type,c=h.dependencies,a.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),a}function Id(a,c,h,x,k,N){var I=0;if(x=a,typeof a=="function")Ug(a)&&(I=1);else if(typeof a=="string")I=J_(a,h,Z.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case A:return a=hr(31,h,c,k),a.elementType=A,a.lanes=N,a;case v:return Na(h.children,k,N,c);case w:I=8,k|=24;break;case S:return a=hr(12,h,c,k|2),a.elementType=S,a.lanes=N,a;case _:return a=hr(13,h,c,k),a.elementType=_,a.lanes=N,a;case R:return a=hr(19,h,c,k),a.elementType=R,a.lanes=N,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case j:I=10;break e;case T:I=9;break e;case M:I=11;break e;case O:I=14;break e;case L:I=16,x=null;break e}I=29,h=Error(r(130,a===null?"null":typeof a,"")),x=null}return c=hr(I,h,c,k),c.elementType=a,c.type=x,c.lanes=N,c}function Na(a,c,h,x){return a=hr(7,a,x,c),a.lanes=h,a}function $g(a,c,h){return a=hr(6,a,null,c),a.lanes=h,a}function nw(a){var c=hr(18,null,null,0);return c.stateNode=a,c}function qg(a,c,h){return c=hr(4,a.children!==null?a.children:[],a.key,c),c.lanes=h,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}var rw=new WeakMap;function Rr(a,c){if(typeof a=="object"&&a!==null){var h=rw.get(a);return h!==void 0?h:(c={value:a,source:c,stack:Q(c)},rw.set(a,c),c)}return{value:a,source:c,stack:Q(c)}}var qo=[],Ho=0,Dd=null,vc=0,_r=[],Or=0,ki=null,ps=1,gs="";function Bs(a,c){qo[Ho++]=vc,qo[Ho++]=Dd,Dd=a,vc=c}function sw(a,c,h){_r[Or++]=ps,_r[Or++]=gs,_r[Or++]=ki,ki=a;var x=ps;a=gs;var k=32-Nt(x)-1;x&=~(1<<k),h+=1;var N=32-Nt(c)+k;if(30<N){var I=k-k%5;N=(x&(1<<I)-1).toString(32),x>>=I,k-=I,ps=1<<32-Nt(c)+k|h<<k|x,gs=N+a}else ps=1<<N|h<<k|x,gs=a}function Hg(a){a.return!==null&&(Bs(a,1),sw(a,1,0))}function Vg(a){for(;a===Dd;)Dd=qo[--Ho],qo[Ho]=null,vc=qo[--Ho],qo[Ho]=null;for(;a===ki;)ki=_r[--Or],_r[Or]=null,gs=_r[--Or],_r[Or]=null,ps=_r[--Or],_r[Or]=null}function iw(a,c){_r[Or++]=ps,_r[Or++]=gs,_r[Or++]=ki,ps=c.id,gs=c.overflow,ki=a}var mn=null,jt=null,rt=!1,Ci=null,Ir=!1,Kg=Error(r(519));function Ni(a){var c=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw wc(Rr(c,a)),Kg}function aw(a){var c=a.stateNode,h=a.type,x=a.memoizedProps;switch(c[gn]=a,c[Yn]=x,h){case"dialog":Je("cancel",c),Je("close",c);break;case"iframe":case"object":case"embed":Je("load",c);break;case"video":case"audio":for(h=0;h<qc.length;h++)Je(qc[h],c);break;case"source":Je("error",c);break;case"img":case"image":case"link":Je("error",c),Je("load",c);break;case"details":Je("toggle",c);break;case"input":Je("invalid",c),b1(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0);break;case"select":Je("invalid",c);break;case"textarea":Je("invalid",c),w1(c,x.value,x.defaultValue,x.children)}h=x.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||c.textContent===""+h||x.suppressHydrationWarning===!0||kk(c.textContent,h)?(x.popover!=null&&(Je("beforetoggle",c),Je("toggle",c)),x.onScroll!=null&&Je("scroll",c),x.onScrollEnd!=null&&Je("scrollend",c),x.onClick!=null&&(c.onclick=Ls),c=!0):c=!1,c||Ni(a,!0)}function ow(a){for(mn=a.return;mn;)switch(mn.tag){case 5:case 31:case 13:Ir=!1;return;case 27:case 3:Ir=!0;return;default:mn=mn.return}}function Vo(a){if(a!==mn)return!1;if(!rt)return ow(a),rt=!0,!1;var c=a.tag,h;if((h=c!==3&&c!==27)&&((h=c===5)&&(h=a.type,h=!(h!=="form"&&h!=="button")||u0(a.type,a.memoizedProps)),h=!h),h&&jt&&Ni(a),ow(a),c===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));jt=_k(a)}else if(c===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));jt=_k(a)}else c===27?(c=jt,Bi(a.type)?(a=g0,g0=null,jt=a):jt=c):jt=mn?Lr(a.stateNode.nextSibling):null;return!0}function Ta(){jt=mn=null,rt=!1}function Qg(){var a=Ci;return a!==null&&(er===null?er=a:er.push.apply(er,a),Ci=null),a}function wc(a){Ci===null?Ci=[a]:Ci.push(a)}var Wg=D(null),ja=null,Fs=null;function Ti(a,c,h){te(Wg,c._currentValue),c._currentValue=h}function Us(a){a._currentValue=Wg.current,U(Wg)}function Yg(a,c,h){for(;a!==null;){var x=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),a===h)break;a=a.return}}function Gg(a,c,h,x){var k=a.child;for(k!==null&&(k.return=a);k!==null;){var N=k.dependencies;if(N!==null){var I=k.child;N=N.firstContext;e:for(;N!==null;){var $=N;N=k;for(var G=0;G<c.length;G++)if($.context===c[G]){N.lanes|=h,$=N.alternate,$!==null&&($.lanes|=h),Yg(N.return,h,a),x||(I=null);break e}N=$.next}}else if(k.tag===18){if(I=k.return,I===null)throw Error(r(341));I.lanes|=h,N=I.alternate,N!==null&&(N.lanes|=h),Yg(I,h,a),I=null}else I=k.child;if(I!==null)I.return=k;else for(I=k;I!==null;){if(I===a){I=null;break}if(k=I.sibling,k!==null){k.return=I.return,I=k;break}I=I.return}k=I}}function Ko(a,c,h,x){a=null;for(var k=c,N=!1;k!==null;){if(!N){if((k.flags&524288)!==0)N=!0;else if((k.flags&262144)!==0)break}if(k.tag===10){var I=k.alternate;if(I===null)throw Error(r(387));if(I=I.memoizedProps,I!==null){var $=k.type;fr(k.pendingProps.value,I.value)||(a!==null?a.push($):a=[$])}}else if(k===ge.current){if(I=k.alternate,I===null)throw Error(r(387));I.memoizedState.memoizedState!==k.memoizedState.memoizedState&&(a!==null?a.push(Wc):a=[Wc])}k=k.return}a!==null&&Gg(c,a,h,x),c.flags|=262144}function Ld(a){for(a=a.firstContext;a!==null;){if(!fr(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Ea(a){ja=a,Fs=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function yn(a){return lw(ja,a)}function zd(a,c){return ja===null&&Ea(a),lw(a,c)}function lw(a,c){var h=c._currentValue;if(c={context:c,memoizedValue:h,next:null},Fs===null){if(a===null)throw Error(r(308));Fs=c,a.dependencies={lanes:0,firstContext:c},a.flags|=524288}else Fs=Fs.next=c;return h}var WR=typeof AbortController<"u"?AbortController:function(){var a=[],c=this.signal={aborted:!1,addEventListener:function(h,x){a.push(x)}};this.abort=function(){c.aborted=!0,a.forEach(function(h){return h()})}},YR=t.unstable_scheduleCallback,GR=t.unstable_NormalPriority,Ht={$$typeof:j,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xg(){return{controller:new WR,data:new Map,refCount:0}}function Sc(a){a.refCount--,a.refCount===0&&YR(GR,function(){a.controller.abort()})}var kc=null,Jg=0,Qo=0,Wo=null;function XR(a,c){if(kc===null){var h=kc=[];Jg=0,Qo=t0(),Wo={status:"pending",value:void 0,then:function(x){h.push(x)}}}return Jg++,c.then(cw,cw),c}function cw(){if(--Jg===0&&kc!==null){Wo!==null&&(Wo.status="fulfilled");var a=kc;kc=null,Qo=0,Wo=null;for(var c=0;c<a.length;c++)(0,a[c])()}}function JR(a,c){var h=[],x={status:"pending",value:null,reason:null,then:function(k){h.push(k)}};return a.then(function(){x.status="fulfilled",x.value=c;for(var k=0;k<h.length;k++)(0,h[k])(c)},function(k){for(x.status="rejected",x.reason=k,k=0;k<h.length;k++)(0,h[k])(void 0)}),x}var uw=q.S;q.S=function(a,c){QS=Ce(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&XR(a,c),uw!==null&&uw(a,c)};var Ma=D(null);function Zg(){var a=Ma.current;return a!==null?a:wt.pooledCache}function Pd(a,c){c===null?te(Ma,Ma.current):te(Ma,c.pool)}function dw(){var a=Zg();return a===null?null:{parent:Ht._currentValue,pool:a}}var Yo=Error(r(460)),em=Error(r(474)),Bd=Error(r(542)),Fd={then:function(){}};function fw(a){return a=a.status,a==="fulfilled"||a==="rejected"}function hw(a,c,h){switch(h=a[h],h===void 0?a.push(c):h!==c&&(c.then(Ls,Ls),c=h),c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,gw(a),a;default:if(typeof c.status=="string")c.then(Ls,Ls);else{if(a=wt,a!==null&&100<a.shellSuspendCounter)throw Error(r(482));a=c,a.status="pending",a.then(function(x){if(c.status==="pending"){var k=c;k.status="fulfilled",k.value=x}},function(x){if(c.status==="pending"){var k=c;k.status="rejected",k.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,gw(a),a}throw Ra=c,Yo}}function Aa(a){try{var c=a._init;return c(a._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(Ra=h,Yo):h}}var Ra=null;function pw(){if(Ra===null)throw Error(r(459));var a=Ra;return Ra=null,a}function gw(a){if(a===Yo||a===Bd)throw Error(r(483))}var Go=null,Cc=0;function Ud(a){var c=Cc;return Cc+=1,Go===null&&(Go=[]),hw(Go,a,c)}function Nc(a,c){c=c.props.ref,a.ref=c!==void 0?c:null}function $d(a,c){throw c.$$typeof===m?Error(r(525)):(a=Object.prototype.toString.call(c),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a)))}function mw(a){function c(ne,J){if(a){var oe=ne.deletions;oe===null?(ne.deletions=[J],ne.flags|=16):oe.push(J)}}function h(ne,J){if(!a)return null;for(;J!==null;)c(ne,J),J=J.sibling;return null}function x(ne){for(var J=new Map;ne!==null;)ne.key!==null?J.set(ne.key,ne):J.set(ne.index,ne),ne=ne.sibling;return J}function k(ne,J){return ne=Ps(ne,J),ne.index=0,ne.sibling=null,ne}function N(ne,J,oe){return ne.index=oe,a?(oe=ne.alternate,oe!==null?(oe=oe.index,oe<J?(ne.flags|=67108866,J):oe):(ne.flags|=67108866,J)):(ne.flags|=1048576,J)}function I(ne){return a&&ne.alternate===null&&(ne.flags|=67108866),ne}function $(ne,J,oe,ye){return J===null||J.tag!==6?(J=$g(oe,ne.mode,ye),J.return=ne,J):(J=k(J,oe),J.return=ne,J)}function G(ne,J,oe,ye){var ze=oe.type;return ze===v?he(ne,J,oe.props.children,ye,oe.key):J!==null&&(J.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===L&&Aa(ze)===J.type)?(J=k(J,oe.props),Nc(J,oe),J.return=ne,J):(J=Id(oe.type,oe.key,oe.props,null,ne.mode,ye),Nc(J,oe),J.return=ne,J)}function le(ne,J,oe,ye){return J===null||J.tag!==4||J.stateNode.containerInfo!==oe.containerInfo||J.stateNode.implementation!==oe.implementation?(J=qg(oe,ne.mode,ye),J.return=ne,J):(J=k(J,oe.children||[]),J.return=ne,J)}function he(ne,J,oe,ye,ze){return J===null||J.tag!==7?(J=Na(oe,ne.mode,ye,ze),J.return=ne,J):(J=k(J,oe),J.return=ne,J)}function ve(ne,J,oe){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return J=$g(""+J,ne.mode,oe),J.return=ne,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case y:return oe=Id(J.type,J.key,J.props,null,ne.mode,oe),Nc(oe,J),oe.return=ne,oe;case b:return J=qg(J,ne.mode,oe),J.return=ne,J;case L:return J=Aa(J),ve(ne,J,oe)}if(K(J)||P(J))return J=Na(J,ne.mode,oe,null),J.return=ne,J;if(typeof J.then=="function")return ve(ne,Ud(J),oe);if(J.$$typeof===j)return ve(ne,zd(ne,J),oe);$d(ne,J)}return null}function ce(ne,J,oe,ye){var ze=J!==null?J.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return ze!==null?null:$(ne,J,""+oe,ye);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case y:return oe.key===ze?G(ne,J,oe,ye):null;case b:return oe.key===ze?le(ne,J,oe,ye):null;case L:return oe=Aa(oe),ce(ne,J,oe,ye)}if(K(oe)||P(oe))return ze!==null?null:he(ne,J,oe,ye,null);if(typeof oe.then=="function")return ce(ne,J,Ud(oe),ye);if(oe.$$typeof===j)return ce(ne,J,zd(ne,oe),ye);$d(ne,oe)}return null}function de(ne,J,oe,ye,ze){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ne=ne.get(oe)||null,$(J,ne,""+ye,ze);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case y:return ne=ne.get(ye.key===null?oe:ye.key)||null,G(J,ne,ye,ze);case b:return ne=ne.get(ye.key===null?oe:ye.key)||null,le(J,ne,ye,ze);case L:return ye=Aa(ye),de(ne,J,oe,ye,ze)}if(K(ye)||P(ye))return ne=ne.get(oe)||null,he(J,ne,ye,ze,null);if(typeof ye.then=="function")return de(ne,J,oe,Ud(ye),ze);if(ye.$$typeof===j)return de(ne,J,oe,zd(J,ye),ze);$d(J,ye)}return null}function Re(ne,J,oe,ye){for(var ze=null,at=null,_e=J,We=J=0,tt=null;_e!==null&&We<oe.length;We++){_e.index>We?(tt=_e,_e=null):tt=_e.sibling;var ot=ce(ne,_e,oe[We],ye);if(ot===null){_e===null&&(_e=tt);break}a&&_e&&ot.alternate===null&&c(ne,_e),J=N(ot,J,We),at===null?ze=ot:at.sibling=ot,at=ot,_e=tt}if(We===oe.length)return h(ne,_e),rt&&Bs(ne,We),ze;if(_e===null){for(;We<oe.length;We++)_e=ve(ne,oe[We],ye),_e!==null&&(J=N(_e,J,We),at===null?ze=_e:at.sibling=_e,at=_e);return rt&&Bs(ne,We),ze}for(_e=x(_e);We<oe.length;We++)tt=de(_e,ne,We,oe[We],ye),tt!==null&&(a&&tt.alternate!==null&&_e.delete(tt.key===null?We:tt.key),J=N(tt,J,We),at===null?ze=tt:at.sibling=tt,at=tt);return a&&_e.forEach(function(Hi){return c(ne,Hi)}),rt&&Bs(ne,We),ze}function Fe(ne,J,oe,ye){if(oe==null)throw Error(r(151));for(var ze=null,at=null,_e=J,We=J=0,tt=null,ot=oe.next();_e!==null&&!ot.done;We++,ot=oe.next()){_e.index>We?(tt=_e,_e=null):tt=_e.sibling;var Hi=ce(ne,_e,ot.value,ye);if(Hi===null){_e===null&&(_e=tt);break}a&&_e&&Hi.alternate===null&&c(ne,_e),J=N(Hi,J,We),at===null?ze=Hi:at.sibling=Hi,at=Hi,_e=tt}if(ot.done)return h(ne,_e),rt&&Bs(ne,We),ze;if(_e===null){for(;!ot.done;We++,ot=oe.next())ot=ve(ne,ot.value,ye),ot!==null&&(J=N(ot,J,We),at===null?ze=ot:at.sibling=ot,at=ot);return rt&&Bs(ne,We),ze}for(_e=x(_e);!ot.done;We++,ot=oe.next())ot=de(_e,ne,We,ot.value,ye),ot!==null&&(a&&ot.alternate!==null&&_e.delete(ot.key===null?We:ot.key),J=N(ot,J,We),at===null?ze=ot:at.sibling=ot,at=ot);return a&&_e.forEach(function(c4){return c(ne,c4)}),rt&&Bs(ne,We),ze}function bt(ne,J,oe,ye){if(typeof oe=="object"&&oe!==null&&oe.type===v&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case y:e:{for(var ze=oe.key;J!==null;){if(J.key===ze){if(ze=oe.type,ze===v){if(J.tag===7){h(ne,J.sibling),ye=k(J,oe.props.children),ye.return=ne,ne=ye;break e}}else if(J.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===L&&Aa(ze)===J.type){h(ne,J.sibling),ye=k(J,oe.props),Nc(ye,oe),ye.return=ne,ne=ye;break e}h(ne,J);break}else c(ne,J);J=J.sibling}oe.type===v?(ye=Na(oe.props.children,ne.mode,ye,oe.key),ye.return=ne,ne=ye):(ye=Id(oe.type,oe.key,oe.props,null,ne.mode,ye),Nc(ye,oe),ye.return=ne,ne=ye)}return I(ne);case b:e:{for(ze=oe.key;J!==null;){if(J.key===ze)if(J.tag===4&&J.stateNode.containerInfo===oe.containerInfo&&J.stateNode.implementation===oe.implementation){h(ne,J.sibling),ye=k(J,oe.children||[]),ye.return=ne,ne=ye;break e}else{h(ne,J);break}else c(ne,J);J=J.sibling}ye=qg(oe,ne.mode,ye),ye.return=ne,ne=ye}return I(ne);case L:return oe=Aa(oe),bt(ne,J,oe,ye)}if(K(oe))return Re(ne,J,oe,ye);if(P(oe)){if(ze=P(oe),typeof ze!="function")throw Error(r(150));return oe=ze.call(oe),Fe(ne,J,oe,ye)}if(typeof oe.then=="function")return bt(ne,J,Ud(oe),ye);if(oe.$$typeof===j)return bt(ne,J,zd(ne,oe),ye);$d(ne,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,J!==null&&J.tag===6?(h(ne,J.sibling),ye=k(J,oe),ye.return=ne,ne=ye):(h(ne,J),ye=$g(oe,ne.mode,ye),ye.return=ne,ne=ye),I(ne)):h(ne,J)}return function(ne,J,oe,ye){try{Cc=0;var ze=bt(ne,J,oe,ye);return Go=null,ze}catch(_e){if(_e===Yo||_e===Bd)throw _e;var at=hr(29,_e,null,ne.mode);return at.lanes=ye,at.return=ne,at}finally{}}}var _a=mw(!0),yw=mw(!1),ji=!1;function tm(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function nm(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Ei(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Mi(a,c,h){var x=a.updateQueue;if(x===null)return null;if(x=x.shared,(ct&2)!==0){var k=x.pending;return k===null?c.next=c:(c.next=k.next,k.next=c),x.pending=c,c=Od(a),ew(a,null,h),c}return _d(a,x,c,h),Od(a)}function Tc(a,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194048)!==0)){var x=c.lanes;x&=a.pendingLanes,h|=x,c.lanes=h,dr(a,h)}}function rm(a,c){var h=a.updateQueue,x=a.alternate;if(x!==null&&(x=x.updateQueue,h===x)){var k=null,N=null;if(h=h.firstBaseUpdate,h!==null){do{var I={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};N===null?k=N=I:N=N.next=I,h=h.next}while(h!==null);N===null?k=N=c:N=N.next=c}else k=N=c;h={baseState:x.baseState,firstBaseUpdate:k,lastBaseUpdate:N,shared:x.shared,callbacks:x.callbacks},a.updateQueue=h;return}a=h.lastBaseUpdate,a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=c}var sm=!1;function jc(){if(sm){var a=Wo;if(a!==null)throw a}}function Ec(a,c,h,x){sm=!1;var k=a.updateQueue;ji=!1;var N=k.firstBaseUpdate,I=k.lastBaseUpdate,$=k.shared.pending;if($!==null){k.shared.pending=null;var G=$,le=G.next;G.next=null,I===null?N=le:I.next=le,I=G;var he=a.alternate;he!==null&&(he=he.updateQueue,$=he.lastBaseUpdate,$!==I&&($===null?he.firstBaseUpdate=le:$.next=le,he.lastBaseUpdate=G))}if(N!==null){var ve=k.baseState;I=0,he=le=G=null,$=N;do{var ce=$.lane&-536870913,de=ce!==$.lane;if(de?(et&ce)===ce:(x&ce)===ce){ce!==0&&ce===Qo&&(sm=!0),he!==null&&(he=he.next={lane:0,tag:$.tag,payload:$.payload,callback:null,next:null});e:{var Re=a,Fe=$;ce=c;var bt=h;switch(Fe.tag){case 1:if(Re=Fe.payload,typeof Re=="function"){ve=Re.call(bt,ve,ce);break e}ve=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=Fe.payload,ce=typeof Re=="function"?Re.call(bt,ve,ce):Re,ce==null)break e;ve=g({},ve,ce);break e;case 2:ji=!0}}ce=$.callback,ce!==null&&(a.flags|=64,de&&(a.flags|=8192),de=k.callbacks,de===null?k.callbacks=[ce]:de.push(ce))}else de={lane:ce,tag:$.tag,payload:$.payload,callback:$.callback,next:null},he===null?(le=he=de,G=ve):he=he.next=de,I|=ce;if($=$.next,$===null){if($=k.shared.pending,$===null)break;de=$,$=de.next,de.next=null,k.lastBaseUpdate=de,k.shared.pending=null}}while(!0);he===null&&(G=ve),k.baseState=G,k.firstBaseUpdate=le,k.lastBaseUpdate=he,N===null&&(k.shared.lanes=0),Ii|=I,a.lanes=I,a.memoizedState=ve}}function xw(a,c){if(typeof a!="function")throw Error(r(191,a));a.call(c)}function bw(a,c){var h=a.callbacks;if(h!==null)for(a.callbacks=null,a=0;a<h.length;a++)xw(h[a],c)}var Xo=D(null),qd=D(0);function vw(a,c){a=Gs,te(qd,a),te(Xo,c),Gs=a|c.baseLanes}function im(){te(qd,Gs),te(Xo,Xo.current)}function am(){Gs=qd.current,U(Xo),U(qd)}var pr=D(null),Dr=null;function Ai(a){var c=a.alternate;te(Ft,Ft.current&1),te(pr,a),Dr===null&&(c===null||Xo.current!==null||c.memoizedState!==null)&&(Dr=a)}function om(a){te(Ft,Ft.current),te(pr,a),Dr===null&&(Dr=a)}function ww(a){a.tag===22?(te(Ft,Ft.current),te(pr,a),Dr===null&&(Dr=a)):Ri()}function Ri(){te(Ft,Ft.current),te(pr,pr.current)}function gr(a){U(pr),Dr===a&&(Dr=null),U(Ft)}var Ft=D(0);function Hd(a){for(var c=a;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h0(h)||p0(h)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var $s=0,Ke=null,yt=null,Vt=null,Vd=!1,Jo=!1,Oa=!1,Kd=0,Mc=0,Zo=null,ZR=0;function Ot(){throw Error(r(321))}function lm(a,c){if(c===null)return!1;for(var h=0;h<c.length&&h<a.length;h++)if(!fr(a[h],c[h]))return!1;return!0}function cm(a,c,h,x,k,N){return $s=N,Ke=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,q.H=a===null||a.memoizedState===null?sS:Cm,Oa=!1,N=h(x,k),Oa=!1,Jo&&(N=kw(c,h,x,k)),Sw(a),N}function Sw(a){q.H=_c;var c=yt!==null&&yt.next!==null;if($s=0,Vt=yt=Ke=null,Vd=!1,Mc=0,Zo=null,c)throw Error(r(300));a===null||Kt||(a=a.dependencies,a!==null&&Ld(a)&&(Kt=!0))}function kw(a,c,h,x){Ke=a;var k=0;do{if(Jo&&(Zo=null),Mc=0,Jo=!1,25<=k)throw Error(r(301));if(k+=1,Vt=yt=null,a.updateQueue!=null){var N=a.updateQueue;N.lastEffect=null,N.events=null,N.stores=null,N.memoCache!=null&&(N.memoCache.index=0)}q.H=iS,N=c(h,x)}while(Jo);return N}function e_(){var a=q.H,c=a.useState()[0];return c=typeof c.then=="function"?Ac(c):c,a=a.useState()[0],(yt!==null?yt.memoizedState:null)!==a&&(Ke.flags|=1024),c}function um(){var a=Kd!==0;return Kd=0,a}function dm(a,c,h){c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~h}function fm(a){if(Vd){for(a=a.memoizedState;a!==null;){var c=a.queue;c!==null&&(c.pending=null),a=a.next}Vd=!1}$s=0,Vt=yt=Ke=null,Jo=!1,Mc=Kd=0,Zo=null}function In(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vt===null?Ke.memoizedState=Vt=a:Vt=Vt.next=a,Vt}function Ut(){if(yt===null){var a=Ke.alternate;a=a!==null?a.memoizedState:null}else a=yt.next;var c=Vt===null?Ke.memoizedState:Vt.next;if(c!==null)Vt=c,yt=a;else{if(a===null)throw Ke.alternate===null?Error(r(467)):Error(r(310));yt=a,a={memoizedState:yt.memoizedState,baseState:yt.baseState,baseQueue:yt.baseQueue,queue:yt.queue,next:null},Vt===null?Ke.memoizedState=Vt=a:Vt=Vt.next=a}return Vt}function Qd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ac(a){var c=Mc;return Mc+=1,Zo===null&&(Zo=[]),a=hw(Zo,a,c),c=Ke,(Vt===null?c.memoizedState:Vt.next)===null&&(c=c.alternate,q.H=c===null||c.memoizedState===null?sS:Cm),a}function Wd(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Ac(a);if(a.$$typeof===j)return yn(a)}throw Error(r(438,String(a)))}function hm(a){var c=null,h=Ke.updateQueue;if(h!==null&&(c=h.memoCache),c==null){var x=Ke.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(k){return k.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),h===null&&(h=Qd(),Ke.updateQueue=h),h.memoCache=c,h=c.data[c.index],h===void 0)for(h=c.data[c.index]=Array(a),x=0;x<a;x++)h[x]=F;return c.index++,h}function qs(a,c){return typeof c=="function"?c(a):c}function Yd(a){var c=Ut();return pm(c,yt,a)}function pm(a,c,h){var x=a.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=h;var k=a.baseQueue,N=x.pending;if(N!==null){if(k!==null){var I=k.next;k.next=N.next,N.next=I}c.baseQueue=k=N,x.pending=null}if(N=a.baseState,k===null)a.memoizedState=N;else{c=k.next;var $=I=null,G=null,le=c,he=!1;do{var ve=le.lane&-536870913;if(ve!==le.lane?(et&ve)===ve:($s&ve)===ve){var ce=le.revertLane;if(ce===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),ve===Qo&&(he=!0);else if(($s&ce)===ce){le=le.next,ce===Qo&&(he=!0);continue}else ve={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},G===null?($=G=ve,I=N):G=G.next=ve,Ke.lanes|=ce,Ii|=ce;ve=le.action,Oa&&h(N,ve),N=le.hasEagerState?le.eagerState:h(N,ve)}else ce={lane:ve,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},G===null?($=G=ce,I=N):G=G.next=ce,Ke.lanes|=ve,Ii|=ve;le=le.next}while(le!==null&&le!==c);if(G===null?I=N:G.next=$,!fr(N,a.memoizedState)&&(Kt=!0,he&&(h=Wo,h!==null)))throw h;a.memoizedState=N,a.baseState=I,a.baseQueue=G,x.lastRenderedState=N}return k===null&&(x.lanes=0),[a.memoizedState,x.dispatch]}function gm(a){var c=Ut(),h=c.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=a;var x=h.dispatch,k=h.pending,N=c.memoizedState;if(k!==null){h.pending=null;var I=k=k.next;do N=a(N,I.action),I=I.next;while(I!==k);fr(N,c.memoizedState)||(Kt=!0),c.memoizedState=N,c.baseQueue===null&&(c.baseState=N),h.lastRenderedState=N}return[N,x]}function Cw(a,c,h){var x=Ke,k=Ut(),N=rt;if(N){if(h===void 0)throw Error(r(407));h=h()}else h=c();var I=!fr((yt||k).memoizedState,h);if(I&&(k.memoizedState=h,Kt=!0),k=k.queue,xm(jw.bind(null,x,k,a),[a]),k.getSnapshot!==c||I||Vt!==null&&Vt.memoizedState.tag&1){if(x.flags|=2048,el(9,{destroy:void 0},Tw.bind(null,x,k,h,c),null),wt===null)throw Error(r(349));N||($s&127)!==0||Nw(x,c,h)}return h}function Nw(a,c,h){a.flags|=16384,a={getSnapshot:c,value:h},c=Ke.updateQueue,c===null?(c=Qd(),Ke.updateQueue=c,c.stores=[a]):(h=c.stores,h===null?c.stores=[a]:h.push(a))}function Tw(a,c,h,x){c.value=h,c.getSnapshot=x,Ew(c)&&Mw(a)}function jw(a,c,h){return h(function(){Ew(c)&&Mw(a)})}function Ew(a){var c=a.getSnapshot;a=a.value;try{var h=c();return!fr(a,h)}catch{return!0}}function Mw(a){var c=Ca(a,2);c!==null&&tr(c,a,2)}function mm(a){var c=In();if(typeof a=="function"){var h=a;if(a=h(),Oa){Nn(!0);try{h()}finally{Nn(!1)}}}return c.memoizedState=c.baseState=a,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qs,lastRenderedState:a},c}function Aw(a,c,h,x){return a.baseState=h,pm(a,yt,typeof x=="function"?x:qs)}function t_(a,c,h,x,k){if(Jd(a))throw Error(r(485));if(a=c.action,a!==null){var N={payload:k,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(I){N.listeners.push(I)}};q.T!==null?h(!0):N.isTransition=!1,x(N),h=c.pending,h===null?(N.next=c.pending=N,Rw(c,N)):(N.next=h.next,c.pending=h.next=N)}}function Rw(a,c){var h=c.action,x=c.payload,k=a.state;if(c.isTransition){var N=q.T,I={};q.T=I;try{var $=h(k,x),G=q.S;G!==null&&G(I,$),_w(a,c,$)}catch(le){ym(a,c,le)}finally{N!==null&&I.types!==null&&(N.types=I.types),q.T=N}}else try{N=h(k,x),_w(a,c,N)}catch(le){ym(a,c,le)}}function _w(a,c,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(x){Ow(a,c,x)},function(x){return ym(a,c,x)}):Ow(a,c,h)}function Ow(a,c,h){c.status="fulfilled",c.value=h,Iw(c),a.state=h,c=a.pending,c!==null&&(h=c.next,h===c?a.pending=null:(h=h.next,c.next=h,Rw(a,h)))}function ym(a,c,h){var x=a.pending;if(a.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=h,Iw(c),c=c.next;while(c!==x)}a.action=null}function Iw(a){a=a.listeners;for(var c=0;c<a.length;c++)(0,a[c])()}function Dw(a,c){return c}function Lw(a,c){if(rt){var h=wt.formState;if(h!==null){e:{var x=Ke;if(rt){if(jt){t:{for(var k=jt,N=Ir;k.nodeType!==8;){if(!N){k=null;break t}if(k=Lr(k.nextSibling),k===null){k=null;break t}}N=k.data,k=N==="F!"||N==="F"?k:null}if(k){jt=Lr(k.nextSibling),x=k.data==="F!";break e}}Ni(x)}x=!1}x&&(c=h[0])}}return h=In(),h.memoizedState=h.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Dw,lastRenderedState:c},h.queue=x,h=tS.bind(null,Ke,x),x.dispatch=h,x=mm(!1),N=km.bind(null,Ke,!1,x.queue),x=In(),k={state:c,dispatch:null,action:a,pending:null},x.queue=k,h=t_.bind(null,Ke,k,N,h),k.dispatch=h,x.memoizedState=a,[c,h,!1]}function zw(a){var c=Ut();return Pw(c,yt,a)}function Pw(a,c,h){if(c=pm(a,c,Dw)[0],a=Yd(qs)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=Ac(c)}catch(I){throw I===Yo?Bd:I}else x=c;c=Ut();var k=c.queue,N=k.dispatch;return h!==c.memoizedState&&(Ke.flags|=2048,el(9,{destroy:void 0},n_.bind(null,k,h),null)),[x,N,a]}function n_(a,c){a.action=c}function Bw(a){var c=Ut(),h=yt;if(h!==null)return Pw(c,h,a);Ut(),c=c.memoizedState,h=Ut();var x=h.queue.dispatch;return h.memoizedState=a,[c,x,!1]}function el(a,c,h,x){return a={tag:a,create:h,deps:x,inst:c,next:null},c=Ke.updateQueue,c===null&&(c=Qd(),Ke.updateQueue=c),h=c.lastEffect,h===null?c.lastEffect=a.next=a:(x=h.next,h.next=a,a.next=x,c.lastEffect=a),a}function Fw(){return Ut().memoizedState}function Gd(a,c,h,x){var k=In();Ke.flags|=a,k.memoizedState=el(1|c,{destroy:void 0},h,x===void 0?null:x)}function Xd(a,c,h,x){var k=Ut();x=x===void 0?null:x;var N=k.memoizedState.inst;yt!==null&&x!==null&&lm(x,yt.memoizedState.deps)?k.memoizedState=el(c,N,h,x):(Ke.flags|=a,k.memoizedState=el(1|c,N,h,x))}function Uw(a,c){Gd(8390656,8,a,c)}function xm(a,c){Xd(2048,8,a,c)}function r_(a){Ke.flags|=4;var c=Ke.updateQueue;if(c===null)c=Qd(),Ke.updateQueue=c,c.events=[a];else{var h=c.events;h===null?c.events=[a]:h.push(a)}}function $w(a){var c=Ut().memoizedState;return r_({ref:c,nextImpl:a}),function(){if((ct&2)!==0)throw Error(r(440));return c.impl.apply(void 0,arguments)}}function qw(a,c){return Xd(4,2,a,c)}function Hw(a,c){return Xd(4,4,a,c)}function Vw(a,c){if(typeof c=="function"){a=a();var h=c(a);return function(){typeof h=="function"?h():c(null)}}if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function Kw(a,c,h){h=h!=null?h.concat([a]):null,Xd(4,4,Vw.bind(null,c,a),h)}function bm(){}function Qw(a,c){var h=Ut();c=c===void 0?null:c;var x=h.memoizedState;return c!==null&&lm(c,x[1])?x[0]:(h.memoizedState=[a,c],a)}function Ww(a,c){var h=Ut();c=c===void 0?null:c;var x=h.memoizedState;if(c!==null&&lm(c,x[1]))return x[0];if(x=a(),Oa){Nn(!0);try{a()}finally{Nn(!1)}}return h.memoizedState=[x,c],x}function vm(a,c,h){return h===void 0||($s&1073741824)!==0&&(et&261930)===0?a.memoizedState=c:(a.memoizedState=h,a=YS(),Ke.lanes|=a,Ii|=a,h)}function Yw(a,c,h,x){return fr(h,c)?h:Xo.current!==null?(a=vm(a,h,x),fr(a,c)||(Kt=!0),a):($s&42)===0||($s&1073741824)!==0&&(et&261930)===0?(Kt=!0,a.memoizedState=h):(a=YS(),Ke.lanes|=a,Ii|=a,c)}function Gw(a,c,h,x,k){var N=V.p;V.p=N!==0&&8>N?N:8;var I=q.T,$={};q.T=$,km(a,!1,c,h);try{var G=k(),le=q.S;if(le!==null&&le($,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var he=JR(G,x);Rc(a,c,he,xr(a))}else Rc(a,c,x,xr(a))}catch(ve){Rc(a,c,{then:function(){},status:"rejected",reason:ve},xr())}finally{V.p=N,I!==null&&$.types!==null&&(I.types=$.types),q.T=I}}function s_(){}function wm(a,c,h,x){if(a.tag!==5)throw Error(r(476));var k=Xw(a).queue;Gw(a,k,c,ie,h===null?s_:function(){return Jw(a),h(x)})}function Xw(a){var c=a.memoizedState;if(c!==null)return c;c={memoizedState:ie,baseState:ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qs,lastRenderedState:ie},next:null};var h={};return c.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qs,lastRenderedState:h},next:null},a.memoizedState=c,a=a.alternate,a!==null&&(a.memoizedState=c),c}function Jw(a){var c=Xw(a);c.next===null&&(c=a.alternate.memoizedState),Rc(a,c.next.queue,{},xr())}function Sm(){return yn(Wc)}function Zw(){return Ut().memoizedState}function eS(){return Ut().memoizedState}function i_(a){for(var c=a.return;c!==null;){switch(c.tag){case 24:case 3:var h=xr();a=Ei(h);var x=Mi(c,a,h);x!==null&&(tr(x,c,h),Tc(x,c,h)),c={cache:Xg()},a.payload=c;return}c=c.return}}function a_(a,c,h){var x=xr();h={lane:x,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Jd(a)?nS(c,h):(h=Fg(a,c,h,x),h!==null&&(tr(h,a,x),rS(h,c,x)))}function tS(a,c,h){var x=xr();Rc(a,c,h,x)}function Rc(a,c,h,x){var k={lane:x,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(Jd(a))nS(c,k);else{var N=a.alternate;if(a.lanes===0&&(N===null||N.lanes===0)&&(N=c.lastRenderedReducer,N!==null))try{var I=c.lastRenderedState,$=N(I,h);if(k.hasEagerState=!0,k.eagerState=$,fr($,I))return _d(a,c,k,0),wt===null&&Rd(),!1}catch{}finally{}if(h=Fg(a,c,k,x),h!==null)return tr(h,a,x),rS(h,c,x),!0}return!1}function km(a,c,h,x){if(x={lane:2,revertLane:t0(),gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null},Jd(a)){if(c)throw Error(r(479))}else c=Fg(a,h,x,2),c!==null&&tr(c,a,2)}function Jd(a){var c=a.alternate;return a===Ke||c!==null&&c===Ke}function nS(a,c){Jo=Vd=!0;var h=a.pending;h===null?c.next=c:(c.next=h.next,h.next=c),a.pending=c}function rS(a,c,h){if((h&4194048)!==0){var x=c.lanes;x&=a.pendingLanes,h|=x,c.lanes=h,dr(a,h)}}var _c={readContext:yn,use:Wd,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useLayoutEffect:Ot,useInsertionEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useSyncExternalStore:Ot,useId:Ot,useHostTransitionStatus:Ot,useFormState:Ot,useActionState:Ot,useOptimistic:Ot,useMemoCache:Ot,useCacheRefresh:Ot};_c.useEffectEvent=Ot;var sS={readContext:yn,use:Wd,useCallback:function(a,c){return In().memoizedState=[a,c===void 0?null:c],a},useContext:yn,useEffect:Uw,useImperativeHandle:function(a,c,h){h=h!=null?h.concat([a]):null,Gd(4194308,4,Vw.bind(null,c,a),h)},useLayoutEffect:function(a,c){return Gd(4194308,4,a,c)},useInsertionEffect:function(a,c){Gd(4,2,a,c)},useMemo:function(a,c){var h=In();c=c===void 0?null:c;var x=a();if(Oa){Nn(!0);try{a()}finally{Nn(!1)}}return h.memoizedState=[x,c],x},useReducer:function(a,c,h){var x=In();if(h!==void 0){var k=h(c);if(Oa){Nn(!0);try{h(c)}finally{Nn(!1)}}}else k=c;return x.memoizedState=x.baseState=k,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:k},x.queue=a,a=a.dispatch=a_.bind(null,Ke,a),[x.memoizedState,a]},useRef:function(a){var c=In();return a={current:a},c.memoizedState=a},useState:function(a){a=mm(a);var c=a.queue,h=tS.bind(null,Ke,c);return c.dispatch=h,[a.memoizedState,h]},useDebugValue:bm,useDeferredValue:function(a,c){var h=In();return vm(h,a,c)},useTransition:function(){var a=mm(!1);return a=Gw.bind(null,Ke,a.queue,!0,!1),In().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,c,h){var x=Ke,k=In();if(rt){if(h===void 0)throw Error(r(407));h=h()}else{if(h=c(),wt===null)throw Error(r(349));(et&127)!==0||Nw(x,c,h)}k.memoizedState=h;var N={value:h,getSnapshot:c};return k.queue=N,Uw(jw.bind(null,x,N,a),[a]),x.flags|=2048,el(9,{destroy:void 0},Tw.bind(null,x,N,h,c),null),h},useId:function(){var a=In(),c=wt.identifierPrefix;if(rt){var h=gs,x=ps;h=(x&~(1<<32-Nt(x)-1)).toString(32)+h,c="_"+c+"R_"+h,h=Kd++,0<h&&(c+="H"+h.toString(32)),c+="_"}else h=ZR++,c="_"+c+"r_"+h.toString(32)+"_";return a.memoizedState=c},useHostTransitionStatus:Sm,useFormState:Lw,useActionState:Lw,useOptimistic:function(a){var c=In();c.memoizedState=c.baseState=a;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=h,c=km.bind(null,Ke,!0,h),h.dispatch=c,[a,c]},useMemoCache:hm,useCacheRefresh:function(){return In().memoizedState=i_.bind(null,Ke)},useEffectEvent:function(a){var c=In(),h={impl:a};return c.memoizedState=h,function(){if((ct&2)!==0)throw Error(r(440));return h.impl.apply(void 0,arguments)}}},Cm={readContext:yn,use:Wd,useCallback:Qw,useContext:yn,useEffect:xm,useImperativeHandle:Kw,useInsertionEffect:qw,useLayoutEffect:Hw,useMemo:Ww,useReducer:Yd,useRef:Fw,useState:function(){return Yd(qs)},useDebugValue:bm,useDeferredValue:function(a,c){var h=Ut();return Yw(h,yt.memoizedState,a,c)},useTransition:function(){var a=Yd(qs)[0],c=Ut().memoizedState;return[typeof a=="boolean"?a:Ac(a),c]},useSyncExternalStore:Cw,useId:Zw,useHostTransitionStatus:Sm,useFormState:zw,useActionState:zw,useOptimistic:function(a,c){var h=Ut();return Aw(h,yt,a,c)},useMemoCache:hm,useCacheRefresh:eS};Cm.useEffectEvent=$w;var iS={readContext:yn,use:Wd,useCallback:Qw,useContext:yn,useEffect:xm,useImperativeHandle:Kw,useInsertionEffect:qw,useLayoutEffect:Hw,useMemo:Ww,useReducer:gm,useRef:Fw,useState:function(){return gm(qs)},useDebugValue:bm,useDeferredValue:function(a,c){var h=Ut();return yt===null?vm(h,a,c):Yw(h,yt.memoizedState,a,c)},useTransition:function(){var a=gm(qs)[0],c=Ut().memoizedState;return[typeof a=="boolean"?a:Ac(a),c]},useSyncExternalStore:Cw,useId:Zw,useHostTransitionStatus:Sm,useFormState:Bw,useActionState:Bw,useOptimistic:function(a,c){var h=Ut();return yt!==null?Aw(h,yt,a,c):(h.baseState=a,[a,h.queue.dispatch])},useMemoCache:hm,useCacheRefresh:eS};iS.useEffectEvent=$w;function Nm(a,c,h,x){c=a.memoizedState,h=h(x,c),h=h==null?c:g({},c,h),a.memoizedState=h,a.lanes===0&&(a.updateQueue.baseState=h)}var Tm={enqueueSetState:function(a,c,h){a=a._reactInternals;var x=xr(),k=Ei(x);k.payload=c,h!=null&&(k.callback=h),c=Mi(a,k,x),c!==null&&(tr(c,a,x),Tc(c,a,x))},enqueueReplaceState:function(a,c,h){a=a._reactInternals;var x=xr(),k=Ei(x);k.tag=1,k.payload=c,h!=null&&(k.callback=h),c=Mi(a,k,x),c!==null&&(tr(c,a,x),Tc(c,a,x))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var h=xr(),x=Ei(h);x.tag=2,c!=null&&(x.callback=c),c=Mi(a,x,h),c!==null&&(tr(c,a,h),Tc(c,a,h))}};function aS(a,c,h,x,k,N,I){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(x,N,I):c.prototype&&c.prototype.isPureReactComponent?!xc(h,x)||!xc(k,N):!0}function oS(a,c,h,x){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,x),c.state!==a&&Tm.enqueueReplaceState(c,c.state,null)}function Ia(a,c){var h=c;if("ref"in c){h={};for(var x in c)x!=="ref"&&(h[x]=c[x])}if(a=a.defaultProps){h===c&&(h=g({},h));for(var k in a)h[k]===void 0&&(h[k]=a[k])}return h}function lS(a){Ad(a)}function cS(a){console.error(a)}function uS(a){Ad(a)}function Zd(a,c){try{var h=a.onUncaughtError;h(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function dS(a,c,h){try{var x=a.onCaughtError;x(h.value,{componentStack:h.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(k){setTimeout(function(){throw k})}}function jm(a,c,h){return h=Ei(h),h.tag=3,h.payload={element:null},h.callback=function(){Zd(a,c)},h}function fS(a){return a=Ei(a),a.tag=3,a}function hS(a,c,h,x){var k=h.type.getDerivedStateFromError;if(typeof k=="function"){var N=x.value;a.payload=function(){return k(N)},a.callback=function(){dS(c,h,x)}}var I=h.stateNode;I!==null&&typeof I.componentDidCatch=="function"&&(a.callback=function(){dS(c,h,x),typeof k!="function"&&(Di===null?Di=new Set([this]):Di.add(this));var $=x.stack;this.componentDidCatch(x.value,{componentStack:$!==null?$:""})})}function o_(a,c,h,x,k){if(h.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=h.alternate,c!==null&&Ko(c,h,k,!0),h=pr.current,h!==null){switch(h.tag){case 31:case 13:return Dr===null?ff():h.alternate===null&&It===0&&(It=3),h.flags&=-257,h.flags|=65536,h.lanes=k,x===Fd?h.flags|=16384:(c=h.updateQueue,c===null?h.updateQueue=new Set([x]):c.add(x),Jm(a,x,k)),!1;case 22:return h.flags|=65536,x===Fd?h.flags|=16384:(c=h.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},h.updateQueue=c):(h=c.retryQueue,h===null?c.retryQueue=new Set([x]):h.add(x)),Jm(a,x,k)),!1}throw Error(r(435,h.tag))}return Jm(a,x,k),ff(),!1}if(rt)return c=pr.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=k,x!==Kg&&(a=Error(r(422),{cause:x}),wc(Rr(a,h)))):(x!==Kg&&(c=Error(r(423),{cause:x}),wc(Rr(c,h))),a=a.current.alternate,a.flags|=65536,k&=-k,a.lanes|=k,x=Rr(x,h),k=jm(a.stateNode,x,k),rm(a,k),It!==4&&(It=2)),!1;var N=Error(r(520),{cause:x});if(N=Rr(N,h),Fc===null?Fc=[N]:Fc.push(N),It!==4&&(It=2),c===null)return!0;x=Rr(x,h),h=c;do{switch(h.tag){case 3:return h.flags|=65536,a=k&-k,h.lanes|=a,a=jm(h.stateNode,x,a),rm(h,a),!1;case 1:if(c=h.type,N=h.stateNode,(h.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(Di===null||!Di.has(N))))return h.flags|=65536,k&=-k,h.lanes|=k,k=fS(k),hS(k,a,h,x),rm(h,k),!1}h=h.return}while(h!==null);return!1}var Em=Error(r(461)),Kt=!1;function xn(a,c,h,x){c.child=a===null?yw(c,null,h,x):_a(c,a.child,h,x)}function pS(a,c,h,x,k){h=h.render;var N=c.ref;if("ref"in x){var I={};for(var $ in x)$!=="ref"&&(I[$]=x[$])}else I=x;return Ea(c),x=cm(a,c,h,I,N,k),$=um(),a!==null&&!Kt?(dm(a,c,k),Hs(a,c,k)):(rt&&$&&Hg(c),c.flags|=1,xn(a,c,x,k),c.child)}function gS(a,c,h,x,k){if(a===null){var N=h.type;return typeof N=="function"&&!Ug(N)&&N.defaultProps===void 0&&h.compare===null?(c.tag=15,c.type=N,mS(a,c,N,x,k)):(a=Id(h.type,null,x,c,c.mode,k),a.ref=c.ref,a.return=c,c.child=a)}if(N=a.child,!Lm(a,k)){var I=N.memoizedProps;if(h=h.compare,h=h!==null?h:xc,h(I,x)&&a.ref===c.ref)return Hs(a,c,k)}return c.flags|=1,a=Ps(N,x),a.ref=c.ref,a.return=c,c.child=a}function mS(a,c,h,x,k){if(a!==null){var N=a.memoizedProps;if(xc(N,x)&&a.ref===c.ref)if(Kt=!1,c.pendingProps=x=N,Lm(a,k))(a.flags&131072)!==0&&(Kt=!0);else return c.lanes=a.lanes,Hs(a,c,k)}return Mm(a,c,h,x,k)}function yS(a,c,h,x){var k=x.children,N=a!==null?a.memoizedState:null;if(a===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),x.mode==="hidden"){if((c.flags&128)!==0){if(N=N!==null?N.baseLanes|h:h,a!==null){for(x=c.child=a.child,k=0;x!==null;)k=k|x.lanes|x.childLanes,x=x.sibling;x=k&~N}else x=0,c.child=null;return xS(a,c,N,h,x)}if((h&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},a!==null&&Pd(c,N!==null?N.cachePool:null),N!==null?vw(c,N):im(),ww(c);else return x=c.lanes=536870912,xS(a,c,N!==null?N.baseLanes|h:h,h,x)}else N!==null?(Pd(c,N.cachePool),vw(c,N),Ri(),c.memoizedState=null):(a!==null&&Pd(c,null),im(),Ri());return xn(a,c,k,h),c.child}function Oc(a,c){return a!==null&&a.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function xS(a,c,h,x,k){var N=Zg();return N=N===null?null:{parent:Ht._currentValue,pool:N},c.memoizedState={baseLanes:h,cachePool:N},a!==null&&Pd(c,null),im(),ww(c),a!==null&&Ko(a,c,x,!0),c.childLanes=k,null}function ef(a,c){return c=nf({mode:c.mode,children:c.children},a.mode),c.ref=a.ref,a.child=c,c.return=a,c}function bS(a,c,h){return _a(c,a.child,null,h),a=ef(c,c.pendingProps),a.flags|=2,gr(c),c.memoizedState=null,a}function l_(a,c,h){var x=c.pendingProps,k=(c.flags&128)!==0;if(c.flags&=-129,a===null){if(rt){if(x.mode==="hidden")return a=ef(c,x),c.lanes=536870912,Oc(null,a);if(om(c),(a=jt)?(a=Rk(a,Ir),a=a!==null&&a.data==="&"?a:null,a!==null&&(c.memoizedState={dehydrated:a,treeContext:ki!==null?{id:ps,overflow:gs}:null,retryLane:536870912,hydrationErrors:null},h=nw(a),h.return=c,c.child=h,mn=c,jt=null)):a=null,a===null)throw Ni(c);return c.lanes=536870912,null}return ef(c,x)}var N=a.memoizedState;if(N!==null){var I=N.dehydrated;if(om(c),k)if(c.flags&256)c.flags&=-257,c=bS(a,c,h);else if(c.memoizedState!==null)c.child=a.child,c.flags|=128,c=null;else throw Error(r(558));else if(Kt||Ko(a,c,h,!1),k=(h&a.childLanes)!==0,Kt||k){if(x=wt,x!==null&&(I=Tr(x,h),I!==0&&I!==N.retryLane))throw N.retryLane=I,Ca(a,I),tr(x,a,I),Em;ff(),c=bS(a,c,h)}else a=N.treeContext,jt=Lr(I.nextSibling),mn=c,rt=!0,Ci=null,Ir=!1,a!==null&&iw(c,a),c=ef(c,x),c.flags|=4096;return c}return a=Ps(a.child,{mode:x.mode,children:x.children}),a.ref=c.ref,c.child=a,a.return=c,a}function tf(a,c){var h=c.ref;if(h===null)a!==null&&a.ref!==null&&(c.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(r(284));(a===null||a.ref!==h)&&(c.flags|=4194816)}}function Mm(a,c,h,x,k){return Ea(c),h=cm(a,c,h,x,void 0,k),x=um(),a!==null&&!Kt?(dm(a,c,k),Hs(a,c,k)):(rt&&x&&Hg(c),c.flags|=1,xn(a,c,h,k),c.child)}function vS(a,c,h,x,k,N){return Ea(c),c.updateQueue=null,h=kw(c,x,h,k),Sw(a),x=um(),a!==null&&!Kt?(dm(a,c,N),Hs(a,c,N)):(rt&&x&&Hg(c),c.flags|=1,xn(a,c,h,N),c.child)}function wS(a,c,h,x,k){if(Ea(c),c.stateNode===null){var N=$o,I=h.contextType;typeof I=="object"&&I!==null&&(N=yn(I)),N=new h(x,N),c.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,N.updater=Tm,c.stateNode=N,N._reactInternals=c,N=c.stateNode,N.props=x,N.state=c.memoizedState,N.refs={},tm(c),I=h.contextType,N.context=typeof I=="object"&&I!==null?yn(I):$o,N.state=c.memoizedState,I=h.getDerivedStateFromProps,typeof I=="function"&&(Nm(c,h,I,x),N.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(I=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),I!==N.state&&Tm.enqueueReplaceState(N,N.state,null),Ec(c,x,N,k),jc(),N.state=c.memoizedState),typeof N.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(a===null){N=c.stateNode;var $=c.memoizedProps,G=Ia(h,$);N.props=G;var le=N.context,he=h.contextType;I=$o,typeof he=="object"&&he!==null&&(I=yn(he));var ve=h.getDerivedStateFromProps;he=typeof ve=="function"||typeof N.getSnapshotBeforeUpdate=="function",$=c.pendingProps!==$,he||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||($||le!==I)&&oS(c,N,x,I),ji=!1;var ce=c.memoizedState;N.state=ce,Ec(c,x,N,k),jc(),le=c.memoizedState,$||ce!==le||ji?(typeof ve=="function"&&(Nm(c,h,ve,x),le=c.memoizedState),(G=ji||aS(c,h,G,x,ce,le,I))?(he||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(c.flags|=4194308)):(typeof N.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=le),N.props=x,N.state=le,N.context=I,x=G):(typeof N.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{N=c.stateNode,nm(a,c),I=c.memoizedProps,he=Ia(h,I),N.props=he,ve=c.pendingProps,ce=N.context,le=h.contextType,G=$o,typeof le=="object"&&le!==null&&(G=yn(le)),$=h.getDerivedStateFromProps,(le=typeof $=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(I!==ve||ce!==G)&&oS(c,N,x,G),ji=!1,ce=c.memoizedState,N.state=ce,Ec(c,x,N,k),jc();var de=c.memoizedState;I!==ve||ce!==de||ji||a!==null&&a.dependencies!==null&&Ld(a.dependencies)?(typeof $=="function"&&(Nm(c,h,$,x),de=c.memoizedState),(he=ji||aS(c,h,he,x,ce,de,G)||a!==null&&a.dependencies!==null&&Ld(a.dependencies))?(le||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(x,de,G),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(x,de,G)),typeof N.componentDidUpdate=="function"&&(c.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof N.componentDidUpdate!="function"||I===a.memoizedProps&&ce===a.memoizedState||(c.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||I===a.memoizedProps&&ce===a.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=de),N.props=x,N.state=de,N.context=G,x=he):(typeof N.componentDidUpdate!="function"||I===a.memoizedProps&&ce===a.memoizedState||(c.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||I===a.memoizedProps&&ce===a.memoizedState||(c.flags|=1024),x=!1)}return N=x,tf(a,c),x=(c.flags&128)!==0,N||x?(N=c.stateNode,h=x&&typeof h.getDerivedStateFromError!="function"?null:N.render(),c.flags|=1,a!==null&&x?(c.child=_a(c,a.child,null,k),c.child=_a(c,null,h,k)):xn(a,c,h,k),c.memoizedState=N.state,a=c.child):a=Hs(a,c,k),a}function SS(a,c,h,x){return Ta(),c.flags|=256,xn(a,c,h,x),c.child}var Am={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Rm(a){return{baseLanes:a,cachePool:dw()}}function _m(a,c,h){return a=a!==null?a.childLanes&~h:0,c&&(a|=yr),a}function kS(a,c,h){var x=c.pendingProps,k=!1,N=(c.flags&128)!==0,I;if((I=N)||(I=a!==null&&a.memoizedState===null?!1:(Ft.current&2)!==0),I&&(k=!0,c.flags&=-129),I=(c.flags&32)!==0,c.flags&=-33,a===null){if(rt){if(k?Ai(c):Ri(),(a=jt)?(a=Rk(a,Ir),a=a!==null&&a.data!=="&"?a:null,a!==null&&(c.memoizedState={dehydrated:a,treeContext:ki!==null?{id:ps,overflow:gs}:null,retryLane:536870912,hydrationErrors:null},h=nw(a),h.return=c,c.child=h,mn=c,jt=null)):a=null,a===null)throw Ni(c);return p0(a)?c.lanes=32:c.lanes=536870912,null}var $=x.children;return x=x.fallback,k?(Ri(),k=c.mode,$=nf({mode:"hidden",children:$},k),x=Na(x,k,h,null),$.return=c,x.return=c,$.sibling=x,c.child=$,x=c.child,x.memoizedState=Rm(h),x.childLanes=_m(a,I,h),c.memoizedState=Am,Oc(null,x)):(Ai(c),Om(c,$))}var G=a.memoizedState;if(G!==null&&($=G.dehydrated,$!==null)){if(N)c.flags&256?(Ai(c),c.flags&=-257,c=Im(a,c,h)):c.memoizedState!==null?(Ri(),c.child=a.child,c.flags|=128,c=null):(Ri(),$=x.fallback,k=c.mode,x=nf({mode:"visible",children:x.children},k),$=Na($,k,h,null),$.flags|=2,x.return=c,$.return=c,x.sibling=$,c.child=x,_a(c,a.child,null,h),x=c.child,x.memoizedState=Rm(h),x.childLanes=_m(a,I,h),c.memoizedState=Am,c=Oc(null,x));else if(Ai(c),p0($)){if(I=$.nextSibling&&$.nextSibling.dataset,I)var le=I.dgst;I=le,x=Error(r(419)),x.stack="",x.digest=I,wc({value:x,source:null,stack:null}),c=Im(a,c,h)}else if(Kt||Ko(a,c,h,!1),I=(h&a.childLanes)!==0,Kt||I){if(I=wt,I!==null&&(x=Tr(I,h),x!==0&&x!==G.retryLane))throw G.retryLane=x,Ca(a,x),tr(I,a,x),Em;h0($)||ff(),c=Im(a,c,h)}else h0($)?(c.flags|=192,c.child=a.child,c=null):(a=G.treeContext,jt=Lr($.nextSibling),mn=c,rt=!0,Ci=null,Ir=!1,a!==null&&iw(c,a),c=Om(c,x.children),c.flags|=4096);return c}return k?(Ri(),$=x.fallback,k=c.mode,G=a.child,le=G.sibling,x=Ps(G,{mode:"hidden",children:x.children}),x.subtreeFlags=G.subtreeFlags&65011712,le!==null?$=Ps(le,$):($=Na($,k,h,null),$.flags|=2),$.return=c,x.return=c,x.sibling=$,c.child=x,Oc(null,x),x=c.child,$=a.child.memoizedState,$===null?$=Rm(h):(k=$.cachePool,k!==null?(G=Ht._currentValue,k=k.parent!==G?{parent:G,pool:G}:k):k=dw(),$={baseLanes:$.baseLanes|h,cachePool:k}),x.memoizedState=$,x.childLanes=_m(a,I,h),c.memoizedState=Am,Oc(a.child,x)):(Ai(c),h=a.child,a=h.sibling,h=Ps(h,{mode:"visible",children:x.children}),h.return=c,h.sibling=null,a!==null&&(I=c.deletions,I===null?(c.deletions=[a],c.flags|=16):I.push(a)),c.child=h,c.memoizedState=null,h)}function Om(a,c){return c=nf({mode:"visible",children:c},a.mode),c.return=a,a.child=c}function nf(a,c){return a=hr(22,a,null,c),a.lanes=0,a}function Im(a,c,h){return _a(c,a.child,null,h),a=Om(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function CS(a,c,h){a.lanes|=c;var x=a.alternate;x!==null&&(x.lanes|=c),Yg(a.return,c,h)}function Dm(a,c,h,x,k,N){var I=a.memoizedState;I===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:h,tailMode:k,treeForkCount:N}:(I.isBackwards=c,I.rendering=null,I.renderingStartTime=0,I.last=x,I.tail=h,I.tailMode=k,I.treeForkCount=N)}function NS(a,c,h){var x=c.pendingProps,k=x.revealOrder,N=x.tail;x=x.children;var I=Ft.current,$=(I&2)!==0;if($?(I=I&1|2,c.flags|=128):I&=1,te(Ft,I),xn(a,c,x,h),x=rt?vc:0,!$&&a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&CS(a,h,c);else if(a.tag===19)CS(a,h,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(k){case"forwards":for(h=c.child,k=null;h!==null;)a=h.alternate,a!==null&&Hd(a)===null&&(k=h),h=h.sibling;h=k,h===null?(k=c.child,c.child=null):(k=h.sibling,h.sibling=null),Dm(c,!1,k,h,N,x);break;case"backwards":case"unstable_legacy-backwards":for(h=null,k=c.child,c.child=null;k!==null;){if(a=k.alternate,a!==null&&Hd(a)===null){c.child=k;break}a=k.sibling,k.sibling=h,h=k,k=a}Dm(c,!0,h,null,N,x);break;case"together":Dm(c,!1,null,null,void 0,x);break;default:c.memoizedState=null}return c.child}function Hs(a,c,h){if(a!==null&&(c.dependencies=a.dependencies),Ii|=c.lanes,(h&c.childLanes)===0)if(a!==null){if(Ko(a,c,h,!1),(h&c.childLanes)===0)return null}else return null;if(a!==null&&c.child!==a.child)throw Error(r(153));if(c.child!==null){for(a=c.child,h=Ps(a,a.pendingProps),c.child=h,h.return=c;a.sibling!==null;)a=a.sibling,h=h.sibling=Ps(a,a.pendingProps),h.return=c;h.sibling=null}return c.child}function Lm(a,c){return(a.lanes&c)!==0?!0:(a=a.dependencies,!!(a!==null&&Ld(a)))}function c_(a,c,h){switch(c.tag){case 3:be(c,c.stateNode.containerInfo),Ti(c,Ht,a.memoizedState.cache),Ta();break;case 27:case 5:Se(c);break;case 4:be(c,c.stateNode.containerInfo);break;case 10:Ti(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,om(c),null;break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(Ai(c),c.flags|=128,null):(h&c.child.childLanes)!==0?kS(a,c,h):(Ai(c),a=Hs(a,c,h),a!==null?a.sibling:null);Ai(c);break;case 19:var k=(a.flags&128)!==0;if(x=(h&c.childLanes)!==0,x||(Ko(a,c,h,!1),x=(h&c.childLanes)!==0),k){if(x)return NS(a,c,h);c.flags|=128}if(k=c.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),te(Ft,Ft.current),x)break;return null;case 22:return c.lanes=0,yS(a,c,h,c.pendingProps);case 24:Ti(c,Ht,a.memoizedState.cache)}return Hs(a,c,h)}function TS(a,c,h){if(a!==null)if(a.memoizedProps!==c.pendingProps)Kt=!0;else{if(!Lm(a,h)&&(c.flags&128)===0)return Kt=!1,c_(a,c,h);Kt=(a.flags&131072)!==0}else Kt=!1,rt&&(c.flags&1048576)!==0&&sw(c,vc,c.index);switch(c.lanes=0,c.tag){case 16:e:{var x=c.pendingProps;if(a=Aa(c.elementType),c.type=a,typeof a=="function")Ug(a)?(x=Ia(a,x),c.tag=1,c=wS(null,c,a,x,h)):(c.tag=0,c=Mm(null,c,a,x,h));else{if(a!=null){var k=a.$$typeof;if(k===M){c.tag=11,c=pS(null,c,a,x,h);break e}else if(k===O){c.tag=14,c=gS(null,c,a,x,h);break e}}throw c=E(a)||a,Error(r(306,c,""))}}return c;case 0:return Mm(a,c,c.type,c.pendingProps,h);case 1:return x=c.type,k=Ia(x,c.pendingProps),wS(a,c,x,k,h);case 3:e:{if(be(c,c.stateNode.containerInfo),a===null)throw Error(r(387));x=c.pendingProps;var N=c.memoizedState;k=N.element,nm(a,c),Ec(c,x,null,h);var I=c.memoizedState;if(x=I.cache,Ti(c,Ht,x),x!==N.cache&&Gg(c,[Ht],h,!0),jc(),x=I.element,N.isDehydrated)if(N={element:x,isDehydrated:!1,cache:I.cache},c.updateQueue.baseState=N,c.memoizedState=N,c.flags&256){c=SS(a,c,x,h);break e}else if(x!==k){k=Rr(Error(r(424)),c),wc(k),c=SS(a,c,x,h);break e}else{switch(a=c.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(jt=Lr(a.firstChild),mn=c,rt=!0,Ci=null,Ir=!0,h=yw(c,null,x,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Ta(),x===k){c=Hs(a,c,h);break e}xn(a,c,x,h)}c=c.child}return c;case 26:return tf(a,c),a===null?(h=zk(c.type,null,c.pendingProps,null))?c.memoizedState=h:rt||(h=c.type,a=c.pendingProps,x=bf(se.current).createElement(h),x[gn]=c,x[Yn]=a,bn(x,h,a),ln(x),c.stateNode=x):c.memoizedState=zk(c.type,a.memoizedProps,c.pendingProps,a.memoizedState),null;case 27:return Se(c),a===null&&rt&&(x=c.stateNode=Ik(c.type,c.pendingProps,se.current),mn=c,Ir=!0,k=jt,Bi(c.type)?(g0=k,jt=Lr(x.firstChild)):jt=k),xn(a,c,c.pendingProps.children,h),tf(a,c),a===null&&(c.flags|=4194304),c.child;case 5:return a===null&&rt&&((k=x=jt)&&(x=B_(x,c.type,c.pendingProps,Ir),x!==null?(c.stateNode=x,mn=c,jt=Lr(x.firstChild),Ir=!1,k=!0):k=!1),k||Ni(c)),Se(c),k=c.type,N=c.pendingProps,I=a!==null?a.memoizedProps:null,x=N.children,u0(k,N)?x=null:I!==null&&u0(k,I)&&(c.flags|=32),c.memoizedState!==null&&(k=cm(a,c,e_,null,null,h),Wc._currentValue=k),tf(a,c),xn(a,c,x,h),c.child;case 6:return a===null&&rt&&((a=h=jt)&&(h=F_(h,c.pendingProps,Ir),h!==null?(c.stateNode=h,mn=c,jt=null,a=!0):a=!1),a||Ni(c)),null;case 13:return kS(a,c,h);case 4:return be(c,c.stateNode.containerInfo),x=c.pendingProps,a===null?c.child=_a(c,null,x,h):xn(a,c,x,h),c.child;case 11:return pS(a,c,c.type,c.pendingProps,h);case 7:return xn(a,c,c.pendingProps,h),c.child;case 8:return xn(a,c,c.pendingProps.children,h),c.child;case 12:return xn(a,c,c.pendingProps.children,h),c.child;case 10:return x=c.pendingProps,Ti(c,c.type,x.value),xn(a,c,x.children,h),c.child;case 9:return k=c.type._context,x=c.pendingProps.children,Ea(c),k=yn(k),x=x(k),c.flags|=1,xn(a,c,x,h),c.child;case 14:return gS(a,c,c.type,c.pendingProps,h);case 15:return mS(a,c,c.type,c.pendingProps,h);case 19:return NS(a,c,h);case 31:return l_(a,c,h);case 22:return yS(a,c,h,c.pendingProps);case 24:return Ea(c),x=yn(Ht),a===null?(k=Zg(),k===null&&(k=wt,N=Xg(),k.pooledCache=N,N.refCount++,N!==null&&(k.pooledCacheLanes|=h),k=N),c.memoizedState={parent:x,cache:k},tm(c),Ti(c,Ht,k)):((a.lanes&h)!==0&&(nm(a,c),Ec(c,null,null,h),jc()),k=a.memoizedState,N=c.memoizedState,k.parent!==x?(k={parent:x,cache:x},c.memoizedState=k,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=k),Ti(c,Ht,x)):(x=N.cache,Ti(c,Ht,x),x!==k.cache&&Gg(c,[Ht],h,!0))),xn(a,c,c.pendingProps.children,h),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function Vs(a){a.flags|=4}function zm(a,c,h,x,k){if((c=(a.mode&32)!==0)&&(c=!1),c){if(a.flags|=16777216,(k&335544128)===k)if(a.stateNode.complete)a.flags|=8192;else if(ZS())a.flags|=8192;else throw Ra=Fd,em}else a.flags&=-16777217}function jS(a,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!$k(c))if(ZS())a.flags|=8192;else throw Ra=Fd,em}function rf(a,c){c!==null&&(a.flags|=4),a.flags&16384&&(c=a.tag!==22?Tn():536870912,a.lanes|=c,sl|=c)}function Ic(a,c){if(!rt)switch(a.tailMode){case"hidden":c=a.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?a.tail=null:h.sibling=null;break;case"collapsed":h=a.tail;for(var x=null;h!==null;)h.alternate!==null&&(x=h),h=h.sibling;x===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:x.sibling=null}}function Et(a){var c=a.alternate!==null&&a.alternate.child===a.child,h=0,x=0;if(c)for(var k=a.child;k!==null;)h|=k.lanes|k.childLanes,x|=k.subtreeFlags&65011712,x|=k.flags&65011712,k.return=a,k=k.sibling;else for(k=a.child;k!==null;)h|=k.lanes|k.childLanes,x|=k.subtreeFlags,x|=k.flags,k.return=a,k=k.sibling;return a.subtreeFlags|=x,a.childLanes=h,c}function u_(a,c,h){var x=c.pendingProps;switch(Vg(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(c),null;case 1:return Et(c),null;case 3:return h=c.stateNode,x=null,a!==null&&(x=a.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),Us(Ht),me(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(a===null||a.child===null)&&(Vo(c)?Vs(c):a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Qg())),Et(c),null;case 26:var k=c.type,N=c.memoizedState;return a===null?(Vs(c),N!==null?(Et(c),jS(c,N)):(Et(c),zm(c,k,null,x,h))):N?N!==a.memoizedState?(Vs(c),Et(c),jS(c,N)):(Et(c),c.flags&=-16777217):(a=a.memoizedProps,a!==x&&Vs(c),Et(c),zm(c,k,a,x,h)),null;case 27:if(Oe(c),h=se.current,k=c.type,a!==null&&c.stateNode!=null)a.memoizedProps!==x&&Vs(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Et(c),null}a=Z.current,Vo(c)?aw(c):(a=Ik(k,x,h),c.stateNode=a,Vs(c))}return Et(c),null;case 5:if(Oe(c),k=c.type,a!==null&&c.stateNode!=null)a.memoizedProps!==x&&Vs(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Et(c),null}if(N=Z.current,Vo(c))aw(c);else{var I=bf(se.current);switch(N){case 1:N=I.createElementNS("http://www.w3.org/2000/svg",k);break;case 2:N=I.createElementNS("http://www.w3.org/1998/Math/MathML",k);break;default:switch(k){case"svg":N=I.createElementNS("http://www.w3.org/2000/svg",k);break;case"math":N=I.createElementNS("http://www.w3.org/1998/Math/MathML",k);break;case"script":N=I.createElement("div"),N.innerHTML="<script><\/script>",N=N.removeChild(N.firstChild);break;case"select":N=typeof x.is=="string"?I.createElement("select",{is:x.is}):I.createElement("select"),x.multiple?N.multiple=!0:x.size&&(N.size=x.size);break;default:N=typeof x.is=="string"?I.createElement(k,{is:x.is}):I.createElement(k)}}N[gn]=c,N[Yn]=x;e:for(I=c.child;I!==null;){if(I.tag===5||I.tag===6)N.appendChild(I.stateNode);else if(I.tag!==4&&I.tag!==27&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===c)break e;for(;I.sibling===null;){if(I.return===null||I.return===c)break e;I=I.return}I.sibling.return=I.return,I=I.sibling}c.stateNode=N;e:switch(bn(N,k,x),k){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}x&&Vs(c)}}return Et(c),zm(c,c.type,a===null?null:a.memoizedProps,c.pendingProps,h),null;case 6:if(a&&c.stateNode!=null)a.memoizedProps!==x&&Vs(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(a=se.current,Vo(c)){if(a=c.stateNode,h=c.memoizedProps,x=null,k=mn,k!==null)switch(k.tag){case 27:case 5:x=k.memoizedProps}a[gn]=c,a=!!(a.nodeValue===h||x!==null&&x.suppressHydrationWarning===!0||kk(a.nodeValue,h)),a||Ni(c,!0)}else a=bf(a).createTextNode(x),a[gn]=c,c.stateNode=a}return Et(c),null;case 31:if(h=c.memoizedState,a===null||a.memoizedState!==null){if(x=Vo(c),h!==null){if(a===null){if(!x)throw Error(r(318));if(a=c.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(557));a[gn]=c}else Ta(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Et(c),a=!1}else h=Qg(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=h),a=!0;if(!a)return c.flags&256?(gr(c),c):(gr(c),null);if((c.flags&128)!==0)throw Error(r(558))}return Et(c),null;case 13:if(x=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(k=Vo(c),x!==null&&x.dehydrated!==null){if(a===null){if(!k)throw Error(r(318));if(k=c.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(r(317));k[gn]=c}else Ta(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Et(c),k=!1}else k=Qg(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=k),k=!0;if(!k)return c.flags&256?(gr(c),c):(gr(c),null)}return gr(c),(c.flags&128)!==0?(c.lanes=h,c):(h=x!==null,a=a!==null&&a.memoizedState!==null,h&&(x=c.child,k=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(k=x.alternate.memoizedState.cachePool.pool),N=null,x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(N=x.memoizedState.cachePool.pool),N!==k&&(x.flags|=2048)),h!==a&&h&&(c.child.flags|=8192),rf(c,c.updateQueue),Et(c),null);case 4:return me(),a===null&&i0(c.stateNode.containerInfo),Et(c),null;case 10:return Us(c.type),Et(c),null;case 19:if(U(Ft),x=c.memoizedState,x===null)return Et(c),null;if(k=(c.flags&128)!==0,N=x.rendering,N===null)if(k)Ic(x,!1);else{if(It!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(N=Hd(a),N!==null){for(c.flags|=128,Ic(x,!1),a=N.updateQueue,c.updateQueue=a,rf(c,a),c.subtreeFlags=0,a=h,h=c.child;h!==null;)tw(h,a),h=h.sibling;return te(Ft,Ft.current&1|2),rt&&Bs(c,x.treeForkCount),c.child}a=a.sibling}x.tail!==null&&Ce()>cf&&(c.flags|=128,k=!0,Ic(x,!1),c.lanes=4194304)}else{if(!k)if(a=Hd(N),a!==null){if(c.flags|=128,k=!0,a=a.updateQueue,c.updateQueue=a,rf(c,a),Ic(x,!0),x.tail===null&&x.tailMode==="hidden"&&!N.alternate&&!rt)return Et(c),null}else 2*Ce()-x.renderingStartTime>cf&&h!==536870912&&(c.flags|=128,k=!0,Ic(x,!1),c.lanes=4194304);x.isBackwards?(N.sibling=c.child,c.child=N):(a=x.last,a!==null?a.sibling=N:c.child=N,x.last=N)}return x.tail!==null?(a=x.tail,x.rendering=a,x.tail=a.sibling,x.renderingStartTime=Ce(),a.sibling=null,h=Ft.current,te(Ft,k?h&1|2:h&1),rt&&Bs(c,x.treeForkCount),a):(Et(c),null);case 22:case 23:return gr(c),am(),x=c.memoizedState!==null,a!==null?a.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(h&536870912)!==0&&(c.flags&128)===0&&(Et(c),c.subtreeFlags&6&&(c.flags|=8192)):Et(c),h=c.updateQueue,h!==null&&rf(c,h.retryQueue),h=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==h&&(c.flags|=2048),a!==null&&U(Ma),null;case 24:return h=null,a!==null&&(h=a.memoizedState.cache),c.memoizedState.cache!==h&&(c.flags|=2048),Us(Ht),Et(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function d_(a,c){switch(Vg(c),c.tag){case 1:return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return Us(Ht),me(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 26:case 27:case 5:return Oe(c),null;case 31:if(c.memoizedState!==null){if(gr(c),c.alternate===null)throw Error(r(340));Ta()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 13:if(gr(c),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Ta()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return U(Ft),null;case 4:return me(),null;case 10:return Us(c.type),null;case 22:case 23:return gr(c),am(),a!==null&&U(Ma),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 24:return Us(Ht),null;case 25:return null;default:return null}}function ES(a,c){switch(Vg(c),c.tag){case 3:Us(Ht),me();break;case 26:case 27:case 5:Oe(c);break;case 4:me();break;case 31:c.memoizedState!==null&&gr(c);break;case 13:gr(c);break;case 19:U(Ft);break;case 10:Us(c.type);break;case 22:case 23:gr(c),am(),a!==null&&U(Ma);break;case 24:Us(Ht)}}function Dc(a,c){try{var h=c.updateQueue,x=h!==null?h.lastEffect:null;if(x!==null){var k=x.next;h=k;do{if((h.tag&a)===a){x=void 0;var N=h.create,I=h.inst;x=N(),I.destroy=x}h=h.next}while(h!==k)}}catch($){ht(c,c.return,$)}}function _i(a,c,h){try{var x=c.updateQueue,k=x!==null?x.lastEffect:null;if(k!==null){var N=k.next;x=N;do{if((x.tag&a)===a){var I=x.inst,$=I.destroy;if($!==void 0){I.destroy=void 0,k=c;var G=h,le=$;try{le()}catch(he){ht(k,G,he)}}}x=x.next}while(x!==N)}}catch(he){ht(c,c.return,he)}}function MS(a){var c=a.updateQueue;if(c!==null){var h=a.stateNode;try{bw(c,h)}catch(x){ht(a,a.return,x)}}}function AS(a,c,h){h.props=Ia(a.type,a.memoizedProps),h.state=a.memoizedState;try{h.componentWillUnmount()}catch(x){ht(a,c,x)}}function Lc(a,c){try{var h=a.ref;if(h!==null){switch(a.tag){case 26:case 27:case 5:var x=a.stateNode;break;case 30:x=a.stateNode;break;default:x=a.stateNode}typeof h=="function"?a.refCleanup=h(x):h.current=x}}catch(k){ht(a,c,k)}}function ms(a,c){var h=a.ref,x=a.refCleanup;if(h!==null)if(typeof x=="function")try{x()}catch(k){ht(a,c,k)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(k){ht(a,c,k)}else h.current=null}function RS(a){var c=a.type,h=a.memoizedProps,x=a.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":h.autoFocus&&x.focus();break e;case"img":h.src?x.src=h.src:h.srcSet&&(x.srcset=h.srcSet)}}catch(k){ht(a,a.return,k)}}function Pm(a,c,h){try{var x=a.stateNode;O_(x,a.type,h,c),x[Yn]=c}catch(k){ht(a,a.return,k)}}function _S(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Bi(a.type)||a.tag===4}function Bm(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||_S(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Bi(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Fm(a,c,h){var x=a.tag;if(x===5||x===6)a=a.stateNode,c?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(a,c):(c=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,c.appendChild(a),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=Ls));else if(x!==4&&(x===27&&Bi(a.type)&&(h=a.stateNode,c=null),a=a.child,a!==null))for(Fm(a,c,h),a=a.sibling;a!==null;)Fm(a,c,h),a=a.sibling}function sf(a,c,h){var x=a.tag;if(x===5||x===6)a=a.stateNode,c?h.insertBefore(a,c):h.appendChild(a);else if(x!==4&&(x===27&&Bi(a.type)&&(h=a.stateNode),a=a.child,a!==null))for(sf(a,c,h),a=a.sibling;a!==null;)sf(a,c,h),a=a.sibling}function OS(a){var c=a.stateNode,h=a.memoizedProps;try{for(var x=a.type,k=c.attributes;k.length;)c.removeAttributeNode(k[0]);bn(c,x,h),c[gn]=a,c[Yn]=h}catch(N){ht(a,a.return,N)}}var Ks=!1,Qt=!1,Um=!1,IS=typeof WeakSet=="function"?WeakSet:Set,cn=null;function f_(a,c){if(a=a.containerInfo,l0=Tf,a=K1(a),Ig(a)){if("selectionStart"in a)var h={start:a.selectionStart,end:a.selectionEnd};else e:{h=(h=a.ownerDocument)&&h.defaultView||window;var x=h.getSelection&&h.getSelection();if(x&&x.rangeCount!==0){h=x.anchorNode;var k=x.anchorOffset,N=x.focusNode;x=x.focusOffset;try{h.nodeType,N.nodeType}catch{h=null;break e}var I=0,$=-1,G=-1,le=0,he=0,ve=a,ce=null;t:for(;;){for(var de;ve!==h||k!==0&&ve.nodeType!==3||($=I+k),ve!==N||x!==0&&ve.nodeType!==3||(G=I+x),ve.nodeType===3&&(I+=ve.nodeValue.length),(de=ve.firstChild)!==null;)ce=ve,ve=de;for(;;){if(ve===a)break t;if(ce===h&&++le===k&&($=I),ce===N&&++he===x&&(G=I),(de=ve.nextSibling)!==null)break;ve=ce,ce=ve.parentNode}ve=de}h=$===-1||G===-1?null:{start:$,end:G}}else h=null}h=h||{start:0,end:0}}else h=null;for(c0={focusedElem:a,selectionRange:h},Tf=!1,cn=c;cn!==null;)if(c=cn,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,cn=a;else for(;cn!==null;){switch(c=cn,N=c.alternate,a=c.flags,c.tag){case 0:if((a&4)!==0&&(a=c.updateQueue,a=a!==null?a.events:null,a!==null))for(h=0;h<a.length;h++)k=a[h],k.ref.impl=k.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&N!==null){a=void 0,h=c,k=N.memoizedProps,N=N.memoizedState,x=h.stateNode;try{var Re=Ia(h.type,k);a=x.getSnapshotBeforeUpdate(Re,N),x.__reactInternalSnapshotBeforeUpdate=a}catch(Fe){ht(h,h.return,Fe)}}break;case 3:if((a&1024)!==0){if(a=c.stateNode.containerInfo,h=a.nodeType,h===9)f0(a);else if(h===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":f0(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(r(163))}if(a=c.sibling,a!==null){a.return=c.return,cn=a;break}cn=c.return}}function DS(a,c,h){var x=h.flags;switch(h.tag){case 0:case 11:case 15:Ws(a,h),x&4&&Dc(5,h);break;case 1:if(Ws(a,h),x&4)if(a=h.stateNode,c===null)try{a.componentDidMount()}catch(I){ht(h,h.return,I)}else{var k=Ia(h.type,c.memoizedProps);c=c.memoizedState;try{a.componentDidUpdate(k,c,a.__reactInternalSnapshotBeforeUpdate)}catch(I){ht(h,h.return,I)}}x&64&&MS(h),x&512&&Lc(h,h.return);break;case 3:if(Ws(a,h),x&64&&(a=h.updateQueue,a!==null)){if(c=null,h.child!==null)switch(h.child.tag){case 27:case 5:c=h.child.stateNode;break;case 1:c=h.child.stateNode}try{bw(a,c)}catch(I){ht(h,h.return,I)}}break;case 27:c===null&&x&4&&OS(h);case 26:case 5:Ws(a,h),c===null&&x&4&&RS(h),x&512&&Lc(h,h.return);break;case 12:Ws(a,h);break;case 31:Ws(a,h),x&4&&PS(a,h);break;case 13:Ws(a,h),x&4&&BS(a,h),x&64&&(a=h.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(h=w_.bind(null,h),U_(a,h))));break;case 22:if(x=h.memoizedState!==null||Ks,!x){c=c!==null&&c.memoizedState!==null||Qt,k=Ks;var N=Qt;Ks=x,(Qt=c)&&!N?Ys(a,h,(h.subtreeFlags&8772)!==0):Ws(a,h),Ks=k,Qt=N}break;case 30:break;default:Ws(a,h)}}function LS(a){var c=a.alternate;c!==null&&(a.alternate=null,LS(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&yg(c)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var At=null,Xn=!1;function Qs(a,c,h){for(h=h.child;h!==null;)zS(a,c,h),h=h.sibling}function zS(a,c,h){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(dt,h)}catch{}switch(h.tag){case 26:Qt||ms(h,c),Qs(a,c,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Qt||ms(h,c);var x=At,k=Xn;Bi(h.type)&&(At=h.stateNode,Xn=!1),Qs(a,c,h),Vc(h.stateNode),At=x,Xn=k;break;case 5:Qt||ms(h,c);case 6:if(x=At,k=Xn,At=null,Qs(a,c,h),At=x,Xn=k,At!==null)if(Xn)try{(At.nodeType===9?At.body:At.nodeName==="HTML"?At.ownerDocument.body:At).removeChild(h.stateNode)}catch(N){ht(h,c,N)}else try{At.removeChild(h.stateNode)}catch(N){ht(h,c,N)}break;case 18:At!==null&&(Xn?(a=At,Mk(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,h.stateNode),fl(a)):Mk(At,h.stateNode));break;case 4:x=At,k=Xn,At=h.stateNode.containerInfo,Xn=!0,Qs(a,c,h),At=x,Xn=k;break;case 0:case 11:case 14:case 15:_i(2,h,c),Qt||_i(4,h,c),Qs(a,c,h);break;case 1:Qt||(ms(h,c),x=h.stateNode,typeof x.componentWillUnmount=="function"&&AS(h,c,x)),Qs(a,c,h);break;case 21:Qs(a,c,h);break;case 22:Qt=(x=Qt)||h.memoizedState!==null,Qs(a,c,h),Qt=x;break;default:Qs(a,c,h)}}function PS(a,c){if(c.memoizedState===null&&(a=c.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{fl(a)}catch(h){ht(c,c.return,h)}}}function BS(a,c){if(c.memoizedState===null&&(a=c.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{fl(a)}catch(h){ht(c,c.return,h)}}function h_(a){switch(a.tag){case 31:case 13:case 19:var c=a.stateNode;return c===null&&(c=a.stateNode=new IS),c;case 22:return a=a.stateNode,c=a._retryCache,c===null&&(c=a._retryCache=new IS),c;default:throw Error(r(435,a.tag))}}function af(a,c){var h=h_(a);c.forEach(function(x){if(!h.has(x)){h.add(x);var k=S_.bind(null,a,x);x.then(k,k)}})}function Jn(a,c){var h=c.deletions;if(h!==null)for(var x=0;x<h.length;x++){var k=h[x],N=a,I=c,$=I;e:for(;$!==null;){switch($.tag){case 27:if(Bi($.type)){At=$.stateNode,Xn=!1;break e}break;case 5:At=$.stateNode,Xn=!1;break e;case 3:case 4:At=$.stateNode.containerInfo,Xn=!0;break e}$=$.return}if(At===null)throw Error(r(160));zS(N,I,k),At=null,Xn=!1,N=k.alternate,N!==null&&(N.return=null),k.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)FS(c,a),c=c.sibling}var rs=null;function FS(a,c){var h=a.alternate,x=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Jn(c,a),Zn(a),x&4&&(_i(3,a,a.return),Dc(3,a),_i(5,a,a.return));break;case 1:Jn(c,a),Zn(a),x&512&&(Qt||h===null||ms(h,h.return)),x&64&&Ks&&(a=a.updateQueue,a!==null&&(x=a.callbacks,x!==null&&(h=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=h===null?x:h.concat(x))));break;case 26:var k=rs;if(Jn(c,a),Zn(a),x&512&&(Qt||h===null||ms(h,h.return)),x&4){var N=h!==null?h.memoizedState:null;if(x=a.memoizedState,h===null)if(x===null)if(a.stateNode===null){e:{x=a.type,h=a.memoizedProps,k=k.ownerDocument||k;t:switch(x){case"title":N=k.getElementsByTagName("title")[0],(!N||N[cc]||N[gn]||N.namespaceURI==="http://www.w3.org/2000/svg"||N.hasAttribute("itemprop"))&&(N=k.createElement(x),k.head.insertBefore(N,k.querySelector("head > title"))),bn(N,x,h),N[gn]=a,ln(N),x=N;break e;case"link":var I=Fk("link","href",k).get(x+(h.href||""));if(I){for(var $=0;$<I.length;$++)if(N=I[$],N.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&N.getAttribute("rel")===(h.rel==null?null:h.rel)&&N.getAttribute("title")===(h.title==null?null:h.title)&&N.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){I.splice($,1);break t}}N=k.createElement(x),bn(N,x,h),k.head.appendChild(N);break;case"meta":if(I=Fk("meta","content",k).get(x+(h.content||""))){for($=0;$<I.length;$++)if(N=I[$],N.getAttribute("content")===(h.content==null?null:""+h.content)&&N.getAttribute("name")===(h.name==null?null:h.name)&&N.getAttribute("property")===(h.property==null?null:h.property)&&N.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&N.getAttribute("charset")===(h.charSet==null?null:h.charSet)){I.splice($,1);break t}}N=k.createElement(x),bn(N,x,h),k.head.appendChild(N);break;default:throw Error(r(468,x))}N[gn]=a,ln(N),x=N}a.stateNode=x}else Uk(k,a.type,a.stateNode);else a.stateNode=Bk(k,x,a.memoizedProps);else N!==x?(N===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):N.count--,x===null?Uk(k,a.type,a.stateNode):Bk(k,x,a.memoizedProps)):x===null&&a.stateNode!==null&&Pm(a,a.memoizedProps,h.memoizedProps)}break;case 27:Jn(c,a),Zn(a),x&512&&(Qt||h===null||ms(h,h.return)),h!==null&&x&4&&Pm(a,a.memoizedProps,h.memoizedProps);break;case 5:if(Jn(c,a),Zn(a),x&512&&(Qt||h===null||ms(h,h.return)),a.flags&32){k=a.stateNode;try{Do(k,"")}catch(Re){ht(a,a.return,Re)}}x&4&&a.stateNode!=null&&(k=a.memoizedProps,Pm(a,k,h!==null?h.memoizedProps:k)),x&1024&&(Um=!0);break;case 6:if(Jn(c,a),Zn(a),x&4){if(a.stateNode===null)throw Error(r(162));x=a.memoizedProps,h=a.stateNode;try{h.nodeValue=x}catch(Re){ht(a,a.return,Re)}}break;case 3:if(Sf=null,k=rs,rs=vf(c.containerInfo),Jn(c,a),rs=k,Zn(a),x&4&&h!==null&&h.memoizedState.isDehydrated)try{fl(c.containerInfo)}catch(Re){ht(a,a.return,Re)}Um&&(Um=!1,US(a));break;case 4:x=rs,rs=vf(a.stateNode.containerInfo),Jn(c,a),Zn(a),rs=x;break;case 12:Jn(c,a),Zn(a);break;case 31:Jn(c,a),Zn(a),x&4&&(x=a.updateQueue,x!==null&&(a.updateQueue=null,af(a,x)));break;case 13:Jn(c,a),Zn(a),a.child.flags&8192&&a.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(lf=Ce()),x&4&&(x=a.updateQueue,x!==null&&(a.updateQueue=null,af(a,x)));break;case 22:k=a.memoizedState!==null;var G=h!==null&&h.memoizedState!==null,le=Ks,he=Qt;if(Ks=le||k,Qt=he||G,Jn(c,a),Qt=he,Ks=le,Zn(a),x&8192)e:for(c=a.stateNode,c._visibility=k?c._visibility&-2:c._visibility|1,k&&(h===null||G||Ks||Qt||Da(a)),h=null,c=a;;){if(c.tag===5||c.tag===26){if(h===null){G=h=c;try{if(N=G.stateNode,k)I=N.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none";else{$=G.stateNode;var ve=G.memoizedProps.style,ce=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;$.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(Re){ht(G,G.return,Re)}}}else if(c.tag===6){if(h===null){G=c;try{G.stateNode.nodeValue=k?"":G.memoizedProps}catch(Re){ht(G,G.return,Re)}}}else if(c.tag===18){if(h===null){G=c;try{var de=G.stateNode;k?Ak(de,!0):Ak(G.stateNode,!1)}catch(Re){ht(G,G.return,Re)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===a)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break e;for(;c.sibling===null;){if(c.return===null||c.return===a)break e;h===c&&(h=null),c=c.return}h===c&&(h=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=a.updateQueue,x!==null&&(h=x.retryQueue,h!==null&&(x.retryQueue=null,af(a,h))));break;case 19:Jn(c,a),Zn(a),x&4&&(x=a.updateQueue,x!==null&&(a.updateQueue=null,af(a,x)));break;case 30:break;case 21:break;default:Jn(c,a),Zn(a)}}function Zn(a){var c=a.flags;if(c&2){try{for(var h,x=a.return;x!==null;){if(_S(x)){h=x;break}x=x.return}if(h==null)throw Error(r(160));switch(h.tag){case 27:var k=h.stateNode,N=Bm(a);sf(a,N,k);break;case 5:var I=h.stateNode;h.flags&32&&(Do(I,""),h.flags&=-33);var $=Bm(a);sf(a,$,I);break;case 3:case 4:var G=h.stateNode.containerInfo,le=Bm(a);Fm(a,le,G);break;default:throw Error(r(161))}}catch(he){ht(a,a.return,he)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function US(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var c=a;US(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),a=a.sibling}}function Ws(a,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)DS(a,c.alternate,c),c=c.sibling}function Da(a){for(a=a.child;a!==null;){var c=a;switch(c.tag){case 0:case 11:case 14:case 15:_i(4,c,c.return),Da(c);break;case 1:ms(c,c.return);var h=c.stateNode;typeof h.componentWillUnmount=="function"&&AS(c,c.return,h),Da(c);break;case 27:Vc(c.stateNode);case 26:case 5:ms(c,c.return),Da(c);break;case 22:c.memoizedState===null&&Da(c);break;case 30:Da(c);break;default:Da(c)}a=a.sibling}}function Ys(a,c,h){for(h=h&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,k=a,N=c,I=N.flags;switch(N.tag){case 0:case 11:case 15:Ys(k,N,h),Dc(4,N);break;case 1:if(Ys(k,N,h),x=N,k=x.stateNode,typeof k.componentDidMount=="function")try{k.componentDidMount()}catch(le){ht(x,x.return,le)}if(x=N,k=x.updateQueue,k!==null){var $=x.stateNode;try{var G=k.shared.hiddenCallbacks;if(G!==null)for(k.shared.hiddenCallbacks=null,k=0;k<G.length;k++)xw(G[k],$)}catch(le){ht(x,x.return,le)}}h&&I&64&&MS(N),Lc(N,N.return);break;case 27:OS(N);case 26:case 5:Ys(k,N,h),h&&x===null&&I&4&&RS(N),Lc(N,N.return);break;case 12:Ys(k,N,h);break;case 31:Ys(k,N,h),h&&I&4&&PS(k,N);break;case 13:Ys(k,N,h),h&&I&4&&BS(k,N);break;case 22:N.memoizedState===null&&Ys(k,N,h),Lc(N,N.return);break;case 30:break;default:Ys(k,N,h)}c=c.sibling}}function $m(a,c){var h=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),a=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(a=c.memoizedState.cachePool.pool),a!==h&&(a!=null&&a.refCount++,h!=null&&Sc(h))}function qm(a,c){a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&Sc(a))}function ss(a,c,h,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)$S(a,c,h,x),c=c.sibling}function $S(a,c,h,x){var k=c.flags;switch(c.tag){case 0:case 11:case 15:ss(a,c,h,x),k&2048&&Dc(9,c);break;case 1:ss(a,c,h,x);break;case 3:ss(a,c,h,x),k&2048&&(a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&Sc(a)));break;case 12:if(k&2048){ss(a,c,h,x),a=c.stateNode;try{var N=c.memoizedProps,I=N.id,$=N.onPostCommit;typeof $=="function"&&$(I,c.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(G){ht(c,c.return,G)}}else ss(a,c,h,x);break;case 31:ss(a,c,h,x);break;case 13:ss(a,c,h,x);break;case 23:break;case 22:N=c.stateNode,I=c.alternate,c.memoizedState!==null?N._visibility&2?ss(a,c,h,x):zc(a,c):N._visibility&2?ss(a,c,h,x):(N._visibility|=2,tl(a,c,h,x,(c.subtreeFlags&10256)!==0||!1)),k&2048&&$m(I,c);break;case 24:ss(a,c,h,x),k&2048&&qm(c.alternate,c);break;default:ss(a,c,h,x)}}function tl(a,c,h,x,k){for(k=k&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var N=a,I=c,$=h,G=x,le=I.flags;switch(I.tag){case 0:case 11:case 15:tl(N,I,$,G,k),Dc(8,I);break;case 23:break;case 22:var he=I.stateNode;I.memoizedState!==null?he._visibility&2?tl(N,I,$,G,k):zc(N,I):(he._visibility|=2,tl(N,I,$,G,k)),k&&le&2048&&$m(I.alternate,I);break;case 24:tl(N,I,$,G,k),k&&le&2048&&qm(I.alternate,I);break;default:tl(N,I,$,G,k)}c=c.sibling}}function zc(a,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var h=a,x=c,k=x.flags;switch(x.tag){case 22:zc(h,x),k&2048&&$m(x.alternate,x);break;case 24:zc(h,x),k&2048&&qm(x.alternate,x);break;default:zc(h,x)}c=c.sibling}}var Pc=8192;function nl(a,c,h){if(a.subtreeFlags&Pc)for(a=a.child;a!==null;)qS(a,c,h),a=a.sibling}function qS(a,c,h){switch(a.tag){case 26:nl(a,c,h),a.flags&Pc&&a.memoizedState!==null&&Z_(h,rs,a.memoizedState,a.memoizedProps);break;case 5:nl(a,c,h);break;case 3:case 4:var x=rs;rs=vf(a.stateNode.containerInfo),nl(a,c,h),rs=x;break;case 22:a.memoizedState===null&&(x=a.alternate,x!==null&&x.memoizedState!==null?(x=Pc,Pc=16777216,nl(a,c,h),Pc=x):nl(a,c,h));break;default:nl(a,c,h)}}function HS(a){var c=a.alternate;if(c!==null&&(a=c.child,a!==null)){c.child=null;do c=a.sibling,a.sibling=null,a=c;while(a!==null)}}function Bc(a){var c=a.deletions;if((a.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var x=c[h];cn=x,KS(x,a)}HS(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)VS(a),a=a.sibling}function VS(a){switch(a.tag){case 0:case 11:case 15:Bc(a),a.flags&2048&&_i(9,a,a.return);break;case 3:Bc(a);break;case 12:Bc(a);break;case 22:var c=a.stateNode;a.memoizedState!==null&&c._visibility&2&&(a.return===null||a.return.tag!==13)?(c._visibility&=-3,of(a)):Bc(a);break;default:Bc(a)}}function of(a){var c=a.deletions;if((a.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var x=c[h];cn=x,KS(x,a)}HS(a)}for(a=a.child;a!==null;){switch(c=a,c.tag){case 0:case 11:case 15:_i(8,c,c.return),of(c);break;case 22:h=c.stateNode,h._visibility&2&&(h._visibility&=-3,of(c));break;default:of(c)}a=a.sibling}}function KS(a,c){for(;cn!==null;){var h=cn;switch(h.tag){case 0:case 11:case 15:_i(8,h,c);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var x=h.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Sc(h.memoizedState.cache)}if(x=h.child,x!==null)x.return=h,cn=x;else e:for(h=a;cn!==null;){x=cn;var k=x.sibling,N=x.return;if(LS(x),x===h){cn=null;break e}if(k!==null){k.return=N,cn=k;break e}cn=N}}}var p_={getCacheForType:function(a){var c=yn(Ht),h=c.data.get(a);return h===void 0&&(h=a(),c.data.set(a,h)),h},cacheSignal:function(){return yn(Ht).controller.signal}},g_=typeof WeakMap=="function"?WeakMap:Map,ct=0,wt=null,Xe=null,et=0,ft=0,mr=null,Oi=!1,rl=!1,Hm=!1,Gs=0,It=0,Ii=0,La=0,Vm=0,yr=0,sl=0,Fc=null,er=null,Km=!1,lf=0,QS=0,cf=1/0,uf=null,Di=null,tn=0,Li=null,il=null,Xs=0,Qm=0,Wm=null,WS=null,Uc=0,Ym=null;function xr(){return(ct&2)!==0&&et!==0?et&-et:q.T!==null?t0():ts()}function YS(){if(yr===0)if((et&536870912)===0||rt){var a=_s;_s<<=1,(_s&3932160)===0&&(_s=262144),yr=a}else yr=536870912;return a=pr.current,a!==null&&(a.flags|=32),yr}function tr(a,c,h){(a===wt&&(ft===2||ft===9)||a.cancelPendingCommit!==null)&&(al(a,0),zi(a,et,yr,!1)),Nr(a,h),((ct&2)===0||a!==wt)&&(a===wt&&((ct&2)===0&&(La|=h),It===4&&zi(a,et,yr,!1)),ys(a))}function GS(a,c,h){if((ct&6)!==0)throw Error(r(327));var x=!h&&(c&127)===0&&(c&a.expiredLanes)===0||Kn(a,c),k=x?x_(a,c):Xm(a,c,!0),N=x;do{if(k===0){rl&&!x&&zi(a,c,0,!1);break}else{if(h=a.current.alternate,N&&!m_(h)){k=Xm(a,c,!1),N=!1;continue}if(k===2){if(N=c,a.errorRecoveryDisabledLanes&N)var I=0;else I=a.pendingLanes&-536870913,I=I!==0?I:I&536870912?536870912:0;if(I!==0){c=I;e:{var $=a;k=Fc;var G=$.current.memoizedState.isDehydrated;if(G&&(al($,I).flags|=256),I=Xm($,I,!1),I!==2){if(Hm&&!G){$.errorRecoveryDisabledLanes|=N,La|=N,k=4;break e}N=er,er=k,N!==null&&(er===null?er=N:er.push.apply(er,N))}k=I}if(N=!1,k!==2)continue}}if(k===1){al(a,0),zi(a,c,0,!0);break}e:{switch(x=a,N=k,N){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:zi(x,c,yr,!Oi);break e;case 2:er=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(k=lf+300-Ce(),10<k)){if(zi(x,c,yr,!Oi),on(x,0,!0)!==0)break e;Xs=c,x.timeoutHandle=jk(XS.bind(null,x,h,er,uf,Km,c,yr,La,sl,Oi,N,"Throttled",-0,0),k);break e}XS(x,h,er,uf,Km,c,yr,La,sl,Oi,N,null,-0,0)}}break}while(!0);ys(a)}function XS(a,c,h,x,k,N,I,$,G,le,he,ve,ce,de){if(a.timeoutHandle=-1,ve=c.subtreeFlags,ve&8192||(ve&16785408)===16785408){ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ls},qS(c,N,ve);var Re=(N&62914560)===N?lf-Ce():(N&4194048)===N?QS-Ce():0;if(Re=e4(ve,Re),Re!==null){Xs=N,a.cancelPendingCommit=Re(ik.bind(null,a,c,N,h,x,k,I,$,G,he,ve,null,ce,de)),zi(a,N,I,!le);return}}ik(a,c,N,h,x,k,I,$,G)}function m_(a){for(var c=a;;){var h=c.tag;if((h===0||h===11||h===15)&&c.flags&16384&&(h=c.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var x=0;x<h.length;x++){var k=h[x],N=k.getSnapshot;k=k.value;try{if(!fr(N(),k))return!1}catch{return!1}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function zi(a,c,h,x){c&=~Vm,c&=~La,a.suspendedLanes|=c,a.pingedLanes&=~c,x&&(a.warmLanes|=c),x=a.expirationTimes;for(var k=c;0<k;){var N=31-Nt(k),I=1<<N;x[N]=-1,k&=~I}h!==0&&es(a,h,c)}function df(){return(ct&6)===0?($c(0),!1):!0}function Gm(){if(Xe!==null){if(ft===0)var a=Xe.return;else a=Xe,Fs=ja=null,fm(a),Go=null,Cc=0,a=Xe;for(;a!==null;)ES(a.alternate,a),a=a.return;Xe=null}}function al(a,c){var h=a.timeoutHandle;h!==-1&&(a.timeoutHandle=-1,L_(h)),h=a.cancelPendingCommit,h!==null&&(a.cancelPendingCommit=null,h()),Xs=0,Gm(),wt=a,Xe=h=Ps(a.current,null),et=c,ft=0,mr=null,Oi=!1,rl=Kn(a,c),Hm=!1,sl=yr=Vm=La=Ii=It=0,er=Fc=null,Km=!1,(c&8)!==0&&(c|=c&32);var x=a.entangledLanes;if(x!==0)for(a=a.entanglements,x&=c;0<x;){var k=31-Nt(x),N=1<<k;c|=a[k],x&=~N}return Gs=c,Rd(),h}function JS(a,c){Ke=null,q.H=_c,c===Yo||c===Bd?(c=pw(),ft=3):c===em?(c=pw(),ft=4):ft=c===Em?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,mr=c,Xe===null&&(It=1,Zd(a,Rr(c,a.current)))}function ZS(){var a=pr.current;return a===null?!0:(et&4194048)===et?Dr===null:(et&62914560)===et||(et&536870912)!==0?a===Dr:!1}function ek(){var a=q.H;return q.H=_c,a===null?_c:a}function tk(){var a=q.A;return q.A=p_,a}function ff(){It=4,Oi||(et&4194048)!==et&&pr.current!==null||(rl=!0),(Ii&134217727)===0&&(La&134217727)===0||wt===null||zi(wt,et,yr,!1)}function Xm(a,c,h){var x=ct;ct|=2;var k=ek(),N=tk();(wt!==a||et!==c)&&(uf=null,al(a,c)),c=!1;var I=It;e:do try{if(ft!==0&&Xe!==null){var $=Xe,G=mr;switch(ft){case 8:Gm(),I=6;break e;case 3:case 2:case 9:case 6:pr.current===null&&(c=!0);var le=ft;if(ft=0,mr=null,ol(a,$,G,le),h&&rl){I=0;break e}break;default:le=ft,ft=0,mr=null,ol(a,$,G,le)}}y_(),I=It;break}catch(he){JS(a,he)}while(!0);return c&&a.shellSuspendCounter++,Fs=ja=null,ct=x,q.H=k,q.A=N,Xe===null&&(wt=null,et=0,Rd()),I}function y_(){for(;Xe!==null;)nk(Xe)}function x_(a,c){var h=ct;ct|=2;var x=ek(),k=tk();wt!==a||et!==c?(uf=null,cf=Ce()+500,al(a,c)):rl=Kn(a,c);e:do try{if(ft!==0&&Xe!==null){c=Xe;var N=mr;t:switch(ft){case 1:ft=0,mr=null,ol(a,c,N,1);break;case 2:case 9:if(fw(N)){ft=0,mr=null,rk(c);break}c=function(){ft!==2&&ft!==9||wt!==a||(ft=7),ys(a)},N.then(c,c);break e;case 3:ft=7;break e;case 4:ft=5;break e;case 7:fw(N)?(ft=0,mr=null,rk(c)):(ft=0,mr=null,ol(a,c,N,7));break;case 5:var I=null;switch(Xe.tag){case 26:I=Xe.memoizedState;case 5:case 27:var $=Xe;if(I?$k(I):$.stateNode.complete){ft=0,mr=null;var G=$.sibling;if(G!==null)Xe=G;else{var le=$.return;le!==null?(Xe=le,hf(le)):Xe=null}break t}}ft=0,mr=null,ol(a,c,N,5);break;case 6:ft=0,mr=null,ol(a,c,N,6);break;case 8:Gm(),It=6;break e;default:throw Error(r(462))}}b_();break}catch(he){JS(a,he)}while(!0);return Fs=ja=null,q.H=x,q.A=k,ct=h,Xe!==null?0:(wt=null,et=0,Rd(),It)}function b_(){for(;Xe!==null&&!ae();)nk(Xe)}function nk(a){var c=TS(a.alternate,a,Gs);a.memoizedProps=a.pendingProps,c===null?hf(a):Xe=c}function rk(a){var c=a,h=c.alternate;switch(c.tag){case 15:case 0:c=vS(h,c,c.pendingProps,c.type,void 0,et);break;case 11:c=vS(h,c,c.pendingProps,c.type.render,c.ref,et);break;case 5:fm(c);default:ES(h,c),c=Xe=tw(c,Gs),c=TS(h,c,Gs)}a.memoizedProps=a.pendingProps,c===null?hf(a):Xe=c}function ol(a,c,h,x){Fs=ja=null,fm(c),Go=null,Cc=0;var k=c.return;try{if(o_(a,k,c,h,et)){It=1,Zd(a,Rr(h,a.current)),Xe=null;return}}catch(N){if(k!==null)throw Xe=k,N;It=1,Zd(a,Rr(h,a.current)),Xe=null;return}c.flags&32768?(rt||x===1?a=!0:rl||(et&536870912)!==0?a=!1:(Oi=a=!0,(x===2||x===9||x===3||x===6)&&(x=pr.current,x!==null&&x.tag===13&&(x.flags|=16384))),sk(c,a)):hf(c)}function hf(a){var c=a;do{if((c.flags&32768)!==0){sk(c,Oi);return}a=c.return;var h=u_(c.alternate,c,Gs);if(h!==null){Xe=h;return}if(c=c.sibling,c!==null){Xe=c;return}Xe=c=a}while(c!==null);It===0&&(It=5)}function sk(a,c){do{var h=d_(a.alternate,a);if(h!==null){h.flags&=32767,Xe=h;return}if(h=a.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!c&&(a=a.sibling,a!==null)){Xe=a;return}Xe=a=h}while(a!==null);It=6,Xe=null}function ik(a,c,h,x,k,N,I,$,G){a.cancelPendingCommit=null;do pf();while(tn!==0);if((ct&6)!==0)throw Error(r(327));if(c!==null){if(c===a.current)throw Error(r(177));if(N=c.lanes|c.childLanes,N|=Bg,en(a,h,N,I,$,G),a===wt&&(Xe=wt=null,et=0),il=c,Li=a,Xs=h,Qm=N,Wm=k,WS=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,k_(Ue,function(){return uk(),null})):(a.callbackNode=null,a.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=q.T,q.T=null,k=V.p,V.p=2,I=ct,ct|=4;try{f_(a,c,h)}finally{ct=I,V.p=k,q.T=x}}tn=1,ak(),ok(),lk()}}function ak(){if(tn===1){tn=0;var a=Li,c=il,h=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||h){h=q.T,q.T=null;var x=V.p;V.p=2;var k=ct;ct|=4;try{FS(c,a);var N=c0,I=K1(a.containerInfo),$=N.focusedElem,G=N.selectionRange;if(I!==$&&$&&$.ownerDocument&&V1($.ownerDocument.documentElement,$)){if(G!==null&&Ig($)){var le=G.start,he=G.end;if(he===void 0&&(he=le),"selectionStart"in $)$.selectionStart=le,$.selectionEnd=Math.min(he,$.value.length);else{var ve=$.ownerDocument||document,ce=ve&&ve.defaultView||window;if(ce.getSelection){var de=ce.getSelection(),Re=$.textContent.length,Fe=Math.min(G.start,Re),bt=G.end===void 0?Fe:Math.min(G.end,Re);!de.extend&&Fe>bt&&(I=bt,bt=Fe,Fe=I);var ne=H1($,Fe),J=H1($,bt);if(ne&&J&&(de.rangeCount!==1||de.anchorNode!==ne.node||de.anchorOffset!==ne.offset||de.focusNode!==J.node||de.focusOffset!==J.offset)){var oe=ve.createRange();oe.setStart(ne.node,ne.offset),de.removeAllRanges(),Fe>bt?(de.addRange(oe),de.extend(J.node,J.offset)):(oe.setEnd(J.node,J.offset),de.addRange(oe))}}}}for(ve=[],de=$;de=de.parentNode;)de.nodeType===1&&ve.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<ve.length;$++){var ye=ve[$];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}Tf=!!l0,c0=l0=null}finally{ct=k,V.p=x,q.T=h}}a.current=c,tn=2}}function ok(){if(tn===2){tn=0;var a=Li,c=il,h=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||h){h=q.T,q.T=null;var x=V.p;V.p=2;var k=ct;ct|=4;try{DS(a,c.alternate,c)}finally{ct=k,V.p=x,q.T=h}}tn=3}}function lk(){if(tn===4||tn===3){tn=0,xe();var a=Li,c=il,h=Xs,x=WS;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?tn=5:(tn=0,il=Li=null,ck(a,a.pendingLanes));var k=a.pendingLanes;if(k===0&&(Di=null),Is(h),c=c.stateNode,qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(dt,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=q.T,k=V.p,V.p=2,q.T=null;try{for(var N=a.onRecoverableError,I=0;I<x.length;I++){var $=x[I];N($.value,{componentStack:$.stack})}}finally{q.T=c,V.p=k}}(Xs&3)!==0&&pf(),ys(a),k=a.pendingLanes,(h&261930)!==0&&(k&42)!==0?a===Ym?Uc++:(Uc=0,Ym=a):Uc=0,$c(0)}}function ck(a,c){(a.pooledCacheLanes&=c)===0&&(c=a.pooledCache,c!=null&&(a.pooledCache=null,Sc(c)))}function pf(){return ak(),ok(),lk(),uk()}function uk(){if(tn!==5)return!1;var a=Li,c=Qm;Qm=0;var h=Is(Xs),x=q.T,k=V.p;try{V.p=32>h?32:h,q.T=null,h=Wm,Wm=null;var N=Li,I=Xs;if(tn=0,il=Li=null,Xs=0,(ct&6)!==0)throw Error(r(331));var $=ct;if(ct|=4,VS(N.current),$S(N,N.current,I,h),ct=$,$c(0,!1),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(dt,N)}catch{}return!0}finally{V.p=k,q.T=x,ck(a,c)}}function dk(a,c,h){c=Rr(h,c),c=jm(a.stateNode,c,2),a=Mi(a,c,2),a!==null&&(Nr(a,2),ys(a))}function ht(a,c,h){if(a.tag===3)dk(a,a,h);else for(;c!==null;){if(c.tag===3){dk(c,a,h);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Di===null||!Di.has(x))){a=Rr(h,a),h=fS(2),x=Mi(c,h,2),x!==null&&(hS(h,x,c,a),Nr(x,2),ys(x));break}}c=c.return}}function Jm(a,c,h){var x=a.pingCache;if(x===null){x=a.pingCache=new g_;var k=new Set;x.set(c,k)}else k=x.get(c),k===void 0&&(k=new Set,x.set(c,k));k.has(h)||(Hm=!0,k.add(h),a=v_.bind(null,a,c,h),c.then(a,a))}function v_(a,c,h){var x=a.pingCache;x!==null&&x.delete(c),a.pingedLanes|=a.suspendedLanes&h,a.warmLanes&=~h,wt===a&&(et&h)===h&&(It===4||It===3&&(et&62914560)===et&&300>Ce()-lf?(ct&2)===0&&al(a,0):Vm|=h,sl===et&&(sl=0)),ys(a)}function fk(a,c){c===0&&(c=Tn()),a=Ca(a,c),a!==null&&(Nr(a,c),ys(a))}function w_(a){var c=a.memoizedState,h=0;c!==null&&(h=c.retryLane),fk(a,h)}function S_(a,c){var h=0;switch(a.tag){case 31:case 13:var x=a.stateNode,k=a.memoizedState;k!==null&&(h=k.retryLane);break;case 19:x=a.stateNode;break;case 22:x=a.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(c),fk(a,h)}function k_(a,c){return pe(a,c)}var gf=null,ll=null,Zm=!1,mf=!1,e0=!1,Pi=0;function ys(a){a!==ll&&a.next===null&&(ll===null?gf=ll=a:ll=ll.next=a),mf=!0,Zm||(Zm=!0,N_())}function $c(a,c){if(!e0&&mf){e0=!0;do for(var h=!1,x=gf;x!==null;){if(a!==0){var k=x.pendingLanes;if(k===0)var N=0;else{var I=x.suspendedLanes,$=x.pingedLanes;N=(1<<31-Nt(42|a)+1)-1,N&=k&~(I&~$),N=N&201326741?N&201326741|1:N?N|2:0}N!==0&&(h=!0,mk(x,N))}else N=et,N=on(x,x===wt?N:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(N&3)===0||Kn(x,N)||(h=!0,mk(x,N));x=x.next}while(h);e0=!1}}function C_(){hk()}function hk(){mf=Zm=!1;var a=0;Pi!==0&&D_()&&(a=Pi);for(var c=Ce(),h=null,x=gf;x!==null;){var k=x.next,N=pk(x,c);N===0?(x.next=null,h===null?gf=k:h.next=k,k===null&&(ll=h)):(h=x,(a!==0||(N&3)!==0)&&(mf=!0)),x=k}tn!==0&&tn!==5||$c(a),Pi!==0&&(Pi=0)}function pk(a,c){for(var h=a.suspendedLanes,x=a.pingedLanes,k=a.expirationTimes,N=a.pendingLanes&-62914561;0<N;){var I=31-Nt(N),$=1<<I,G=k[I];G===-1?(($&h)===0||($&x)!==0)&&(k[I]=Qn($,c)):G<=c&&(a.expiredLanes|=$),N&=~$}if(c=wt,h=et,h=on(a,a===c?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),x=a.callbackNode,h===0||a===c&&(ft===2||ft===9)||a.cancelPendingCommit!==null)return x!==null&&x!==null&&we(x),a.callbackNode=null,a.callbackPriority=0;if((h&3)===0||Kn(a,h)){if(c=h&-h,c===a.callbackPriority)return c;switch(x!==null&&we(x),Is(h)){case 2:case 8:h=Ze;break;case 32:h=Ue;break;case 268435456:h=Zr;break;default:h=Ue}return x=gk.bind(null,a),h=pe(h,x),a.callbackPriority=c,a.callbackNode=h,c}return x!==null&&x!==null&&we(x),a.callbackPriority=2,a.callbackNode=null,2}function gk(a,c){if(tn!==0&&tn!==5)return a.callbackNode=null,a.callbackPriority=0,null;var h=a.callbackNode;if(pf()&&a.callbackNode!==h)return null;var x=et;return x=on(a,a===wt?x:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),x===0?null:(GS(a,x,c),pk(a,Ce()),a.callbackNode!=null&&a.callbackNode===h?gk.bind(null,a):null)}function mk(a,c){if(pf())return null;GS(a,c,!0)}function N_(){z_(function(){(ct&6)!==0?pe(Ie,C_):hk()})}function t0(){if(Pi===0){var a=Qo;a===0&&(a=vi,vi<<=1,(vi&261888)===0&&(vi=256)),Pi=a}return Pi}function yk(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:kd(""+a)}function xk(a,c){var h=c.ownerDocument.createElement("input");return h.name=c.name,h.value=c.value,a.id&&h.setAttribute("form",a.id),c.parentNode.insertBefore(h,c),a=new FormData(a),h.parentNode.removeChild(h),a}function T_(a,c,h,x,k){if(c==="submit"&&h&&h.stateNode===k){var N=yk((k[Yn]||null).action),I=x.submitter;I&&(c=(c=I[Yn]||null)?yk(c.formAction):I.getAttribute("formAction"),c!==null&&(N=c,I=null));var $=new jd("action","action",null,x,k);a.push({event:$,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Pi!==0){var G=I?xk(k,I):new FormData(k);wm(h,{pending:!0,data:G,method:k.method,action:N},null,G)}}else typeof N=="function"&&($.preventDefault(),G=I?xk(k,I):new FormData(k),wm(h,{pending:!0,data:G,method:k.method,action:N},N,G))},currentTarget:k}]})}}for(var n0=0;n0<Pg.length;n0++){var r0=Pg[n0],j_=r0.toLowerCase(),E_=r0[0].toUpperCase()+r0.slice(1);ns(j_,"on"+E_)}ns(Y1,"onAnimationEnd"),ns(G1,"onAnimationIteration"),ns(X1,"onAnimationStart"),ns("dblclick","onDoubleClick"),ns("focusin","onFocus"),ns("focusout","onBlur"),ns(HR,"onTransitionRun"),ns(VR,"onTransitionStart"),ns(KR,"onTransitionCancel"),ns(J1,"onTransitionEnd"),Oo("onMouseEnter",["mouseout","mouseover"]),Oo("onMouseLeave",["mouseout","mouseover"]),Oo("onPointerEnter",["pointerout","pointerover"]),Oo("onPointerLeave",["pointerout","pointerover"]),va("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),va("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),va("onBeforeInput",["compositionend","keypress","textInput","paste"]),va("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),va("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),va("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),M_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(qc));function bk(a,c){c=(c&4)!==0;for(var h=0;h<a.length;h++){var x=a[h],k=x.event;x=x.listeners;e:{var N=void 0;if(c)for(var I=x.length-1;0<=I;I--){var $=x[I],G=$.instance,le=$.currentTarget;if($=$.listener,G!==N&&k.isPropagationStopped())break e;N=$,k.currentTarget=le;try{N(k)}catch(he){Ad(he)}k.currentTarget=null,N=G}else for(I=0;I<x.length;I++){if($=x[I],G=$.instance,le=$.currentTarget,$=$.listener,G!==N&&k.isPropagationStopped())break e;N=$,k.currentTarget=le;try{N(k)}catch(he){Ad(he)}k.currentTarget=null,N=G}}}}function Je(a,c){var h=c[mg];h===void 0&&(h=c[mg]=new Set);var x=a+"__bubble";h.has(x)||(vk(c,a,2,!1),h.add(x))}function s0(a,c,h){var x=0;c&&(x|=4),vk(h,a,x,c)}var yf="_reactListening"+Math.random().toString(36).slice(2);function i0(a){if(!a[yf]){a[yf]=!0,h1.forEach(function(h){h!=="selectionchange"&&(M_.has(h)||s0(h,!1,a),s0(h,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[yf]||(c[yf]=!0,s0("selectionchange",!1,c))}}function vk(a,c,h,x){switch(Yk(c)){case 2:var k=r4;break;case 8:k=s4;break;default:k=v0}h=k.bind(null,c,h,a),k=void 0,!Ng||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(k=!0),x?k!==void 0?a.addEventListener(c,h,{capture:!0,passive:k}):a.addEventListener(c,h,!0):k!==void 0?a.addEventListener(c,h,{passive:k}):a.addEventListener(c,h,!1)}function a0(a,c,h,x,k){var N=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var I=x.tag;if(I===3||I===4){var $=x.stateNode.containerInfo;if($===k)break;if(I===4)for(I=x.return;I!==null;){var G=I.tag;if((G===3||G===4)&&I.stateNode.containerInfo===k)return;I=I.return}for(;$!==null;){if(I=Ao($),I===null)return;if(G=I.tag,G===5||G===6||G===26||G===27){x=N=I;continue e}$=$.parentNode}}x=x.return}N1(function(){var le=N,he=kg(h),ve=[];e:{var ce=Z1.get(a);if(ce!==void 0){var de=jd,Re=a;switch(a){case"keypress":if(Nd(h)===0)break e;case"keydown":case"keyup":de=SR;break;case"focusin":Re="focus",de=Mg;break;case"focusout":Re="blur",de=Mg;break;case"beforeblur":case"afterblur":de=Mg;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=E1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=uR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=NR;break;case Y1:case G1:case X1:de=hR;break;case J1:de=jR;break;case"scroll":case"scrollend":de=lR;break;case"wheel":de=MR;break;case"copy":case"cut":case"paste":de=gR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=A1;break;case"toggle":case"beforetoggle":de=RR}var Fe=(c&4)!==0,bt=!Fe&&(a==="scroll"||a==="scrollend"),ne=Fe?ce!==null?ce+"Capture":null:ce;Fe=[];for(var J=le,oe;J!==null;){var ye=J;if(oe=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||oe===null||ne===null||(ye=dc(J,ne),ye!=null&&Fe.push(Hc(J,ye,oe))),bt)break;J=J.return}0<Fe.length&&(ce=new de(ce,Re,null,h,he),ve.push({event:ce,listeners:Fe}))}}if((c&7)===0){e:{if(ce=a==="mouseover"||a==="pointerover",de=a==="mouseout"||a==="pointerout",ce&&h!==Sg&&(Re=h.relatedTarget||h.fromElement)&&(Ao(Re)||Re[Mo]))break e;if((de||ce)&&(ce=he.window===he?he:(ce=he.ownerDocument)?ce.defaultView||ce.parentWindow:window,de?(Re=h.relatedTarget||h.toElement,de=le,Re=Re?Ao(Re):null,Re!==null&&(bt=i(Re),Fe=Re.tag,Re!==bt||Fe!==5&&Fe!==27&&Fe!==6)&&(Re=null)):(de=null,Re=le),de!==Re)){if(Fe=E1,ye="onMouseLeave",ne="onMouseEnter",J="mouse",(a==="pointerout"||a==="pointerover")&&(Fe=A1,ye="onPointerLeave",ne="onPointerEnter",J="pointer"),bt=de==null?ce:uc(de),oe=Re==null?ce:uc(Re),ce=new Fe(ye,J+"leave",de,h,he),ce.target=bt,ce.relatedTarget=oe,ye=null,Ao(he)===le&&(Fe=new Fe(ne,J+"enter",Re,h,he),Fe.target=oe,Fe.relatedTarget=bt,ye=Fe),bt=ye,de&&Re)t:{for(Fe=A_,ne=de,J=Re,oe=0,ye=ne;ye;ye=Fe(ye))oe++;ye=0;for(var ze=J;ze;ze=Fe(ze))ye++;for(;0<oe-ye;)ne=Fe(ne),oe--;for(;0<ye-oe;)J=Fe(J),ye--;for(;oe--;){if(ne===J||J!==null&&ne===J.alternate){Fe=ne;break t}ne=Fe(ne),J=Fe(J)}Fe=null}else Fe=null;de!==null&&wk(ve,ce,de,Fe,!1),Re!==null&&bt!==null&&wk(ve,bt,Re,Fe,!0)}}e:{if(ce=le?uc(le):window,de=ce.nodeName&&ce.nodeName.toLowerCase(),de==="select"||de==="input"&&ce.type==="file")var at=P1;else if(L1(ce))if(B1)at=UR;else{at=BR;var _e=PR}else de=ce.nodeName,!de||de.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?le&&wg(le.elementType)&&(at=P1):at=FR;if(at&&(at=at(a,le))){z1(ve,at,h,he);break e}_e&&_e(a,ce,le),a==="focusout"&&le&&ce.type==="number"&&le.memoizedProps.value!=null&&vg(ce,"number",ce.value)}switch(_e=le?uc(le):window,a){case"focusin":(L1(_e)||_e.contentEditable==="true")&&(Bo=_e,Dg=le,bc=null);break;case"focusout":bc=Dg=Bo=null;break;case"mousedown":Lg=!0;break;case"contextmenu":case"mouseup":case"dragend":Lg=!1,Q1(ve,h,he);break;case"selectionchange":if(qR)break;case"keydown":case"keyup":Q1(ve,h,he)}var We;if(Rg)e:{switch(a){case"compositionstart":var tt="onCompositionStart";break e;case"compositionend":tt="onCompositionEnd";break e;case"compositionupdate":tt="onCompositionUpdate";break e}tt=void 0}else Po?I1(a,h)&&(tt="onCompositionEnd"):a==="keydown"&&h.keyCode===229&&(tt="onCompositionStart");tt&&(R1&&h.locale!=="ko"&&(Po||tt!=="onCompositionStart"?tt==="onCompositionEnd"&&Po&&(We=T1()):(Si=he,Tg="value"in Si?Si.value:Si.textContent,Po=!0)),_e=xf(le,tt),0<_e.length&&(tt=new M1(tt,a,null,h,he),ve.push({event:tt,listeners:_e}),We?tt.data=We:(We=D1(h),We!==null&&(tt.data=We)))),(We=OR?IR(a,h):DR(a,h))&&(tt=xf(le,"onBeforeInput"),0<tt.length&&(_e=new M1("onBeforeInput","beforeinput",null,h,he),ve.push({event:_e,listeners:tt}),_e.data=We)),T_(ve,a,le,h,he)}bk(ve,c)})}function Hc(a,c,h){return{instance:a,listener:c,currentTarget:h}}function xf(a,c){for(var h=c+"Capture",x=[];a!==null;){var k=a,N=k.stateNode;if(k=k.tag,k!==5&&k!==26&&k!==27||N===null||(k=dc(a,h),k!=null&&x.unshift(Hc(a,k,N)),k=dc(a,c),k!=null&&x.push(Hc(a,k,N))),a.tag===3)return x;a=a.return}return[]}function A_(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function wk(a,c,h,x,k){for(var N=c._reactName,I=[];h!==null&&h!==x;){var $=h,G=$.alternate,le=$.stateNode;if($=$.tag,G!==null&&G===x)break;$!==5&&$!==26&&$!==27||le===null||(G=le,k?(le=dc(h,N),le!=null&&I.unshift(Hc(h,le,G))):k||(le=dc(h,N),le!=null&&I.push(Hc(h,le,G)))),h=h.return}I.length!==0&&a.push({event:c,listeners:I})}var R_=/\r\n?/g,__=/\u0000|\uFFFD/g;function Sk(a){return(typeof a=="string"?a:""+a).replace(R_,`
`).replace(__,"")}function kk(a,c){return c=Sk(c),Sk(a)===c}function xt(a,c,h,x,k,N){switch(h){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||Do(a,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&Do(a,""+x);break;case"className":wd(a,"class",x);break;case"tabIndex":wd(a,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":wd(a,h,x);break;case"style":k1(a,x,N);break;case"data":if(c!=="object"){wd(a,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||h!=="href")){a.removeAttribute(h);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){a.removeAttribute(h);break}x=kd(""+x),a.setAttribute(h,x);break;case"action":case"formAction":if(typeof x=="function"){a.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof N=="function"&&(h==="formAction"?(c!=="input"&&xt(a,c,"name",k.name,k,null),xt(a,c,"formEncType",k.formEncType,k,null),xt(a,c,"formMethod",k.formMethod,k,null),xt(a,c,"formTarget",k.formTarget,k,null)):(xt(a,c,"encType",k.encType,k,null),xt(a,c,"method",k.method,k,null),xt(a,c,"target",k.target,k,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){a.removeAttribute(h);break}x=kd(""+x),a.setAttribute(h,x);break;case"onClick":x!=null&&(a.onclick=Ls);break;case"onScroll":x!=null&&Je("scroll",a);break;case"onScrollEnd":x!=null&&Je("scrollend",a);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(h=x.__html,h!=null){if(k.children!=null)throw Error(r(60));a.innerHTML=h}}break;case"multiple":a.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":a.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){a.removeAttribute("xlink:href");break}h=kd(""+x),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?a.setAttribute(h,""+x):a.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?a.setAttribute(h,""):a.removeAttribute(h);break;case"capture":case"download":x===!0?a.setAttribute(h,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?a.setAttribute(h,x):a.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?a.setAttribute(h,x):a.removeAttribute(h);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?a.removeAttribute(h):a.setAttribute(h,x);break;case"popover":Je("beforetoggle",a),Je("toggle",a),vd(a,"popover",x);break;case"xlinkActuate":Ds(a,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Ds(a,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Ds(a,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Ds(a,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Ds(a,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Ds(a,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Ds(a,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Ds(a,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Ds(a,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":vd(a,"is",x);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=aR.get(h)||h,vd(a,h,x))}}function o0(a,c,h,x,k,N){switch(h){case"style":k1(a,x,N);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(h=x.__html,h!=null){if(k.children!=null)throw Error(r(60));a.innerHTML=h}}break;case"children":typeof x=="string"?Do(a,x):(typeof x=="number"||typeof x=="bigint")&&Do(a,""+x);break;case"onScroll":x!=null&&Je("scroll",a);break;case"onScrollEnd":x!=null&&Je("scrollend",a);break;case"onClick":x!=null&&(a.onclick=Ls);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!p1.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(k=h.endsWith("Capture"),c=h.slice(2,k?h.length-7:void 0),N=a[Yn]||null,N=N!=null?N[h]:null,typeof N=="function"&&a.removeEventListener(c,N,k),typeof x=="function")){typeof N!="function"&&N!==null&&(h in a?a[h]=null:a.hasAttribute(h)&&a.removeAttribute(h)),a.addEventListener(c,x,k);break e}h in a?a[h]=x:x===!0?a.setAttribute(h,""):vd(a,h,x)}}}function bn(a,c,h){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Je("error",a),Je("load",a);var x=!1,k=!1,N;for(N in h)if(h.hasOwnProperty(N)){var I=h[N];if(I!=null)switch(N){case"src":x=!0;break;case"srcSet":k=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:xt(a,c,N,I,h,null)}}k&&xt(a,c,"srcSet",h.srcSet,h,null),x&&xt(a,c,"src",h.src,h,null);return;case"input":Je("invalid",a);var $=N=I=k=null,G=null,le=null;for(x in h)if(h.hasOwnProperty(x)){var he=h[x];if(he!=null)switch(x){case"name":k=he;break;case"type":I=he;break;case"checked":G=he;break;case"defaultChecked":le=he;break;case"value":N=he;break;case"defaultValue":$=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(r(137,c));break;default:xt(a,c,x,he,h,null)}}b1(a,N,$,G,le,I,k,!1);return;case"select":Je("invalid",a),x=I=N=null;for(k in h)if(h.hasOwnProperty(k)&&($=h[k],$!=null))switch(k){case"value":N=$;break;case"defaultValue":I=$;break;case"multiple":x=$;default:xt(a,c,k,$,h,null)}c=N,h=I,a.multiple=!!x,c!=null?Io(a,!!x,c,!1):h!=null&&Io(a,!!x,h,!0);return;case"textarea":Je("invalid",a),N=k=x=null;for(I in h)if(h.hasOwnProperty(I)&&($=h[I],$!=null))switch(I){case"value":x=$;break;case"defaultValue":k=$;break;case"children":N=$;break;case"dangerouslySetInnerHTML":if($!=null)throw Error(r(91));break;default:xt(a,c,I,$,h,null)}w1(a,x,k,N);return;case"option":for(G in h)if(h.hasOwnProperty(G)&&(x=h[G],x!=null))switch(G){case"selected":a.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:xt(a,c,G,x,h,null)}return;case"dialog":Je("beforetoggle",a),Je("toggle",a),Je("cancel",a),Je("close",a);break;case"iframe":case"object":Je("load",a);break;case"video":case"audio":for(x=0;x<qc.length;x++)Je(qc[x],a);break;case"image":Je("error",a),Je("load",a);break;case"details":Je("toggle",a);break;case"embed":case"source":case"link":Je("error",a),Je("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in h)if(h.hasOwnProperty(le)&&(x=h[le],x!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:xt(a,c,le,x,h,null)}return;default:if(wg(c)){for(he in h)h.hasOwnProperty(he)&&(x=h[he],x!==void 0&&o0(a,c,he,x,h,void 0));return}}for($ in h)h.hasOwnProperty($)&&(x=h[$],x!=null&&xt(a,c,$,x,h,null))}function O_(a,c,h,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var k=null,N=null,I=null,$=null,G=null,le=null,he=null;for(de in h){var ve=h[de];if(h.hasOwnProperty(de)&&ve!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":G=ve;default:x.hasOwnProperty(de)||xt(a,c,de,null,x,ve)}}for(var ce in x){var de=x[ce];if(ve=h[ce],x.hasOwnProperty(ce)&&(de!=null||ve!=null))switch(ce){case"type":N=de;break;case"name":k=de;break;case"checked":le=de;break;case"defaultChecked":he=de;break;case"value":I=de;break;case"defaultValue":$=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(r(137,c));break;default:de!==ve&&xt(a,c,ce,de,x,ve)}}bg(a,I,$,G,le,he,N,k);return;case"select":de=I=$=ce=null;for(N in h)if(G=h[N],h.hasOwnProperty(N)&&G!=null)switch(N){case"value":break;case"multiple":de=G;default:x.hasOwnProperty(N)||xt(a,c,N,null,x,G)}for(k in x)if(N=x[k],G=h[k],x.hasOwnProperty(k)&&(N!=null||G!=null))switch(k){case"value":ce=N;break;case"defaultValue":$=N;break;case"multiple":I=N;default:N!==G&&xt(a,c,k,N,x,G)}c=$,h=I,x=de,ce!=null?Io(a,!!h,ce,!1):!!x!=!!h&&(c!=null?Io(a,!!h,c,!0):Io(a,!!h,h?[]:"",!1));return;case"textarea":de=ce=null;for($ in h)if(k=h[$],h.hasOwnProperty($)&&k!=null&&!x.hasOwnProperty($))switch($){case"value":break;case"children":break;default:xt(a,c,$,null,x,k)}for(I in x)if(k=x[I],N=h[I],x.hasOwnProperty(I)&&(k!=null||N!=null))switch(I){case"value":ce=k;break;case"defaultValue":de=k;break;case"children":break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(r(91));break;default:k!==N&&xt(a,c,I,k,x,N)}v1(a,ce,de);return;case"option":for(var Re in h)if(ce=h[Re],h.hasOwnProperty(Re)&&ce!=null&&!x.hasOwnProperty(Re))switch(Re){case"selected":a.selected=!1;break;default:xt(a,c,Re,null,x,ce)}for(G in x)if(ce=x[G],de=h[G],x.hasOwnProperty(G)&&ce!==de&&(ce!=null||de!=null))switch(G){case"selected":a.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:xt(a,c,G,ce,x,de)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Fe in h)ce=h[Fe],h.hasOwnProperty(Fe)&&ce!=null&&!x.hasOwnProperty(Fe)&&xt(a,c,Fe,null,x,ce);for(le in x)if(ce=x[le],de=h[le],x.hasOwnProperty(le)&&ce!==de&&(ce!=null||de!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(r(137,c));break;default:xt(a,c,le,ce,x,de)}return;default:if(wg(c)){for(var bt in h)ce=h[bt],h.hasOwnProperty(bt)&&ce!==void 0&&!x.hasOwnProperty(bt)&&o0(a,c,bt,void 0,x,ce);for(he in x)ce=x[he],de=h[he],!x.hasOwnProperty(he)||ce===de||ce===void 0&&de===void 0||o0(a,c,he,ce,x,de);return}}for(var ne in h)ce=h[ne],h.hasOwnProperty(ne)&&ce!=null&&!x.hasOwnProperty(ne)&&xt(a,c,ne,null,x,ce);for(ve in x)ce=x[ve],de=h[ve],!x.hasOwnProperty(ve)||ce===de||ce==null&&de==null||xt(a,c,ve,ce,x,de)}function Ck(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function I_(){if(typeof performance.getEntriesByType=="function"){for(var a=0,c=0,h=performance.getEntriesByType("resource"),x=0;x<h.length;x++){var k=h[x],N=k.transferSize,I=k.initiatorType,$=k.duration;if(N&&$&&Ck(I)){for(I=0,$=k.responseEnd,x+=1;x<h.length;x++){var G=h[x],le=G.startTime;if(le>$)break;var he=G.transferSize,ve=G.initiatorType;he&&Ck(ve)&&(G=G.responseEnd,I+=he*(G<$?1:($-le)/(G-le)))}if(--x,c+=8*(N+I)/(k.duration/1e3),a++,10<a)break}}if(0<a)return c/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var l0=null,c0=null;function bf(a){return a.nodeType===9?a:a.ownerDocument}function Nk(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Tk(a,c){if(a===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&c==="foreignObject"?0:a}function u0(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var d0=null;function D_(){var a=window.event;return a&&a.type==="popstate"?a===d0?!1:(d0=a,!0):(d0=null,!1)}var jk=typeof setTimeout=="function"?setTimeout:void 0,L_=typeof clearTimeout=="function"?clearTimeout:void 0,Ek=typeof Promise=="function"?Promise:void 0,z_=typeof queueMicrotask=="function"?queueMicrotask:typeof Ek<"u"?function(a){return Ek.resolve(null).then(a).catch(P_)}:jk;function P_(a){setTimeout(function(){throw a})}function Bi(a){return a==="head"}function Mk(a,c){var h=c,x=0;do{var k=h.nextSibling;if(a.removeChild(h),k&&k.nodeType===8)if(h=k.data,h==="/$"||h==="/&"){if(x===0){a.removeChild(k),fl(c);return}x--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")x++;else if(h==="html")Vc(a.ownerDocument.documentElement);else if(h==="head"){h=a.ownerDocument.head,Vc(h);for(var N=h.firstChild;N;){var I=N.nextSibling,$=N.nodeName;N[cc]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&N.rel.toLowerCase()==="stylesheet"||h.removeChild(N),N=I}}else h==="body"&&Vc(a.ownerDocument.body);h=k}while(h);fl(c)}function Ak(a,c){var h=a;a=0;do{var x=h.nextSibling;if(h.nodeType===1?c?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(c?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),x&&x.nodeType===8)if(h=x.data,h==="/$"){if(a===0)break;a--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||a++;h=x}while(h)}function f0(a){var c=a.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var h=c;switch(c=c.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":f0(h),yg(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}a.removeChild(h)}}function B_(a,c,h,x){for(;a.nodeType===1;){var k=h;if(a.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(x){if(!a[cc])switch(c){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(N=a.getAttribute("rel"),N==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(N!==k.rel||a.getAttribute("href")!==(k.href==null||k.href===""?null:k.href)||a.getAttribute("crossorigin")!==(k.crossOrigin==null?null:k.crossOrigin)||a.getAttribute("title")!==(k.title==null?null:k.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(N=a.getAttribute("src"),(N!==(k.src==null?null:k.src)||a.getAttribute("type")!==(k.type==null?null:k.type)||a.getAttribute("crossorigin")!==(k.crossOrigin==null?null:k.crossOrigin))&&N&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(c==="input"&&a.type==="hidden"){var N=k.name==null?null:""+k.name;if(k.type==="hidden"&&a.getAttribute("name")===N)return a}else return a;if(a=Lr(a.nextSibling),a===null)break}return null}function F_(a,c,h){if(c==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!h||(a=Lr(a.nextSibling),a===null))return null;return a}function Rk(a,c){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=Lr(a.nextSibling),a===null))return null;return a}function h0(a){return a.data==="$?"||a.data==="$~"}function p0(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function U_(a,c){var h=a.ownerDocument;if(a.data==="$~")a._reactRetry=c;else if(a.data!=="$?"||h.readyState!=="loading")c();else{var x=function(){c(),h.removeEventListener("DOMContentLoaded",x)};h.addEventListener("DOMContentLoaded",x),a._reactRetry=x}}function Lr(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return a}var g0=null;function _k(a){a=a.nextSibling;for(var c=0;a;){if(a.nodeType===8){var h=a.data;if(h==="/$"||h==="/&"){if(c===0)return Lr(a.nextSibling);c--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||c++}a=a.nextSibling}return null}function Ok(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var h=a.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(c===0)return a;c--}else h!=="/$"&&h!=="/&"||c++}a=a.previousSibling}return null}function Ik(a,c,h){switch(c=bf(h),a){case"html":if(a=c.documentElement,!a)throw Error(r(452));return a;case"head":if(a=c.head,!a)throw Error(r(453));return a;case"body":if(a=c.body,!a)throw Error(r(454));return a;default:throw Error(r(451))}}function Vc(a){for(var c=a.attributes;c.length;)a.removeAttributeNode(c[0]);yg(a)}var zr=new Map,Dk=new Set;function vf(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Js=V.d;V.d={f:$_,r:q_,D:H_,C:V_,L:K_,m:Q_,X:Y_,S:W_,M:G_};function $_(){var a=Js.f(),c=df();return a||c}function q_(a){var c=Ro(a);c!==null&&c.tag===5&&c.type==="form"?Jw(c):Js.r(a)}var cl=typeof document>"u"?null:document;function Lk(a,c,h){var x=cl;if(x&&typeof c=="string"&&c){var k=Mr(c);k='link[rel="'+a+'"][href="'+k+'"]',typeof h=="string"&&(k+='[crossorigin="'+h+'"]'),Dk.has(k)||(Dk.add(k),a={rel:a,crossOrigin:h,href:c},x.querySelector(k)===null&&(c=x.createElement("link"),bn(c,"link",a),ln(c),x.head.appendChild(c)))}}function H_(a){Js.D(a),Lk("dns-prefetch",a,null)}function V_(a,c){Js.C(a,c),Lk("preconnect",a,c)}function K_(a,c,h){Js.L(a,c,h);var x=cl;if(x&&a&&c){var k='link[rel="preload"][as="'+Mr(c)+'"]';c==="image"&&h&&h.imageSrcSet?(k+='[imagesrcset="'+Mr(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(k+='[imagesizes="'+Mr(h.imageSizes)+'"]')):k+='[href="'+Mr(a)+'"]';var N=k;switch(c){case"style":N=ul(a);break;case"script":N=dl(a)}zr.has(N)||(a=g({rel:"preload",href:c==="image"&&h&&h.imageSrcSet?void 0:a,as:c},h),zr.set(N,a),x.querySelector(k)!==null||c==="style"&&x.querySelector(Kc(N))||c==="script"&&x.querySelector(Qc(N))||(c=x.createElement("link"),bn(c,"link",a),ln(c),x.head.appendChild(c)))}}function Q_(a,c){Js.m(a,c);var h=cl;if(h&&a){var x=c&&typeof c.as=="string"?c.as:"script",k='link[rel="modulepreload"][as="'+Mr(x)+'"][href="'+Mr(a)+'"]',N=k;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":N=dl(a)}if(!zr.has(N)&&(a=g({rel:"modulepreload",href:a},c),zr.set(N,a),h.querySelector(k)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Qc(N)))return}x=h.createElement("link"),bn(x,"link",a),ln(x),h.head.appendChild(x)}}}function W_(a,c,h){Js.S(a,c,h);var x=cl;if(x&&a){var k=_o(x).hoistableStyles,N=ul(a);c=c||"default";var I=k.get(N);if(!I){var $={loading:0,preload:null};if(I=x.querySelector(Kc(N)))$.loading=5;else{a=g({rel:"stylesheet",href:a,"data-precedence":c},h),(h=zr.get(N))&&m0(a,h);var G=I=x.createElement("link");ln(G),bn(G,"link",a),G._p=new Promise(function(le,he){G.onload=le,G.onerror=he}),G.addEventListener("load",function(){$.loading|=1}),G.addEventListener("error",function(){$.loading|=2}),$.loading|=4,wf(I,c,x)}I={type:"stylesheet",instance:I,count:1,state:$},k.set(N,I)}}}function Y_(a,c){Js.X(a,c);var h=cl;if(h&&a){var x=_o(h).hoistableScripts,k=dl(a),N=x.get(k);N||(N=h.querySelector(Qc(k)),N||(a=g({src:a,async:!0},c),(c=zr.get(k))&&y0(a,c),N=h.createElement("script"),ln(N),bn(N,"link",a),h.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},x.set(k,N))}}function G_(a,c){Js.M(a,c);var h=cl;if(h&&a){var x=_o(h).hoistableScripts,k=dl(a),N=x.get(k);N||(N=h.querySelector(Qc(k)),N||(a=g({src:a,async:!0,type:"module"},c),(c=zr.get(k))&&y0(a,c),N=h.createElement("script"),ln(N),bn(N,"link",a),h.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},x.set(k,N))}}function zk(a,c,h,x){var k=(k=se.current)?vf(k):null;if(!k)throw Error(r(446));switch(a){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(c=ul(h.href),h=_o(k).hoistableStyles,x=h.get(c),x||(x={type:"style",instance:null,count:0,state:null},h.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){a=ul(h.href);var N=_o(k).hoistableStyles,I=N.get(a);if(I||(k=k.ownerDocument||k,I={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},N.set(a,I),(N=k.querySelector(Kc(a)))&&!N._p&&(I.instance=N,I.state.loading=5),zr.has(a)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},zr.set(a,h),N||X_(k,a,h,I.state))),c&&x===null)throw Error(r(528,""));return I}if(c&&x!==null)throw Error(r(529,""));return null;case"script":return c=h.async,h=h.src,typeof h=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=dl(h),h=_o(k).hoistableScripts,x=h.get(c),x||(x={type:"script",instance:null,count:0,state:null},h.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,a))}}function ul(a){return'href="'+Mr(a)+'"'}function Kc(a){return'link[rel="stylesheet"]['+a+"]"}function Pk(a){return g({},a,{"data-precedence":a.precedence,precedence:null})}function X_(a,c,h,x){a.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=a.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),bn(c,"link",h),ln(c),a.head.appendChild(c))}function dl(a){return'[src="'+Mr(a)+'"]'}function Qc(a){return"script[async]"+a}function Bk(a,c,h){if(c.count++,c.instance===null)switch(c.type){case"style":var x=a.querySelector('style[data-href~="'+Mr(h.href)+'"]');if(x)return c.instance=x,ln(x),x;var k=g({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return x=(a.ownerDocument||a).createElement("style"),ln(x),bn(x,"style",k),wf(x,h.precedence,a),c.instance=x;case"stylesheet":k=ul(h.href);var N=a.querySelector(Kc(k));if(N)return c.state.loading|=4,c.instance=N,ln(N),N;x=Pk(h),(k=zr.get(k))&&m0(x,k),N=(a.ownerDocument||a).createElement("link"),ln(N);var I=N;return I._p=new Promise(function($,G){I.onload=$,I.onerror=G}),bn(N,"link",x),c.state.loading|=4,wf(N,h.precedence,a),c.instance=N;case"script":return N=dl(h.src),(k=a.querySelector(Qc(N)))?(c.instance=k,ln(k),k):(x=h,(k=zr.get(N))&&(x=g({},h),y0(x,k)),a=a.ownerDocument||a,k=a.createElement("script"),ln(k),bn(k,"link",x),a.head.appendChild(k),c.instance=k);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,wf(x,h.precedence,a));return c.instance}function wf(a,c,h){for(var x=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),k=x.length?x[x.length-1]:null,N=k,I=0;I<x.length;I++){var $=x[I];if($.dataset.precedence===c)N=$;else if(N!==k)break}N?N.parentNode.insertBefore(a,N.nextSibling):(c=h.nodeType===9?h.head:h,c.insertBefore(a,c.firstChild))}function m0(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.title==null&&(a.title=c.title)}function y0(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.integrity==null&&(a.integrity=c.integrity)}var Sf=null;function Fk(a,c,h){if(Sf===null){var x=new Map,k=Sf=new Map;k.set(h,x)}else k=Sf,x=k.get(h),x||(x=new Map,k.set(h,x));if(x.has(a))return x;for(x.set(a,null),h=h.getElementsByTagName(a),k=0;k<h.length;k++){var N=h[k];if(!(N[cc]||N[gn]||a==="link"&&N.getAttribute("rel")==="stylesheet")&&N.namespaceURI!=="http://www.w3.org/2000/svg"){var I=N.getAttribute(c)||"";I=a+I;var $=x.get(I);$?$.push(N):x.set(I,[N])}}return x}function Uk(a,c,h){a=a.ownerDocument||a,a.head.insertBefore(h,c==="title"?a.querySelector("head > title"):null)}function J_(a,c,h){if(h===1||c.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return a=c.disabled,typeof c.precedence=="string"&&a==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function $k(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function Z_(a,c,h,x){if(h.type==="stylesheet"&&(typeof x.media!="string"||matchMedia(x.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var k=ul(x.href),N=c.querySelector(Kc(k));if(N){c=N._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(a.count++,a=kf.bind(a),c.then(a,a)),h.state.loading|=4,h.instance=N,ln(N);return}N=c.ownerDocument||c,x=Pk(x),(k=zr.get(k))&&m0(x,k),N=N.createElement("link"),ln(N);var I=N;I._p=new Promise(function($,G){I.onload=$,I.onerror=G}),bn(N,"link",x),h.instance=N}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(h,c),(c=h.state.preload)&&(h.state.loading&3)===0&&(a.count++,h=kf.bind(a),c.addEventListener("load",h),c.addEventListener("error",h))}}var x0=0;function e4(a,c){return a.stylesheets&&a.count===0&&Nf(a,a.stylesheets),0<a.count||0<a.imgCount?function(h){var x=setTimeout(function(){if(a.stylesheets&&Nf(a,a.stylesheets),a.unsuspend){var N=a.unsuspend;a.unsuspend=null,N()}},6e4+c);0<a.imgBytes&&x0===0&&(x0=62500*I_());var k=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&Nf(a,a.stylesheets),a.unsuspend)){var N=a.unsuspend;a.unsuspend=null,N()}},(a.imgBytes>x0?50:800)+c);return a.unsuspend=h,function(){a.unsuspend=null,clearTimeout(x),clearTimeout(k)}}:null}function kf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Nf(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Cf=null;function Nf(a,c){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Cf=new Map,c.forEach(t4,a),Cf=null,kf.call(a))}function t4(a,c){if(!(c.state.loading&4)){var h=Cf.get(a);if(h)var x=h.get(null);else{h=new Map,Cf.set(a,h);for(var k=a.querySelectorAll("link[data-precedence],style[data-precedence]"),N=0;N<k.length;N++){var I=k[N];(I.nodeName==="LINK"||I.getAttribute("media")!=="not all")&&(h.set(I.dataset.precedence,I),x=I)}x&&h.set(null,x)}k=c.instance,I=k.getAttribute("data-precedence"),N=h.get(I)||x,N===x&&h.set(null,k),h.set(I,k),this.count++,x=kf.bind(this),k.addEventListener("load",x),k.addEventListener("error",x),N?N.parentNode.insertBefore(k,N.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(k,a.firstChild)),c.state.loading|=4}}var Wc={$$typeof:j,Provider:null,Consumer:null,_currentValue:ie,_currentValue2:ie,_threadCount:0};function n4(a,c,h,x,k,N,I,$,G){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Wn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wn(0),this.hiddenUpdates=Wn(null),this.identifierPrefix=x,this.onUncaughtError=k,this.onCaughtError=N,this.onRecoverableError=I,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function qk(a,c,h,x,k,N,I,$,G,le,he,ve){return a=new n4(a,c,h,I,G,le,he,ve,$),c=1,N===!0&&(c|=24),N=hr(3,null,null,c),a.current=N,N.stateNode=a,c=Xg(),c.refCount++,a.pooledCache=c,c.refCount++,N.memoizedState={element:x,isDehydrated:h,cache:c},tm(N),a}function Hk(a){return a?(a=$o,a):$o}function Vk(a,c,h,x,k,N){k=Hk(k),x.context===null?x.context=k:x.pendingContext=k,x=Ei(c),x.payload={element:h},N=N===void 0?null:N,N!==null&&(x.callback=N),h=Mi(a,x,c),h!==null&&(tr(h,a,c),Tc(h,a,c))}function Kk(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var h=a.retryLane;a.retryLane=h!==0&&h<c?h:c}}function b0(a,c){Kk(a,c),(a=a.alternate)&&Kk(a,c)}function Qk(a){if(a.tag===13||a.tag===31){var c=Ca(a,67108864);c!==null&&tr(c,a,67108864),b0(a,67108864)}}function Wk(a){if(a.tag===13||a.tag===31){var c=xr();c=Os(c);var h=Ca(a,c);h!==null&&tr(h,a,c),b0(a,c)}}var Tf=!0;function r4(a,c,h,x){var k=q.T;q.T=null;var N=V.p;try{V.p=2,v0(a,c,h,x)}finally{V.p=N,q.T=k}}function s4(a,c,h,x){var k=q.T;q.T=null;var N=V.p;try{V.p=8,v0(a,c,h,x)}finally{V.p=N,q.T=k}}function v0(a,c,h,x){if(Tf){var k=w0(x);if(k===null)a0(a,c,x,jf,h),Gk(a,x);else if(a4(k,a,c,h,x))x.stopPropagation();else if(Gk(a,x),c&4&&-1<i4.indexOf(a)){for(;k!==null;){var N=Ro(k);if(N!==null)switch(N.tag){case 3:if(N=N.stateNode,N.current.memoizedState.isDehydrated){var I=Tt(N.pendingLanes);if(I!==0){var $=N;for($.pendingLanes|=2,$.entangledLanes|=2;I;){var G=1<<31-Nt(I);$.entanglements[1]|=G,I&=~G}ys(N),(ct&6)===0&&(cf=Ce()+500,$c(0))}}break;case 31:case 13:$=Ca(N,2),$!==null&&tr($,N,2),df(),b0(N,2)}if(N=w0(x),N===null&&a0(a,c,x,jf,h),N===k)break;k=N}k!==null&&x.stopPropagation()}else a0(a,c,x,null,h)}}function w0(a){return a=kg(a),S0(a)}var jf=null;function S0(a){if(jf=null,a=Ao(a),a!==null){var c=i(a);if(c===null)a=null;else{var h=c.tag;if(h===13){if(a=o(c),a!==null)return a;a=null}else if(h===31){if(a=l(c),a!==null)return a;a=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null)}}return jf=a,null}function Yk(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Te()){case Ie:return 2;case Ze:return 8;case Ue:case $t:return 32;case Zr:return 268435456;default:return 32}default:return 32}}var k0=!1,Fi=null,Ui=null,$i=null,Yc=new Map,Gc=new Map,qi=[],i4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Gk(a,c){switch(a){case"focusin":case"focusout":Fi=null;break;case"dragenter":case"dragleave":Ui=null;break;case"mouseover":case"mouseout":$i=null;break;case"pointerover":case"pointerout":Yc.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gc.delete(c.pointerId)}}function Xc(a,c,h,x,k,N){return a===null||a.nativeEvent!==N?(a={blockedOn:c,domEventName:h,eventSystemFlags:x,nativeEvent:N,targetContainers:[k]},c!==null&&(c=Ro(c),c!==null&&Qk(c)),a):(a.eventSystemFlags|=x,c=a.targetContainers,k!==null&&c.indexOf(k)===-1&&c.push(k),a)}function a4(a,c,h,x,k){switch(c){case"focusin":return Fi=Xc(Fi,a,c,h,x,k),!0;case"dragenter":return Ui=Xc(Ui,a,c,h,x,k),!0;case"mouseover":return $i=Xc($i,a,c,h,x,k),!0;case"pointerover":var N=k.pointerId;return Yc.set(N,Xc(Yc.get(N)||null,a,c,h,x,k)),!0;case"gotpointercapture":return N=k.pointerId,Gc.set(N,Xc(Gc.get(N)||null,a,c,h,x,k)),!0}return!1}function Xk(a){var c=Ao(a.target);if(c!==null){var h=i(c);if(h!==null){if(c=h.tag,c===13){if(c=o(h),c!==null){a.blockedOn=c,wi(a.priority,function(){Wk(h)});return}}else if(c===31){if(c=l(h),c!==null){a.blockedOn=c,wi(a.priority,function(){Wk(h)});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){a.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Ef(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var h=w0(a.nativeEvent);if(h===null){h=a.nativeEvent;var x=new h.constructor(h.type,h);Sg=x,h.target.dispatchEvent(x),Sg=null}else return c=Ro(h),c!==null&&Qk(c),a.blockedOn=h,!1;c.shift()}return!0}function Jk(a,c,h){Ef(a)&&h.delete(c)}function o4(){k0=!1,Fi!==null&&Ef(Fi)&&(Fi=null),Ui!==null&&Ef(Ui)&&(Ui=null),$i!==null&&Ef($i)&&($i=null),Yc.forEach(Jk),Gc.forEach(Jk)}function Mf(a,c){a.blockedOn===c&&(a.blockedOn=null,k0||(k0=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,o4)))}var Af=null;function Zk(a){Af!==a&&(Af=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Af===a&&(Af=null);for(var c=0;c<a.length;c+=3){var h=a[c],x=a[c+1],k=a[c+2];if(typeof x!="function"){if(S0(x||h)===null)continue;break}var N=Ro(h);N!==null&&(a.splice(c,3),c-=3,wm(N,{pending:!0,data:k,method:h.method,action:x},x,k))}}))}function fl(a){function c(G){return Mf(G,a)}Fi!==null&&Mf(Fi,a),Ui!==null&&Mf(Ui,a),$i!==null&&Mf($i,a),Yc.forEach(c),Gc.forEach(c);for(var h=0;h<qi.length;h++){var x=qi[h];x.blockedOn===a&&(x.blockedOn=null)}for(;0<qi.length&&(h=qi[0],h.blockedOn===null);)Xk(h),h.blockedOn===null&&qi.shift();if(h=(a.ownerDocument||a).$$reactFormReplay,h!=null)for(x=0;x<h.length;x+=3){var k=h[x],N=h[x+1],I=k[Yn]||null;if(typeof N=="function")I||Zk(h);else if(I){var $=null;if(N&&N.hasAttribute("formAction")){if(k=N,I=N[Yn]||null)$=I.formAction;else if(S0(k)!==null)continue}else $=I.action;typeof $=="function"?h[x+1]=$:(h.splice(x,3),x-=3),Zk(h)}}}function e2(){function a(N){N.canIntercept&&N.info==="react-transition"&&N.intercept({handler:function(){return new Promise(function(I){return k=I})},focusReset:"manual",scroll:"manual"})}function c(){k!==null&&(k(),k=null),x||setTimeout(h,20)}function h(){if(!x&&!navigation.transition){var N=navigation.currentEntry;N&&N.url!=null&&navigation.navigate(N.url,{state:N.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var x=!1,k=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(h,100),function(){x=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),k!==null&&(k(),k=null)}}}function C0(a){this._internalRoot=a}Rf.prototype.render=C0.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(r(409));var h=c.current,x=xr();Vk(h,x,a,c,null,null)},Rf.prototype.unmount=C0.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;Vk(a.current,2,null,a,null,null),df(),c[Mo]=null}};function Rf(a){this._internalRoot=a}Rf.prototype.unstable_scheduleHydration=function(a){if(a){var c=ts();a={blockedOn:null,target:a,priority:c};for(var h=0;h<qi.length&&c!==0&&c<qi[h].priority;h++);qi.splice(h,0,a),h===0&&Xk(a)}};var t2=e.version;if(t2!=="19.2.0")throw Error(r(527,t2,"19.2.0"));V.findDOMNode=function(a){var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=f(c),a=a!==null?p(a):null,a=a===null?null:a.stateNode,a};var l4={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _f=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_f.isDisabled&&_f.supportsFiber)try{dt=_f.inject(l4),qt=_f}catch{}}return nu.createRoot=function(a,c){if(!s(a))throw Error(r(299));var h=!1,x="",k=lS,N=cS,I=uS;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(k=c.onUncaughtError),c.onCaughtError!==void 0&&(N=c.onCaughtError),c.onRecoverableError!==void 0&&(I=c.onRecoverableError)),c=qk(a,1,!1,null,null,h,x,null,k,N,I,e2),a[Mo]=c.current,i0(a),new C0(c)},nu.hydrateRoot=function(a,c,h){if(!s(a))throw Error(r(299));var x=!1,k="",N=lS,I=cS,$=uS,G=null;return h!=null&&(h.unstable_strictMode===!0&&(x=!0),h.identifierPrefix!==void 0&&(k=h.identifierPrefix),h.onUncaughtError!==void 0&&(N=h.onUncaughtError),h.onCaughtError!==void 0&&(I=h.onCaughtError),h.onRecoverableError!==void 0&&($=h.onRecoverableError),h.formState!==void 0&&(G=h.formState)),c=qk(a,1,!0,c,h??null,x,k,G,N,I,$,e2),c.context=Hk(null),h=c.current,x=xr(),x=Os(x),k=Ei(x),k.callback=null,Mi(h,k,x),h=x,c.current.lanes=h,Nr(c,h),ys(c),a[Mo]=c.current,i0(a),new Rf(c)},nu.version="19.2.0",nu}var O2;function uI(){if(O2)return z0.exports;O2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),z0.exports=cI(),z0.exports}var dI=uI();const fI=Gl(dI),kj="church-hub-api-url",Nb="church-hub-user-auth",hI=typeof window<"u"&&"__TAURI__"in window,I2=/\/api\/auth\/user\/(usr_[A-Za-z0-9_]+)$/;function Dp(t){const e=t.match(I2);if(e){const n=e[1];return{baseUrl:t.replace(I2,""),userToken:n}}return{baseUrl:t.replace(/\/+$/,""),userToken:null}}function sd(){if(typeof window>"u")return null;try{return localStorage.getItem(kj)}catch{return null}}function Xl(){if(typeof window>"u")return null;try{return localStorage.getItem(Nb)}catch{return null}}function Cj(t){if(!(typeof window>"u"))try{const{baseUrl:e,userToken:n}=Dp(t);localStorage.setItem(kj,e),n&&(localStorage.setItem(Nb,n),document.cookie=`user_auth=${n}; path=/; SameSite=Lax`)}catch(e){console.error("Failed to save API URL:",e)}}function Nj(t){try{const{baseUrl:e}=Dp(t),n=new URL(e);return n.protocol==="http:"||n.protocol==="https:"}catch{return!1}}async function Tj(t){try{const{baseUrl:e,userToken:n}=Dp(t),s=await(hI?hi:fetch)(`${e}/ping`,{method:"GET"});return s.ok?(n&&(document.cookie=`user_auth=${n}; path=/; SameSite=Lax`,localStorage.setItem(Nb,n)),{success:!0}):{success:!1,error:`Server returned ${s.status}`}}catch(e){return e instanceof Error?{success:!1,error:`${e.name}: ${e.message}`}:{success:!1,error:"Unknown error occurred"}}}const jj="3000",Tb=typeof window<"u"&&"__TAURI_INTERNALS__"in window;function pn(){if(typeof window>"u"||!Tb)return!1;const t=navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")||t.includes("ipod")||t.includes("android")}function Ej(){return pn()?sd()===null:!1}function Mj(){return Tb&&!pn()?"localhost":typeof window<"u"&&window.location.hostname?window.location.hostname:"127.0.0.1"}function Ct(){return pn()?sd():`http://${Mj()}:${jj}`}function Aj(){if(pn()){const t=sd();return t?t.replace(/^http/,"ws"):null}return`ws://${Mj()}:${jj}`}function D2(){if(typeof window>"u"||pn())return!1;if(Tb)return!0;const t=window.location.hostname.toLowerCase();return t==="localhost"||t==="127.0.0.1"||t==="::1"||t.startsWith("127.")||t==="tauri.localhost"}const pI=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gI=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),L2=t=>{const e=gI(t);return e.charAt(0).toUpperCase()+e.slice(1)},Rj=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),mI=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var yI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const xI=C.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...l},d)=>C.createElement("svg",{ref:d,...yI,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:Rj("lucide",s),...!i&&!mI(l)&&{"aria-hidden":"true"},...l},[...o.map(([f,p])=>C.createElement(f,p)),...Array.isArray(i)?i:[i]]));const je=(t,e)=>{const n=C.forwardRef(({className:r,...s},i)=>C.createElement(xI,{ref:i,iconNode:e,className:Rj(`lucide-${pI(L2(t))}`,`lucide-${t}`,r),...s}));return n.displayName=L2(t),n};const bI=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],vI=je("arrow-left-right",bI);const wI=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],id=je("arrow-left",wI);const SI=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],_j=je("bell",SI);const kI=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Lp=je("book-open",kI);const CI=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],Sr=je("book",CI);const NI=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],Oj=je("bookmark",NI);const TI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],zp=je("calendar-days",TI);const jI=[["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M21 12.598V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8.5",key:"1glfrc"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}]],Th=je("calendar-plus",jI);const EI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ij=je("calendar",EI);const MI=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],jb=je("check",MI);const AI=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ms=je("chevron-down",AI);const RI=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Dj=je("chevron-left",RI);const _I=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],As=je("chevron-right",_I);const OI=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Eb=je("chevron-up",OI);const II=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],jh=je("circle-alert",II);const DI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],LI=je("circle-plus",DI);const zI=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Pp=je("clock",zI);const PI=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Lj=je("compass",PI);const BI=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ad=je("copy",BI);const FI=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Eh=je("download",FI);const UI=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Bp=je("ellipsis-vertical",UI);const $I=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Fp=je("external-link",$I);const qI=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Jl=je("eye-off",qI);const HI=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],pa=je("eye",HI);const VI=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],KI=je("file-question-mark",VI);const QI=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],fs=je("file-text",QI);const WI=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],Du=je("file-up",WI);const YI=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]],GI=je("film",YI);const XI=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],zj=je("folder-open",XI);const JI=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Pj=je("folder",JI);const ZI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],od=je("globe",ZI);const eD=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],Bj=je("grid-3x3",eD);const tD=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],cr=je("grip-vertical",tD);const nD=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Fj=je("heart",nD);const rD=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Uj=je("house",rD);const sD=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],$j=je("image",sD);const iD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],aD=je("info",iD);const oD=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],lD=je("key-round",oD);const cD=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],uD=je("key",cD);const dD=[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]],z2=je("keyboard",dD);const fD=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],hD=je("languages",fD);const pD=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],qj=je("layers",pD);const gD=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Hj=je("link",gD);const mD=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M11 19H3",key:"zflm78"}],["path",{d:"M21 16V5",key:"yxg4q8"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],Vj=je("list-music",mD);const yD=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 19H3",key:"zzsher"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]],xD=je("list-plus",yD);const bD=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Kj=je("list",bD);const vD=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Qe=je("loader-circle",vD);const wD=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Qj=je("mail",wD);const SD=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],Wj=je("map",SD);const kD=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],CD=je("maximize",kD);const ND=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],fo=je("megaphone",ND);const TD=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],jD=je("menu",TD);const ED=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Yj=je("message-square",ED);const MD=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],AD=je("minimize",MD);const RD=[["path",{d:"m9 10 3-3 3 3",key:"11gsxs"}],["path",{d:"M12 13V7",key:"h0r20n"}],["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M8 21h8",key:"1ev6f3"}]],Mh=je("monitor-up",RD);const _D=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],OD=je("move",_D);const ID=[["circle",{cx:"8",cy:"18",r:"4",key:"1fc0mg"}],["path",{d:"M12 18V2l7 4",key:"g04rme"}]],DD=je("music-2",ID);const LD=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],ya=je("music",LD);const zD=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Gj=je("palette",zD);const PD=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],BD=je("panel-left",PD);const FD=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],P2=je("pen-line",FD);const UD=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],to=je("pencil",UD);const $D=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Xj=je("phone",$D);const qD=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Mb=je("play",qD);const HD=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Xt=je("plus",HD);const VD=[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],KD=je("power-off",VD);const QD=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],Jj=je("power",QD);const WD=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],B2=je("qr-code",WD);const YD=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],GD=je("radio",YD);const XD=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],JD=je("redo-2",XD);const ZD=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ab=je("refresh-cw",ZD);const e6=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],t6=je("rotate-ccw",e6);const n6=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ld=je("save",n6);const r6=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Zl=je("search",r6);const s6=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],Zj=je("server",s6);const i6=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],di=je("settings",i6);const a6=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]],o6=je("shield-x",a6);const l6=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],eE=je("square-pen",l6);const c6=[["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}],["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}]],u6=je("square-play",c6);const d6=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],tE=je("square",d6);const f6=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],nE=je("star",f6);const h6=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],p6=je("tag",h6);const g6=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Fn=je("trash-2",g6);const m6=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],y6=je("triangle-alert",m6);const x6=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Uf=je("type",x6);const b6=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],v6=je("undo-2",b6);const w6=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],F2=je("upload",w6);const S6=[["circle",{cx:"10",cy:"7",r:"1",key:"dypaad"}],["circle",{cx:"4",cy:"20",r:"1",key:"22iqad"}],["path",{d:"M4.7 19.3 19 5",key:"1enqfc"}],["path",{d:"m21 3-3 1 2 2Z",key:"d3ov82"}],["path",{d:"M9.26 7.68 5 12l2 5",key:"1esawj"}],["path",{d:"m10 14 5 2 3.5-3.5",key:"v8oal5"}],["path",{d:"m18 12 1-1 1 1-1 1Z",key:"1bh22v"}]],k6=je("usb",S6);const C6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],$l=je("users",C6);const N6=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],rE=je("video",N6);const T6=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],j6=je("volume-2",T6);const E6=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],M6=je("volume-x",E6);const A6=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],sE=je("wifi-off",A6);const R6=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],Ah=je("wifi",R6);const _6=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],nt=je("x",_6);const O6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],I6=je("zoom-in",O6);const D6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],L6=je("zoom-out",D6),$e=t=>typeof t=="string",ru=()=>{let t,e;const n=new Promise((r,s)=>{t=r,e=s});return n.resolve=t,n.reject=e,n},U2=t=>t==null?"":""+t,z6=(t,e,n)=>{t.forEach(r=>{e[r]&&(n[r]=e[r])})},P6=/###/g,$2=t=>t&&t.indexOf("###")>-1?t.replace(P6,"."):t,q2=t=>!t||$e(t),yu=(t,e,n)=>{const r=$e(e)?e.split("."):e;let s=0;for(;s<r.length-1;){if(q2(t))return{};const i=$2(r[s]);!t[i]&&n&&(t[i]=new n),Object.prototype.hasOwnProperty.call(t,i)?t=t[i]:t={},++s}return q2(t)?{}:{obj:t,k:$2(r[s])}},H2=(t,e,n)=>{const{obj:r,k:s}=yu(t,e,Object);if(r!==void 0||e.length===1){r[s]=n;return}let i=e[e.length-1],o=e.slice(0,e.length-1),l=yu(t,o,Object);for(;l.obj===void 0&&o.length;)i=`${o[o.length-1]}.${i}`,o=o.slice(0,o.length-1),l=yu(t,o,Object),l?.obj&&typeof l.obj[`${l.k}.${i}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${i}`]=n},B6=(t,e,n,r)=>{const{obj:s,k:i}=yu(t,e,Object);s[i]=s[i]||[],s[i].push(n)},Rh=(t,e)=>{const{obj:n,k:r}=yu(t,e);if(n&&Object.prototype.hasOwnProperty.call(n,r))return n[r]},F6=(t,e,n)=>{const r=Rh(t,n);return r!==void 0?r:Rh(e,n)},iE=(t,e,n)=>{for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in t?$e(t[r])||t[r]instanceof String||$e(e[r])||e[r]instanceof String?n&&(t[r]=e[r]):iE(t[r],e[r],n):t[r]=e[r]);return t},pl=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var U6={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const $6=t=>$e(t)?t.replace(/[&<>"'\/]/g,e=>U6[e]):t;class q6{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const H6=[" ",",","?","!",";"],V6=new q6(20),K6=(t,e,n)=>{e=e||"",n=n||"";const r=H6.filter(o=>e.indexOf(o)<0&&n.indexOf(o)<0);if(r.length===0)return!0;const s=V6.getRegExp(`(${r.map(o=>o==="?"?"\\?":o).join("|")})`);let i=!s.test(t);if(!i){const o=t.indexOf(n);o>0&&!s.test(t.substring(0,o))&&(i=!0)}return i},ux=(t,e,n=".")=>{if(!t)return;if(t[e])return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0;const r=e.split(n);let s=t;for(let i=0;i<r.length;){if(!s||typeof s!="object")return;let o,l="";for(let d=i;d<r.length;++d)if(d!==i&&(l+=n),l+=r[d],o=s[l],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&d<r.length-1)continue;i+=d-i+1;break}s=o}return s},Lu=t=>t?.replace("_","-"),Q6={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console?.[t]?.apply?.(console,e)}};class _h{constructor(e,n={}){this.init(e,n)}init(e,n={}){this.prefix=n.prefix||"i18next:",this.logger=e||Q6,this.options=n,this.debug=n.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,r,s){return s&&!this.debug?null:($e(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new _h(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new _h(this.logger,e)}}var ks=new _h;let Up=class{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const s=this.observers[r].get(n)||0;this.observers[r].set(n,s+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e,...n){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([s,i])=>{for(let o=0;o<i;o++)s(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([s,i])=>{for(let o=0;o<i;o++)s.apply(s,[e,...n])})}};class V2 extends Up{constructor(e,n={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,r,s={}){const i=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,o=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;e.indexOf(".")>-1?l=e.split("."):(l=[e,n],r&&(Array.isArray(r)?l.push(...r):$e(r)&&i?l.push(...r.split(i)):l.push(r)));const d=Rh(this.data,l);return!d&&!n&&!r&&e.indexOf(".")>-1&&(e=l[0],n=l[1],r=l.slice(2).join(".")),d||!o||!$e(r)?d:ux(this.data?.[e]?.[n],r,i)}addResource(e,n,r,s,i={silent:!1}){const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let l=[e,n];r&&(l=l.concat(o?r.split(o):r)),e.indexOf(".")>-1&&(l=e.split("."),s=n,n=l[1]),this.addNamespaces(n),H2(this.data,l,s),i.silent||this.emit("added",e,n,r,s)}addResources(e,n,r,s={silent:!1}){for(const i in r)($e(r[i])||Array.isArray(r[i]))&&this.addResource(e,n,i,r[i],{silent:!0});s.silent||this.emit("added",e,n,r)}addResourceBundle(e,n,r,s,i,o={silent:!1,skipCopy:!1}){let l=[e,n];e.indexOf(".")>-1&&(l=e.split("."),s=r,r=n,n=l[1]),this.addNamespaces(n);let d=Rh(this.data,l)||{};o.skipCopy||(r=JSON.parse(JSON.stringify(r))),s?iE(d,r,i):d={...d,...r},H2(this.data,l,d),o.silent||this.emit("added",e,n,r)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(s=>n[s]&&Object.keys(n[s]).length>0)}toJSON(){return this.data}}var aE={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,r,s){return t.forEach(i=>{e=this.processors[i]?.process(e,n,r,s)??e}),e}};const oE=Symbol("i18next/PATH_KEY");function W6(){const t=[],e=Object.create(null);let n;return e.get=(r,s)=>(n?.revoke?.(),s===oE?t:(t.push(s),n=Proxy.revocable(r,e),n.proxy)),Proxy.revocable(Object.create(null),e).proxy}function dx(t,e){const{[oE]:n}=t(W6());return n.join(e?.keySeparator??".")}const K2={},F0=t=>!$e(t)&&typeof t!="boolean"&&typeof t!="number";class Oh extends Up{constructor(e,n={}){super(),z6(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=ks.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,n={interpolation:{}}){const r={...n};if(e==null)return!1;const s=this.resolve(e,r);if(s?.res===void 0)return!1;const i=F0(s.res);return!(r.returnObjects===!1&&i)}extractFromKey(e,n){let r=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const s=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let i=n.ns||this.options.defaultNS||[];const o=r&&e.indexOf(r)>-1,l=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!K6(e,r,s);if(o&&!l){const d=e.match(this.interpolator.nestingRegexp);if(d&&d.length>0)return{key:e,namespaces:$e(i)?[i]:i};const f=e.split(r);(r!==s||r===s&&this.options.ns.indexOf(f[0])>-1)&&(i=f.shift()),e=f.join(s)}return{key:e,namespaces:$e(i)?[i]:i}}translate(e,n,r){let s=typeof n=="object"?{...n}:n;if(typeof s!="object"&&this.options.overloadTranslationOptionHandler&&(s=this.options.overloadTranslationOptionHandler(arguments)),typeof s=="object"&&(s={...s}),s||(s={}),e==null)return"";typeof e=="function"&&(e=dx(e,{...this.options,...s})),Array.isArray(e)||(e=[String(e)]);const i=s.returnDetails!==void 0?s.returnDetails:this.options.returnDetails,o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,{key:l,namespaces:d}=this.extractFromKey(e[e.length-1],s),f=d[d.length-1];let p=s.nsSeparator!==void 0?s.nsSeparator:this.options.nsSeparator;p===void 0&&(p=":");const g=s.lng||this.language,m=s.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(g?.toLowerCase()==="cimode")return m?i?{res:`${f}${p}${l}`,usedKey:l,exactUsedKey:l,usedLng:g,usedNS:f,usedParams:this.getUsedParamsDetails(s)}:`${f}${p}${l}`:i?{res:l,usedKey:l,exactUsedKey:l,usedLng:g,usedNS:f,usedParams:this.getUsedParamsDetails(s)}:l;const y=this.resolve(e,s);let b=y?.res;const v=y?.usedKey||l,w=y?.exactUsedKey||l,S=["[object Number]","[object Function]","[object RegExp]"],T=s.joinArrays!==void 0?s.joinArrays:this.options.joinArrays,j=!this.i18nFormat||this.i18nFormat.handleAsObject,M=s.count!==void 0&&!$e(s.count),_=Oh.hasDefaultValue(s),R=M?this.pluralResolver.getSuffix(g,s.count,s):"",O=s.ordinal&&M?this.pluralResolver.getSuffix(g,s.count,{ordinal:!1}):"",L=M&&!s.ordinal&&s.count===0,A=L&&s[`defaultValue${this.options.pluralSeparator}zero`]||s[`defaultValue${R}`]||s[`defaultValue${O}`]||s.defaultValue;let F=b;j&&!b&&_&&(F=A);const H=F0(F),P=Object.prototype.toString.apply(F);if(j&&F&&H&&S.indexOf(P)<0&&!($e(T)&&Array.isArray(F))){if(!s.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const B=this.options.returnedObjectHandler?this.options.returnedObjectHandler(v,F,{...s,ns:d}):`key '${l} (${this.language})' returned an object instead of string.`;return i?(y.res=B,y.usedParams=this.getUsedParamsDetails(s),y):B}if(o){const B=Array.isArray(F),E=B?[]:{},K=B?w:v;for(const q in F)if(Object.prototype.hasOwnProperty.call(F,q)){const V=`${K}${o}${q}`;_&&!b?E[q]=this.translate(V,{...s,defaultValue:F0(A)?A[q]:void 0,joinArrays:!1,ns:d}):E[q]=this.translate(V,{...s,joinArrays:!1,ns:d}),E[q]===V&&(E[q]=F[q])}b=E}}else if(j&&$e(T)&&Array.isArray(b))b=b.join(T),b&&(b=this.extendTranslation(b,e,s,r));else{let B=!1,E=!1;!this.isValidLookup(b)&&_&&(B=!0,b=A),this.isValidLookup(b)||(E=!0,b=l);const q=(s.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&E?void 0:b,V=_&&A!==b&&this.options.updateMissing;if(E||B||V){if(this.logger.log(V?"updateKey":"missingKey",g,f,l,V?A:b),o){const D=this.resolve(l,{...s,keySeparator:!1});D&&D.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let ie=[];const Y=this.languageUtils.getFallbackCodes(this.options.fallbackLng,s.lng||this.language);if(this.options.saveMissingTo==="fallback"&&Y&&Y[0])for(let D=0;D<Y.length;D++)ie.push(Y[D]);else this.options.saveMissingTo==="all"?ie=this.languageUtils.toResolveHierarchy(s.lng||this.language):ie.push(s.lng||this.language);const X=(D,U,te)=>{const Z=_&&te!==b?te:q;this.options.missingKeyHandler?this.options.missingKeyHandler(D,f,U,Z,V,s):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(D,f,U,Z,V,s),this.emit("missingKey",D,f,U,b)};this.options.saveMissing&&(this.options.saveMissingPlurals&&M?ie.forEach(D=>{const U=this.pluralResolver.getSuffixes(D,s);L&&s[`defaultValue${this.options.pluralSeparator}zero`]&&U.indexOf(`${this.options.pluralSeparator}zero`)<0&&U.push(`${this.options.pluralSeparator}zero`),U.forEach(te=>{X([D],l+te,s[`defaultValue${te}`]||A)})}):X(ie,l,A))}b=this.extendTranslation(b,e,s,y,r),E&&b===l&&this.options.appendNamespaceToMissingKey&&(b=`${f}${p}${l}`),(E||B)&&this.options.parseMissingKeyHandler&&(b=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${f}${p}${l}`:l,B?b:void 0,s))}return i?(y.res=b,y.usedParams=this.getUsedParamsDetails(s),y):b}extendTranslation(e,n,r,s,i){if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const d=$e(e)&&(r?.interpolation?.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(d){const g=e.match(this.interpolator.nestingRegexp);f=g&&g.length}let p=r.replace&&!$e(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(p={...this.options.interpolation.defaultVariables,...p}),e=this.interpolator.interpolate(e,p,r.lng||this.language||s.usedLng,r),d){const g=e.match(this.interpolator.nestingRegexp),m=g&&g.length;f<m&&(r.nest=!1)}!r.lng&&s&&s.res&&(r.lng=this.language||s.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,(...g)=>i?.[0]===g[0]&&!r.context?(this.logger.warn(`It seems you are nesting recursively key: ${g[0]} in key: ${n[0]}`),null):this.translate(...g,n),r)),r.interpolation&&this.interpolator.reset()}const o=r.postProcess||this.options.postProcess,l=$e(o)?[o]:o;return e!=null&&l?.length&&r.applyPostProcessor!==!1&&(e=aE.handle(l,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e,n={}){let r,s,i,o,l;return $e(e)&&(e=[e]),e.forEach(d=>{if(this.isValidLookup(r))return;const f=this.extractFromKey(d,n),p=f.key;s=p;let g=f.namespaces;this.options.fallbackNS&&(g=g.concat(this.options.fallbackNS));const m=n.count!==void 0&&!$e(n.count),y=m&&!n.ordinal&&n.count===0,b=n.context!==void 0&&($e(n.context)||typeof n.context=="number")&&n.context!=="",v=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);g.forEach(w=>{this.isValidLookup(r)||(l=w,!K2[`${v[0]}-${w}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(l)&&(K2[`${v[0]}-${w}`]=!0,this.logger.warn(`key "${s}" for languages "${v.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),v.forEach(S=>{if(this.isValidLookup(r))return;o=S;const T=[p];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(T,p,S,w,n);else{let M;m&&(M=this.pluralResolver.getSuffix(S,n.count,n));const _=`${this.options.pluralSeparator}zero`,R=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(m&&(n.ordinal&&M.indexOf(R)===0&&T.push(p+M.replace(R,this.options.pluralSeparator)),T.push(p+M),y&&T.push(p+_)),b){const O=`${p}${this.options.contextSeparator||"_"}${n.context}`;T.push(O),m&&(n.ordinal&&M.indexOf(R)===0&&T.push(O+M.replace(R,this.options.pluralSeparator)),T.push(O+M),y&&T.push(O+_))}}let j;for(;j=T.pop();)this.isValidLookup(r)||(i=j,r=this.getResource(S,w,j,n))}))})}),{res:r,usedKey:s,exactUsedKey:i,usedLng:o,usedNS:l}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,r,s={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,n,r,s):this.resourceStore.getResource(e,n,r,s)}getUsedParamsDetails(e={}){const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!$e(e.replace);let s=r?e.replace:e;if(r&&typeof e.count<"u"&&(s.count=e.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!r){s={...s};for(const i of n)delete s[i]}return s}static hasDefaultValue(e){const n="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&n===r.substring(0,n.length)&&e[r]!==void 0)return!0;return!1}}class Q2{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=ks.create("languageUtils")}getScriptPartFromCode(e){if(e=Lu(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=Lu(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if($e(e)&&e.indexOf("-")>-1){let n;try{n=Intl.getCanonicalLocales(e)[0]}catch{}return n&&this.options.lowerCaseLng&&(n=n.toLowerCase()),n||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(r=>{if(n)return;const s=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(s))&&(n=s)}),!n&&this.options.supportedLngs&&e.forEach(r=>{if(n)return;const s=this.getScriptPartFromCode(r);if(this.isSupportedCode(s))return n=s;const i=this.getLanguagePartFromCode(r);if(this.isSupportedCode(i))return n=i;n=this.options.supportedLngs.find(o=>{if(o===i)return o;if(!(o.indexOf("-")<0&&i.indexOf("-")<0)&&(o.indexOf("-")>0&&i.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===i||o.indexOf(i)===0&&i.length>1))return o})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),$e(e)&&(e=[e]),Array.isArray(e))return e;if(!n)return e.default||[];let r=e[n];return r||(r=e[this.getScriptPartFromCode(n)]),r||(r=e[this.formatLanguageCode(n)]),r||(r=e[this.getLanguagePartFromCode(n)]),r||(r=e.default),r||[]}toResolveHierarchy(e,n){const r=this.getFallbackCodes((n===!1?[]:n)||this.options.fallbackLng||[],e),s=[],i=o=>{o&&(this.isSupportedCode(o)?s.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return $e(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(e))):$e(e)&&i(this.formatLanguageCode(e)),r.forEach(o=>{s.indexOf(o)<0&&i(this.formatLanguageCode(o))}),s}}const W2={zero:0,one:1,two:2,few:3,many:4,other:5},Y2={select:t=>t===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class Y6{constructor(e,n={}){this.languageUtils=e,this.options=n,this.logger=ks.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,n){this.rules[e]=n}clearCache(){this.pluralRulesCache={}}getRule(e,n={}){const r=Lu(e==="dev"?"en":e),s=n.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:r,type:s});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let o;try{o=new Intl.PluralRules(r,{type:s})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Y2;if(!e.match(/-|_/))return Y2;const d=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(d,n)}return this.pluralRulesCache[i]=o,o}needsPlural(e,n={}){let r=this.getRule(e,n);return r||(r=this.getRule("dev",n)),r?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,n,r={}){return this.getSuffixes(e,r).map(s=>`${n}${s}`)}getSuffixes(e,n={}){let r=this.getRule(e,n);return r||(r=this.getRule("dev",n)),r?r.resolvedOptions().pluralCategories.sort((s,i)=>W2[s]-W2[i]).map(s=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${s}`):[]}getSuffix(e,n,r={}){const s=this.getRule(e,r);return s?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${s.select(n)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",n,r))}}const G2=(t,e,n,r=".",s=!0)=>{let i=F6(t,e,n);return!i&&s&&$e(n)&&(i=ux(t,n,r),i===void 0&&(i=ux(e,n,r))),i},U0=t=>t.replace(/\$/g,"$$$$");class G6{constructor(e={}){this.logger=ks.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(n=>n),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:n,escapeValue:r,useRawValueToEscape:s,prefix:i,prefixEscaped:o,suffix:l,suffixEscaped:d,formatSeparator:f,unescapeSuffix:p,unescapePrefix:g,nestingPrefix:m,nestingPrefixEscaped:y,nestingSuffix:b,nestingSuffixEscaped:v,nestingOptionsSeparator:w,maxReplaces:S,alwaysFormat:T}=e.interpolation;this.escape=n!==void 0?n:$6,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=i?pl(i):o||"{{",this.suffix=l?pl(l):d||"}}",this.formatSeparator=f||",",this.unescapePrefix=p?"":g||"-",this.unescapeSuffix=this.unescapePrefix?"":p||"",this.nestingPrefix=m?pl(m):y||pl("$t("),this.nestingSuffix=b?pl(b):v||pl(")"),this.nestingOptionsSeparator=w||",",this.maxReplaces=S||1e3,this.alwaysFormat=T!==void 0?T:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,r)=>n?.source===r?(n.lastIndex=0,n):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,n,r,s){let i,o,l;const d=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},f=y=>{if(y.indexOf(this.formatSeparator)<0){const S=G2(n,d,y,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(S,void 0,r,{...s,...n,interpolationkey:y}):S}const b=y.split(this.formatSeparator),v=b.shift().trim(),w=b.join(this.formatSeparator).trim();return this.format(G2(n,d,v,this.options.keySeparator,this.options.ignoreJSONStructure),w,r,{...s,...n,interpolationkey:v})};this.resetRegExp();const p=s?.missingInterpolationHandler||this.options.missingInterpolationHandler,g=s?.interpolation?.skipOnVariables!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:y=>U0(y)},{regex:this.regexp,safeValue:y=>this.escapeValue?U0(this.escape(y)):U0(y)}].forEach(y=>{for(l=0;i=y.regex.exec(e);){const b=i[1].trim();if(o=f(b),o===void 0)if(typeof p=="function"){const w=p(e,i,s);o=$e(w)?w:""}else if(s&&Object.prototype.hasOwnProperty.call(s,b))o="";else if(g){o=i[0];continue}else this.logger.warn(`missed to pass in variable ${b} for interpolating ${e}`),o="";else!$e(o)&&!this.useRawValueToEscape&&(o=U2(o));const v=y.safeValue(o);if(e=e.replace(i[0],v),g?(y.regex.lastIndex+=o.length,y.regex.lastIndex-=i[0].length):y.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),e}nest(e,n,r={}){let s,i,o;const l=(d,f)=>{const p=this.nestingOptionsSeparator;if(d.indexOf(p)<0)return d;const g=d.split(new RegExp(`${p}[ ]*{`));let m=`{${g[1]}`;d=g[0],m=this.interpolate(m,o);const y=m.match(/'/g),b=m.match(/"/g);((y?.length??0)%2===0&&!b||b.length%2!==0)&&(m=m.replace(/'/g,'"'));try{o=JSON.parse(m),f&&(o={...f,...o})}catch(v){return this.logger.warn(`failed parsing options string in nesting for key ${d}`,v),`${d}${p}${m}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,d};for(;s=this.nestingRegexp.exec(e);){let d=[];o={...r},o=o.replace&&!$e(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const f=/{.*}/.test(s[1])?s[1].lastIndexOf("}")+1:s[1].indexOf(this.formatSeparator);if(f!==-1&&(d=s[1].slice(f).split(this.formatSeparator).map(p=>p.trim()).filter(Boolean),s[1]=s[1].slice(0,f)),i=n(l.call(this,s[1].trim(),o),o),i&&s[0]===e&&!$e(i))return i;$e(i)||(i=U2(i)),i||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${e}`),i=""),d.length&&(i=d.reduce((p,g)=>this.format(p,g,r.lng,{...r,interpolationkey:s[1].trim()}),i.trim())),e=e.replace(s[0],i),this.regexp.lastIndex=0}return e}}const X6=t=>{let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const r=t.split("(");e=r[0].toLowerCase().trim();const s=r[1].substring(0,r[1].length-1);e==="currency"&&s.indexOf(":")<0?n.currency||(n.currency=s.trim()):e==="relativetime"&&s.indexOf(":")<0?n.range||(n.range=s.trim()):s.split(";").forEach(o=>{if(o){const[l,...d]=o.split(":"),f=d.join(":").trim().replace(/^'+|'+$/g,""),p=l.trim();n[p]||(n[p]=f),f==="false"&&(n[p]=!1),f==="true"&&(n[p]=!0),isNaN(f)||(n[p]=parseInt(f,10))}})}return{formatName:e,formatOptions:n}},X2=t=>{const e={};return(n,r,s)=>{let i=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(i={...i,[s.interpolationkey]:void 0});const o=r+JSON.stringify(i);let l=e[o];return l||(l=t(Lu(r),s),e[o]=l),l(n)}},J6=t=>(e,n,r)=>t(Lu(n),r)(e);class Z6{constructor(e={}){this.logger=ks.create("formatter"),this.options=e,this.init(e)}init(e,n={interpolation:{}}){this.formatSeparator=n.interpolation.formatSeparator||",";const r=n.cacheInBuiltFormats?X2:J6;this.formats={number:r((s,i)=>{const o=new Intl.NumberFormat(s,{...i});return l=>o.format(l)}),currency:r((s,i)=>{const o=new Intl.NumberFormat(s,{...i,style:"currency"});return l=>o.format(l)}),datetime:r((s,i)=>{const o=new Intl.DateTimeFormat(s,{...i});return l=>o.format(l)}),relativetime:r((s,i)=>{const o=new Intl.RelativeTimeFormat(s,{...i});return l=>o.format(l,i.range||"day")}),list:r((s,i)=>{const o=new Intl.ListFormat(s,{...i});return l=>o.format(l)})}}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=X2(n)}format(e,n,r,s={}){const i=n.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(l=>l.indexOf(")")>-1)){const l=i.findIndex(d=>d.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,l)].join(this.formatSeparator)}return i.reduce((l,d)=>{const{formatName:f,formatOptions:p}=X6(d);if(this.formats[f]){let g=l;try{const m=s?.formatParams?.[s.interpolationkey]||{},y=m.locale||m.lng||s.locale||s.lng||r;g=this.formats[f](l,y,{...p,...s,...m})}catch(m){this.logger.warn(m)}return g}else this.logger.warn(`there was no format function for ${f}`);return l},e)}}const eL=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class tL extends Up{constructor(e,n,r,s={}){super(),this.backend=e,this.store=n,this.services=r,this.languageUtils=r.languageUtils,this.options=s,this.logger=ks.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(r,s.backend,s)}queueLoad(e,n,r,s){const i={},o={},l={},d={};return e.forEach(f=>{let p=!0;n.forEach(g=>{const m=`${f}|${g}`;!r.reload&&this.store.hasResourceBundle(f,g)?this.state[m]=2:this.state[m]<0||(this.state[m]===1?o[m]===void 0&&(o[m]=!0):(this.state[m]=1,p=!1,o[m]===void 0&&(o[m]=!0),i[m]===void 0&&(i[m]=!0),d[g]===void 0&&(d[g]=!0)))}),p||(l[f]=!0)}),(Object.keys(i).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(i),pending:Object.keys(o),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(d)}}loaded(e,n,r){const s=e.split("|"),i=s[0],o=s[1];n&&this.emit("failedLoading",i,o,n),!n&&r&&this.store.addResourceBundle(i,o,r,void 0,void 0,{skipCopy:!0}),this.state[e]=n?-1:2,n&&r&&(this.state[e]=0);const l={};this.queue.forEach(d=>{B6(d.loaded,[i],o),eL(d,e),n&&d.errors.push(n),d.pendingCount===0&&!d.done&&(Object.keys(d.loaded).forEach(f=>{l[f]||(l[f]={});const p=d.loaded[f];p.length&&p.forEach(g=>{l[f][g]===void 0&&(l[f][g]=!0)})}),d.done=!0,d.errors.length?d.callback(d.errors):d.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(d=>!d.done)}read(e,n,r,s=0,i=this.retryTimeout,o){if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:r,tried:s,wait:i,callback:o});return}this.readingCalls++;const l=(f,p)=>{if(this.readingCalls--,this.waitingReads.length>0){const g=this.waitingReads.shift();this.read(g.lng,g.ns,g.fcName,g.tried,g.wait,g.callback)}if(f&&p&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,r,s+1,i*2,o)},i);return}o(f,p)},d=this.backend[r].bind(this.backend);if(d.length===2){try{const f=d(e,n);f&&typeof f.then=="function"?f.then(p=>l(null,p)).catch(l):l(null,f)}catch(f){l(f)}return}return d(e,n,l)}prepareLoading(e,n,r={},s){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();$e(e)&&(e=this.languageUtils.toResolveHierarchy(e)),$e(n)&&(n=[n]);const i=this.queueLoad(e,n,r,s);if(!i.toLoad.length)return i.pending.length||s(),null;i.toLoad.forEach(o=>{this.loadOne(o)})}load(e,n,r){this.prepareLoading(e,n,{},r)}reload(e,n,r){this.prepareLoading(e,n,{reload:!0},r)}loadOne(e,n=""){const r=e.split("|"),s=r[0],i=r[1];this.read(s,i,"read",void 0,void 0,(o,l)=>{o&&this.logger.warn(`${n}loading namespace ${i} for language ${s} failed`,o),!o&&l&&this.logger.log(`${n}loaded namespace ${i} for language ${s}`,l),this.loaded(e,o,l)})}saveMissing(e,n,r,s,i,o={},l=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(n)){this.logger.warn(`did not save key "${r}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend?.create){const d={...o,isUpdate:i},f=this.backend.create.bind(this.backend);if(f.length<6)try{let p;f.length===5?p=f(e,n,r,s,d):p=f(e,n,r,s),p&&typeof p.then=="function"?p.then(g=>l(null,g)).catch(l):l(null,p)}catch(p){l(p)}else f(e,n,r,s,l,d)}!e||!e[0]||this.store.addResource(e[0],n,r,s)}}}const J2=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),$e(t[1])&&(e.defaultValue=t[1]),$e(t[2])&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(r=>{e[r]=n[r]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),Z2=t=>($e(t.ns)&&(t.ns=[t.ns]),$e(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),$e(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs?.indexOf?.("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),typeof t.initImmediate=="boolean"&&(t.initAsync=t.initImmediate),t),$f=()=>{},nL=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(n=>{typeof t[n]=="function"&&(t[n]=t[n].bind(t))})};class xu extends Up{constructor(e={},n){if(super(),this.options=Z2(e),this.services={},this.logger=ks,this.modules={external:[]},nL(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(e={},n){this.isInitializing=!0,typeof e=="function"&&(n=e,e={}),e.defaultNS==null&&e.ns&&($e(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const r=J2();this.options={...r,...this.options,...Z2(e)},this.options.interpolation={...r.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const s=f=>f?typeof f=="function"?new f:f:null;if(!this.options.isClone){this.modules.logger?ks.init(s(this.modules.logger),this.options):ks.init(null,this.options);let f;this.modules.formatter?f=this.modules.formatter:f=Z6;const p=new Q2(this.options);this.store=new V2(this.options.resources,this.options);const g=this.services;g.logger=ks,g.resourceStore=this.store,g.languageUtils=p,g.pluralResolver=new Y6(p,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),f&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(g.formatter=s(f),g.formatter.init&&g.formatter.init(g,this.options),this.options.interpolation.format=g.formatter.format.bind(g.formatter)),g.interpolator=new G6(this.options),g.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},g.backendConnector=new tL(s(this.modules.backend),g.resourceStore,g,this.options),g.backendConnector.on("*",(y,...b)=>{this.emit(y,...b)}),this.modules.languageDetector&&(g.languageDetector=s(this.modules.languageDetector),g.languageDetector.init&&g.languageDetector.init(g,this.options.detection,this.options)),this.modules.i18nFormat&&(g.i18nFormat=s(this.modules.i18nFormat),g.i18nFormat.init&&g.i18nFormat.init(this)),this.translator=new Oh(this.services,this.options),this.translator.on("*",(y,...b)=>{this.emit(y,...b)}),this.modules.external.forEach(y=>{y.init&&y.init(this)})}if(this.format=this.options.interpolation.format,n||(n=$f),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const f=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);f.length>0&&f[0]!=="dev"&&(this.options.lng=f[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(f=>{this[f]=(...p)=>this.store[f](...p)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(f=>{this[f]=(...p)=>(this.store[f](...p),this)});const l=ru(),d=()=>{const f=(p,g)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(g),n(p,g)};if(this.languages&&!this.isInitialized)return f(null,this.t.bind(this));this.changeLanguage(this.options.lng,f)};return this.options.resources||!this.options.initAsync?d():setTimeout(d,0),l}loadResources(e,n=$f){let r=n;const s=$e(e)?e:this.language;if(typeof e=="function"&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if(s?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const i=[],o=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(f=>{f!=="cimode"&&i.indexOf(f)<0&&i.push(f)})};s?o(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(d=>o(d)),this.options.preload?.forEach?.(l=>o(l)),this.services.backendConnector.load(i,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(l)})}else r(null)}reloadResources(e,n,r){const s=ru();return typeof e=="function"&&(r=e,e=void 0),typeof n=="function"&&(r=n,n=void 0),e||(e=this.languages),n||(n=this.options.ns),r||(r=$f),this.services.backendConnector.reload(e,n,i=>{s.resolve(),r(i)}),s}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&aE.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let n=0;n<this.languages.length;n++){const r=this.languages[n];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,n){this.isLanguageChangingTo=e;const r=ru();this.emit("languageChanging",e);const s=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},i=(l,d)=>{d?this.isLanguageChangingTo===e&&(s(d),this.translator.changeLanguage(d),this.isLanguageChangingTo=void 0,this.emit("languageChanged",d),this.logger.log("languageChanged",d)):this.isLanguageChangingTo=void 0,r.resolve((...f)=>this.t(...f)),n&&n(l,(...f)=>this.t(...f))},o=l=>{!e&&!l&&this.services.languageDetector&&(l=[]);const d=$e(l)?l:l&&l[0],f=this.store.hasLanguageSomeTranslations(d)?d:this.services.languageUtils.getBestMatchFromCodes($e(l)?[l]:l);f&&(this.language||s(f),this.translator.language||this.translator.changeLanguage(f),this.services.languageDetector?.cacheUserLanguage?.(f)),this.loadResources(f,p=>{i(p,f)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),r}getFixedT(e,n,r){const s=(i,o,...l)=>{let d;typeof o!="object"?d=this.options.overloadTranslationOptionHandler([i,o].concat(l)):d={...o},d.lng=d.lng||s.lng,d.lngs=d.lngs||s.lngs,d.ns=d.ns||s.ns,d.keyPrefix!==""&&(d.keyPrefix=d.keyPrefix||r||s.keyPrefix);const f=this.options.keySeparator||".";let p;return d.keyPrefix&&Array.isArray(i)?p=i.map(g=>(typeof g=="function"&&(g=dx(g,{...this.options,...o})),`${d.keyPrefix}${f}${g}`)):(typeof i=="function"&&(i=dx(i,{...this.options,...o})),p=d.keyPrefix?`${d.keyPrefix}${f}${i}`:i),this.t(p,d)};return $e(e)?s.lng=e:s.lngs=e,s.ns=n,s.keyPrefix=r,s}t(...e){return this.translator?.translate(...e)}exists(...e){return this.translator?.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,n={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=n.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const o=(l,d)=>{const f=this.services.backendConnector.state[`${l}|${d}`];return f===-1||f===0||f===2};if(n.precheck){const l=n.precheck(this,o);if(l!==void 0)return l}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(r,e)&&(!s||o(i,e)))}loadNamespaces(e,n){const r=ru();return this.options.ns?($e(e)&&(e=[e]),e.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{r.resolve(),n&&n(s)}),r):(n&&n(),Promise.resolve())}loadLanguages(e,n){const r=ru();$e(e)&&(e=[e]);const s=this.options.preload||[],i=e.filter(o=>s.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return i.length?(this.options.preload=s.concat(i),this.loadResources(o=>{r.resolve(),n&&n(o)}),r):(n&&n(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";try{const s=new Intl.Locale(e);if(s&&s.getTextInfo){const i=s.getTextInfo();if(i&&i.direction)return i.direction}}catch{}const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services?.languageUtils||new Q2(J2());return e.toLowerCase().indexOf("-latn")>1?"ltr":n.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},n){const r=new xu(e,n);return r.createInstance=xu.createInstance,r}cloneInstance(e={},n=$f){const r=e.forkResourceStore;r&&delete e.forkResourceStore;const s={...this.options,...e,isClone:!0},i=new xu(s);if((e.debug!==void 0||e.prefix!==void 0)&&(i.logger=i.logger.clone(e)),["store","services","language"].forEach(l=>{i[l]=this[l]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},r){const l=Object.keys(this.store.data).reduce((d,f)=>(d[f]={...this.store.data[f]},d[f]=Object.keys(d[f]).reduce((p,g)=>(p[g]={...d[f][g]},p),d[f]),d),{});i.store=new V2(l,s),i.services.resourceStore=i.store}return i.translator=new Oh(i.services,s),i.translator.on("*",(l,...d)=>{i.emit(l,...d)}),i.init(s,n),i.translator.options=s,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Hn=xu.createInstance();Hn.createInstance;Hn.dir;Hn.init;Hn.loadResources;Hn.reloadResources;Hn.use;Hn.changeLanguage;Hn.getFixedT;Hn.t;Hn.exists;Hn.setDefaultNamespace;Hn.hasLoadedNamespace;Hn.loadNamespaces;Hn.loadLanguages;const rL=(t,e,n,r)=>{const s=[n,{code:e,...r||{}}];if(t?.services?.logger?.forward)return t.services.logger.forward(s,"warn","react-i18next::",!0);no(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),t?.services?.logger?.warn?t.services.logger.warn(...s):console?.warn&&console.warn(...s)},eC={},lE=(t,e,n,r)=>{no(n)&&eC[n]||(no(n)&&(eC[n]=new Date),rL(t,e,n,r))},cE=(t,e)=>()=>{if(t.isInitialized)e();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),e()};t.on("initialized",n)}},fx=(t,e,n)=>{t.loadNamespaces(e,cE(t,n))},tC=(t,e,n,r)=>{if(no(n)&&(n=[n]),t.options.preload&&t.options.preload.indexOf(e)>-1)return fx(t,n,r);n.forEach(s=>{t.options.ns.indexOf(s)<0&&t.options.ns.push(s)}),t.loadLanguages(e,cE(t,r))},sL=(t,e,n={})=>!e.languages||!e.languages.length?(lE(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(t,{lng:n.lng,precheck:(r,s)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!s(r.isLanguageChangingTo,t))return!1}}),no=t=>typeof t=="string",iL=t=>typeof t=="object"&&t!==null,aL=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,oL={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},lL=t=>oL[t],cL=t=>t.replace(aL,lL);let hx={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:cL};const uL=(t={})=>{hx={...hx,...t}},dL=()=>hx;let uE;const fL=t=>{uE=t},hL=()=>uE,pL={type:"3rdParty",init(t){uL(t.options.react),fL(t)}},gL=C.createContext();class mL{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var Rb=mj();const yL=(t,e)=>no(e)?e:iL(e)&&no(e.defaultValue)?e.defaultValue:Array.isArray(t)?t[t.length-1]:t,xL={t:yL,ready:!1},bL=()=>()=>{},ke=(t,e={})=>{const{i18n:n}=e,{i18n:r,defaultNS:s}=C.useContext(gL)||{},i=n||r||hL();i&&!i.reportNamespaces&&(i.reportNamespaces=new mL),i||lE(i,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const o=C.useMemo(()=>({...dL(),...i?.options?.react,...e}),[i,e]),{useSuspense:l,keyPrefix:d}=o,f=t||s||i?.options?.defaultNS,p=no(f)?[f]:f||["translation"],g=C.useMemo(()=>p,p);i?.reportNamespaces?.addUsedNamespaces?.(g);const m=C.useRef(0),y=C.useCallback(A=>{if(!i)return bL;const{bindI18n:F,bindI18nStore:H}=o,P=()=>{m.current+=1,A()};return F&&i.on(F,P),H&&i.store.on(H,P),()=>{F&&F.split(" ").forEach(B=>i.off(B,P)),H&&H.split(" ").forEach(B=>i.store.off(B,P))}},[i,o]),b=C.useRef(),v=C.useCallback(()=>{if(!i)return xL;const A=!!(i.isInitialized||i.initializedStoreOnce)&&g.every(K=>sL(K,i,o)),F=e.lng||i.language,H=m.current,P=b.current;if(P&&P.ready===A&&P.lng===F&&P.keyPrefix===d&&P.revision===H)return P;const E={t:i.getFixedT(F,o.nsMode==="fallback"?g:g[0],d),ready:A,lng:F,keyPrefix:d,revision:H};return b.current=E,E},[i,g,d,o,e.lng]),[w,S]=C.useState(0),{t:T,ready:j}=Rb.useSyncExternalStore(y,v,v);C.useEffect(()=>{if(i&&!j&&!l){const A=()=>S(F=>F+1);e.lng?tC(i,e.lng,g,A):fx(i,g,A)}},[i,e.lng,g,j,l,w]);const M=i||{},_=C.useRef(null),R=C.useRef(),O=A=>{const F=Object.getOwnPropertyDescriptors(A);F.__original&&delete F.__original;const H=Object.create(Object.getPrototypeOf(A),F);if(!Object.prototype.hasOwnProperty.call(H,"__original"))try{Object.defineProperty(H,"__original",{value:A,writable:!1,enumerable:!1,configurable:!1})}catch{}return H},L=C.useMemo(()=>{const A=M,F=A?.language;let H=A;A&&(_.current&&_.current.__original===A?R.current!==F?(H=O(A),_.current=H,R.current=F):H=_.current:(H=O(A),_.current=H,R.current=F));const P=[T,H,j];return P.t=T,P.i18n=H,P.ready=j,P},[T,M,j,M.resolvedLanguage,M.language,M.languages]);if(i&&l&&!j)throw new Promise(A=>{const F=()=>A();e.lng?tC(i,e.lng,g,F):fx(i,g,F)});return L},vL={primary:"bg-indigo-600 text-white hover:bg-indigo-700 focus:ring-indigo-500",secondary:"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-100 hover:bg-gray-200 dark:hover:bg-gray-600 focus:ring-gray-500",ghost:"bg-transparent text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-gray-100 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"},wL={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base",icon:"p-2"},it=C.forwardRef(({variant:t="primary",size:e="md",className:n="",children:r,disabled:s,...i},o)=>u.jsx("button",{ref:o,disabled:s,className:`
          inline-flex items-center justify-center font-medium rounded-lg
          focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-gray-900
          transition-colors duration-200
          disabled:opacity-50 disabled:cursor-not-allowed
          ${vL[t]}
          ${wL[e]}
          ${n}
        `,...i,children:r}));it.displayName="Button";const br=C.forwardRef(({className:t="",...e},n)=>u.jsx("input",{ref:n,className:`w-full px-3 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ${t}`,...e}));br.displayName="Input";const dE=C.createContext(null);function SL({children:t}){const[e,n]=C.useState([]),r=C.useCallback((o,l="info")=>{const d=Date.now();n(f=>[...f,{id:d,message:o,type:l}]),setTimeout(()=>{n(f=>f.filter(p=>p.id!==d))},3e3)},[]),s=C.useCallback(o=>{n(l=>l.filter(d=>d.id!==o))},[]),i=o=>{switch(o){case"success":return"bg-green-600 text-white";case"error":return"bg-red-600 text-white";default:return"bg-gray-800 text-white dark:bg-gray-200 dark:text-gray-800"}};return u.jsxs(dE.Provider,{value:{showToast:r},children:[t,u.jsx("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2",children:e.map(o=>u.jsxs("div",{className:`px-4 py-3 rounded-lg shadow-lg flex items-center gap-3 animate-slide-in ${i(o.type)}`,children:[u.jsx("span",{children:o.message}),u.jsx("button",{type:"button",onClick:()=>s(o.id),className:"hover:opacity-70 transition-opacity",children:u.jsx(nt,{className:"w-4 h-4"})})]},o.id))}),u.jsx("style",{children:`
        @keyframes slide-in {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        .animate-slide-in {
          animation: slide-in 0.2s ease-out;
        }
      `})]})}function mt(){const t=C.useContext(dE);if(!t)throw new Error("useToast must be used within a ToastProvider");return t}function kL(){const{t}=ke("settings"),{showToast:e}=mt(),[n,r]=C.useState(""),[s,i]=C.useState(""),[o,l]=C.useState(!1),[d,f]=C.useState("idle"),[p,g]=C.useState("");C.useEffect(()=>{const v=sd();v&&(r(v),i(v))},[]);const m=n!==s,y=async()=>{if(!n.trim()){g(t("sections.apiUrl.errors.emptyUrl"));return}if(!Nj(n)){g(t("sections.apiUrl.errors.invalidUrl"));return}l(!0),f("testing"),g(""),await Tj(n)?f("success"):(f("error"),g(t("sections.apiUrl.errors.connectionFailed"))),l(!1)},b=()=>{if(d!=="success"){g(t("sections.apiUrl.errors.testFirst"));return}Cj(n),i(n),e(t("sections.apiUrl.saved"),"success")};return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Zj,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t("sections.apiUrl.title")})]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("sections.apiUrl.settingsDescription")}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{htmlFor:"settings-api-url",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:t("sections.apiUrl.label")}),u.jsx(br,{id:"settings-api-url",type:"url",placeholder:"https://your-server.com:3000",value:n,onChange:v=>{r(v.target.value),f("idle"),g("")},disabled:o})]}),p&&u.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:p}),d==="success"&&u.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[u.jsx(Ah,{className:"w-4 h-4"}),u.jsx("span",{children:t("sections.apiUrl.connectionSuccess")})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(it,{variant:"secondary",size:"sm",onClick:y,disabled:o||!n.trim(),children:o?u.jsxs(u.Fragment,{children:[u.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),t("sections.apiUrl.testing")]}):d==="error"?u.jsxs(u.Fragment,{children:[u.jsx(sE,{className:"w-4 h-4 mr-2"}),t("sections.apiUrl.retry")]}):u.jsxs(u.Fragment,{children:[u.jsx(Ah,{className:"w-4 h-4 mr-2"}),t("sections.apiUrl.testConnection")]})}),m&&d==="success"&&u.jsx(it,{variant:"primary",size:"sm",onClick:b,children:t("sections.apiUrl.save")})]})]})]})}function CL({onComplete:t}){const{t:e}=ke("settings"),[n,r]=C.useState(""),[s,i]=C.useState(!1),[o,l]=C.useState("idle"),[d,f]=C.useState(""),p=C.useMemo(()=>{if(!n)return!1;const{userToken:y}=Dp(n);return y!==null},[n]),g=async()=>{if(!n.trim()){f(e("sections.apiUrl.errors.emptyUrl"));return}if(!Nj(n)){f(e("sections.apiUrl.errors.invalidUrl"));return}i(!0),l("testing"),f("");const y=await Tj(n);y.success?l("success"):(l("error"),f(y.error||e("sections.apiUrl.errors.connectionFailed"))),i(!1)},m=()=>{if(o!=="success"){f(e("sections.apiUrl.errors.testFirst"));return}Cj(n),t()};return u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 p-4",children:u.jsxs("div",{className:"w-full max-w-md bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 space-y-6",children:[u.jsxs("div",{className:"text-center space-y-2",children:[u.jsx("div",{className:"mx-auto w-16 h-16 bg-indigo-100 dark:bg-indigo-900 rounded-full flex items-center justify-center",children:u.jsx(Zj,{className:"w-8 h-8 text-indigo-600 dark:text-indigo-400"})}),u.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e("sections.apiUrl.setup.title")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e("sections.apiUrl.setup.description")})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{htmlFor:"api-url",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:e("sections.apiUrl.label")}),u.jsx(br,{id:"api-url",type:"url",placeholder:"http://192.168.x.x:3000/api/auth/user/usr_TOKEN",value:n,onChange:y=>{r(y.target.value),l("idle"),f("")},disabled:s}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e("sections.apiUrl.hint")}),p&&u.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400",children:[u.jsx(lD,{className:"w-4 h-4"}),u.jsx("span",{children:e("sections.apiUrl.authTokenDetected")})]})]}),d&&u.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:d}),o==="success"&&u.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[u.jsx(Ah,{className:"w-4 h-4"}),u.jsx("span",{children:e("sections.apiUrl.connectionSuccess")})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsx(it,{variant:"secondary",onClick:g,disabled:s||!n.trim(),className:"w-full",children:s?u.jsxs(u.Fragment,{children:[u.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),e("sections.apiUrl.testing")]}):o==="error"?u.jsxs(u.Fragment,{children:[u.jsx(sE,{className:"w-4 h-4 mr-2"}),e("sections.apiUrl.retry")]}):u.jsxs(u.Fragment,{children:[u.jsx(Ah,{className:"w-4 h-4 mr-2"}),e("sections.apiUrl.testConnection")]})}),u.jsx(it,{variant:"primary",onClick:m,disabled:o!=="success",className:"w-full",children:e("sections.apiUrl.save")})]})]})]})})}const NL="modulepreload",TL=function(t){return"/"+t},nC={},Cn=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){let d=function(f){return Promise.all(f.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");s=d(n.map(f=>{if(f=TL(f),f in nC)return;nC[f]=!0;const p=f.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":NL,p||(m.as="script"),m.crossOrigin="",m.href=f,l&&m.setAttribute("nonce",l),document.head.appendChild(m),p)return new Promise((y,b)=>{m.addEventListener("load",y),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};var ho=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},jL={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},EL=class{#t=jL;#e=!1;setTimeoutProvider(t){this.#t=t}setTimeout(t,e){return this.#t.setTimeout(t,e)}clearTimeout(t){this.#t.clearTimeout(t)}setInterval(t,e){return this.#t.setInterval(t,e)}clearInterval(t){this.#t.clearInterval(t)}},Fa=new EL;function ML(t){setTimeout(t,0)}var ro=typeof window>"u"||"Deno"in globalThis;function Mn(){}function AL(t,e){return typeof t=="function"?t(e):t}function px(t){return typeof t=="number"&&t>=0&&t!==1/0}function fE(t,e){return Math.max(t+(e||0)-Date.now(),0)}function ca(t,e){return typeof t=="function"?t(e):t}function Kr(t,e){return typeof t=="function"?t(e):t}function rC(t,e){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=t;if(o){if(r){if(e.queryHash!==_b(o,e.options))return!1}else if(!zu(e.queryKey,o))return!1}if(n!=="all"){const d=e.isActive();if(n==="active"&&!d||n==="inactive"&&d)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||s&&s!==e.state.fetchStatus||i&&!i(e))}function sC(t,e){const{exact:n,status:r,predicate:s,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(so(e.options.mutationKey)!==so(i))return!1}else if(!zu(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||s&&!s(e))}function _b(t,e){return(e?.queryKeyHashFn||so)(t)}function so(t){return JSON.stringify(t,(e,n)=>gx(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function zu(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>zu(t[n],e[n])):!1}var RL=Object.prototype.hasOwnProperty;function Ob(t,e){if(t===e)return t;const n=iC(t)&&iC(e);if(!n&&!(gx(t)&&gx(e)))return e;const s=(n?t:Object.keys(t)).length,i=n?e:Object.keys(e),o=i.length,l=n?new Array(o):{};let d=0;for(let f=0;f<o;f++){const p=n?f:i[f],g=t[p],m=e[p];if(g===m){l[p]=g,(n?f<s:RL.call(t,p))&&d++;continue}if(g===null||m===null||typeof g!="object"||typeof m!="object"){l[p]=m;continue}const y=Ob(g,m);l[p]=y,y===g&&d++}return s===o&&d===s?t:l}function Pu(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function iC(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function gx(t){if(!aC(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!aC(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function aC(t){return Object.prototype.toString.call(t)==="[object Object]"}function _L(t){return new Promise(e=>{Fa.setTimeout(e,t)})}function mx(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?Ob(t,e):e}function OL(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function IL(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var Ib=Symbol();function hE(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Ib?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function pE(t,e){return typeof t=="function"?t(...e):!!t}var DL=class extends ho{#t;#e;#n;constructor(){super(),this.#n=t=>{if(!ro&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#e||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(t){this.#n=t,this.#e?.(),this.#e=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#t!==t&&(this.#t=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#t=="boolean"?this.#t:globalThis.document?.visibilityState!=="hidden"}},Db=new DL;function yx(){let t,e;const n=new Promise((s,i)=>{t=s,e=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),t(s)},n.reject=s=>{r({status:"rejected",reason:s}),e(s)},n}var LL=ML;function zL(){let t=[],e=0,n=l=>{l()},r=l=>{l()},s=LL;const i=l=>{e?t.push(l):s(()=>{n(l)})},o=()=>{const l=t;t=[],l.length&&s(()=>{r(()=>{l.forEach(d=>{n(d)})})})};return{batch:l=>{let d;e++;try{d=l()}finally{e--,e||o()}return d},batchCalls:l=>(...d)=>{i(()=>{l(...d)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var zt=zL(),PL=class extends ho{#t=!0;#e;#n;constructor(){super(),this.#n=t=>{if(!ro&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#e||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(t){this.#n=t,this.#e?.(),this.#e=t(this.setOnline.bind(this))}setOnline(t){this.#t!==t&&(this.#t=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#t}},Ih=new PL;function BL(t){return Math.min(1e3*2**t,3e4)}function gE(t){return(t??"online")==="online"?Ih.isOnline():!0}var xx=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function mE(t){let e=!1,n=0,r;const s=yx(),i=()=>s.status!=="pending",o=v=>{if(!i()){const w=new xx(v);m(w),t.onCancel?.(w)}},l=()=>{e=!0},d=()=>{e=!1},f=()=>Db.isFocused()&&(t.networkMode==="always"||Ih.isOnline())&&t.canRun(),p=()=>gE(t.networkMode)&&t.canRun(),g=v=>{i()||(r?.(),s.resolve(v))},m=v=>{i()||(r?.(),s.reject(v))},y=()=>new Promise(v=>{r=w=>{(i()||f())&&v(w)},t.onPause?.()}).then(()=>{r=void 0,i()||t.onContinue?.()}),b=()=>{if(i())return;let v;const w=n===0?t.initialPromise:void 0;try{v=w??t.fn()}catch(S){v=Promise.reject(S)}Promise.resolve(v).then(g).catch(S=>{if(i())return;const T=t.retry??(ro?0:3),j=t.retryDelay??BL,M=typeof j=="function"?j(n,S):j,_=T===!0||typeof T=="number"&&n<T||typeof T=="function"&&T(n,S);if(e||!_){m(S);return}n++,t.onFail?.(n,S),_L(M).then(()=>f()?void 0:y()).then(()=>{e?m(S):b()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r?.(),s),cancelRetry:l,continueRetry:d,canStart:p,start:()=>(p()?b():y().then(b),s)}}var yE=class{#t;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),px(this.gcTime)&&(this.#t=Fa.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(ro?1/0:300*1e3))}clearGcTimeout(){this.#t&&(Fa.clearTimeout(this.#t),this.#t=void 0)}},FL=class extends yE{#t;#e;#n;#s;#r;#i;#o;constructor(t){super(),this.#o=!1,this.#i=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#s=t.client,this.#n=this.#s.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#t=lC(this.options),this.state=t.state??this.#t,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(t){if(this.options={...this.#i,...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=lC(this.options);e.data!==void 0&&(this.setState(oC(e.data,e.dataUpdatedAt)),this.#t=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(t,e){const n=mx(this.state.data,t,this.options);return this.#a({data:n,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),n}setState(t,e){this.#a({type:"setState",state:t,setStateOptions:e})}cancel(t){const e=this.#r?.promise;return this.#r?.cancel(t),e?e.then(Mn).catch(Mn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#t)}isActive(){return this.observers.some(t=>Kr(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ib||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ca(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!fE(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#a({type:"invalidate"})}async fetch(t,e){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(t&&this.setOptions(t),!this.options.queryFn){const l=this.observers.find(d=>d.options.queryFn);l&&this.setOptions(l.options)}const n=new AbortController,r=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(this.#o=!0,n.signal)})},s=()=>{const l=hE(this.options,e),f=(()=>{const p={client:this.#s,queryKey:this.queryKey,meta:this.meta};return r(p),p})();return this.#o=!1,this.options.persister?this.options.persister(l,f,this):l(f)},o=(()=>{const l={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#s,state:this.state,fetchFn:s};return r(l),l})();this.options.behavior?.onFetch(o,this),this.#e=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#a({type:"fetch",meta:o.fetchOptions?.meta}),this.#r=mE({initialPromise:e?.initialPromise,fn:o.fetchFn,onCancel:l=>{l instanceof xx&&l.revert&&this.setState({...this.#e,fetchStatus:"idle"}),n.abort()},onFail:(l,d)=>{this.#a({type:"failed",failureCount:l,error:d})},onPause:()=>{this.#a({type:"pause"})},onContinue:()=>{this.#a({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0});try{const l=await this.#r.start();if(l===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(l),this.#n.config.onSuccess?.(l,this),this.#n.config.onSettled?.(l,this.state.error,this),l}catch(l){if(l instanceof xx){if(l.silent)return this.#r.promise;if(l.revert){if(this.state.data===void 0)throw l;return this.state.data}}throw this.#a({type:"error",error:l}),this.#n.config.onError?.(l,this),this.#n.config.onSettled?.(this.state.data,l,this),l}finally{this.scheduleGc()}}#a(t){const e=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...xE(n.data,this.options),fetchMeta:t.meta??null};case"success":const r={...n,...oC(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#e=t.manual?r:void 0,r;case"error":const s=t.error;return{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=e(this.state),zt.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:t})})}};function xE(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:gE(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function oC(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function lC(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Lb=class extends ho{constructor(t,e){super(),this.options=e,this.#t=t,this.#a=null,this.#o=yx(),this.bindMethods(),this.setOptions(e)}#t;#e=void 0;#n=void 0;#s=void 0;#r;#i;#o;#a;#h;#d;#f;#c;#u;#l;#g=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),cC(this.#e,this.options)?this.#p():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return bx(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return bx(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#v(),this.#w(),this.#e.removeObserver(this)}setOptions(t){const e=this.options,n=this.#e;if(this.options=this.#t.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Kr(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#S(),this.#e.setOptions(this.options),e._defaulted&&!Pu(this.options,e)&&this.#t.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const r=this.hasListeners();r&&uC(this.#e,n,this.options,e)&&this.#p(),this.updateResult(),r&&(this.#e!==n||Kr(this.options.enabled,this.#e)!==Kr(e.enabled,this.#e)||ca(this.options.staleTime,this.#e)!==ca(e.staleTime,this.#e))&&this.#m();const s=this.#y();r&&(this.#e!==n||Kr(this.options.enabled,this.#e)!==Kr(e.enabled,this.#e)||s!==this.#l)&&this.#x(s)}getOptimisticResult(t){const e=this.#t.getQueryCache().build(this.#t,t),n=this.createResult(e,t);return $L(this,n)&&(this.#s=n,this.#i=this.options,this.#r=this.#e.state),n}getCurrentResult(){return this.#s}trackResult(t,e){return new Proxy(t,{get:(n,r)=>(this.trackProp(r),e?.(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,r))})}trackProp(t){this.#g.add(t)}getCurrentQuery(){return this.#e}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#t.defaultQueryOptions(t),n=this.#t.getQueryCache().build(this.#t,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#p({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#s))}#p(t){this.#S();let e=this.#e.fetch(this.options,t);return t?.throwOnError||(e=e.catch(Mn)),e}#m(){this.#v();const t=ca(this.options.staleTime,this.#e);if(ro||this.#s.isStale||!px(t))return;const n=fE(this.#s.dataUpdatedAt,t)+1;this.#c=Fa.setTimeout(()=>{this.#s.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#x(t){this.#w(),this.#l=t,!(ro||Kr(this.options.enabled,this.#e)===!1||!px(this.#l)||this.#l===0)&&(this.#u=Fa.setInterval(()=>{(this.options.refetchIntervalInBackground||Db.isFocused())&&this.#p()},this.#l))}#b(){this.#m(),this.#x(this.#y())}#v(){this.#c&&(Fa.clearTimeout(this.#c),this.#c=void 0)}#w(){this.#u&&(Fa.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#e,r=this.options,s=this.#s,i=this.#r,o=this.#i,d=t!==n?t.state:this.#n,{state:f}=t;let p={...f},g=!1,m;if(e._optimisticResults){const L=this.hasListeners(),A=!L&&cC(t,e),F=L&&uC(t,n,e,r);(A||F)&&(p={...p,...xE(f.data,t.options)}),e._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:y,errorUpdatedAt:b,status:v}=p;m=p.data;let w=!1;if(e.placeholderData!==void 0&&m===void 0&&v==="pending"){let L;s?.isPlaceholderData&&e.placeholderData===o?.placeholderData?(L=s.data,w=!0):L=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,L!==void 0&&(v="success",m=mx(s?.data,L,e),g=!0)}if(e.select&&m!==void 0&&!w)if(s&&m===i?.data&&e.select===this.#h)m=this.#d;else try{this.#h=e.select,m=e.select(m),m=mx(s?.data,m,e),this.#d=m,this.#a=null}catch(L){this.#a=L}this.#a&&(y=this.#a,m=this.#d,b=Date.now(),v="error");const S=p.fetchStatus==="fetching",T=v==="pending",j=v==="error",M=T&&S,_=m!==void 0,O={status:v,fetchStatus:p.fetchStatus,isPending:T,isSuccess:v==="success",isError:j,isInitialLoading:M,isLoading:M,data:m,dataUpdatedAt:p.dataUpdatedAt,error:y,errorUpdatedAt:b,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:S,isRefetching:S&&!T,isLoadingError:j&&!_,isPaused:p.fetchStatus==="paused",isPlaceholderData:g,isRefetchError:j&&_,isStale:zb(t,e),refetch:this.refetch,promise:this.#o,isEnabled:Kr(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const L=H=>{O.status==="error"?H.reject(O.error):O.data!==void 0&&H.resolve(O.data)},A=()=>{const H=this.#o=O.promise=yx();L(H)},F=this.#o;switch(F.status){case"pending":t.queryHash===n.queryHash&&L(F);break;case"fulfilled":(O.status==="error"||O.data!==F.value)&&A();break;case"rejected":(O.status!=="error"||O.error!==F.reason)&&A();break}}return O}updateResult(){const t=this.#s,e=this.createResult(this.#e,this.options);if(this.#r=this.#e.state,this.#i=this.options,this.#r.data!==void 0&&(this.#f=this.#e),Pu(e,t))return;this.#s=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:r}=this.options,s=typeof r=="function"?r():r;if(s==="all"||!s&&!this.#g.size)return!0;const i=new Set(s??this.#g);return this.options.throwOnError&&i.add("error"),Object.keys(this.#s).some(o=>{const l=o;return this.#s[l]!==t[l]&&i.has(l)})};this.#k({listeners:n()})}#S(){const t=this.#t.getQueryCache().build(this.#t,this.options);if(t===this.#e)return;const e=this.#e;this.#e=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#k(t){zt.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#s)}),this.#t.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function UL(t,e){return Kr(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function cC(t,e){return UL(t,e)||t.state.data!==void 0&&bx(t,e,e.refetchOnMount)}function bx(t,e,n){if(Kr(e.enabled,t)!==!1&&ca(e.staleTime,t)!=="static"){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&zb(t,e)}return!1}function uC(t,e,n,r){return(t!==e||Kr(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&zb(t,n)}function zb(t,e){return Kr(e.enabled,t)!==!1&&t.isStaleByTime(ca(e.staleTime,t))}function $L(t,e){return!Pu(t.getCurrentResult(),e)}function dC(t){return{onFetch:(e,n)=>{const r=e.options,s=e.fetchOptions?.meta?.fetchMore?.direction,i=e.state.data?.pages||[],o=e.state.data?.pageParams||[];let l={pages:[],pageParams:[]},d=0;const f=async()=>{let p=!1;const g=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(e.signal.aborted?p=!0:e.signal.addEventListener("abort",()=>{p=!0}),e.signal)})},m=hE(e.options,e.fetchOptions),y=async(b,v,w)=>{if(p)return Promise.reject();if(v==null&&b.pages.length)return Promise.resolve(b);const T=(()=>{const R={client:e.client,queryKey:e.queryKey,pageParam:v,direction:w?"backward":"forward",meta:e.options.meta};return g(R),R})(),j=await m(T),{maxPages:M}=e.options,_=w?IL:OL;return{pages:_(b.pages,j,M),pageParams:_(b.pageParams,v,M)}};if(s&&i.length){const b=s==="backward",v=b?qL:fC,w={pages:i,pageParams:o},S=v(r,w);l=await y(w,S,b)}else{const b=t??i.length;do{const v=d===0?o[0]??r.initialPageParam:fC(r,l);if(d>0&&v==null)break;l=await y(l,v),d++}while(d<b)}return l};e.options.persister?e.fetchFn=()=>e.options.persister?.(f,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=f}}}function fC(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function qL(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var HL=class extends yE{#t;#e;#n;#s;constructor(t){super(),this.#t=t.client,this.mutationId=t.mutationId,this.#n=t.mutationCache,this.#e=[],this.state=t.state||bE(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#e.includes(t)||(this.#e.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#e=this.#e.filter(e=>e!==t),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(t){const e=()=>{this.#r({type:"continue"})},n={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#s=mE({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(i,o)=>{this.#r({type:"failed",failureCount:i,error:o})},onPause:()=>{this.#r({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const r=this.state.status==="pending",s=!this.#s.canStart();try{if(r)e();else{this.#r({type:"pending",variables:t,isPaused:s}),await this.#n.config.onMutate?.(t,this,n);const o=await this.options.onMutate?.(t,n);o!==this.state.context&&this.#r({type:"pending",context:o,variables:t,isPaused:s})}const i=await this.#s.start();return await this.#n.config.onSuccess?.(i,t,this.state.context,this,n),await this.options.onSuccess?.(i,t,this.state.context,n),await this.#n.config.onSettled?.(i,null,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(i,null,t,this.state.context,n),this.#r({type:"success",data:i}),i}catch(i){try{throw await this.#n.config.onError?.(i,t,this.state.context,this,n),await this.options.onError?.(i,t,this.state.context,n),await this.#n.config.onSettled?.(void 0,i,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(void 0,i,t,this.state.context,n),i}finally{this.#r({type:"error",error:i})}}finally{this.#n.runNext(this)}}#r(t){const e=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),zt.batch(()=>{this.#e.forEach(n=>{n.onMutationUpdate(t)}),this.#n.notify({mutation:this,type:"updated",action:t})})}};function bE(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var VL=class extends ho{constructor(t={}){super(),this.config=t,this.#t=new Set,this.#e=new Map,this.#n=0}#t;#e;#n;build(t,e,n){const r=new HL({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(r),r}add(t){this.#t.add(t);const e=qf(t);if(typeof e=="string"){const n=this.#e.get(e);n?n.push(t):this.#e.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#t.delete(t)){const e=qf(t);if(typeof e=="string"){const n=this.#e.get(e);if(n)if(n.length>1){const r=n.indexOf(t);r!==-1&&n.splice(r,1)}else n[0]===t&&this.#e.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=qf(t);if(typeof e=="string"){const r=this.#e.get(e)?.find(s=>s.state.status==="pending");return!r||r===t}else return!0}runNext(t){const e=qf(t);return typeof e=="string"?this.#e.get(e)?.find(r=>r!==t&&r.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){zt.batch(()=>{this.#t.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#t.clear(),this.#e.clear()})}getAll(){return Array.from(this.#t)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>sC(e,n))}findAll(t={}){return this.getAll().filter(e=>sC(t,e))}notify(t){zt.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return zt.batch(()=>Promise.all(t.map(e=>e.continue().catch(Mn))))}};function qf(t){return t.options.scope?.id}var KL=class extends ho{#t;#e=void 0;#n;#s;constructor(e,n){super(),this.#t=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#t.defaultMutationOptions(e),Pu(this.options,n)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&so(n.mutationKey)!==so(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#i(e)}getCurrentResult(){return this.#e}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#i()}mutate(e,n){return this.#s=n,this.#n?.removeObserver(this),this.#n=this.#t.getMutationCache().build(this.#t,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??bE();this.#e={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#i(e){zt.batch(()=>{if(this.#s&&this.hasListeners()){const n=this.#e.variables,r=this.#e.context,s={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#s.onSuccess?.(e.data,n,r,s),this.#s.onSettled?.(e.data,null,n,r,s)):e?.type==="error"&&(this.#s.onError?.(e.error,n,r,s),this.#s.onSettled?.(void 0,e.error,n,r,s))}this.listeners.forEach(n=>{n(this.#e)})})}};function hC(t,e){const n=new Set(e);return t.filter(r=>!n.has(r))}function QL(t,e,n){const r=t.slice(0);return r[e]=n,r}var WL=class extends ho{#t;#e;#n;#s;#r;#i;#o;#a;#h=[];constructor(t,e,n){super(),this.#t=t,this.#s=n,this.#n=[],this.#r=[],this.#e=[],this.setQueries(e)}onSubscribe(){this.listeners.size===1&&this.#r.forEach(t=>{t.subscribe(e=>{this.#u(t,e)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#r.forEach(t=>{t.destroy()})}setQueries(t,e){this.#n=t,this.#s=e,zt.batch(()=>{const n=this.#r,r=this.#c(this.#n);this.#h=r,r.forEach(p=>p.observer.setOptions(p.defaultedQueryOptions));const s=r.map(p=>p.observer),i=s.map(p=>p.getCurrentResult()),o=n.length!==s.length,l=s.some((p,g)=>p!==n[g]),d=o||l,f=d?!0:i.some((p,g)=>{const m=this.#e[g];return!m||!Pu(p,m)});!d&&!f||(d&&(this.#r=s),this.#e=i,this.hasListeners()&&(d&&(hC(n,s).forEach(p=>{p.destroy()}),hC(s,n).forEach(p=>{p.subscribe(g=>{this.#u(p,g)})})),this.#l()))})}getCurrentResult(){return this.#e}getQueries(){return this.#r.map(t=>t.getCurrentQuery())}getObservers(){return this.#r}getOptimisticResult(t,e){const n=this.#c(t),r=n.map(s=>s.observer.getOptimisticResult(s.defaultedQueryOptions));return[r,s=>this.#f(s??r,e),()=>this.#d(r,n)]}#d(t,e){return e.map((n,r)=>{const s=t[r];return n.defaultedQueryOptions.notifyOnChangeProps?s:n.observer.trackResult(s,i=>{e.forEach(o=>{o.observer.trackProp(i)})})})}#f(t,e){return e?((!this.#i||this.#e!==this.#a||e!==this.#o)&&(this.#o=e,this.#a=this.#e,this.#i=Ob(this.#i,e(t))),this.#i):t}#c(t){const e=new Map(this.#r.map(r=>[r.options.queryHash,r])),n=[];return t.forEach(r=>{const s=this.#t.defaultQueryOptions(r),i=e.get(s.queryHash);i?n.push({defaultedQueryOptions:s,observer:i}):n.push({defaultedQueryOptions:s,observer:new Lb(this.#t,s)})}),n}#u(t,e){const n=this.#r.indexOf(t);n!==-1&&(this.#e=QL(this.#e,n,e),this.#l())}#l(){if(this.hasListeners()){const t=this.#i,e=this.#d(this.#e,this.#h),n=this.#f(e,this.#s?.combine);t!==n&&zt.batch(()=>{this.listeners.forEach(r=>{r(this.#e)})})}}},YL=class extends ho{constructor(t={}){super(),this.config=t,this.#t=new Map}#t;build(t,e,n){const r=e.queryKey,s=e.queryHash??_b(r,e);let i=this.get(s);return i||(i=new FL({client:t,queryKey:r,queryHash:s,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(r)}),this.add(i)),i}add(t){this.#t.has(t.queryHash)||(this.#t.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#t.get(t.queryHash);e&&(t.destroy(),e===t&&this.#t.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){zt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#t.get(t)}getAll(){return[...this.#t.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>rC(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>rC(t,n)):e}notify(t){zt.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){zt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){zt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},GL=class{#t;#e;#n;#s;#r;#i;#o;#a;constructor(t={}){this.#t=t.queryCache||new YL,this.#e=t.mutationCache||new VL,this.#n=t.defaultOptions||{},this.#s=new Map,this.#r=new Map,this.#i=0}mount(){this.#i++,this.#i===1&&(this.#o=Db.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#t.onFocus())}),this.#a=Ih.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#t.onOnline())}))}unmount(){this.#i--,this.#i===0&&(this.#o?.(),this.#o=void 0,this.#a?.(),this.#a=void 0)}isFetching(t){return this.#t.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#e.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#t.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#t.build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(ca(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return this.#t.findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=this.#t.get(r.queryHash)?.state.data,o=AL(e,i);if(o!==void 0)return this.#t.build(this,r).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return zt.batch(()=>this.#t.findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#t.get(e.queryHash)?.state}removeQueries(t){const e=this.#t;zt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#t;return zt.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=zt.batch(()=>this.#t.findAll(t).map(s=>s.cancel(n)));return Promise.all(r).then(Mn).catch(Mn)}invalidateQueries(t,e={}){return zt.batch(()=>(this.#t.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=zt.batch(()=>this.#t.findAll(t).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(Mn)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Mn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#t.build(this,e);return n.isStaleByTime(ca(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Mn).catch(Mn)}fetchInfiniteQuery(t){return t.behavior=dC(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Mn).catch(Mn)}ensureInfiniteQueryData(t){return t.behavior=dC(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Ih.isOnline()?this.#e.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#t}getMutationCache(){return this.#e}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#s.set(so(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#s.values()],n={};return e.forEach(r=>{zu(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(so(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(r=>{zu(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=_b(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Ib&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#t.clear(),this.#e.clear()}},vE=C.createContext(void 0),Le=t=>{const e=C.useContext(vE);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},XL=({client:t,children:e})=>(C.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),u.jsx(vE.Provider,{value:t,children:e})),wE=C.createContext(!1),SE=()=>C.useContext(wE);wE.Provider;function JL(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var ZL=C.createContext(JL()),kE=()=>C.useContext(ZL),CE=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},NE=t=>{C.useEffect(()=>{t.clearReset()},[t])},TE=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:s})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(s&&t.data===void 0||pE(n,[t.error,r])),jE=t=>{if(t.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=t.staleTime;t.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},EE=(t,e)=>t.isLoading&&t.isFetching&&!e,vx=(t,e)=>t?.suspense&&e.isPending,Dh=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function ez({queries:t,...e},n){const r=Le(),s=SE(),i=kE(),o=C.useMemo(()=>t.map(v=>{const w=r.defaultQueryOptions(v);return w._optimisticResults=s?"isRestoring":"optimistic",w}),[t,r,s]);o.forEach(v=>{jE(v),CE(v,i)}),NE(i);const[l]=C.useState(()=>new WL(r,o,e)),[d,f,p]=l.getOptimisticResult(o,e.combine),g=!s&&e.subscribed!==!1;C.useSyncExternalStore(C.useCallback(v=>g?l.subscribe(zt.batchCalls(v)):Mn,[l,g]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),C.useEffect(()=>{l.setQueries(o,e)},[o,e,l]);const y=d.some((v,w)=>vx(o[w],v))?d.flatMap((v,w)=>{const S=o[w];if(S){const T=new Lb(r,S);if(vx(S,v))return Dh(S,T,i);EE(v,s)&&Dh(S,T,i)}return[]}):[];if(y.length>0)throw Promise.all(y);const b=d.find((v,w)=>{const S=o[w];return S&&TE({result:v,errorResetBoundary:i,throwOnError:S.throwOnError,query:r.getQueryCache().get(S.queryHash),suspense:S.suspense})});if(b?.error)throw b.error;return f(p())}function tz(t,e,n){const r=SE(),s=kE(),i=Le(),o=i.defaultQueryOptions(t);i.getDefaultOptions().queries?._experimental_beforeQuery?.(o),o._optimisticResults=r?"isRestoring":"optimistic",jE(o),CE(o,s),NE(s);const l=!i.getQueryCache().get(o.queryHash),[d]=C.useState(()=>new e(i,o)),f=d.getOptimisticResult(o),p=!r&&t.subscribed!==!1;if(C.useSyncExternalStore(C.useCallback(g=>{const m=p?d.subscribe(zt.batchCalls(g)):Mn;return d.updateResult(),m},[d,p]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),C.useEffect(()=>{d.setOptions(o)},[o,d]),vx(o,f))throw Dh(o,d,s);if(TE({result:f,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw f.error;return i.getDefaultOptions().queries?._experimental_afterQuery?.(o,f),o.experimental_prefetchInRender&&!ro&&EE(f,r)&&(l?Dh(o,d,s):i.getQueryCache().get(o.queryHash)?.promise)?.catch(Mn).finally(()=>{d.updateResult()}),o.notifyOnChangeProps?f:d.trackResult(f)}function lt(t,e){return tz(t,Lb)}function De(t,e){const n=Le(),[r]=C.useState(()=>new KL(n,t));C.useEffect(()=>{r.setOptions(t)},[r,t]);const s=C.useSyncExternalStore(C.useCallback(o=>r.subscribe(zt.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=C.useCallback((o,l)=>{r.mutate(o,l).catch(Mn)},[r]);if(s.error&&pE(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}const Pb=typeof window<"u"&&"__TAURI_INTERNALS__"in window;function ME(){if(!Pb)return!1;const t=navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")||t.includes("android")}const nz=Pb?hi:window.fetch.bind(window);function rz(){if(ME()){const n=sd();if(n)return n}const t=window.__serverConfig?.serverPort??void 0??3e3;return`http://${Pb?"localhost":window.location.hostname||"localhost"}:${t}`}async function Me(t,e){const n=ME()?Xl():null,r={...e?.headers??{}};return n&&(r.Cookie=`user_auth=${n}`),await(await nz(`${rz()}${t}`,{...e??{},credentials:"include",headers:r})).json()}async function sz(t){const e=t?`?broadcastUrl=${encodeURIComponent(t)}`:"";return(await Me(`/api/livestream/message${e}`)).data.message}async function iz(){return(await Me("/api/livestream/obs/status")).data}async function az(){return(await Me("/api/livestream/obs/connect",{method:"POST"})).data}async function oz(){return(await Me("/api/livestream/obs/disconnect",{method:"POST"})).data}async function lz(t=!1){return(await Me(`/api/livestream/obs/scenes${t?"?visible=true":""}`)).data}async function cz(t,e){return(await Me(`/api/livestream/obs/scenes/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).data}async function uz(t){return(await Me("/api/livestream/obs/scenes/reorder",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({sceneIds:t})})).data}async function dz(t){return(await Me(`/api/livestream/obs/scene/${encodeURIComponent(t)}`,{method:"POST"})).data}async function fz(){return(await Me("/api/livestream/obs/stream/start",{method:"POST"})).data}async function hz(){return(await Me("/api/livestream/obs/stream/stop",{method:"POST"})).data}async function pz(){return(await Me("/api/livestream/obs/config")).data}async function gz(t){return(await Me("/api/livestream/obs/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).data}async function AE(t){return(await Me("/api/livestream/youtube/tokens",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).data}async function mz(){return(await Me("/api/livestream/youtube/status")).data}async function yz(){await Me("/api/livestream/youtube/logout",{method:"DELETE"})}async function xz(){return(await Me("/api/livestream/youtube/config")).data}async function bz(t){return(await Me("/api/livestream/youtube/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).data}async function vz(){return(await Me("/api/livestream/youtube/broadcast/active")).data}async function wz(){return(await Me("/api/livestream/youtube/broadcasts/completed")).data}function Sz(){const[t,e]=C.useState(!1),n=De({mutationFn:i=>sz(i)}),r=C.useCallback(async i=>await n.mutateAsync(i),[n]),s=C.useCallback(async i=>{const o=n.data||await n.mutateAsync(i);return await navigator.clipboard.writeText(o),e(!0),setTimeout(()=>e(!1),2e3),o},[n]);return{message:n.data,isLoading:n.isPending,fetchMessage:r,copyMessage:s,copied:t}}function nr(t,e){t!=="debug"&&console.log(`[${t.toUpperCase()}] [livestream-ws] ${e}`)}function RE(){const t=Le(),e=C.useRef(null),n=C.useRef(null),r=C.useRef(null),[s,i]=C.useState("disconnected"),[o,l]=C.useState(null),[d,f]=C.useState(null),p=C.useCallback(()=>{if(e.current?.readyState===WebSocket.OPEN)return;const y=Ct().replace(/^http/,"ws")+"/ws";nr("debug",`Connecting to ${y}`),i("connecting");try{const b=new WebSocket(y);e.current=b,b.onopen=()=>{nr("info","WebSocket connected"),console.log("[livestream-ws] WebSocket CONNECTED to",y),i("connected"),r.current=setInterval(()=>{b.readyState===WebSocket.OPEN&&b.send(JSON.stringify({type:"ping"}))},3e4)},b.onmessage=v=>{try{const w=JSON.parse(v.data);if(w.type==="pong"){nr("debug","Received pong");return}w.type==="obs_connection_status"&&(nr("debug","Received OBS connection status update"),t.invalidateQueries({queryKey:["livestream","obs","status"]})),w.type==="obs_streaming_status"&&(nr("debug","Received OBS streaming status update"),t.invalidateQueries({queryKey:["livestream","obs","status"]})),w.type==="obs_current_scene"&&(nr("debug",`Received OBS current scene: ${w.payload.sceneName}`),t.invalidateQueries({queryKey:["livestream","obs","scenes"]})),w.type==="livestream_status"&&(nr("debug","Received livestream status update"),l(w.payload),t.invalidateQueries({queryKey:["livestream","broadcast"]})),w.type==="youtube_auth_status"&&(nr("info",`Received YouTube auth status update: isAuthenticated=${w.payload.isAuthenticated}`),console.log("[livestream-ws] YouTube auth status payload:",w.payload),t.invalidateQueries({queryKey:["livestream","youtube","auth"]})),w.type==="stream_start_progress"&&(nr("debug",`Stream start progress: ${w.payload.step} (${w.payload.progress}%)`),f(w.payload),(w.payload.step==="completed"||w.payload.step==="error")&&setTimeout(()=>f(null),3e3))}catch(w){nr("error",`Failed to parse message: ${w}`)}},b.onerror=v=>{nr("error",`WebSocket error: ${v}`),i("error")},b.onclose=()=>{nr("info","WebSocket disconnected"),i("disconnected"),r.current&&(clearInterval(r.current),r.current=null),n.current=setTimeout(()=>{nr("debug","Attempting reconnect..."),p()},3e3)}}catch(b){nr("error",`Failed to connect: ${b}`),i("error"),n.current=setTimeout(()=>{p()},5e3)}},[t]),g=C.useCallback(()=>{n.current&&(clearTimeout(n.current),n.current=null),r.current&&(clearInterval(r.current),r.current=null),e.current&&(e.current.close(),e.current=null)},[]);return C.useEffect(()=>(p(),()=>{g()}),[p,g]),{status:s,livestreamStatus:o,streamStartProgress:d,connect:p,disconnect:g}}async function kz(){return(await Me("/api/livestream/mixer/config")).data}async function Cz(t){return(await Me("/api/livestream/mixer/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).data}async function Nz(){return(await Me("/api/livestream/mixer/channels")).data}async function Tz(t){return(await Me("/api/livestream/mixer/channels",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({channels:t})})).data}async function _E(){return(await Me("/api/livestream/mixer/test",{method:"POST"})).data}function OE(){const t=Le(),e=lt({queryKey:["livestream","mixer","channels"],queryFn:Nz,staleTime:300*1e3}),n=De({mutationFn:r=>Tz(r),onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","mixer","channels"]})}});return{...e,channels:e.data??[],update:n.mutate,updateAsync:n.mutateAsync,isUpdating:n.isPending}}function Bb(){const t=Le(),e=lt({queryKey:["livestream","mixer","config"],queryFn:kz,staleTime:300*1e3}),n=De({mutationFn:s=>Cz(s),onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","mixer","config"]})}}),r=De({mutationFn:_E});return{...e,config:e.data,update:n.mutate,updateAsync:n.mutateAsync,isUpdating:n.isPending,testConnection:r.mutateAsync,isTesting:r.isPending,testResult:r.data}}function jz(){const t=Le(),e=lt({queryKey:["livestream","obs","config"],queryFn:pz,staleTime:300*1e3}),n=De({mutationFn:r=>gz(r),onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","obs","config"]})}});return{...e,config:e.data,update:n.mutate,updateAsync:n.mutateAsync,isUpdating:n.isPending}}function Fb(){const t=Le(),e=lt({queryKey:["livestream","obs","status"],queryFn:iz,staleTime:10*1e3,refetchInterval:30*1e3}),n=De({mutationFn:az,onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","obs"]})}}),r=De({mutationFn:oz,onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","obs"]})}});return{...e,status:e.data,isConnected:e.data?.connected??!1,isStreaming:e.data?.isStreaming??!1,isRecording:e.data?.isRecording??!1,connect:n.mutate,connectAsync:n.mutateAsync,isConnecting:n.isPending,disconnect:r.mutate,disconnectAsync:r.mutateAsync,isDisconnecting:r.isPending}}function Ub(t=!1){const e=Le(),n=lt({queryKey:["livestream","obs","scenes",t],queryFn:()=>lz(t),staleTime:10*1e3,refetchInterval:30*1e3}),r=De({mutationFn:({id:l,data:d})=>cz(l,d),onSuccess:()=>{e.invalidateQueries({queryKey:["livestream","obs","scenes"]})}}),s=De({mutationFn:l=>uz(l),onSuccess:()=>{e.invalidateQueries({queryKey:["livestream","obs","scenes"]})}}),i=De({mutationFn:l=>dz(l),onMutate:async l=>{await e.cancelQueries({queryKey:["livestream","obs","scenes"]});const d=e.getQueryData(["livestream","obs","scenes",t]);return e.setQueryData(["livestream","obs","scenes",t],f=>f&&f.map(p=>({...p,isCurrent:p.obsSceneName===l}))),{previousScenes:d}},onError:(l,d,f)=>{f?.previousScenes&&e.setQueryData(["livestream","obs","scenes",t],f.previousScenes)},onSettled:()=>{e.invalidateQueries({queryKey:["livestream","obs","scenes"]})}}),o=n.data?.find(l=>l.isCurrent);return{...n,scenes:n.data??[],currentScene:o,updateScene:r.mutate,isUpdating:r.isPending,reorderScenes:s.mutate,isReordering:s.isPending,switchScene:i.mutate,switchSceneAsync:i.mutateAsync,isSwitching:i.isPending}}function $p(){const t=Le(),{streamStartProgress:e,livestreamStatus:n}=RE(),r=lt({queryKey:["livestream","broadcast","active"],queryFn:vz,staleTime:10*1e3,refetchInterval:30*1e3}),s=De({mutationFn:fz,onSuccess:()=>{t.invalidateQueries({queryKey:["livestream"]})}}),i=De({mutationFn:hz,onSuccess:()=>{t.invalidateQueries({queryKey:["livestream"]})}}),o=n!==null?n.isLive:r.data?.status==="live";return{activeBroadcast:r.data,isLoadingBroadcast:r.isLoading,isLive:o,start:s.mutate,startAsync:s.mutateAsync,isStarting:s.isPending,stop:i.mutate,stopAsync:i.mutateAsync,isStopping:i.isPending,lastStartedBroadcast:s.data?.broadcast,streamStartProgress:e}}function Bu(){return typeof window<"u"&&"__TAURI_INTERNALS__"in window}async function IE(t){if(console.log("[openInTauriBrowser] Attempting to open:",t),console.log("[openInTauriBrowser] window.__TAURI__:",window.__TAURI__),window.__TAURI__?.opener?.openUrl)try{return console.log("[openInTauriBrowser] Using __TAURI__.opener.openUrl"),await window.__TAURI__.opener.openUrl(t),!0}catch(e){console.error("[openInTauriBrowser] opener.openUrl failed:",e)}if(window.__TAURI__?.shell?.open)try{return console.log("[openInTauriBrowser] Using __TAURI__.shell.open"),await window.__TAURI__.shell.open(t),!0}catch(e){console.error("[openInTauriBrowser] shell.open failed:",e)}try{console.log("[openInTauriBrowser] Trying dynamic import of plugin-shell");const{open:e}=await Cn(async()=>{const{open:n}=await import("./index-DloC2wOa.js");return{open:n}},[]);return await e(t),!0}catch(e){console.error("[openInTauriBrowser] plugin-shell import failed:",e)}try{console.log("[openInTauriBrowser] Trying dynamic import of plugin-opener");const{openUrl:e}=await Cn(async()=>{const{openUrl:n}=await import("./index-DBkYlLEp.js");return{openUrl:n}},[]);return await e(t),!0}catch(e){console.error("[openInTauriBrowser] plugin-opener import failed:",e)}return!1}async function wx(t){Bu()&&await IE(t)||window.open(t,"_blank","noopener,noreferrer")}async function pC(t,e){const{popupName:n="auth",width:r=600,height:s=700}=e||{};return console.log("[openAuthUrl] isTauri:",Bu(),"url:",t),Bu()?await IE(t)?(console.log("[openAuthUrl] Successfully opened in native browser"),null):(console.error("[openAuthUrl] All Tauri methods failed, trying window.open"),window.open(t,n,`width=${r},height=${s},left=100,top=100`)):window.open(t,n,`width=${r},height=${s},left=100,top=100`)}const $0="https://churchub-youtube-oauth-worker.bringes.io";function DE(){const t=Le(),{t:e}=ke("livestream"),{showToast:n}=mt(),[r,s]=C.useState(!1),[i,o]=C.useState(null),l=C.useRef(void 0),d=lt({queryKey:["livestream","youtube","auth"],queryFn:mz,staleTime:300*1e3});C.useEffect(()=>{const m=d.data?.requiresReauth;m&&l.current!==!0&&!r&&n(e("errors.youtubeSessionExpired"),"error"),l.current=m},[d.data?.requiresReauth,r,n,e]);const f=De({mutationFn:AE,onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","youtube"]}),s(!1),o(null)},onError:m=>{o(m instanceof Error?m.message:"Failed to store tokens"),s(!1)}}),p=De({mutationFn:yz,onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","youtube"]})}});C.useEffect(()=>{d.data?.isAuthenticated&&r&&(s(!1),o(null))},[d.data?.isAuthenticated,r]);const g=C.useCallback(async()=>{console.log("[useYouTubeAuth] openLoginPopup called"),console.log("[useYouTubeAuth] YOUTUBE_OAUTH_SERVER:",$0),console.log("[useYouTubeAuth] isTauri:",Bu()),s(!0),o(null);try{const m="http://localhost:3000",y=new URL("/auth/youtube",$0);if(y.searchParams.set("origin",m),Bu()){y.searchParams.set("mode","redirect"),y.searchParams.set("returnUrl",`${m}/auth/youtube/callback`),console.log("[useYouTubeAuth] Opening auth URL:",y.toString()),await pC(y.toString(),{popupName:"youtube-auth"}),setTimeout(()=>{f.isPending||s(!1)},6e4);return}y.searchParams.set("mode","postMessage");const b=await pC(y.toString(),{popupName:"youtube-auth"}),v=async S=>{const T=new URL($0).origin;if(S.origin===T){if(S.data?.type==="youtube-auth-success"){const{tokens:j}=S.data;try{await f.mutateAsync({accessToken:j.accessToken,refreshToken:j.refreshToken,expiresAt:j.expiresAt})}catch(M){o(M instanceof Error?M.message:"Failed to store tokens"),s(!1)}b?.close()}else S.data?.type==="youtube-auth-error"&&(o(S.data.error||"Authentication failed"),s(!1),b?.close());window.removeEventListener("message",v)}};window.addEventListener("message",v);const w=setInterval(()=>{b?.closed&&(clearInterval(w),window.removeEventListener("message",v),f.isPending||s(!1))},500)}catch(m){o(m instanceof Error?m.message:"Authentication failed"),s(!1)}},[f]);return{...d,isAuthenticated:d.data?.isAuthenticated??!1,channelName:d.data?.channelName,channelId:d.data?.channelId,requiresReauth:d.data?.requiresReauth??!1,login:g,logout:p.mutate,isLoggingOut:p.isPending,isAuthenticating:r,authError:i}}function $b(){const t=Le(),e=lt({queryKey:["livestream","youtube","config"],queryFn:xz,staleTime:300*1e3}),n=De({mutationFn:r=>bz(r),onSuccess:()=>{t.invalidateQueries({queryKey:["livestream","youtube","config"]})}});return{...e,config:e.data,update:n.mutate,updateAsync:n.mutateAsync,isUpdating:n.isPending}}function LE(t=!0){const e=lt({queryKey:["livestream","youtube","broadcasts","completed"],queryFn:wz,staleTime:6e4,enabled:t});return{broadcasts:e.data??[],isLoading:e.isLoading,refetch:e.refetch,isRefetching:e.isRefetching,error:e.error}}function Ez(t){return!1}function Hf(t,e,n,...r){t==="error"?console.error(`[${e}] ${n}`,...r):t==="warn"?console.warn(`[${e}] ${n}`,...r):Ez()&&(t==="debug"?console.debug(`[${e}] ${n}`,...r):t==="info"&&console.log(`[${e}] ${n}`,...r))}function ec(t){return{debug:(e,...n)=>Hf("debug",t,e,...n),info:(e,...n)=>Hf("info",t,e,...n),warn:(e,...n)=>Hf("warn",t,e,...n),error:(e,...n)=>Hf("error",t,e,...n)}}const qb=C.createContext(null);function Mz({children:t}){const[e,n]=C.useState(0),r=C.useRef(!1);r.current=e>0;const s=C.useCallback(()=>{n(l=>l+1)},[]),i=C.useCallback(()=>{n(l=>Math.max(0,l-1))},[]),o=C.useMemo(()=>({isRecording:e>0,isRecordingRef:r,startRecording:s,stopRecording:i}),[e,s,i]);return u.jsx(qb.Provider,{value:o,children:t})}function Az(){const t=C.useContext(qb);if(!t)throw new Error("useShortcutRecording must be used within ShortcutRecordingProvider");return t}function Rz(){return C.useContext(qb)}async function po(t,e){try{const n=await Me(`/api/settings/${t}/${e}`);return n.error?null:n.data??null}catch{return null}}async function go(t,e){try{const n=await Me(`/api/settings/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return n.error?!1:n.data?.success??!1}catch{return!1}}const bu="midi:",zE={enabled:!1,inputDeviceId:null,outputDeviceId:null},gC={actions:{startLive:{shortcuts:[],enabled:!0},stopLive:{shortcuts:[],enabled:!0},searchSong:{shortcuts:[],enabled:!0},searchBible:{shortcuts:[],enabled:!0}},version:1},Vf="global_keyboard_shortcuts";function Hb(){const t=Le(),{data:e,isLoading:n}=lt({queryKey:["app_settings",Vf],queryFn:()=>po("app_settings",Vf)}),r=De({mutationFn:f=>go("app_settings",{key:Vf,value:JSON.stringify(f)}),onSuccess:()=>{t.invalidateQueries({queryKey:["app_settings",Vf]})}}),s=C.useMemo(()=>{if(!e?.value)return gC;try{return JSON.parse(e.value)}catch{return gC}},[e]),i=C.useMemo(()=>s.midi??zE,[s]),o=C.useCallback(async(f,p)=>{const g={...s,actions:{...s.actions,[f]:p}};await r.mutateAsync(g)},[s,r]),l=C.useCallback(async f=>{const p={...s,midi:f};await r.mutateAsync(p)},[s,r]),d=C.useCallback(async f=>{await r.mutateAsync(f)},[r]);return{shortcuts:s,midiConfig:i,isLoading:n,isSaving:r.isPending,updateActionShortcuts:o,updateMIDIConfig:l,updateFullConfig:d}}async function mC(t,e){const n=new Sj;return n.onmessage=e,await Yt("plugin:global-shortcut|register",{shortcuts:Array.isArray(t)?t:[t],handler:n})}async function yC(){return await Yt("plugin:global-shortcut|unregister_all",{})}const Br=ec("keyboard-shortcuts:global");function _z({shortcuts:t,sceneShortcuts:e,onStartLive:n,onStopLive:r,onSearchSong:s,onSearchBible:i,onSceneSwitch:o,isRecordingRef:l}){const d=C.useRef({onStartLive:n,onStopLive:r,onSearchSong:s,onSearchBible:i,onSceneSwitch:o});C.useEffect(()=>{d.current={onStartLive:n,onStopLive:r,onSearchSong:s,onSearchBible:i,onSceneSwitch:o}},[n,r,s,i,o]);const f=JSON.stringify(t),p=JSON.stringify(e);C.useEffect(()=>{let g=!1;return(async()=>{const y=JSON.parse(f),b=JSON.parse(p);try{if(await yC(),Br.debug("Unregistered all previous shortcuts"),g)return;const v={startLive:()=>d.current.onStartLive(),stopLive:()=>d.current.onStopLive(),searchSong:()=>d.current.onSearchSong(),searchBible:()=>d.current.onSearchBible()};if(y.actions){for(const[w,S]of Object.entries(y.actions))if(S.enabled){for(const T of S.shortcuts)if(T){if(g)return;try{await mC(T,j=>{if(j.state==="Pressed"){if(l?.current){Br.debug(`Skipping shortcut ${T} - recording in progress`);return}Br.info(`App shortcut triggered: ${T} -> ${w}`),v[w]()}}),Br.info(`Registered app shortcut: ${T} -> ${w}`)}catch(j){Br.error(`Failed to register app shortcut ${T}:`,j)}}}}for(const{shortcut:w,sceneName:S}of b)if(w){if(g)return;try{await mC(w,T=>{if(T.state==="Pressed"){if(l?.current){Br.debug(`Skipping scene shortcut ${w} - recording in progress`);return}Br.info(`Scene shortcut triggered: ${w} -> ${S}`),d.current.onSceneSwitch(S)}}),Br.info(`Registered scene shortcut: ${w} -> ${S}`)}catch(T){Br.error(`Failed to register scene shortcut ${w}:`,T)}}Br.info("All shortcuts registered successfully")}catch(v){Br.error("Failed to register shortcuts:",v)}})(),()=>{g=!0,yC().catch(y=>{Br.error("Failed to cleanup shortcuts on unmount:",y)})}},[f,p])}const nn=ec("midi:context"),Vb=C.createContext(null);function PE({children:t,initialConfig:e=zE,onConfigChange:n}){const[r,s]=C.useState(!1),[i,o]=C.useState(null),[l,d]=C.useState([]),[f,p]=C.useState([]),[g,m]=C.useState(e),y=C.useRef(null),b=C.useRef(null),v=C.useRef(new Set),w=!0,S=C.useCallback(async()=>{try{const E=await(await fetch(`${Ct()}/api/midi/devices`)).json();if(E.data){const K=E.data.inputs.map(V=>({id:String(V.id),name:V.name,manufacturer:"Unknown",state:"connected"})),q=E.data.outputs.map(V=>({id:String(V.id),name:V.name,manufacturer:"Unknown",state:"connected"}));d(K),p(q),nn.debug("Fetched MIDI devices",{inputs:K,outputs:q})}}catch(B){nn.error("Failed to fetch MIDI devices",{error:B})}},[]),T=C.useCallback(()=>{if(y.current?.readyState===WebSocket.OPEN)return;const B=`${Aj()}/ws`;try{const E=new WebSocket(B);y.current=E,E.onopen=()=>{s(!0),o(null)},E.onmessage=K=>{try{const q=JSON.parse(K.data);if(q.type==="midi_message"){const V={type:q.payload.type,channel:q.payload.channel,note:q.payload.note,controller:q.payload.controller,value:q.payload.value,timestamp:q.payload.timestamp};v.current.forEach(ie=>{try{ie(V)}catch(Y){nn.error("Error in MIDI message subscriber",{error:Y})}})}q.type==="midi_connection_status"&&nn.debug("MIDI connection status",q.payload),q.type==="midi_devices"&&(nn.debug("MIDI devices update",q.payload),S())}catch(q){nn.error("Failed to parse WebSocket message",{error:q})}},E.onerror=K=>{nn.error("WebSocket error",{error:K}),o("WebSocket connection error")},E.onclose=()=>{nn.info("WebSocket disconnected"),g.enabled&&(b.current=setTimeout(()=>{nn.debug("Reconnecting WebSocket..."),T()},3e3))}}catch(E){nn.error("Failed to connect WebSocket",{error:E}),o("Failed to connect to MIDI service")}},[g.enabled,S]),j=C.useCallback(async()=>{try{await S(),T();const B=g.inputDeviceId?parseInt(g.inputDeviceId,10):null,E=g.outputDeviceId?parseInt(g.outputDeviceId,10):null;if(B!==null||E!==null)try{const q=await(await fetch(`${Ct()}/api/midi/connect`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inputDeviceId:B,outputDeviceId:E})})).json()}catch{}return!0}catch(B){const E=B instanceof Error?B.message:"Unknown error requesting MIDI access";return nn.error("MIDI access request failed",{error:E}),o(E),!1}},[S,T,g.inputDeviceId,g.outputDeviceId]),M=C.useCallback(async(B,E)=>{try{const q=await(await fetch(`${Ct()}/api/midi/connect`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inputDeviceId:B,outputDeviceId:E})})).json();return nn.debug("MIDI connect result",q),q.data}catch(K){return nn.error("Failed to connect MIDI devices",{error:K}),null}},[]),_=C.useCallback(B=>{const E=B?parseInt(B,10):null;m(K=>{const q={...K,inputDeviceId:B};return n?.(q),q}),M(E,g.outputDeviceId?parseInt(g.outputDeviceId,10):null)},[g.outputDeviceId,M,n]),R=C.useCallback(B=>{const E=B?parseInt(B,10):null;m(K=>{const q={...K,outputDeviceId:B};return n?.(q),q}),M(g.inputDeviceId?parseInt(g.inputDeviceId,10):null,E)},[g.inputDeviceId,M,n]),O=C.useCallback(B=>{m(E=>{const K={...E,enabled:B};return n?.(K),K}),B?j():(y.current&&(y.current.close(),y.current=null),fetch(`${Ct()}/api/midi/disconnect`,{method:"POST"}).catch(E=>nn.error("Failed to disconnect",{error:E})))},[n,j]),L=C.useCallback(B=>{if(m(E=>{const K={...E,...B};return n?.(K),K}),B.inputDeviceId!==void 0||B.outputDeviceId!==void 0){const E=B.inputDeviceId??g.inputDeviceId,K=B.outputDeviceId??g.outputDeviceId;M(E?parseInt(E,10):null,K?parseInt(K,10):null)}},[g.inputDeviceId,g.outputDeviceId,M,n]),A=C.useCallback((B,E)=>{if(!y.current||y.current.readyState!==WebSocket.OPEN){nn.debug("Cannot set LED: WebSocket not connected");return}try{y.current.send(JSON.stringify({type:"midi_set_led",payload:{note:B,on:E}})),nn.debug(`LED ${B} set to ${E?"ON":"OFF"}`)}catch(K){nn.error("Error sending LED message",{error:K,note:B,on:E})}},[]),F=C.useCallback(B=>{if(!y.current||y.current.readyState!==WebSocket.OPEN){nn.debug("Cannot set LEDs: WebSocket not connected");return}const E=[];B.forEach((K,q)=>{E.push({note:q,on:K})});try{y.current.send(JSON.stringify({type:"midi_set_all_leds",payload:{ledStates:E}}))}catch(K){nn.error("Error sending LED messages",{error:K})}},[]),H=C.useCallback(B=>(v.current.add(B),()=>{v.current.delete(B)}),[]);C.useEffect(()=>(g.enabled&&j(),()=>{b.current&&clearTimeout(b.current),y.current&&y.current.close()}),[g.enabled,j]),C.useEffect(()=>{m(e)},[e]);const P=C.useMemo(()=>({isSupported:w,isEnabled:g.enabled,hasPermission:r,permissionError:i,inputDevices:l,outputDevices:f,selectedInputId:g.inputDeviceId,selectedOutputId:g.outputDeviceId,requestAccess:j,selectInputDevice:_,selectOutputDevice:R,setEnabled:O,setLED:A,setAllLEDs:F,subscribe:H,config:g,updateConfig:L}),[w,g,r,i,l,f,j,_,R,O,A,F,H,L]);return u.jsx(Vb.Provider,{value:P,children:t})}function Oz(){const t=C.useContext(Vb);if(!t)throw new Error("useMIDI must be used within a MIDIProvider");return t}function Kb(){return C.useContext(Vb)}function BE(t){switch(t.type){case"note_on":return`${bu}note_on:${t.note}`;case"note_off":return`${bu}note_off:${t.note}`;case"control_change":return`${bu}cc:${t.controller}`;default:return""}}function FE(t){if(!io(t))return null;const e=t.slice(bu.length),[n,r]=e.split(":"),s=parseInt(r,10);if(isNaN(s))return null;switch(n){case"note_on":return{type:"note_on",number:s};case"note_off":return{type:"note_off",number:s};case"cc":return{type:"control_change",number:s};default:return null}}function io(t){return t.startsWith(bu)}function Iz(t){const e=FE(t);if(!e)return t;switch(e.type){case"note_on":return`MIDI Note ${e.number}`;case"note_off":return`MIDI Note Off ${e.number}`;case"control_change":return`MIDI CC ${e.number}`;default:return t}}function xC(t){const e=FE(t);return e?e.number:null}const q0=ec("midi:led-feedback");function Dz({shortcuts:t,sceneShortcuts:e,isLive:n,currentSceneName:r}){const s=Kb(),i=C.useRef(new Map);C.useEffect(()=>{if(!s||!s.isEnabled||!s.selectedOutputId){q0.debug("LED feedback disabled: no MIDI output");return}const o=new Map;if(t?.actions){const d=Object.keys(t.actions);for(const f of d){const p=t.actions[f];if(!(!p?.enabled||!p.shortcuts))for(const g of p.shortcuts){if(!io(g))continue;const m=xC(g);if(m===null)continue;let y=!1;(f==="startLive"||f==="stopLive")&&(y=n),o.set(m,y)}}}for(const{shortcut:d,sceneName:f}of e){if(!io(d))continue;const p=xC(d);if(p===null)continue;const g=f===r;o.set(p,g)}const l=[];if(o.forEach((d,f)=>{i.current.get(f)!==d&&l.push({note:f,on:d})}),i.current.forEach((d,f)=>{!o.has(f)&&d&&l.push({note:f,on:!1})}),l.length>0){q0.debug("LED state changes",{changes:l});for(const{note:d,on:f}of l)s.setLED(d,f)}i.current=o},[s,t,e,n,r]),C.useEffect(()=>()=>{!s||!s.isEnabled||(q0.debug("Cleaning up LED states"),i.current.forEach((o,l)=>{o&&s.setLED(l,!1)}))},[s])}const gl=ec("midi:shortcuts"),Lz=200;function zz({shortcuts:t,sceneShortcuts:e,onStartLive:n,onStopLive:r,onSearchSong:s,onSearchBible:i,onSceneSwitch:o,isRecordingRef:l}){const d=Kb(),f=C.useRef({onStartLive:n,onStopLive:r,onSearchSong:s,onSearchBible:i,onSceneSwitch:o});C.useEffect(()=>{f.current={onStartLive:n,onStopLive:r,onSearchSong:s,onSearchBible:i,onSceneSwitch:o}},[n,r,s,i,o]);const p=C.useRef(new Map),g=C.useRef(new Map);C.useEffect(()=>{const y=new Map;if(t?.actions){const b=Object.keys(t.actions);for(const v of b){const w=t.actions[v];if(w?.enabled&&w.shortcuts){for(const S of w.shortcuts)if(io(S)){const T=y.get(S)||[];T.push({type:"global",action:v}),y.set(S,T),gl.debug(`Mapped MIDI shortcut ${S} to global action ${v}`)}}}}for(const{shortcut:b,sceneName:v}of e)if(io(b)){const w=y.get(b)||[];w.push({type:"scene",action:v}),y.set(b,w),gl.debug(`Mapped MIDI shortcut ${b} to scene ${v}`)}p.current=y,gl.info(`Built MIDI shortcut map with ${y.size} entries`)},[t,e]);const m=C.useCallback(y=>{if(l?.current){gl.debug("Skipping MIDI action - recording in progress");return}if(y.type==="note_off"||y.type==="control_change"&&y.value===0)return;const b=BE(y),v=Date.now(),w=g.current.get(b)||0;if(v-w<Lz){gl.debug(`Debouncing MIDI shortcut: ${b} (${v-w}ms since last)`);return}g.current.set(b,v);const S=p.current.get(b);if(!(!S||S.length===0)){gl.info(`MIDI shortcut triggered: ${b}`,{mappings:S});for(const T of S)if(T.type==="global")switch(T.action){case"startLive":f.current.onStartLive?.();break;case"stopLive":f.current.onStopLive?.();break;case"searchSong":f.current.onSearchSong?.();break;case"searchBible":f.current.onSearchBible?.();break}else T.type==="scene"&&f.current.onSceneSwitch?.(T.action)}},[]);C.useEffect(()=>{if(!d||!d.isEnabled)return;const y=d.subscribe(b=>{m(b)});return()=>{y()}},[d,m])}const Zs=ec("keyboard-shortcuts:manager");function Pz(){const t=lr(),{shortcuts:e,isLoading:n}=Hb(),{start:r,stop:s,isLive:i,isStarting:o,isStopping:l,streamStartProgress:d}=$p(),{scenes:f,switchScene:p,currentScene:g}=Ub(),{isRecordingRef:m}=Az(),y=C.useRef(!1),b=C.useRef(!1),v=d&&d.step!=="completed"&&d.step!=="error";C.useEffect(()=>{!o&&!v&&(y.current=!1)},[o,v]),C.useEffect(()=>{l||(b.current=!1)},[l]);const w=C.useMemo(()=>{const R=[];for(const O of f)if(O.shortcuts)for(const L of O.shortcuts)R.push({shortcut:L,sceneName:O.obsSceneName});return R},[f]),S=C.useCallback(()=>{if(i){if(b.current||l){Zs.debug("Skipping stop - already stopping");return}b.current=!0,Zs.info("Stopping live stream via shortcut (toggle)"),t({to:"/livestream"}),s();return}if(y.current||o||v){Zs.debug("Skipping start - already starting");return}y.current=!0,Zs.info("Starting live stream via shortcut"),t({to:"/livestream"}),r()},[r,s,t,i,o,l,v]),T=C.useCallback(()=>{if(b.current||!i&&!v||l){Zs.debug("Skipping stop - livestream is not live/starting or already stopping");return}b.current=!0,Zs.info("Stopping live stream via shortcut"),t({to:"/livestream/"}),s()},[s,t,i,l,v]),j=C.useCallback(()=>{Zs.debug("Navigating to song search via shortcut"),t({to:"/songs/"})},[t]),M=C.useCallback(()=>{Zs.debug("Navigating to Bible search via shortcut"),t({to:"/bible/"})},[t]),_=C.useCallback(R=>{Zs.debug(`Switching to scene: ${R}`),p(R)},[p]);return _z({shortcuts:n?{actions:{},version:1}:e,sceneShortcuts:w,onStartLive:S,onStopLive:T,onSearchSong:j,onSearchBible:M,onSceneSwitch:_,isRecordingRef:m}),zz({shortcuts:n?{actions:{},version:1}:e,sceneShortcuts:w,onStartLive:S,onStopLive:T,onSearchSong:j,onSearchBible:M,onSceneSwitch:_,isRecordingRef:m}),Dz({shortcuts:n?{actions:{},version:1}:e,sceneShortcuts:w,isLive:i??!1,currentSceneName:g?.obsSceneName??null}),null}function UE(t){if(io(t))return Iz(t);const e=navigator.platform.includes("Mac");return t.replace("CommandOrControl",e?"Cmd":"Ctrl").replace("Control","Ctrl").replace("Meta","Cmd").replace("ArrowUp","").replace("ArrowDown","").replace("ArrowLeft","").replace("ArrowRight","")}function bC(t){return["Meta","Control","Alt","Shift"].includes(t)}const Bz=[["startLive","stopLive"]];function Fz(t,e){return Bz.some(([n,r])=>t===n&&e===r||t===r&&e===n)}function Uz(t,e,n,r){for(const[s,i]of Object.entries(n.actions))if(s!==e&&!Fz(e,s)&&i.shortcuts.includes(t))return{shortcut:t,conflictSource:"global",conflictName:s};for(const s of r)if(s.shortcuts?.includes(t))return{shortcut:t,conflictSource:"scene",conflictName:s.displayName};return null}function $E({value:t,onChange:e,onRemove:n,error:r,namespace:s="settings"}){const{t:i}=ke(s),[o,l]=C.useState(!1),d=C.useRef(o),f=C.useRef(e),p=Kb(),g=Rz();C.useEffect(()=>{d.current=o},[o]),C.useEffect(()=>{f.current=e},[e]),C.useEffect(()=>!o||!p||!p.isEnabled?void 0:p.subscribe(j=>{if(j.type==="note_off"||j.type==="control_change"&&j.value===0)return;const M=BE(j);M&&(f.current(M),l(!1),g?.stopRecording())}),[o,p,g]);const m=s==="livestream"?"scenes":"sections.shortcuts",y=C.useCallback(T=>{if(T.preventDefault(),T.stopPropagation(),!d.current)return;const j=[];if((T.metaKey||T.ctrlKey)&&j.push("CommandOrControl"),T.altKey&&j.push("Alt"),T.shiftKey&&j.push("Shift"),!bC(T.key)){const M=T.key.length===1?T.key.toUpperCase():T.key;j.push(M)}j.length>0&&!bC(T.key)&&(f.current(j.join("+")),l(!1),g?.stopRecording())},[g]),b=C.useCallback(()=>{l(!0),g?.startRecording()},[g]),v=C.useCallback(()=>{l(!1),g?.stopRecording()},[g]),w=t&&io(t),S=()=>o?p?.isEnabled?i(`${m}.recordShortcutOrMidi`,{defaultValue:"Press key or MIDI button..."}):i(`${m}.recordShortcut`):i(`${m}.clickToRecord`,{defaultValue:"Click to record"});return u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:"flex-1 relative",children:[w&&!o&&u.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 px-1.5 py-0.5 text-[10px] font-medium bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded",children:"MIDI"}),u.jsx("input",{type:"text",readOnly:!0,value:t?UE(t):"",placeholder:S(),onKeyDown:y,onFocus:b,onBlur:v,className:`
            w-full py-2 text-sm
            border rounded-lg
            bg-white dark:bg-gray-700
            text-gray-900 dark:text-white
            placeholder:text-gray-400 dark:placeholder:text-gray-500
            focus:outline-none focus:ring-2
            cursor-pointer
            ${w&&!o?"pl-14 pr-3":"px-3"}
            ${r?"border-red-500 focus:ring-red-500":o?"border-indigo-500 focus:ring-indigo-500":"border-gray-300 dark:border-gray-600 focus:ring-indigo-500"}
          `}),o&&u.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-indigo-500 animate-pulse",children:i(`${m}.recording`,{defaultValue:"Recording..."})})]}),u.jsx("button",{type:"button",onClick:n,className:"p-2 text-gray-400 hover:text-red-500 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:i(`${m}.removeShortcut`),children:u.jsx(nt,{size:18})})]})}function $z({action:t,config:e,allShortcuts:n,scenes:r,onUpdate:s}){const{t:i}=ke("settings"),[o,l]=C.useState({}),d=t.icon,f=C.useCallback(v=>Uz(v,t.id,n,r),[t.id,n,r]),p=C.useCallback(v=>{if(v.conflictSource==="global"){const w=i(`sections.shortcuts.actions.${v.conflictName}.label`);return i("sections.shortcuts.conflicts.global",{action:w})}return i("sections.shortcuts.conflicts.scene",{scene:v.conflictName})},[i]),g=C.useCallback(()=>{s({...e,shortcuts:[...e.shortcuts,""]})},[e,s]),m=C.useCallback(v=>{const w=e.shortcuts.filter((S,T)=>T!==v);s({...e,shortcuts:w}),l(S=>{const T={...S};return delete T[v],T})},[e,s]),y=C.useCallback((v,w)=>{const S=[...e.shortcuts];S[v]=w,s({...e,shortcuts:S});const T=f(w);l(T?j=>({...j,[v]:p(T)}):j=>{const M={...j};return delete M[v],M})},[e,s,f,p]),b=C.useCallback(()=>{s({...e,enabled:!e.enabled})},[e,s]);return u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-start justify-between mb-3",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-indigo-50 dark:bg-indigo-900/30 rounded-lg",children:u.jsx(d,{size:20,className:"text-indigo-600 dark:text-indigo-400"})}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:i(t.labelKey)}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:i(t.descriptionKey)})]})]}),u.jsx("button",{type:"button",onClick:b,className:`
            px-3 py-1 text-xs font-medium rounded-full transition-colors
            ${e.enabled?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}
          `,children:e.enabled?i("sections.shortcuts.enabled"):i("sections.shortcuts.disabled")})]}),u.jsxs("div",{className:"space-y-2",children:[e.shortcuts.length===0?u.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 italic",children:i("sections.shortcuts.noShortcuts")}):e.shortcuts.map((v,w)=>u.jsxs("div",{children:[u.jsx($E,{value:v,onChange:S=>y(w,S),onRemove:()=>m(w),error:o[w],namespace:"settings"}),o[w]&&u.jsx("p",{className:"mt-1 text-xs text-red-500",children:o[w]})]},w)),u.jsxs("button",{type:"button",onClick:g,className:"flex items-center gap-2 text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 mt-2",children:[u.jsx(Xt,{size:16}),i("sections.shortcuts.addShortcut")]})]})]})}function An({options:t,value:e,onChange:n,onCreateNew:r,placeholder:s="Select...",createNewLabel:i="Create",disabled:o=!1,allowClear:l=!0,className:d=""}){const[f,p]=C.useState(!1),[g,m]=C.useState(""),[y,b]=C.useState(!1),[v,w]=C.useState({left:0,width:0,openUpward:!1}),S=C.useRef(null),T=C.useRef(null),j=C.useRef(null),M=C.useRef(null),_=t.find(P=>P.value===e),R=t.filter(P=>P.label.toLowerCase().includes(g.toLowerCase())),O=r&&g.trim().length>0&&!t.some(P=>P.label.toLowerCase()===g.toLowerCase());C.useEffect(()=>{function P(B){const E=B.target,K=S.current&&!S.current.contains(E),q=j.current&&!j.current.contains(E);K&&q&&(p(!1),m(""))}return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]),C.useEffect(()=>{f&&M.current&&M.current.focus()},[f]),C.useEffect(()=>{if(f&&T.current){const P=T.current.getBoundingClientRect(),B=250,E=window.innerHeight-P.bottom,K=P.top,q=E<B&&K>E;w(q?{bottom:window.innerHeight-P.top+4,left:P.left+window.scrollX,width:P.width,openUpward:!0}:{top:P.bottom+window.scrollY+4,left:P.left+window.scrollX,width:P.width,openUpward:!1})}},[f]);const L=P=>{n(P.value),p(!1),m("")},A=P=>{P.stopPropagation(),n(null)},F=async()=>{if(!(!r||!g.trim())){b(!0);try{const P=await r(g.trim());P&&(n(P.value),p(!1),m(""))}finally{b(!1)}}},H=P=>{P.key==="Escape"?(p(!1),m("")):P.key==="Enter"&&O&&(P.preventDefault(),F())};return u.jsxs("div",{ref:S,className:`relative ${d}`,children:[u.jsxs("button",{ref:T,type:"button",onClick:()=>!o&&p(!f),disabled:o,className:"w-full flex items-center justify-between gap-2 px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-left text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[u.jsx("span",{className:_?"":"text-gray-400 dark:text-gray-500",children:_?.label||s}),u.jsxs("div",{className:"flex items-center gap-1",children:[l&&_&&u.jsx(nt,{className:"w-4 h-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",onClick:A}),u.jsx(Ms,{className:`w-4 h-4 text-gray-400 transition-transform ${f?"rotate-180":""}`})]})]}),f&&ta.createPortal(u.jsxs("div",{ref:j,className:"fixed z-[9999] bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg overflow-hidden",style:{...v.openUpward?{bottom:v.bottom}:{top:v.top},left:v.left,width:v.width},children:[u.jsx("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:u.jsx("input",{ref:M,type:"text",value:g,onChange:P=>m(P.target.value),onKeyDown:H,placeholder:"Search...",className:"w-full px-2 py-1 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded text-sm text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-indigo-500"})}),u.jsxs("div",{className:"max-h-48 overflow-y-auto",children:[O&&u.jsxs("button",{type:"button",onClick:F,disabled:y,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-indigo-600 dark:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 disabled:opacity-50",children:[u.jsx(Xt,{className:"w-4 h-4"}),i,' "',g,'"']}),R.length===0&&!O?u.jsx("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:"No options found"}):R.map(P=>u.jsxs("button",{type:"button",onClick:()=>L(P),className:`w-full flex items-center justify-between px-3 py-2 text-sm text-left hover:bg-gray-100 dark:hover:bg-gray-700 ${P.value===e?"bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-400":"text-gray-900 dark:text-white"}`,children:[P.label,P.value===e&&u.jsx(jb,{className:"w-4 h-4"})]},P.value))]})]}),document.body)]})}function qz(){const{t}=ke("settings"),e=Oz(),n=C.useMemo(()=>e.inputDevices.map(o=>({value:o.id,label:o.manufacturer&&o.manufacturer!=="Unknown"?`${o.name} (${o.manufacturer})`:o.name})),[e.inputDevices]),r=C.useMemo(()=>e.outputDevices.map(o=>({value:o.id,label:o.manufacturer&&o.manufacturer!=="Unknown"?`${o.name} (${o.manufacturer})`:o.name})),[e.outputDevices]),s=()=>{!e.hasPermission&&!e.isEnabled?e.requestAccess().then(o=>{o&&e.setEnabled(!0)}):e.setEnabled(!e.isEnabled)},i=()=>{e.requestAccess()};return e.isSupported?u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:u.jsx(DD,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t("sections.shortcuts.midi.title",{defaultValue:"MIDI Controller"})}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t("sections.shortcuts.midi.description",{defaultValue:"Use hardware MIDI controllers for shortcuts with LED feedback"})})]})]}),u.jsx("button",{type:"button",onClick:s,className:`
            relative inline-flex h-6 w-11 items-center rounded-full transition-colors
            ${e.isEnabled?"bg-purple-600":"bg-gray-200 dark:bg-gray-700"}
          `,role:"switch","aria-checked":e.isEnabled,children:u.jsx("span",{className:`
              inline-block h-4 w-4 transform rounded-full bg-white transition-transform
              ${e.isEnabled?"translate-x-6":"translate-x-1"}
            `})})]}),e.permissionError&&u.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:u.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:t("sections.shortcuts.midi.permissionError",{defaultValue:"MIDI access denied: {{error}}",error:e.permissionError})})}),e.isEnabled&&e.hasPermission&&u.jsxs("div",{className:"space-y-3 pl-10",children:[u.jsx("div",{className:"flex justify-end",children:u.jsxs("button",{type:"button",onClick:i,className:"flex items-center gap-1.5 px-2 py-1 text-xs text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:[u.jsx(Ab,{className:"w-3 h-3"}),t("sections.shortcuts.midi.refresh",{defaultValue:"Refresh devices"})]})}),u.jsxs("div",{className:"space-y-1.5",children:[u.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[u.jsx(k6,{className:"w-4 h-4"}),t("sections.shortcuts.midi.inputDevice",{defaultValue:"Input Device"})]}),u.jsx(An,{options:n,value:e.selectedInputId,onChange:o=>e.selectInputDevice(o),placeholder:t("sections.shortcuts.midi.selectDevice",{defaultValue:"Select device..."}),allowClear:!0}),e.inputDevices.length===0&&u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t("sections.shortcuts.midi.noInputDevices",{defaultValue:"No MIDI input devices detected"})})]}),u.jsxs("div",{className:"space-y-1.5",children:[u.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[u.jsx(Jj,{className:"w-4 h-4"}),t("sections.shortcuts.midi.outputDevice",{defaultValue:"Output Device (LEDs)"})]}),u.jsx(An,{options:r,value:e.selectedOutputId,onChange:o=>e.selectOutputDevice(o),placeholder:t("sections.shortcuts.midi.selectDevice",{defaultValue:"Select device..."}),allowClear:!0}),e.outputDevices.length===0&&u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t("sections.shortcuts.midi.noOutputDevices",{defaultValue:"No MIDI output devices detected"})})]}),(e.selectedInputId||e.selectedOutputId)&&u.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${e.selectedInputId&&e.selectedOutputId?"bg-green-500":"bg-yellow-500"}`}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.selectedInputId&&e.selectedOutputId?t("sections.shortcuts.midi.fullyConnected",{defaultValue:"Input and output connected"}):e.selectedInputId?t("sections.shortcuts.midi.inputOnly",{defaultValue:"Input connected (no LED feedback)"}):t("sections.shortcuts.midi.outputOnly",{defaultValue:"Output connected (no triggers)"})})]})]}),e.isEnabled&&!e.hasPermission&&!e.permissionError&&u.jsx("div",{className:"pl-10",children:u.jsx("button",{type:"button",onClick:()=>e.requestAccess(),className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors",children:t("sections.shortcuts.midi.requestPermission",{defaultValue:"Grant MIDI Access"})})})]}):u.jsx("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:u.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:t("sections.shortcuts.midi.notSupported",{defaultValue:"Web MIDI API is not supported in this browser. MIDI controller features are unavailable."})})})}function Hz({children:t}){const{midiConfig:e,updateMIDIConfig:n,isLoading:r}=Hb(),s=C.useCallback(i=>{n(i)},[n]);return r?u.jsx(u.Fragment,{children:t}):u.jsx(PE,{initialConfig:e,onConfigChange:s,children:t})}const Vz=[{id:"startLive",labelKey:"sections.shortcuts.actions.startLive.label",descriptionKey:"sections.shortcuts.actions.startLive.description",icon:Mb},{id:"stopLive",labelKey:"sections.shortcuts.actions.stopLive.label",descriptionKey:"sections.shortcuts.actions.stopLive.description",icon:tE},{id:"searchSong",labelKey:"sections.shortcuts.actions.searchSong.label",descriptionKey:"sections.shortcuts.actions.searchSong.description",icon:ya},{id:"searchBible",labelKey:"sections.shortcuts.actions.searchBible.label",descriptionKey:"sections.shortcuts.actions.searchBible.description",icon:Lp}];function Kz(){const{t}=ke("settings"),{shortcuts:e,isLoading:n,updateActionShortcuts:r}=Hb(),{scenes:s}=Ub(),i=C.useMemo(()=>s?s.map(l=>({displayName:l.displayName,shortcuts:l.shortcuts||[]})):[],[s]),o=(l,d)=>{r(l,d)};return n?u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(z2,{size:24,className:"text-indigo-600 dark:text-indigo-400"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.shortcuts.title")})]}),u.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3,4].map(l=>u.jsx("div",{className:"h-32 bg-gray-100 dark:bg-gray-800 rounded-lg"},l))})]}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(z2,{size:24,className:"text-indigo-600 dark:text-indigo-400"}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.shortcuts.title")}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("sections.shortcuts.description")})]})]}),u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:u.jsx(qz,{})}),u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 space-y-3",children:Vz.map(l=>u.jsx($z,{action:l,config:e.actions[l.id],allShortcuts:e,scenes:i,onUpdate:d=>o(l.id,d)},l.id))})]})}const Qz=typeof window<"u"&&"__TAURI_INTERNALS__"in window,cd=Qz&&pn()?hi:window.fetch.bind(window);function ud(t){const e={};if(t&&(e["Content-Type"]=t),pn()){const n=Xl();n&&(e.Cookie=`user_auth=${n}`)}return e}async function Wz(){const t=await cd(`${Ct()}/api/screens`,{credentials:"include",headers:ud()});if(!t.ok)throw new Error("Failed to fetch screens");return(await t.json()).data}async function Yz(t){const e=await cd(`${Ct()}/api/screens/${t}`,{credentials:"include",headers:ud()});if(!e.ok)throw new Error("Failed to fetch screen");return(await e.json()).data}async function Gz(t){`${t.name}`;const e=await cd(`${Ct()}/api/screens`,{method:"POST",headers:ud("application/json"),body:JSON.stringify(t),credentials:"include"});if(!e.ok)throw new Error("Failed to save screen");return(await e.json()).data}async function Xz(t){if(!(await cd(`${Ct()}/api/screens/${t}`,{method:"DELETE",headers:ud(),credentials:"include"})).ok)throw new Error("Failed to delete screen")}async function Jz(t,e,n,r){const s=await cd(`${Ct()}/api/screens/${t}/batch-config`,{method:"PUT",headers:ud("application/json"),body:JSON.stringify({globalSettings:e,contentConfigs:n,nextSlideConfig:r}),credentials:"include"});if(!s.ok)throw new Error("Failed to batch update screen config");return(await s.json()).data}const Qb=["screens"];function Wb(){return lt({queryKey:Qb,queryFn:Wz})}function Zz(){const t=navigator.userAgent.toLowerCase(),e=navigator.platform.toLowerCase();return e.includes("win")||t.includes("windows")?"windows":e.includes("mac")||t.includes("macintosh")||t.includes("mac os")?"macos":e.includes("linux")||t.includes("linux")?"linux":"unknown"}async function Lh(t,e){const n=Zz();console.log(`[setWindowFullscreen] Platform: ${n}, setting fullscreen: ${e}`);const r=async()=>{try{return await new Promise(o=>setTimeout(o,100)),await t.isFullscreen()===e}catch{return!1}},s=async()=>{try{const i=await t.isMaximized();return e?i:!i}catch{return!1}};try{if(console.log("[setWindowFullscreen] Trying win.setFullscreen()..."),await t.setFullscreen(e),await r())return console.log(`[setWindowFullscreen] setFullscreen(${e}) succeeded!`),!0;console.log("[setWindowFullscreen] setFullscreen did not achieve desired state")}catch(i){console.error("[setWindowFullscreen] setFullscreen threw error:",i)}if(n==="macos")try{return console.log("[setWindowFullscreen] Trying macOS setSimpleFullscreen..."),await t.setSimpleFullscreen(e),console.log(`[setWindowFullscreen] setSimpleFullscreen(${e}) called`),!0}catch(i){console.error("[setWindowFullscreen] setSimpleFullscreen failed:",i)}else if(n==="windows")try{if(console.log("[setWindowFullscreen] Trying Windows maximize+decorations fallback..."),e?(await t.setDecorations(!1),await t.maximize()):(await t.unmaximize(),await t.setDecorations(!0)),await s())return console.log("[setWindowFullscreen] Windows fallback succeeded!"),!0;console.log("[setWindowFullscreen] Windows fallback did not achieve desired state")}catch(i){console.error("[setWindowFullscreen] Windows fallback failed:",i)}return console.error(`[setWindowFullscreen] All Tauri methods failed for platform: ${n}`),!1}const qE="display-window-positions";function sn(){const t="__TAURI_INTERNALS__"in window,e="__TAURI__"in window;return console.log("[isTauri] __TAURI_INTERNALS__:",t,"__TAURI__:",e),t||e}function Sx(){return sn()?"http://localhost:3000":window.location.origin}function eP(t,e){try{const n=HE();n[t]=e,localStorage.setItem(qE,JSON.stringify(n))}catch(n){console.error("[saveWindowState] Failed to save window state:",n)}}function HE(){try{const t=localStorage.getItem(qE);return t?JSON.parse(t):{}}catch{return{}}}function tP(t){return HE()[t]||null}async function VE(t,e,n=!1,r){console.log(`[openDisplayWindow] Opening display ${t} in ${e} mode, isTauri: ${sn()}, defaultFullscreen: ${n}`);const s=`${Sx()}/screen/${t}`;console.log(`[openDisplayWindow] URL: ${s}`),console.log("[openDisplayWindow] Opening in native mode"),await rP(t,s,n,r)}async function nP(t){if(console.log(`[openInBrowser] called, isTauri: ${sn()}`),sn())try{console.log("[openInBrowser] Importing @tauri-apps/plugin-shell");const{open:e}=await Cn(async()=>{const{open:n}=await import("./index-DloC2wOa.js");return{open:n}},[]);console.log("[openInBrowser] Calling shell.open()"),await e(t),console.log("[openInBrowser] shell.open() completed")}catch(e){console.error("[openInBrowser] Failed to open in browser via Tauri:",e),window.open(t,"_blank")}else console.log("[openInBrowser] Opening via window.open"),window.open(t,"_blank")}async function rP(t,e,n=!1,r){if(console.log(`[openInNativeWindow] called, isTauri: ${sn()}`),sn())try{console.log("[openInNativeWindow] Importing @tauri-apps/api/webviewWindow");const{WebviewWindow:s}=await Cn(async()=>{const{WebviewWindow:p}=await import("./webviewWindow-BLpYegvH.js");return{WebviewWindow:p}},__vite__mapDeps([0,1,2,3]));console.log("[openInNativeWindow] WebviewWindow imported:",s);const i=`display-${t}`;console.log(`[openInNativeWindow] Window label: ${i}`),console.log("[openInNativeWindow] Checking for existing window");const o=await s.getByLabel(i);if(console.log("[openInNativeWindow] existingWindow:",o),o){console.log("[openInNativeWindow] Window exists, focusing"),await o.setFocus(),await o.setAlwaysOnTop(!0);return}const l=tP(t);console.log("[openInNativeWindow] Stored state:",l);const d={url:e,title:r||`Display ${t}`,width:l?.width??1280,height:l?.height??720,x:l?.x,y:l?.y,center:!l,resizable:!0,maximizable:!0,minimizable:!0,decorations:!0,alwaysOnTop:!0,skipTaskbar:!0,focus:!0};console.log("[openInNativeWindow] Creating window with options:",d);const f=new s(i,d);console.log("[openInNativeWindow] WebviewWindow constructor called, webview:",f),f.once("tauri://created",async()=>{console.log(`[openInNativeWindow] Native window created: ${i}`),await new Promise(m=>setTimeout(m,100));const p=await s.getByLabel(i);if(!p){console.error("[openInNativeWindow] Could not get window by label");return}l?.fullscreen?(console.log("[openInNativeWindow] Restoring fullscreen state"),await Lh(p,!0)):l?.maximized?(console.log("[openInNativeWindow] Restoring maximized state"),await p.maximize()):!l&&n&&(console.log("[openInNativeWindow] Applying default fullscreen setting"),await Lh(p,!0));const g=async()=>{try{const m=await s.getByLabel(i);if(m){const y=await m.outerPosition(),b=await m.outerSize(),v=await m.isMaximized(),w=await m.isFullscreen();eP(t,{x:y.x,y:y.y,width:b.width,height:b.height,maximized:v,fullscreen:w})}}catch{}};f.listen("tauri://move",g),f.listen("tauri://resize",g)}),f.once("tauri://error",p=>{console.error("[openInNativeWindow] tauri://error event:",p)}),console.log("[openInNativeWindow] Event listeners attached")}catch(s){console.error("[openInNativeWindow] Error opening native window:",s),console.log("[openInNativeWindow] Falling back to browser window.open"),window.open(e,"_blank")}else console.log("[openInNativeWindow] Not in Tauri, falling back to browser"),window.open(e,"_blank")}async function vC(t){if(console.log(`[closeDisplayWindow] Closing display ${t}, isTauri: ${sn()}`),!!sn())try{const{WebviewWindow:e}=await Cn(async()=>{const{WebviewWindow:s}=await import("./webviewWindow-BLpYegvH.js");return{WebviewWindow:s}},__vite__mapDeps([0,1,2,3])),n=`display-${t}`;console.log(`[closeDisplayWindow] Looking for window: ${n}`);const r=await e.getByLabel(n);console.log(`[closeDisplayWindow] Window found: ${!!r}`),r?(await r.close(),console.log("[closeDisplayWindow] Window closed successfully")):console.warn(`[closeDisplayWindow] Window not found: ${n}`)}catch(e){console.error("[closeDisplayWindow] Failed to close display window:",e)}}async function sP(t){const e=t.filter(n=>n.isActive);for(const n of e)await VE(n.id,"native",n.isFullscreen,n.name),await new Promise(r=>setTimeout(r,100))}const iP=ec("app:screen");function aP(){const{data:t,isSuccess:e}=Wb(),n=C.useRef(!1);C.useEffect(()=>{n.current||!e||!t||!sn()||(n.current=!0,sP(t).catch(r=>{iP.error("Failed to auto-open screens:",r)}))},[t,e])}function oP(){return De({mutationFn:({screenId:t,globalSettings:e,contentConfigs:n,nextSlideConfig:r})=>Jz(t,e,n,r)})}function lP(){const t=Le();return De({mutationFn:Xz,onSuccess:()=>{t.invalidateQueries({queryKey:Qb})}})}function cP(){const{data:t}=mi(),e=KE(),n=qp(),r=Yb(),s=!!t?.currentQueueItemId||!!t?.currentSongSlideId;C.useEffect(()=>{const i=o=>{if(!(o.target instanceof HTMLInputElement||o.target instanceof HTMLTextAreaElement||o.target instanceof HTMLSelectElement||o.target instanceof HTMLElement&&o.target.isContentEditable||document.querySelector("dialog[open]")))switch(o.key){case"ArrowRight":case"ArrowDown":case" ":case"PageDown":o.preventDefault(),s&&e.mutate("next");break;case"ArrowLeft":case"ArrowUp":case"PageUp":o.preventDefault(),s&&e.mutate("prev");break;case"Escape":o.preventDefault(),n.mutate();break;case"F5":case"F10":case"Enter":o.preventDefault(),r.mutate();break}};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[s,e,n,r])}const uP=typeof window<"u"&&"__TAURI_INTERNALS__"in window,pi=uP&&pn()?hi:window.fetch.bind(window);function gi(t){const e={};if(t&&(e["Content-Type"]=t),pn()){const n=Xl();n&&(e.Cookie=`user_auth=${n}`)}return e}async function dP(){const t=await pi(`${Ct()}/api/presentation/state`,{credentials:"include",headers:gi()});if(!t.ok)throw new Error("Failed to fetch presentation state");return(await t.json()).data}async function fP(t){const e=await pi(`${Ct()}/api/presentation/state`,{method:"PUT",headers:gi("application/json"),body:JSON.stringify(t),credentials:"include"});if(!e.ok)throw new Error("Failed to update presentation state");return(await e.json()).data}async function hP(){const t=await pi(`${Ct()}/api/presentation/clear`,{method:"POST",headers:gi(),credentials:"include"});if(!t.ok)throw new Error("Failed to clear slide");return(await t.json()).data}async function pP(){const t=await pi(`${Ct()}/api/presentation/show`,{method:"POST",headers:gi(),credentials:"include"});if(!t.ok)throw new Error("Failed to show slide");return(await t.json()).data}async function gP(t){const e=await pi(`${Ct()}/api/presentation/navigate-queue`,{method:"POST",headers:gi("application/json"),body:JSON.stringify({direction:t}),credentials:"include"});if(!e.ok)throw new Error("Failed to navigate queue");return(await e.json()).data}async function mP(t){const e=await pi(`${Ct()}/api/presentation/temporary-bible`,{method:"POST",headers:gi("application/json"),body:JSON.stringify(t),credentials:"include"});if(!e.ok)throw new Error("Failed to present temporary Bible verse");return(await e.json()).data}async function yP(t){const e=await pi(`${Ct()}/api/presentation/temporary-song`,{method:"POST",headers:gi("application/json"),body:JSON.stringify(t),credentials:"include"});if(!e.ok)throw new Error("Failed to present temporary song");return(await e.json()).data}async function xP(t){const e=await pi(`${Ct()}/api/presentation/navigate-temporary`,{method:"POST",headers:gi("application/json"),body:JSON.stringify({direction:t.direction}),credentials:"include"});if(!e.ok)throw new Error("Failed to navigate temporary content");return(await e.json()).data}async function bP(){const t=await pi(`${Ct()}/api/presentation/clear-temporary`,{method:"POST",headers:gi(),credentials:"include"});if(!t.ok)throw new Error("Failed to clear temporary content");return(await t.json()).data}const Rs=["presentation","state"];function mi(){return lt({queryKey:Rs,queryFn:dP,refetchInterval:1e4,refetchOnWindowFocus:!0})}function qp(){const t=Le();return De({mutationFn:hP,onSuccess:e=>{t.setQueryData(Rs,e)}})}function Yb(){const t=Le();return De({mutationFn:pP,onSuccess:e=>{t.setQueryData(Rs,e)}})}function vP(){const t=Le();return De({mutationFn:fP,onSuccess:e=>{t.setQueryData(Rs,e)}})}function KE(){const t=Le();return De({mutationFn:gP,onSuccess:e=>{t.setQueryData(Rs,e)}})}function wP(){const t=Le();return De({mutationFn:mP,onSuccess:e=>{t.setQueryData(Rs,e)}})}function QE(){const t=Le();return De({mutationFn:yP,onSuccess:e=>{t.setQueryData(Rs,e)}})}function WE(){const t=Le();return De({mutationFn:xP,onSuccess:e=>{t.setQueryData(Rs,e)}})}function YE(){const t=Le();return De({mutationFn:bP,onSuccess:e=>{t.setQueryData(Rs,e)}})}function Fu(t){return["screens",t]}function Gb(t){return lt({queryKey:Fu(t??0),queryFn:()=>Yz(t),enabled:t!=null})}function GE(){const t=Le();return De({mutationFn:Gz,onSuccess:e=>{t.invalidateQueries({queryKey:Qb}),e?.id&&t.invalidateQueries({queryKey:Fu(e.id)})}})}function rr(t,e){t!=="debug"&&console.log(`[${t.toUpperCase()}] [websocket] ${e}`)}function tc(){const t=Le(),e=C.useRef(null),n=C.useRef(null),r=C.useRef(null),[s,i]=C.useState("disconnected"),o=C.useCallback(()=>{if(e.current?.readyState===WebSocket.OPEN)return;let f=Aj();if(!f){const p=Ct();if(!p){rr("error","No API URL configured"),i("error");return}f=p.replace(/^http/,"ws")}if(f=f+"/ws",pn()){const p=Xl();p&&(f=`${f}?token=${encodeURIComponent(p)}`)}rr("debug",`Connecting to ${f}`),i("connecting");try{const p=new WebSocket(f);e.current=p,p.onopen=()=>{rr("info","WebSocket connected"),i("connected"),r.current=setInterval(()=>{p.readyState===WebSocket.OPEN&&p.send(JSON.stringify({type:"ping"}))},3e4)},p.onmessage=g=>{try{const m=JSON.parse(g.data);if(m.type==="pong"){rr("debug","Received pong");return}m.type==="presentation_state"&&(rr("debug","Received presentation state update"),t.setQueryData(Rs,m.payload)),m.type==="screen_config_updated"&&(rr("debug",`Received screen config update for screen ${m.payload.screenId}`),t.invalidateQueries({queryKey:Fu(m.payload.screenId)})),m.type==="screen_config_preview"&&(rr("debug",`Received screen config preview for screen ${m.payload.screenId}`),t.setQueryData(Fu(m.payload.screenId),m.payload.config))}catch(m){rr("error",`Failed to parse message: ${m}`)}},p.onerror=g=>{rr("error",`WebSocket error: ${g}`),i("error"),n.current||(n.current=setTimeout(()=>{rr("debug","Attempting reconnect after error..."),o()},3e3))},p.onclose=()=>{rr("info","WebSocket disconnected"),i("disconnected"),r.current&&(clearInterval(r.current),r.current=null),n.current&&(clearTimeout(n.current),n.current=null),n.current=setTimeout(()=>{rr("debug","Attempting reconnect..."),o()},3e3)}}catch(p){rr("error",`Failed to connect: ${p}`),i("error"),n.current=setTimeout(()=>{o()},5e3)}},[t]),l=C.useCallback(()=>{n.current&&(clearTimeout(n.current),n.current=null),r.current&&(clearInterval(r.current),r.current=null),e.current&&(e.current.close(),e.current=null)},[]),d=C.useCallback(f=>e.current?.readyState===WebSocket.OPEN?(e.current.send(JSON.stringify(f)),!0):(rr("error","Cannot send message: WebSocket not connected"),!1),[]);return C.useEffect(()=>(o(),()=>{l()}),[o,l]),{status:s,connect:o,disconnect:l,send:d}}function XE({isOpen:t,title:e,message:n,onClose:r,variant:s="info"}){const{t:i}=ke(),o=C.useRef(null);C.useEffect(()=>{const p=o.current;p&&(t?p.showModal():p.close())},[t]);const l={error:"text-red-500",warning:"text-yellow-500",info:"text-blue-500"}[s],d={error:"bg-red-600 hover:bg-red-700",warning:"bg-yellow-600 hover:bg-yellow-700",info:"bg-indigo-600 hover:bg-indigo-700"}[s],f=p=>{p.target===o.current&&r()};return u.jsx("dialog",{ref:o,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:r,onClick:f,children:u.jsxs("div",{className:"p-6 min-w-[300px] max-w-md",children:[u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsxs("div",{className:`flex-shrink-0 ${l}`,children:[s==="error"&&u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s==="warning"&&u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s==="info"&&u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:e}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:n})]})]}),u.jsx("div",{className:"flex justify-end mt-6",children:u.jsx("button",{type:"button",onClick:r,className:`px-4 py-2 rounded-lg font-medium text-white transition-colors ${d}`,children:i("common:buttons.ok")})})]})})}function fi({isOpen:t,title:e,message:n,confirmLabel:r,cancelLabel:s,onConfirm:i,onCancel:o,variant:l="default"}){const{t:d}=ke(),f=C.useRef(null);C.useEffect(()=>{const m=f.current;m&&(t?m.showModal():m.close())},[t]);const p=l==="danger"?"bg-red-600 hover:bg-red-700 text-white":"bg-indigo-600 hover:bg-indigo-700 text-white",g=m=>{m.target===f.current&&o()};return u.jsx("dialog",{ref:f,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:o,onClick:g,children:u.jsxs("div",{className:"p-6 min-w-[300px] max-w-md",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:e}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:n}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:s??d("common:buttons.cancel")}),u.jsx("button",{type:"button",onClick:i,className:`px-4 py-2 rounded-lg font-medium transition-colors ${p}`,children:r})]})]})})}function SP({category:t,onEdit:e,onDelete:n}){const{t:r}=ke("settings");return u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white truncate block",children:t.name}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[r("sections.categories.value"),": ",t.priority]})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{type:"button",onClick:e,className:"p-2 text-gray-500 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors",title:r("sections.categories.actions.edit"),children:u.jsx(to,{size:16})}),u.jsx("button",{type:"button",onClick:n,className:"p-2 text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors",title:r("sections.categories.actions.delete"),children:u.jsx(Fn,{size:16})})]})]})}function kP({isOpen:t,category:e,onSubmit:n,onCancel:r,isLoading:s}){const{t:i}=ke("settings"),o=C.useRef(null),l=C.useRef(null),[d,f]=C.useState(e?.name??""),[p,g]=C.useState(e?.priority??1);C.useEffect(()=>{t?(o.current?.showModal(),l.current?.focus()):o.current?.close()},[t]),C.useEffect(()=>{f(e?.name??""),g(e?.priority??1)},[e]);const m=b=>{b.preventDefault(),d.trim()&&n(d.trim(),p)},y=b=>{b.target===o.current&&r()};return u.jsx("dialog",{ref:o,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-md w-full",onClose:r,onClick:y,children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:i(e?"sections.categories.modals.edit.title":"sections.categories.modals.create.title")}),u.jsx("button",{type:"button",onClick:r,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:u.jsx(nt,{size:20})})]}),u.jsxs("form",{onSubmit:m,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("sections.categories.categoryName")}),u.jsx("input",{ref:l,type:"text",value:d,onChange:b=>f(b.target.value),placeholder:i("sections.categories.categoryNamePlaceholder"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("sections.categories.value")}),u.jsx("input",{type:"number",min:1,value:p,onChange:b=>g(Number(b.target.value)||1),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:i("common:buttons.cancel","Cancel")}),u.jsx("button",{type:"submit",disabled:s||!d.trim(),className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors disabled:opacity-50",children:i(e?"sections.categories.modals.edit.submit":"sections.categories.modals.create.submit")})]})]})]})})}async function CP(){return(await Me("/api/categories")).data??[]}async function NP(t){const e=await Me("/api/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,category:e.data}}async function TP(t){return(await Me(`/api/categories/${t}`,{method:"DELETE"})).data?.success??!1}async function jP(){return(await Me("/api/songs")).data??[]}async function EP(t){return(await Me(`/api/songs/${t}`)).data??null}async function MP(t){const e=await Me("/api/songs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function AP(t){return(await Me(`/api/songs/${t}`,{method:"DELETE"})).data?.success??!1}async function RP(t){return(await Me(`/api/songs/search?q=${encodeURIComponent(t)}`)).data??[]}function Hp(){return lt({queryKey:["categories"],queryFn:CP})}function _P(){const t=Le();return De({mutationFn:TP,onSuccess:e=>{e&&t.invalidateQueries({queryKey:["categories"]})}})}function OP(){const t=Le();return De({mutationFn:AP,onSuccess:()=>{t.invalidateQueries({queryKey:["songs"]})}})}function IP(t,e){if(t.title!==e.title||t.categoryId!==e.categoryId||t.slides.length!==e.slides.length)return!1;for(let n=0;n<t.slides.length;n++)if(t.slides[n].content!==e.slides[n].content||t.slides[n].sortOrder!==e.slides[n].sortOrder)return!1;return!0}function DP(){const t=C.useRef(null),e=C.useCallback(s=>{t.current={title:s.title,categoryId:s.categoryId,slides:s.slides.map((i,o)=>({id:i.id,content:i.content,sortOrder:o}))}},[]),n=C.useCallback(s=>{if(!t.current)return!0;const i={title:s.title,categoryId:s.categoryId,slides:s.slides.map((o,l)=>({id:o.id,content:o.content,sortOrder:l}))};return!IP(i,t.current)},[]),r=C.useCallback(()=>{t.current=null},[]);return{setSavedState:e,isDirty:n,resetSavedState:r}}function LP(t){return lt({queryKey:["songs","search",t],queryFn:()=>RP(t),enabled:t.length>0})}function Xb(t){return lt({queryKey:["song",t],queryFn:()=>EP(t),enabled:t!==null})}function zP({onNextSlide:t,onPreviousSlide:e,onHidePresentation:n,enabled:r=!0}){C.useEffect(()=>{if(!r)return;const s=i=>{if(!(i.target instanceof HTMLInputElement||i.target instanceof HTMLTextAreaElement||i.target instanceof HTMLSelectElement))switch(i.key){case"ArrowDown":case"ArrowRight":i.preventDefault(),t();break;case"ArrowUp":case"ArrowLeft":i.preventDefault(),e();break;case"Escape":i.preventDefault(),n();break}};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[r,t,e,n])}function PP(){return lt({queryKey:["songs"],queryFn:jP})}function BP({isDirty:t}){const[e,n]=C.useState(!1),[r,s]=C.useState(null),{proceed:i,reset:o,status:l}=sI({condition:t});C.useEffect(()=>{l==="blocked"&&(n(!0),s(()=>i))},[l,i]),C.useEffect(()=>{const p=g=>{t&&(g.preventDefault(),g.returnValue="")};return window.addEventListener("beforeunload",p),()=>window.removeEventListener("beforeunload",p)},[t]);const d=C.useCallback(()=>{n(!1),s(null),o?.()},[o]),f=C.useCallback(()=>{n(!1),r?.(),s(null)},[r]);return{showModal:e,handleCancel:d,handleDiscard:f}}function Jb(){const t=Le();return De({mutationFn:e=>NP(e),onSuccess:e=>{e.success&&t.invalidateQueries({queryKey:["categories"]})}})}function Zb(){const t=Le();return De({mutationFn:e=>MP(e),onSuccess:e=>{e.success&&(t.invalidateQueries({queryKey:["songs"]}),e.id&&t.invalidateQueries({queryKey:["song",e.id]}))}})}function FP(){const{t}=ke("settings"),{showToast:e}=mt(),{data:n,isLoading:r,error:s}=Hp(),i=Jb(),o=_P(),[l,d]=C.useState({type:"none"}),f=async(m,y)=>{(await i.mutateAsync({name:m,priority:y})).success?(d({type:"none"}),e(t("sections.categories.toast.created"),"success")):e(t("sections.categories.toast.error"),"error")},p=async(m,y)=>{if(l.type!=="edit")return;(await i.mutateAsync({id:l.category.id,name:m,priority:y})).success?(d({type:"none"}),e(t("sections.categories.toast.updated"),"success")):e(t("sections.categories.toast.error"),"error")},g=async()=>{if(l.type!=="delete")return;await o.mutateAsync(l.category.id)?(d({type:"none"}),e(t("sections.categories.toast.deleted"),"success")):e(t("sections.categories.toast.error"),"error")};return r?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s?u.jsx("div",{className:"text-center py-8 text-red-500",children:t("sections.categories.toast.error")}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.categories.title")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("sections.categories.description")})]}),u.jsxs("button",{type:"button",onClick:()=>d({type:"create"}),className:"flex items-center gap-2 px-3 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors text-sm whitespace-nowrap shrink-0",children:[u.jsx(Xt,{size:16}),t("sections.categories.addCategory")]})]}),n&&n.length>0?u.jsx("div",{className:"space-y-2",children:n.map(m=>u.jsx(SP,{category:m,onEdit:()=>d({type:"edit",category:m}),onDelete:()=>d({type:"delete",category:m})},m.id))}):u.jsxs("div",{className:"text-center py-12 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx(zj,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:t("sections.categories.noCategories")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:t("sections.categories.noCategoriesDescription")})]}),(l.type==="create"||l.type==="edit")&&u.jsx(kP,{isOpen:!0,category:l.type==="edit"?l.category:void 0,onSubmit:l.type==="create"?f:p,onCancel:()=>d({type:"none"}),isLoading:i.isPending}),l.type==="delete"&&u.jsx(fi,{isOpen:!0,title:t("sections.categories.modals.delete.title"),message:t("sections.categories.modals.delete.message",{name:l.category.name}),confirmLabel:t("sections.categories.modals.delete.confirm"),cancelLabel:t("common:buttons.cancel","Cancel"),onConfirm:g,onCancel:()=>d({type:"none"}),variant:"danger"})]})}function Vp({value:t,onChange:e,disabled:n}){const{t:r}=ke("songs"),{data:s}=Hp(),i=Jb(),o=C.useMemo(()=>s?.map(d=>({value:d.id,label:d.name}))??[],[s]),l=async d=>{const f=await i.mutateAsync({name:d});return f.success&&f.category?{value:f.category.id,label:f.category.name}:null};return u.jsx(An,{options:o,value:t,onChange:d=>e(d),onCreateNew:l,placeholder:r("editor.categoryPlaceholder"),createNewLabel:r("category.create"),disabled:n})}function UP({isOpen:t,onClose:e,onImport:n}){const{t:r}=ke("songs"),[s,i]=C.useState(""),o=C.useRef(null);C.useEffect(()=>{const g=o.current;g&&(t?g.showModal():g.close())},[t]);const l=C.useMemo(()=>s.trim()?s.split(/\n\s*\n/).map(g=>g.trim()).filter(g=>g.length>0).map(g=>g.split(`
`).map(y=>`<p>${y}</p>`).join("")):[],[s]),d=()=>{l.length>0&&(n(l),i(""),e())},f=()=>{i(""),e()},p=g=>{g.target===o.current&&f()};return u.jsx("dialog",{ref:o,className:"fixed inset-0 p-0 m-auto w-full max-w-lg bg-transparent backdrop:bg-black/50",onClose:f,onClick:p,children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[u.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(fs,{className:"w-5 h-5 text-indigo-500"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r("import.title")})]}),u.jsx("button",{type:"button",onClick:f,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",children:u.jsx(nt,{className:"w-5 h-5 text-gray-500"})})]}),u.jsxs("div",{className:"p-4 space-y-4",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r("import.description")}),u.jsx("textarea",{value:s,onChange:g=>i(g.target.value),placeholder:r("import.placeholder"),rows:10,className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none font-mono text-sm"}),l.length>0&&u.jsx("p",{className:"text-sm text-indigo-600 dark:text-indigo-400",children:r("import.preview",{count:l.length})})]}),u.jsxs("div",{className:"flex justify-end gap-2 px-4 py-3 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:r("import.cancel")}),u.jsx("button",{type:"button",onClick:d,disabled:l.length===0,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:r("import.confirm")})]})]})})}function $P({song:t,onClick:e}){const n=t.highlightedTitle?.includes("<mark>");return u.jsxs("button",{type:"button",onClick:e,className:"w-full flex items-center justify-between p-4 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:border-indigo-300 dark:hover:border-indigo-600 hover:shadow-sm transition-all text-left group",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[n?u.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate [&_mark]:bg-yellow-300 [&_mark]:dark:bg-yellow-400/60 [&_mark]:rounded-sm [&_mark]:px-0.5",dangerouslySetInnerHTML:{__html:t.highlightedTitle}}):u.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.title}),t.categoryName&&u.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[u.jsx(p6,{className:"w-3 h-3 text-gray-400"}),u.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.categoryName})]}),t.matchedContent&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-2 [&_mark]:bg-yellow-300 [&_mark]:dark:bg-yellow-400/60 [&_mark]:rounded-sm [&_mark]:px-0.5",dangerouslySetInnerHTML:{__html:t.matchedContent}})]}),u.jsx(As,{className:"w-5 h-5 text-gray-400 group-hover:text-indigo-500 transition-colors flex-shrink-0 ml-2"})]})}function qP({isOpen:t,availableTranslations:e,onSubmit:n,onClose:r}){const{t:s}=ke("settings"),i=C.useRef(null),[o,l]=C.useState(null);C.useEffect(()=>{const g=i.current;g&&(t?(g.showModal(),l(null)):g.close())},[t]);const d=C.useMemo(()=>e.map(g=>({value:g.id,label:`${g.name} (${g.abbreviation})`})),[e]),f=()=>{o!==null&&(n(o),r())},p=g=>{g.target===i.current&&r()};return u.jsx("dialog",{ref:i,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:r,onClick:p,children:u.jsxs("div",{className:"p-6 min-w-[350px] max-w-md",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:s("sections.bible.modals.add.title")}),u.jsx("div",{className:"space-y-4 mb-6",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:s("sections.bible.modals.add.selectLabel")}),u.jsx(An,{options:d,value:o,onChange:g=>l(g),placeholder:s("sections.bible.modals.add.selectLabel"),allowClear:!1})]})}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:s("common:buttons.cancel",{defaultValue:"Cancel"})}),u.jsx("button",{type:"button",onClick:f,disabled:o===null,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:s("sections.bible.modals.add.submit")})]})]})})}function HP({onPrevVerse:t,onNextVerse:e,canNavigate:n}){const{t:r}=ke("bible");tc();const{data:s}=mi(),i=qp(),o=Yb(),l=s?.isHidden??!0,d=!!s?.currentSongSlideId||!!s?.currentQueueItemId||!!s?.lastSongSlideId,f=async()=>{(s?.lastSongSlideId||s?.currentQueueItemId)&&await o.mutateAsync()},p=async()=>{await i.mutateAsync()};return u.jsxs("div",{className:"flex flex-col lg:h-full bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 lg:p-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Mh,{size:18,className:"text-indigo-600 dark:text-indigo-400"}),u.jsx("h3",{className:"font-medium text-gray-900 dark:text-white text-sm lg:text-base",children:r("controls.title")})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-md ${l?"bg-gray-100 dark:bg-gray-700":"bg-red-100 dark:bg-red-900/30"}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${l?"bg-gray-400 dark:bg-gray-500":"bg-red-500 animate-pulse"}`}),u.jsx("span",{className:`text-xs font-semibold ${l?"text-gray-400 dark:text-gray-500":"text-red-600 dark:text-red-400"}`,children:"LIVE"})]}),l?u.jsxs("button",{type:"button",onClick:f,disabled:!d||o.isPending,className:"flex items-center gap-1.5 px-2 lg:px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 transition-colors",title:`${r("controls.show")} (F10)`,children:[o.isPending?u.jsx(Qe,{size:18,className:"animate-spin"}):u.jsx(pa,{size:18}),u.jsx("span",{className:"hidden sm:inline",children:r("controls.show")}),u.jsx("span",{className:"text-xs opacity-75 hidden sm:inline",children:"(F10)"})]}):u.jsxs("button",{type:"button",onClick:p,disabled:i.isPending,className:"flex items-center gap-1.5 px-2 lg:px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 transition-colors",title:`${r("controls.hide")} (Esc)`,children:[i.isPending?u.jsx(Qe,{size:18,className:"animate-spin"}):u.jsx(Jl,{size:18}),u.jsx("span",{className:"hidden sm:inline",children:r("controls.hide")}),u.jsx("span",{className:"text-xs opacity-75 hidden sm:inline",children:"(Esc)"})]})]})]}),u.jsxs("div",{className:"p-2 lg:p-3 lg:flex-1 lg:min-h-0 flex flex-col",children:[u.jsx("div",{className:"w-full lg:flex-1 lg:min-h-0 lg:flex lg:items-center lg:justify-center",children:u.jsx(n1,{})}),u.jsxs("div",{className:"flex items-center justify-center gap-2 pt-2 lg:pt-3 flex-shrink-0",children:[u.jsxs("button",{type:"button",onClick:t,disabled:!n,className:"flex items-center gap-1.5 px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",title:r("controls.prevVerse"),children:[u.jsx(Eb,{size:18}),u.jsx("span",{className:"text-sm",children:r("controls.prev")})]}),u.jsxs("button",{type:"button",onClick:e,disabled:!n,className:"flex items-center gap-1.5 px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",title:r("controls.nextVerse"),children:[u.jsx("span",{className:"text-sm",children:r("controls.next")}),u.jsx(Ms,{size:18})]})]})]})]})}const wC=39;function VP({books:t,isLoading:e,onSelectBook:n}){const{t:r}=ke("bible");if(e)return u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600 dark:text-indigo-400"})});if(t.length===0)return u.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:r("navigation.noBooks")});const s=t.filter(o=>o.bookOrder<=wC),i=t.filter(o=>o.bookOrder>wC);return u.jsxs("div",{className:"h-full overflow-y-auto space-y-4",children:[s.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-1",children:r("navigation.oldTestament")}),u.jsx("div",{className:"grid grid-cols-2 gap-1",children:s.map(o=>u.jsx("button",{type:"button",onClick:()=>n(o.id,o.bookName),className:"text-left px-2 py-1.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 rounded-md transition-colors truncate",children:o.bookName},o.id))})]}),i.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-1",children:r("navigation.newTestament")}),u.jsx("div",{className:"grid grid-cols-2 gap-1",children:i.map(o=>u.jsx("button",{type:"button",onClick:()=>n(o.id,o.bookName),className:"text-left px-2 py-1.5 text-sm text-gray-700 dark:text-gray-200 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 rounded-md transition-colors truncate",children:o.bookName},o.id))})]})]})}function KP({bookName:t,chapters:e,isLoading:n,onSelectChapter:r,onGoBack:s}){const{t:i}=ke("bible");return n?u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600 dark:text-indigo-400"})}):u.jsxs("div",{className:"space-y-3",children:[u.jsxs("button",{type:"button",onClick:s,className:"flex items-center gap-1.5 text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 transition-colors",children:[u.jsx(id,{size:16}),i("navigation.back")]}),u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t}),u.jsx("div",{className:"grid grid-cols-6 gap-1.5",children:e.map(o=>u.jsx("button",{type:"button",onClick:()=>r(o.chapter),className:"aspect-square flex items-center justify-center text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 hover:bg-indigo-100 dark:hover:bg-indigo-900/40 rounded-md transition-colors",children:o.chapter},o.chapter))})]})}function QP({results:t,isLoading:e,verseNumber:n}){if(e)return u.jsx("div",{className:"flex items-center justify-center py-4",children:u.jsx(Qe,{className:"w-4 h-4 animate-spin text-indigo-500"})});const r=t.filter(s=>s.verse!==null);return r.length===0||r.length===1?null:u.jsx("div",{className:"mt-2 space-y-2 pl-6 border-l-2 border-indigo-200 dark:border-indigo-700",children:r.map(({translation:s,verse:i})=>u.jsxs("div",{className:"text-sm",children:[u.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 mr-2",children:s.abbreviation}),u.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:i?.text})]},s.id))})}async function WP(){return(await Me("/api/bible/translations")).data}async function YP(t){return(await Me("/api/bible/translations",{method:"POST",body:JSON.stringify(t)})).data}async function GP(t){return(await Me(`/api/bible/books/${t}`)).data}async function XP(t){return(await Me(`/api/bible/chapters/${t}`)).data}async function JP(t,e){return(await Me(`/api/bible/verses/${t}/${e}`)).data}async function ZP(t){return(await Me(`/api/bible/verse/${t}`)).data}async function e8(t){try{return(await Me(`/api/bible/next-verse/${t}`)).data}catch{return null}}async function t8(t,e,n,r){try{return(await Me(`/api/bible/verse-by-reference/${t}/${e}/${n}/${r}`)).data}catch{return null}}async function n8(t,e,n){const r=new URLSearchParams({q:t});return e&&r.set("translationId",String(e)),r.set("limit",String(n)),(await Me(`/api/bible/search?${r.toString()}`)).data}function r8(t,e,n,r){const s=!!e&&!!n&&!!r,i=ez({queries:t.map(f=>({queryKey:["bible","verse-by-reference",f.id,e,n,r],queryFn:()=>t8(f.id,e,n,r),enabled:s,staleTime:600*1e3}))}),o=t.map((f,p)=>({translation:f,verse:i[p]?.data??null,isLoading:i[p]?.isLoading??!1,isError:i[p]?.isError??!1})),l=i.some(f=>f.isLoading),d=i.some(f=>f.isError);return{results:o,isLoading:l,isError:d}}const s8=100;function i8({bookName:t,bookCode:e,chapter:n,verses:r,presentedIndex:s,searchedIndex:i,isLoading:o,selectedTranslations:l,onSelectVerse:d,onGoBack:f}){const{t:p}=ke("bible"),g=C.useRef(null),m=C.useRef(null),y=s!==null?r[s]?.verse:void 0,b=l.slice(1),{results:v,isLoading:w}=r8(b,e,n,y),S=s??i,T=r[0]?.id;return C.useEffect(()=>{if(g.current&&m.current){const j=m.current,_=g.current.getBoundingClientRect(),R=j.getBoundingClientRect(),O=_.top-R.top+j.scrollTop,L=Math.max(0,O-s8);j.scrollTo({top:L,behavior:"smooth"})}},[S,T]),o?u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600 dark:text-indigo-400"})}):u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsxs("button",{type:"button",onClick:f,className:"flex items-center gap-1.5 text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 transition-colors",children:[u.jsx(id,{size:16}),p("navigation.back")]}),u.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t," ",n]})]}),u.jsx("div",{ref:m,className:"flex-1 min-h-0 space-y-1 overflow-y-auto px-0.5 py-0.5",children:r.map((j,M)=>{const _=M===s,R=M===i&&!_,O=_||R,L=()=>_?"bg-green-100 dark:bg-green-900/50 ring-2 ring-green-500":R?"bg-indigo-100 dark:bg-indigo-900/50 ring-2 ring-indigo-500":"hover:bg-gray-100 dark:hover:bg-gray-700",A=()=>_?"text-green-700 dark:text-green-300":R?"text-indigo-700 dark:text-indigo-300":"text-gray-500 dark:text-gray-400",F=()=>_?"text-green-900 dark:text-green-100":R?"text-indigo-900 dark:text-indigo-100":"text-gray-700 dark:text-gray-200";return u.jsxs("div",{children:[u.jsxs("button",{ref:O?g:null,type:"button",onClick:()=>d(M),className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${L()}`,children:[u.jsx("span",{className:`font-semibold mr-2 ${A()}`,children:j.verse}),u.jsx("span",{className:F(),children:j.text})]}),_&&b.length>0&&u.jsx(QP,{results:v,isLoading:w,verseNumber:j.verse})]},j.id)})})]})}function a8({onNextVerse:t,onPreviousVerse:e,onGoBack:n,onHidePresentation:r,onPresentSearched:s,enabled:i=!0}){C.useEffect(()=>{if(!i)return;const o=l=>{if(!(l.target instanceof HTMLInputElement||l.target instanceof HTMLTextAreaElement||l.target instanceof HTMLSelectElement))switch(l.key){case"ArrowDown":case"ArrowRight":l.preventDefault(),t();break;case"ArrowUp":case"ArrowLeft":l.preventDefault(),e();break;case"Backspace":l.preventDefault(),n();break;case"Escape":l.preventDefault(),r();break;case"Enter":s&&(l.preventDefault(),s());break}};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[i,t,e,n,r,s])}const H0={translationId:void 0,bookId:void 0,bookName:void 0,chapter:void 0,presentedIndex:null,searchedIndex:null,searchQuery:"",level:"books"};function o8(t){const[e,n]=C.useState({...H0,translationId:t}),r=C.useCallback(w=>{n(()=>({...H0,translationId:w}))},[]),s=C.useCallback((w,S,T=!0)=>{n(j=>({...j,bookId:w,bookName:S,chapter:void 0,presentedIndex:null,searchedIndex:null,level:"chapters",searchQuery:T?"":j.searchQuery}))},[]),i=C.useCallback(w=>{n(S=>({...S,chapter:w,presentedIndex:null,searchedIndex:null,level:"verses"}))},[]),o=C.useCallback(w=>{n(S=>({...S,presentedIndex:w}))},[]),l=C.useCallback(()=>{n(w=>({...w,presentedIndex:(w.presentedIndex??w.searchedIndex??-1)+1,searchedIndex:null}))},[]),d=C.useCallback(()=>{n(w=>({...w,presentedIndex:Math.max(0,(w.presentedIndex??w.searchedIndex??1)-1),searchedIndex:null}))},[]),f=C.useCallback(()=>{n(w=>({...w,searchedIndex:w.presentedIndex,presentedIndex:null}))},[]),p=C.useCallback(()=>{n(w=>w.level==="verses"?{...w,chapter:void 0,presentedIndex:null,searchedIndex:null,level:"chapters"}:w.level==="chapters"?{...w,bookId:void 0,bookName:void 0,level:"books"}:w)},[]),g=C.useCallback(w=>{n(S=>({...S,searchQuery:w}))},[]),m=C.useCallback(()=>{n(w=>({...w,searchQuery:""}))},[]),y=C.useCallback(()=>{n(w=>({...H0,translationId:w.translationId}))},[]),b=C.useCallback(w=>{n({translationId:w.translationId,bookId:w.bookId,bookName:w.bookName,chapter:w.chapter,presentedIndex:w.verseIndex,searchedIndex:null,searchQuery:"",level:"verses"})},[]),v=C.useCallback(w=>{const S=w.clearSearch===!1;n(T=>({...T,bookId:w.bookId,bookName:w.bookName,chapter:w.chapter,presentedIndex:S?T.presentedIndex:w.verseIndex??null,searchedIndex:S?w.verseIndex??null:null,searchQuery:S?T.searchQuery:"",level:"verses"}))},[]);return{state:e,selectTranslation:r,selectBook:s,selectChapter:i,presentVerse:o,nextVerse:l,previousVerse:d,clearPresentation:f,goBack:p,setSearchQuery:g,clearSearch:m,reset:y,navigateToVerse:b,navigateToChapter:v}}function Kp(t){return lt({queryKey:["bible","books",t],queryFn:()=>GP(t),enabled:!!t,staleTime:600*1e3})}function l8(t){return lt({queryKey:["bible","chapters",t],queryFn:()=>XP(t),enabled:!!t,staleTime:600*1e3})}const JE="default_bible_translation",ZE="selected_bible_translations",e3=3;async function t3(){const t=await po("app_settings",JE);if(!t)return null;const e=parseInt(t.value,10);return Number.isNaN(e)?null:e}async function c8(t){return await go("app_settings",{key:JE,value:String(t)})}async function u8(){const t=await po("app_settings",ZE);if(!t){const e=await t3();return e!==null?[e]:[]}try{const e=JSON.parse(t.value);return Array.isArray(e.translationIds)?e.translationIds.filter(n=>typeof n=="number").slice(0,e3):[]}catch{return[]}}async function d8(t){const e=t.slice(0,e3);return await go("app_settings",{key:ZE,value:JSON.stringify({translationIds:e})})}const n3=["bible","translations"];function r3(){return lt({queryKey:n3,queryFn:WP,staleTime:300*1e3})}const SC=["settings","default_bible_translation"];function ev(){const t=Le(),{data:e=[],isLoading:n}=r3(),{data:r,isLoading:s}=lt({queryKey:SC,queryFn:t3,staleTime:300*1e3}),i=De({mutationFn:c8,onSuccess:()=>{t.invalidateQueries({queryKey:SC})}});return{translation:e.find(d=>d.id===r)??e[0]??null,translations:e,defaultTranslationId:r,setDefaultTranslation:i,isLoading:n||s}}function f8(){const t=Le();return De({mutationFn:YP,onSuccess:()=>{t.invalidateQueries({queryKey:n3})}})}function h8(t,e,n,r=!0){return lt({queryKey:["bible","search",t,e,n],queryFn:()=>n8(t,e,n),enabled:r&&t.length>=2,staleTime:60*1e3})}const kC=["settings","selected_bible_translations"],kx=3;function tv(){const t=Le(),{data:e=[],isLoading:n}=r3(),{data:r=[],isLoading:s}=lt({queryKey:kC,queryFn:u8,staleTime:300*1e3}),i=De({mutationFn:d8,onSuccess:()=>{t.invalidateQueries({queryKey:kC})}}),o=r.map(b=>e.find(v=>v.id===b)).filter(b=>b!==void 0),l=e.filter(b=>!r.includes(b.id)),d=o[0]??null,f=n||s,p=r.length<kx;return{selectedTranslations:o,selectedIds:r,availableTranslations:l,translations:e,primaryTranslation:d,addTranslation:async b=>{if(!p)return;const v=[...r,b];await i.mutateAsync(v)},removeTranslation:async b=>{const v=r.filter(w=>w!==b);await i.mutateAsync(v)},reorderTranslations:async b=>{await i.mutateAsync(b)},saveTranslations:i,isLoading:f,canAddMore:p,maxTranslations:kx}}function p8(t,e){const n=t.trim();if(!n)return{type:"none"};const r=/^(\d?\s*[a-zA-Z]+)\s*(\d+)?(?:[\s:,](\d+))?$/i,s=n.match(r);if(!s)return{type:"none"};const[,i,o,l]=s,d=i.trim().toLowerCase(),f=g8(d,e);if(!f)return{type:"none"};const p=o?parseInt(o,10):void 0,g=l?parseInt(l,10):void 0;return p!==void 0&&p>f.chapterCount?{type:"none"}:g!==void 0&&p!==void 0?{type:"verse",bookName:f.bookName,chapter:p,verse:g,matchedBook:f}:p!==void 0?{type:"chapter",bookName:f.bookName,chapter:p,matchedBook:f}:{type:"book",bookName:f.bookName,matchedBook:f}}function g8(t,e){const n=Kf(t),r=e.find(o=>Kf(o.bookName)===n);if(r)return r;const s=e.find(o=>Kf(o.bookName).startsWith(n));if(s)return s;const i=e.find(o=>Kf(o.bookCode)===n);if(i)return i}function Kf(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"")}function m8({searchQuery:t,books:e,navigation:n,enabled:r}){const s=C.useRef(null),{selectBook:i,navigateToChapter:o,selectVerse:l}=n,d=C.useMemo(()=>!r||e.length===0||!t.trim()?null:p8(t,e),[t,e,r]);return C.useEffect(()=>{if(!d||d.type==="none"){s.current=null;return}const{matchedBook:f,chapter:p,verse:g,type:m}=d;if(!f)return;const y=`${m}-${f.id}-${p??""}-${g??""}`;if(s.current!==y)switch(s.current=y,m){case"book":i(f.id,f.bookName,!1);break;case"chapter":p!==void 0&&o({bookId:f.id,bookName:f.bookName,chapter:p,clearSearch:!1});break;case"verse":p!==void 0&&g!==void 0&&o({bookId:f.id,bookName:f.bookName,chapter:p,verseIndex:g-1,clearSearch:!1});break}},[d,i,o,l]),{parsedReference:d,isReferenceSearch:d!==null&&d.type!=="none"}}function s3(t,e){return lt({queryKey:["bible","verses",t,e],queryFn:()=>JP(t,e),enabled:!!t&&!!e,staleTime:600*1e3})}function y8(t){return lt({queryKey:["bible","verse",t],queryFn:()=>ZP(t),enabled:!!t,staleTime:600*1e3})}function x8({navigation:t,onSelectVerse:e,onSelectSearchResult:n,onPresentSearched:r}){const{t:s}=ke("bible"),i=C.useRef(null),{state:o,selectBook:l,selectChapter:d,goBack:f,setSearchQuery:p,clearSearch:g}=t;C.useEffect(()=>{i.current?.focus()},[]);const{selectedTranslations:m}=tv(),{data:y=[],isLoading:b}=Kp(o.translationId),{data:v=[],isLoading:w}=l8(o.bookId),{data:S=[],isLoading:T}=s3(o.bookId,o.chapter),M=y.find(H=>H.id===o.bookId)?.bookCode||"",{isReferenceSearch:_}=m8({searchQuery:o.searchQuery,books:y,navigation:t,enabled:o.searchQuery.length>=2}),{data:R,isLoading:O}=h8(o.searchQuery,o.translationId,50,!_),L=H=>{const P=S[H];P&&e(P,H)},A=H=>{H.key==="Enter"&&r&&(H.preventDefault(),r())},F=o.searchQuery.length>=2&&!_;return u.jsxs("div",{className:"flex flex-col lg:h-full bg-white dark:bg-gray-800 lg:rounded-lg lg:border lg:border-gray-200 lg:dark:border-gray-700",children:[u.jsx("div",{className:"p-3 space-y-2 border-b border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"relative",children:[u.jsx(Zl,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),u.jsx("input",{ref:i,type:"text",value:o.searchQuery,onChange:H=>p(H.target.value),onKeyDown:A,placeholder:s("search.placeholder"),className:"w-full pl-9 pr-9 py-2 text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white placeholder-gray-400"}),o.searchQuery&&u.jsx("button",{type:"button",onClick:g,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(nt,{size:16})})]})}),u.jsx("div",{className:"lg:flex-1 overflow-hidden lg:overflow-y-auto lg:scrollbar-thin p-3",children:F?u.jsx(b8,{results:R?.results||[],type:R?.type||"text",isLoading:O,onSelectResult:n}):o.level==="books"?u.jsx(VP,{books:y,isLoading:b,onSelectBook:l}):o.level==="chapters"?u.jsx(KP,{bookName:o.bookName||"",chapters:v,isLoading:w,onSelectChapter:d,onGoBack:f}):u.jsx(i8,{bookName:o.bookName||"",bookCode:M,chapter:o.chapter||0,verses:S,presentedIndex:o.presentedIndex,searchedIndex:o.searchedIndex,isLoading:T,selectedTranslations:m,onSelectVerse:L,onGoBack:f})})]})}function b8({results:t,type:e,isLoading:n,onSelectResult:r}){const{t:s}=ke("bible");return n?u.jsx("div",{className:"flex items-center justify-center py-8 text-gray-500 dark:text-gray-400",children:s("search.searching")}):t.length===0?u.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:s("search.noResults")}):u.jsx("div",{className:"space-y-1",children:t.map(i=>{const o=e==="text",l=i,d=i;return u.jsxs("button",{type:"button",onClick:()=>r(l),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[u.jsx("div",{className:"text-xs font-medium text-indigo-600 dark:text-indigo-400 mb-0.5",children:o?l.reference:`${d.bookName} ${d.chapter}:${d.verse}`}),u.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-200 line-clamp-2",dangerouslySetInnerHTML:{__html:o?l.highlightedText:d.text}})]},i.id)})})}async function v8(){return(await Me("/api/queue")).data??[]}async function w8(t){const e=await Me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function S8(t){return(await Me(`/api/queue/${t}`,{method:"DELETE"})).data?.success??!1}async function k8(){return(await Me("/api/queue",{method:"DELETE"})).data?.success??!1}async function C8(t){return(await Me("/api/queue/reorder",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).data?.success??!1}async function N8(t,e){return(await Me(`/api/queue/${t}/expand`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({expanded:e})})).data??null}async function T8(t){const e=await Me("/api/queue/slide",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function j8(t){const e=await Me(`/api/queue/slide/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({slideType:t.slideType,slideContent:t.slideContent})});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function E8(t){const e=await Me("/api/queue/bible-passage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function M8(t){const e=await Me("/api/queue/export-to-schedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t})});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function A8(t){const e=await Me("/api/queue/versete-tineri",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}function R8(){const t=Le();return De({mutationFn:e=>w8(e),onSuccess:e=>{e.success&&e.data&&t.setQueryData(["queue"],n=>n?[...n,e.data]:[e.data]),t.invalidateQueries({queryKey:["queue"]})}})}function i3(){const t=Le();return De({mutationFn:()=>k8(),onMutate:async()=>{await t.cancelQueries({queryKey:["queue"]});const e=t.getQueryData(["queue"]);return t.setQueryData(["queue"],[]),{previousQueue:e}},onError:(e,n,r)=>{r?.previousQueue&&t.setQueryData(["queue"],r.previousQueue)},onSettled:()=>{t.invalidateQueries({queryKey:["queue"]})}})}function _8(){const t=Le();return De({mutationFn:e=>E8(e),onSuccess:e=>{e.success&&t.invalidateQueries({queryKey:["queue"]})}})}function O8(){const t=Le();return De({mutationFn:e=>T8(e),onSuccess:e=>{e.success&&t.invalidateQueries({queryKey:["queue"]})}})}function I8(){const t=Le();return De({mutationFn:e=>A8(e),onSuccess:e=>{e.success&&t.invalidateQueries({queryKey:["queue"]})}})}function Qp(){return lt({queryKey:["queue"],queryFn:v8})}function D8(){const t=Le();return De({mutationFn:e=>S8(e),onMutate:async e=>{await t.cancelQueries({queryKey:["queue"]});const n=t.getQueryData(["queue"]);return t.setQueryData(["queue"],r=>r?r.filter(s=>s.id!==e):[]),{previousQueue:n}},onError:(e,n,r)=>{r?.previousQueue&&t.setQueryData(["queue"],r.previousQueue)},onSettled:()=>{t.invalidateQueries({queryKey:["queue"]})}})}function L8(){const t=Le();return De({mutationFn:e=>C8(e),onMutate:async e=>{await t.cancelQueries({queryKey:["queue"]});const n=t.getQueryData(["queue"]);return t.setQueryData(["queue"],r=>{if(!r)return[];const s=new Map(r.map(i=>[i.id,i]));return e.itemIds.map(i=>s.get(i)).filter(i=>i!==void 0).map((i,o)=>({...i,sortOrder:o}))}),{previousQueue:n}},onError:(e,n,r)=>{r?.previousQueue&&t.setQueryData(["queue"],r.previousQueue)},onSettled:()=>{t.invalidateQueries({queryKey:["queue"]})}})}function z8(){const t=Le();return De({mutationFn:e=>M8(e),onSuccess:e=>{e.success&&t.invalidateQueries({queryKey:["schedules"]})}})}function P8(t){if(!t)return null;let e=t.parentElement;for(;e;){const{overflowY:n}=window.getComputedStyle(e);if(n==="auto"||n==="scroll")return e;e=e.parentElement}return null}function B8(t){const e=P8(t);if(!e)return;const n=t.getBoundingClientRect(),r=e.getBoundingClientRect(),s=n.top-r.top+e.scrollTop,i=n.height,o=s-i,l=e.scrollHeight-e.clientHeight,d=Math.max(0,Math.min(o,l)),f=n.top-r.top;Math.abs(f-i)<5||e.scrollTo({top:d,behavior:"smooth"})}function nv(t,e){C.useEffect(()=>{e&&t.current&&B8(t.current)},[e,t])}function a3(){const t=Le();return De({mutationFn:({id:e,expanded:n})=>N8(e,n),onMutate:async({id:e,expanded:n})=>{await t.cancelQueries({queryKey:["queue"]});const r=t.getQueryData(["queue"]);return t.setQueryData(["queue"],s=>s?s.map(i=>i.id===e?{...i,isExpanded:n}:i):[]),{previousQueue:r}},onError:(e,n,r)=>{r?.previousQueue&&t.setQueryData(["queue"],r.previousQueue)},onSettled:()=>{t.invalidateQueries({queryKey:["queue"]})}})}function F8(){const t=Le();return De({mutationFn:e=>j8(e),onSuccess:()=>{t.invalidateQueries({queryKey:["queue"]})}})}const U8=/^(\d?\s*[a-zA-Z]+)\s*(\d+)\s*[:.,]\s*(\d+)(?:\s*[-]\s*(?:(\d+)\s*[:.,]\s*)?(\d+))?$/i;function o3(t){const{input:e,books:n}=t,r=e.trim();if(!r)return{status:"empty",errorKey:"biblePassage.errors.empty"};const s=r.match(U8);if(!s)return{status:"invalid_format",errorKey:"biblePassage.errors.invalid_format"};const[,i,o,l,d,f]=s,p=i.trim(),g=q8(p,n);if(!g)return{status:"book_not_found",errorKey:"biblePassage.errors.book_not_found"};const m=parseInt(o,10),y=parseInt(l,10);let b,v;if(f?d?(b=parseInt(d,10),v=parseInt(f,10)):(b=m,v=parseInt(f,10)):(b=m,v=y),m<1||m>g.chapterCount)return{status:"invalid_chapter",errorKey:"biblePassage.errors.invalid_chapter"};if(b<1||b>g.chapterCount)return{status:"invalid_chapter",errorKey:"biblePassage.errors.invalid_chapter"};if(b<m||b===m&&v<y)return{status:"end_before_start",errorKey:"biblePassage.errors.end_before_start"};const w=$8(g.bookName,m,y,b,v);return{status:"valid",bookCode:g.bookCode,bookName:g.bookName,startChapter:m,startVerse:y,endChapter:b,endVerse:v,matchedBook:g,formattedReference:w}}function $8(t,e,n,r,s){return e===r?n===s?`${t} ${e}:${n}`:`${t} ${e}:${n}-${s}`:`${t} ${e}:${n} - ${r}:${s}`}function q8(t,e){const n=Qf(t),r=e.find(o=>Qf(o.bookName)===n);if(r)return r;const s=e.find(o=>Qf(o.bookName).startsWith(n));if(s)return s;const i=e.find(o=>Qf(o.bookCode)===n);if(i)return i}function Qf(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"")}function l3({isOpen:t,onClose:e,afterItemId:n,onSaved:r}){const{t:s}=ke("queue"),{showToast:i}=mt(),o=C.useRef(null),l=C.useRef(null),d=_8(),[f,p]=C.useState(""),[g,m]=C.useState(null),{translation:y}=ev(),{data:b=[]}=Kp(y?.id??0);C.useEffect(()=>{const M=setTimeout(()=>{if(!f.trim()){m(null);return}if(b.length===0)return;const _=o3({input:f,books:b});m(_)},300);return()=>clearTimeout(M)},[f,b]),C.useEffect(()=>{t?(o.current?.showModal(),setTimeout(()=>l.current?.focus(),100)):o.current?.close()},[t]);const v=()=>{d.isPending||e()},w=M=>{M.target===o.current&&v()},S=async()=>{if(!y||!g||g.status!=="valid")return;(await d.mutateAsync({translationId:y.id,translationAbbreviation:y.abbreviation,bookCode:g.bookCode,bookName:g.bookName,startChapter:g.startChapter,startVerse:g.startVerse,endChapter:g.endChapter,endVerse:g.endVerse,afterItemId:n})).success?(i(s("messages.biblePassageInserted"),"success"),r?.(),e()):i(s("messages.error"),"error")},T=M=>{M.key==="Enter"&&g?.status==="valid"&&S()},j=g?.status==="valid";return u.jsx("dialog",{ref:o,onCancel:v,onClick:w,className:"fixed inset-0 m-auto w-full max-w-lg p-0 rounded-lg bg-white dark:bg-gray-800 backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col max-h-[80vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Sr,{size:20,className:"text-teal-600"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s("biblePassage.title")})]}),u.jsx("button",{type:"button",onClick:v,disabled:d.isPending,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:s("biblePassage.reference")}),u.jsx("input",{ref:l,type:"text",value:f,onChange:M=>p(M.target.value),onKeyDown:T,placeholder:s("biblePassage.referencePlaceholder"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-teal-500 focus:border-teal-500"}),u.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:s("biblePassage.referenceHint")})]}),g&&u.jsx("div",{className:`p-3 rounded-lg border ${j?"bg-teal-50 dark:bg-teal-900/30 border-teal-200 dark:border-teal-800":"bg-red-50 dark:bg-red-900/30 border-red-200 dark:border-red-800"}`,children:j?u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"font-medium text-teal-800 dark:text-teal-200",children:g.formattedReference}),u.jsxs("span",{className:"flex items-center gap-1 text-sm text-teal-600 dark:text-teal-400",children:[u.jsx(jb,{size:16}),s("biblePassage.valid")]})]}):u.jsxs("div",{className:"flex items-center gap-2 text-red-700 dark:text-red-300",children:[u.jsx(jh,{size:16}),u.jsx("span",{children:s(g.errorKey)})]})})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:v,disabled:d.isPending,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg disabled:opacity-50",children:s("actions.cancel")}),u.jsxs("button",{type:"button",onClick:S,disabled:d.isPending||!j,className:"inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 disabled:opacity-50",children:[d.isPending&&u.jsx(Qe,{size:18,className:"animate-spin"}),s("biblePassage.add")]})]})]})})}function H8(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return C.useMemo(()=>r=>{e.forEach(s=>s(r))},e)}const Wp=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function nc(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function rv(t){return"nodeType"in t}function ur(t){var e,n;return t?nc(t)?t:rv(t)&&(e=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?e:window:window}function sv(t){const{Document:e}=ur(t);return t instanceof e}function dd(t){return nc(t)?!1:t instanceof ur(t).HTMLElement}function c3(t){return t instanceof ur(t).SVGElement}function rc(t){return t?nc(t)?t.document:rv(t)?sv(t)?t:dd(t)||c3(t)?t.ownerDocument:document:document:document}const Ts=Wp?C.useLayoutEffect:C.useEffect;function iv(t){const e=C.useRef(t);return Ts(()=>{e.current=t}),C.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}function V8(){const t=C.useRef(null),e=C.useCallback((r,s)=>{t.current=setInterval(r,s)},[]),n=C.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,n]}function Uu(t,e){e===void 0&&(e=[t]);const n=C.useRef(t);return Ts(()=>{n.current!==t&&(n.current=t)},e),n}function fd(t,e){const n=C.useRef();return C.useMemo(()=>{const r=t(n.current);return n.current=r,r},[...e])}function zh(t){const e=iv(t),n=C.useRef(null),r=C.useCallback(s=>{s!==n.current&&e?.(s,n.current),n.current=s},[]);return[n,r]}function Cx(t){const e=C.useRef();return C.useEffect(()=>{e.current=t},[t]),e.current}let V0={};function hd(t,e){return C.useMemo(()=>{if(e)return e;const n=V0[t]==null?0:V0[t]+1;return V0[t]=n,t+"-"+n},[t,e])}function u3(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,o)=>{const l=Object.entries(o);for(const[d,f]of l){const p=i[d];p!=null&&(i[d]=p+t*f)}return i},{...e})}}const Dl=u3(1),$u=u3(-1);function K8(t){return"clientX"in t&&"clientY"in t}function av(t){if(!t)return!1;const{KeyboardEvent:e}=ur(t.target);return e&&t instanceof e}function Q8(t){if(!t)return!1;const{TouchEvent:e}=ur(t.target);return e&&t instanceof e}function Nx(t){if(Q8(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:n}=t.touches[0];return{x:e,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:n}=t.changedTouches[0];return{x:e,y:n}}}return K8(t)?{x:t.clientX,y:t.clientY}:null}const us=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:n}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:n}=t;return"scaleX("+e+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[us.Translate.toString(t),us.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:n,easing:r}=t;return e+" "+n+"ms "+r}}}),CC="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function W8(t){return t.matches(CC)?t:t.querySelector(CC)}const Y8={display:"none"};function G8(t){let{id:e,value:n}=t;return St.createElement("div",{id:e,style:Y8},n)}function X8(t){let{id:e,announcement:n,ariaLiveType:r="assertive"}=t;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return St.createElement("div",{id:e,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function J8(){const[t,e]=C.useState("");return{announce:C.useCallback(r=>{r!=null&&e(r)},[]),announcement:t}}const d3=C.createContext(null);function Z8(t){const e=C.useContext(d3);C.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function e7(){const[t]=C.useState(()=>new Set),e=C.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[C.useCallback(r=>{let{type:s,event:i}=r;t.forEach(o=>{var l;return(l=o[s])==null?void 0:l.call(o,i)})},[t]),e]}const t7={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},n7={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was moved over droppable area "+n.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was dropped over droppable area "+n.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function r7(t){let{announcements:e=n7,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=t7}=t;const{announce:i,announcement:o}=J8(),l=hd("DndLiveRegion"),[d,f]=C.useState(!1);if(C.useEffect(()=>{f(!0)},[]),Z8(C.useMemo(()=>({onDragStart(g){let{active:m}=g;i(e.onDragStart({active:m}))},onDragMove(g){let{active:m,over:y}=g;e.onDragMove&&i(e.onDragMove({active:m,over:y}))},onDragOver(g){let{active:m,over:y}=g;i(e.onDragOver({active:m,over:y}))},onDragEnd(g){let{active:m,over:y}=g;i(e.onDragEnd({active:m,over:y}))},onDragCancel(g){let{active:m,over:y}=g;i(e.onDragCancel({active:m,over:y}))}}),[i,e])),!d)return null;const p=St.createElement(St.Fragment,null,St.createElement(G8,{id:r,value:s.draggable}),St.createElement(X8,{id:l,announcement:o}));return n?ta.createPortal(p,n):p}var rn;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(rn||(rn={}));function Ph(){}function ar(t,e){return C.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function mo(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return C.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const ds=Object.freeze({x:0,y:0});function f3(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function h3(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return n-r}function s7(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return r-n}function NC(t){let{left:e,top:n,height:r,width:s}=t;return[{x:e,y:n},{x:e+s,y:n},{x:e,y:n+r},{x:e+s,y:n+r}]}function p3(t,e){if(!t||t.length===0)return null;const[n]=t;return n[e]}function TC(t,e,n){return e===void 0&&(e=t.left),n===void 0&&(n=t.top),{x:e+t.width*.5,y:n+t.height*.5}}const yo=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const s=TC(e,e.left,e.top),i=[];for(const o of r){const{id:l}=o,d=n.get(l);if(d){const f=f3(TC(d),s);i.push({id:l,data:{droppableContainer:o,value:f}})}}return i.sort(h3)},i7=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const s=NC(e),i=[];for(const o of r){const{id:l}=o,d=n.get(l);if(d){const f=NC(d),p=s.reduce((m,y,b)=>m+f3(f[b],y),0),g=Number((p/4).toFixed(4));i.push({id:l,data:{droppableContainer:o,value:g}})}}return i.sort(h3)};function a7(t,e){const n=Math.max(e.top,t.top),r=Math.max(e.left,t.left),s=Math.min(e.left+e.width,t.left+t.width),i=Math.min(e.top+e.height,t.top+t.height),o=s-r,l=i-n;if(r<s&&n<i){const d=e.width*e.height,f=t.width*t.height,p=o*l,g=p/(d+f-p);return Number(g.toFixed(4))}return 0}const o7=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const s=[];for(const i of r){const{id:o}=i,l=n.get(o);if(l){const d=a7(l,e);d>0&&s.push({id:o,data:{droppableContainer:i,value:d}})}}return s.sort(s7)};function l7(t,e,n){return{...t,scaleX:e&&n?e.width/n.width:1,scaleY:e&&n?e.height/n.height:1}}function g3(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:ds}function c7(t){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((o,l)=>({...o,top:o.top+t*l.y,bottom:o.bottom+t*l.y,left:o.left+t*l.x,right:o.right+t*l.x}),{...n})}}const u7=c7(1);function d7(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function f7(t,e,n){const r=d7(e);if(!r)return t;const{scaleX:s,scaleY:i,x:o,y:l}=r,d=t.left-o-(1-s)*parseFloat(n),f=t.top-l-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),p=s?t.width/s:t.width,g=i?t.height/i:t.height;return{width:p,height:g,top:f,right:d+p,bottom:f+g,left:d}}const h7={ignoreTransform:!1};function sc(t,e){e===void 0&&(e=h7);let n=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:f,transformOrigin:p}=ur(t).getComputedStyle(t);f&&(n=f7(n,f,p))}const{top:r,left:s,width:i,height:o,bottom:l,right:d}=n;return{top:r,left:s,width:i,height:o,bottom:l,right:d}}function jC(t){return sc(t,{ignoreTransform:!0})}function p7(t){const e=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:e,bottom:n,width:e,height:n}}function g7(t,e){return e===void 0&&(e=ur(t).getComputedStyle(t)),e.position==="fixed"}function m7(t,e){e===void 0&&(e=ur(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=e[s];return typeof i=="string"?n.test(i):!1})}function Yp(t,e){const n=[];function r(s){if(e!=null&&n.length>=e||!s)return n;if(sv(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!dd(s)||c3(s)||n.includes(s))return n;const i=ur(t).getComputedStyle(s);return s!==t&&m7(s,i)&&n.push(s),g7(s,i)?n:r(s.parentNode)}return t?r(t):n}function m3(t){const[e]=Yp(t,1);return e??null}function K0(t){return!Wp||!t?null:nc(t)?t:rv(t)?sv(t)||t===rc(t).scrollingElement?window:dd(t)?t:null:null}function y3(t){return nc(t)?t.scrollX:t.scrollLeft}function x3(t){return nc(t)?t.scrollY:t.scrollTop}function Tx(t){return{x:y3(t),y:x3(t)}}var un;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(un||(un={}));function b3(t){return!Wp||!t?!1:t===document.scrollingElement}function v3(t){const e={x:0,y:0},n=b3(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},s=t.scrollTop<=e.y,i=t.scrollLeft<=e.x,o=t.scrollTop>=r.y,l=t.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:o,isRight:l,maxScroll:r,minScroll:e}}const y7={x:.2,y:.2};function x7(t,e,n,r,s){let{top:i,left:o,right:l,bottom:d}=n;r===void 0&&(r=10),s===void 0&&(s=y7);const{isTop:f,isBottom:p,isLeft:g,isRight:m}=v3(t),y={x:0,y:0},b={x:0,y:0},v={height:e.height*s.y,width:e.width*s.x};return!f&&i<=e.top+v.height?(y.y=un.Backward,b.y=r*Math.abs((e.top+v.height-i)/v.height)):!p&&d>=e.bottom-v.height&&(y.y=un.Forward,b.y=r*Math.abs((e.bottom-v.height-d)/v.height)),!m&&l>=e.right-v.width?(y.x=un.Forward,b.x=r*Math.abs((e.right-v.width-l)/v.width)):!g&&o<=e.left+v.width&&(y.x=un.Backward,b.x=r*Math.abs((e.left+v.width-o)/v.width)),{direction:y,speed:b}}function b7(t){if(t===document.scrollingElement){const{innerWidth:i,innerHeight:o}=window;return{top:0,left:0,right:i,bottom:o,width:i,height:o}}const{top:e,left:n,right:r,bottom:s}=t.getBoundingClientRect();return{top:e,left:n,right:r,bottom:s,width:t.clientWidth,height:t.clientHeight}}function w3(t){return t.reduce((e,n)=>Dl(e,Tx(n)),ds)}function v7(t){return t.reduce((e,n)=>e+y3(n),0)}function w7(t){return t.reduce((e,n)=>e+x3(n),0)}function S7(t,e){if(e===void 0&&(e=sc),!t)return;const{top:n,left:r,bottom:s,right:i}=e(t);m3(t)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const k7=[["x",["left","right"],v7],["y",["top","bottom"],w7]];class ov{constructor(e,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Yp(n),s=w3(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[i,o,l]of k7)for(const d of o)Object.defineProperty(this,d,{get:()=>{const f=l(r),p=s[i]-f;return this.rect[d]+p},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class vu{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=e}add(e,n,r){var s;(s=this.target)==null||s.addEventListener(e,n,r),this.listeners.push([e,n,r])}}function C7(t){const{EventTarget:e}=ur(t);return t instanceof e?t:rc(t)}function Q0(t,e){const n=Math.abs(t.x),r=Math.abs(t.y);return typeof e=="number"?Math.sqrt(n**2+r**2)>e:"x"in e&&"y"in e?n>e.x&&r>e.y:"x"in e?n>e.x:"y"in e?r>e.y:!1}var Qr;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Qr||(Qr={}));function EC(t){t.preventDefault()}function N7(t){t.stopPropagation()}var st;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(st||(st={}));const S3={start:[st.Space,st.Enter],cancel:[st.Esc],end:[st.Space,st.Enter,st.Tab]},T7=(t,e)=>{let{currentCoordinates:n}=e;switch(t.code){case st.Right:return{...n,x:n.x+25};case st.Left:return{...n,x:n.x-25};case st.Down:return{...n,y:n.y+25};case st.Up:return{...n,y:n.y-25}}};class yi{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:n}}=e;this.props=e,this.listeners=new vu(rc(n)),this.windowListeners=new vu(ur(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Qr.Resize,this.handleCancel),this.windowListeners.add(Qr.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Qr.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:n}=this.props,r=e.node.current;r&&S7(r),n(ds)}handleKeyDown(e){if(av(e)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=S3,coordinateGetter:o=T7,scrollBehavior:l="smooth"}=s,{code:d}=e;if(i.end.includes(d)){this.handleEnd(e);return}if(i.cancel.includes(d)){this.handleCancel(e);return}const{collisionRect:f}=r.current,p=f?{x:f.left,y:f.top}:ds;this.referenceCoordinates||(this.referenceCoordinates=p);const g=o(e,{active:n,context:r.current,currentCoordinates:p});if(g){const m=$u(g,p),y={x:0,y:0},{scrollableAncestors:b}=r.current;for(const v of b){const w=e.code,{isTop:S,isRight:T,isLeft:j,isBottom:M,maxScroll:_,minScroll:R}=v3(v),O=b7(v),L={x:Math.min(w===st.Right?O.right-O.width/2:O.right,Math.max(w===st.Right?O.left:O.left+O.width/2,g.x)),y:Math.min(w===st.Down?O.bottom-O.height/2:O.bottom,Math.max(w===st.Down?O.top:O.top+O.height/2,g.y))},A=w===st.Right&&!T||w===st.Left&&!j,F=w===st.Down&&!M||w===st.Up&&!S;if(A&&L.x!==g.x){const H=v.scrollLeft+m.x,P=w===st.Right&&H<=_.x||w===st.Left&&H>=R.x;if(P&&!m.y){v.scrollTo({left:H,behavior:l});return}P?y.x=v.scrollLeft-H:y.x=w===st.Right?v.scrollLeft-_.x:v.scrollLeft-R.x,y.x&&v.scrollBy({left:-y.x,behavior:l});break}else if(F&&L.y!==g.y){const H=v.scrollTop+m.y,P=w===st.Down&&H<=_.y||w===st.Up&&H>=R.y;if(P&&!m.x){v.scrollTo({top:H,behavior:l});return}P?y.y=v.scrollTop-H:y.y=w===st.Down?v.scrollTop-_.y:v.scrollTop-R.y,y.y&&v.scrollBy({top:-y.y,behavior:l});break}}this.handleMove(e,Dl($u(g,this.referenceCoordinates),y))}}}handleMove(e,n){const{onMove:r}=this.props;e.preventDefault(),r(n)}handleEnd(e){const{onEnd:n}=this.props;e.preventDefault(),this.detach(),n()}handleCancel(e){const{onCancel:n}=this.props;e.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}yi.activators=[{eventName:"onKeyDown",handler:(t,e,n)=>{let{keyboardCodes:r=S3,onActivation:s}=e,{active:i}=n;const{code:o}=t.nativeEvent;if(r.start.includes(o)){const l=i.activatorNode.current;return l&&t.target!==l?!1:(t.preventDefault(),s?.({event:t.nativeEvent}),!0)}return!1}}];function MC(t){return!!(t&&"distance"in t)}function AC(t){return!!(t&&"delay"in t)}class lv{constructor(e,n,r){var s;r===void 0&&(r=C7(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=n;const{event:i}=e,{target:o}=i;this.props=e,this.events=n,this.document=rc(o),this.documentListeners=new vu(this.document),this.listeners=new vu(r),this.windowListeners=new vu(ur(o)),this.initialCoordinates=(s=Nx(i))!=null?s:ds,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Qr.Resize,this.handleCancel),this.windowListeners.add(Qr.DragStart,EC),this.windowListeners.add(Qr.VisibilityChange,this.handleCancel),this.windowListeners.add(Qr.ContextMenu,EC),this.documentListeners.add(Qr.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(AC(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(MC(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,n){const{active:r,onPending:s}=this.props;s(r,e,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:e}=this,{onStart:n}=this.props;e&&(this.activated=!0,this.documentListeners.add(Qr.Click,N7,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Qr.SelectionChange,this.removeTextSelection),n(e))}handleMove(e){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:o,options:{activationConstraint:l}}=i;if(!s)return;const d=(n=Nx(e))!=null?n:ds,f=$u(s,d);if(!r&&l){if(MC(l)){if(l.tolerance!=null&&Q0(f,l.tolerance))return this.handleCancel();if(Q0(f,l.distance))return this.handleStart()}if(AC(l)&&Q0(f,l.tolerance))return this.handleCancel();this.handlePending(l,f);return}e.cancelable&&e.preventDefault(),o(d)}handleEnd(){const{onAbort:e,onEnd:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleCancel(){const{onAbort:e,onCancel:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleKeydown(e){e.code===st.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const j7={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class xi extends lv{constructor(e){const{event:n}=e,r=rc(n.target);super(e,j7,r)}}xi.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return!n.isPrimary||n.button!==0?!1:(r?.({event:n}),!0)}}];const E7={move:{name:"mousemove"},end:{name:"mouseup"}};var jx;(function(t){t[t.RightClick=2]="RightClick"})(jx||(jx={}));class M7 extends lv{constructor(e){super(e,E7,rc(e.event.target))}}M7.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return n.button===jx.RightClick?!1:(r?.({event:n}),!0)}}];const W0={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class A7 extends lv{constructor(e){super(e,W0)}static setup(){return window.addEventListener(W0.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(W0.move.name,e)};function e(){}}}A7.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;const{touches:s}=n;return s.length>1?!1:(r?.({event:n}),!0)}}];var wu;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(wu||(wu={}));var Bh;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(Bh||(Bh={}));function R7(t){let{acceleration:e,activator:n=wu.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:o=5,order:l=Bh.TreeOrder,pointerCoordinates:d,scrollableAncestors:f,scrollableAncestorRects:p,delta:g,threshold:m}=t;const y=O7({delta:g,disabled:!i}),[b,v]=V8(),w=C.useRef({x:0,y:0}),S=C.useRef({x:0,y:0}),T=C.useMemo(()=>{switch(n){case wu.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case wu.DraggableRect:return s}},[n,s,d]),j=C.useRef(null),M=C.useCallback(()=>{const R=j.current;if(!R)return;const O=w.current.x*S.current.x,L=w.current.y*S.current.y;R.scrollBy(O,L)},[]),_=C.useMemo(()=>l===Bh.TreeOrder?[...f].reverse():f,[l,f]);C.useEffect(()=>{if(!i||!f.length||!T){v();return}for(const R of _){if(r?.(R)===!1)continue;const O=f.indexOf(R),L=p[O];if(!L)continue;const{direction:A,speed:F}=x7(R,L,T,e,m);for(const H of["x","y"])y[H][A[H]]||(F[H]=0,A[H]=0);if(F.x>0||F.y>0){v(),j.current=R,b(M,o),w.current=F,S.current=A;return}}w.current={x:0,y:0},S.current={x:0,y:0},v()},[e,M,r,v,i,o,JSON.stringify(T),JSON.stringify(y),b,f,_,p,JSON.stringify(m)])}const _7={x:{[un.Backward]:!1,[un.Forward]:!1},y:{[un.Backward]:!1,[un.Forward]:!1}};function O7(t){let{delta:e,disabled:n}=t;const r=Cx(e);return fd(s=>{if(n||!r||!s)return _7;const i={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[un.Backward]:s.x[un.Backward]||i.x===-1,[un.Forward]:s.x[un.Forward]||i.x===1},y:{[un.Backward]:s.y[un.Backward]||i.y===-1,[un.Forward]:s.y[un.Forward]||i.y===1}}},[n,e,r])}function I7(t,e){const n=e!=null?t.get(e):void 0,r=n?n.node.current:null;return fd(s=>{var i;return e==null?null:(i=r??s)!=null?i:null},[r,e])}function D7(t,e){return C.useMemo(()=>t.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(o=>({eventName:o.eventName,handler:e(o.handler,r)}));return[...n,...i]},[]),[t,e])}var qu;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(qu||(qu={}));var Ex;(function(t){t.Optimized="optimized"})(Ex||(Ex={}));const RC=new Map;function L7(t,e){let{dragging:n,dependencies:r,config:s}=e;const[i,o]=C.useState(null),{frequency:l,measure:d,strategy:f}=s,p=C.useRef(t),g=w(),m=Uu(g),y=C.useCallback(function(S){S===void 0&&(S=[]),!m.current&&o(T=>T===null?S:T.concat(S.filter(j=>!T.includes(j))))},[m]),b=C.useRef(null),v=fd(S=>{if(g&&!n)return RC;if(!S||S===RC||p.current!==t||i!=null){const T=new Map;for(let j of t){if(!j)continue;if(i&&i.length>0&&!i.includes(j.id)&&j.rect.current){T.set(j.id,j.rect.current);continue}const M=j.node.current,_=M?new ov(d(M),M):null;j.rect.current=_,_&&T.set(j.id,_)}return T}return S},[t,i,n,g,d]);return C.useEffect(()=>{p.current=t},[t]),C.useEffect(()=>{g||y()},[n,g]),C.useEffect(()=>{i&&i.length>0&&o(null)},[JSON.stringify(i)]),C.useEffect(()=>{g||typeof l!="number"||b.current!==null||(b.current=setTimeout(()=>{y(),b.current=null},l))},[l,g,y,...r]),{droppableRects:v,measureDroppableContainers:y,measuringScheduled:i!=null};function w(){switch(f){case qu.Always:return!1;case qu.BeforeDragging:return n;default:return!n}}}function k3(t,e){return fd(n=>t?n||(typeof e=="function"?e(t):t):null,[e,t])}function z7(t,e){return k3(t,e)}function P7(t){let{callback:e,disabled:n}=t;const r=iv(e),s=C.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return C.useEffect(()=>()=>s?.disconnect(),[s]),s}function Gp(t){let{callback:e,disabled:n}=t;const r=iv(e),s=C.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return C.useEffect(()=>()=>s?.disconnect(),[s]),s}function B7(t){return new ov(sc(t),t)}function _C(t,e,n){e===void 0&&(e=B7);const[r,s]=C.useState(null);function i(){s(d=>{if(!t)return null;if(t.isConnected===!1){var f;return(f=d??n)!=null?f:null}const p=e(t);return JSON.stringify(d)===JSON.stringify(p)?d:p})}const o=P7({callback(d){if(t)for(const f of d){const{type:p,target:g}=f;if(p==="childList"&&g instanceof HTMLElement&&g.contains(t)){i();break}}}}),l=Gp({callback:i});return Ts(()=>{i(),t?(l?.observe(t),o?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),o?.disconnect())},[t]),r}function F7(t){const e=k3(t);return g3(t,e)}const OC=[];function U7(t){const e=C.useRef(t),n=fd(r=>t?r&&r!==OC&&t&&e.current&&t.parentNode===e.current.parentNode?r:Yp(t):OC,[t]);return C.useEffect(()=>{e.current=t},[t]),n}function $7(t){const[e,n]=C.useState(null),r=C.useRef(t),s=C.useCallback(i=>{const o=K0(i.target);o&&n(l=>l?(l.set(o,Tx(o)),new Map(l)):null)},[]);return C.useEffect(()=>{const i=r.current;if(t!==i){o(i);const l=t.map(d=>{const f=K0(d);return f?(f.addEventListener("scroll",s,{passive:!0}),[f,Tx(f)]):null}).filter(d=>d!=null);n(l.length?new Map(l):null),r.current=t}return()=>{o(t),o(i)};function o(l){l.forEach(d=>{const f=K0(d);f?.removeEventListener("scroll",s)})}},[s,t]),C.useMemo(()=>t.length?e?Array.from(e.values()).reduce((i,o)=>Dl(i,o),ds):w3(t):ds,[t,e])}function IC(t,e){e===void 0&&(e=[]);const n=C.useRef(null);return C.useEffect(()=>{n.current=null},e),C.useEffect(()=>{const r=t!==ds;r&&!n.current&&(n.current=t),!r&&n.current&&(n.current=null)},[t]),n.current?$u(t,n.current):ds}function q7(t){C.useEffect(()=>{if(!Wp)return;const e=t.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of e)n?.()}},t.map(e=>{let{sensor:n}=e;return n}))}function H7(t,e){return C.useMemo(()=>t.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=o=>{i(o,e)},n},{}),[t,e])}function C3(t){return C.useMemo(()=>t?p7(t):null,[t])}const DC=[];function V7(t,e){e===void 0&&(e=sc);const[n]=t,r=C3(n?ur(n):null),[s,i]=C.useState(DC);function o(){i(()=>t.length?t.map(d=>b3(d)?r:new ov(e(d),d)):DC)}const l=Gp({callback:o});return Ts(()=>{l?.disconnect(),o(),t.forEach(d=>l?.observe(d))},[t]),s}function K7(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return dd(e)?e:t}function Q7(t){let{measure:e}=t;const[n,r]=C.useState(null),s=C.useCallback(f=>{for(const{target:p}of f)if(dd(p)){r(g=>{const m=e(p);return g?{...g,width:m.width,height:m.height}:m});break}},[e]),i=Gp({callback:s}),o=C.useCallback(f=>{const p=K7(f);i?.disconnect(),p&&i?.observe(p),r(p?e(p):null)},[e,i]),[l,d]=zh(o);return C.useMemo(()=>({nodeRef:l,rect:n,setRef:d}),[n,l,d])}const W7=[{sensor:xi,options:{}},{sensor:yi,options:{}}],Y7={current:{}},hh={draggable:{measure:jC},droppable:{measure:jC,strategy:qu.WhileDragging,frequency:Ex.Optimized},dragOverlay:{measure:sc}};class Su extends Map{get(e){var n;return e!=null&&(n=super.get(e))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:n}=e;return!n})}getNodeFor(e){var n,r;return(n=(r=this.get(e))==null?void 0:r.node.current)!=null?n:void 0}}const G7={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Su,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ph},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:hh,measureDroppableContainers:Ph,windowRect:null,measuringScheduled:!1},X7={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ph,draggableNodes:new Map,over:null,measureDroppableContainers:Ph},Xp=C.createContext(X7),N3=C.createContext(G7);function J7(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Su}}}function Z7(t,e){switch(e.type){case rn.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case rn.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case rn.DragEnd:case rn.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case rn.RegisterDroppable:{const{element:n}=e,{id:r}=n,s=new Su(t.droppable.containers);return s.set(r,n),{...t,droppable:{...t.droppable,containers:s}}}case rn.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=e,i=t.droppable.containers.get(n);if(!i||r!==i.key)return t;const o=new Su(t.droppable.containers);return o.set(n,{...i,disabled:s}),{...t,droppable:{...t.droppable,containers:o}}}case rn.UnregisterDroppable:{const{id:n,key:r}=e,s=t.droppable.containers.get(n);if(!s||r!==s.key)return t;const i=new Su(t.droppable.containers);return i.delete(n),{...t,droppable:{...t.droppable,containers:i}}}default:return t}}function eB(t){let{disabled:e}=t;const{active:n,activatorEvent:r,draggableNodes:s}=C.useContext(Xp),i=Cx(r),o=Cx(n?.id);return C.useEffect(()=>{if(!e&&!r&&i&&o!=null){if(!av(i)||document.activeElement===i.target)return;const l=s.get(o);if(!l)return;const{activatorNode:d,node:f}=l;if(!d.current&&!f.current)return;requestAnimationFrame(()=>{for(const p of[d.current,f.current]){if(!p)continue;const g=W8(p);if(g){g.focus();break}}})}},[r,e,s,o,i]),null}function tB(t,e){let{transform:n,...r}=e;return t!=null&&t.length?t.reduce((s,i)=>i({transform:s,...r}),n):n}function nB(t){return C.useMemo(()=>({draggable:{...hh.draggable,...t?.draggable},droppable:{...hh.droppable,...t?.droppable},dragOverlay:{...hh.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function rB(t){let{activeNode:e,measure:n,initialRect:r,config:s=!0}=t;const i=C.useRef(!1),{x:o,y:l}=typeof s=="boolean"?{x:s,y:s}:s;Ts(()=>{if(!o&&!l||!e){i.current=!1;return}if(i.current||!r)return;const f=e?.node.current;if(!f||f.isConnected===!1)return;const p=n(f),g=g3(p,r);if(o||(g.x=0),l||(g.y=0),i.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const m=m3(f);m&&m.scrollBy({top:g.y,left:g.x})}},[e,o,l,r,n])}const T3=C.createContext({...ds,scaleX:1,scaleY:1});var Wi;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Wi||(Wi={}));const xo=C.memo(function(e){var n,r,s,i;let{id:o,accessibility:l,autoScroll:d=!0,children:f,sensors:p=W7,collisionDetection:g=o7,measuring:m,modifiers:y,...b}=e;const v=C.useReducer(Z7,void 0,J7),[w,S]=v,[T,j]=e7(),[M,_]=C.useState(Wi.Uninitialized),R=M===Wi.Initialized,{draggable:{active:O,nodes:L,translate:A},droppable:{containers:F}}=w,H=O!=null?L.get(O):null,P=C.useRef({initial:null,translated:null}),B=C.useMemo(()=>{var vt;return O!=null?{id:O,data:(vt=H?.data)!=null?vt:Y7,rect:P}:null},[O,H]),E=C.useRef(null),[K,q]=C.useState(null),[V,ie]=C.useState(null),Y=Uu(b,Object.values(b)),X=hd("DndDescribedBy",o),D=C.useMemo(()=>F.getEnabled(),[F]),U=nB(m),{droppableRects:te,measureDroppableContainers:Z,measuringScheduled:re}=L7(D,{dragging:R,dependencies:[A.x,A.y],config:U.droppable}),se=I7(L,O),ge=C.useMemo(()=>V?Nx(V):null,[V]),be=_s(),me=z7(se,U.draggable.measure);rB({activeNode:O!=null?L.get(O):null,config:be.layoutShiftCompensation,initialRect:me,measure:U.draggable.measure});const Se=_C(se,U.draggable.measure,me),Oe=_C(se?se.parentElement:null),He=C.useRef({activatorEvent:null,active:null,activeNode:se,collisionRect:null,collisions:null,droppableRects:te,draggableNodes:L,draggingNode:null,draggingNodeRect:null,droppableContainers:F,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ut=F.getNodeFor((n=He.current.over)==null?void 0:n.id),z=Q7({measure:U.dragOverlay.measure}),fe=(r=z.nodeRef.current)!=null?r:se,ue=R?(s=z.rect)!=null?s:Se:null,W=!!(z.nodeRef.current&&z.rect),Q=F7(W?null:Se),ee=C3(fe?ur(fe):null),pe=U7(R?ut??se:null),we=V7(pe),ae=tB(y,{transform:{x:A.x-Q.x,y:A.y-Q.y,scaleX:1,scaleY:1},activatorEvent:V,active:B,activeNodeRect:Se,containerNodeRect:Oe,draggingNodeRect:ue,over:He.current.over,overlayNodeRect:z.rect,scrollableAncestors:pe,scrollableAncestorRects:we,windowRect:ee}),xe=ge?Dl(ge,A):null,Ce=$7(pe),Te=IC(Ce),Ie=IC(Ce,[Se]),Ze=Dl(ae,Te),Ue=ue?u7(ue,ae):null,$t=B&&Ue?g({active:B,collisionRect:Ue,droppableRects:te,droppableContainers:D,pointerCoordinates:xe}):null,Zr=p3($t,"id"),[Bt,hs]=C.useState(null),dt=W?ae:Dl(ae,Ie),qt=l7(dt,(i=Bt?.rect)!=null?i:null,Se),Nn=C.useRef(null),Nt=C.useCallback((vt,Tt)=>{let{sensor:on,options:Kn}=Tt;if(E.current==null)return;const Qn=L.get(E.current);if(!Qn)return;const Tn=vt.nativeEvent,Wn=new on({active:E.current,activeNode:Qn,event:Tn,options:Kn,context:He,onAbort(en){if(!L.get(en))return;const{onDragAbort:dr}=Y.current,Tr={id:en};dr?.(Tr),T({type:"onDragAbort",event:Tr})},onPending(en,es,dr,Tr){if(!L.get(en))return;const{onDragPending:Is}=Y.current,ts={id:en,constraint:es,initialCoordinates:dr,offset:Tr};Is?.(ts),T({type:"onDragPending",event:ts})},onStart(en){const es=E.current;if(es==null)return;const dr=L.get(es);if(!dr)return;const{onDragStart:Tr}=Y.current,Os={activatorEvent:Tn,active:{id:es,data:dr.data,rect:P}};ta.unstable_batchedUpdates(()=>{Tr?.(Os),_(Wi.Initializing),S({type:rn.DragStart,initialCoordinates:en,active:es}),T({type:"onDragStart",event:Os}),q(Nn.current),ie(Tn)})},onMove(en){S({type:rn.DragMove,coordinates:en})},onEnd:Nr(rn.DragEnd),onCancel:Nr(rn.DragCancel)});Nn.current=Wn;function Nr(en){return async function(){const{active:dr,collisions:Tr,over:Os,scrollAdjustedTranslate:Is}=He.current;let ts=null;if(dr&&Is){const{cancelDrop:wi}=Y.current;ts={activatorEvent:Tn,active:dr,collisions:Tr,delta:Is,over:Os},en===rn.DragEnd&&typeof wi=="function"&&await Promise.resolve(wi(ts))&&(en=rn.DragCancel)}E.current=null,ta.unstable_batchedUpdates(()=>{S({type:en}),_(Wi.Uninitialized),hs(null),q(null),ie(null),Nn.current=null;const wi=en===rn.DragEnd?"onDragEnd":"onDragCancel";if(ts){const jr=Y.current[wi];jr?.(ts),T({type:wi,event:ts})}})}}},[L]),jo=C.useCallback((vt,Tt)=>(on,Kn)=>{const Qn=on.nativeEvent,Tn=L.get(Kn);if(E.current!==null||!Tn||Qn.dndKit||Qn.defaultPrevented)return;const Wn={active:Tn};vt(on,Tt.options,Wn)===!0&&(Qn.dndKit={capturedBy:Tt.sensor},E.current=Kn,Nt(on,Tt))},[L,Nt]),Eo=D7(p,jo);q7(p),Ts(()=>{Se&&M===Wi.Initializing&&_(Wi.Initialized)},[Se,M]),C.useEffect(()=>{const{onDragMove:vt}=Y.current,{active:Tt,activatorEvent:on,collisions:Kn,over:Qn}=He.current;if(!Tt||!on)return;const Tn={active:Tt,activatorEvent:on,collisions:Kn,delta:{x:Ze.x,y:Ze.y},over:Qn};ta.unstable_batchedUpdates(()=>{vt?.(Tn),T({type:"onDragMove",event:Tn})})},[Ze.x,Ze.y]),C.useEffect(()=>{const{active:vt,activatorEvent:Tt,collisions:on,droppableContainers:Kn,scrollAdjustedTranslate:Qn}=He.current;if(!vt||E.current==null||!Tt||!Qn)return;const{onDragOver:Tn}=Y.current,Wn=Kn.get(Zr),Nr=Wn&&Wn.rect.current?{id:Wn.id,rect:Wn.rect.current,data:Wn.data,disabled:Wn.disabled}:null,en={active:vt,activatorEvent:Tt,collisions:on,delta:{x:Qn.x,y:Qn.y},over:Nr};ta.unstable_batchedUpdates(()=>{hs(Nr),Tn?.(en),T({type:"onDragOver",event:en})})},[Zr]),Ts(()=>{He.current={activatorEvent:V,active:B,activeNode:se,collisionRect:Ue,collisions:$t,droppableRects:te,draggableNodes:L,draggingNode:fe,draggingNodeRect:ue,droppableContainers:F,over:Bt,scrollableAncestors:pe,scrollAdjustedTranslate:Ze},P.current={initial:ue,translated:Ue}},[B,se,$t,Ue,L,fe,ue,te,F,Bt,pe,Ze]),R7({...be,delta:A,draggingRect:Ue,pointerCoordinates:xe,scrollableAncestors:pe,scrollableAncestorRects:we});const lc=C.useMemo(()=>({active:B,activeNode:se,activeNodeRect:Se,activatorEvent:V,collisions:$t,containerNodeRect:Oe,dragOverlay:z,draggableNodes:L,droppableContainers:F,droppableRects:te,over:Bt,measureDroppableContainers:Z,scrollableAncestors:pe,scrollableAncestorRects:we,measuringConfiguration:U,measuringScheduled:re,windowRect:ee}),[B,se,Se,V,$t,Oe,z,L,F,te,Bt,Z,pe,we,U,re,ee]),vi=C.useMemo(()=>({activatorEvent:V,activators:Eo,active:B,activeNodeRect:Se,ariaDescribedById:{draggable:X},dispatch:S,draggableNodes:L,over:Bt,measureDroppableContainers:Z}),[V,Eo,B,Se,S,X,L,Bt,Z]);return St.createElement(d3.Provider,{value:j},St.createElement(Xp.Provider,{value:vi},St.createElement(N3.Provider,{value:lc},St.createElement(T3.Provider,{value:qt},f)),St.createElement(eB,{disabled:l?.restoreFocus===!1})),St.createElement(r7,{...l,hiddenTextDescribedById:X}));function _s(){const vt=K?.autoScrollEnabled===!1,Tt=typeof d=="object"?d.enabled===!1:d===!1,on=R&&!vt&&!Tt;return typeof d=="object"?{...d,enabled:on}:{enabled:on}}}),sB=C.createContext(null),LC="button",iB="Draggable";function aB(t){let{id:e,data:n,disabled:r=!1,attributes:s}=t;const i=hd(iB),{activators:o,activatorEvent:l,active:d,activeNodeRect:f,ariaDescribedById:p,draggableNodes:g,over:m}=C.useContext(Xp),{role:y=LC,roleDescription:b="draggable",tabIndex:v=0}=s??{},w=d?.id===e,S=C.useContext(w?T3:sB),[T,j]=zh(),[M,_]=zh(),R=H7(o,e),O=Uu(n);Ts(()=>(g.set(e,{id:e,key:i,node:T,activatorNode:M,data:O}),()=>{const A=g.get(e);A&&A.key===i&&g.delete(e)}),[g,e]);const L=C.useMemo(()=>({role:y,tabIndex:v,"aria-disabled":r,"aria-pressed":w&&y===LC?!0:void 0,"aria-roledescription":b,"aria-describedby":p.draggable}),[r,y,v,w,b,p.draggable]);return{active:d,activatorEvent:l,activeNodeRect:f,attributes:L,isDragging:w,listeners:r?void 0:R,node:T,over:m,setNodeRef:j,setActivatorNodeRef:_,transform:S}}function oB(){return C.useContext(N3)}const lB="Droppable",cB={timeout:25};function uB(t){let{data:e,disabled:n=!1,id:r,resizeObserverConfig:s}=t;const i=hd(lB),{active:o,dispatch:l,over:d,measureDroppableContainers:f}=C.useContext(Xp),p=C.useRef({disabled:n}),g=C.useRef(!1),m=C.useRef(null),y=C.useRef(null),{disabled:b,updateMeasurementsFor:v,timeout:w}={...cB,...s},S=Uu(v??r),T=C.useCallback(()=>{if(!g.current){g.current=!0;return}y.current!=null&&clearTimeout(y.current),y.current=setTimeout(()=>{f(Array.isArray(S.current)?S.current:[S.current]),y.current=null},w)},[w]),j=Gp({callback:T,disabled:b||!o}),M=C.useCallback((L,A)=>{j&&(A&&(j.unobserve(A),g.current=!1),L&&j.observe(L))},[j]),[_,R]=zh(M),O=Uu(e);return C.useEffect(()=>{!j||!_.current||(j.disconnect(),g.current=!1,j.observe(_.current))},[_,j]),C.useEffect(()=>(l({type:rn.RegisterDroppable,element:{id:r,key:i,disabled:n,node:_,rect:m,data:O}}),()=>l({type:rn.UnregisterDroppable,key:i,id:r})),[r]),C.useEffect(()=>{n!==p.current.disabled&&(l({type:rn.SetDroppableDisabled,id:r,key:i,disabled:n}),p.current.disabled=n)},[r,i,n,l]),{active:o,rect:m,isOver:d?.id===r,node:_,over:d,setNodeRef:R}}function ic(t,e,n){const r=t.slice();return r.splice(n<0?r.length+n:n,0,r.splice(e,1)[0]),r}function dB(t,e){return t.reduce((n,r,s)=>{const i=e.get(r);return i&&(n[s]=i),n},Array(t.length))}function Wf(t){return t!==null&&t>=0}function fB(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function hB(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const j3=t=>{let{rects:e,activeIndex:n,overIndex:r,index:s}=t;const i=ic(e,r,n),o=e[s],l=i[s];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},Yf={scaleX:1,scaleY:1},bo=t=>{var e;let{activeIndex:n,activeNodeRect:r,index:s,rects:i,overIndex:o}=t;const l=(e=i[n])!=null?e:r;if(!l)return null;if(s===n){const f=i[o];return f?{x:0,y:n<o?f.top+f.height-(l.top+l.height):f.top-l.top,...Yf}:null}const d=pB(i,s,n);return s>n&&s<=o?{x:0,y:-l.height-d,...Yf}:s<n&&s>=o?{x:0,y:l.height+d,...Yf}:{x:0,y:0,...Yf}};function pB(t,e,n){const r=t[e],s=t[e-1],i=t[e+1];return r?n<e?s?r.top-(s.top+s.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const E3="Sortable",M3=St.createContext({activeIndex:-1,containerId:E3,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:j3,disabled:{draggable:!1,droppable:!1}});function vo(t){let{children:e,id:n,items:r,strategy:s=j3,disabled:i=!1}=t;const{active:o,dragOverlay:l,droppableRects:d,over:f,measureDroppableContainers:p}=oB(),g=hd(E3,n),m=l.rect!==null,y=C.useMemo(()=>r.map(R=>typeof R=="object"&&"id"in R?R.id:R),[r]),b=o!=null,v=o?y.indexOf(o.id):-1,w=f?y.indexOf(f.id):-1,S=C.useRef(y),T=!fB(y,S.current),j=w!==-1&&v===-1||T,M=hB(i);Ts(()=>{T&&b&&p(y)},[T,y,b,p]),C.useEffect(()=>{S.current=y},[y]);const _=C.useMemo(()=>({activeIndex:v,containerId:g,disabled:M,disableTransforms:j,items:y,overIndex:w,useDragOverlay:m,sortedRects:dB(y,d),strategy:s}),[v,g,M.draggable,M.droppable,j,y,w,d,m,s]);return St.createElement(M3.Provider,{value:_},e)}const gB=t=>{let{id:e,items:n,activeIndex:r,overIndex:s}=t;return ic(n,r,s).indexOf(e)},mB=t=>{let{containerId:e,isSorting:n,wasDragging:r,index:s,items:i,newIndex:o,previousItems:l,previousContainerId:d,transition:f}=t;return!f||!r||l!==i&&s===o?!1:n?!0:o!==s&&e===d},yB={duration:200,easing:"ease"},A3="transform",xB=us.Transition.toString({property:A3,duration:0,easing:"linear"}),bB={roleDescription:"sortable"};function vB(t){let{disabled:e,index:n,node:r,rect:s}=t;const[i,o]=C.useState(null),l=C.useRef(n);return Ts(()=>{if(!e&&n!==l.current&&r.current){const d=s.current;if(d){const f=sc(r.current,{ignoreTransform:!0}),p={x:d.left-f.left,y:d.top-f.top,scaleX:d.width/f.width,scaleY:d.height/f.height};(p.x||p.y)&&o(p)}}n!==l.current&&(l.current=n)},[e,n,r,s]),C.useEffect(()=>{i&&o(null)},[i]),i}function wo(t){let{animateLayoutChanges:e=mB,attributes:n,disabled:r,data:s,getNewIndex:i=gB,id:o,strategy:l,resizeObserverConfig:d,transition:f=yB}=t;const{items:p,containerId:g,activeIndex:m,disabled:y,disableTransforms:b,sortedRects:v,overIndex:w,useDragOverlay:S,strategy:T}=C.useContext(M3),j=wB(r,y),M=p.indexOf(o),_=C.useMemo(()=>({sortable:{containerId:g,index:M,items:p},...s}),[g,s,M,p]),R=C.useMemo(()=>p.slice(p.indexOf(o)),[p,o]),{rect:O,node:L,isOver:A,setNodeRef:F}=uB({id:o,data:_,disabled:j.droppable,resizeObserverConfig:{updateMeasurementsFor:R,...d}}),{active:H,activatorEvent:P,activeNodeRect:B,attributes:E,setNodeRef:K,listeners:q,isDragging:V,over:ie,setActivatorNodeRef:Y,transform:X}=aB({id:o,data:_,attributes:{...bB,...n},disabled:j.draggable}),D=H8(F,K),U=!!H,te=U&&!b&&Wf(m)&&Wf(w),Z=!S&&V,re=Z&&te?X:null,ge=te?re??(l??T)({rects:v,activeNodeRect:B,activeIndex:m,overIndex:w,index:M}):null,be=Wf(m)&&Wf(w)?i({id:o,items:p,activeIndex:m,overIndex:w}):M,me=H?.id,Se=C.useRef({activeId:me,items:p,newIndex:be,containerId:g}),Oe=p!==Se.current.items,He=e({active:H,containerId:g,isDragging:V,isSorting:U,id:o,index:M,items:p,newIndex:Se.current.newIndex,previousItems:Se.current.items,previousContainerId:Se.current.containerId,transition:f,wasDragging:Se.current.activeId!=null}),ut=vB({disabled:!He,index:M,node:L,rect:O});return C.useEffect(()=>{U&&Se.current.newIndex!==be&&(Se.current.newIndex=be),g!==Se.current.containerId&&(Se.current.containerId=g),p!==Se.current.items&&(Se.current.items=p)},[U,be,g,p]),C.useEffect(()=>{if(me===Se.current.activeId)return;if(me!=null&&Se.current.activeId==null){Se.current.activeId=me;return}const fe=setTimeout(()=>{Se.current.activeId=me},50);return()=>clearTimeout(fe)},[me]),{active:H,activeIndex:m,attributes:E,data:_,rect:O,index:M,newIndex:be,items:p,isOver:A,isSorting:U,isDragging:V,listeners:q,node:L,overIndex:w,over:ie,setNodeRef:D,setActivatorNodeRef:Y,setDroppableNodeRef:F,setDraggableNodeRef:K,transform:ut??ge,transition:z()};function z(){if(ut||Oe&&Se.current.newIndex===M)return xB;if(!(Z&&!av(P)||!f)&&(U||He))return us.Transition.toString({...f,property:A3})}}function wB(t,e){var n,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(n=t?.draggable)!=null?n:e.draggable,droppable:(r=t?.droppable)!=null?r:e.droppable}}function Fh(t){if(!t)return!1;const e=t.data.current;return!!(e&&"sortable"in e&&typeof e.sortable=="object"&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const SB=[st.Down,st.Right,st.Up,st.Left],So=(t,e)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:i,over:o,scrollableAncestors:l}}=e;if(SB.includes(t.code)){if(t.preventDefault(),!n||!r)return;const d=[];i.getEnabled().forEach(g=>{if(!g||g!=null&&g.disabled)return;const m=s.get(g.id);if(m)switch(t.code){case st.Down:r.top<m.top&&d.push(g);break;case st.Up:r.top>m.top&&d.push(g);break;case st.Left:r.left>m.left&&d.push(g);break;case st.Right:r.left<m.left&&d.push(g);break}});const f=i7({collisionRect:r,droppableRects:s,droppableContainers:d});let p=p3(f,"id");if(p===o?.id&&f.length>1&&(p=f[1].id),p!=null){const g=i.get(n.id),m=i.get(p),y=m?s.get(m.id):null,b=m?.node.current;if(b&&y&&g&&m){const w=Yp(b).some((R,O)=>l[O]!==R),S=R3(g,m),T=kB(g,m),j=w||!S?{x:0,y:0}:{x:T?r.width-y.width:0,y:T?r.height-y.height:0},M={x:y.left,y:y.top};return j.x&&j.y?M:$u(M,j)}}}};function R3(t,e){return!Fh(t)||!Fh(e)?!1:t.data.current.sortable.containerId===e.data.current.sortable.containerId}function kB(t,e){return!Fh(t)||!Fh(e)||!R3(t,e)?!1:t.data.current.sortable.index<e.data.current.sortable.index}function CB({translation:t,index:e,onRemove:n}){const{t:r}=ke("settings"),{attributes:s,listeners:i,setNodeRef:o,transform:l,transition:d,isDragging:f}=wo({id:t.id}),p={transform:us.Transform.toString(l),transition:d,opacity:f?.5:1},g=m=>{switch(m){case 0:return r("sections.bible.primary");case 1:return r("sections.bible.secondary");case 2:return r("sections.bible.tertiary");default:return""}};return u.jsxs("div",{ref:o,style:p,className:`
        flex items-center gap-3 p-3 bg-white dark:bg-gray-800
        border border-gray-200 dark:border-gray-700 rounded-lg
        ${f?"shadow-lg ring-2 ring-indigo-500":""}
      `,children:[u.jsx("button",{type:"button",className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 cursor-grab active:cursor-grabbing",...s,...i,children:u.jsx(cr,{size:20})}),u.jsx("div",{className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-md bg-indigo-100 dark:bg-indigo-900/50 text-indigo-600 dark:text-indigo-400",children:u.jsx(Sr,{size:18})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.name}),u.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400",children:t.abbreviation})]}),u.jsx("span",{className:"text-xs text-indigo-600 dark:text-indigo-400",children:g(e)})]}),u.jsx("button",{type:"button",onClick:n,className:"p-2 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:r("common:buttons.remove",{defaultValue:"Remove"}),children:u.jsx(nt,{size:18})})]})}function NB(){const{t}=ke("settings"),{showToast:e}=mt(),{selectedTranslations:n,selectedIds:r,availableTranslations:s,addTranslation:i,removeTranslation:o,reorderTranslations:l,isLoading:d,canAddMore:f}=tv(),[p,g]=C.useState(!1),m=mo(ar(xi),ar(yi,{coordinateGetter:So})),y=async w=>{const{active:S,over:T}=w;if(!T||S.id===T.id)return;const j=r.findIndex(R=>R===S.id),M=r.findIndex(R=>R===T.id);if(j===-1||M===-1)return;const _=ic(r,j,M);try{await l(_),e(t("sections.bible.toast.saved"),"success")}catch{e(t("sections.bible.toast.error"),"error")}},b=async w=>{try{await i(w),e(t("sections.bible.toast.added"),"success")}catch{e(t("sections.bible.toast.error"),"error")}},v=async w=>{try{await o(w),e(t("sections.bible.toast.removed"),"success")}catch{e(t("sections.bible.toast.error"),"error")}};return d?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"})}):u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[u.jsx(Sr,{className:"w-5 h-5"}),t("sections.bible.title")]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t("sections.bible.description")})]}),u.jsxs("button",{type:"button",onClick:()=>g(!0),disabled:!f,className:"flex items-center gap-2 px-3 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-sm font-medium rounded-lg transition-colors",title:f?void 0:t("sections.bible.maxReached"),children:[u.jsx(Xt,{size:16}),t("sections.bible.addTranslation")]})]}),n.length===0?u.jsxs("div",{className:"text-center py-8 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-dashed border-gray-300 dark:border-gray-600",children:[u.jsx(Sr,{className:"w-12 h-12 mx-auto text-gray-400 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:t("sections.bible.noTranslations")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:t("sections.bible.noTranslationsDescription")})]}):u.jsx(xo,{sensors:m,collisionDetection:yo,onDragEnd:y,children:u.jsx(vo,{items:r,strategy:bo,children:u.jsx("div",{className:"space-y-2",children:n.map((w,S)=>u.jsx(CB,{translation:w,index:S,onRemove:()=>v(w.id)},w.id))})})}),n.length>0&&u.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-3",children:[n.length," / ",kx," ",t("sections.bible.translationsSelected",{defaultValue:"translations selected"})]}),u.jsx(qP,{isOpen:p,availableTranslations:s,onSubmit:b,onClose:()=>g(!1)})]})}function TB({isOpen:t,onClose:e}){const{t:n}=ke("bible"),r=C.useRef(null),s=C.useRef(null),[i,o]=C.useState(null),{mutateAsync:l,isPending:d}=f8();C.useEffect(()=>{t?r.current?.showModal():r.current?.close()},[t]),C.useEffect(()=>{const m=r.current;if(!m)return;const y=b=>{b.preventDefault(),e()};return m.addEventListener("cancel",y),()=>m.removeEventListener("cancel",y)},[e]);const f=m=>{m.target===r.current&&e()},p=()=>{s.current?.click()},g=async m=>{const y=m.target.files?.[0];if(y){try{const b=await y.text(),v=y.name.replace(/\.xml$/i,"").replace(/-/g," ");await l({xmlContent:b,name:v,abbreviation:v.substring(0,10).toUpperCase(),language:"ro"})}catch(b){o(b instanceof Error?b.message:n("import.error"))}s.current&&(s.current.value="")}};return u.jsxs(u.Fragment,{children:[u.jsx("dialog",{ref:r,className:"fixed inset-0 m-auto w-full max-w-4xl p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:f,children:u.jsxs("div",{className:"flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n("settings.title")}),u.jsx("button",{type:"button",onClick:e,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:u.jsx(NB,{})}),u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[u.jsx(Du,{className:"w-5 h-5"}),n("settings.import.title")]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:n("settings.import.description")})]}),u.jsxs("button",{type:"button",onClick:p,disabled:d,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-sm font-medium rounded-lg transition-colors",children:[d?u.jsx(Qe,{className:"w-4 h-4 animate-spin"}):u.jsx(Du,{className:"w-4 h-4"}),n("settings.import.button")]}),u.jsx("input",{ref:s,type:"file",accept:".xml",onChange:g,className:"hidden"})]}),u.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx(aD,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"text-sm",children:[u.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:n("settings.import.formatTitle")}),u.jsx("p",{className:"text-blue-800 dark:text-blue-200 mb-3",children:n("settings.import.formatDescription")}),u.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:n("settings.import.structureTitle")}),u.jsx("pre",{className:"bg-blue-100 dark:bg-blue-900/40 p-3 rounded text-xs text-blue-900 dark:text-blue-100 overflow-x-auto whitespace-pre",children:`<?xml version="1.0" encoding="UTF-8"?>
<usfx>
  <book id="GEN">
    <id>GEN</id>
    <h>Genesis</h>
    <c id="1">
      <v id="1">In the beginning God created...</v>
      <v id="2">And the earth was without form...</v>
    </c>
    <c id="2">
      <v id="1">Thus the heavens and the earth...</v>
    </c>
  </book>
</usfx>`}),u.jsxs("ul",{className:"mt-3 space-y-1 text-blue-800 dark:text-blue-200",children:[u.jsxs("li",{children:[" ",n("settings.import.hints.rootElement")]}),u.jsxs("li",{children:[" ",n("settings.import.hints.bookElement")]}),u.jsxs("li",{children:[" ",n("settings.import.hints.chapterElement")]}),u.jsxs("li",{children:[" ",n("settings.import.hints.verseElement")]})]})]})]})})]})]})]})}),u.jsx(XE,{isOpen:!!i,title:n("import.errorTitle"),message:i||"",onClose:()=>o(null),variant:"error"})]})}function jB(t,e,n,r){const s=`${t} ${e}:${n}`;return r?`${s} - ${r}`:s}function EB({onAddSong:t,onAddBibleVerse:e,onAddBiblePassage:n,onAddSlide:r,onImportSchedule:s}){const{t:i}=ke("queue"),[o,l]=C.useState(!1),d=C.useRef(null);C.useEffect(()=>{o?d.current?.showModal():d.current?.close()},[o]);const f=g=>{l(!1),g()},p=()=>{l(!1)};return u.jsxs(u.Fragment,{children:[u.jsx("button",{type:"button",onClick:()=>l(!0),className:"p-1.5 text-white bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 rounded-lg transition-colors",title:i("addToQueue.button"),children:u.jsx(Xt,{size:18})}),u.jsx("dialog",{ref:d,onCancel:p,onClick:g=>{g.target===d.current&&p()},className:"fixed inset-0 m-auto w-full max-w-sm p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:i("addToQueue.title")}),u.jsx("button",{type:"button",onClick:p,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"p-4 space-y-2",children:[u.jsxs("button",{type:"button",onClick:()=>f(t),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center",children:u.jsx(ya,{size:20,className:"text-indigo-600 dark:text-indigo-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:i("addToQueue.searchSong")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("addToQueue.searchSongDescription")})]})]}),e&&u.jsxs("button",{type:"button",onClick:()=>f(e),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:u.jsx(Sr,{size:20,className:"text-blue-600 dark:text-blue-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:i("addToQueue.bibleVerse")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("addToQueue.bibleVerseDescription")})]})]}),n&&u.jsxs("button",{type:"button",onClick:()=>f(n),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-teal-100 dark:bg-teal-900/30 flex items-center justify-center",children:u.jsx(Lp,{size:20,className:"text-teal-600 dark:text-teal-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:i("addToQueue.biblePassage")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("addToQueue.biblePassageDescription")})]})]}),u.jsxs("button",{type:"button",onClick:()=>f(()=>r("announcement")),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center",children:u.jsx(fo,{size:20,className:"text-orange-600 dark:text-orange-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:i("addToQueue.announcement")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("addToQueue.announcementDescription")})]})]}),u.jsxs("button",{type:"button",onClick:()=>f(()=>r("versete_tineri")),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:u.jsx(fs,{size:20,className:"text-green-600 dark:text-green-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:i("addToQueue.verseteTineri")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("addToQueue.verseteTineriDescription")})]})]}),s&&u.jsxs("button",{type:"button",onClick:()=>f(s),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center",children:u.jsx(zp,{size:20,className:"text-purple-600 dark:text-purple-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:i("importSchedule.title")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("importSchedule.description")})]})]})]})]})})]})}function wn(t){this.content=t}wn.prototype={constructor:wn,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,s=r.find(t),i=r.content.slice();return s==-1?i.push(n||t,e):(i[s+1]=e,n&&(i[s]=n)),new wn(i)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new wn(n)},addToStart:function(t,e){return new wn([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new wn(n)},addBefore:function(t,e,n){var r=this.remove(e),s=r.content.slice(),i=r.find(t);return s.splice(i==-1?s.length:i,0,e,n),new wn(s)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=wn.from(t),t.size?new wn(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=wn.from(t),t.size?new wn(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=wn.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};wn.from=function(t){if(t instanceof wn)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new wn(e)};function _3(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let s=t.child(r),i=e.child(r);if(s==i){n+=s.nodeSize;continue}if(!s.sameMarkup(i))return n;if(s.isText&&s.text!=i.text){for(let o=0;s.text[o]==i.text[o];o++)n++;return n}if(s.content.size||i.content.size){let o=_3(s.content,i.content,n+1);if(o!=null)return o}n+=s.nodeSize}}function O3(t,e,n,r){for(let s=t.childCount,i=e.childCount;;){if(s==0||i==0)return s==i?null:{a:n,b:r};let o=t.child(--s),l=e.child(--i),d=o.nodeSize;if(o==l){n-=d,r-=d;continue}if(!o.sameMarkup(l))return{a:n,b:r};if(o.isText&&o.text!=l.text){let f=0,p=Math.min(o.text.length,l.text.length);for(;f<p&&o.text[o.text.length-f-1]==l.text[l.text.length-f-1];)f++,n--,r--;return{a:n,b:r}}if(o.content.size||l.content.size){let f=O3(o.content,l.content,n-1,r-1);if(f)return f}n-=d,r-=d}}class Ne{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,s=0,i){for(let o=0,l=0;l<n;o++){let d=this.content[o],f=l+d.nodeSize;if(f>e&&r(d,s+l,i||null,o)!==!1&&d.content.size){let p=l+1;d.nodesBetween(Math.max(0,e-p),Math.min(d.content.size,n-p),r,s+p)}l=f}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,s){let i="",o=!0;return this.nodesBetween(e,n,(l,d)=>{let f=l.isText?l.text.slice(Math.max(e,d)-d,n-d):l.isLeaf?s?typeof s=="function"?s(l):s:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&f||l.isTextblock)&&r&&(o?o=!1:i+=r),i+=f},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,s=this.content.slice(),i=0;for(n.isText&&n.sameMarkup(r)&&(s[s.length-1]=n.withText(n.text+r.text),i=1);i<e.content.length;i++)s.push(e.content[i]);return new Ne(s,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],s=0;if(n>e)for(let i=0,o=0;o<n;i++){let l=this.content[i],d=o+l.nodeSize;d>e&&((o<e||d>n)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,n-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,n-o-1))),r.push(l),s+=l.nodeSize),o=d}return new Ne(r,s)}cutByIndex(e,n){return e==n?Ne.empty:e==0&&n==this.content.length?this:new Ne(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let s=this.content.slice(),i=this.size+n.nodeSize-r.nodeSize;return s[e]=n,new Ne(s,i)}addToStart(e){return new Ne([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Ne(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let s=this.content[n];e(s,r,n),r+=s.nodeSize}}findDiffStart(e,n=0){return _3(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return O3(this,e,n,r)}findIndex(e){if(e==0)return Gf(0,e);if(e==this.size)return Gf(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let s=this.child(n),i=r+s.nodeSize;if(i>=e)return i==e?Gf(n+1,i):Gf(n,r);r=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return Ne.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ne(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Ne.empty;let n,r=0;for(let s=0;s<e.length;s++){let i=e[s];r+=i.nodeSize,s&&i.isText&&e[s-1].sameMarkup(i)?(n||(n=e.slice(0,s)),n[n.length-1]=i.withText(n[n.length-1].text+i.text)):n&&n.push(i)}return new Ne(n||e,r)}static from(e){if(!e)return Ne.empty;if(e instanceof Ne)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Ne([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Ne.empty=new Ne([],0);const Y0={index:0,offset:0};function Gf(t,e){return Y0.index=t,Y0.offset=e,Y0}function Uh(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Uh(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Uh(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let kt=class Mx{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let s=0;s<e.length;s++){let i=e[s];if(this.eq(i))return e;if(this.type.excludes(i.type))n||(n=e.slice(0,s));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(n||(n=e.slice(0,s)),n.push(this),r=!0),n&&n.push(i)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Uh(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let s=r.create(n.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Mx.none;if(e instanceof Mx)return[e];let n=e.slice();return n.sort((r,s)=>r.type.rank-s.type.rank),n}};kt.none=[];class $h extends Error{}class Ae{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=D3(this.content,e+this.openStart,n);return r&&new Ae(r,this.openStart,this.openEnd)}removeBetween(e,n){return new Ae(I3(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return Ae.empty;let r=n.openStart||0,s=n.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Ae(Ne.fromJSON(e,n.content),r,s)}static maxOpen(e,n=!0){let r=0,s=0;for(let i=e.firstChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.lastChild)s++;return new Ae(e,r,s)}}Ae.empty=new Ae(Ne.empty,0,0);function I3(t,e,n){let{index:r,offset:s}=t.findIndex(e),i=t.maybeChild(r),{index:o,offset:l}=t.findIndex(n);if(s==e||i.isText){if(l!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(r,i.copy(I3(i.content,e-s-1,n-s-1)))}function D3(t,e,n,r){let{index:s,offset:i}=t.findIndex(e),o=t.maybeChild(s);if(i==e||o.isText)return r&&!r.canReplace(s,s,n)?null:t.cut(0,e).append(n).append(t.cut(e));let l=D3(o.content,e-i-1,n,o);return l&&t.replaceChild(s,o.copy(l))}function MB(t,e,n){if(n.openStart>t.depth)throw new $h("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new $h("Inconsistent open depths");return L3(t,e,n,0)}function L3(t,e,n,r){let s=t.index(r),i=t.node(r);if(s==e.index(r)&&r<t.depth-n.openStart){let o=L3(t,e,n,r+1);return i.copy(i.content.replaceChild(s,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let o=t.parent,l=o.content;return Ga(o,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}else{let{start:o,end:l}=AB(n,t);return Ga(i,P3(t,o,l,e,r))}else return Ga(i,qh(t,e,r))}function z3(t,e){if(!e.type.compatibleContent(t.type))throw new $h("Cannot join "+e.type.name+" onto "+t.type.name)}function Ax(t,e,n){let r=t.node(n);return z3(r,e.node(n)),r}function Ya(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function ku(t,e,n,r){let s=(e||t).node(n),i=0,o=e?e.index(n):s.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(Ya(t.nodeAfter,r),i++));for(let l=i;l<o;l++)Ya(s.child(l),r);e&&e.depth==n&&e.textOffset&&Ya(e.nodeBefore,r)}function Ga(t,e){return t.type.checkContent(e),t.copy(e)}function P3(t,e,n,r,s){let i=t.depth>s&&Ax(t,e,s+1),o=r.depth>s&&Ax(n,r,s+1),l=[];return ku(null,t,s,l),i&&o&&e.index(s)==n.index(s)?(z3(i,o),Ya(Ga(i,P3(t,e,n,r,s+1)),l)):(i&&Ya(Ga(i,qh(t,e,s+1)),l),ku(e,n,s,l),o&&Ya(Ga(o,qh(n,r,s+1)),l)),ku(r,null,s,l),new Ne(l)}function qh(t,e,n){let r=[];if(ku(null,t,n,r),t.depth>n){let s=Ax(t,e,n+1);Ya(Ga(s,qh(t,e,n+1)),r)}return ku(e,null,n,r),new Ne(r)}function AB(t,e){let n=e.depth-t.openStart,s=e.node(n).copy(t.content);for(let i=n-1;i>=0;i--)s=e.node(i).copy(Ne.from(s));return{start:s.resolveNoCache(t.openStart+n),end:s.resolveNoCache(s.content.size-t.openEnd-n)}}class Hu{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(n);return r?e.child(n).cut(r):s}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],s=n==0?0:this.path[n*3-1]+1;for(let i=0;i<e;i++)s+=r.child(i).nodeSize;return s}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return kt.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),s=e.maybeChild(n);if(!r){let l=r;r=s,s=l}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!s||!i[o].isInSet(s.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,s=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Hh(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],s=0,i=n;for(let o=e;;){let{index:l,offset:d}=o.content.findIndex(i),f=i-d;if(r.push(o,l,s+d),!f||(o=o.child(l),o.isText))break;i=f-1,s+=d+1}return new Hu(n,r,i)}static resolveCached(e,n){let r=zC.get(e);if(r)for(let i=0;i<r.elts.length;i++){let o=r.elts[i];if(o.pos==n)return o}else zC.set(e,r=new RB);let s=r.elts[r.i]=Hu.resolve(e,n);return r.i=(r.i+1)%_B,s}}class RB{constructor(){this.elts=[],this.i=0}}const _B=12,zC=new WeakMap;class Hh{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const OB=Object.create(null);let ua=class Rx{constructor(e,n,r,s=kt.none){this.type=e,this.attrs=n,this.marks=s,this.content=r||Ne.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,s=0){this.content.nodesBetween(e,n,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,s){return this.content.textBetween(e,n,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Uh(this.attrs,n||e.defaultAttrs||OB)&&kt.sameSet(this.marks,r||kt.none)}copy(e=null){return e==this.content?this:new Rx(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Rx(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return Ae.empty;let s=this.resolve(e),i=this.resolve(n),o=r?0:s.sharedDepth(n),l=s.start(o),f=s.node(o).content.cut(s.pos-l,i.pos-l);return new Ae(f,s.depth-o,i.depth-o)}replace(e,n,r){return MB(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:s}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(s==e||n.isText)return n;e-=s+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let s=this.content.child(n-1);return{node:s,index:n-1,offset:r-s.nodeSize}}resolve(e){return Hu.resolveCached(this,e)}resolveNoCache(e){return Hu.resolve(this,e)}rangeHasMark(e,n,r){let s=!1;return n>e&&this.nodesBetween(e,n,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),B3(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=Ne.empty,s=0,i=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,s,i),l=o&&o.matchFragment(this.content,n);if(!l||!l.validEnd)return!1;for(let d=s;d<i;d++)if(!this.type.allowsMarks(r.child(d).marks))return!1;return!0}canReplaceWith(e,n,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(e).matchType(r),o=i&&i.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=kt.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!kt.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let s=Ne.fromJSON(e,n.content),i=e.nodeType(n.type).create(n.attrs,s,r);return i.type.checkAttrs(i.attrs),i}};ua.prototype.text=void 0;class Vh extends ua{constructor(e,n,r,s){if(super(e,n,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):B3(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Vh(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Vh(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function B3(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class ao{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new IB(e,n);if(r.next==null)return ao.empty;let s=F3(r);r.next&&r.err("Unexpected trailing text");let i=UB(FB(s));return $B(i,r),i}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let s=this;for(let i=n;s&&i<r;i++)s=s.matchType(e.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let s=[this];function i(o,l){let d=o.matchFragment(e,r);if(d&&(!n||d.validEnd))return Ne.from(l.map(f=>f.createAndFill()));for(let f=0;f<o.next.length;f++){let{type:p,next:g}=o.next[f];if(!(p.isText||p.hasRequiredAttrs())&&s.indexOf(g)==-1){s.push(g);let m=i(g,l.concat(p));if(m)return m}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(e)){let o=[];for(let l=s;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:l,next:d}=i.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in n)&&(!s.type||d.validEnd)&&(r.push({match:l.contentMatch,type:l,via:s}),n[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&n(r.next[s].next)}return n(this),e.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return i}).join(`
`)}}ao.empty=new ao(!0);class IB{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function F3(t){let e=[];do e.push(DB(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function DB(t){let e=[];do e.push(LB(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function LB(t){let e=BB(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=zB(t,e);else break;return e}function PC(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function zB(t,e){let n=PC(t),r=n;return t.eat(",")&&(t.next!="}"?r=PC(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function PB(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let s=[];for(let i in n){let o=n[i];o.isInGroup(e)&&s.push(o)}return s.length==0&&t.err("No node type or group '"+e+"' found"),s}function BB(t){if(t.eat("(")){let e=F3(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=PB(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function FB(t){let e=[[]];return s(i(t,0),n()),e;function n(){return e.push([])-1}function r(o,l,d){let f={term:d,to:l};return e[o].push(f),f}function s(o,l){o.forEach(d=>d.to=l)}function i(o,l){if(o.type=="choice")return o.exprs.reduce((d,f)=>d.concat(i(f,l)),[]);if(o.type=="seq")for(let d=0;;d++){let f=i(o.exprs[d],l);if(d==o.exprs.length-1)return f;s(f,l=n())}else if(o.type=="star"){let d=n();return r(l,d),s(i(o.expr,d),d),[r(d)]}else if(o.type=="plus"){let d=n();return s(i(o.expr,l),d),s(i(o.expr,d),d),[r(d)]}else{if(o.type=="opt")return[r(l)].concat(i(o.expr,l));if(o.type=="range"){let d=l;for(let f=0;f<o.min;f++){let p=n();s(i(o.expr,d),p),d=p}if(o.max==-1)s(i(o.expr,d),d);else for(let f=o.min;f<o.max;f++){let p=n();r(d,p),s(i(o.expr,d),p),d=p}return[r(d)]}else{if(o.type=="name")return[r(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function U3(t,e){return e-t}function BC(t,e){let n=[];return r(e),n.sort(U3);function r(s){let i=t[s];if(i.length==1&&!i[0].term)return r(i[0].to);n.push(s);for(let o=0;o<i.length;o++){let{term:l,to:d}=i[o];!l&&n.indexOf(d)==-1&&r(d)}}}function UB(t){let e=Object.create(null);return n(BC(t,0));function n(r){let s=[];r.forEach(o=>{t[o].forEach(({term:l,to:d})=>{if(!l)return;let f;for(let p=0;p<s.length;p++)s[p][0]==l&&(f=s[p][1]);BC(t,d).forEach(p=>{f||s.push([l,f=[]]),f.indexOf(p)==-1&&f.push(p)})})});let i=e[r.join(",")]=new ao(r.indexOf(t.length-1)>-1);for(let o=0;o<s.length;o++){let l=s[o][1].sort(U3);i.next.push({type:s[o][0],next:e[l.join(",")]||n(l)})}return i}}function $B(t,e){for(let n=0,r=[t];n<r.length;n++){let s=r[n],i=!s.validEnd,o=[];for(let l=0;l<s.next.length;l++){let{type:d,next:f}=s.next[l];o.push(d.name),i&&!(d.isText||d.hasRequiredAttrs())&&(i=!1),r.indexOf(f)==-1&&r.push(f)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function $3(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function q3(t,e){let n=Object.create(null);for(let r in t){let s=e&&e[r];if(s===void 0){let i=t[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=s}return n}function H3(t,e,n,r){for(let s in e)if(!(s in t))throw new RangeError(`Unsupported attribute ${s} for ${n} of type ${s}`);for(let s in t){let i=t[s];i.validate&&i.validate(e[s])}}function V3(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new HB(t,r,e[r]);return n}let FC=class K3{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=V3(e,r.attrs),this.defaultAttrs=$3(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ao.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:q3(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new ua(this,this.computeAttrs(e),Ne.from(n),kt.setFrom(r))}createChecked(e=null,n,r){return n=Ne.from(n),this.checkContent(n),new ua(this,this.computeAttrs(e),n,kt.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=Ne.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let s=this.contentMatch.matchFragment(n),i=s&&s.fillBefore(Ne.empty,!0);return i?new ua(this,e,n.append(i),kt.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){H3(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:kt.none:e}static compile(e,n){let r=Object.create(null);e.forEach((i,o)=>r[i]=new K3(i,n,o));let s=n.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function qB(t,e,n){let r=n.split("|");return s=>{let i=s===null?"null":typeof s;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${i}`)}}class HB{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?qB(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Jp{constructor(e,n,r,s){this.name=e,this.rank=n,this.schema=r,this.spec=s,this.attrs=V3(e,s.attrs),this.excluded=null;let i=$3(this.attrs);this.instance=i?new kt(this,i):null}create(e=null){return!e&&this.instance?this.instance:new kt(this,q3(this.attrs,e))}static compile(e,n){let r=Object.create(null),s=0;return e.forEach((i,o)=>r[i]=new Jp(i,s++,n,o)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){H3(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Q3{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let s in e)n[s]=e[s];n.nodes=wn.from(e.nodes),n.marks=wn.from(e.marks||{}),this.nodes=FC.compile(this.spec.nodes,this),this.marks=Jp.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],o=i.spec.content||"",l=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=ao.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=l=="_"?null:l?UC(this,l.split(" ")):l==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:UC(this,o.split(" "))}this.nodeFromJSON=s=>ua.fromJSON(this,s),this.markFromJSON=s=>kt.fromJSON(this,s),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof FC){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,s)}text(e,n){let r=this.nodes.text;return new Vh(r,r.defaultAttrs,e,kt.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function UC(t,e){let n=[];for(let r=0;r<e.length;r++){let s=e[r],i=t.marks[s],o=i;if(i)n.push(i);else for(let l in t.marks){let d=t.marks[l];(s=="_"||d.spec.group&&d.spec.group.split(" ").indexOf(s)>-1)&&n.push(o=d)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function VB(t){return t.tag!=null}function KB(t){return t.style!=null}let Cu=class _x{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(s=>{if(VB(s))this.tags.push(s);else if(KB(s)){let i=/[^=]*/.exec(s.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let i=e.nodes[s.node];return i.contentMatch.matchType(i)})}parse(e,n={}){let r=new qC(this,n,!1);return r.addAll(e,kt.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new qC(this,n,!0);return r.addAll(e,kt.none,n.from,n.to),Ae.maxOpen(r.finish())}matchTag(e,n,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(YB(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||n.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,n,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let o=this.styles[i],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=n))){if(o.getAttrs){let d=o.getAttrs(n);if(d===!1)continue;o.attrs=d||void 0}return o}}}static schemaRules(e){let n=[];function r(s){let i=s.priority==null?50:s.priority,o=0;for(;o<n.length;o++){let l=n[o];if((l.priority==null?50:l.priority)<i)break}n.splice(o,0,s)}for(let s in e.marks){let i=e.marks[s].spec.parseDOM;i&&i.forEach(o=>{r(o=HC(o)),o.mark||o.ignore||o.clearMark||(o.mark=s)})}for(let s in e.nodes){let i=e.nodes[s].spec.parseDOM;i&&i.forEach(o=>{r(o=HC(o)),o.node||o.ignore||o.mark||(o.node=s)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new _x(e,_x.schemaRules(e)))}};const W3={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},QB={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Y3={ol:!0,ul:!0},Vu=1,Ox=2,Nu=4;function $C(t,e,n){return e!=null?(e?Vu:0)|(e==="full"?Ox:0):t&&t.whitespace=="pre"?Vu|Ox:n&~Nu}class Xf{constructor(e,n,r,s,i,o){this.type=e,this.attrs=n,this.marks=r,this.solid=s,this.options=o,this.content=[],this.activeMarks=kt.none,this.match=i||(o&Nu?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(Ne.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Vu)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let n=Ne.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(Ne.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!W3.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class qC{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=n.topNode,i,o=$C(null,n.preserveWhitespace,0)|(r?Nu:0);s?i=new Xf(s.type,s.attrs,kt.none,!0,n.topMatch||s.type.contentMatch,o):r?i=new Xf(null,null,kt.none,!0,null,o):i=new Xf(e.schema.topNodeType,null,kt.none,!0,null,o),this.nodes=[i],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,s=this.top,i=s.options&Ox?"full":this.localPreserveWS||(s.options&Vu)>0,{schema:o}=this.parser;if(i==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i)if(i==="full")r=r.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(o.linebreakReplacement.create())){let l=r.split(/\r?\n|\r/);for(let d=0;d<l.length;d++)d&&this.insertNode(o.linebreakReplacement.create(),n,!0),l[d]&&this.insertNode(o.text(l[d]),n,!/\S/.test(l[d]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let l=s.content[s.content.length-1],d=e.previousSibling;(!l||d&&d.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(r=r.slice(1))}r&&this.insertNode(o.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let s=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),l;Y3.hasOwnProperty(o)&&this.parser.normalizeLists&&WB(e);let d=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,r));e:if(d?d.ignore:QB.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,n);else if(!d||d.skip||d.closeParent){d&&d.closeParent?this.open=Math.max(0,this.open-1):d&&d.skip.nodeType&&(e=d.skip);let f,p=this.needsBlock;if(W3.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),f=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let g=d&&d.skip?n:this.readStyles(e,n);g&&this.addAll(e,g),f&&this.sync(i),this.needsBlock=p}else{let f=this.readStyles(e,n);f&&this.addElementByRule(e,d,f,d.consuming===!1?l:void 0)}this.localPreserveWS=s}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let i=this.parser.matchedStyles[s],o=r.getPropertyValue(i);if(o)for(let l=void 0;;){let d=this.parser.matchStyle(i,o,this,l);if(!d)break;if(d.ignore)return null;if(d.clearMark?n=n.filter(f=>!d.clearMark(f)):n=n.concat(this.parser.schema.marks[d.mark].create(d.attrs)),d.consuming===!1)l=d;else break}}return n}addElementByRule(e,n,r,s){let i,o;if(n.node)if(o=this.parser.schema.nodes[n.node],o.isLeaf)this.insertNode(o.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let d=this.enter(o,n.attrs||null,r,n.preserveWhitespace);d&&(i=!0,r=d)}else{let d=this.parser.schema.marks[n.mark];r=r.concat(d.create(n.attrs))}let l=this.top;if(o&&o.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(d=>this.insertNode(d,r,!1));else{let d=e;typeof n.contentElement=="string"?d=e.querySelector(n.contentElement):typeof n.contentElement=="function"?d=n.contentElement(e):n.contentElement&&(d=n.contentElement),this.findAround(e,d,!0),this.addAll(d,r),this.findAround(e,d,!1)}i&&this.sync(l)&&this.open--}addAll(e,n,r,s){let i=r||0;for(let o=r?e.childNodes[r]:e.firstChild,l=s==null?null:e.childNodes[s];o!=l;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o,n);this.findAtPoint(e,i)}findPlace(e,n,r){let s,i;for(let o=this.open,l=0;o>=0;o--){let d=this.nodes[o],f=d.findWrapping(e);if(f&&(!s||s.length>f.length+l)&&(s=f,i=d,!f.length))break;if(d.solid){if(r)break;l+=2}}if(!s)return null;this.sync(i);for(let o=0;o<s.length;o++)n=this.enterInner(s[o],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(n=this.enterInner(i,null,n))}let s=this.findPlace(e,n,r);if(s){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=kt.none;for(let l of s.concat(e.marks))(i.type?i.type.allowsMarkType(l.type):VC(l.type,e.type))&&(o=l.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,n,r,s){let i=this.findPlace(e.create(n),r,!1);return i&&(i=this.enterInner(e,n,r,!0,s)),i}enterInner(e,n,r,s=!1,i){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let l=$C(e,i,o.options);o.options&Nu&&o.content.length==0&&(l|=Nu);let d=kt.none;return r=r.filter(f=>(o.type?o.type.allowsMarkType(f.type):VC(f.type,e))?(d=f.addToSet(d),!1):!0),this.nodes.push(new Xf(e,n,d,s,null,l)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Vu)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&n.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),o=(l,d)=>{for(;l>=0;l--){let f=n[l];if(f==""){if(l==n.length-1||l==0)continue;for(;d>=i;d--)if(o(l-1,d))return!0;return!1}else{let p=d>0||d==0&&s?this.nodes[d].type:r&&d>=i?r.node(d-i).type:null;if(!p||p.name!=f&&!p.isInGroup(f))return!1;d--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function WB(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Y3.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function YB(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function HC(t){let e={};for(let n in t)e[n]=t[n];return e}function VC(t,e){let n=e.schema.nodes;for(let r in n){let s=n[r];if(!s.allowsMarkType(t))continue;let i=[],o=l=>{i.push(l);for(let d=0;d<l.edgeCount;d++){let{type:f,next:p}=l.edge(d);if(f==e||i.indexOf(p)<0&&o(p))return!0}};if(o(s.contentMatch))return!0}}class ko{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=G0(n).createDocumentFragment());let s=r,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let l=0,d=0;for(;l<i.length&&d<o.marks.length;){let f=o.marks[d];if(!this.marks[f.type.name]){d++;continue}if(!f.eq(i[l][0])||f.type.spec.spanning===!1)break;l++,d++}for(;l<i.length;)s=i.pop()[1];for(;d<o.marks.length;){let f=o.marks[d++],p=this.serializeMark(f,o.isInline,n);p&&(i.push([f,s]),s.appendChild(p.dom),s=p.contentDOM||p.dom)}}s.appendChild(this.serializeNodeInner(o,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:s}=ph(G0(n),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,s)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let s=e.marks.length-1;s>=0;s--){let i=this.serializeMark(e.marks[s],e.isInline,n);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,n,r={}){let s=this.marks[e.type.name];return s&&ph(G0(r),s(e,n),null,e.attrs)}static renderSpec(e,n,r=null,s){return ph(e,n,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new ko(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=KC(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return KC(e.marks)}}function KC(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function G0(t){return t.document||window.document}const QC=new WeakMap;function GB(t){let e=QC.get(t);return e===void 0&&QC.set(t,e=XB(t)),e}function XB(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)n(r[s]);else for(let s in r)n(r[s])}return n(t),e}function ph(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],i;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=GB(r))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=s.indexOf(" ");o>0&&(n=s.slice(0,o),s=s.slice(o+1));let l,d=n?t.createElementNS(n,s):t.createElement(s),f=e[1],p=1;if(f&&typeof f=="object"&&f.nodeType==null&&!Array.isArray(f)){p=2;for(let g in f)if(f[g]!=null){let m=g.indexOf(" ");m>0?d.setAttributeNS(g.slice(0,m),g.slice(m+1),f[g]):g=="style"&&d.style?d.style.cssText=f[g]:d.setAttribute(g,f[g])}}for(let g=p;g<e.length;g++){let m=e[g];if(m===0){if(g<e.length-1||g>p)throw new RangeError("Content hole must be the only child of its parent node");return{dom:d,contentDOM:d}}else{let{dom:y,contentDOM:b}=ph(t,m,n,r);if(d.appendChild(y),b){if(l)throw new RangeError("Multiple content holes");l=b}}}return{dom:d,contentDOM:l}}const G3=65535,X3=Math.pow(2,16);function JB(t,e){return t+e*X3}function WC(t){return t&G3}function ZB(t){return(t-(t&G3))/X3}const J3=1,Z3=2,gh=4,eM=8;class Ix{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&eM)>0}get deletedBefore(){return(this.delInfo&(J3|gh))>0}get deletedAfter(){return(this.delInfo&(Z3|gh))>0}get deletedAcross(){return(this.delInfo&gh)>0}}class wr{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&wr.empty)return wr.empty}recover(e){let n=0,r=WC(e);if(!this.inverted)for(let s=0;s<r;s++)n+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+n+ZB(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let s=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let d=this.ranges[l]-(this.inverted?s:0);if(d>e)break;let f=this.ranges[l+i],p=this.ranges[l+o],g=d+f;if(e<=g){let m=f?e==d?-1:e==g?1:n:n,y=d+s+(m<0?0:p);if(r)return y;let b=e==(n<0?d:g)?null:JB(l/3,e-d),v=e==d?Z3:e==g?J3:gh;return(n<0?e!=d:e!=g)&&(v|=eM),new Ix(y,v,b)}s+=p-f}return r?e+s:new Ix(e+s,0,null)}touches(e,n){let r=0,s=WC(n),i=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let d=this.ranges[l]-(this.inverted?r:0);if(d>e)break;let f=this.ranges[l+i],p=d+f;if(e<=p&&l==s*3)return!0;r+=this.ranges[l+o]-f}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let o=this.ranges[s],l=o-(this.inverted?i:0),d=o+(this.inverted?0:i),f=this.ranges[s+n],p=this.ranges[s+r];e(l,l+f,d,d+p),i+=p-f}}invert(){return new wr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?wr.empty:new wr(e<0?[0,-e,0]:[0,0,e])}}wr.empty=new wr([]);class Ku{constructor(e,n,r=0,s=e?e.length:0){this.mirror=n,this.from=r,this.to=s,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Ku(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let s=e.getMirror(n);this.appendMap(e._maps[n],s!=null&&s<n?r+s:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let s=e.getMirror(n);this.appendMap(e._maps[n].invert(),s!=null&&s>n?r-s-1:void 0)}}invert(){let e=new Ku;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let s=0;for(let i=this.from;i<this.to;i++){let o=this._maps[i],l=o.mapResult(e,n);if(l.recover!=null){let d=this.getMirror(i);if(d!=null&&d>i&&d<this.to){i=d,e=this._maps[d].recover(l.recover);continue}}s|=l.delInfo,e=l.pos}return r?e:new Ix(e,s,null)}}const X0=Object.create(null);class On{getMap(){return wr.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=X0[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in X0)throw new RangeError("Duplicate use of step JSON ID "+e);return X0[e]=n,n.prototype.jsonID=e,n}}class Gt{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new Gt(e,null)}static fail(e){return new Gt(null,e)}static fromReplace(e,n,r,s){try{return Gt.ok(e.replace(n,r,s))}catch(i){if(i instanceof $h)return Gt.fail(i.message);throw i}}}function cv(t,e,n){let r=[];for(let s=0;s<t.childCount;s++){let i=t.child(s);i.content.size&&(i=i.copy(cv(i.content,e,i))),i.isInline&&(i=e(i,n,s)),r.push(i)}return Ne.fromArray(r)}class na extends On{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new Ae(cv(n.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),n.openStart,n.openEnd);return Gt.fromReplace(e,this.from,this.to,i)}invert(){return new ls(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new na(n.pos,r.pos,this.mark)}merge(e){return e instanceof na&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new na(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new na(n.from,n.to,e.markFromJSON(n.mark))}}On.jsonID("addMark",na);class ls extends On{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new Ae(cv(n.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),n.openStart,n.openEnd);return Gt.fromReplace(e,this.from,this.to,r)}invert(){return new na(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new ls(n.pos,r.pos,this.mark)}merge(e){return e instanceof ls&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ls(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ls(n.from,n.to,e.markFromJSON(n.mark))}}On.jsonID("removeMark",ls);class ra extends On{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Gt.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return Gt.fromReplace(e,this.pos,this.pos+1,new Ae(Ne.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let s=0;s<n.marks.length;s++)if(!n.marks[s].isInSet(r))return new ra(this.pos,n.marks[s]);return new ra(this.pos,this.mark)}}return new oo(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new ra(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ra(n.pos,e.markFromJSON(n.mark))}}On.jsonID("addNodeMark",ra);class oo extends On{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Gt.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return Gt.fromReplace(e,this.pos,this.pos+1,new Ae(Ne.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new ra(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new oo(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new oo(n.pos,e.markFromJSON(n.mark))}}On.jsonID("removeNodeMark",oo);class dn extends On{constructor(e,n,r,s=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=s}apply(e){return this.structure&&Dx(e,this.from,this.to)?Gt.fail("Structure replace would overwrite content"):Gt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new wr([this.from,this.to-this.from,this.slice.size])}invert(e){return new dn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new dn(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof dn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?Ae.empty:new Ae(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new dn(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?Ae.empty:new Ae(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new dn(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new dn(n.from,n.to,Ae.fromJSON(e,n.slice),!!n.structure)}}On.jsonID("replace",dn);class fn extends On{constructor(e,n,r,s,i,o,l=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=o,this.structure=l}apply(e){if(this.structure&&(Dx(e,this.from,this.gapFrom)||Dx(e,this.gapTo,this.to)))return Gt.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return Gt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?Gt.fromReplace(e,this.from,this.to,r):Gt.fail("Content does not fit in gap")}getMap(){return new wr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new fn(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||s<n.pos||i>r.pos?null:new fn(n.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new fn(n.from,n.to,n.gapFrom,n.gapTo,Ae.fromJSON(e,n.slice),n.insert,!!n.structure)}}On.jsonID("replaceAround",fn);function Dx(t,e,n){let r=t.resolve(e),s=n-e,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function eF(t,e,n,r){let s=[],i=[],o,l;t.doc.nodesBetween(e,n,(d,f,p)=>{if(!d.isInline)return;let g=d.marks;if(!r.isInSet(g)&&p.type.allowsMarkType(r.type)){let m=Math.max(f,e),y=Math.min(f+d.nodeSize,n),b=r.addToSet(g);for(let v=0;v<g.length;v++)g[v].isInSet(b)||(o&&o.to==m&&o.mark.eq(g[v])?o.to=y:s.push(o=new ls(m,y,g[v])));l&&l.to==m?l.to=y:i.push(l=new na(m,y,r))}}),s.forEach(d=>t.step(d)),i.forEach(d=>t.step(d))}function tF(t,e,n,r){let s=[],i=0;t.doc.nodesBetween(e,n,(o,l)=>{if(!o.isInline)return;i++;let d=null;if(r instanceof Jp){let f=o.marks,p;for(;p=r.isInSet(f);)(d||(d=[])).push(p),f=p.removeFromSet(f)}else r?r.isInSet(o.marks)&&(d=[r]):d=o.marks;if(d&&d.length){let f=Math.min(l+o.nodeSize,n);for(let p=0;p<d.length;p++){let g=d[p],m;for(let y=0;y<s.length;y++){let b=s[y];b.step==i-1&&g.eq(s[y].style)&&(m=b)}m?(m.to=f,m.step=i):s.push({style:g,from:Math.max(l,e),to:f,step:i})}}}),s.forEach(o=>t.step(new ls(o.from,o.to,o.style)))}function uv(t,e,n,r=n.contentMatch,s=!0){let i=t.doc.nodeAt(e),o=[],l=e+1;for(let d=0;d<i.childCount;d++){let f=i.child(d),p=l+f.nodeSize,g=r.matchType(f.type);if(!g)o.push(new dn(l,p,Ae.empty));else{r=g;for(let m=0;m<f.marks.length;m++)n.allowsMarkType(f.marks[m].type)||t.step(new ls(l,p,f.marks[m]));if(s&&f.isText&&n.whitespace!="pre"){let m,y=/\r?\n|\r/g,b;for(;m=y.exec(f.text);)b||(b=new Ae(Ne.from(n.schema.text(" ",n.allowedMarks(f.marks))),0,0)),o.push(new dn(l+m.index,l+m.index+m[0].length,b))}}l=p}if(!r.validEnd){let d=r.fillBefore(Ne.empty,!0);t.replace(l,l,new Ae(d,0,0))}for(let d=o.length-1;d>=0;d--)t.step(o[d])}function nF(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function ac(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth,s=0,i=0;;--r){let o=t.$from.node(r),l=t.$from.index(r)+s,d=t.$to.indexAfter(r)-i;if(r<t.depth&&o.canReplace(l,d,n))return r;if(r==0||o.type.spec.isolating||!nF(o,l,d))break;l&&(s=1),d<o.childCount&&(i=1)}return null}function rF(t,e,n){let{$from:r,$to:s,depth:i}=e,o=r.before(i+1),l=s.after(i+1),d=o,f=l,p=Ne.empty,g=0;for(let b=i,v=!1;b>n;b--)v||r.index(b)>0?(v=!0,p=Ne.from(r.node(b).copy(p)),g++):d--;let m=Ne.empty,y=0;for(let b=i,v=!1;b>n;b--)v||s.after(b+1)<s.end(b)?(v=!0,m=Ne.from(s.node(b).copy(m)),y++):f++;t.step(new fn(d,f,o,l,new Ae(p.append(m),g,y),p.size-g,!0))}function dv(t,e,n=null,r=t){let s=sF(t,e),i=s&&iF(r,e);return i?s.map(YC).concat({type:e,attrs:n}).concat(i.map(YC)):null}function YC(t){return{type:t,attrs:null}}function sF(t,e){let{parent:n,startIndex:r,endIndex:s}=t,i=n.contentMatchAt(r).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return n.canReplaceWith(r,s,o)?i:null}function iF(t,e){let{parent:n,startIndex:r,endIndex:s}=t,i=n.child(r),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let d=(o.length?o[o.length-1]:e).contentMatch;for(let f=r;d&&f<s;f++)d=d.matchType(n.child(f).type);return!d||!d.validEnd?null:o}function aF(t,e,n){let r=Ne.empty;for(let o=n.length-1;o>=0;o--){if(r.size){let l=n[o].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=Ne.from(n[o].type.create(n[o].attrs,r))}let s=e.start,i=e.end;t.step(new fn(s,i,s,i,new Ae(r,0,0),n.length,!0))}function oF(t,e,n,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=t.steps.length;t.doc.nodesBetween(e,n,(o,l)=>{let d=typeof s=="function"?s(o):s;if(o.isTextblock&&!o.hasMarkup(r,d)&&lF(t.doc,t.mapping.slice(i).map(l),r)){let f=null;if(r.schema.linebreakReplacement){let y=r.whitespace=="pre",b=!!r.contentMatch.matchType(r.schema.linebreakReplacement);y&&!b?f=!1:!y&&b&&(f=!0)}f===!1&&nM(t,o,l,i),uv(t,t.mapping.slice(i).map(l,1),r,void 0,f===null);let p=t.mapping.slice(i),g=p.map(l,1),m=p.map(l+o.nodeSize,1);return t.step(new fn(g,m,g+1,m-1,new Ae(Ne.from(r.create(d,null,o.marks)),0,0),1,!0)),f===!0&&tM(t,o,l,i),!1}})}function tM(t,e,n,r){e.forEach((s,i)=>{if(s.isText){let o,l=/\r?\n|\r/g;for(;o=l.exec(s.text);){let d=t.mapping.slice(r).map(n+1+i+o.index);t.replaceWith(d,d+1,e.type.schema.linebreakReplacement.create())}}})}function nM(t,e,n,r){e.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let o=t.mapping.slice(r).map(n+1+i);t.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function lF(t,e,n){let r=t.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,n)}function cF(t,e,n,r,s){let i=t.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let o=n.create(r,null,s||i.marks);if(i.isLeaf)return t.replaceWith(e,e+i.nodeSize,o);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new fn(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new Ae(Ne.from(o),0,0),1,!0))}function li(t,e,n=1,r){let s=t.resolve(e),i=s.depth-n,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let f=s.depth-1,p=n-2;f>i;f--,p--){let g=s.node(f),m=s.index(f);if(g.type.spec.isolating)return!1;let y=g.content.cutByIndex(m,g.childCount),b=r&&r[p+1];b&&(y=y.replaceChild(0,b.type.create(b.attrs)));let v=r&&r[p]||g;if(!g.canReplace(m+1,g.childCount)||!v.type.validContent(y))return!1}let l=s.indexAfter(i),d=r&&r[0];return s.node(i).canReplaceWith(l,l,d?d.type:s.node(i+1).type)}function uF(t,e,n=1,r){let s=t.doc.resolve(e),i=Ne.empty,o=Ne.empty;for(let l=s.depth,d=s.depth-n,f=n-1;l>d;l--,f--){i=Ne.from(s.node(l).copy(i));let p=r&&r[f];o=Ne.from(p?p.type.create(p.attrs,o):s.node(l).copy(o))}t.step(new dn(e,e,new Ae(i.append(o),n,n),!0))}function xa(t,e){let n=t.resolve(e),r=n.index();return rM(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function dF(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let s=0;s<e.childCount;s++){let i=e.child(s),o=i.type==r?t.type.schema.nodes.text:i.type;if(n=n.matchType(o),!n||!t.type.allowsMarks(i.marks))return!1}return n.validEnd}function rM(t,e){return!!(t&&e&&!t.isLeaf&&dF(t,e))}function Zp(t,e,n=-1){let r=t.resolve(e);for(let s=r.depth;;s--){let i,o,l=r.index(s);if(s==r.depth?(i=r.nodeBefore,o=r.nodeAfter):n>0?(i=r.node(s+1),l++,o=r.node(s).maybeChild(l)):(i=r.node(s).maybeChild(l-1),o=r.node(s+1)),i&&!i.isTextblock&&rM(i,o)&&r.node(s).canReplace(l,l+1))return e;if(s==0)break;e=n<0?r.before(s):r.after(s)}}function fF(t,e,n){let r=null,{linebreakReplacement:s}=t.doc.type.schema,i=t.doc.resolve(e-n),o=i.node().type;if(s&&o.inlineContent){let p=o.whitespace=="pre",g=!!o.contentMatch.matchType(s);p&&!g?r=!1:!p&&g&&(r=!0)}let l=t.steps.length;if(r===!1){let p=t.doc.resolve(e+n);nM(t,p.node(),p.before(),l)}o.inlineContent&&uv(t,e+n-1,o,i.node().contentMatchAt(i.index()),r==null);let d=t.mapping.slice(l),f=d.map(e-n);if(t.step(new dn(f,d.map(e+n,-1),Ae.empty,!0)),r===!0){let p=t.doc.resolve(f);tM(t,p.node(),p.before(),t.steps.length)}return t}function hF(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,n))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,n))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function sM(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let s=n.content;for(let i=0;i<n.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(n.openStart==0&&n.size?2:1);i++)for(let o=r.depth;o>=0;o--){let l=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,d=r.index(o)+(l>0?1:0),f=r.node(o),p=!1;if(i==1)p=f.canReplace(d,d,s);else{let g=f.contentMatchAt(d).findWrapping(s.firstChild.type);p=g&&f.canReplaceWith(d,d,g[0])}if(p)return l==0?r.pos:l<0?r.before(o+1):r.after(o+1)}return null}function eg(t,e,n=e,r=Ae.empty){if(e==n&&!r.size)return null;let s=t.resolve(e),i=t.resolve(n);return iM(s,i,r)?new dn(e,n,r):new pF(s,i,r).fit()}function iM(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class pF{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=Ne.empty;for(let s=0;s<=e.depth;s++){let i=e.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=Ne.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let f=this.findFittable();f?this.placeNodes(f):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let i=this.placed,o=r.depth,l=s.depth;for(;o&&l&&i.childCount==1;)i=i.firstChild.content,o--,l--;let d=new Ae(i,o,l);return e>-1?new fn(r.pos,e,this.$to.pos,this.$to.end(),d,n):d.size||r.pos!=this.$to.pos?new dn(r.pos,s.pos,d):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let i=n.firstChild;if(n.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){e=r;break}n=i.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=J0(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let o=s.firstChild;for(let l=this.depth;l>=0;l--){let{type:d,match:f}=this.frontier[l],p,g=null;if(n==1&&(o?f.matchType(o.type)||(g=f.fillBefore(Ne.from(o),!1)):i&&d.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:l,parent:i,inject:g};if(n==2&&o&&(p=f.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:l,parent:i,wrap:p};if(i&&f.matchType(i.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=J0(e,n);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new Ae(e,n+1,Math.max(r,s.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=J0(e,n);if(s.childCount<=1&&n>0){let i=e.size-n<=n+s.size;this.unplaced=new Ae(lu(e,n-1,1),n-1,i?n-1:r)}else this.unplaced=new Ae(lu(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:s,wrap:i}){for(;this.depth>n;)this.closeFrontierNode();if(i)for(let v=0;v<i.length;v++)this.openFrontierNode(i[v]);let o=this.unplaced,l=r?r.content:o.content,d=o.openStart-e,f=0,p=[],{match:g,type:m}=this.frontier[n];if(s){for(let v=0;v<s.childCount;v++)p.push(s.child(v));g=g.matchFragment(s)}let y=l.size+e-(o.content.size-o.openEnd);for(;f<l.childCount;){let v=l.child(f),w=g.matchType(v.type);if(!w)break;f++,(f>1||d==0||v.content.size)&&(g=w,p.push(aM(v.mark(m.allowedMarks(v.marks)),f==1?d:0,f==l.childCount?y:-1)))}let b=f==l.childCount;b||(y=-1),this.placed=cu(this.placed,n,Ne.from(p)),this.frontier[n].match=g,b&&y<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,w=l;v<y;v++){let S=w.lastChild;this.frontier.push({type:S.type,match:S.contentMatchAt(S.childCount)}),w=S.content}this.unplaced=b?e==0?Ae.empty:new Ae(lu(o.content,e-1,1),e-1,y<0?o.openEnd:e-1):new Ae(lu(o.content,e,f),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Z0(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:s}=this.frontier[n],i=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),o=Z0(e,n,s,r,i);if(o){for(let l=n-1;l>=0;l--){let{match:d,type:f}=this.frontier[l],p=Z0(e,l,f,d,!0);if(!p||p.childCount)continue e}return{depth:n,fit:o,move:i?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=cu(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let s=e.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,i)}return e}openFrontierNode(e,n=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=cu(this.placed,this.depth,Ne.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(Ne.empty,!0);n.childCount&&(this.placed=cu(this.placed,this.frontier.length,n))}}function lu(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(lu(t.firstChild.content,e-1,n)))}function cu(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(cu(t.lastChild.content,e-1,n)))}function J0(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function aM(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,aM(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(Ne.empty,!0)))),t.copy(r)}function Z0(t,e,n,r,s){let i=t.node(e),o=s?t.indexAfter(e):t.index(e);if(o==i.childCount&&!n.compatibleContent(i.type))return null;let l=r.fillBefore(i.content,!0,o);return l&&!gF(n,i.content,o)?l:null}function gF(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function mF(t){return t.spec.defining||t.spec.definingForContent}function yF(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let s=t.doc.resolve(e),i=t.doc.resolve(n);if(iM(s,i,r))return t.step(new dn(e,n,r));let o=lM(s,i);o[o.length-1]==0&&o.pop();let l=-(s.depth+1);o.unshift(l);for(let m=s.depth,y=s.pos-1;m>0;m--,y--){let b=s.node(m).type.spec;if(b.defining||b.definingAsContext||b.isolating)break;o.indexOf(m)>-1?l=m:s.before(m)==y&&o.splice(1,0,-m)}let d=o.indexOf(l),f=[],p=r.openStart;for(let m=r.content,y=0;;y++){let b=m.firstChild;if(f.push(b),y==r.openStart)break;m=b.content}for(let m=p-1;m>=0;m--){let y=f[m],b=mF(y.type);if(b&&!y.sameMarkup(s.node(Math.abs(l)-1)))p=m;else if(b||!y.type.isTextblock)break}for(let m=r.openStart;m>=0;m--){let y=(m+p+1)%(r.openStart+1),b=f[y];if(b)for(let v=0;v<o.length;v++){let w=o[(v+d)%o.length],S=!0;w<0&&(S=!1,w=-w);let T=s.node(w-1),j=s.index(w-1);if(T.canReplaceWith(j,j,b.type,b.marks))return t.replace(s.before(w),S?i.after(w):n,new Ae(oM(r.content,0,r.openStart,y),y,r.openEnd))}}let g=t.steps.length;for(let m=o.length-1;m>=0&&(t.replace(e,n,r),!(t.steps.length>g));m--){let y=o[m];y<0||(e=s.before(y),n=i.after(y))}}function oM(t,e,n,r,s){if(e<n){let i=t.firstChild;t=t.replaceChild(0,i.copy(oM(i.content,e+1,n,r,i)))}if(e>r){let i=s.contentMatchAt(0),o=i.fillBefore(t).append(t);t=o.append(i.matchFragment(o).fillBefore(Ne.empty,!0))}return t}function xF(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let s=hF(t.doc,e,r.type);s!=null&&(e=n=s)}t.replaceRange(e,n,new Ae(Ne.from(r),0,0))}function bF(t,e,n){let r=t.doc.resolve(e),s=t.doc.resolve(n),i=lM(r,s);for(let o=0;o<i.length;o++){let l=i[o],d=o==i.length-1;if(d&&l==0||r.node(l).type.contentMatch.validEnd)return t.delete(r.start(l),s.end(l));if(l>0&&(d||r.node(l-1).canReplace(r.index(l-1),s.indexAfter(l-1))))return t.delete(r.before(l),s.after(l))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(e-r.start(o)==r.depth-o&&n>r.end(o)&&s.end(o)-n!=s.depth-o&&r.start(o-1)==s.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),s.index(o-1)))return t.delete(r.before(o),n);t.delete(e,n)}function lM(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let s=r;s>=0;s--){let i=t.start(s);if(i<t.pos-(t.depth-s)||e.end(s)>e.pos+(e.depth-s)||t.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(i==e.start(s)||s==t.depth&&s==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==i-1)&&n.push(s)}return n}class Ll extends On{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return Gt.fail("No node at attribute step's position");let r=Object.create(null);for(let i in n.attrs)r[i]=n.attrs[i];r[this.attr]=this.value;let s=n.type.create(r,null,n.marks);return Gt.fromReplace(e,this.pos,this.pos+1,new Ae(Ne.from(s),0,n.isLeaf?0:1))}getMap(){return wr.empty}invert(e){return new Ll(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Ll(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ll(n.pos,n.attr,n.value)}}On.jsonID("attr",Ll);class Qu extends On{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let s in e.attrs)n[s]=e.attrs[s];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return Gt.ok(r)}getMap(){return wr.empty}invert(e){return new Qu(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Qu(n.attr,n.value)}}On.jsonID("docAttr",Qu);let ql=class extends Error{};ql=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};ql.prototype=Object.create(Error.prototype);ql.prototype.constructor=ql;ql.prototype.name="TransformError";class cM{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Ku}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new ql(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=Ae.empty){let s=eg(this.doc,e,n,r);return s&&this.step(s),this}replaceWith(e,n,r){return this.replace(e,n,new Ae(Ne.from(r),0,0))}delete(e,n){return this.replace(e,n,Ae.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return yF(this,e,n,r),this}replaceRangeWith(e,n,r){return xF(this,e,n,r),this}deleteRange(e,n){return bF(this,e,n),this}lift(e,n){return rF(this,e,n),this}join(e,n=1){return fF(this,e,n),this}wrap(e,n){return aF(this,e,n),this}setBlockType(e,n=e,r,s=null){return oF(this,e,n,r,s),this}setNodeMarkup(e,n,r=null,s){return cF(this,e,n,r,s),this}setNodeAttribute(e,n,r){return this.step(new Ll(e,n,r)),this}setDocAttribute(e,n){return this.step(new Qu(e,n)),this}addNodeMark(e,n){return this.step(new ra(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof kt)n.isInSet(r.marks)&&this.step(new oo(e,n));else{let s=r.marks,i,o=[];for(;i=n.isInSet(s);)o.push(new oo(e,i)),s=i.removeFromSet(s);for(let l=o.length-1;l>=0;l--)this.step(o[l])}return this}split(e,n=1,r){return uF(this,e,n,r),this}addMark(e,n,r){return eF(this,e,n,r),this}removeMark(e,n,r){return tF(this,e,n,r),this}clearIncompatible(e,n,r){return uv(this,e,n,r),this}}const ey=Object.create(null);class Ge{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new vF(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=Ae.empty){let r=n.content.lastChild,s=null;for(let l=0;l<n.openEnd;l++)s=r,r=r.lastChild;let i=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:d,$to:f}=o[l],p=e.mapping.slice(i);e.replaceRange(p.map(d.pos),p.map(f.pos),l?Ae.empty:n),l==0&&JC(e,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:o,$to:l}=s[i],d=e.mapping.slice(r),f=d.map(o.pos),p=d.map(l.pos);i?e.deleteRange(f,p):(e.replaceRangeWith(f,p,n),JC(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let s=e.parent.inlineContent?new qe(e):Al(e.node(0),e.parent,e.pos,e.index(),n,r);if(s)return s;for(let i=e.depth-1;i>=0;i--){let o=n<0?Al(e.node(0),e.node(i),e.before(i+1),e.index(i),n,r):Al(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,n,r);if(o)return o}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new kr(e.node(0))}static atStart(e){return Al(e,e,0,0,1)||new kr(e)}static atEnd(e){return Al(e,e,e.content.size,e.childCount,-1)||new kr(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=ey[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in ey)throw new RangeError("Duplicate use of selection JSON ID "+e);return ey[e]=n,n.prototype.jsonID=e,n}getBookmark(){return qe.between(this.$anchor,this.$head).getBookmark()}}Ge.prototype.visible=!0;class vF{constructor(e,n){this.$from=e,this.$to=n}}let GC=!1;function XC(t){!GC&&!t.parent.inlineContent&&(GC=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class qe extends Ge{constructor(e,n=e){XC(e),XC(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return Ge.near(r);let s=e.resolve(n.map(this.anchor));return new qe(s.parent.inlineContent?s:r,r)}replace(e,n=Ae.empty){if(super.replace(e,n),n==Ae.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof qe&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new tg(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new qe(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let s=e.resolve(n);return new this(s,r==n?s:e.resolve(r))}static between(e,n,r){let s=e.pos-n.pos;if((!r||s)&&(r=s>=0?1:-1),!n.parent.inlineContent){let i=Ge.findFrom(n,r,!0)||Ge.findFrom(n,-r,!0);if(i)n=i.$head;else return Ge.near(n,r)}return e.parent.inlineContent||(s==0?e=n:(e=(Ge.findFrom(e,-r,!0)||Ge.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=s<0&&(e=n))),new qe(e,n)}}Ge.jsonID("text",qe);class tg{constructor(e,n){this.anchor=e,this.head=n}map(e){return new tg(e.map(this.anchor),e.map(this.head))}resolve(e){return qe.between(e.resolve(this.anchor),e.resolve(this.head))}}class Be extends Ge{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:s}=n.mapResult(this.anchor),i=e.resolve(s);return r?Ge.near(i):new Be(i)}content(){return new Ae(Ne.from(this.node),0,0)}eq(e){return e instanceof Be&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new fv(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Be(e.resolve(n.anchor))}static create(e,n){return new Be(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}Be.prototype.visible=!1;Ge.jsonID("node",Be);class fv{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new tg(r,r):new fv(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&Be.isSelectable(r)?new Be(n):Ge.near(n)}}class kr extends Ge{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=Ae.empty){if(n==Ae.empty){e.delete(0,e.doc.content.size);let r=Ge.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new kr(e)}map(e){return new kr(e)}eq(e){return e instanceof kr}getBookmark(){return wF}}Ge.jsonID("all",kr);const wF={map(){return this},resolve(t){return new kr(t)}};function Al(t,e,n,r,s,i=!1){if(e.inlineContent)return qe.create(t,n);for(let o=r-(s>0?0:1);s>0?o<e.childCount:o>=0;o+=s){let l=e.child(o);if(l.isAtom){if(!i&&Be.isSelectable(l))return Be.create(t,n-(s<0?l.nodeSize:0))}else{let d=Al(t,l,n+s,s<0?l.childCount:0,s,i);if(d)return d}n+=l.nodeSize*s}return null}function JC(t,e,n){let r=t.steps.length-1;if(r<e)return;let s=t.steps[r];if(!(s instanceof dn||s instanceof fn))return;let i=t.mapping.maps[r],o;i.forEach((l,d,f,p)=>{o==null&&(o=p)}),t.setSelection(Ge.near(t.doc.resolve(o),n))}const ZC=1,Jf=2,eN=4;class SF extends cM{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|ZC)&~Jf,this.storedMarks=null,this}get selectionSet(){return(this.updated&ZC)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Jf,this}ensureMarks(e){return kt.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Jf)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Jf,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||kt.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let s=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),!e)return this.deleteRange(n,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(n);i=r==n?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,s.text(e,i)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(Ge.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=eN,this}get scrolledIntoView(){return(this.updated&eN)>0}}function tN(t,e){return!e||!t?t:t.bind(e)}class uu{constructor(e,n,r){this.name=e,this.init=tN(n.init,r),this.apply=tN(n.apply,r)}}const kF=[new uu("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new uu("selection",{init(t,e){return t.selection||Ge.atStart(e.doc)},apply(t){return t.selection}}),new uu("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new uu("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class ty{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=kF.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new uu(r.key,r.spec.state,r))})}}class Il{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),s=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let d=s?s[o].n:0,f=s?s[o].state:this,p=d<n.length&&l.spec.appendTransaction.call(l,d?n.slice(d):n,f,r);if(p&&r.filterTransaction(p,o)){if(p.setMeta("appendedTransaction",e),!s){s=[];for(let g=0;g<this.config.plugins.length;g++)s.push(g<o?{state:r,n:n.length}:{state:this,n:0})}n.push(p),r=r.applyInner(p),i=!0}s&&(s[o]={state:r,n:n.length})}}if(!i)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new Il(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];n[i.name]=i.apply(e,this[i.name],this,n)}return n}get tr(){return new SF(this)}static create(e){let n=new ty(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Il(n);for(let s=0;s<n.fields.length;s++)r[n.fields[s].name]=n.fields[s].init(e,r);return r}reconfigure(e){let n=new ty(this.schema,e.plugins),r=n.fields,s=new Il(n);for(let i=0;i<r.length;i++){let o=r[i].name;s[o]=this.hasOwnProperty(o)?this[o]:r[i].init(e,s)}return s}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],i=s.spec.state;i&&i.toJSON&&(n[r]=i.toJSON.call(s,this[s.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new ty(e.schema,e.plugins),i=new Il(s);return s.fields.forEach(o=>{if(o.name=="doc")i.doc=ua.fromJSON(e.schema,n.doc);else if(o.name=="selection")i.selection=Ge.fromJSON(i.doc,n.selection);else if(o.name=="storedMarks")n.storedMarks&&(i.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let d=r[l],f=d.spec.state;if(d.key==o.name&&f&&f.fromJSON&&Object.prototype.hasOwnProperty.call(n,l)){i[o.name]=f.fromJSON.call(d,e,n[l],i);return}}i[o.name]=o.init(e,i)}}),i}}function uM(t,e,n){for(let r in t){let s=t[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=uM(s,e,{})),n[r]=s}return n}class _t{constructor(e){this.spec=e,this.props={},e.props&&uM(e.props,this,this.props),this.key=e.key?e.key.key:dM("plugin")}getState(e){return e[this.key]}}const ny=Object.create(null);function dM(t){return t in ny?t+"$"+ ++ny[t]:(ny[t]=0,t+"$")}class an{constructor(e="key"){this.key=dM(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const hv=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function fM(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const hM=(t,e,n)=>{let r=fM(t,n);if(!r)return!1;let s=pv(r);if(!s){let o=r.blockRange(),l=o&&ac(o);return l==null?!1:(e&&e(t.tr.lift(o,l).scrollIntoView()),!0)}let i=s.nodeBefore;if(SM(t,s,e,-1))return!0;if(r.parent.content.size==0&&(Hl(i,"end")||Be.isSelectable(i)))for(let o=r.depth;;o--){let l=eg(t.doc,r.before(o),r.after(o),Ae.empty);if(l&&l.slice.size<l.to-l.from){if(e){let d=t.tr.step(l);d.setSelection(Hl(i,"end")?Ge.findFrom(d.doc.resolve(d.mapping.map(s.pos,-1)),-1):Be.create(d.doc,s.pos-i.nodeSize)),e(d.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return i.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1},CF=(t,e,n)=>{let r=fM(t,n);if(!r)return!1;let s=pv(r);return s?pM(t,s,e):!1},NF=(t,e,n)=>{let r=mM(t,n);if(!r)return!1;let s=gv(r);return s?pM(t,s,e):!1};function pM(t,e,n){let r=e.nodeBefore,s=r,i=e.pos-1;for(;!s.isTextblock;i--){if(s.type.spec.isolating)return!1;let p=s.lastChild;if(!p)return!1;s=p}let o=e.nodeAfter,l=o,d=e.pos+1;for(;!l.isTextblock;d++){if(l.type.spec.isolating)return!1;let p=l.firstChild;if(!p)return!1;l=p}let f=eg(t.doc,i,d,Ae.empty);if(!f||f.from!=i||f instanceof dn&&f.slice.size>=d-i)return!1;if(n){let p=t.tr.step(f);p.setSelection(qe.create(p.doc,i)),n(p.scrollIntoView())}return!0}function Hl(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const gM=(t,e,n)=>{let{$head:r,empty:s}=t.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;i=pv(r)}let o=i&&i.nodeBefore;return!o||!Be.isSelectable(o)?!1:(e&&e(t.tr.setSelection(Be.create(t.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function pv(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function mM(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const yM=(t,e,n)=>{let r=mM(t,n);if(!r)return!1;let s=gv(r);if(!s)return!1;let i=s.nodeAfter;if(SM(t,s,e,1))return!0;if(r.parent.content.size==0&&(Hl(i,"start")||Be.isSelectable(i))){let o=eg(t.doc,r.before(),r.after(),Ae.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(Hl(i,"start")?Ge.findFrom(l.doc.resolve(l.mapping.map(s.pos)),1):Be.create(l.doc,l.mapping.map(s.pos))),e(l.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},xM=(t,e,n)=>{let{$head:r,empty:s}=t.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;i=gv(r)}let o=i&&i.nodeAfter;return!o||!Be.isSelectable(o)?!1:(e&&e(t.tr.setSelection(Be.create(t.doc,i.pos)).scrollIntoView()),!0)};function gv(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const TF=(t,e)=>{let n=t.selection,r=n instanceof Be,s;if(r){if(n.node.isTextblock||!xa(t.doc,n.from))return!1;s=n.from}else if(s=Zp(t.doc,n.from,-1),s==null)return!1;if(e){let i=t.tr.join(s);r&&i.setSelection(Be.create(i.doc,s-t.doc.resolve(s).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},jF=(t,e)=>{let n=t.selection,r;if(n instanceof Be){if(n.node.isTextblock||!xa(t.doc,n.to))return!1;r=n.to}else if(r=Zp(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},EF=(t,e)=>{let{$from:n,$to:r}=t.selection,s=n.blockRange(r),i=s&&ac(s);return i==null?!1:(e&&e(t.tr.lift(s,i).scrollIntoView()),!0)},bM=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function mv(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const MF=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let s=n.node(-1),i=n.indexAfter(-1),o=mv(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(e){let l=n.after(),d=t.tr.replaceWith(l,l,o.createAndFill());d.setSelection(Ge.near(d.doc.resolve(l),1)),e(d.scrollIntoView())}return!0},vM=(t,e)=>{let n=t.selection,{$from:r,$to:s}=n;if(n instanceof kr||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=mv(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,l=t.tr.insert(o,i.createAndFill());l.setSelection(qe.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},wM=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let i=n.before();if(li(t.doc,i))return e&&e(t.tr.split(i).scrollIntoView()),!0}let r=n.blockRange(),s=r&&ac(r);return s==null?!1:(e&&e(t.tr.lift(r,s).scrollIntoView()),!0)};function AF(t){return(e,n)=>{let{$from:r,$to:s}=e.selection;if(e.selection instanceof Be&&e.selection.node.isBlock)return!r.parentOffset||!li(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let i=[],o,l,d=!1,f=!1;for(let y=r.depth;;y--)if(r.node(y).isBlock){d=r.end(y)==r.pos+(r.depth-y),f=r.start(y)==r.pos-(r.depth-y),l=mv(r.node(y-1).contentMatchAt(r.indexAfter(y-1))),i.unshift(d&&l?{type:l}:null),o=y;break}else{if(y==1)return!1;i.unshift(null)}let p=e.tr;(e.selection instanceof qe||e.selection instanceof kr)&&p.deleteSelection();let g=p.mapping.map(r.pos),m=li(p.doc,g,i.length,i);if(m||(i[0]=l?{type:l}:null,m=li(p.doc,g,i.length,i)),!m)return!1;if(p.split(g,i.length,i),!d&&f&&r.node(o).type!=l){let y=p.mapping.map(r.before(o)),b=p.doc.resolve(y);l&&r.node(o-1).canReplaceWith(b.index(),b.index()+1,l)&&p.setNodeMarkup(p.mapping.map(r.before(o)),l)}return n&&n(p.scrollIntoView()),!0}}const RF=AF(),_F=(t,e)=>{let{$from:n,to:r}=t.selection,s,i=n.sharedDepth(r);return i==0?!1:(s=n.before(i),e&&e(t.tr.setSelection(Be.create(t.doc,s))),!0)};function OF(t,e,n){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(s.isTextblock||xa(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function SM(t,e,n,r){let s=e.nodeBefore,i=e.nodeAfter,o,l,d=s.type.spec.isolating||i.type.spec.isolating;if(!d&&OF(t,e,n))return!0;let f=!d&&e.parent.canReplace(e.index(),e.index()+1);if(f&&(o=(l=s.contentMatchAt(s.childCount)).findWrapping(i.type))&&l.matchType(o[0]||i.type).validEnd){if(n){let y=e.pos+i.nodeSize,b=Ne.empty;for(let S=o.length-1;S>=0;S--)b=Ne.from(o[S].create(null,b));b=Ne.from(s.copy(b));let v=t.tr.step(new fn(e.pos-1,y,e.pos,y,new Ae(b,1,0),o.length,!0)),w=v.doc.resolve(y+2*o.length);w.nodeAfter&&w.nodeAfter.type==s.type&&xa(v.doc,w.pos)&&v.join(w.pos),n(v.scrollIntoView())}return!0}let p=i.type.spec.isolating||r>0&&d?null:Ge.findFrom(e,1),g=p&&p.$from.blockRange(p.$to),m=g&&ac(g);if(m!=null&&m>=e.depth)return n&&n(t.tr.lift(g,m).scrollIntoView()),!0;if(f&&Hl(i,"start",!0)&&Hl(s,"end")){let y=s,b=[];for(;b.push(y),!y.isTextblock;)y=y.lastChild;let v=i,w=1;for(;!v.isTextblock;v=v.firstChild)w++;if(y.canReplace(y.childCount,y.childCount,v.content)){if(n){let S=Ne.empty;for(let j=b.length-1;j>=0;j--)S=Ne.from(b[j].copy(S));let T=t.tr.step(new fn(e.pos-b.length,e.pos+i.nodeSize,e.pos+w,e.pos+i.nodeSize-w,new Ae(S,b.length,0),0,!0));n(T.scrollIntoView())}return!0}}return!1}function kM(t){return function(e,n){let r=e.selection,s=t<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(n&&n(e.tr.setSelection(qe.create(e.doc,t<0?s.start(i):s.end(i)))),!0):!1}}const IF=kM(-1),DF=kM(1);function LF(t,e=null){return function(n,r){let{$from:s,$to:i}=n.selection,o=s.blockRange(i),l=o&&dv(o,t,e);return l?(r&&r(n.tr.wrap(o,l).scrollIntoView()),!0):!1}}function nN(t,e=null){return function(n,r){let s=!1;for(let i=0;i<n.selection.ranges.length&&!s;i++){let{$from:{pos:o},$to:{pos:l}}=n.selection.ranges[i];n.doc.nodesBetween(o,l,(d,f)=>{if(s)return!1;if(!(!d.isTextblock||d.hasMarkup(t,e)))if(d.type==t)s=!0;else{let p=n.doc.resolve(f),g=p.index();s=p.parent.canReplaceWith(g,g+1,t)}})}if(!s)return!1;if(r){let i=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:d}}=n.selection.ranges[o];i.setBlockType(l,d,t,e)}r(i.scrollIntoView())}return!0}}function yv(...t){return function(e,n,r){for(let s=0;s<t.length;s++)if(t[s](e,n,r))return!0;return!1}}yv(hv,hM,gM);yv(hv,yM,xM);yv(bM,vM,wM,RF);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function zF(t,e=null){return function(n,r){let{$from:s,$to:i}=n.selection,o=s.blockRange(i);if(!o)return!1;let l=r?n.tr:null;return PF(l,o,t,e)?(r&&r(l.scrollIntoView()),!0):!1}}function PF(t,e,n,r=null){let s=!1,i=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let d=o.resolve(e.start-2);i=new Hh(d,d,e.depth),e.endIndex<e.parent.childCount&&(e=new Hh(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let l=dv(i,n,r,e);return l?(t&&BF(t,e,l,s,n),!0):!1}function BF(t,e,n,r,s){let i=Ne.empty;for(let p=n.length-1;p>=0;p--)i=Ne.from(n[p].type.create(n[p].attrs,i));t.step(new fn(e.start-(r?2:0),e.end,e.start,e.end,new Ae(i,0,0),n.length,!0));let o=0;for(let p=0;p<n.length;p++)n[p].type==s&&(o=p+1);let l=n.length-o,d=e.start+n.length-(r?2:0),f=e.parent;for(let p=e.startIndex,g=e.endIndex,m=!0;p<g;p++,m=!1)!m&&li(t.doc,d,l)&&(t.split(d,l),d+=2*l),d+=f.child(p).nodeSize;return t}function FF(t){return function(e,n){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==t);return i?n?r.node(i.depth-1).type==t?UF(e,n,t,i):$F(e,n,i):!0:!1}}function UF(t,e,n,r){let s=t.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new fn(i-1,o,i,o,new Ae(Ne.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Hh(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const l=ac(r);if(l==null)return!1;s.lift(r,l);let d=s.doc.resolve(s.mapping.map(i,-1)-1);return xa(s.doc,d.pos)&&d.nodeBefore.type==d.nodeAfter.type&&s.join(d.pos),e(s.scrollIntoView()),!0}function $F(t,e,n){let r=t.tr,s=n.parent;for(let y=n.end,b=n.endIndex-1,v=n.startIndex;b>v;b--)y-=s.child(b).nodeSize,r.delete(y-1,y+1);let i=r.doc.resolve(n.start),o=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let l=n.startIndex==0,d=n.endIndex==s.childCount,f=i.node(-1),p=i.index(-1);if(!f.canReplace(p+(l?0:1),p+1,o.content.append(d?Ne.empty:Ne.from(s))))return!1;let g=i.pos,m=g+o.nodeSize;return r.step(new fn(g-(l?1:0),m+(d?1:0),g+1,m-1,new Ae((l?Ne.empty:Ne.from(s.copy(Ne.empty))).append(d?Ne.empty:Ne.from(s.copy(Ne.empty))),l?0:1,d?0:1),l?0:1)),e(r.scrollIntoView()),!0}function qF(t){return function(e,n){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,f=>f.childCount>0&&f.firstChild.type==t);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let l=i.parent,d=l.child(o-1);if(d.type!=t)return!1;if(n){let f=d.lastChild&&d.lastChild.type==l.type,p=Ne.from(f?t.create():null),g=new Ae(Ne.from(t.create(null,Ne.from(l.type.create(null,p)))),f?3:1,0),m=i.start,y=i.end;n(e.tr.step(new fn(m-(f?3:1),y,m,y,g,1,!0)).scrollIntoView())}return!0}}const Sn=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Vl=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Lx=null;const si=function(t,e,n){let r=Lx||(Lx=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},HF=function(){Lx=null},lo=function(t,e,n,r){return n&&(rN(t,e,n,r,-1)||rN(t,e,n,r,1))},VF=/^(img|br|input|textarea|hr)$/i;function rN(t,e,n,r,s){for(var i;;){if(t==n&&e==r)return!0;if(e==(s<0?0:Gr(t))){let o=t.parentNode;if(!o||o.nodeType!=1||pd(t)||VF.test(t.nodeName)||t.contentEditable=="false")return!1;e=Sn(t)+(s<0?0:1),t=o}else if(t.nodeType==1){let o=t.childNodes[e+(s<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((i=o.pmViewDesc)===null||i===void 0)&&i.ignoreForSelection)e+=s;else return!1;else t=o,e=s<0?Gr(t):0}else return!1}}function Gr(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function KF(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Gr(t)}else if(t.parentNode&&!pd(t))e=Sn(t),t=t.parentNode;else return null}}function QF(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!pd(t))e=Sn(t)+1,t=t.parentNode;else return null}}function WF(t,e,n){for(let r=e==0,s=e==Gr(t);r||s;){if(t==n)return!0;let i=Sn(t);if(t=t.parentNode,!t)return!1;r=r&&i==0,s=s&&i==Gr(t)}}function pd(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const ng=function(t){return t.focusNode&&lo(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Ba(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function YF(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function GF(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Gr(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Gr(r.startContainer),r.startOffset)}}}const js=typeof navigator<"u"?navigator:null,sN=typeof document<"u"?document:null,ba=js&&js.userAgent||"",zx=/Edge\/(\d+)/.exec(ba),CM=/MSIE \d/.exec(ba),Px=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ba),ir=!!(CM||Px||zx),da=CM?document.documentMode:Px?+Px[1]:zx?+zx[1]:0,Xr=!ir&&/gecko\/(\d+)/i.test(ba);Xr&&+(/Firefox\/(\d+)/.exec(ba)||[0,0])[1];const Bx=!ir&&/Chrome\/(\d+)/.exec(ba),Rn=!!Bx,NM=Bx?+Bx[1]:0,Un=!ir&&!!js&&/Apple Computer/.test(js.vendor),Kl=Un&&(/Mobile\/\w+/.test(ba)||!!js&&js.maxTouchPoints>2),Wr=Kl||(js?/Mac/.test(js.platform):!1),XF=js?/Win/.test(js.platform):!1,ai=/Android \d/.test(ba),gd=!!sN&&"webkitFontSmoothing"in sN.documentElement.style,JF=gd?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function ZF(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function ei(t,e){return typeof t=="number"?t:t[e]}function e9(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function iN(t,e,n){let r=t.someProp("scrollThreshold")||0,s=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument;for(let o=n||t.dom;o;){if(o.nodeType!=1){o=Vl(o);continue}let l=o,d=l==i.body,f=d?ZF(i):e9(l),p=0,g=0;if(e.top<f.top+ei(r,"top")?g=-(f.top-e.top+ei(s,"top")):e.bottom>f.bottom-ei(r,"bottom")&&(g=e.bottom-e.top>f.bottom-f.top?e.top+ei(s,"top")-f.top:e.bottom-f.bottom+ei(s,"bottom")),e.left<f.left+ei(r,"left")?p=-(f.left-e.left+ei(s,"left")):e.right>f.right-ei(r,"right")&&(p=e.right-f.right+ei(s,"right")),p||g)if(d)i.defaultView.scrollBy(p,g);else{let y=l.scrollLeft,b=l.scrollTop;g&&(l.scrollTop+=g),p&&(l.scrollLeft+=p);let v=l.scrollLeft-y,w=l.scrollTop-b;e={left:e.left-v,top:e.top-w,right:e.right-v,bottom:e.bottom-w}}let m=d?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(m))break;o=m=="absolute"?o.offsetParent:Vl(o)}}function t9(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,s;for(let i=(e.left+e.right)/2,o=n+1;o<Math.min(innerHeight,e.bottom);o+=5){let l=t.root.elementFromPoint(i,o);if(!l||l==t.dom||!t.dom.contains(l))continue;let d=l.getBoundingClientRect();if(d.top>=n-20){r=l,s=d.top;break}}return{refDOM:r,refTop:s,stack:TM(t.dom)}}function TM(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Vl(r));return e}function n9({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;jM(n,r==0?0:r-e)}function jM(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:s,left:i}=t[n];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let ml=null;function r9(t){if(t.setActive)return t.setActive();if(ml)return t.focus(ml);let e=TM(t);t.focus(ml==null?{get preventScroll(){return ml={preventScroll:!0},!0}}:void 0),ml||(ml=!1,jM(e,0))}function EM(t,e){let n,r=2e8,s,i=0,o=e.top,l=e.top,d,f;for(let p=t.firstChild,g=0;p;p=p.nextSibling,g++){let m;if(p.nodeType==1)m=p.getClientRects();else if(p.nodeType==3)m=si(p).getClientRects();else continue;for(let y=0;y<m.length;y++){let b=m[y];if(b.top<=o&&b.bottom>=l){o=Math.max(b.bottom,o),l=Math.min(b.top,l);let v=b.left>e.left?b.left-e.left:b.right<e.left?e.left-b.right:0;if(v<r){n=p,r=v,s=v&&n.nodeType==3?{left:b.right<e.left?b.right:b.left,top:e.top}:e,p.nodeType==1&&v&&(i=g+(e.left>=(b.left+b.right)/2?1:0));continue}}else b.top>e.top&&!d&&b.left<=e.left&&b.right>=e.left&&(d=p,f={left:Math.max(b.left,Math.min(b.right,e.left)),top:b.top});!n&&(e.left>=b.right&&e.top>=b.top||e.left>=b.left&&e.top>=b.bottom)&&(i=g+1)}}return!n&&d&&(n=d,s=f,r=0),n&&n.nodeType==3?s9(n,s):!n||r&&n.nodeType==1?{node:t,offset:i}:EM(n,s)}function s9(t,e){let n=t.nodeValue.length,r=document.createRange();for(let s=0;s<n;s++){r.setEnd(t,s+1),r.setStart(t,s);let i=Qi(r,1);if(i.top!=i.bottom&&xv(e,i))return{node:t,offset:s+(e.left>=(i.left+i.right)/2?1:0)}}return{node:t,offset:0}}function xv(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function i9(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function a9(t,e,n){let{node:r,offset:s}=EM(e,n),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&n.left>(o.left+o.right)/2?1:-1}return t.docView.posFromDOM(r,s,i)}function o9(t,e,n,r){let s=-1;for(let i=e,o=!1;i!=t.dom;){let l=t.docView.nearestDesc(i,!0),d;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((d=l.dom.getBoundingClientRect()).width||d.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!o&&d.left>r.left||d.top>r.top?s=l.posBefore:(!o&&d.right<r.left||d.bottom<r.top)&&(s=l.posAfter),o=!0),!l.contentDOM&&s<0&&!l.node.isText))return(l.node.isBlock?r.top<(d.top+d.bottom)/2:r.left<(d.left+d.right)/2)?l.posBefore:l.posAfter;i=l.dom.parentNode}return s>-1?s:t.docView.posFromDOM(e,n,-1)}function MM(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=s;;){let o=t.childNodes[i];if(o.nodeType==1){let l=o.getClientRects();for(let d=0;d<l.length;d++){let f=l[d];if(xv(e,f))return MM(o,e,f)}}if((i=(i+1)%r)==s)break}return t}function l9(t,e){let n=t.dom.ownerDocument,r,s=0,i=GF(n,e.left,e.top);i&&({node:r,offset:s}=i);let o=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),l;if(!o||!t.dom.contains(o.nodeType!=1?o.parentNode:o)){let f=t.dom.getBoundingClientRect();if(!xv(e,f)||(o=MM(t.dom,e,f),!o))return null}if(Un)for(let f=o;r&&f;f=Vl(f))f.draggable&&(r=void 0);if(o=i9(o,e),r){if(Xr&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let p=r.childNodes[s],g;p.nodeName=="IMG"&&(g=p.getBoundingClientRect()).right<=e.left&&g.bottom>e.top&&s++}let f;gd&&s&&r.nodeType==1&&(f=r.childNodes[s-1]).nodeType==1&&f.contentEditable=="false"&&f.getBoundingClientRect().top>=e.top&&s--,r==t.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=t.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(l=o9(t,r,s,e))}l==null&&(l=a9(t,o,e));let d=t.docView.nearestDesc(o,!0);return{pos:l,inside:d?d.posAtStart-d.border:-1}}function aN(t){return t.top<t.bottom||t.left<t.right}function Qi(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(aN(r))return r}return Array.prototype.find.call(n,aN)||t.getBoundingClientRect()}const c9=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function AM(t,e,n){let{node:r,offset:s,atom:i}=t.docView.domFromPos(e,n<0?-1:1),o=gd||Xr;if(r.nodeType==3)if(o&&(c9.test(r.nodeValue)||(n<0?!s:s==r.nodeValue.length))){let d=Qi(si(r,s,s),n);if(Xr&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let f=Qi(si(r,s-1,s-1),-1);if(f.top==d.top){let p=Qi(si(r,s,s+1),-1);if(p.top!=d.top)return su(p,p.left<f.left)}}return d}else{let d=s,f=s,p=n<0?1:-1;return n<0&&!s?(f++,p=-1):n>=0&&s==r.nodeValue.length?(d--,p=1):n<0?d--:f++,su(Qi(si(r,d,f),p),p<0)}if(!t.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&s&&(n<0||s==Gr(r))){let d=r.childNodes[s-1];if(d.nodeType==1)return ry(d.getBoundingClientRect(),!1)}if(i==null&&s<Gr(r)){let d=r.childNodes[s];if(d.nodeType==1)return ry(d.getBoundingClientRect(),!0)}return ry(r.getBoundingClientRect(),n>=0)}if(i==null&&s&&(n<0||s==Gr(r))){let d=r.childNodes[s-1],f=d.nodeType==3?si(d,Gr(d)-(o?0:1)):d.nodeType==1&&(d.nodeName!="BR"||!d.nextSibling)?d:null;if(f)return su(Qi(f,1),!1)}if(i==null&&s<Gr(r)){let d=r.childNodes[s];for(;d.pmViewDesc&&d.pmViewDesc.ignoreForCoords;)d=d.nextSibling;let f=d?d.nodeType==3?si(d,0,o?0:1):d.nodeType==1?d:null:null;if(f)return su(Qi(f,-1),!0)}return su(Qi(r.nodeType==3?si(r):r,-n),n>=0)}function su(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function ry(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function RM(t,e,n){let r=t.state,s=t.root.activeElement;r!=e&&t.updateState(e),s!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),s!=t.dom&&s&&s.focus()}}function u9(t,e,n){let r=e.selection,s=n=="up"?r.$from:r.$to;return RM(t,e,()=>{let{node:i}=t.docView.domFromPos(s.pos,n=="up"?-1:1);for(;;){let l=t.docView.nearestDesc(i,!0);if(!l)break;if(l.node.isBlock){i=l.contentDOM||l.dom;break}i=l.dom.parentNode}let o=AM(t,s.pos,1);for(let l=i.firstChild;l;l=l.nextSibling){let d;if(l.nodeType==1)d=l.getClientRects();else if(l.nodeType==3)d=si(l,0,l.nodeValue.length).getClientRects();else continue;for(let f=0;f<d.length;f++){let p=d[f];if(p.bottom>p.top+1&&(n=="up"?o.top-p.top>(p.bottom-o.top)*2:p.bottom-o.bottom>(o.bottom-p.top)*2))return!1}}return!0})}const d9=/[\u0590-\u08ac]/;function f9(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,o=s==r.parent.content.size,l=t.domSelection();return l?!d9.test(r.parent.textContent)||!l.modify?n=="left"||n=="backward"?i:o:RM(t,e,()=>{let{focusNode:d,focusOffset:f,anchorNode:p,anchorOffset:g}=t.domSelectionRange(),m=l.caretBidiLevel;l.modify("move",n,"character");let y=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:b,focusOffset:v}=t.domSelectionRange(),w=b&&!y.contains(b.nodeType==1?b:b.parentNode)||d==b&&f==v;try{l.collapse(p,g),d&&(d!=p||f!=g)&&l.extend&&l.extend(d,f)}catch{}return m!=null&&(l.caretBidiLevel=m),w}):r.pos==r.start()||r.pos==r.end()}let oN=null,lN=null,cN=!1;function h9(t,e,n){return oN==e&&lN==n?cN:(oN=e,lN=n,cN=n=="up"||n=="down"?u9(t,e,n):f9(t,e,n))}const Jr=0,uN=1,Ua=2,Es=3;class md{constructor(e,n,r,s){this.parent=e,this.children=n,this.dom=r,this.contentDOM=s,this.dirty=Jr,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let s=this.children[n];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,o;if(e==this.contentDOM)i=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=n>Sn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&n==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,s=e;s;s=s.parentNode){let i=this.getDesc(s),o;if(i&&(!n||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return i}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let s=e;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let s=this.children[n],i=r+s.size;if(r==e&&i!=r){for(;!s.border&&s.children.length;)for(let o=0;o<s.children.length;o++){let l=s.children[o];if(l.size){s=l;break}}return s}if(e<i)return s.descAt(e-r-s.border);r=i}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],l=i+o.size;if(l>e||o instanceof OM){s=e-i;break}i=l}if(s)return this.children[r].domFromPos(s-this.children[r].border,n);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof _M&&i.side>=0;r--);if(n<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&n&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,n):{node:this.contentDOM,offset:i?Sn(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,n):{node:this.contentDOM,offset:i?Sn(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let o=r,l=0;;l++){let d=this.children[l],f=o+d.size;if(s==-1&&e<=f){let p=o+d.border;if(e>=p&&n<=f-d.border&&d.node&&d.contentDOM&&this.contentDOM.contains(d.contentDOM))return d.parseRange(e,n,p);e=o;for(let g=l;g>0;g--){let m=this.children[g-1];if(m.size&&m.dom.parentNode==this.contentDOM&&!m.emptyChildAt(1)){s=Sn(m.dom)+1;break}e-=m.size}s==-1&&(s=0)}if(s>-1&&(f>n||l==this.children.length-1)){n=f;for(let p=l+1;p<this.children.length;p++){let g=this.children[p];if(g.size&&g.dom.parentNode==this.contentDOM&&!g.emptyChildAt(-1)){i=Sn(g.dom);break}n+=g.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=f}return{node:this.contentDOM,from:e,to:n,fromOffset:s,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,s=!1){let i=Math.min(e,n),o=Math.max(e,n);for(let y=0,b=0;y<this.children.length;y++){let v=this.children[y],w=b+v.size;if(i>b&&o<w)return v.setSelection(e-b-v.border,n-b-v.border,r,s);b=w}let l=this.domFromPos(e,e?-1:1),d=n==e?l:this.domFromPos(n,n?-1:1),f=r.root.getSelection(),p=r.domSelectionRange(),g=!1;if((Xr||Un)&&e==n){let{node:y,offset:b}=l;if(y.nodeType==3){if(g=!!(b&&y.nodeValue[b-1]==`
`),g&&b==y.nodeValue.length)for(let v=y,w;v;v=v.parentNode){if(w=v.nextSibling){w.nodeName=="BR"&&(l=d={node:w.parentNode,offset:Sn(w)+1});break}let S=v.pmViewDesc;if(S&&S.node&&S.node.isBlock)break}}else{let v=y.childNodes[b-1];g=v&&(v.nodeName=="BR"||v.contentEditable=="false")}}if(Xr&&p.focusNode&&p.focusNode!=d.node&&p.focusNode.nodeType==1){let y=p.focusNode.childNodes[p.focusOffset];y&&y.contentEditable=="false"&&(s=!0)}if(!(s||g&&Un)&&lo(l.node,l.offset,p.anchorNode,p.anchorOffset)&&lo(d.node,d.offset,p.focusNode,p.focusOffset))return;let m=!1;if((f.extend||e==n)&&!(g&&Xr)){f.collapse(l.node,l.offset);try{e!=n&&f.extend(d.node,d.offset),m=!0}catch{}}if(!m){if(e>n){let b=l;l=d,d=b}let y=document.createRange();y.setEnd(d.node,d.offset),y.setStart(l.node,l.offset),f.removeAllRanges(),f.addRange(y)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],o=r+i.size;if(r==o?e<=o&&n>=r:e<o&&n>r){let l=r+i.border,d=o-i.border;if(e>=l&&n<=d){this.dirty=e==r||n==o?Ua:uN,e==l&&n==d&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=Es:i.markDirty(e-l,n-l);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?Ua:Es}r=o}this.dirty=Ua}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?Ua:uN;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class _M extends md{constructor(e,n,r,s){let i,o=n.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!n.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=n,this.widget=n,i=this}matchesWidget(e){return this.dirty==Jr&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class p9 extends md{constructor(e,n,r,s){super(e,[],n,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class co extends md{constructor(e,n,r,s,i){super(e,[],r,s),this.mark=n,this.spec=i}static create(e,n,r,s){let i=s.nodeViews[n.type.name],o=i&&i(n,s,r);return(!o||!o.dom)&&(o=ko.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new co(e,n,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&Es||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Es&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=Jr){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Jr}}slice(e,n,r){let s=co.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;n<o&&(i=Ux(i,n,o,r)),e>0&&(i=Ux(i,0,e,r));for(let l=0;l<i.length;l++)i[l].parent=s;return s.children=i,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class fa extends md{constructor(e,n,r,s,i,o,l,d,f){super(e,[],i,o),this.node=n,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=l}static create(e,n,r,s,i,o){let l=i.nodeViews[n.type.name],d,f=l&&l(n,i,()=>{if(!d)return o;if(d.parent)return d.parent.posBeforeChild(d)},r,s),p=f&&f.dom,g=f&&f.contentDOM;if(n.isText){if(!p)p=document.createTextNode(n.text);else if(p.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else p||({dom:p,contentDOM:g}=ko.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!g&&!n.isText&&p.nodeName!="BR"&&(p.hasAttribute("contenteditable")||(p.contentEditable="false"),n.type.spec.draggable&&(p.draggable=!0));let m=p;return p=LM(p,r,n),f?d=new g9(e,n,r,s,p,g||null,m,f,i,o+1):n.isText?new rg(e,n,r,s,p,m,i):new fa(e,n,r,s,p,g||null,m,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Ne.empty)}return e}matchesNode(e,n,r){return this.dirty==Jr&&e.eq(this.node)&&Kh(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,s=n,i=e.composing?this.localCompositionInfo(e,n):null,o=i&&i.pos>-1?i:null,l=i&&i.pos<0,d=new y9(this,o&&o.node,e);v9(this.node,this.innerDeco,(f,p,g)=>{f.spec.marks?d.syncToMarks(f.spec.marks,r,e):f.type.side>=0&&!g&&d.syncToMarks(p==this.node.childCount?kt.none:this.node.child(p).marks,r,e),d.placeWidget(f,e,s)},(f,p,g,m)=>{d.syncToMarks(f.marks,r,e);let y;d.findNodeMatch(f,p,g,m)||l&&e.state.selection.from>s&&e.state.selection.to<s+f.nodeSize&&(y=d.findIndexWithChild(i.node))>-1&&d.updateNodeAt(f,p,g,y,e)||d.updateNextNode(f,p,g,e,m,s)||d.addNode(f,p,g,e,s),s+=f.nodeSize}),d.syncToMarks([],r,e),this.node.isTextblock&&d.addTextblockHacks(),d.destroyRest(),(d.changed||this.dirty==Ua)&&(o&&this.protectLocalComposition(e,o),IM(this.contentDOM,this.children,e),Kl&&w9(this.dom))}localCompositionInfo(e,n){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof qe)||r<n||s>n+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,l=S9(this.node.content,o,r-n,s-n);return l<0?null:{node:i,pos:l,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:s}){if(this.getDesc(n))return;let i=n;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new p9(this,i,n,s);e.input.compositionNodes.push(o),this.children=Ux(this.children,r,r+s.length,e,o)}update(e,n,r,s){return this.dirty==Es||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,s),!0)}updateInner(e,n,r,s){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=Jr}updateOuterDeco(e){if(Kh(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=DM(this.dom,this.nodeDOM,Fx(this.outerDeco,this.node,n),Fx(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function dN(t,e,n,r,s){LM(r,e,t);let i=new fa(void 0,t,e,n,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class rg extends fa{constructor(e,n,r,s,i,o,l){super(e,n,r,s,i,null,o,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,s){return this.dirty==Es||this.dirty!=Jr&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=Jr||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=Jr,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let s=this.node.cut(e,n),i=document.createTextNode(s.text);return new rg(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Es)}get domAtom(){return!1}isText(e){return this.node.text==e}}class OM extends md{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Jr&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class g9 extends fa{constructor(e,n,r,s,i,o,l,d,f,p){super(e,n,r,s,i,o,l,f,p),this.spec=d}update(e,n,r,s){if(this.dirty==Es)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,n,r);return i&&this.updateInner(e,n,r,s),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,s){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function IM(t,e,n){let r=t.firstChild,s=!1;for(let i=0;i<e.length;i++){let o=e[i],l=o.dom;if(l.parentNode==t){for(;l!=r;)r=fN(r),s=!0;r=r.nextSibling}else s=!0,t.insertBefore(l,r);if(o instanceof co){let d=r?r.previousSibling:t.lastChild;IM(o.contentDOM,o.children,n),r=d?d.nextSibling:t.firstChild}}for(;r;)r=fN(r),s=!0;s&&n.trackWrites==t&&(n.trackWrites=null)}const Tu=function(t){t&&(this.nodeName=t)};Tu.prototype=Object.create(null);const $a=[new Tu];function Fx(t,e,n){if(t.length==0)return $a;let r=n?$a[0]:new Tu,s=[r];for(let i=0;i<t.length;i++){let o=t[i].type.attrs;if(o){o.nodeName&&s.push(r=new Tu(o.nodeName));for(let l in o){let d=o[l];d!=null&&(n&&s.length==1&&s.push(r=new Tu(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+d:l=="style"?r.style=(r.style?r.style+";":"")+d:l!="nodeName"&&(r[l]=d))}}}return s}function DM(t,e,n,r){if(n==$a&&r==$a)return e;let s=e;for(let i=0;i<r.length;i++){let o=r[i],l=n[i];if(i){let d;l&&l.nodeName==o.nodeName&&s!=t&&(d=s.parentNode)&&d.nodeName.toLowerCase()==o.nodeName||(d=document.createElement(o.nodeName),d.pmIsDeco=!0,d.appendChild(s),l=$a[0]),s=d}m9(s,l||$a[0],o)}return s}function m9(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=n.class?n.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&t.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&t.classList.add(s[i]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)t.style.removeProperty(s[1])}n.style&&(t.style.cssText+=n.style)}}function LM(t,e,n){return DM(t,t,$a,Fx(e,n,t.nodeType!=1))}function Kh(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function fN(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class y9{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=x9(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let s=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;s<o&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=Jr,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let d=this.index;d<Math.min(this.index+3,this.top.children.length);d++){let f=this.top.children[d];if(f.matchesMark(e[i])&&!this.isLocked(f.dom)){l=d;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let d=co.create(this.top,e[i],n,r);this.top.children.splice(this.index,0,d),this.top=d,this.changed=!0}this.index=0,i++}}findNodeMatch(e,n,r,s){let i=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(e,n,r))i=this.top.children.indexOf(o,this.index);else for(let l=this.index,d=Math.min(this.top.children.length,l+5);l<d;l++){let f=this.top.children[l];if(f.matchesNode(e,n,r)&&!this.preMatch.matched.has(f)){i=l;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,n,r,s,i){let o=this.top.children[s];return o.dirty==Es&&o.dom==o.contentDOM&&(o.dirty=Ua),o.update(e,n,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=n}}updateNextNode(e,n,r,s,i,o){for(let l=this.index;l<this.top.children.length;l++){let d=this.top.children[l];if(d instanceof fa){let f=this.preMatch.matched.get(d);if(f!=null&&f!=i)return!1;let p=d.dom,g,m=this.isLocked(p)&&!(e.isText&&d.node&&d.node.isText&&d.nodeDOM.nodeValue==e.text&&d.dirty!=Es&&Kh(n,d.outerDeco));if(!m&&d.update(e,n,r,s))return this.destroyBetween(this.index,l),d.dom!=p&&(this.changed=!0),this.index++,!0;if(!m&&(g=this.recreateWrapper(d,e,n,r,s,o)))return this.destroyBetween(this.index,l),this.top.children[this.index]=g,g.contentDOM&&(g.dirty=Ua,g.updateChildren(s,o+1),g.dirty=Jr),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,s,i,o){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Kh(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let l=fa.create(this.top,n,r,s,i,o);if(l.contentDOM){l.children=e.children,e.children=[];for(let d of l.children)d.parent=l}return e.destroy(),l}addNode(e,n,r,s,i){let o=fa.create(this.top,e,n,r,s,i);o.contentDOM&&o.updateChildren(s,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,n,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new _M(this.top,e,n,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof co;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof rg)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Un||Rn)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new OM(this.top,[],r,null);n!=this.top?n.children.push(s):n.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function x9(t,e){let n=e,r=n.children.length,s=t.childCount,i=new Map,o=[];e:for(;s>0;){let l;for(;;)if(r){let f=n.children[r-1];if(f instanceof co)n=f,r=f.children.length;else{l=f,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let d=l.node;if(d){if(d!=t.child(s-1))break;--s,i.set(l,s),o.push(l)}}return{index:s,matched:i,matches:o.reverse()}}function b9(t,e){return t.type.side-e.type.side}function v9(t,e,n,r){let s=e.locals(t),i=0;if(s.length==0){for(let f=0;f<t.childCount;f++){let p=t.child(f);r(p,s,e.forChild(i,p),f),i+=p.nodeSize}return}let o=0,l=[],d=null;for(let f=0;;){let p,g;for(;o<s.length&&s[o].to==i;){let w=s[o++];w.widget&&(p?(g||(g=[p])).push(w):p=w)}if(p)if(g){g.sort(b9);for(let w=0;w<g.length;w++)n(g[w],f,!!d)}else n(p,f,!!d);let m,y;if(d)y=-1,m=d,d=null;else if(f<t.childCount)y=f,m=t.child(f++);else break;for(let w=0;w<l.length;w++)l[w].to<=i&&l.splice(w--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)l.push(s[o++]);let b=i+m.nodeSize;if(m.isText){let w=b;o<s.length&&s[o].from<w&&(w=s[o].from);for(let S=0;S<l.length;S++)l[S].to<w&&(w=l[S].to);w<b&&(d=m.cut(w-i),m=m.cut(0,w-i),b=w,y=-1)}else for(;o<s.length&&s[o].to<b;)o++;let v=m.isInline&&!m.isLeaf?l.filter(w=>!w.inline):l.slice();r(m,v,e.forChild(i,m),y),i=b}}function w9(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function S9(t,e,n,r){for(let s=0,i=0;s<t.childCount&&i<=r;){let o=t.child(s++),l=i;if(i+=o.nodeSize,!o.isText)continue;let d=o.text;for(;s<t.childCount;){let f=t.child(s++);if(i+=f.nodeSize,!f.isText)break;d+=f.text}if(i>=n){if(i>=r&&d.slice(r-e.length-l,r-l)==e)return r-e.length;let f=l<r?d.lastIndexOf(e,r-l-1):-1;if(f>=0&&f+e.length+l>=n)return l+f;if(n==r&&d.length>=r+e.length-l&&d.slice(r-l,r-l+e.length)==e)return r}}return-1}function Ux(t,e,n,r,s){let i=[];for(let o=0,l=0;o<t.length;o++){let d=t[o],f=l,p=l+=d.size;f>=n||p<=e?i.push(d):(f<e&&i.push(d.slice(0,e-f,r)),s&&(i.push(s),s=void 0),p>n&&i.push(d.slice(n-f,d.size,r)))}return i}function bv(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let s=t.docView.nearestDesc(n.focusNode),i=s&&s.size==0,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let l=r.resolve(o),d,f;if(ng(n)){for(d=o;s&&!s.node;)s=s.parent;let g=s.node;if(s&&g.isAtom&&Be.isSelectable(g)&&s.parent&&!(g.isInline&&WF(n.focusNode,n.focusOffset,s.dom))){let m=s.posBefore;f=new Be(o==m?l:r.resolve(m))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let g=o,m=o;for(let y=0;y<n.rangeCount;y++){let b=n.getRangeAt(y);g=Math.min(g,t.docView.posFromDOM(b.startContainer,b.startOffset,1)),m=Math.max(m,t.docView.posFromDOM(b.endContainer,b.endOffset,-1))}if(g<0)return null;[d,o]=m==t.state.selection.anchor?[m,g]:[g,m],l=r.resolve(o)}else d=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(d<0)return null}let p=r.resolve(d);if(!f){let g=e=="pointer"||t.state.selection.head<l.pos&&!i?1:-1;f=vv(t,p,l,g)}return f}function zM(t){return t.editable?t.hasFocus():BM(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function ci(t,e=!1){let n=t.state.selection;if(PM(t,n),!!zM(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Rn){let r=t.domSelectionRange(),s=t.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&lo(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)C9(t);else{let{anchor:r,head:s}=n,i,o;hN&&!(n instanceof qe)&&(n.$from.parent.inlineContent||(i=pN(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=pN(t,n.to))),t.docView.setSelection(r,s,t,e),hN&&(i&&gN(i),o&&gN(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&k9(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const hN=Un||Rn&&NM<63;function pN(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),s=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(Un&&s&&s.contentEditable=="false")return sy(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return sy(s);if(i)return sy(i)}}function sy(t){return t.contentEditable="true",Un&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function gN(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function k9(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,s=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=s)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!zM(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function C9(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,Sn(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&ir&&da<=11&&(n.disabled=!0,n.disabled=!1)}function PM(t,e){if(e instanceof Be){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(mN(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else mN(t)}function mN(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function vv(t,e,n,r){return t.someProp("createSelectionBetween",s=>s(t,e,n))||qe.between(e,n,r)}function yN(t){return t.editable&&!t.hasFocus()?!1:BM(t)}function BM(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function N9(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return lo(e.node,e.offset,n.anchorNode,n.anchorOffset)}function $x(t,e){let{$anchor:n,$head:r}=t.selection,s=e>0?n.max(r):n.min(r),i=s.parent.inlineContent?s.depth?t.doc.resolve(e>0?s.after():s.before()):null:s;return i&&Ge.findFrom(i,e)}function Yi(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function xN(t,e,n){let r=t.state.selection;if(r instanceof qe)if(n.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=t.state.doc.resolve(s.pos+i.nodeSize*(e<0?-1:1));return Yi(t,new qe(r.$anchor,o))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let s=$x(t.state,e);return s&&s instanceof Be?Yi(t,s):!1}else if(!(Wr&&n.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,o;if(!i||i.isText)return!1;let l=e<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(o=t.docView.descAt(l))&&!o.contentDOM?Be.isSelectable(i)?Yi(t,new Be(e<0?t.state.doc.resolve(s.pos-i.nodeSize):s)):gd?Yi(t,new qe(t.state.doc.resolve(e<0?l:l+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof Be&&r.node.isInline)return Yi(t,new qe(e>0?r.$to:r.$from));{let s=$x(t.state,e);return s?Yi(t,s):!1}}}function Qh(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function ju(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function yl(t,e){return e<0?T9(t):j9(t)}function T9(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s,i,o=!1;for(Xr&&n.nodeType==1&&r<Qh(n)&&ju(n.childNodes[r],-1)&&(o=!0);;)if(r>0){if(n.nodeType!=1)break;{let l=n.childNodes[r-1];if(ju(l,-1))s=n,i=--r;else if(l.nodeType==3)n=l,r=n.nodeValue.length;else break}}else{if(FM(n))break;{let l=n.previousSibling;for(;l&&ju(l,-1);)s=n.parentNode,i=Sn(l),l=l.previousSibling;if(l)n=l,r=Qh(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}o?qx(t,n,r):s&&qx(t,s,i)}function j9(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s=Qh(n),i,o;for(;;)if(r<s){if(n.nodeType!=1)break;let l=n.childNodes[r];if(ju(l,1))i=n,o=++r;else break}else{if(FM(n))break;{let l=n.nextSibling;for(;l&&ju(l,1);)i=l.parentNode,o=Sn(l)+1,l=l.nextSibling;if(l)n=l,r=0,s=Qh(n);else{if(n=n.parentNode,n==t.dom)break;r=s=0}}}i&&qx(t,i,o)}function FM(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function E9(t,e){for(;t&&e==t.childNodes.length&&!pd(t);)e=Sn(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function M9(t,e){for(;t&&!e&&!pd(t);)e=Sn(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function qx(t,e,n){if(e.nodeType!=3){let i,o;(o=E9(e,n))?(e=o,n=0):(i=M9(e,n))&&(e=i,n=i.nodeValue.length)}let r=t.domSelection();if(!r)return;if(ng(r)){let i=document.createRange();i.setEnd(e,n),i.setStart(e,n),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:s}=t;setTimeout(()=>{t.state==s&&ci(t)},50)}function bN(t,e){let n=t.state.doc.resolve(e);if(!(Rn||XF)&&n.parent.inlineContent){let s=t.coordsAtPos(e);if(e>n.start()){let i=t.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(e<n.end()){let i=t.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function vN(t,e,n){let r=t.state.selection;if(r instanceof qe&&!r.empty||n.indexOf("s")>-1||Wr&&n.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let o=$x(t.state,e);if(o&&o instanceof Be)return Yi(t,o)}if(!s.parent.inlineContent){let o=e<0?s:i,l=r instanceof kr?Ge.near(o,e):Ge.findFrom(o,e);return l?Yi(t,l):!1}return!1}function wN(t,e){if(!(t.state.selection instanceof qe))return!0;let{$head:n,$anchor:r,empty:s}=t.state.selection;if(!n.sameParent(r))return!0;if(!s)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let o=t.state.tr;return e<0?o.delete(n.pos-i.nodeSize,n.pos):o.delete(n.pos,n.pos+i.nodeSize),t.dispatch(o),!0}return!1}function SN(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function A9(t){if(!Un||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;SN(t,r,"true"),setTimeout(()=>SN(t,r,"false"),20)}return!1}function R9(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function _9(t,e){let n=e.keyCode,r=R9(e);if(n==8||Wr&&n==72&&r=="c")return wN(t,-1)||yl(t,-1);if(n==46&&!e.shiftKey||Wr&&n==68&&r=="c")return wN(t,1)||yl(t,1);if(n==13||n==27)return!0;if(n==37||Wr&&n==66&&r=="c"){let s=n==37?bN(t,t.state.selection.from)=="ltr"?-1:1:-1;return xN(t,s,r)||yl(t,s)}else if(n==39||Wr&&n==70&&r=="c"){let s=n==39?bN(t,t.state.selection.from)=="ltr"?1:-1:1;return xN(t,s,r)||yl(t,s)}else{if(n==38||Wr&&n==80&&r=="c")return vN(t,-1,r)||yl(t,-1);if(n==40||Wr&&n==78&&r=="c")return A9(t)||vN(t,1,r)||yl(t,1);if(r==(Wr?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function wv(t,e){t.someProp("transformCopied",y=>{e=y(e,t)});let n=[],{content:r,openStart:s,openEnd:i}=e;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let y=r.firstChild;n.push(y.type.name,y.attrs!=y.type.defaultAttrs?y.attrs:null),r=y.content}let o=t.someProp("clipboardSerializer")||ko.fromSchema(t.state.schema),l=KM(),d=l.createElement("div");d.appendChild(o.serializeFragment(r,{document:l}));let f=d.firstChild,p,g=0;for(;f&&f.nodeType==1&&(p=VM[f.nodeName.toLowerCase()]);){for(let y=p.length-1;y>=0;y--){let b=l.createElement(p[y]);for(;d.firstChild;)b.appendChild(d.firstChild);d.appendChild(b),g++}f=d.firstChild}f&&f.nodeType==1&&f.setAttribute("data-pm-slice",`${s} ${i}${g?` -${g}`:""} ${JSON.stringify(n)}`);let m=t.someProp("clipboardTextSerializer",y=>y(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:d,text:m,slice:e}}function UM(t,e,n,r,s){let i=s.parent.type.spec.code,o,l;if(!n&&!e)return null;let d=!!e&&(r||i||!n);if(d){if(t.someProp("transformPastedText",m=>{e=m(e,i||r,t)}),i)return l=new Ae(Ne.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",m=>{l=m(l,t,!0)}),l;let g=t.someProp("clipboardTextParser",m=>m(e,s,r,t));if(g)l=g;else{let m=s.marks(),{schema:y}=t.state,b=ko.fromSchema(y);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let w=o.appendChild(document.createElement("p"));v&&w.appendChild(b.serializeNode(y.text(v,m)))})}}else t.someProp("transformPastedHTML",g=>{n=g(n,t)}),o=L9(n),gd&&z9(o);let f=o&&o.querySelector("[data-pm-slice]"),p=f&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(f.getAttribute("data-pm-slice")||"");if(p&&p[3])for(let g=+p[3];g>0;g--){let m=o.firstChild;for(;m&&m.nodeType!=1;)m=m.nextSibling;if(!m)break;o=m}if(l||(l=(t.someProp("clipboardParser")||t.someProp("domParser")||Cu.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(d||p),context:s,ruleFromNode(m){return m.nodeName=="BR"&&!m.nextSibling&&m.parentNode&&!O9.test(m.parentNode.nodeName)?{ignore:!0}:null}})),p)l=P9(kN(l,+p[1],+p[2]),p[4]);else if(l=Ae.maxOpen(I9(l.content,s),!0),l.openStart||l.openEnd){let g=0,m=0;for(let y=l.content.firstChild;g<l.openStart&&!y.type.spec.isolating;g++,y=y.firstChild);for(let y=l.content.lastChild;m<l.openEnd&&!y.type.spec.isolating;m++,y=y.lastChild);l=kN(l,g,m)}return t.someProp("transformPasted",g=>{l=g(l,t,d)}),l}const O9=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function I9(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let s=e.node(n).contentMatchAt(e.index(n)),i,o=[];if(t.forEach(l=>{if(!o)return;let d=s.findWrapping(l.type),f;if(!d)return o=null;if(f=o.length&&i.length&&qM(d,i,l,o[o.length-1],0))o[o.length-1]=f;else{o.length&&(o[o.length-1]=HM(o[o.length-1],i.length));let p=$M(l,d);o.push(p),s=s.matchType(p.type),i=d}}),o)return Ne.from(o)}return t}function $M(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,Ne.from(t));return t}function qM(t,e,n,r,s){if(s<t.length&&s<e.length&&t[s]==e[s]){let i=qM(t,e,n,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==t.length-1?n.type:t[s+1]))return r.copy(r.content.append(Ne.from($M(n,t,s+1))))}}function HM(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,HM(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(Ne.empty,!0);return t.copy(n.append(r))}function Hx(t,e,n,r,s,i){let o=e<0?t.firstChild:t.lastChild,l=o.content;return t.childCount>1&&(i=0),s<r-1&&(l=Hx(l,e,n,r,s+1,i)),s>=n&&(l=e<0?o.contentMatchAt(0).fillBefore(l,i<=s).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(Ne.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(l))}function kN(t,e,n){return e<t.openStart&&(t=new Ae(Hx(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new Ae(Hx(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const VM={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let CN=null;function KM(){return CN||(CN=document.implementation.createHTMLDocument("title"))}let iy=null;function D9(t){let e=window.trustedTypes;return e?(iy||(iy=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),iy.createHTML(t)):t}function L9(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=KM().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),s;if((s=r&&VM[r[1].toLowerCase()])&&(t=s.map(i=>"<"+i+">").join("")+t+s.map(i=>"</"+i+">").reverse().join("")),n.innerHTML=D9(t),s)for(let i=0;i<s.length;i++)n=n.querySelector(s[i])||n;return n}function z9(t){let e=t.querySelectorAll(Rn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function P9(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:s,openStart:i,openEnd:o}=t;for(let l=r.length-2;l>=0;l-=2){let d=n.nodes[r[l]];if(!d||d.hasRequiredAttrs())break;s=Ne.from(d.create(r[l+1],s)),i++,o++}return new Ae(s,i,o)}const $n={},qn={},B9={touchstart:!0,touchmove:!0};class F9{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function U9(t){for(let e in $n){let n=$n[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{q9(t,r)&&!Sv(t,r)&&(t.editable||!(r.type in qn))&&n(t,r)},B9[e]?{passive:!0}:void 0)}Un&&t.dom.addEventListener("input",()=>null),Vx(t)}function sa(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function $9(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function Vx(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>Sv(t,r))})}function Sv(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function q9(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function H9(t,e){!Sv(t,e)&&$n[e.type]&&(t.editable||!(e.type in qn))&&$n[e.type](t,e)}qn.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!WM(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(ai&&Rn&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),Kl&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",s=>s(t,Ba(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||_9(t,n)?n.preventDefault():sa(t,"key")};qn.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};qn.keypress=(t,e)=>{let n=e;if(WM(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Wr&&n.metaKey)return;if(t.someProp("handleKeyPress",s=>s(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof qe)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(n.charCode),i=()=>t.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!t.someProp("handleTextInput",o=>o(t,r.$from.pos,r.$to.pos,s,i))&&t.dispatch(i()),n.preventDefault()}};function sg(t){return{left:t.clientX,top:t.clientY}}function V9(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function kv(t,e,n,r,s){if(r==-1)return!1;let i=t.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(t.someProp(e,l=>o>i.depth?l(t,n,i.nodeAfter,i.before(o),s,!0):l(t,n,i.node(o),i.before(o),s,!1)))return!0;return!1}function zl(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function K9(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&Be.isSelectable(r)?(zl(t,new Be(n)),!0):!1}function Q9(t,e){if(e==-1)return!1;let n=t.state.selection,r,s;n instanceof Be&&(r=n.node);let i=t.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let l=o>i.depth?i.nodeAfter:i.node(o);if(Be.isSelectable(l)){r&&n.$from.depth>0&&o>=n.$from.depth&&i.before(n.$from.depth+1)==n.$from.pos?s=i.before(n.$from.depth):s=i.before(o);break}}return s!=null?(zl(t,Be.create(t.state.doc,s)),!0):!1}function W9(t,e,n,r,s){return kv(t,"handleClickOn",e,n,r)||t.someProp("handleClick",i=>i(t,e,r))||(s?Q9(t,n):K9(t,n))}function Y9(t,e,n,r){return kv(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",s=>s(t,e,r))}function G9(t,e,n,r){return kv(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",s=>s(t,e,r))||X9(t,n,r)}function X9(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(zl(t,qe.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let i=s.depth+1;i>0;i--){let o=i>s.depth?s.nodeAfter:s.node(i),l=s.before(i);if(o.inlineContent)zl(t,qe.create(r,l+1,l+1+o.content.size));else if(Be.isSelectable(o))zl(t,Be.create(r,l));else continue;return!0}}function Cv(t){return Wh(t)}const QM=Wr?"metaKey":"ctrlKey";$n.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Cv(t),s=Date.now(),i="singleClick";s-t.input.lastClick.time<500&&V9(n,t.input.lastClick)&&!n[QM]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?i="doubleClick":t.input.lastClick.type=="doubleClick"&&(i="tripleClick")),t.input.lastClick={time:s,x:n.clientX,y:n.clientY,type:i,button:n.button};let o=t.posAtCoords(sg(n));o&&(i=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new J9(t,o,n,!!r)):(i=="doubleClick"?Y9:G9)(t,o.pos,o.inside,n)?n.preventDefault():sa(t,"pointer"))};class J9{constructor(e,n,r,s){this.view=e,this.pos=n,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[QM],this.allowDefault=r.shiftKey;let i,o;if(n.inside>-1)i=e.state.doc.nodeAt(n.inside),o=n.inside;else{let p=e.state.doc.resolve(n.pos);i=p.parent,o=p.depth?p.before():0}const l=s?null:r.target,d=l?e.docView.nearestDesc(l,!0):null;this.target=d&&d.nodeDOM.nodeType==1?d.nodeDOM:null;let{selection:f}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||f instanceof Be&&f.from<=o&&f.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Xr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),sa(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>ci(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(sg(e))),this.updateAllowDefault(e),this.allowDefault||!n?sa(this.view,"pointer"):W9(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Un&&this.mightDrag&&!this.mightDrag.node.isAtom||Rn&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(zl(this.view,Ge.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):sa(this.view,"pointer")}move(e){this.updateAllowDefault(e),sa(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}$n.touchstart=t=>{t.input.lastTouch=Date.now(),Cv(t),sa(t,"pointer")};$n.touchmove=t=>{t.input.lastTouch=Date.now(),sa(t,"pointer")};$n.contextmenu=t=>Cv(t);function WM(t,e){return t.composing?!0:Un&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const Z9=ai?5e3:-1;qn.compositionstart=qn.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof qe&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),Wh(t,!0),t.markCursor=null;else if(Wh(t,!e.selection.empty),Xr&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let o=i<0?s.lastChild:s.childNodes[i-1];if(!o)break;if(o.nodeType==3){let l=t.domSelection();l&&l.collapse(o,o.nodeValue.length);break}else s=o,i=-1}}t.input.composing=!0}YM(t,Z9)};qn.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,YM(t,20))};function YM(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Wh(t),e))}function GM(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=tU());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function eU(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=KF(e.focusNode,e.focusOffset),r=QF(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let s=r.pmViewDesc,i=t.domObserver.lastChangedTextNode;if(n==i||r==i)return i;if(!s||!s.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let o=n.pmViewDesc;if(!(!o||!o.isText(n.nodeValue)))return r}}return n||r}function tU(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Wh(t,e=!1){if(!(ai&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),GM(t),e||t.docView&&t.docView.dirty){let n=bv(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function nU(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const Wu=ir&&da<15||Kl&&JF<604;$n.copy=qn.cut=(t,e)=>{let n=e,r=t.state.selection,s=n.type=="cut";if(r.empty)return;let i=Wu?null:n.clipboardData,o=r.content(),{dom:l,text:d}=wv(t,o);i?(n.preventDefault(),i.clearData(),i.setData("text/html",l.innerHTML),i.setData("text/plain",d)):nU(t,l),s&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function rU(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function sU(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Yu(t,r.value,null,s,e):Yu(t,r.textContent,r.innerHTML,s,e)},50)}function Yu(t,e,n,r,s){let i=UM(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",d=>d(t,s,i||Ae.empty)))return!0;if(!i)return!1;let o=rU(i),l=o?t.state.tr.replaceSelectionWith(o,r):t.state.tr.replaceSelection(i);return t.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function XM(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}qn.paste=(t,e)=>{let n=e;if(t.composing&&!ai)return;let r=Wu?null:n.clipboardData,s=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&Yu(t,XM(r),r.getData("text/html"),s,n)?n.preventDefault():sU(t,n)};class JM{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const iU=Wr?"altKey":"ctrlKey";function ZM(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[iU]}$n.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let s=t.state.selection,i=s.empty?null:t.posAtCoords(sg(n)),o;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof Be?s.to-1:s.to))){if(r&&r.mightDrag)o=Be.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let g=t.docView.nearestDesc(n.target,!0);g&&g.node.type.spec.draggable&&g!=t.docView&&(o=Be.create(t.state.doc,g.posBefore))}}let l=(o||t.state.selection).content(),{dom:d,text:f,slice:p}=wv(t,l);(!n.dataTransfer.files.length||!Rn||NM>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Wu?"Text":"text/html",d.innerHTML),n.dataTransfer.effectAllowed="copyMove",Wu||n.dataTransfer.setData("text/plain",f),t.dragging=new JM(p,ZM(t,n),o)};$n.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};qn.dragover=qn.dragenter=(t,e)=>e.preventDefault();qn.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let s=t.posAtCoords(sg(n));if(!s)return;let i=t.state.doc.resolve(s.pos),o=r&&r.slice;o?t.someProp("transformPasted",b=>{o=b(o,t,!1)}):o=UM(t,XM(n.dataTransfer),Wu?null:n.dataTransfer.getData("text/html"),!1,i);let l=!!(r&&ZM(t,n));if(t.someProp("handleDrop",b=>b(t,n,o||Ae.empty,l))){n.preventDefault();return}if(!o)return;n.preventDefault();let d=o?sM(t.state.doc,i.pos,o):i.pos;d==null&&(d=i.pos);let f=t.state.tr;if(l){let{node:b}=r;b?b.replace(f):f.deleteSelection()}let p=f.mapping.map(d),g=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,m=f.doc;if(g?f.replaceRangeWith(p,p,o.content.firstChild):f.replaceRange(p,p,o),f.doc.eq(m))return;let y=f.doc.resolve(p);if(g&&Be.isSelectable(o.content.firstChild)&&y.nodeAfter&&y.nodeAfter.sameMarkup(o.content.firstChild))f.setSelection(new Be(y));else{let b=f.mapping.map(d);f.mapping.maps[f.mapping.maps.length-1].forEach((v,w,S,T)=>b=T),f.setSelection(vv(t,y,f.doc.resolve(b)))}t.focus(),t.dispatch(f.setMeta("uiEvent","drop"))};$n.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&ci(t)},20))};$n.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};$n.beforeinput=(t,e)=>{if(Rn&&ai&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",i=>i(t,Ba(8,"Backspace")))))return;let{$cursor:s}=t.state.selection;s&&s.pos>0&&t.dispatch(t.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let t in qn)$n[t]=qn[t];function Gu(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Yh{constructor(e,n){this.toDOM=e,this.spec=n||Xa,this.side=this.spec.side||0}map(e,n,r,s){let{pos:i,deleted:o}=e.mapResult(n.from+s,this.side<0?-1:1);return o?null:new Pn(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Yh&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Gu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class ha{constructor(e,n){this.attrs=e,this.spec=n||Xa}map(e,n,r,s){let i=e.map(n.from+s,this.spec.inclusiveStart?-1:1)-r,o=e.map(n.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new Pn(i,o,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof ha&&Gu(this.attrs,e.attrs)&&Gu(this.spec,e.spec)}static is(e){return e.type instanceof ha}destroy(){}}class Nv{constructor(e,n){this.attrs=e,this.spec=n||Xa}map(e,n,r,s){let i=e.mapResult(n.from+s,1);if(i.deleted)return null;let o=e.mapResult(n.to+s,-1);return o.deleted||o.pos<=i.pos?null:new Pn(i.pos-r,o.pos-r,this)}valid(e,n){let{index:r,offset:s}=e.content.findIndex(n.from),i;return s==n.from&&!(i=e.child(r)).isText&&s+i.nodeSize==n.to}eq(e){return this==e||e instanceof Nv&&Gu(this.attrs,e.attrs)&&Gu(this.spec,e.spec)}destroy(){}}class Pn{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new Pn(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new Pn(e,e,new Yh(n,r))}static inline(e,n,r,s){return new Pn(e,n,new ha(r,s))}static node(e,n,r,s){return new Pn(e,n,new Nv(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof ha}get widget(){return this.type instanceof Yh}}const Rl=[],Xa={};class Rt{constructor(e,n){this.local=e.length?e:Rl,this.children=n.length?n:Rl}static create(e,n){return n.length?Gh(n,e,0,Xa):En}find(e,n,r){let s=[];return this.findInner(e??0,n??1e9,s,0,r),s}findInner(e,n,r,s,i){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=n&&l.to>=e&&(!i||i(l.spec))&&r.push(l.copy(l.from+s,l.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,n-l,r,s+l,i)}}map(e,n,r){return this==En||e.maps.length==0?this:this.mapInner(e,n,0,0,r||Xa)}mapInner(e,n,r,s,i){let o;for(let l=0;l<this.local.length;l++){let d=this.local[l].map(e,r,s);d&&d.type.valid(n,d)?(o||(o=[])).push(d):i.onRemove&&i.onRemove(this.local[l].spec)}return this.children.length?aU(this.children,o||[],e,n,r,s,i):o?new Rt(o.sort(Ja),Rl):En}add(e,n){return n.length?this==En?Rt.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let s,i=0;e.forEach((l,d)=>{let f=d+r,p;if(p=tA(n,l,f)){for(s||(s=this.children.slice());i<s.length&&s[i]<d;)i+=3;s[i]==d?s[i+2]=s[i+2].addInner(l,p,f+1):s.splice(i,0,d,d+l.nodeSize,Gh(p,l,f+1,Xa)),i+=3}});let o=eA(i?nA(n):n,-r);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new Rt(o.length?this.local.concat(o).sort(Ja):this.local,s||this.children)}remove(e){return e.length==0||this==En?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let o,l=r[i]+n,d=r[i+1]+n;for(let p=0,g;p<e.length;p++)(g=e[p])&&g.from>l&&g.to<d&&(e[p]=null,(o||(o=[])).push(g));if(!o)continue;r==this.children&&(r=this.children.slice());let f=r[i+2].removeInner(o,l+1);f!=En?r[i+2]=f:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let l=0;l<s.length;l++)s[l].eq(o,n)&&(s==this.local&&(s=this.local.slice()),s.splice(l--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new Rt(s,r):En}forChild(e,n){if(this==En)return this;if(n.isLeaf)return Rt.empty;let r,s;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let i=e+1,o=i+n.content.size;for(let l=0;l<this.local.length;l++){let d=this.local[l];if(d.from<o&&d.to>i&&d.type instanceof ha){let f=Math.max(i,d.from)-i,p=Math.min(o,d.to)-i;f<p&&(s||(s=[])).push(d.copy(f,p))}}if(s){let l=new Rt(s.sort(Ja),Rl);return r?new Ji([l,r]):l}return r||En}eq(e){if(this==e)return!0;if(!(e instanceof Rt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return Tv(this.localsInner(e))}localsInner(e){if(this==En)return Rl;if(e.inlineContent||!this.local.some(ha.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof ha||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Rt.empty=new Rt([],[]);Rt.removeOverlap=Tv;const En=Rt.empty;class Ji{constructor(e){this.members=e}map(e,n){const r=this.members.map(s=>s.map(e,n,Xa));return Ji.from(r)}forChild(e,n){if(n.isLeaf)return Rt.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(e,n);i!=En&&(i instanceof Ji?r=r.concat(i.members):r.push(i))}return Ji.from(r)}eq(e){if(!(e instanceof Ji)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(e);if(i.length)if(!n)n=i;else{r&&(n=n.slice(),r=!1);for(let o=0;o<i.length;o++)n.push(i[o])}}return n?Tv(r?n:n.sort(Ja)):Rl}static from(e){switch(e.length){case 0:return En;case 1:return e[0];default:return new Ji(e.every(n=>n instanceof Rt)?e:e.reduce((n,r)=>n.concat(r instanceof Rt?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function aU(t,e,n,r,s,i,o){let l=t.slice();for(let f=0,p=i;f<n.maps.length;f++){let g=0;n.maps[f].forEach((m,y,b,v)=>{let w=v-b-(y-m);for(let S=0;S<l.length;S+=3){let T=l[S+1];if(T<0||m>T+p-g)continue;let j=l[S]+p-g;y>=j?l[S+1]=m<=j?-2:-1:m>=p&&w&&(l[S]+=w,l[S+1]+=w)}g+=w}),p=n.maps[f].map(p,-1)}let d=!1;for(let f=0;f<l.length;f+=3)if(l[f+1]<0){if(l[f+1]==-2){d=!0,l[f+1]=-1;continue}let p=n.map(t[f]+i),g=p-s;if(g<0||g>=r.content.size){d=!0;continue}let m=n.map(t[f+1]+i,-1),y=m-s,{index:b,offset:v}=r.content.findIndex(g),w=r.maybeChild(b);if(w&&v==g&&v+w.nodeSize==y){let S=l[f+2].mapInner(n,w,p+1,t[f]+i+1,o);S!=En?(l[f]=g,l[f+1]=y,l[f+2]=S):(l[f+1]=-2,d=!0)}else d=!0}if(d){let f=oU(l,t,e,n,s,i,o),p=Gh(f,r,0,o);e=p.local;for(let g=0;g<l.length;g+=3)l[g+1]<0&&(l.splice(g,3),g-=3);for(let g=0,m=0;g<p.children.length;g+=3){let y=p.children[g];for(;m<l.length&&l[m]<y;)m+=3;l.splice(m,0,p.children[g],p.children[g+1],p.children[g+2])}}return new Rt(e.sort(Ja),l)}function eA(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let s=t[r];n.push(new Pn(s.from+e,s.to+e,s.type))}return n}function oU(t,e,n,r,s,i,o){function l(d,f){for(let p=0;p<d.local.length;p++){let g=d.local[p].map(r,s,f);g?n.push(g):o.onRemove&&o.onRemove(d.local[p].spec)}for(let p=0;p<d.children.length;p+=3)l(d.children[p+2],d.children[p]+f+1)}for(let d=0;d<t.length;d+=3)t[d+1]==-1&&l(t[d+2],e[d]+i+1);return n}function tA(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,s=null;for(let i=0,o;i<t.length;i++)(o=t[i])&&o.from>n&&o.to<r&&((s||(s=[])).push(o),t[i]=null);return s}function nA(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Gh(t,e,n,r){let s=[],i=!1;e.forEach((l,d)=>{let f=tA(t,l,d+n);if(f){i=!0;let p=Gh(f,l,n+d+1,r);p!=En&&s.push(d,d+l.nodeSize,p)}});let o=eA(i?nA(t):t,-n).sort(Ja);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(r.onRemove&&r.onRemove(o[l].spec),o.splice(l--,1));return o.length||s.length?new Rt(o,s):En}function Ja(t,e){return t.from-e.from||t.to-e.to}function Tv(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let s=n+1;s<e.length;s++){let i=e[s];if(i.from==r.from){i.to!=r.to&&(e==t&&(e=t.slice()),e[s]=i.copy(i.from,r.to),NN(e,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),NN(e,s,r.copy(i.from,r.to)));break}}}return e}function NN(t,e,n){for(;e<t.length&&Ja(n,t[e])>0;)e++;t.splice(e,0,n)}function ay(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=En&&e.push(r)}),t.cursorWrapper&&e.push(Rt.create(t.state.doc,[t.cursorWrapper.deco])),Ji.from(e)}const lU={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},cU=ir&&da<=11;class uU{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class dU{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new uU,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);ir&&da<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),cU&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,lU)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(yN(this.view)){if(this.suppressingSelectionUpdates)return ci(this.view);if(ir&&da<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&lo(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let i=e.focusNode;i;i=Vl(i))n.add(i);for(let i=e.anchorNode;i;i=Vl(i))if(n.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&yN(e)&&!this.ignoreSelectionChange(r),i=-1,o=-1,l=!1,d=[];if(e.editable)for(let p=0;p<n.length;p++){let g=this.registerMutation(n[p],d);g&&(i=i<0?g.from:Math.min(g.from,i),o=o<0?g.to:Math.max(g.to,o),g.typeOver&&(l=!0))}if(Xr&&d.length){let p=d.filter(g=>g.nodeName=="BR");if(p.length==2){let[g,m]=p;g.parentNode&&g.parentNode.parentNode==m.parentNode?m.remove():g.remove()}else{let{focusNode:g}=this.currentSelection;for(let m of p){let y=m.parentNode;y&&y.nodeName=="LI"&&(!g||pU(e,g)!=y)&&m.remove()}}}let f=null;i<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&ng(r)&&(f=bv(e))&&f.eq(Ge.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,ci(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||s)&&(i>-1&&(e.docView.markDirty(i,o),fU(e)),this.handleDOMChange(i,o,l,d),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||ci(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let p=0;p<e.addedNodes.length;p++){let g=e.addedNodes[p];n.push(g),g.nodeType==3&&(this.lastChangedTextNode=g)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,i=e.nextSibling;if(ir&&da<=11&&e.addedNodes.length)for(let p=0;p<e.addedNodes.length;p++){let{previousSibling:g,nextSibling:m}=e.addedNodes[p];(!g||Array.prototype.indexOf.call(e.addedNodes,g)<0)&&(s=g),(!m||Array.prototype.indexOf.call(e.addedNodes,m)<0)&&(i=m)}let o=s&&s.parentNode==e.target?Sn(s)+1:0,l=r.localPosFromDOM(e.target,o,-1),d=i&&i.parentNode==e.target?Sn(i):e.target.childNodes.length,f=r.localPosFromDOM(e.target,d,1);return{from:l,to:f}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let TN=new WeakMap,jN=!1;function fU(t){if(!TN.has(t)&&(TN.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Xr,jN)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),jN=!0}}function EN(t,e){let n=e.startContainer,r=e.startOffset,s=e.endContainer,i=e.endOffset,o=t.domAtPos(t.state.selection.anchor);return lo(o.node,o.offset,s,i)&&([n,r,s,i]=[s,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:i}}function hU(t,e){if(e.getComposedRanges){let s=e.getComposedRanges(t.root)[0];if(s)return EN(t,s)}let n;function r(s){s.preventDefault(),s.stopImmediatePropagation(),n=s.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?EN(t,n):null}function pU(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function gU(t,e,n){let{node:r,fromOffset:s,toOffset:i,from:o,to:l}=t.docView.parseRange(e,n),d=t.domSelectionRange(),f,p=d.anchorNode;if(p&&t.dom.contains(p.nodeType==1?p:p.parentNode)&&(f=[{node:p,offset:d.anchorOffset}],ng(d)||f.push({node:d.focusNode,offset:d.focusOffset})),Rn&&t.input.lastKeyCode===8)for(let w=i;w>s;w--){let S=r.childNodes[w-1],T=S.pmViewDesc;if(S.nodeName=="BR"&&!T){i=w;break}if(!T||T.size)break}let g=t.state.doc,m=t.someProp("domParser")||Cu.fromSchema(t.state.schema),y=g.resolve(o),b=null,v=m.parse(r,{topNode:y.parent,topMatch:y.parent.contentMatchAt(y.index()),topOpen:!0,from:s,to:i,preserveWhitespace:y.parent.type.whitespace=="pre"?"full":!0,findPositions:f,ruleFromNode:mU,context:y});if(f&&f[0].pos!=null){let w=f[0].pos,S=f[1]&&f[1].pos;S==null&&(S=w),b={anchor:w+o,head:S+o}}return{doc:v,sel:b,from:o,to:l}}function mU(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Un&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Un&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const yU=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function xU(t,e,n,r,s){let i=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let O=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,L=bv(t,O);if(L&&!t.state.selection.eq(L)){if(Rn&&ai&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",F=>F(t,Ba(13,"Enter"))))return;let A=t.state.tr.setSelection(L);O=="pointer"?A.setMeta("pointer",!0):O=="key"&&A.scrollIntoView(),i&&A.setMeta("composition",i),t.dispatch(A)}return}let o=t.state.doc.resolve(e),l=o.sharedDepth(n);e=o.before(l+1),n=t.state.doc.resolve(n).after(l+1);let d=t.state.selection,f=gU(t,e,n),p=t.state.doc,g=p.slice(f.from,f.to),m,y;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(m=t.state.selection.to,y="end"):(m=t.state.selection.from,y="start"),t.input.lastKeyCode=null;let b=wU(g.content,f.doc.content,f.from,m,y);if(b&&t.input.domChangeCount++,(Kl&&t.input.lastIOSEnter>Date.now()-225||ai)&&s.some(O=>O.nodeType==1&&!yU.test(O.nodeName))&&(!b||b.endA>=b.endB)&&t.someProp("handleKeyDown",O=>O(t,Ba(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!b)if(r&&d instanceof qe&&!d.empty&&d.$head.sameParent(d.$anchor)&&!t.composing&&!(f.sel&&f.sel.anchor!=f.sel.head))b={start:d.from,endA:d.to,endB:d.to};else{if(f.sel){let O=MN(t,t.state.doc,f.sel);if(O&&!O.eq(t.state.selection)){let L=t.state.tr.setSelection(O);i&&L.setMeta("composition",i),t.dispatch(L)}}return}t.state.selection.from<t.state.selection.to&&b.start==b.endB&&t.state.selection instanceof qe&&(b.start>t.state.selection.from&&b.start<=t.state.selection.from+2&&t.state.selection.from>=f.from?b.start=t.state.selection.from:b.endA<t.state.selection.to&&b.endA>=t.state.selection.to-2&&t.state.selection.to<=f.to&&(b.endB+=t.state.selection.to-b.endA,b.endA=t.state.selection.to)),ir&&da<=11&&b.endB==b.start+1&&b.endA==b.start&&b.start>f.from&&f.doc.textBetween(b.start-f.from-1,b.start-f.from+1)==" "&&(b.start--,b.endA--,b.endB--);let v=f.doc.resolveNoCache(b.start-f.from),w=f.doc.resolveNoCache(b.endB-f.from),S=p.resolve(b.start),T=v.sameParent(w)&&v.parent.inlineContent&&S.end()>=b.endA;if((Kl&&t.input.lastIOSEnter>Date.now()-225&&(!T||s.some(O=>O.nodeName=="DIV"||O.nodeName=="P"))||!T&&v.pos<f.doc.content.size&&(!v.sameParent(w)||!v.parent.inlineContent)&&v.pos<w.pos&&!/\S/.test(f.doc.textBetween(v.pos,w.pos,"","")))&&t.someProp("handleKeyDown",O=>O(t,Ba(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>b.start&&vU(p,b.start,b.endA,v,w)&&t.someProp("handleKeyDown",O=>O(t,Ba(8,"Backspace")))){ai&&Rn&&t.domObserver.suppressSelectionUpdates();return}Rn&&b.endB==b.start&&(t.input.lastChromeDelete=Date.now()),ai&&!T&&v.start()!=w.start()&&w.parentOffset==0&&v.depth==w.depth&&f.sel&&f.sel.anchor==f.sel.head&&f.sel.head==b.endA&&(b.endB-=2,w=f.doc.resolveNoCache(b.endB-f.from),setTimeout(()=>{t.someProp("handleKeyDown",function(O){return O(t,Ba(13,"Enter"))})},20));let j=b.start,M=b.endA,_=O=>{let L=O||t.state.tr.replace(j,M,f.doc.slice(b.start-f.from,b.endB-f.from));if(f.sel){let A=MN(t,L.doc,f.sel);A&&!(Rn&&t.composing&&A.empty&&(b.start!=b.endB||t.input.lastChromeDelete<Date.now()-100)&&(A.head==j||A.head==L.mapping.map(M)-1)||ir&&A.empty&&A.head==j)&&L.setSelection(A)}return i&&L.setMeta("composition",i),L.scrollIntoView()},R;if(T)if(v.pos==w.pos){ir&&da<=11&&v.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>ci(t),20));let O=_(t.state.tr.delete(j,M)),L=p.resolve(b.start).marksAcross(p.resolve(b.endA));L&&O.ensureMarks(L),t.dispatch(O)}else if(b.endA==b.endB&&(R=bU(v.parent.content.cut(v.parentOffset,w.parentOffset),S.parent.content.cut(S.parentOffset,b.endA-S.start())))){let O=_(t.state.tr);R.type=="add"?O.addMark(j,M,R.mark):O.removeMark(j,M,R.mark),t.dispatch(O)}else if(v.parent.child(v.index()).isText&&v.index()==w.index()-(w.textOffset?0:1)){let O=v.parent.textBetween(v.parentOffset,w.parentOffset),L=()=>_(t.state.tr.insertText(O,j,M));t.someProp("handleTextInput",A=>A(t,j,M,O,L))||t.dispatch(L())}else t.dispatch(_());else t.dispatch(_())}function MN(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:vv(t,e.resolve(n.anchor),e.resolve(n.head))}function bU(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,s=n,i=r,o,l,d;for(let p=0;p<r.length;p++)s=r[p].removeFromSet(s);for(let p=0;p<n.length;p++)i=n[p].removeFromSet(i);if(s.length==1&&i.length==0)l=s[0],o="add",d=p=>p.mark(l.addToSet(p.marks));else if(s.length==0&&i.length==1)l=i[0],o="remove",d=p=>p.mark(l.removeFromSet(p.marks));else return null;let f=[];for(let p=0;p<e.childCount;p++)f.push(d(e.child(p)));if(Ne.from(f).eq(t))return{mark:l,type:o}}function vU(t,e,n,r,s){if(n-e<=s.pos-r.pos||oy(r,!0,!1)<s.pos)return!1;let i=t.resolve(e);if(!r.parent.isTextblock){let l=i.nodeAfter;return l!=null&&n==e+l.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=t.resolve(oy(i,!0,!0));return!o.parent.isTextblock||o.pos>n||oy(o,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function oy(t,e,n){let r=t.depth,s=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,s++,e=!1;if(n){let i=t.node(r).maybeChild(t.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function wU(t,e,n,r,s){let i=t.findDiffStart(e,n);if(i==null)return null;let{a:o,b:l}=t.findDiffEnd(e,n+t.size,n+e.size);if(s=="end"){let d=Math.max(0,i-Math.min(o,l));r-=o+d-i}if(o<i&&t.size<e.size){let d=r<=i&&r>=o?i-r:0;i-=d,i&&i<e.size&&AN(e.textBetween(i-1,i+1))&&(i+=d?1:-1),l=i+(l-o),o=i}else if(l<i){let d=r<=i&&r>=l?i-r:0;i-=d,i&&i<t.size&&AN(t.textBetween(i-1,i+1))&&(i+=d?1:-1),o=i+(o-l),l=i}return{start:i,endA:o,endB:l}}function AN(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class rA{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new F9,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(DN),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=ON(this),_N(this),this.nodeViews=IN(this),this.docView=dN(this.state.doc,RN(this),ay(this),this.dom,this),this.domObserver=new dU(this,(r,s,i,o)=>xU(this,r,s,i,o)),this.domObserver.start(),U9(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Vx(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(DN),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let s=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&(GM(this),o=!0),this.state=e;let l=s.plugins!=e.plugins||this._props.plugins!=n.plugins;if(l||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let y=IN(this);kU(y,this.nodeViews)&&(this.nodeViews=y,i=!0)}(l||n.handleDOMEvents!=this._props.handleDOMEvents)&&Vx(this),this.editable=ON(this),_N(this);let d=ay(this),f=RN(this),p=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",g=i||!this.docView.matchesNode(e.doc,f,d);(g||!e.selection.eq(s.selection))&&(o=!0);let m=p=="preserve"&&o&&this.dom.style.overflowAnchor==null&&t9(this);if(o){this.domObserver.stop();let y=g&&(ir||Rn)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&SU(s.selection,e.selection);if(g){let b=Rn?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=eU(this)),(i||!this.docView.update(e.doc,f,d,this))&&(this.docView.updateOuterDeco(f),this.docView.destroy(),this.docView=dN(e.doc,f,d,this.dom,this)),b&&!this.trackWrites&&(y=!0)}y||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&N9(this))?ci(this,y):(PM(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),p=="reset"?this.dom.scrollTop=0:p=="to selection"?this.scrollToSelection():m&&n9(m)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof Be){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&iN(this,n.getBoundingClientRect(),e)}else iN(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-n.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new JM(e.slice,e.move,s<0?void 0:Be.create(this.state.doc,s))}someProp(e,n){let r=this._props&&this._props[e],s;if(r!=null&&(s=n?n(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(s=n?n(l):l))return s}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let l=i[o].props[e];if(l!=null&&(s=n?n(l):l))return s}}hasFocus(){if(ir){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&r9(this.dom),ci(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return l9(this,e)}coordsAtPos(e,n=1){return AM(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let s=this.docView.posFromDOM(e,n,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,n){return h9(this,n||this.state,e)}pasteHTML(e,n){return Yu(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Yu(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return wv(this,e)}destroy(){this.docView&&($9(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ay(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,HF())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return H9(this,e)}domSelectionRange(){let e=this.domSelection();return e?Un&&this.root.nodeType===11&&YF(this.dom.ownerDocument)==this.dom&&hU(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}rA.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function RN(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[Pn.node(0,t.state.doc.content.size,e)]}function _N(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Pn.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function ON(t){return!t.someProp("editable",e=>e(t.state)===!1)}function SU(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function IN(t){let e=Object.create(null);function n(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function kU(t,e){let n=0,r=0;for(let s in t){if(t[s]!=e[s])return!0;n++}for(let s in e)r++;return n!=r}function DN(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var ga={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Xh={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},CU=typeof navigator<"u"&&/Mac/.test(navigator.platform),NU=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var kn=0;kn<10;kn++)ga[48+kn]=ga[96+kn]=String(kn);for(var kn=1;kn<=24;kn++)ga[kn+111]="F"+kn;for(var kn=65;kn<=90;kn++)ga[kn]=String.fromCharCode(kn+32),Xh[kn]=String.fromCharCode(kn);for(var ly in ga)Xh.hasOwnProperty(ly)||(Xh[ly]=ga[ly]);function TU(t){var e=CU&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||NU&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Xh:ga)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const jU=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),EU=typeof navigator<"u"&&/Win/.test(navigator.platform);function MU(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,s,i,o;for(let l=0;l<e.length-1;l++){let d=e[l];if(/^(cmd|meta|m)$/i.test(d))o=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))s=!0;else if(/^s(hift)?$/i.test(d))i=!0;else if(/^mod$/i.test(d))jU?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+d)}return r&&(n="Alt-"+n),s&&(n="Ctrl-"+n),o&&(n="Meta-"+n),i&&(n="Shift-"+n),n}function AU(t){let e=Object.create(null);for(let n in t)e[MU(n)]=t[n];return e}function cy(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function RU(t){return new _t({props:{handleKeyDown:sA(t)}})}function sA(t){let e=AU(t);return function(n,r){let s=TU(r),i,o=e[cy(s,r)];if(o&&o(n.state,n.dispatch,n))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let l=e[cy(s,r,!1)];if(l&&l(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(EU&&r.ctrlKey&&r.altKey)&&(i=ga[r.keyCode])&&i!=s){let l=e[cy(i,r)];if(l&&l(n.state,n.dispatch,n))return!0}}return!1}}var _U=Object.defineProperty,jv=(t,e)=>{for(var n in e)_U(t,n,{get:e[n],enumerable:!0})};function ig(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:s}=n,{storedMarks:i}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,i=n.storedMarks,n}}}var ag=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:r}=e,{tr:s}=n,i=this.buildProps(s);return Object.fromEntries(Object.entries(t).map(([o,l])=>[o,(...f)=>{const p=l(...f)(i);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(s),p}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:i}=r,o=[],l=!!t,d=t||s.tr,f=()=>(!l&&e&&!d.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(d),o.every(g=>g===!0)),p={...Object.fromEntries(Object.entries(n).map(([g,m])=>[g,(...b)=>{const v=this.buildProps(d,e),w=m(...b)(v);return o.push(w),p}])),run:f};return p}createCan(t){const{rawCommands:e,state:n}=this,r=!1,s=t||n.tr,i=this.buildProps(s,r);return{...Object.fromEntries(Object.entries(e).map(([l,d])=>[l,(...f)=>d(...f)({...i,dispatch:void 0})])),chain:()=>this.createChain(s,r)}}buildProps(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:i}=r,o={tr:t,editor:r,view:i,state:ig({state:s,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([l,d])=>[l,(...f)=>d(...f)(o)]))}};return o}},iA={};jv(iA,{blur:()=>OU,clearContent:()=>IU,clearNodes:()=>DU,command:()=>LU,createParagraphNear:()=>zU,cut:()=>PU,deleteCurrentNode:()=>BU,deleteNode:()=>FU,deleteRange:()=>UU,deleteSelection:()=>$U,enter:()=>qU,exitCode:()=>HU,extendMarkRange:()=>VU,first:()=>KU,focus:()=>WU,forEach:()=>YU,insertContent:()=>GU,insertContentAt:()=>ZU,joinBackward:()=>n$,joinDown:()=>t$,joinForward:()=>r$,joinItemBackward:()=>s$,joinItemForward:()=>i$,joinTextblockBackward:()=>a$,joinTextblockForward:()=>o$,joinUp:()=>e$,keyboardShortcut:()=>c$,lift:()=>u$,liftEmptyBlock:()=>d$,liftListItem:()=>f$,newlineInCode:()=>h$,resetAttributes:()=>p$,scrollIntoView:()=>g$,selectAll:()=>m$,selectNodeBackward:()=>y$,selectNodeForward:()=>x$,selectParentNode:()=>b$,selectTextblockEnd:()=>v$,selectTextblockStart:()=>w$,setContent:()=>S$,setMark:()=>F$,setMeta:()=>U$,setNode:()=>$$,setNodeSelection:()=>q$,setTextDirection:()=>H$,setTextSelection:()=>V$,sinkListItem:()=>K$,splitBlock:()=>Q$,splitListItem:()=>W$,toggleList:()=>Y$,toggleMark:()=>G$,toggleNode:()=>X$,toggleWrap:()=>J$,undoInputRule:()=>Z$,unsetAllMarks:()=>eq,unsetMark:()=>tq,unsetTextDirection:()=>nq,updateAttributes:()=>rq,wrapIn:()=>sq,wrapInList:()=>iq});var OU=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window?.getSelection())==null||n.removeAllRanges())}),!0),IU=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),DU=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:s}=r;return n&&s.forEach(({$from:i,$to:o})=>{t.doc.nodesBetween(i.pos,o.pos,(l,d)=>{if(l.type.isText)return;const{doc:f,mapping:p}=e,g=f.resolve(p.map(d)),m=f.resolve(p.map(d+l.nodeSize)),y=g.blockRange(m);if(!y)return;const b=ac(y);if(l.type.isTextblock){const{defaultType:v}=g.parent.contentMatchAt(g.index());e.setNodeMarkup(y.start,v)}(b||b===0)&&e.lift(y,b)})}),!0},LU=t=>e=>t(e),zU=()=>({state:t,dispatch:e})=>vM(t,e),PU=(t,e)=>({editor:n,tr:r})=>{const{state:s}=n,i=s.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const o=r.mapping.map(e);return r.insert(o,i.content),r.setSelection(new qe(r.doc.resolve(Math.max(o-1,0)))),!0},BU=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const s=t.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===r.type){if(e){const l=s.before(i),d=s.after(i);t.delete(l,d).scrollIntoView()}return!0}return!1};function Jt(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var FU=t=>({tr:e,state:n,dispatch:r})=>{const s=Jt(t,n.schema),i=e.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s){if(r){const d=i.before(o),f=i.after(o);e.delete(d,f).scrollIntoView()}return!0}return!1},UU=t=>({tr:e,dispatch:n})=>{const{from:r,to:s}=t;return n&&e.delete(r,s),!0},$U=()=>({state:t,dispatch:e})=>hv(t,e),qU=()=>({commands:t})=>t.keyboardShortcut("Enter"),HU=()=>({state:t,dispatch:e})=>MF(t,e);function Ev(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Jh(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>n.strict?e[s]===t[s]:Ev(e[s])?e[s].test(t[s]):e[s]===t[s]):!0}function aA(t,e,n={}){return t.find(r=>r.type===e&&Jh(Object.fromEntries(Object.keys(n).map(s=>[s,r.attrs[s]])),n))}function LN(t,e,n={}){return!!aA(t,e,n)}function Mv(t,e,n){var r;if(!t||!e)return;let s=t.parent.childAfter(t.parentOffset);if((!s.node||!s.node.marks.some(p=>p.type===e))&&(s=t.parent.childBefore(t.parentOffset)),!s.node||!s.node.marks.some(p=>p.type===e)||(n=n||((r=s.node.marks[0])==null?void 0:r.attrs),!aA([...s.node.marks],e,n)))return;let o=s.index,l=t.start()+s.offset,d=o+1,f=l+s.node.nodeSize;for(;o>0&&LN([...t.parent.child(o-1).marks],e,n);)o-=1,l-=t.parent.child(o).nodeSize;for(;d<t.parent.childCount&&LN([...t.parent.child(d).marks],e,n);)f+=t.parent.child(d).nodeSize,d+=1;return{from:l,to:f}}function bi(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var VU=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const i=bi(t,r.schema),{doc:o,selection:l}=n,{$from:d,from:f,to:p}=l;if(s){const g=Mv(d,i,e);if(g&&g.from<=f&&g.to>=p){const m=qe.create(o,g.from,g.to);n.setSelection(m)}}return!0},KU=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function oA(t){return t instanceof qe}function qa(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function lA(t,e=null){if(!e)return null;const n=Ge.atStart(t),r=Ge.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const s=n.from,i=r.to;return e==="all"?qe.create(t,qa(0,s,i),qa(t.content.size,s,i)):qe.create(t,qa(e,s,i),qa(e,s,i))}function QU(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Av(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var WU=(t=null,e={})=>({editor:n,view:r,tr:s,dispatch:i})=>{e={scrollIntoView:!0,...e};const o=()=>{(Av()||QU())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e?.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(i&&t===null&&!oA(n.state.selection))return o(),!0;const l=lA(s.doc,t)||n.state.selection,d=n.state.selection.eq(l);return i&&(d||s.setSelection(l),d&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},YU=(t,e)=>n=>t.every((r,s)=>e(r,{...n,index:s})),GU=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),cA=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&cA(r)}return t};function Zf(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return cA(n)}function Xu(t,e,n){if(t instanceof ua||t instanceof Ne)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,s=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return Ne.fromArray(t.map(l=>e.nodeFromJSON(l)));const o=e.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(i){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",i),Xu("",e,n)}if(s){if(n.errorOnInvalidContent){let o=!1,l="";const d=new Q3({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:f=>(o=!0,l=typeof f=="string"?f:f.outerHTML,null)}]}})});if(n.slice?Cu.fromSchema(d).parseSlice(Zf(t),n.parseOptions):Cu.fromSchema(d).parse(Zf(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const i=Cu.fromSchema(e);return n.slice?i.parseSlice(Zf(t),n.parseOptions).content:i.parse(Zf(t),n.parseOptions)}return Xu("",e,n)}function XU(t,e,n){const r=t.steps.length-1;if(r<e)return;const s=t.steps[r];if(!(s instanceof dn||s instanceof fn))return;const i=t.mapping.maps[r];let o=0;i.forEach((l,d,f,p)=>{o===0&&(o=p)}),t.setSelection(Ge.near(t.doc.resolve(o),n))}var JU=t=>!("type"in t),ZU=(t,e,n)=>({tr:r,dispatch:s,editor:i})=>{var o;if(s){n={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let l;const d=w=>{i.emit("contentError",{editor:i,error:w,disableCollaboration:()=>{"collaboration"in i.storage&&typeof i.storage.collaboration=="object"&&i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},f={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{Xu(e,i.schema,{parseOptions:f,errorOnInvalidContent:!0})}catch(w){d(w)}try{l=Xu(e,i.schema,{parseOptions:f,errorOnInvalidContent:(o=n.errorOnInvalidContent)!=null?o:i.options.enableContentCheck})}catch(w){return d(w),!1}let{from:p,to:g}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},m=!0,y=!0;if((JU(l)?l:[l]).forEach(w=>{w.check(),m=m?w.isText&&w.marks.length===0:!1,y=y?w.isBlock:!1}),p===g&&y){const{parent:w}=r.doc.resolve(p);w.isTextblock&&!w.type.spec.code&&!w.childCount&&(p-=1,g+=1)}let v;if(m){if(Array.isArray(e))v=e.map(w=>w.text||"").join("");else if(e instanceof Ne){let w="";e.forEach(S=>{S.text&&(w+=S.text)}),v=w}else typeof e=="object"&&e&&e.text?v=e.text:v=e;r.insertText(v,p,g)}else{v=l;const w=r.doc.resolve(p),S=w.node(),T=w.parentOffset===0,j=S.isText||S.isTextblock,M=S.content.size>0;T&&j&&M&&(p=Math.max(0,p-1)),r.replaceWith(p,g,v)}n.updateSelection&&XU(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:p,text:v}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:p,text:v})}return!0},e$=()=>({state:t,dispatch:e})=>TF(t,e),t$=()=>({state:t,dispatch:e})=>jF(t,e),n$=()=>({state:t,dispatch:e})=>hM(t,e),r$=()=>({state:t,dispatch:e})=>yM(t,e),s$=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Zp(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},i$=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Zp(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},a$=()=>({state:t,dispatch:e})=>CF(t,e),o$=()=>({state:t,dispatch:e})=>NF(t,e);function uA(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function l$(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,s,i,o;for(let l=0;l<e.length-1;l+=1){const d=e[l];if(/^(cmd|meta|m)$/i.test(d))o=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))s=!0;else if(/^s(hift)?$/i.test(d))i=!0;else if(/^mod$/i.test(d))Av()||uA()?o=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),i&&(n=`Shift-${n}`),n}var c$=t=>({editor:e,view:n,tr:r,dispatch:s})=>{const i=l$(t).split(/-(?!$)/),o=i.find(f=>!["Alt","Ctrl","Meta","Shift"].includes(f)),l=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),d=e.captureTransaction(()=>{n.someProp("handleKeyDown",f=>f(n,l))});return d?.steps.forEach(f=>{const p=f.map(r.mapping);p&&s&&r.maybeStep(p)}),!0};function ma(t,e,n={}){const{from:r,to:s,empty:i}=t.selection,o=e?Jt(e,t.schema):null,l=[];t.doc.nodesBetween(r,s,(g,m)=>{if(g.isText)return;const y=Math.max(r,m),b=Math.min(s,m+g.nodeSize);l.push({node:g,from:y,to:b})});const d=s-r,f=l.filter(g=>o?o.name===g.node.type.name:!0).filter(g=>Jh(g.node.attrs,n,{strict:!1}));return i?!!f.length:f.reduce((g,m)=>g+m.to-m.from,0)>=d}var u$=(t,e={})=>({state:n,dispatch:r})=>{const s=Jt(t,n.schema);return ma(n,s,e)?EF(n,r):!1},d$=()=>({state:t,dispatch:e})=>wM(t,e),f$=t=>({state:e,dispatch:n})=>{const r=Jt(t,e.schema);return FF(r)(e,n)},h$=()=>({state:t,dispatch:e})=>bM(t,e);function og(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function zN(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,s)=>(n.includes(s)||(r[s]=t[s]),r),{})}var p$=(t,e)=>({tr:n,state:r,dispatch:s})=>{let i=null,o=null;const l=og(typeof t=="string"?t:t.name,r.schema);if(!l)return!1;l==="node"&&(i=Jt(t,r.schema)),l==="mark"&&(o=bi(t,r.schema));let d=!1;return n.selection.ranges.forEach(f=>{r.doc.nodesBetween(f.$from.pos,f.$to.pos,(p,g)=>{i&&i===p.type&&(d=!0,s&&n.setNodeMarkup(g,void 0,zN(p.attrs,e))),o&&p.marks.length&&p.marks.forEach(m=>{o===m.type&&(d=!0,s&&n.addMark(g,g+p.nodeSize,o.create(zN(m.attrs,e))))})})}),d},g$=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),m$=()=>({tr:t,dispatch:e})=>{if(e){const n=new kr(t.doc);t.setSelection(n)}return!0},y$=()=>({state:t,dispatch:e})=>gM(t,e),x$=()=>({state:t,dispatch:e})=>xM(t,e),b$=()=>({state:t,dispatch:e})=>_F(t,e),v$=()=>({state:t,dispatch:e})=>DF(t,e),w$=()=>({state:t,dispatch:e})=>IF(t,e);function Kx(t,e,n={},r={}){return Xu(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var S$=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:s,tr:i,dispatch:o,commands:l})=>{const{doc:d}=i;if(r.preserveWhitespace!=="full"){const f=Kx(t,s.schema,r,{errorOnInvalidContent:e??s.options.enableContentCheck});return o&&i.replaceWith(0,d.content.size,f).setMeta("preventUpdate",!n),!0}return o&&i.setMeta("preventUpdate",!n),l.insertContentAt({from:0,to:d.content.size},t,{parseOptions:r,errorOnInvalidContent:e??s.options.enableContentCheck})};function dA(t,e){const n=bi(e,t.schema),{from:r,to:s,empty:i}=t.selection,o=[];i?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,s,d=>{o.push(...d.marks)});const l=o.find(d=>d.type.name===n.name);return l?{...l.attrs}:{}}function fA(t,e){const n=new cM(t);return e.forEach(r=>{r.steps.forEach(s=>{n.step(s)})}),n}function k$(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function C$(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(s,i)=>{n(s)&&r.push({node:s,pos:i})}),r}function N$(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function lg(t){return e=>N$(e.$from,t)}function Pe(t,e,n){return t.config[e]===void 0&&t.parent?Pe(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?Pe(t.parent,e,n):null}):t.config[e]}function Rv(t){return t.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=Pe(e,"addExtensions",n);return r?[e,...Rv(r())]:e}).flat(10)}function _v(t,e){const n=ko.fromSchema(e).serializeFragment(t),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}function hA(t){return typeof t=="function"}function gt(t,e=void 0,...n){return hA(t)?e?t.bind(e)(...n):t(...n):t}function T$(t={}){return Object.keys(t).length===0&&t.constructor===Object}function Ql(t){const e=t.filter(s=>s.type==="extension"),n=t.filter(s=>s.type==="node"),r=t.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function pA(t){const e=[],{nodeExtensions:n,markExtensions:r}=Ql(t),s=[...n,...r],i={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage,extensions:s},d=Pe(o,"addGlobalAttributes",l);if(!d)return;d().forEach(p=>{p.types.forEach(g=>{Object.entries(p.attributes).forEach(([m,y])=>{e.push({type:g,name:m,attribute:{...i,...y}})})})})}),s.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage},d=Pe(o,"addAttributes",l);if(!d)return;const f=d();Object.entries(f).forEach(([p,g])=>{const m={...i,...g};typeof m?.default=="function"&&(m.default=m.default()),m?.isRequired&&m?.default===void 0&&delete m.default,e.push({type:o.name,name:p,attribute:m})})}),e}function Zt(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([s,i])=>{if(!r[s]){r[s]=i;return}if(s==="class"){const l=i?String(i).split(" "):[],d=r[s]?r[s].split(" "):[],f=l.filter(p=>!d.includes(p));r[s]=[...d,...f].join(" ")}else if(s==="style"){const l=i?i.split(";").map(p=>p.trim()).filter(Boolean):[],d=r[s]?r[s].split(";").map(p=>p.trim()).filter(Boolean):[],f=new Map;d.forEach(p=>{const[g,m]=p.split(":").map(y=>y.trim());f.set(g,m)}),l.forEach(p=>{const[g,m]=p.split(":").map(y=>y.trim());f.set(g,m)}),r[s]=Array.from(f.entries()).map(([p,g])=>`${p}: ${g}`).join("; ")}else r[s]=i}),r},{})}function Zh(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>Zt(n,r),{})}function j$(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function PN(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const s=e.reduce((i,o)=>{const l=o.attribute.parseHTML?o.attribute.parseHTML(n):j$(n.getAttribute(o.name));return l==null?i:{...i,[o.name]:l}},{});return{...r,...s}}}}function BN(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&T$(n)?!1:n!=null))}function FN(t){var e,n;const r={};return!((e=t?.attribute)!=null&&e.isRequired)&&"default"in(t?.attribute||{})&&(r.default=t.attribute.default),((n=t?.attribute)==null?void 0:n.validate)!==void 0&&(r.validate=t.attribute.validate),[t.name,r]}function E$(t,e){var n;const r=pA(t),{nodeExtensions:s,markExtensions:i}=Ql(t),o=(n=s.find(f=>Pe(f,"topNode")))==null?void 0:n.name,l=Object.fromEntries(s.map(f=>{const p=r.filter(S=>S.type===f.name),g={name:f.name,options:f.options,storage:f.storage,editor:e},m=t.reduce((S,T)=>{const j=Pe(T,"extendNodeSchema",g);return{...S,...j?j(f):{}}},{}),y=BN({...m,content:gt(Pe(f,"content",g)),marks:gt(Pe(f,"marks",g)),group:gt(Pe(f,"group",g)),inline:gt(Pe(f,"inline",g)),atom:gt(Pe(f,"atom",g)),selectable:gt(Pe(f,"selectable",g)),draggable:gt(Pe(f,"draggable",g)),code:gt(Pe(f,"code",g)),whitespace:gt(Pe(f,"whitespace",g)),linebreakReplacement:gt(Pe(f,"linebreakReplacement",g)),defining:gt(Pe(f,"defining",g)),isolating:gt(Pe(f,"isolating",g)),attrs:Object.fromEntries(p.map(FN))}),b=gt(Pe(f,"parseHTML",g));b&&(y.parseDOM=b.map(S=>PN(S,p)));const v=Pe(f,"renderHTML",g);v&&(y.toDOM=S=>v({node:S,HTMLAttributes:Zh(S,p)}));const w=Pe(f,"renderText",g);return w&&(y.toText=w),[f.name,y]})),d=Object.fromEntries(i.map(f=>{const p=r.filter(w=>w.type===f.name),g={name:f.name,options:f.options,storage:f.storage,editor:e},m=t.reduce((w,S)=>{const T=Pe(S,"extendMarkSchema",g);return{...w,...T?T(f):{}}},{}),y=BN({...m,inclusive:gt(Pe(f,"inclusive",g)),excludes:gt(Pe(f,"excludes",g)),group:gt(Pe(f,"group",g)),spanning:gt(Pe(f,"spanning",g)),code:gt(Pe(f,"code",g)),attrs:Object.fromEntries(p.map(FN))}),b=gt(Pe(f,"parseHTML",g));b&&(y.parseDOM=b.map(w=>PN(w,p)));const v=Pe(f,"renderHTML",g);return v&&(y.toDOM=w=>v({mark:w,HTMLAttributes:Zh(w,p)})),[f.name,y]}));return new Q3({topNode:o,nodes:l,marks:d})}function M$(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}function Ov(t){return t.sort((n,r)=>{const s=Pe(n,"priority")||100,i=Pe(r,"priority")||100;return s>i?-1:s<i?1:0})}function gA(t){const e=Ov(Rv(t)),n=M$(e.map(r=>r.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function mA(t,e,n){const{from:r,to:s}=e,{blockSeparator:i=`

`,textSerializers:o={}}=n||{};let l="";return t.nodesBetween(r,s,(d,f,p,g)=>{var m;d.isBlock&&f>r&&(l+=i);const y=o?.[d.type.name];if(y)return p&&(l+=y({node:d,pos:f,parent:p,index:g,range:e})),!1;d.isText&&(l+=(m=d?.text)==null?void 0:m.slice(Math.max(r,f)-f,s-f))}),l}function A$(t,e){const n={from:0,to:t.content.size};return mA(t,n,e)}function yA(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function R$(t,e){const n=Jt(e,t.schema),{from:r,to:s}=t.selection,i=[];t.doc.nodesBetween(r,s,l=>{i.push(l)});const o=i.reverse().find(l=>l.type.name===n.name);return o?{...o.attrs}:{}}function xA(t,e){const n=og(typeof e=="string"?e:e.name,t.schema);return n==="node"?R$(t,e):n==="mark"?dA(t,e):{}}function _$(t,e=JSON.stringify){const n={};return t.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(n,s)?!1:n[s]=!0})}function O$(t){const e=_$(t);return e.length===1?e:e.filter((n,r)=>!e.filter((i,o)=>o!==r).some(i=>n.oldRange.from>=i.oldRange.from&&n.oldRange.to<=i.oldRange.to&&n.newRange.from>=i.newRange.from&&n.newRange.to<=i.newRange.to))}function bA(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((s,i)=>{const o=[];if(s.ranges.length)s.forEach((l,d)=>{o.push({from:l,to:d})});else{const{from:l,to:d}=n[i];if(l===void 0||d===void 0)return;o.push({from:l,to:d})}o.forEach(({from:l,to:d})=>{const f=e.slice(i).map(l,-1),p=e.slice(i).map(d),g=e.invert().map(f,-1),m=e.invert().map(p);r.push({oldRange:{from:g,to:m},newRange:{from:f,to:p}})})}),O$(r)}function Iv(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(s=>{const i=n.resolve(t),o=Mv(i,s.type);o&&r.push({mark:s,...o})}):n.nodesBetween(t,e,(s,i)=>{!s||s?.nodeSize===void 0||r.push(...s.marks.map(o=>({from:i,to:i+s.nodeSize,mark:o})))}),r}var I$=(t,e,n,r=20)=>{const s=t.doc.resolve(n);let i=r,o=null;for(;i>0&&o===null;){const l=s.node(i);l?.type.name===e?o=l:i-=1}return[o,i]};function uy(t,e){return e.nodes[t]||e.marks[t]||null}function mh(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=t.find(i=>i.type===e&&i.name===r);return s?s.attribute.keepOnSplit:!1}))}var D$=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(s,i,o,l)=>{var d,f;const p=((f=(d=s.type.spec).toText)==null?void 0:f.call(d,{node:s,pos:i,parent:o,index:l}))||s.textContent||"%leaf%";n+=s.isAtom&&!s.isText?p:p.slice(0,Math.max(0,r-i))}),n};function Qx(t,e,n={}){const{empty:r,ranges:s}=t.selection,i=e?bi(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(g=>i?i.name===g.type.name:!0).find(g=>Jh(g.attrs,n,{strict:!1}));let o=0;const l=[];if(s.forEach(({$from:g,$to:m})=>{const y=g.pos,b=m.pos;t.doc.nodesBetween(y,b,(v,w)=>{if(!v.isText&&!v.marks.length)return;const S=Math.max(y,w),T=Math.min(b,w+v.nodeSize),j=T-S;o+=j,l.push(...v.marks.map(M=>({mark:M,from:S,to:T})))})}),o===0)return!1;const d=l.filter(g=>i?i.name===g.mark.type.name:!0).filter(g=>Jh(g.mark.attrs,n,{strict:!1})).reduce((g,m)=>g+m.to-m.from,0),f=l.filter(g=>i?g.mark.type!==i&&g.mark.type.excludes(i):!0).reduce((g,m)=>g+m.to-m.from,0);return(d>0?d+f:d)>=o}function L$(t,e,n={}){if(!e)return ma(t,null,n)||Qx(t,null,n);const r=og(e,t.schema);return r==="node"?ma(t,e,n):r==="mark"?Qx(t,e,n):!1}var z$=(t,e)=>{const{$from:n,$to:r,$anchor:s}=t.selection;if(e){const i=lg(l=>l.type.name===e)(t.selection);if(!i)return!1;const o=t.doc.resolve(i.pos+1);return s.pos+1===o.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)},P$=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function UN(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function $N(t,e){const{nodeExtensions:n}=Ql(e),r=n.find(o=>o.name===t);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},i=gt(Pe(r,"group",s));return typeof i!="string"?!1:i.split(" ").includes("list")}function cg(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!=null?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let s=!0;return t.content.forEach(i=>{s!==!1&&(cg(i,{ignoreWhitespace:n,checkChildren:e})||(s=!1))}),s}return!1}function vA(t){return t instanceof Be}function B$(t,e,n){var r;const{selection:s}=e;let i=null;if(oA(s)&&(i=s.$cursor),i){const l=(r=t.storedMarks)!=null?r:i.marks();return i.parent.type.allowsMarkType(n)&&(!!n.isInSet(l)||!l.some(f=>f.type.excludes(n)))}const{ranges:o}=s;return o.some(({$from:l,$to:d})=>{let f=l.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(l.pos,d.pos,(p,g,m)=>{if(f)return!1;if(p.isInline){const y=!m||m.type.allowsMarkType(n),b=!!n.isInSet(p.marks)||!p.marks.some(v=>v.type.excludes(n));f=y&&b}return!f}),f})}var F$=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const{selection:i}=n,{empty:o,ranges:l}=i,d=bi(t,r.schema);if(s)if(o){const f=dA(r,d);n.addStoredMark(d.create({...f,...e}))}else l.forEach(f=>{const p=f.$from.pos,g=f.$to.pos;r.doc.nodesBetween(p,g,(m,y)=>{const b=Math.max(y,p),v=Math.min(y+m.nodeSize,g);m.marks.find(S=>S.type===d)?m.marks.forEach(S=>{d===S.type&&n.addMark(b,v,d.create({...S.attrs,...e}))}):n.addMark(b,v,d.create(e))})});return B$(r,n,d)},U$=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),$$=(t,e={})=>({state:n,dispatch:r,chain:s})=>{const i=Jt(t,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),i.isTextblock?s().command(({commands:l})=>nN(i,{...o,...e})(n)?!0:l.clearNodes()).command(({state:l})=>nN(i,{...o,...e})(l,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},q$=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,s=qa(t,0,r.content.size),i=Be.create(r,s);e.setSelection(i)}return!0},H$=(t,e)=>({tr:n,state:r,dispatch:s})=>{const{selection:i}=r;let o,l;return typeof e=="number"?(o=e,l=e):e&&"from"in e&&"to"in e?(o=e.from,l=e.to):(o=i.from,l=i.to),s&&n.doc.nodesBetween(o,l,(d,f)=>{d.isText||n.setNodeMarkup(f,void 0,{...d.attrs,dir:t})}),!0},V$=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:s,to:i}=typeof t=="number"?{from:t,to:t}:t,o=qe.atStart(r).from,l=qe.atEnd(r).to,d=qa(s,o,l),f=qa(i,o,l),p=qe.create(r,d,f);e.setSelection(p)}return!0},K$=t=>({state:e,dispatch:n})=>{const r=Jt(t,e.schema);return qF(r)(e,n)};function qN(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(s=>e?.includes(s.type.name));t.tr.ensureMarks(r)}}var Q$=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:s})=>{const{selection:i,doc:o}=e,{$from:l,$to:d}=i,f=s.extensionManager.attributes,p=mh(f,l.node().type.name,l.node().attrs);if(i instanceof Be&&i.node.isBlock)return!l.parentOffset||!li(o,l.pos)?!1:(r&&(t&&qN(n,s.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const g=d.parentOffset===d.parent.content.size,m=l.depth===0?void 0:k$(l.node(-1).contentMatchAt(l.indexAfter(-1)));let y=g&&m?[{type:m,attrs:p}]:void 0,b=li(e.doc,e.mapping.map(l.pos),1,y);if(!y&&!b&&li(e.doc,e.mapping.map(l.pos),1,m?[{type:m}]:void 0)&&(b=!0,y=m?[{type:m,attrs:p}]:void 0),r){if(b&&(i instanceof qe&&e.deleteSelection(),e.split(e.mapping.map(l.pos),1,y),m&&!g&&!l.parentOffset&&l.parent.type!==m)){const v=e.mapping.map(l.before()),w=e.doc.resolve(v);l.node(-1).canReplaceWith(w.index(),w.index()+1,m)&&e.setNodeMarkup(e.mapping.map(l.before()),m)}t&&qN(n,s.extensionManager.splittableMarks),e.scrollIntoView()}return b},W$=(t,e={})=>({tr:n,state:r,dispatch:s,editor:i})=>{var o;const l=Jt(t,r.schema),{$from:d,$to:f}=r.selection,p=r.selection.node;if(p&&p.isBlock||d.depth<2||!d.sameParent(f))return!1;const g=d.node(-1);if(g.type!==l)return!1;const m=i.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==l||d.index(-2)!==d.node(-2).childCount-1)return!1;if(s){let S=Ne.empty;const T=d.index(-1)?1:d.index(-2)?2:3;for(let L=d.depth-T;L>=d.depth-3;L-=1)S=Ne.from(d.node(L).copy(S));const j=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,M={...mh(m,d.node().type.name,d.node().attrs),...e},_=((o=l.contentMatch.defaultType)==null?void 0:o.createAndFill(M))||void 0;S=S.append(Ne.from(l.createAndFill(null,_)||void 0));const R=d.before(d.depth-(T-1));n.replace(R,d.after(-j),new Ae(S,4-T,0));let O=-1;n.doc.nodesBetween(R,n.doc.content.size,(L,A)=>{if(O>-1)return!1;L.isTextblock&&L.content.size===0&&(O=A+1)}),O>-1&&n.setSelection(qe.near(n.doc.resolve(O))),n.scrollIntoView()}return!0}const y=f.pos===d.end()?g.contentMatchAt(0).defaultType:null,b={...mh(m,g.type.name,g.attrs),...e},v={...mh(m,d.node().type.name,d.node().attrs),...e};n.delete(d.pos,f.pos);const w=y?[{type:l,attrs:b},{type:y,attrs:v}]:[{type:l,attrs:b}];if(!li(n.doc,d.pos,2))return!1;if(s){const{selection:S,storedMarks:T}=r,{splittableMarks:j}=i.extensionManager,M=T||S.$to.parentOffset&&S.$from.marks();if(n.split(d.pos,2,w).scrollIntoView(),!M||!s)return!0;const _=M.filter(R=>j.includes(R.type.name));n.ensureMarks(_)}return!0},dy=(t,e)=>{const n=lg(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===s?.type&&xa(t.doc,n.pos)&&t.join(n.pos),!0},fy=(t,e)=>{const n=lg(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===s?.type&&xa(t.doc,r)&&t.join(r),!0},Y$=(t,e,n,r={})=>({editor:s,tr:i,state:o,dispatch:l,chain:d,commands:f,can:p})=>{const{extensions:g,splittableMarks:m}=s.extensionManager,y=Jt(t,o.schema),b=Jt(e,o.schema),{selection:v,storedMarks:w}=o,{$from:S,$to:T}=v,j=S.blockRange(T),M=w||v.$to.parentOffset&&v.$from.marks();if(!j)return!1;const _=lg(R=>$N(R.type.name,g))(v);if(j.depth>=1&&_&&j.depth-_.depth<=1){if(_.node.type===y)return f.liftListItem(b);if($N(_.node.type.name,g)&&y.validContent(_.node.content)&&l)return d().command(()=>(i.setNodeMarkup(_.pos,y),!0)).command(()=>dy(i,y)).command(()=>fy(i,y)).run()}return!n||!M||!l?d().command(()=>p().wrapInList(y,r)?!0:f.clearNodes()).wrapInList(y,r).command(()=>dy(i,y)).command(()=>fy(i,y)).run():d().command(()=>{const R=p().wrapInList(y,r),O=M.filter(L=>m.includes(L.type.name));return i.ensureMarks(O),R?!0:f.clearNodes()}).wrapInList(y,r).command(()=>dy(i,y)).command(()=>fy(i,y)).run()},G$=(t,e={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:i=!1}=n,o=bi(t,r.schema);return Qx(r,o,e)?s.unsetMark(o,{extendEmptyMarkRange:i}):s.setMark(o,e)},X$=(t,e,n={})=>({state:r,commands:s})=>{const i=Jt(t,r.schema),o=Jt(e,r.schema),l=ma(r,i,n);let d;return r.selection.$anchor.sameParent(r.selection.$head)&&(d=r.selection.$anchor.parent.attrs),l?s.setNode(o,d):s.setNode(i,{...d,...n})},J$=(t,e={})=>({state:n,commands:r})=>{const s=Jt(t,n.schema);return ma(n,s,e)?r.lift(s):r.wrapIn(s,e)},Z$=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let i;if(s.spec.isInputRules&&(i=s.getState(t))){if(e){const o=t.tr,l=i.transform;for(let d=l.steps.length-1;d>=0;d-=1)o.step(l.steps[d].invert(l.docs[d]));if(i.text){const d=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,t.schema.text(i.text,d))}else o.delete(i.from,i.to)}return!0}}return!1},eq=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:s}=n;return r||e&&s.forEach(i=>{t.removeMark(i.$from.pos,i.$to.pos)}),!0},tq=(t,e={})=>({tr:n,state:r,dispatch:s})=>{var i;const{extendEmptyMarkRange:o=!1}=e,{selection:l}=n,d=bi(t,r.schema),{$from:f,empty:p,ranges:g}=l;if(!s)return!0;if(p&&o){let{from:m,to:y}=l;const b=(i=f.marks().find(w=>w.type===d))==null?void 0:i.attrs,v=Mv(f,d,b);v&&(m=v.from,y=v.to),n.removeMark(m,y,d)}else g.forEach(m=>{n.removeMark(m.$from.pos,m.$to.pos,d)});return n.removeStoredMark(d),!0},nq=t=>({tr:e,state:n,dispatch:r})=>{const{selection:s}=n;let i,o;return typeof t=="number"?(i=t,o=t):t&&"from"in t&&"to"in t?(i=t.from,o=t.to):(i=s.from,o=s.to),r&&e.doc.nodesBetween(i,o,(l,d)=>{if(l.isText)return;const f={...l.attrs};delete f.dir,e.setNodeMarkup(d,void 0,f)}),!0},rq=(t,e={})=>({tr:n,state:r,dispatch:s})=>{let i=null,o=null;const l=og(typeof t=="string"?t:t.name,r.schema);if(!l)return!1;l==="node"&&(i=Jt(t,r.schema)),l==="mark"&&(o=bi(t,r.schema));let d=!1;return n.selection.ranges.forEach(f=>{const p=f.$from.pos,g=f.$to.pos;let m,y,b,v;n.selection.empty?r.doc.nodesBetween(p,g,(w,S)=>{i&&i===w.type&&(d=!0,b=Math.max(S,p),v=Math.min(S+w.nodeSize,g),m=S,y=w)}):r.doc.nodesBetween(p,g,(w,S)=>{S<p&&i&&i===w.type&&(d=!0,b=Math.max(S,p),v=Math.min(S+w.nodeSize,g),m=S,y=w),S>=p&&S<=g&&(i&&i===w.type&&(d=!0,s&&n.setNodeMarkup(S,void 0,{...w.attrs,...e})),o&&w.marks.length&&w.marks.forEach(T=>{if(o===T.type&&(d=!0,s)){const j=Math.max(S,p),M=Math.min(S+w.nodeSize,g);n.addMark(j,M,o.create({...T.attrs,...e}))}}))}),y&&(m!==void 0&&s&&n.setNodeMarkup(m,void 0,{...y.attrs,...e}),o&&y.marks.length&&y.marks.forEach(w=>{o===w.type&&s&&n.addMark(b,v,o.create({...w.attrs,...e}))}))}),d},sq=(t,e={})=>({state:n,dispatch:r})=>{const s=Jt(t,n.schema);return LF(s,e)(n,r)},iq=(t,e={})=>({state:n,dispatch:r})=>{const s=Jt(t,n.schema);return zF(s,e)(n,r)},aq=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(r=>r.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(r=>r!==e):delete this.callbacks[t]),this}once(t,e){const n=(...r)=>{this.off(t,n),e.apply(this,r)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},ug=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},oq=(t,e)=>{if(Ev(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function eh(t){var e;const{editor:n,from:r,to:s,text:i,rules:o,plugin:l}=t,{view:d}=n;if(d.composing)return!1;const f=d.state.doc.resolve(r);if(f.parent.type.spec.code||(e=f.nodeBefore||f.nodeAfter)!=null&&e.marks.find(m=>m.type.spec.code))return!1;let p=!1;const g=D$(f)+i;return o.forEach(m=>{if(p)return;const y=oq(g,m.find);if(!y)return;const b=d.state.tr,v=ig({state:d.state,transaction:b}),w={from:r-(y[0].length-i.length),to:s},{commands:S,chain:T,can:j}=new ag({editor:n,state:v});m.handler({state:v,range:w,match:y,commands:S,chain:T,can:j})===null||!b.steps.length||(m.undoable&&b.setMeta(l,{transform:b,from:r,to:s,text:i}),d.dispatch(b),p=!0)}),p}function lq(t){const{editor:e,rules:n}=t,r=new _t({state:{init(){return null},apply(s,i,o){const l=s.getMeta(r);if(l)return l;const d=s.getMeta("applyInputRules");return!!d&&setTimeout(()=>{let{text:p}=d;typeof p=="string"?p=p:p=_v(Ne.from(p),o.schema);const{from:g}=d,m=g+p.length;eh({editor:e,from:g,to:m,text:p,rules:n,plugin:r})}),s.selectionSet||s.docChanged?null:i}},props:{handleTextInput(s,i,o,l){return eh({editor:e,from:i,to:o,text:l,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:i}=s.state.selection;i&&eh({editor:e,from:i.pos,to:i.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,i){if(i.key!=="Enter")return!1;const{$cursor:o}=s.state.selection;return o?eh({editor:e,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function cq(t){return Object.prototype.toString.call(t).slice(8,-1)}function th(t){return cq(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function wA(t,e){const n={...t};return th(t)&&th(e)&&Object.keys(e).forEach(r=>{th(e[r])&&th(t[r])?n[r]=wA(t[r],e[r]):n[r]=e[r]}),n}var Dv=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...gt(Pe(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...gt(Pe(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>wA(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},Co=class SA extends Dv{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new SA(n)}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const o=s.marks();if(!!!o.find(f=>f?.type.name===n.name))return!1;const d=o.find(f=>f?.type.name===n.name);return d&&r.removeStoredMark(d),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function uq(t){return typeof t=="number"}var dq=class{constructor(t){this.find=t.find,this.handler=t.handler}},fq=(t,e,n)=>{if(Ev(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(s=>{const i=[s.text];return i.index=s.index,i.input=t,i.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(s.replaceWith)),i}):[]};function hq(t){const{editor:e,state:n,from:r,to:s,rule:i,pasteEvent:o,dropEvent:l}=t,{commands:d,chain:f,can:p}=new ag({editor:e,state:n}),g=[];return n.doc.nodesBetween(r,s,(y,b)=>{var v,w,S,T,j;if((w=(v=y.type)==null?void 0:v.spec)!=null&&w.code||!(y.isText||y.isTextblock||y.isInline))return;const M=(j=(T=(S=y.content)==null?void 0:S.size)!=null?T:y.nodeSize)!=null?j:0,_=Math.max(r,b),R=Math.min(s,b+M);if(_>=R)return;const O=y.isText?y.text||"":y.textBetween(_-b,R-b,void 0,"");fq(O,i.find,o).forEach(A=>{if(A.index===void 0)return;const F=_+A.index+1,H=F+A[0].length,P={from:n.tr.mapping.map(F),to:n.tr.mapping.map(H)},B=i.handler({state:n,range:P,match:A,commands:d,chain:f,can:p,pasteEvent:o,dropEvent:l});g.push(B)})}),g.every(y=>y!==null)}var nh=null,pq=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",t),n};function gq(t){const{editor:e,rules:n}=t;let r=null,s=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const d=({state:p,from:g,to:m,rule:y,pasteEvt:b})=>{const v=p.tr,w=ig({state:p,transaction:v});if(!(!hq({editor:e,state:w,from:Math.max(g-1,0),to:m.b-1,rule:y,pasteEvent:b,dropEvent:l})||!v.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,v}};return n.map(p=>new _t({view(g){const m=b=>{var v;r=(v=g.dom.parentElement)!=null&&v.contains(b.target)?g.dom.parentElement:null,r&&(nh=e)},y=()=>{nh&&(nh=null)};return window.addEventListener("dragstart",m),window.addEventListener("dragend",y),{destroy(){window.removeEventListener("dragstart",m),window.removeEventListener("dragend",y)}}},props:{handleDOMEvents:{drop:(g,m)=>{if(i=r===g.dom.parentElement,l=m,!i){const y=nh;y?.isEditable&&setTimeout(()=>{const b=y.state.selection;b&&y.commands.deleteRange({from:b.from,to:b.to})},10)}return!1},paste:(g,m)=>{var y;const b=(y=m.clipboardData)==null?void 0:y.getData("text/html");return o=m,s=!!b?.includes("data-pm-slice"),!1}}},appendTransaction:(g,m,y)=>{const b=g[0],v=b.getMeta("uiEvent")==="paste"&&!s,w=b.getMeta("uiEvent")==="drop"&&!i,S=b.getMeta("applyPasteRules"),T=!!S;if(!v&&!w&&!T)return;if(T){let{text:_}=S;typeof _=="string"?_=_:_=_v(Ne.from(_),y.schema);const{from:R}=S,O=R+_.length,L=pq(_);return d({rule:p,state:y,from:R,to:{b:O},pasteEvt:L})}const j=m.doc.content.findDiffStart(y.doc.content),M=m.doc.content.findDiffEnd(y.doc.content);if(!(!uq(j)||!M||j===M.b))return d({rule:p,state:y,from:j,to:M,pasteEvt:o})}}))}var dg=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=gA(t),this.schema=E$(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:uy(e.name,this.schema)},r=Pe(e,"addCommands",n);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this;return Ov([...this.extensions].reverse()).flatMap(r=>{const s={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:uy(r.name,this.schema)},i=[],o=Pe(r,"addKeyboardShortcuts",s);let l={};if(r.type==="mark"&&Pe(r,"exitable",s)&&(l.ArrowRight=()=>Co.handleExit({editor:t,mark:r})),o){const m=Object.fromEntries(Object.entries(o()).map(([y,b])=>[y,()=>b({editor:t})]));l={...l,...m}}const d=RU(l);i.push(d);const f=Pe(r,"addInputRules",s);if(UN(r,t.options.enableInputRules)&&f){const m=f();if(m&&m.length){const y=lq({editor:t,rules:m}),b=Array.isArray(y)?y:[y];i.push(...b)}}const p=Pe(r,"addPasteRules",s);if(UN(r,t.options.enablePasteRules)&&p){const m=p();if(m&&m.length){const y=gq({editor:t,rules:m});i.push(...y)}}const g=Pe(r,"addProseMirrorPlugins",s);if(g){const m=g();i.push(...m)}return i})}get attributes(){return pA(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=Ql(this.extensions);return Object.fromEntries(e.filter(n=>!!Pe(n,"addNodeView")).map(n=>{const r=this.attributes.filter(d=>d.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Jt(n.name,this.schema)},i=Pe(n,"addNodeView",s);if(!i)return[];const o=i();if(!o)return[];const l=(d,f,p,g,m)=>{const y=Zh(d,r);return o({node:d,view:f,getPos:p,decorations:g,innerDecorations:m,editor:t,extension:n,HTMLAttributes:y})};return[n.name,l]}))}get markViews(){const{editor:t}=this,{markExtensions:e}=Ql(this.extensions);return Object.fromEntries(e.filter(n=>!!Pe(n,"addMarkView")).map(n=>{const r=this.attributes.filter(l=>l.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:bi(n.name,this.schema)},i=Pe(n,"addMarkView",s);if(!i)return[];const o=(l,d,f)=>{const p=Zh(l,r);return i()({mark:l,view:d,inline:f,editor:t,extension:n,HTMLAttributes:p,updateAttributes:g=>{Mq(l,t,g)}})};return[n.name,o]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var n;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:uy(e.name,this.schema)};e.type==="mark"&&((n=gt(Pe(e,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(e.name);const s=Pe(e,"onBeforeCreate",r),i=Pe(e,"onCreate",r),o=Pe(e,"onUpdate",r),l=Pe(e,"onSelectionUpdate",r),d=Pe(e,"onTransaction",r),f=Pe(e,"onFocus",r),p=Pe(e,"onBlur",r),g=Pe(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),i&&this.editor.on("create",i),o&&this.editor.on("update",o),l&&this.editor.on("selectionUpdate",l),d&&this.editor.on("transaction",d),f&&this.editor.on("focus",f),p&&this.editor.on("blur",p),g&&this.editor.on("destroy",g)})}};dg.resolve=gA;dg.sort=Ov;dg.flatten=Rv;var mq={};jv(mq,{ClipboardTextSerializer:()=>CA,Commands:()=>NA,Delete:()=>TA,Drop:()=>jA,Editable:()=>EA,FocusEvents:()=>AA,Keymap:()=>RA,Paste:()=>_A,Tabindex:()=>OA,TextDirection:()=>IA,focusEventsPluginKey:()=>MA});var Pt=class kA extends Dv{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new kA(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},CA=Pt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new _t({key:new an("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:s}=e,{ranges:i}=s,o=Math.min(...i.map(p=>p.$from.pos)),l=Math.max(...i.map(p=>p.$to.pos)),d=yA(n);return mA(r,{from:o,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}}),NA=Pt.create({name:"commands",addCommands(){return{...iA}}}),TA=Pt.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,r,s;const i=()=>{var o,l,d,f;if((f=(d=(l=(o=this.editor.options.coreExtensionOptions)==null?void 0:o.delete)==null?void 0:l.filterTransaction)==null?void 0:d.call(l,t))!=null?f:t.getMeta("y-sync$"))return;const p=fA(t.before,[t,...e]);bA(p).forEach(y=>{p.mapping.mapResult(y.oldRange.from).deletedAfter&&p.mapping.mapResult(y.oldRange.to).deletedBefore&&p.before.nodesBetween(y.oldRange.from,y.oldRange.to,(b,v)=>{const w=v+b.nodeSize-2,S=y.oldRange.from<=v&&w<=y.oldRange.to;this.editor.emit("delete",{type:"node",node:b,from:v,to:w,newFrom:p.mapping.map(v),newTo:p.mapping.map(w),deletedRange:y.oldRange,newRange:y.newRange,partial:!S,editor:this.editor,transaction:t,combinedTransform:p})})});const m=p.mapping;p.steps.forEach((y,b)=>{var v,w;if(y instanceof ls){const S=m.slice(b).map(y.from,-1),T=m.slice(b).map(y.to),j=m.invert().map(S,-1),M=m.invert().map(T),_=(v=p.doc.nodeAt(S-1))==null?void 0:v.marks.some(O=>O.eq(y.mark)),R=(w=p.doc.nodeAt(T))==null?void 0:w.marks.some(O=>O.eq(y.mark));this.editor.emit("delete",{type:"mark",mark:y.mark,from:y.from,to:y.to,deletedRange:{from:j,to:M},newRange:{from:S,to:T},partial:!!(R||_),editor:this.editor,transaction:t,combinedTransform:p})}})};(s=(r=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:r.async)==null||s?setTimeout(i,0):i()}}),jA=Pt.create({name:"drop",addProseMirrorPlugins(){return[new _t({key:new an("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),EA=Pt.create({name:"editable",addProseMirrorPlugins(){return[new _t({key:new an("editable"),props:{editable:()=>this.editor.options.editable}})]}}),MA=new an("focusEvents"),AA=Pt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new _t({key:MA,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),RA=Pt.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:l})=>{const{selection:d,doc:f}=l,{empty:p,$anchor:g}=d,{pos:m,parent:y}=g,b=g.parent.isTextblock&&m>0?l.doc.resolve(m-1):g,v=b.parent.type.spec.isolating,w=g.pos-g.parentOffset,S=v&&b.parent.childCount===1?w===g.pos:Ge.atStart(f).from===m;return!p||!y.type.isTextblock||y.textContent.length||!S||S&&g.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Av()||uA()?i:s},addProseMirrorPlugins(){return[new _t({key:new an("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(v=>v.getMeta("composition")))return;const r=t.some(v=>v.docChanged)&&!e.doc.eq(n.doc),s=t.some(v=>v.getMeta("preventClearDocument"));if(!r||s)return;const{empty:i,from:o,to:l}=e.selection,d=Ge.atStart(e.doc).from,f=Ge.atEnd(e.doc).to;if(i||!(o===d&&l===f)||!cg(n.doc))return;const m=n.tr,y=ig({state:n,transaction:m}),{commands:b}=new ag({editor:this.editor,state:y});if(b.clearNodes(),!!m.steps.length)return m}})]}}),_A=Pt.create({name:"paste",addProseMirrorPlugins(){return[new _t({key:new an("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),OA=Pt.create({name:"tabindex",addProseMirrorPlugins(){return[new _t({key:new an("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),IA=Pt.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=Ql(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const n=e.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new _t({key:new an("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),yq=class _l{constructor(e,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new _l(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new _l(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new _l(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,i=n.isAtom&&!n.isText,o=this.pos+r+(i?0:1);if(o<0||o>this.resolvedPos.doc.nodeSize-2)return;const l=this.resolvedPos.doc.resolve(o);if(!s&&l.depth<=this.depth)return;const d=new _l(l,this.editor,s,s?n:null);s&&(d.actualDepth=this.depth+1),e.push(new _l(l,this.editor,s,s?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(n).length>0){const i=s.node.attrs,o=Object.keys(n);for(let l=0;l<o.length;l+=1){const d=o[l];if(i[d]!==n[d])break}}else r=s;s=s.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const i=Object.keys(n);return this.children.forEach(o=>{r&&s.length>0||(o.node.type.name===e&&i.every(d=>n[d]===o.node.attrs[d])&&s.push(o),!(r&&s.length>0)&&(s=s.concat(o.querySelectorAll(e,n,r))))}),s}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},xq=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function bq(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(s),s}var vq=class extends aq{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:s,moved:i})=>this.options.onDrop(r,s,i)),this.on("paste",({event:r,slice:s})=>this.options.onPaste(r,s)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=lA(e,this.options.autofocus);this.editorState=Il.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t?.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=bq(xq,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=hA(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(s=>{const i=typeof s=="string"?`${s}$`:s.key;n=n.filter(o=>!o.key.startsWith(i))}),e.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var t,e;const r=[...this.options.enableCoreExtensions?[EA,CA.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),NA,AA,RA,OA,jA,_A,TA,IA.configure({direction:this.options.textDirection})].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s?.type));this.extensionManager=new dg(r,this)}createCommandManager(){this.commandManager=new ag({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=Kx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(n=>n.name!=="collaboration"),this.createExtensionManager()}}),t=Kx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){var e;this.editorView=new rA(t,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)==null?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.prependClass(),this.injectCSS();const r=this.view.dom;r.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(f=>{var p;return(p=this.capturedTransaction)==null?void 0:p.step(f)});return}const{state:e,transactions:n}=this.state.applyTransaction(t),r=!this.state.selection.eq(e.selection),s=n.includes(t),i=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!s)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const o=n.findLast(f=>f.getMeta("focus")||f.getMeta("blur")),l=o?.getMeta("focus"),d=o?.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:o}),d&&this.emit("blur",{editor:this,event:d.event,transaction:o}),!(t.getMeta("preventUpdate")||!n.some(f=>f.docChanged)||i.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return xA(this.state,t)}isActive(t,e){const n=typeof t=="string"?t:null,r=typeof t=="string"?e:t;return L$(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return _v(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:n={}}=t||{};return A$(this.state.doc,{blockSeparator:e,textSerializers:{...yA(this.schema),...n}})}get isEmpty(){return cg(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new yq(e,this)}get $doc(){return this.$pos(0)}};function Wl(t){return new ug({find:t.find,handler:({state:e,range:n,match:r})=>{const s=gt(t.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:i}=e,o=r[r.length-1],l=r[0];if(o){const d=l.search(/\S/),f=n.from+l.indexOf(o),p=f+o.length;if(Iv(n.from,n.to,e.doc).filter(y=>y.mark.type.excluded.find(v=>v===t.type&&v!==y.mark.type)).filter(y=>y.to>f).length)return null;p<n.to&&i.delete(p,n.to),f>n.from&&i.delete(n.from+d,f);const m=n.from+d+o.length;i.addMark(n.from+d,m,t.type.create(s||{})),i.removeStoredMark(t.type)}},undoable:t.undoable})}function wq(t){return new ug({find:t.find,handler:({state:e,range:n,match:r})=>{const s=gt(t.getAttributes,void 0,r)||{},{tr:i}=e,o=n.from;let l=n.to;const d=t.type.create(s);if(r[1]){const f=r[0].lastIndexOf(r[1]);let p=o+f;p>l?p=l:l=p+r[1].length;const g=r[0][r[0].length-1];i.insertText(g,o+r[0].length-1),i.replaceWith(p,l,d)}else if(r[0]){const f=t.type.isInline?o:o-1;i.insert(f,t.type.create(s)).delete(i.mapping.map(o),i.mapping.map(l))}i.scrollIntoView()},undoable:t.undoable})}function Wx(t){return new ug({find:t.find,handler:({state:e,range:n,match:r})=>{const s=e.doc.resolve(n.from),i=gt(t.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,i)},undoable:t.undoable})}function Yl(t){return new ug({find:t.find,handler:({state:e,range:n,match:r,chain:s})=>{const i=gt(t.getAttributes,void 0,r)||{},o=e.tr.delete(n.from,n.to),d=o.doc.resolve(n.from).blockRange(),f=d&&dv(d,t.type,i);if(!f)return null;if(o.wrap(d,f),t.keepMarks&&t.editor){const{selection:g,storedMarks:m}=e,{splittableMarks:y}=t.editor.extensionManager,b=m||g.$to.parentOffset&&g.$from.marks();if(b){const v=b.filter(w=>y.includes(w.type.name));o.ensureMarks(v)}}if(t.keepAttributes){const g=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(g,i).run()}const p=o.doc.resolve(n.from-1).nodeBefore;p&&p.type===t.type&&xa(o.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,p))&&o.join(n.from-1)},undoable:t.undoable})}function Sq(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof Be){const i=r.index();return r.parent.canReplaceWith(i,i+1,e)}let s=r.depth;for(;s>=0;){const i=r.index(s);if(r.node(s).contentMatchAt(i).matchType(e))return!0;s-=1}return!1}var kq={};jv(kq,{createAtomBlockMarkdownSpec:()=>Cq,createBlockMarkdownSpec:()=>Nq,createInlineMarkdownSpec:()=>Eq,parseAttributes:()=>Lv,parseIndentedBlocks:()=>Yx,renderNestedMarkdownContent:()=>Pv,serializeAttributes:()=>zv});function Lv(t){if(!t?.trim())return{};const e={},n=[],r=t.replace(/["']([^"']*)["']/g,f=>(n.push(f),`__QUOTED_${n.length-1}__`)),s=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(s){const f=s.map(p=>p.trim().slice(1));e.class=f.join(" ")}const i=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);i&&(e.id=i[1]);const o=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(o)).forEach(([,f,p])=>{var g;const m=parseInt(((g=p.match(/__QUOTED_(\d+)__/))==null?void 0:g[1])||"0",10),y=n[m];y&&(e[f]=y.slice(1,-1))});const d=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return d&&d.split(/\s+/).filter(Boolean).forEach(p=>{p.match(/^[a-zA-Z][\w-]*$/)&&(e[p]=!0)}),e}function zv(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([n,r])=>{n==="class"||n==="id"||(r===!0?e.push(n):r!==!1&&r!=null&&e.push(`${n}="${String(r)}"`))}),e.join(" ")}function Cq(t){const{nodeName:e,name:n,parseAttributes:r=Lv,serializeAttributes:s=zv,defaultAttributes:i={},requiredAttributes:o=[],allowedAttributes:l}=t,d=n||e,f=p=>{if(!l)return p;const g={};return l.forEach(m=>{m in p&&(g[m]=p[m])}),g};return{parseMarkdown:(p,g)=>{const m={...i,...p.attributes};return g.createNode(e,m,[])},markdownTokenizer:{name:e,level:"block",start(p){var g;const m=new RegExp(`^:::${d}(?:\\s|$)`,"m"),y=(g=p.match(m))==null?void 0:g.index;return y!==void 0?y:-1},tokenize(p,g,m){const y=new RegExp(`^:::${d}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),b=p.match(y);if(!b)return;const v=b[1]||"",w=r(v);if(!o.find(T=>!(T in w)))return{type:e,raw:b[0],attributes:w}}},renderMarkdown:p=>{const g=f(p.attrs||{}),m=s(g),y=m?` {${m}}`:"";return`:::${d}${y} :::`}}}function Nq(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=Lv,serializeAttributes:i=zv,defaultAttributes:o={},content:l="block",allowedAttributes:d}=t,f=n||e,p=g=>{if(!d)return g;const m={};return d.forEach(y=>{y in g&&(m[y]=g[y])}),m};return{parseMarkdown:(g,m)=>{let y;if(r){const v=r(g);y=typeof v=="string"?[{type:"text",text:v}]:v}else l==="block"?y=m.parseChildren(g.tokens||[]):y=m.parseInline(g.tokens||[]);const b={...o,...g.attributes};return m.createNode(e,b,y)},markdownTokenizer:{name:e,level:"block",start(g){var m;const y=new RegExp(`^:::${f}`,"m"),b=(m=g.match(y))==null?void 0:m.index;return b!==void 0?b:-1},tokenize(g,m,y){var b;const v=new RegExp(`^:::${f}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),w=g.match(v);if(!w)return;const[S,T=""]=w,j=s(T);let M=1;const _=S.length;let R="";const O=/^:::([\w-]*)(\s.*)?/gm,L=g.slice(_);for(O.lastIndex=0;;){const A=O.exec(L);if(A===null)break;const F=A.index,H=A[1];if(!((b=A[2])!=null&&b.endsWith(":::"))){if(H)M+=1;else if(M-=1,M===0){const P=L.slice(0,F);R=P.trim();const B=g.slice(0,_+F+A[0].length);let E=[];if(R)if(l==="block")for(E=y.blockTokens(P),E.forEach(K=>{K.text&&(!K.tokens||K.tokens.length===0)&&(K.tokens=y.inlineTokens(K.text))});E.length>0;){const K=E[E.length-1];if(K.type==="paragraph"&&(!K.text||K.text.trim()===""))E.pop();else break}else E=y.inlineTokens(R);return{type:e,raw:B,attributes:j,content:R,tokens:E}}}}}},renderMarkdown:(g,m)=>{const y=p(g.attrs||{}),b=i(y),v=b?` {${b}}`:"",w=m.renderChildren(g.content||[],`

`);return`:::${f}${v}

${w}

:::`}}}function Tq(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(t);for(;r!==null;){const[,s,i,o]=r;e[s]=i||o,r=n.exec(t)}return e}function jq(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function Eq(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=Tq,serializeAttributes:i=jq,defaultAttributes:o={},selfClosing:l=!1,allowedAttributes:d}=t,f=n||e,p=m=>{if(!d)return m;const y={};return d.forEach(b=>{b in m&&(y[b]=m[b])}),y},g=f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(m,y)=>{const b={...o,...m.attributes};if(l)return y.createNode(e,b);const v=r?r(m):m.content||"";return v?y.createNode(e,b,[y.createTextNode(v)]):y.createNode(e,b,[])},markdownTokenizer:{name:e,level:"inline",start(m){const y=l?new RegExp(`\\[${g}\\s*[^\\]]*\\]`):new RegExp(`\\[${g}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${g}\\]`),b=m.match(y),v=b?.index;return v!==void 0?v:-1},tokenize(m,y,b){const v=l?new RegExp(`^\\[${g}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${g}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${g}\\]`),w=m.match(v);if(!w)return;let S="",T="";if(l){const[,M]=w;T=M}else{const[,M,_]=w;T=M,S=_||""}const j=s(T.trim());return{type:e,raw:w[0],content:S.trim(),attributes:j}}},renderMarkdown:m=>{let y="";r?y=r(m):m.content&&m.content.length>0&&(y=m.content.filter(S=>S.type==="text").map(S=>S.text).join(""));const b=p(m.attrs||{}),v=i(b),w=v?` ${v}`:"";return l?`[${f}${w}]`:`[${f}${w}]${y}[/${f}]`}}}function Yx(t,e,n){var r,s,i,o;const l=t.split(`
`),d=[];let f="",p=0;const g=e.baseIndentSize||2;for(;p<l.length;){const m=l[p],y=m.match(e.itemPattern);if(!y){if(d.length>0)break;if(m.trim()===""){p+=1,f=`${f}${m}
`;continue}else return}const b=e.extractItemData(y),{indentLevel:v,mainContent:w}=b;f=`${f}${m}
`;const S=[w];for(p+=1;p<l.length;){const _=l[p];if(_.trim()===""){const O=l.slice(p+1).findIndex(F=>F.trim()!=="");if(O===-1)break;if((((s=(r=l[p+1+O].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:s.length)||0)>v){S.push(_),f=`${f}${_}
`,p+=1;continue}else break}if((((o=(i=_.match(/^(\s*)/))==null?void 0:i[1])==null?void 0:o.length)||0)>v)S.push(_),f=`${f}${_}
`,p+=1;else break}let T;const j=S.slice(1);if(j.length>0){const _=j.map(R=>R.slice(v+g)).join(`
`);_.trim()&&(e.customNestedParser?T=e.customNestedParser(_):T=n.blockTokens(_))}const M=e.createToken(b,T);d.push(M)}if(d.length!==0)return{items:d,raw:f}}function Pv(t,e,n,r){if(!t||!Array.isArray(t.content))return"";const s=typeof n=="function"?n(r):n,[i,...o]=t.content,l=e.renderChildren([i]),d=[`${s}${l}`];return o&&o.length>0&&o.forEach(f=>{const p=e.renderChildren([f]);if(p){const g=p.split(`
`).map(m=>m?e.indent(m):"").join(`
`);d.push(g)}}),d.join(`
`)}function Mq(t,e,n={}){const{state:r}=e,{doc:s,tr:i}=r,o=t;s.descendants((l,d)=>{const f=i.mapping.map(d),p=i.mapping.map(d)+l.nodeSize;let g=null;if(l.marks.forEach(y=>{if(y!==o)return!1;g=y}),!g)return;let m=!1;if(Object.keys(n).forEach(y=>{n[y]!==g.attrs[y]&&(m=!0)}),m){const y=t.type.create({...t.attrs,...n});i.removeMark(f,p,t.type),i.addMark(f,p,y)}}),i.docChanged&&e.view.dispatch(i)}var Cr=class DA extends Dv{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new DA(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function uo(t){return new dq({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:s})=>{const i=gt(t.getAttributes,void 0,r,s);if(i===!1||i===null)return null;const{tr:o}=e,l=r[r.length-1],d=r[0];let f=n.to;if(l){const p=d.search(/\S/),g=n.from+d.indexOf(l),m=g+l.length;if(Iv(n.from,n.to,e.doc).filter(b=>b.mark.type.excluded.find(w=>w===t.type&&w!==b.mark.type)).filter(b=>b.to>g).length)return null;m<n.to&&o.delete(m,n.to),g>n.from&&o.delete(n.from+p,g),f=n.from+p+l.length,o.addMark(n.from+p,f,t.type.create(i||{})),o.removeStoredMark(t.type)}}})}var Aq=Pt.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const e=t.style.textAlign;return this.options.alignments.includes(e)?e:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>({commands:e})=>this.options.alignments.includes(t)?this.options.types.map(n=>e.updateAttributes(n,{textAlign:t})).some(n=>n):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(e=>t.resetAttributes(e,"textAlign")).some(e=>e),toggleTextAlign:t=>({editor:e,commands:n})=>this.options.alignments.includes(t)?e.isActive({textAlign:t})?n.unsetTextAlign():n.setTextAlign(t):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),Bv=Aq,hy,HN;function Rq(){return HN||(HN=1,hy=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,s,i;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(s=r;s--!==0;)if(!t(e[s],n[s]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(s of e.entries())if(!n.has(s[0]))return!1;for(s of e.entries())if(!t(s[1],n.get(s[0])))return!1;return!0}if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(s of e.entries())if(!n.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(r=e.length,r!=n.length)return!1;for(s=r;s--!==0;)if(e[s]!==n[s])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(i=Object.keys(e),r=i.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[s]))return!1;for(s=r;s--!==0;){var o=i[s];if(!(o==="_owner"&&e.$$typeof)&&!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}),hy}var _q=Rq();const Oq=Gl(_q);var Iq=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},Dq=({contentComponent:t})=>{const e=Rb.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return u.jsx(u.Fragment,{children:Object.values(e)})};function Lq(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:RO.createPortal(r.reactElement,r.element,n)},t.forEach(s=>s())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(s=>s())}}}var zq=class extends St.Component{constructor(t){var e;super(t),this.editorContentRef=St.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const t=this.props.editor;if(t&&!t.isDestroyed&&t.options.element){if(t.contentComponent)return;const e=this.editorContentRef.current;e.append(t.view.dom),t.setOptions({element:e}),t.contentComponent=Lq(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(n=>n.hasContentComponentInitialized?n:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.firstChild))return;const n=document.createElement("div");n.append(e.view.dom),e.setOptions({element:n})}catch{}}}render(){const{editor:t,innerRef:e,...n}=this.props;return u.jsxs(u.Fragment,{children:[u.jsx("div",{ref:Iq(e,this.editorContentRef),...n}),t?.contentComponent&&u.jsx(Dq,{contentComponent:t.contentComponent})]})}},Pq=C.forwardRef((t,e)=>{const n=St.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return St.createElement(zq,{key:n,innerRef:e,...t})}),Fv=St.memo(Pq),Bq=typeof window<"u"?C.useLayoutEffect:C.useEffect,Fq=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},n=this.editor;return n.on("transaction",e),()=>{n.off("transaction",e)}}}};function Uq(t){var e;const[n]=C.useState(()=>new Fq(t.editor)),r=yj.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:Oq);return Bq(()=>n.watch(t.editor),[t.editor,n]),C.useDebugValue(r),r}var $q=!1,Gx=typeof window>"u",qq=Gx||!!(typeof window<"u"&&window.next),Hq=class LA{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Gx||qq?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onBeforeCreate)==null?void 0:i.call(s,...r)},onBlur:(...r)=>{var s,i;return(i=(s=this.options.current).onBlur)==null?void 0:i.call(s,...r)},onCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onCreate)==null?void 0:i.call(s,...r)},onDestroy:(...r)=>{var s,i;return(i=(s=this.options.current).onDestroy)==null?void 0:i.call(s,...r)},onFocus:(...r)=>{var s,i;return(i=(s=this.options.current).onFocus)==null?void 0:i.call(s,...r)},onSelectionUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onSelectionUpdate)==null?void 0:i.call(s,...r)},onTransaction:(...r)=>{var s,i;return(i=(s=this.options.current).onTransaction)==null?void 0:i.call(s,...r)},onUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onUpdate)==null?void 0:i.call(s,...r)},onContentError:(...r)=>{var s,i;return(i=(s=this.options.current).onContentError)==null?void 0:i.call(s,...r)},onDrop:(...r)=>{var s,i;return(i=(s=this.options.current).onDrop)==null?void 0:i.call(s,...r)},onPaste:(...r)=>{var s,i;return(i=(s=this.options.current).onPaste)==null?void 0:i.call(s,...r)},onDelete:(...r)=>{var s,i;return(i=(s=this.options.current).onDelete)==null?void 0:i.call(s,...r)}};return new vq(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((s,i)=>{var o;return s===((o=n.extensions)==null?void 0:o[i])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?LA.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,s)=>r===e[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function Uv(t={},e=[]){const n=C.useRef(t);n.current=t;const[r]=C.useState(()=>new Hq(n)),s=Rb.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return C.useDebugValue(s),C.useEffect(r.onRender(e)),Uq({editor:s,selector:({transactionNumber:i})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&i===0?0:i+1}),s}var Vq=C.createContext({editor:null});Vq.Consumer;var Kq=C.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),Qq=()=>C.useContext(Kq);St.forwardRef((t,e)=>{const{onDragStart:n}=Qq(),r=t.as||"div";return u.jsx(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});St.createContext({markViewContentRef:()=>{}});var ep=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:n,...r}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,r,n]},Wq=/^\s*>\s$/,Yq=Cr.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return ep("blockquote",{...Zt(this.options.HTMLAttributes,t),children:ep("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=">",r=[];return t.content.forEach(s=>{const l=e.renderChildren([s]).split(`
`).map(d=>d.trim()===""?n:`${n} ${d}`);r.push(l.join(`
`))}),r.join(`
${n}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Yl({find:Wq,type:this.type})]}}),Gq=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Xq=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Jq=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Zq=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,eH=Co.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return ep("strong",{...Zt(this.options.HTMLAttributes,t),children:ep("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Wl({find:Gq,type:this.type}),Wl({find:Jq,type:this.type})]},addPasteRules(){return[uo({find:Xq,type:this.type}),uo({find:Zq,type:this.type})]}}),tH=/(^|[^`])`([^`]+)`(?!`)$/,nH=/(^|[^`])`([^`]+)`(?!`)/g,rH=Co.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Zt(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Wl({find:tH,type:this.type})]},addPasteRules(){return[uo({find:nH,type:this.type})]}}),py=4,sH=/^```([a-z]+)?[\s\n]$/,iH=/^~~~([a-z]+)?[\s\n]$/,aH=Cr.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:py,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const i=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",Zt(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return((n=t.raw)==null?void 0:n.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let r="";const s=((n=t.attrs)==null?void 0:n.language)||"";return t.content?r=[`\`\`\`${s}`,e.renderChildren(t.content),"```"].join(`
`):r=`\`\`\`${s}

\`\`\``,r},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:py,{state:r}=t,{selection:s}=r,{$from:i,empty:o}=s;if(i.parent.type!==this.type)return!1;const l=" ".repeat(n);return o?t.commands.insertContent(l):t.commands.command(({tr:d})=>{const{from:f,to:p}=s,y=r.doc.textBetween(f,p,`
`,`
`).split(`
`).map(b=>l+b).join(`
`);return d.replaceWith(f,p,r.schema.text(y)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:py,{state:r}=t,{selection:s}=r,{$from:i,empty:o}=s;return i.parent.type!==this.type?!1:o?t.commands.command(({tr:l})=>{var d;const{pos:f}=i,p=i.start(),g=i.end(),y=r.doc.textBetween(p,g,`
`,`
`).split(`
`);let b=0,v=0;const w=f-p;for(let R=0;R<y.length;R+=1){if(v+y[R].length>=w){b=R;break}v+=y[R].length+1}const T=((d=y[b].match(/^ */))==null?void 0:d[0])||"",j=Math.min(T.length,n);if(j===0)return!0;let M=p;for(let R=0;R<b;R+=1)M+=y[R].length+1;return l.delete(M,M+j),f-M<=j&&l.setSelection(qe.create(l.doc,M)),!0}):t.commands.command(({tr:l})=>{const{from:d,to:f}=s,m=r.doc.textBetween(d,f,`
`,`
`).split(`
`).map(y=>{var b;const v=((b=y.match(/^ */))==null?void 0:b[0])||"",w=Math.min(v.length,n);return y.slice(w)}).join(`
`);return l.replaceWith(d,f,r.schema.text(m)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!i||!o?!1:t.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:s,empty:i}=n;if(!i||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const l=s.after();return l===void 0?!1:r.nodeAt(l)?t.commands.command(({tr:f})=>(f.setSelection(Ge.near(r.resolve(l))),!0)):t.commands.exitCode()}}},addInputRules(){return[Wx({find:sH,type:this.type,getAttributes:t=>({language:t[1]})}),Wx({find:iH,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new _t({key:new an("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=s?.mode;if(!n||!i)return!1;const{tr:o,schema:l}=t.state,d=l.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:i},d)),o.selection.$from.parent.type!==this.type&&o.setSelection(qe.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),oH=Cr.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),lH=Cr.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Zt(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:s,storedMarks:i}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:l}=r.extensionManager,d=i||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:f,dispatch:p})=>{if(p&&d&&o){const g=d.filter(m=>l.includes(m.type.name));f.ensureMarks(g)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),cH=Cr.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Zt(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var n;const r=(n=t.attrs)!=null&&n.level?parseInt(t.attrs.level,10):1,s="#".repeat(r);return t.content?`${s} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>Wx({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),uH=Cr.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Zt(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!Sq(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:r}=n,s=t();return vA(n)?s.insertContentAt(r.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({state:i,tr:o,dispatch:l})=>{if(l){const{$to:d}=o.selection,f=d.end();if(d.nodeAfter)d.nodeAfter.isTextblock?o.setSelection(qe.create(o.doc,d.pos+1)):d.nodeAfter.isBlock?o.setSelection(Be.create(o.doc,d.pos)):o.setSelection(qe.create(o.doc,d.pos));else{const p=i.schema.nodes[this.options.nextNodeType]||d.parent.type.contentMatch.defaultType,g=p?.create();g&&(o.insert(f,g),o.setSelection(qe.create(o.doc,f+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[wq({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),dH=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,fH=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,hH=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,pH=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,gH=Co.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Zt(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Wl({find:dH,type:this.type}),Wl({find:hH,type:this.type})]},addPasteRules(){return[uo({find:fH,type:this.type}),uo({find:pH,type:this.type})]}});const mH="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",yH="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",Xx="numeric",Jx="ascii",Zx="alpha",Eu="asciinumeric",du="alphanumeric",eb="domain",zA="emoji",xH="scheme",bH="slashscheme",gy="whitespace";function vH(t,e){return t in e||(e[t]=[]),e[t]}function Ha(t,e,n){e[Xx]&&(e[Eu]=!0,e[du]=!0),e[Jx]&&(e[Eu]=!0,e[Zx]=!0),e[Eu]&&(e[du]=!0),e[Zx]&&(e[du]=!0),e[du]&&(e[eb]=!0),e[zA]&&(e[eb]=!0);for(const r in e){const s=vH(r,n);s.indexOf(t)<0&&s.push(t)}}function wH(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}function sr(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}sr.groups={};sr.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let r=0;r<e.jr.length;r++){const s=e.jr[r][0],i=e.jr[r][1];if(i&&s.test(t))return i}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let s=0;s<t.length;s++)this.tt(t[s],e,n,r)},tr(t,e,n,r){r=r||sr.groups;let s;return e&&e.j?s=e:(s=new sr(e),n&&r&&Ha(e,n,r)),this.jr.push([t,s]),s},ts(t,e,n,r){let s=this;const i=t.length;if(!i)return s;for(let o=0;o<i-1;o++)s=s.tt(t[o]);return s.tt(t[i-1],e,n,r)},tt(t,e,n,r){r=r||sr.groups;const s=this;if(e&&e.j)return s.j[t]=e,e;const i=e;let o,l=s.go(t);if(l?(o=new sr,Object.assign(o.j,l.j),o.jr.push.apply(o.jr,l.jr),o.jd=l.jd,o.t=l.t):o=new sr,i){if(r)if(o.t&&typeof o.t=="string"){const d=Object.assign(wH(o.t,r),n);Ha(i,d,r)}else n&&Ha(i,n,r);o.t=i}return s.j[t]=o,o}};const Ye=(t,e,n,r,s)=>t.ta(e,n,r,s),Dt=(t,e,n,r,s)=>t.tr(e,n,r,s),VN=(t,e,n,r,s)=>t.ts(e,n,r,s),Ee=(t,e,n,r,s)=>t.tt(e,n,r,s),ri="WORD",tb="UWORD",PA="ASCIINUMERICAL",BA="ALPHANUMERICAL",Ju="LOCALHOST",nb="TLD",rb="UTLD",yh="SCHEME",Ol="SLASH_SCHEME",$v="NUM",sb="WS",qv="NL",Mu="OPENBRACE",Au="CLOSEBRACE",tp="OPENBRACKET",np="CLOSEBRACKET",rp="OPENPAREN",sp="CLOSEPAREN",ip="OPENANGLEBRACKET",ap="CLOSEANGLEBRACKET",op="FULLWIDTHLEFTPAREN",lp="FULLWIDTHRIGHTPAREN",cp="LEFTCORNERBRACKET",up="RIGHTCORNERBRACKET",dp="LEFTWHITECORNERBRACKET",fp="RIGHTWHITECORNERBRACKET",hp="FULLWIDTHLESSTHAN",pp="FULLWIDTHGREATERTHAN",gp="AMPERSAND",mp="APOSTROPHE",yp="ASTERISK",Gi="AT",xp="BACKSLASH",bp="BACKTICK",vp="CARET",Zi="COLON",Hv="COMMA",wp="DOLLAR",bs="DOT",Sp="EQUALS",Vv="EXCLAMATION",Vr="HYPHEN",Ru="PERCENT",kp="PIPE",Cp="PLUS",Np="POUND",_u="QUERY",Kv="QUOTE",FA="FULLWIDTHMIDDLEDOT",Qv="SEMI",vs="SLASH",Ou="TILDE",Tp="UNDERSCORE",UA="EMOJI",jp="SYM";var $A=Object.freeze({__proto__:null,ALPHANUMERICAL:BA,AMPERSAND:gp,APOSTROPHE:mp,ASCIINUMERICAL:PA,ASTERISK:yp,AT:Gi,BACKSLASH:xp,BACKTICK:bp,CARET:vp,CLOSEANGLEBRACKET:ap,CLOSEBRACE:Au,CLOSEBRACKET:np,CLOSEPAREN:sp,COLON:Zi,COMMA:Hv,DOLLAR:wp,DOT:bs,EMOJI:UA,EQUALS:Sp,EXCLAMATION:Vv,FULLWIDTHGREATERTHAN:pp,FULLWIDTHLEFTPAREN:op,FULLWIDTHLESSTHAN:hp,FULLWIDTHMIDDLEDOT:FA,FULLWIDTHRIGHTPAREN:lp,HYPHEN:Vr,LEFTCORNERBRACKET:cp,LEFTWHITECORNERBRACKET:dp,LOCALHOST:Ju,NL:qv,NUM:$v,OPENANGLEBRACKET:ip,OPENBRACE:Mu,OPENBRACKET:tp,OPENPAREN:rp,PERCENT:Ru,PIPE:kp,PLUS:Cp,POUND:Np,QUERY:_u,QUOTE:Kv,RIGHTCORNERBRACKET:up,RIGHTWHITECORNERBRACKET:fp,SCHEME:yh,SEMI:Qv,SLASH:vs,SLASH_SCHEME:Ol,SYM:jp,TILDE:Ou,TLD:nb,UNDERSCORE:Tp,UTLD:rb,UWORD:tb,WORD:ri,WS:sb});const ti=/[a-z]/,iu=new RegExp("\\p{L}","u"),my=new RegExp("\\p{Emoji}","u"),ni=/\d/,yy=/\s/,KN="\r",xy=`
`,SH="",kH="",by="";let rh=null,sh=null;function CH(t=[]){const e={};sr.groups=e;const n=new sr;rh==null&&(rh=QN(mH)),sh==null&&(sh=QN(yH)),Ee(n,"'",mp),Ee(n,"{",Mu),Ee(n,"}",Au),Ee(n,"[",tp),Ee(n,"]",np),Ee(n,"(",rp),Ee(n,")",sp),Ee(n,"<",ip),Ee(n,">",ap),Ee(n,"",op),Ee(n,"",lp),Ee(n,"",cp),Ee(n,"",up),Ee(n,"",dp),Ee(n,"",fp),Ee(n,"",hp),Ee(n,"",pp),Ee(n,"&",gp),Ee(n,"*",yp),Ee(n,"@",Gi),Ee(n,"`",bp),Ee(n,"^",vp),Ee(n,":",Zi),Ee(n,",",Hv),Ee(n,"$",wp),Ee(n,".",bs),Ee(n,"=",Sp),Ee(n,"!",Vv),Ee(n,"-",Vr),Ee(n,"%",Ru),Ee(n,"|",kp),Ee(n,"+",Cp),Ee(n,"#",Np),Ee(n,"?",_u),Ee(n,'"',Kv),Ee(n,"/",vs),Ee(n,";",Qv),Ee(n,"~",Ou),Ee(n,"_",Tp),Ee(n,"\\",xp),Ee(n,"",FA);const r=Dt(n,ni,$v,{[Xx]:!0});Dt(r,ni,r);const s=Dt(r,ti,PA,{[Eu]:!0}),i=Dt(r,iu,BA,{[du]:!0}),o=Dt(n,ti,ri,{[Jx]:!0});Dt(o,ni,s),Dt(o,ti,o),Dt(s,ni,s),Dt(s,ti,s);const l=Dt(n,iu,tb,{[Zx]:!0});Dt(l,ti),Dt(l,ni,i),Dt(l,iu,l),Dt(i,ni,i),Dt(i,ti),Dt(i,iu,i);const d=Ee(n,xy,qv,{[gy]:!0}),f=Ee(n,KN,sb,{[gy]:!0}),p=Dt(n,yy,sb,{[gy]:!0});Ee(n,by,p),Ee(f,xy,d),Ee(f,by,p),Dt(f,yy,p),Ee(p,KN),Ee(p,xy),Dt(p,yy,p),Ee(p,by,p);const g=Dt(n,my,UA,{[zA]:!0});Ee(g,"#"),Dt(g,my,g),Ee(g,SH,g);const m=Ee(g,kH);Ee(m,"#"),Dt(m,my,g);const y=[[ti,o],[ni,s]],b=[[ti,null],[iu,l],[ni,i]];for(let v=0;v<rh.length;v++)Vi(n,rh[v],nb,ri,y);for(let v=0;v<sh.length;v++)Vi(n,sh[v],rb,tb,b);Ha(nb,{tld:!0,ascii:!0},e),Ha(rb,{utld:!0,alpha:!0},e),Vi(n,"file",yh,ri,y),Vi(n,"mailto",yh,ri,y),Vi(n,"http",Ol,ri,y),Vi(n,"https",Ol,ri,y),Vi(n,"ftp",Ol,ri,y),Vi(n,"ftps",Ol,ri,y),Ha(yh,{scheme:!0,ascii:!0},e),Ha(Ol,{slashscheme:!0,ascii:!0},e),t=t.sort((v,w)=>v[0]>w[0]?1:-1);for(let v=0;v<t.length;v++){const w=t[v][0],T=t[v][1]?{[xH]:!0}:{[bH]:!0};w.indexOf("-")>=0?T[eb]=!0:ti.test(w)?ni.test(w)?T[Eu]=!0:T[Jx]=!0:T[Xx]=!0,VN(n,w,w,T)}return VN(n,"localhost",Ju,{ascii:!0}),n.jd=new sr(jp),{start:n,tokens:Object.assign({groups:e},$A)}}function qA(t,e){const n=NH(e.replace(/[A-Z]/g,l=>l.toLowerCase())),r=n.length,s=[];let i=0,o=0;for(;o<r;){let l=t,d=null,f=0,p=null,g=-1,m=-1;for(;o<r&&(d=l.go(n[o]));)l=d,l.accepts()?(g=0,m=0,p=l):g>=0&&(g+=n[o].length,m++),f+=n[o].length,i+=n[o].length,o++;i-=g,o-=m,f-=g,s.push({t:p.t,v:e.slice(i-f,i),s:i-f,e:i})}return s}function NH(t){const e=[],n=t.length;let r=0;for(;r<n;){let s=t.charCodeAt(r),i,o=s<55296||s>56319||r+1===n||(i=t.charCodeAt(r+1))<56320||i>57343?t[r]:t.slice(r,r+2);e.push(o),r+=o.length}return e}function Vi(t,e,n,r,s){let i;const o=e.length;for(let l=0;l<o-1;l++){const d=e[l];t.j[d]?i=t.j[d]:(i=new sr(r),i.jr=s.slice(),t.j[d]=i),t=i}return i=new sr(n),i.jr=s.slice(),t.j[e[o-1]]=i,i}function QN(t){const e=[],n=[];let r=0,s="0123456789";for(;r<t.length;){let i=0;for(;s.indexOf(t[r+i])>=0;)i++;if(i>0){e.push(n.join(""));for(let o=parseInt(t.substring(r,r+i),10);o>0;o--)n.pop();r+=i}else n.push(t[r]),r++}return e}const Zu={defaultProtocol:"http",events:null,format:WN,formatHref:WN,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Wv(t,e=null){let n=Object.assign({},Zu);t&&(n=Object.assign(n,t instanceof Wv?t.o:t));const r=n.ignoreTags,s=[];for(let i=0;i<r.length;i++)s.push(r[i].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=s}Wv.prototype={o:Zu,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=e!=null;let s=this.o[t];return s&&(typeof s=="object"?(s=n.t in s?s[n.t]:Zu[t],typeof s=="function"&&r&&(s=s(e,n))):typeof s=="function"&&r&&(s=s(e,n.t,n)),s)},getObj(t,e,n){let r=this.o[t];return typeof r=="function"&&e!=null&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function WN(t){return t}function HA(t,e){this.t="token",this.v=t,this.tk=e}HA.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=Zu.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),s=t.get("tagName",n,e),i=this.toFormattedString(t),o={},l=t.get("className",n,e),d=t.get("target",n,e),f=t.get("rel",n,e),p=t.getObj("attributes",n,e),g=t.getObj("events",n,e);return o.href=r,l&&(o.class=l),d&&(o.target=d),f&&(o.rel=f),p&&Object.assign(o,p),{tagName:s,attributes:o,content:i,eventListeners:g}}};function fg(t,e){class n extends HA{constructor(s,i){super(s,i),this.t=t}}for(const r in e)n.prototype[r]=e[r];return n.t=t,n}const YN=fg("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),GN=fg("text"),TH=fg("nl"),ih=fg("url",{isLink:!0,toHref(t=Zu.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Ju&&t[1].t===Zi}}),Fr=t=>new sr(t);function jH({groups:t}){const e=t.domain.concat([gp,yp,Gi,xp,bp,vp,wp,Sp,Vr,$v,Ru,kp,Cp,Np,vs,jp,Ou,Tp]),n=[mp,Zi,Hv,bs,Vv,Ru,_u,Kv,Qv,ip,ap,Mu,Au,np,tp,rp,sp,op,lp,cp,up,dp,fp,hp,pp],r=[gp,mp,yp,xp,bp,vp,wp,Sp,Vr,Mu,Au,Ru,kp,Cp,Np,_u,vs,jp,Ou,Tp],s=Fr(),i=Ee(s,Ou);Ye(i,r,i),Ye(i,t.domain,i);const o=Fr(),l=Fr(),d=Fr();Ye(s,t.domain,o),Ye(s,t.scheme,l),Ye(s,t.slashscheme,d),Ye(o,r,i),Ye(o,t.domain,o);const f=Ee(o,Gi);Ee(i,Gi,f),Ee(l,Gi,f),Ee(d,Gi,f);const p=Ee(i,bs);Ye(p,r,i),Ye(p,t.domain,i);const g=Fr();Ye(f,t.domain,g),Ye(g,t.domain,g);const m=Ee(g,bs);Ye(m,t.domain,g);const y=Fr(YN);Ye(m,t.tld,y),Ye(m,t.utld,y),Ee(f,Ju,y);const b=Ee(g,Vr);Ee(b,Vr,b),Ye(b,t.domain,g),Ye(y,t.domain,g),Ee(y,bs,m),Ee(y,Vr,b);const v=Ee(y,Zi);Ye(v,t.numeric,YN);const w=Ee(o,Vr),S=Ee(o,bs);Ee(w,Vr,w),Ye(w,t.domain,o),Ye(S,r,i),Ye(S,t.domain,o);const T=Fr(ih);Ye(S,t.tld,T),Ye(S,t.utld,T),Ye(T,t.domain,o),Ye(T,r,i),Ee(T,bs,S),Ee(T,Vr,w),Ee(T,Gi,f);const j=Ee(T,Zi),M=Fr(ih);Ye(j,t.numeric,M);const _=Fr(ih),R=Fr();Ye(_,e,_),Ye(_,n,R),Ye(R,e,_),Ye(R,n,R),Ee(T,vs,_),Ee(M,vs,_);const O=Ee(l,Zi),L=Ee(d,Zi),A=Ee(L,vs),F=Ee(A,vs);Ye(l,t.domain,o),Ee(l,bs,S),Ee(l,Vr,w),Ye(d,t.domain,o),Ee(d,bs,S),Ee(d,Vr,w),Ye(O,t.domain,_),Ee(O,vs,_),Ee(O,_u,_),Ye(F,t.domain,_),Ye(F,e,_),Ee(F,vs,_);const H=[[Mu,Au],[tp,np],[rp,sp],[ip,ap],[op,lp],[cp,up],[dp,fp],[hp,pp]];for(let P=0;P<H.length;P++){const[B,E]=H[P],K=Ee(_,B);Ee(R,B,K),Ee(K,E,_);const q=Fr(ih);Ye(K,e,q);const V=Fr();Ye(K,n),Ye(q,e,q),Ye(q,n,V),Ye(V,e,q),Ye(V,n,V),Ee(q,E,_),Ee(V,E,_)}return Ee(s,Ju,T),Ee(s,qv,TH),{start:s,tokens:$A}}function EH(t,e,n){let r=n.length,s=0,i=[],o=[];for(;s<r;){let l=t,d=null,f=null,p=0,g=null,m=-1;for(;s<r&&!(d=l.go(n[s].t));)o.push(n[s++]);for(;s<r&&(f=d||l.go(n[s].t));)d=null,l=f,l.accepts()?(m=0,g=l):m>=0&&m++,s++,p++;if(m<0)s-=p,s<r&&(o.push(n[s]),s++);else{o.length>0&&(i.push(vy(GN,e,o)),o=[]),s-=m,p-=m;const y=g.t,b=n.slice(s-p,s);i.push(vy(y,e,b))}}return o.length>0&&i.push(vy(GN,e,o)),i}function vy(t,e,n){const r=n[0].s,s=n[n.length-1].e,i=e.slice(r,s);return new t(i,n)}const MH=typeof console<"u"&&console&&console.warn||(()=>{}),AH="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Mt={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function RH(){return sr.groups={},Mt.scanner=null,Mt.parser=null,Mt.tokenQueue=[],Mt.pluginQueue=[],Mt.customSchemes=[],Mt.initialized=!1,Mt}function XN(t,e=!1){if(Mt.initialized&&MH(`linkifyjs: already initialized - will not register custom scheme "${t}" ${AH}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Mt.customSchemes.push([t,e])}function _H(){Mt.scanner=CH(Mt.customSchemes);for(let t=0;t<Mt.tokenQueue.length;t++)Mt.tokenQueue[t][1]({scanner:Mt.scanner});Mt.parser=jH(Mt.scanner.tokens);for(let t=0;t<Mt.pluginQueue.length;t++)Mt.pluginQueue[t][1]({scanner:Mt.scanner,parser:Mt.parser});return Mt.initialized=!0,Mt}function Yv(t){return Mt.initialized||_H(),EH(Mt.parser.start,t,qA(Mt.scanner.start,t))}Yv.scan=qA;function VA(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new Wv(n),s=Yv(t),i=[];for(let o=0;o<s.length;o++){const l=s[o];l.isLink&&(!e||l.t===e)&&r.check(l)&&i.push(l.toFormattedObject(r))}return i}var Gv="[\0- -\u2029]",OH=new RegExp(Gv),IH=new RegExp(`${Gv}$`),DH=new RegExp(Gv,"g");function LH(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function zH(t){return new _t({key:new an("autolink"),appendTransaction:(e,n,r)=>{const s=e.some(f=>f.docChanged)&&!n.doc.eq(r.doc),i=e.some(f=>f.getMeta("preventAutolink"));if(!s||i)return;const{tr:o}=r,l=fA(n.doc,[...e]);if(bA(l).forEach(({newRange:f})=>{const p=C$(r.doc,f,y=>y.isTextblock);let g,m;if(p.length>1)g=p[0],m=r.doc.textBetween(g.pos,g.pos+g.node.nodeSize,void 0," ");else if(p.length){const y=r.doc.textBetween(f.from,f.to," "," ");if(!IH.test(y))return;g=p[0],m=r.doc.textBetween(g.pos,f.to,void 0," ")}if(g&&m){const y=m.split(OH).filter(Boolean);if(y.length<=0)return!1;const b=y[y.length-1],v=g.pos+m.lastIndexOf(b);if(!b)return!1;const w=Yv(b).map(S=>S.toObject(t.defaultProtocol));if(!LH(w))return!1;w.filter(S=>S.isLink).map(S=>({...S,from:v+S.start+1,to:v+S.end+1})).filter(S=>r.schema.marks.code?!r.doc.rangeHasMark(S.from,S.to,r.schema.marks.code):!0).filter(S=>t.validate(S.value)).filter(S=>t.shouldAutoLink(S.value)).forEach(S=>{Iv(S.from,S.to,r.doc).some(T=>T.mark.type===t.type)||o.addMark(S.from,S.to,t.type.create({href:S.href}))})}}),!!o.steps.length)return o}})}function PH(t){return new _t({key:new an("handleClickLink"),props:{handleClick:(e,n,r)=>{var s,i;if(r.button!==0||!e.editable)return!1;let o=null;if(r.target instanceof HTMLAnchorElement)o=r.target;else{let p=r.target;const g=[];for(;p.nodeName!=="DIV";)g.push(p),p=p.parentNode;o=g.find(m=>m.nodeName==="A")}if(!o)return!1;const l=xA(e.state,t.type.name),d=(s=o?.href)!=null?s:l.href,f=(i=o?.target)!=null?i:l.target;return t.enableClickSelection&&t.editor.commands.extendMarkRange(t.type.name),o&&d?(window.open(d,f),!0):!1}}})}function BH(t){return new _t({key:new an("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{shouldAutoLink:s}=t,{state:i}=e,{selection:o}=i,{empty:l}=o;if(l)return!1;let d="";r.content.forEach(p=>{d+=p.textContent});const f=VA(d,{defaultProtocol:t.defaultProtocol}).find(p=>p.isLink&&p.value===d);return!d||!f||s!==void 0&&!s(f.href)?!1:t.editor.commands.setMark(t.type,{href:f.href})}}})}function Pa(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&n.push(s)}),!t||t.replace(DH,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var FH=Co.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){XN(t);return}XN(t.scheme,t.optionalSlashes)})},onDestroy(){RH()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!Pa(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!Pa(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!Pa(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Zt(this.options.HTMLAttributes,t),0]:["a",Zt(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var n;const r=((n=t.attrs)==null?void 0:n.href)||"";return`[${e.renderChildren(t)}](${r})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!Pa(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:r=>!!Pa(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[uo({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,s=VA(t).filter(i=>i.isLink&&this.options.isAllowedUri(i.value,{defaultValidate:o=>!!Pa(o,n),protocols:n,defaultProtocol:r}));s.length&&s.forEach(i=>{this.options.shouldAutoLink(i.value)&&e.push({text:i.value,data:{href:i.href},index:i.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(zH({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!Pa(s,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&t.push(PH({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(BH({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),UH=Object.defineProperty,$H=(t,e)=>{for(var n in e)UH(t,n,{get:e[n],enumerable:!0})},qH="listItem",JN="textStyle",ZN=/^\s*([-+*])\s$/,KA=Cr.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Zt(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(qH,this.editor.getAttributes(JN)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Yl({find:ZN,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Yl({find:ZN,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(JN),editor:this.editor})),[t]}}),QA=Cr.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Zt(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(s=>s.type==="paragraph"))n=e.parseChildren(t.tokens);else{const s=t.tokens[0];if(s&&s.type==="text"&&s.tokens&&s.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(s.tokens)}],t.tokens.length>1){const o=t.tokens.slice(1),l=e.parseChildren(o);n.push(...l)}}else n=e.parseChildren(t.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>Pv(t,e,r=>r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${r.index+1}. `:"- ",n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),HH={};$H(HH,{findListItemPos:()=>yd,getNextListDepth:()=>Xv,handleBackspace:()=>ib,handleDelete:()=>ab,hasListBefore:()=>WA,hasListItemAfter:()=>VH,hasListItemBefore:()=>YA,listItemHasSubList:()=>GA,nextListIsDeeper:()=>XA,nextListIsHigher:()=>JA});var yd=(t,e)=>{const{$from:n}=e.selection,r=Jt(t,e.schema);let s=null,i=n.depth,o=n.pos,l=null;for(;i>0&&l===null;)s=n.node(i),s.type===r?l=i:(i-=1,o-=1);return l===null?null:{$pos:e.doc.resolve(o),depth:l}},Xv=(t,e)=>{const n=yd(t,e);if(!n)return!1;const[,r]=I$(e,t,n.$pos.pos+4);return r},WA=(t,e,n)=>{const{$anchor:r}=t.selection,s=Math.max(0,r.pos-2),i=t.doc.resolve(s).node();return!(!i||!n.includes(i.type.name))},YA=(t,e)=>{var n;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-2);return!(s.index()===0||((n=s.nodeBefore)==null?void 0:n.type.name)!==t)},GA=(t,e,n)=>{if(!n)return!1;const r=Jt(t,e.schema);let s=!1;return n.descendants(i=>{i.type===r&&(s=!0)}),s},ib=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!ma(t.state,e)&&WA(t.state,e,n)){const{$anchor:l}=t.state.selection,d=t.state.doc.resolve(l.before()-1),f=[];d.node().descendants((m,y)=>{m.type.name===e&&f.push({node:m,pos:y})});const p=f.at(-1);if(!p)return!1;const g=t.state.doc.resolve(d.start()+p.pos+1);return t.chain().cut({from:l.start()-1,to:l.end()+1},g.end()).joinForward().run()}if(!ma(t.state,e)||!P$(t.state))return!1;const r=yd(e,t.state);if(!r)return!1;const i=t.state.doc.resolve(r.$pos.pos-2).node(r.depth),o=GA(e,t.state,i);return YA(e,t.state)&&!o?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},XA=(t,e)=>{const n=Xv(t,e),r=yd(t,e);return!r||!n?!1:n>r.depth},JA=(t,e)=>{const n=Xv(t,e),r=yd(t,e);return!r||!n?!1:n<r.depth},ab=(t,e)=>{if(!ma(t.state,e)||!z$(t.state,e))return!1;const{selection:n}=t.state,{$from:r,$to:s}=n;return!n.empty&&r.sameParent(s)?!1:XA(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():JA(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},VH=(t,e)=>{var n;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-r.parentOffset-2);return!(s.index()===s.parent.childCount-1||((n=s.nodeAfter)==null?void 0:n.type.name)!==t)},ZA=Pt.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&ab(t,n)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&ab(t,n)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&ib(t,n,r)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&ib(t,n,r)&&(e=!0)}),e}}}}),eT=/^(\s*)(\d+)\.\s+(.*)$/,KH=/^\s/;function QH(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n],i=s.match(eT);if(!i)break;const[,o,l,d]=i,f=o.length;let p=d,g=n+1;const m=[s];for(;g<t.length;){const y=t[g];if(y.match(eT))break;if(y.trim()==="")m.push(y),p+=`
`,g+=1;else if(y.match(KH))m.push(y),p+=`
${y.slice(f+2)}`,g+=1;else break}e.push({indent:f,number:parseInt(l,10),content:p.trim(),raw:m.join(`
`)}),r=g,n=g}return[e,r]}function e5(t,e,n){var r;const s=[];let i=0;for(;i<t.length;){const o=t[i];if(o.indent===e){const l=o.content.split(`
`),d=((r=l[0])==null?void 0:r.trim())||"",f=[];d&&f.push({type:"paragraph",raw:d,tokens:n.inlineTokens(d)});const p=l.slice(1).join(`
`).trim();if(p){const y=n.blockTokens(p);f.push(...y)}let g=i+1;const m=[];for(;g<t.length&&t[g].indent>e;)m.push(t[g]),g+=1;if(m.length>0){const y=Math.min(...m.map(v=>v.indent)),b=e5(m,y,n);f.push({type:"list",ordered:!0,start:m[0].number,items:b,raw:m.map(v=>v.raw).join(`
`)})}s.push({type:"list_item",raw:o.raw,tokens:f}),i=g}else i+=1}return s}function WH(t,e){return t.map(n=>{if(n.type!=="list_item")return e.parseChildren([n])[0];const r=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(s=>{if(s.type==="paragraph"||s.type==="list"||s.type==="blockquote"||s.type==="code")r.push(...e.parseChildren([s]));else if(s.type==="text"&&s.tokens){const i=e.parseChildren([s]);r.push({type:"paragraph",content:i})}else{const i=e.parseChildren([s]);i.length>0&&r.push(...i)}}),{type:"listItem",content:r}})}var YH="listItem",tT="textStyle",nT=/^(\d+)\.\s$/,t5=Cr.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",Zt(this.options.HTMLAttributes,n),0]:["ol",Zt(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const n=t.start||1,r=t.items?WH(t.items,e):[];return n!==1?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=e?.index;return n!==void 0?n:-1},tokenize:(t,e,n)=>{var r;const s=t.split(`
`),[i,o]=QH(s);if(i.length===0)return;const l=e5(i,0,n);return l.length===0?void 0:{type:"list",ordered:!0,start:((r=i[0])==null?void 0:r.number)||1,items:l,raw:s.slice(0,o).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(YH,this.editor.getAttributes(tT)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Yl({find:nT,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Yl({find:nT,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(tT)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),GH=/^\s*(\[([( |x])?\])\s$/,XH=Cr.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",Zt(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const r=e.parseChildren(t.nestedTokens);n.push(...r)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;const s=`- [${(n=t.attrs)!=null&&n.checked?"x":" "}] `;return Pv(t,e,s)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:r})=>{const s=document.createElement("li"),i=document.createElement("label"),o=document.createElement("span"),l=document.createElement("input"),d=document.createElement("div"),f=p=>{var g,m;l.ariaLabel=((m=(g=this.options.a11y)==null?void 0:g.checkboxLabel)==null?void 0:m.call(g,p,l.checked))||`Task item checkbox for ${p.textContent||"empty task item"}`};return f(t),i.contentEditable="false",l.type="checkbox",l.addEventListener("mousedown",p=>p.preventDefault()),l.addEventListener("change",p=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){l.checked=!l.checked;return}const{checked:g}=p.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:m})=>{const y=n();if(typeof y!="number")return!1;const b=m.doc.nodeAt(y);return m.setNodeMarkup(y,void 0,{...b?.attrs,checked:g}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,g)||(l.checked=!l.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([p,g])=>{s.setAttribute(p,g)}),s.dataset.checked=t.attrs.checked,l.checked=t.attrs.checked,i.append(l,o),s.append(i,d),Object.entries(e).forEach(([p,g])=>{s.setAttribute(p,g)}),{dom:s,contentDOM:d,update:p=>p.type!==this.type?!1:(s.dataset.checked=p.attrs.checked,l.checked=p.attrs.checked,f(p),!0)}}},addInputRules(){return[Yl({find:GH,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),JH=Cr.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",Zt(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return n!==void 0?n:-1},tokenize(t,e,n){const r=i=>{const o=Yx(i,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:l=>({indentLevel:l[1].length,mainContent:l[4],checked:l[3].toLowerCase()==="x"}),createToken:(l,d)=>({type:"taskItem",raw:"",mainContent:l.mainContent,indentLevel:l.indentLevel,checked:l.checked,text:l.mainContent,tokens:n.inlineTokens(l.mainContent),nestedTokens:d}),customNestedParser:r},n);return o?[{type:"taskList",raw:o.raw,items:o.items}]:n.blockTokens(i)},s=Yx(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:i=>({indentLevel:i[1].length,mainContent:i[4],checked:i[3].toLowerCase()==="x"}),createToken:(i,o)=>({type:"taskItem",raw:"",mainContent:i.mainContent,indentLevel:i.indentLevel,checked:i.checked,text:i.mainContent,tokens:n.inlineTokens(i.mainContent),nestedTokens:o}),customNestedParser:r},n);if(s)return{type:"taskList",raw:s.raw,items:s.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});Pt.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(KA.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(QA.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(ZA.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(t5.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(XH.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(JH.configure(this.options.taskList)),t}});var ZH=Cr.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Zt(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const n=t.tokens||[];return n.length===1&&n[0].type==="image"?e.parseChildren([n[0]]):e.createNode("paragraph",void 0,e.parseInline(n))},renderMarkdown:(t,e)=>!t||!Array.isArray(t.content)?"":e.renderChildren(t.content),addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),eV=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,tV=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,nV=Co.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Zt(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Wl({find:eV,type:this.type})]},addPasteRules(){return[uo({find:tV,type:this.type})]}}),rV=Cr.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),sV=Co.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",Zt(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,n){const s=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!s)return;const i=s[2].trim();return{type:"underline",raw:s[0],text:i,tokens:n.inlineTokens(i)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function iV(t={}){return new _t({view(e){return new aV(e,t)}})}class aV{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let i=o=>{this[s](o)};return e.dom.addEventListener(s,i),{name:s,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,s=this.editorView.dom,i=s.getBoundingClientRect(),o=i.width/s.offsetWidth,l=i.height/s.offsetHeight;if(n){let g=e.nodeBefore,m=e.nodeAfter;if(g||m){let y=this.editorView.nodeDOM(this.cursorPos-(g?g.nodeSize:0));if(y){let b=y.getBoundingClientRect(),v=g?b.bottom:b.top;g&&m&&(v=(v+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let w=this.width/2*l;r={left:b.left,right:b.right,top:v-w,bottom:v+w}}}}if(!r){let g=this.editorView.coordsAtPos(this.cursorPos),m=this.width/2*o;r={left:g.left-m,right:g.left+m,top:g.top,bottom:g.bottom}}let d=this.editorView.dom.offsetParent;this.element||(this.element=d.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let f,p;if(!d||d==document.body&&getComputedStyle(d).position=="static")f=-pageXOffset,p=-pageYOffset;else{let g=d.getBoundingClientRect(),m=g.width/d.offsetWidth,y=g.height/d.offsetHeight;f=g.left-d.scrollLeft*m,p=g.top-d.scrollTop*y}this.element.style.left=(r.left-f)/o+"px",this.element.style.top=(r.top-p)/l+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),s=r&&r.type.spec.disableDropCursor,i=typeof s=="function"?s(this.editorView,n,e):s;if(n&&!i){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=sM(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class Lt extends Ge{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return Lt.valid(r)?new Lt(r):Ge.near(r)}content(){return Ae.empty}eq(e){return e instanceof Lt&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Lt(e.resolve(n.pos))}getBookmark(){return new Jv(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!oV(e)||!lV(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let s=n.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&Lt.valid(e))return e;let s=e.pos,i=null;for(let o=e.depth;;o--){let l=e.node(o);if(n>0?e.indexAfter(o)<l.childCount:e.index(o)>0){i=l.child(n>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;s+=n;let d=e.doc.resolve(s);if(Lt.valid(d))return d}for(;;){let o=n>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!Be.isSelectable(i)){e=e.doc.resolve(s+i.nodeSize*n),r=!1;continue e}break}i=o,s+=n;let l=e.doc.resolve(s);if(Lt.valid(l))return l}return null}}}Lt.prototype.visible=!1;Lt.findFrom=Lt.findGapCursorFrom;Ge.jsonID("gapcursor",Lt);class Jv{constructor(e){this.pos=e}map(e){return new Jv(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return Lt.valid(n)?new Lt(n):Ge.near(n)}}function n5(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function oV(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||n5(s.type))return!0;if(s.inlineContent)return!1}}return!0}function lV(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||n5(s.type))return!0;if(s.inlineContent)return!1}}return!0}function cV(){return new _t({props:{decorations:hV,createSelectionBetween(t,e,n){return e.pos==n.pos&&Lt.valid(n)?new Lt(n):null},handleClick:dV,handleKeyDown:uV,handleDOMEvents:{beforeinput:fV}}})}const uV=sA({ArrowLeft:ah("horiz",-1),ArrowRight:ah("horiz",1),ArrowUp:ah("vert",-1),ArrowDown:ah("vert",1)});function ah(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,i){let o=r.selection,l=e>0?o.$to:o.$from,d=o.empty;if(o instanceof qe){if(!i.endOfTextblock(n)||l.depth==0)return!1;d=!1,l=r.doc.resolve(e>0?l.after():l.before())}let f=Lt.findGapCursorFrom(l,e,d);return f?(s&&s(r.tr.setSelection(new Lt(f))),!0):!1}}function dV(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!Lt.valid(r))return!1;let s=t.posAtCoords({left:n.clientX,top:n.clientY});return s&&s.inside>-1&&Be.isSelectable(t.state.doc.nodeAt(s.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Lt(r))),!0)}function fV(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Lt))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let s=Ne.empty;for(let o=r.length-1;o>=0;o--)s=Ne.from(r[o].createAndFill(null,s));let i=t.state.tr.replace(n.pos,n.pos,new Ae(s,0,0));return i.setSelection(qe.near(i.doc.resolve(n.pos+1))),t.dispatch(i),!1}function hV(t){if(!(t.selection instanceof Lt))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Rt.create(t.doc,[Pn.widget(t.selection.head,e,{key:"gapcursor"})])}var Ep=200,hn=function(){};hn.prototype.append=function(e){return e.length?(e=hn.from(e),!this.length&&e||e.length<Ep&&this.leafAppend(e)||this.length<Ep&&e.leafPrepend(this)||this.appendInner(e)):this};hn.prototype.prepend=function(e){return e.length?hn.from(e).append(this):this};hn.prototype.appendInner=function(e){return new pV(this,e)};hn.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?hn.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};hn.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};hn.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};hn.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,o){return s.push(e(i,o))},n,r),s};hn.from=function(e){return e instanceof hn?e:e&&e.length?new r5(e):hn.empty};var r5=(function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new e(this.values.slice(s,i))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,i,o,l){for(var d=i;d<o;d++)if(s(this.values[d],l+d)===!1)return!1},e.prototype.forEachInvertedInner=function(s,i,o,l){for(var d=i-1;d>=o;d--)if(s(this.values[d],l+d)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=Ep)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=Ep)return new e(s.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e})(hn);hn.empty=new r5([]);var pV=(function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,i,o){var l=this.left.length;if(s<l&&this.left.forEachInner(r,s,Math.min(i,l),o)===!1||i>l&&this.right.forEachInner(r,Math.max(s-l,0),Math.min(this.length,i)-l,o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,i,o){var l=this.left.length;if(s>l&&this.right.forEachInvertedInner(r,s-l,Math.max(i,l)-l,o+l)===!1||i<l&&this.left.forEachInvertedInner(r,Math.min(s,l),i,o)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e})(hn);const gV=500;class as{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;n&&(s=this.remapping(r,this.items.length),i=s.maps.length);let o=e.tr,l,d,f=[],p=[];return this.items.forEach((g,m)=>{if(!g.step){s||(s=this.remapping(r,m+1),i=s.maps.length),i--,p.push(g);return}if(s){p.push(new ws(g.map));let y=g.step.map(s.slice(i)),b;y&&o.maybeStep(y).doc&&(b=o.mapping.maps[o.mapping.maps.length-1],f.push(new ws(b,void 0,void 0,f.length+p.length))),i--,b&&s.appendMap(b,i)}else o.maybeStep(g.step);if(g.selection)return l=s?g.selection.map(s.slice(i)):g.selection,d=new as(this.items.slice(0,r).append(p.reverse().concat(f)),this.eventCount-1),!1},this.items.length,0),{remaining:d,transform:o,selection:l}}addTransform(e,n,r,s){let i=[],o=this.eventCount,l=this.items,d=!s&&l.length?l.get(l.length-1):null;for(let p=0;p<e.steps.length;p++){let g=e.steps[p].invert(e.docs[p]),m=new ws(e.mapping.maps[p],g,n),y;(y=d&&d.merge(m))&&(m=y,p?i.pop():l=l.slice(0,l.length-1)),i.push(m),n&&(o++,n=void 0),s||(d=m)}let f=o-r.depth;return f>yV&&(l=mV(l,f),o-=f),new as(l.append(i),o)}remapping(e,n){let r=new Ku;return this.items.forEach((s,i)=>{let o=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,o)},e,n),r}addMaps(e){return this.eventCount==0?this:new as(this.items.append(e.map(n=>new ws(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-n),i=e.mapping,o=e.steps.length,l=this.eventCount;this.items.forEach(m=>{m.selection&&l--},s);let d=n;this.items.forEach(m=>{let y=i.getMirror(--d);if(y==null)return;o=Math.min(o,y);let b=i.maps[y];if(m.step){let v=e.steps[y].invert(e.docs[y]),w=m.selection&&m.selection.map(i.slice(d+1,y));w&&l++,r.push(new ws(b,v,w))}else r.push(new ws(b))},s);let f=[];for(let m=n;m<o;m++)f.push(new ws(i.maps[m]));let p=this.items.slice(0,s).append(f).append(r),g=new as(p,l);return g.emptyItemCount()>gV&&(g=g.compress(this.items.length-r.length)),g}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,s=[],i=0;return this.items.forEach((o,l)=>{if(l>=e)s.push(o),o.selection&&i++;else if(o.step){let d=o.step.map(n.slice(r)),f=d&&d.getMap();if(r--,f&&n.appendMap(f,r),d){let p=o.selection&&o.selection.map(n.slice(r));p&&i++;let g=new ws(f.invert(),d,p),m,y=s.length-1;(m=s.length&&s[y].merge(g))?s[y]=m:s.push(g)}}else o.map&&r--},this.items.length,0),new as(hn.from(s.reverse()),i)}}as.empty=new as(hn.empty,0);function mV(t,e){let n;return t.forEach((r,s)=>{if(r.selection&&e--==0)return n=s,!1}),t.slice(n)}class ws{constructor(e,n,r,s){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new ws(n.getMap().invert(),n,this.selection)}}}class Xi{constructor(e,n,r,s,i){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const yV=20;function xV(t,e,n,r){let s=n.getMeta(Za),i;if(s)return s.historyState;n.getMeta(wV)&&(t=new Xi(t.done,t.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(Za))return o.getMeta(Za).redo?new Xi(t.done.addTransform(n,void 0,r,xh(e)),t.undone,rT(n.mapping.maps),t.prevTime,t.prevComposition):new Xi(t.done,t.undone.addTransform(n,void 0,r,xh(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=n.getMeta("composition"),d=t.prevTime==0||!o&&t.prevComposition!=l&&(t.prevTime<(n.time||0)-r.newGroupDelay||!bV(n,t.prevRanges)),f=o?wy(t.prevRanges,n.mapping):rT(n.mapping.maps);return new Xi(t.done.addTransform(n,d?e.selection.getBookmark():void 0,r,xh(e)),as.empty,f,n.time,l??t.prevComposition)}else return(i=n.getMeta("rebased"))?new Xi(t.done.rebased(n,i),t.undone.rebased(n,i),wy(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Xi(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),wy(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function bV(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(n=!0)}),n}function rT(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,s,i,o)=>e.push(i,o));return e}function wy(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let s=e.map(t[r],1),i=e.map(t[r+1],-1);s<=i&&n.push(s,i)}return n}function vV(t,e,n){let r=xh(e),s=Za.get(e).spec.config,i=(n?t.undone:t.done).popEvent(e,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),l=(n?t.done:t.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),d=new Xi(n?l:i.remaining,n?i.remaining:l,null,0,-1);return i.transform.setSelection(o).setMeta(Za,{redo:n,historyState:d})}let Sy=!1,sT=null;function xh(t){let e=t.plugins;if(sT!=e){Sy=!1,sT=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Sy=!0;break}}return Sy}const Za=new an("history"),wV=new an("closeHistory");function SV(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new _t({key:Za,state:{init(){return new Xi(as.empty,as.empty,null,0,-1)},apply(e,n,r){return xV(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,s=r=="historyUndo"?i5:r=="historyRedo"?a5:null;return!s||!e.editable?!1:(n.preventDefault(),s(e.state,e.dispatch))}}}})}function s5(t,e){return(n,r)=>{let s=Za.getState(n);if(!s||(t?s.undone:s.done).eventCount==0)return!1;if(r){let i=vV(s,n,t);i&&r(e?i.scrollIntoView():i)}return!0}}const i5=s5(!1,!0),a5=s5(!0,!0);Pt.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=t?.node||this.editor.state.doc;if((t?.mode||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=t=>{const e=t?.node||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let t=!1;return[new _t({key:new an("characterCount"),appendTransaction:(e,n,r)=>{if(t)return;const s=this.options.limit;if(s==null||s===0){t=!0;return}const i=this.storage.characters({node:r.doc});if(i>s){const o=i-s,l=0,d=o;console.warn(`[CharacterCount] Initial content exceeded limit of ${s} characters. Content was automatically trimmed.`);const f=r.tr.deleteRange(l,d);return t=!0,f}t=!0},filterTransaction:(e,n)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const s=this.storage.characters({node:n.doc}),i=this.storage.characters({node:e.doc});if(i<=r||s>r&&i>r&&i<=s)return!0;if(s>r&&i>r&&i>s||!e.getMeta("paste"))return!1;const l=e.selection.$head.pos,d=i-r,f=l-d,p=l;return e.deleteRange(f,p),!(this.storage.characters({node:e.doc})>r)}})]}});var kV=Pt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[iV(this.options)]}});Pt.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new _t({key:new an("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:s}=e,i=[];if(!n||!r)return Rt.create(t,[]);let o=0;this.options.mode==="deepest"&&t.descendants((d,f)=>{if(d.isText)return;if(!(s>=f&&s<=f+d.nodeSize-1))return!1;o+=1});let l=0;return t.descendants((d,f)=>{if(d.isText||!(s>=f&&s<=f+d.nodeSize-1))return!1;if(l+=1,this.options.mode==="deepest"&&o-l>0||this.options.mode==="shallowest"&&l>1)return this.options.mode==="deepest";i.push(Pn.node(f,f+d.nodeSize,{class:this.options.className}))}),Rt.create(t,i)}}})]}});var CV=Pt.create({name:"gapCursor",addProseMirrorPlugins(){return[cV()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=gt(Pe(t,"allowGapCursor",n)))!=null?e:null}}});Pt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new _t({key:new an("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,s=[];if(!n)return null;const i=this.editor.isEmpty;return t.descendants((o,l)=>{const d=r>=l&&r<=l+o.nodeSize,f=!o.isLeaf&&cg(o);if((d||!this.options.showOnlyCurrent)&&f){const p=[this.options.emptyNodeClass];i&&p.push(this.options.emptyEditorClass);const g=Pn.node(l,l+o.nodeSize,{class:p.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:o,pos:l,hasAnchor:d}):this.options.placeholder});s.push(g)}return this.options.includeChildren}),Rt.create(t,s)}}})]}});Pt.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new _t({key:new an("selection"),props:{decorations(n){return n.selection.empty||t.isFocused||!t.isEditable||vA(n.selection)||t.view.dragging?null:Rt.create(n.doc,[Pn.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});function iT({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||e?.type===t}var NV=Pt.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new an(this.name),n=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,s])=>s).filter(s=>(this.options.notAfter||[]).concat(n).includes(s.name));return[new _t({key:e,appendTransaction:(s,i,o)=>{const{doc:l,tr:d,schema:f}=o,p=e.getState(o),g=l.content.size,m=f.nodes[n];if(p)return d.insert(g,m.create())},state:{init:(s,i)=>{const o=i.tr.doc.lastChild;return!iT({node:o,types:r})},apply:(s,i)=>{if(!s.docChanged||s.getMeta("__uniqueIDTransaction"))return i;const o=s.doc.lastChild;return!iT({node:o,types:r})}}})]}}),TV=Pt.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>i5(t,e),redo:()=>({state:t,dispatch:e})=>a5(t,e)}},addProseMirrorPlugins(){return[SV(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),jV=Pt.create({name:"starterKit",addExtensions(){var t,e,n,r;const s=[];return this.options.bold!==!1&&s.push(eH.configure(this.options.bold)),this.options.blockquote!==!1&&s.push(Yq.configure(this.options.blockquote)),this.options.bulletList!==!1&&s.push(KA.configure(this.options.bulletList)),this.options.code!==!1&&s.push(rH.configure(this.options.code)),this.options.codeBlock!==!1&&s.push(aH.configure(this.options.codeBlock)),this.options.document!==!1&&s.push(oH.configure(this.options.document)),this.options.dropcursor!==!1&&s.push(kV.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&s.push(CV.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&s.push(lH.configure(this.options.hardBreak)),this.options.heading!==!1&&s.push(cH.configure(this.options.heading)),this.options.undoRedo!==!1&&s.push(TV.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&s.push(uH.configure(this.options.horizontalRule)),this.options.italic!==!1&&s.push(gH.configure(this.options.italic)),this.options.listItem!==!1&&s.push(QA.configure(this.options.listItem)),this.options.listKeymap!==!1&&s.push(ZA.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&s.push(FH.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&s.push(t5.configure(this.options.orderedList)),this.options.paragraph!==!1&&s.push(ZH.configure(this.options.paragraph)),this.options.strike!==!1&&s.push(nV.configure(this.options.strike)),this.options.text!==!1&&s.push(rV.configure(this.options.text)),this.options.underline!==!1&&s.push(sV.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&s.push(NV.configure((r=this.options)==null?void 0:r.trailingNode)),s}}),Zv=jV;function EV({entry:t,index:e,onPersonNameChange:n,onReferenceChange:r,onDelete:s}){const{t:i}=ke("queue"),{attributes:o,listeners:l,setNodeRef:d,transform:f,transition:p,isDragging:g}=wo({id:t.id}),m={transform:us.Transform.toString(f),transition:p},{translation:y}=ev(),{data:b=[]}=Kp(y?.id??0),[v,w]=C.useState(t.referenceInput);C.useEffect(()=>{const j=setTimeout(()=>{if(!v.trim()){r(v,null);return}if(b.length===0)return;const M=o3({input:v,books:b});r(v,M)},300);return()=>clearTimeout(j)},[v,b,r]);const S=t.parsedResult?.status==="valid",T=t.parsedResult&&t.parsedResult.status!=="valid";return u.jsxs("div",{ref:d,style:m,className:`flex items-start gap-2 p-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg ${g?"opacity-50 shadow-lg":""}`,children:[u.jsx("button",{type:"button",...o,...l,className:"cursor-grab active:cursor-grabbing p-1 mt-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors flex-shrink-0",children:u.jsx(cr,{className:"w-4 h-4 text-gray-400"})}),u.jsxs("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mt-2 flex-shrink-0 w-6",children:[e+1,"."]}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx("input",{type:"text",value:t.personName,onChange:j=>n(j.target.value),placeholder:i("verseteTineri.personNamePlaceholder"),className:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("input",{type:"text",value:v,onChange:j=>w(j.target.value),placeholder:i("biblePassage.referencePlaceholder"),className:`w-full px-3 py-1.5 text-sm border rounded bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:ring-2 focus:border-transparent ${T?"border-red-300 dark:border-red-600 focus:ring-red-500":S?"border-teal-300 dark:border-teal-600 focus:ring-teal-500":"border-gray-300 dark:border-gray-600 focus:ring-indigo-500"}`}),t.parsedResult&&u.jsx("div",{className:"flex items-center gap-1 text-xs",children:S?u.jsxs(u.Fragment,{children:[u.jsx(jb,{size:12,className:"text-teal-600 dark:text-teal-400"}),u.jsx("span",{className:"text-teal-700 dark:text-teal-300",children:t.parsedResult.formattedReference})]}):u.jsxs(u.Fragment,{children:[u.jsx(jh,{size:12,className:"text-red-500"}),u.jsx("span",{className:"text-red-600 dark:text-red-400",children:i(t.parsedResult.errorKey)})]})})]})]}),u.jsx("button",{type:"button",onClick:s,className:"p-1.5 mt-1 hover:bg-red-100 dark:hover:bg-red-900/20 rounded transition-colors flex-shrink-0",title:i("verseteTineri.removeEntry"),children:u.jsx(Fn,{className:"w-4 h-4 text-gray-400 hover:text-red-500"})})]})}function MV({entries:t,onEntriesChange:e}){const{t:n}=ke("queue"),r=mo(ar(xi),ar(yi,{coordinateGetter:So})),s=f=>{const{active:p,over:g}=f;if(g&&p.id!==g.id){const m=t.findIndex(v=>v.id===p.id),y=t.findIndex(v=>v.id===g.id),b=ic(t,m,y).map((v,w)=>({...v,sortOrder:w}));e(b)}},i=()=>{const f={id:`temp-${Date.now()}`,personName:"",referenceInput:"",parsedResult:null,sortOrder:t.length};e([...t,f])},o=C.useCallback((f,p)=>{const g=t.map(m=>m.id===f?{...m,personName:p}:m);e(g)},[t,e]),l=C.useCallback((f,p,g)=>{const m=t.map(y=>y.id===f?{...y,referenceInput:p,parsedResult:g}:y);e(m)},[t,e]),d=C.useCallback(f=>{const p=t.filter(g=>g.id!==f).map((g,m)=>({...g,sortOrder:m}));e(p)},[t,e]);return u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[u.jsx($l,{size:16}),u.jsx("span",{children:n("verseteTineri.entriesCount",{count:t.length})})]}),t.length>0?u.jsx(xo,{sensors:r,collisionDetection:yo,onDragEnd:s,children:u.jsx(vo,{items:t.map(f=>f.id),strategy:bo,children:u.jsx("div",{className:"space-y-2",children:t.map((f,p)=>u.jsx(EV,{entry:f,index:p,onPersonNameChange:g=>o(f.id,g),onReferenceChange:(g,m)=>l(f.id,g,m),onDelete:()=>d(f.id)},f.id))})})}):u.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-center border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg",children:[u.jsx($l,{className:"w-8 h-8 text-gray-400 mb-2"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n("verseteTineri.noEntries")})]}),u.jsxs("button",{type:"button",onClick:i,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-400 hover:border-indigo-400 hover:text-indigo-600 dark:hover:border-indigo-500 dark:hover:text-indigo-400 transition-colors",children:[u.jsx(Xt,{size:18}),n("verseteTineri.addEntry")]})]})}const AV=[{type:"announcement",icon:fo},{type:"versete_tineri",icon:fs}];function ob({isOpen:t,onClose:e,afterItemId:n,editingItem:r,initialTemplate:s,onSaved:i}){const{t:o}=ke("queue"),{showToast:l}=mt(),d=C.useRef(null),f=O8(),p=F8(),g=I8(),{translation:m}=ev(),y=!!r,[b,v]=C.useState("announcement"),[w,S]=C.useState(""),[T,j]=C.useState([]),M=Uv({extensions:[Zv.configure({heading:{levels:[1,2]}}),Bv.configure({types:["heading","paragraph"]})],content:"",onUpdate:({editor:A})=>{S(A.getHTML())},editorProps:{attributes:{class:"min-h-[150px] p-4 focus:outline-none bg-white dark:bg-gray-900 prose prose-sm dark:prose-invert max-w-none",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}}});C.useEffect(()=>{t?(d.current?.showModal(),r?(v(r.slideType??"announcement"),S(r.slideContent??""),M?.commands.setContent(r.slideContent??""),j([])):(v(s??"announcement"),S(""),M?.commands.setContent(""),j([]))):d.current?.close()},[t,M,r,s]);const _=async()=>{if(b==="versete_tineri"){const A=T.filter(P=>P.personName.trim()&&P.parsedResult?.status==="valid");if(A.length===0){l(o("verseteTineri.errorNoValidEntries"),"error");return}if(!m){l(o("verseteTineri.errorNoTranslation"),"error");return}const F=A.map(P=>({personName:P.personName.trim(),translationId:m.id,bookCode:P.parsedResult.bookCode,bookName:P.parsedResult.bookName,startChapter:P.parsedResult.startChapter,startVerse:P.parsedResult.startVerse,endChapter:P.parsedResult.endChapter,endVerse:P.parsedResult.endVerse}));(await g.mutateAsync({entries:F,afterItemId:n})).success?(l(o("messages.slideInserted"),"success"),i?.(),e()):l(o("messages.error"),"error");return}if(!w.trim()){l(o("insertSlide.errorEmpty"),"error");return}y&&r?(await p.mutateAsync({id:r.id,slideType:b,slideContent:w})).success?(l(o("messages.slideUpdated"),"success"),i?.(),e()):l(o("messages.error"),"error"):(await f.mutateAsync({slideType:b,slideContent:w,afterItemId:n})).success?(l(o("messages.slideInserted"),"success"),i?.(),e()):l(o("messages.error"),"error")},R=()=>{!f.isPending&&!p.isPending&&!g.isPending&&e()},O=f.isPending||p.isPending||g.isPending,L=A=>{A.target===d.current&&R()};return u.jsx("dialog",{ref:d,onCancel:R,onClick:L,className:"fixed inset-0 m-auto w-full max-w-xl p-0 rounded-lg bg-white dark:bg-gray-800 backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col max-h-[80vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:o(y?"insertSlide.editTitle":"insertSlide.title")}),u.jsx("button",{type:"button",onClick:R,disabled:O,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[(y||!s)&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o("insertSlide.selectTemplate")}),u.jsx("div",{className:"flex gap-2",children:AV.map(({type:A,icon:F})=>u.jsxs("button",{type:"button",onClick:()=>v(A),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg border transition-colors ${b===A?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300":"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[u.jsx(F,{size:18}),u.jsx("span",{className:"text-sm font-medium",children:o(`slideTemplates.${A}`)})]},A))})]}),b==="versete_tineri"?u.jsx(MV,{entries:T,onEntriesChange:j}):u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o("insertSlide.content")}),u.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 dark:bg-gray-900 rounded-t-lg border border-b-0 border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:()=>M?.chain().focus().toggleBold().run(),className:`px-2 py-1 rounded text-sm font-bold ${M?.isActive("bold")?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"B"}),u.jsx("button",{type:"button",onClick:()=>M?.chain().focus().toggleItalic().run(),className:`px-2 py-1 rounded text-sm italic ${M?.isActive("italic")?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"I"}),u.jsx("div",{className:"w-px h-5 bg-gray-300 dark:bg-gray-600 mx-1"}),u.jsx("button",{type:"button",onClick:()=>M?.chain().focus().toggleHeading({level:1}).run(),className:`px-2 py-1 rounded text-sm ${M?.isActive("heading",{level:1})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"H1"}),u.jsx("button",{type:"button",onClick:()=>M?.chain().focus().toggleHeading({level:2}).run(),className:`px-2 py-1 rounded text-sm ${M?.isActive("heading",{level:2})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"H2"})]}),u.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-b-lg overflow-hidden",children:u.jsx(Fv,{editor:M})})]})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:R,disabled:O,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg disabled:opacity-50",children:o("actions.cancel")}),u.jsxs("button",{type:"button",onClick:_,disabled:O||(b==="versete_tineri"?T.length===0:!w.trim()),className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:[O&&u.jsx(Qe,{size:18,className:"animate-spin"}),o(y?"insertSlide.save":"insertSlide.insert")]})]})]})})}const xd=C.forwardRef(function({onEditSong:e,onEditSlide:n,onAddToSchedule:r,onInsertSongAfter:s,onInsertBibleVerseAfter:i,onInsertBiblePassageAfter:o,onInsertSlideAfter:l,onRemove:d},f){const{t:p}=ke("queue"),[g,m]=C.useState(!1),[y,b]=C.useState(!1),v=C.useRef(null),w=C.useRef(null),S=C.useRef(null);C.useImperativeHandle(f,()=>({openMenu:()=>m(!0)})),C.useEffect(()=>{if(!g)return;const R=O=>{v.current&&!v.current.contains(O.target)&&w.current&&!w.current.contains(O.target)&&m(!1)};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[g]),C.useEffect(()=>{if(!g)return;const R=O=>{O.key==="Escape"&&m(!1)};return document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[g]),C.useEffect(()=>{y?S.current?.showModal():S.current?.close()},[y]);const T=R=>{m(!1),R()},j=()=>{m(!1),b(!0)},M=R=>{b(!1),R()},_=()=>{b(!1)};return u.jsxs("div",{className:"relative",children:[u.jsx("button",{ref:w,type:"button",onClick:()=>m(!g),className:"flex-shrink-0 p-1.5 rounded text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:p("actions.moreOptions"),children:u.jsx(Bp,{size:16})}),g&&u.jsxs("div",{ref:v,className:"absolute right-0 top-full mt-1 z-50 min-w-[160px] bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-1",children:[e&&u.jsxs("button",{type:"button",onClick:()=>T(e),className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(P2,{size:14}),p("actions.editSong")]}),n&&u.jsxs("button",{type:"button",onClick:()=>T(n),className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(P2,{size:14}),p("actions.editSlide")]}),r&&u.jsxs("button",{type:"button",onClick:()=>T(r),className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(Th,{size:14}),p("actions.addToSchedule")]}),u.jsxs("button",{type:"button",onClick:j,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(LI,{size:14}),p("actions.insertAfter")]}),u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1"}),u.jsxs("button",{type:"button",onClick:()=>T(d),className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-left text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:[u.jsx(Fn,{size:14}),p("actions.remove")]})]}),u.jsx("dialog",{ref:S,onCancel:_,onClick:R=>{R.target===S.current&&_()},className:"fixed inset-0 m-auto w-full max-w-sm p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:p("actions.insertAfter")}),u.jsx("button",{type:"button",onClick:_,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"p-4 space-y-2",children:[u.jsxs("button",{type:"button",onClick:()=>M(s),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center",children:u.jsx(ya,{size:20,className:"text-indigo-600 dark:text-indigo-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:p("addToQueue.searchSong")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:p("addToQueue.searchSongDescription")})]})]}),i&&u.jsxs("button",{type:"button",onClick:()=>M(i),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:u.jsx(Sr,{size:20,className:"text-blue-600 dark:text-blue-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:p("addToQueue.bibleVerse")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:p("addToQueue.bibleVerseDescription")})]})]}),o&&u.jsxs("button",{type:"button",onClick:()=>M(o),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-teal-100 dark:bg-teal-900/30 flex items-center justify-center",children:u.jsx(Lp,{size:20,className:"text-teal-600 dark:text-teal-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:p("addToQueue.biblePassage")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:p("addToQueue.biblePassageDescription")})]})]}),u.jsxs("button",{type:"button",onClick:()=>M(()=>l("announcement")),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center",children:u.jsx(fo,{size:20,className:"text-orange-600 dark:text-orange-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:p("addToQueue.announcement")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:p("addToQueue.announcementDescription")})]})]}),u.jsxs("button",{type:"button",onClick:()=>M(()=>l("versete_tineri")),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:u.jsx(fs,{size:20,className:"text-green-600 dark:text-green-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:p("addToQueue.verseteTineri")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:p("addToQueue.verseteTineriDescription")})]})]})]})]})})]})});function RV({item:t,isActive:e,onRemove:n,onClick:r,onInsertSongAfter:s,onInsertBibleVerseAfter:i,onInsertBiblePassageAfter:o,onInsertSlideAfter:l,dragHandleProps:d}){const{t:f}=ke("queue"),p=C.useRef(null),g=m=>{m.preventDefault(),p.current?.openMenu()};return u.jsx("div",{className:`rounded-lg border transition-all ${e?"border-green-400 bg-green-50/50 dark:bg-green-900/10":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"}`,children:u.jsxs("div",{className:"flex items-center gap-2 p-3",onContextMenu:g,children:[u.jsx("div",{...d,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(cr,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsxs("button",{type:"button",onClick:r,className:"flex-1 flex items-center gap-3 min-w-0 text-left",children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${e?"bg-green-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:u.jsx(Sr,{size:16})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:`font-medium text-sm ${e?"text-green-900 dark:text-green-100":"text-gray-900 dark:text-white"}`,children:t.bibleReference||f("bible.verse")}),t.bibleTranslation&&u.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400",children:t.bibleTranslation})]}),t.bibleText&&u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:t.bibleText})]})]}),u.jsx(xd,{ref:p,onInsertSongAfter:s,onInsertBibleVerseAfter:i,onInsertBiblePassageAfter:o,onInsertSlideAfter:l,onRemove:n})]})})}function _V({verse:t,verseIndex:e,isActive:n,onClick:r}){const s=C.useRef(null);nv(s,n);const i=t.text.length>100?`${t.text.slice(0,100)}...`:t.text;return u.jsx("button",{ref:s,type:"button",onClick:r,className:`w-full text-left p-2 pl-10 rounded-lg border transition-all ${n?"border-teal-600 bg-teal-50 dark:bg-teal-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 bg-white dark:bg-gray-800"}`,children:u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium ${n?"bg-teal-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:e+1}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:`text-xs font-medium mb-0.5 ${n?"text-teal-700 dark:text-teal-300":"text-gray-500 dark:text-gray-400"}`,children:t.reference}),u.jsx("div",{className:`text-sm line-clamp-2 ${n?"text-teal-900 dark:text-teal-100":"text-gray-700 dark:text-gray-300"}`,children:i})]})]})})}function OV({item:t,isExpanded:e,activeVerseId:n,activeQueueItemId:r,onToggleExpand:s,onRemove:i,onVerseClick:o,onPassageClick:l,onInsertSongAfter:d,onInsertBibleVerseAfter:f,onInsertBiblePassageAfter:p,onInsertSlideAfter:g,dragHandleProps:m}){const{t:y}=ke("queue"),b=C.useRef(null),v=t.id===r,w=v&&t.biblePassageVerses.some(T=>T.id===n),S=T=>{T.preventDefault(),b.current?.openMenu()};return u.jsxs("div",{className:`rounded-lg border transition-all ${w?"border-teal-400 bg-teal-50/50 dark:bg-teal-900/10":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"}`,children:[u.jsxs("div",{className:"flex items-center gap-2 p-3",onContextMenu:S,children:[u.jsx("div",{...m,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(cr,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsx("button",{type:"button",onClick:s,className:"flex-shrink-0 p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",title:y(e?"actions.collapse":"actions.expand"),children:e?u.jsx(Ms,{size:16,className:"text-gray-500"}):u.jsx(As,{size:16,className:"text-gray-500"})}),u.jsxs("button",{type:"button",onClick:l,className:"flex items-center gap-3 flex-1 min-w-0 text-left",children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${w?"bg-teal-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:u.jsx(Sr,{size:16})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("span",{className:`font-medium text-sm truncate ${w?"text-teal-900 dark:text-teal-100":"text-gray-900 dark:text-white"}`,children:t.biblePassageReference||y("biblePassage.passage")})}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:y("biblePassage.versesCount",{count:t.biblePassageVerses.length})})]})]}),u.jsx(xd,{ref:b,onInsertSongAfter:d,onInsertBibleVerseAfter:f,onInsertBiblePassageAfter:p,onInsertSlideAfter:g,onRemove:i})]}),e&&t.biblePassageVerses.length>0&&u.jsx("div",{className:"px-3 pb-3 space-y-1.5",children:t.biblePassageVerses.map((T,j)=>u.jsx(_V,{verse:T,verseIndex:j,isActive:v&&T.id===n,onClick:()=>o(T.id)},T.id))})]})}async function IV(){return(await Me("/api/schedules")).data??[]}async function DV(t){return(await Me(`/api/schedules/${t}`)).data??null}async function LV(t){const e=await Me("/api/schedules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}async function zV(t){return(await Me(`/api/schedules/${t}`,{method:"DELETE"})).data?.success??!1}async function PV(t){return(await Me(`/api/schedules/search?q=${encodeURIComponent(t)}`)).data??[]}async function BV(t,e){const n=await Me(`/api/schedules/${t}/items`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return n.error?{success:!1,error:n.error}:{success:!0,data:n.data}}async function FV(t,e){return(await Me(`/api/schedules/${t}/items/${e}`,{method:"DELETE"})).data?.success??!1}async function UV(t,e,n){const r=await Me(`/api/schedules/${t}/items/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return r.error?{success:!1,error:r.error}:{success:!0,data:r.data}}async function $V(t,e){return(await Me(`/api/schedules/${t}/items/reorder`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).data?.success??!1}async function qV(t){return(await Me(`/api/schedules/${t}/import-to-queue`,{method:"POST"})).data?.success??!1}function hg(){const t=Le();return De({mutationFn:({scheduleId:e,input:n})=>BV(e,n),onSuccess:(e,{scheduleId:n})=>{t.invalidateQueries({queryKey:["schedules"]}),t.invalidateQueries({queryKey:["schedule",n]})}})}function HV(){const t=Le();return De({mutationFn:e=>zV(e),onSuccess:()=>{t.invalidateQueries({queryKey:["schedules"]})}})}function o5(){const t=Le();return De({mutationFn:e=>qV(e),onSuccess:()=>{t.invalidateQueries({queryKey:["queue"]})}})}function l5(){const t=Le();return De({mutationFn:({scheduleId:e,itemId:n})=>FV(e,n),onSuccess:(e,{scheduleId:n})=>{t.invalidateQueries({queryKey:["schedules"]}),t.invalidateQueries({queryKey:["schedule",n]})}})}function c5(){const t=Le();return De({mutationFn:({scheduleId:e,input:n})=>$V(e,n),onSuccess:(e,{scheduleId:n})=>{t.invalidateQueries({queryKey:["schedule",n]})}})}function VV(t){return lt({queryKey:["schedule",t],queryFn:()=>DV(t),enabled:t>0})}function KV(){return lt({queryKey:["schedules"],queryFn:IV})}function QV(t){return lt({queryKey:["schedules","search",t],queryFn:()=>PV(t),enabled:t.length>0})}function WV(){const t=Le();return De({mutationFn:({scheduleId:e,itemId:n,input:r})=>UV(e,n,r),onSuccess:(e,{scheduleId:n})=>{t.invalidateQueries({queryKey:["schedule",n]})}})}function u5(){const t=Le();return De({mutationFn:e=>LV(e),onSuccess:e=>{e.success&&(t.invalidateQueries({queryKey:["schedules"]}),e.data?.id&&t.invalidateQueries({queryKey:["schedule",e.data.id]}))}})}function YV({isOpen:t,onClose:e,onCreated:n}){const{t:r}=ke("schedules"),{showToast:s}=mt(),i=C.useRef(null),o=C.useRef(null),[l,d]=C.useState(""),f=u5();C.useEffect(()=>{t?(i.current?.showModal(),setTimeout(()=>o.current?.focus(),100)):(i.current?.close(),d(""))},[t]),C.useEffect(()=>{const m=i.current;if(!m)return;const y=b=>{b.preventDefault(),f.isPending||e()};return m.addEventListener("cancel",y),()=>m.removeEventListener("cancel",y)},[e,f.isPending]);const p=async m=>{if(m.preventDefault(),!l.trim())return;const y=await f.mutateAsync({title:l.trim()});y.success&&y.data?(s(r("messages.saved"),"success"),n?.(),e()):s(r("messages.error"),"error")},g=()=>{f.isPending||e()};return u.jsx("dialog",{ref:i,className:"fixed inset-0 m-auto w-full max-w-sm p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:m=>{m.target===i.current&&g()},onKeyDown:m=>{m.key==="Escape"&&g()},children:u.jsxs("form",{onSubmit:p,className:"flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r("modal.createTitle")}),u.jsx("button",{type:"button",onClick:g,disabled:f.isPending,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"p-4",children:[u.jsx("label",{htmlFor:"schedule-title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("modal.scheduleName")}),u.jsx("input",{ref:o,id:"schedule-title",type:"text",value:l,onChange:m=>d(m.target.value),disabled:f.isPending,placeholder:r("editor.titlePlaceholder"),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white disabled:opacity-50",autoComplete:"off"})]}),u.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:g,disabled:f.isPending,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50",children:r("modal.cancel")}),u.jsxs("button",{type:"submit",disabled:!l.trim()||f.isPending,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors disabled:opacity-50",children:[f.isPending&&u.jsx(Qe,{size:16,className:"animate-spin"}),r("modal.create")]})]})]})})}function GV({schedule:t,onClick:e}){const{t:n,i18n:r}=ke("schedules"),s=i=>new Date(i).toLocaleDateString(r.language,{year:"numeric",month:"short",day:"numeric"});return u.jsxs("button",{type:"button",onClick:e,className:"w-full flex items-center justify-between p-4 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:border-indigo-300 dark:hover:border-indigo-600 hover:shadow-sm transition-all text-left group",children:[u.jsxs("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[u.jsx("div",{className:"p-2 bg-indigo-50 dark:bg-indigo-900/30 rounded-lg flex-shrink-0",children:u.jsx(zp,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.title}),t.description&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-0.5 line-clamp-1",children:t.description}),u.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(Vj,{className:"w-3 h-3 text-gray-400"}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:n("itemCount",{count:t.itemCount})})]}),t.createdAt&&u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(Pp,{className:"w-3 h-3 text-gray-400"}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s(t.createdAt)})]})]}),t.matchedContent&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-1",dangerouslySetInnerHTML:{__html:t.matchedContent}})]})]}),u.jsx(As,{className:"w-5 h-5 text-gray-400 group-hover:text-indigo-500 transition-colors flex-shrink-0 ml-2"})]})}function e1({onScheduleClick:t}){const{t:e}=ke("schedules"),[n,r]=C.useState(""),{data:s,isLoading:i}=KV(),{data:o,isLoading:l}=QV(n),d=n.length>0,f=d?l:i,p=C.useMemo(()=>d&&o?o.map(g=>({id:g.id,title:g.title,description:g.description,itemCount:g.itemCount,matchedContent:g.matchedContent})):[...s??[]].sort((g,m)=>m.createdAt-g.createdAt).map(g=>({id:g.id,title:g.title,description:g.description,itemCount:g.itemCount,createdAt:g.createdAt})),[d,o,s]);return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Zl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",value:n,onChange:g=>r(g.target.value),placeholder:e("search.placeholder"),className:"w-full pl-10 pr-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors"})]}),f?u.jsx("div",{className:"grid gap-3",children:[1,2,3].map(g=>u.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"},g))}):p.length===0?u.jsxs("div",{className:"text-center py-12 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx(zp,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:d?e("search.noResults",{query:n}):e("noSchedules")}),!d&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:e("noSchedulesDescription")})]}):u.jsxs("div",{className:"grid gap-3",children:[d&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e("search.resultsCount",{count:p.length})}),p.map(g=>u.jsx(GV,{schedule:g,onClick:()=>t(g.id)},g.id))]})]})}function t1({isOpen:t,songId:e,onClose:n,onAdded:r}){const{t:s}=ke("schedules"),{showToast:i}=mt(),o=C.useRef(null),l=hg(),[d,f]=C.useState(!1);C.useEffect(()=>{t?o.current?.showModal():o.current?.close()},[t]),C.useEffect(()=>{const y=o.current;if(!y)return;const b=v=>{v.preventDefault(),l.isPending||n()};return y.addEventListener("cancel",b),()=>y.removeEventListener("cancel",b)},[n,l.isPending]);const p=async y=>{(await l.mutateAsync({scheduleId:y,input:{songId:e}})).success?(i(s("messages.itemAdded"),"success"),r?.(y),n()):i(s("messages.error"),"error")},g=()=>{f(!1)},m=()=>{l.isPending||n()};return u.jsxs(u.Fragment,{children:[u.jsx("dialog",{ref:o,className:"fixed inset-0 m-auto w-full max-w-lg p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:y=>{y.target===o.current&&m()},onKeyDown:y=>{y.key==="Escape"&&m()},children:u.jsxs("div",{className:"flex flex-col max-h-[80vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s("modal.addSongTitle")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("modal.addSongDescription")})]}),u.jsx("button",{type:"button",onClick:m,disabled:l.isPending,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:l.isPending?u.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("modal.adding")})]}):u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:()=>f(!0),className:"w-full flex items-center justify-center gap-2 px-4 py-3 mb-4 text-white bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 rounded-lg transition-colors font-medium",children:[u.jsx(Xt,{size:20}),s("modal.createNew")]}),u.jsx(e1,{onScheduleClick:p})]})})]})}),u.jsx(YV,{isOpen:d,onClose:()=>f(!1),onCreated:g})]})}function XV({onAddSong:t,onAddBibleVerse:e,onAddBiblePassage:n,onAddSlide:r}){const{t:s}=ke("queue"),[i,o]=C.useState(!1),l=C.useRef(null);C.useEffect(()=>{i?l.current?.showModal():l.current?.close()},[i]);const d=p=>{o(!1),p()},f=()=>{o(!1)};return u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:()=>o(!0),className:"flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-white bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 rounded-md transition-colors",children:[u.jsx(Xt,{size:14}),s("addToQueue.button")]}),u.jsx("dialog",{ref:l,onCancel:f,onClick:p=>{p.target===l.current&&f()},className:"fixed inset-0 m-auto w-full max-w-sm p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s("addToQueue.title")}),u.jsx("button",{type:"button",onClick:f,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"p-4 space-y-2",children:[u.jsxs("button",{type:"button",onClick:()=>d(t),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center",children:u.jsx(ya,{size:20,className:"text-indigo-600 dark:text-indigo-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:s("addToQueue.searchSong")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("addToQueue.searchSongDescription")})]})]}),e&&u.jsxs("button",{type:"button",onClick:()=>d(e),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:u.jsx(Sr,{size:20,className:"text-blue-600 dark:text-blue-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:s("addToQueue.bibleVerse")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("addToQueue.bibleVerseDescription")})]})]}),n&&u.jsxs("button",{type:"button",onClick:()=>d(n),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-teal-100 dark:bg-teal-900/30 flex items-center justify-center",children:u.jsx(Lp,{size:20,className:"text-teal-600 dark:text-teal-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:s("addToQueue.biblePassage")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("addToQueue.biblePassageDescription")})]})]}),u.jsxs("button",{type:"button",onClick:()=>d(()=>r("announcement")),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center",children:u.jsx(fo,{size:20,className:"text-orange-600 dark:text-orange-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:s("addToQueue.announcement")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("addToQueue.announcementDescription")})]})]}),u.jsxs("button",{type:"button",onClick:()=>d(()=>r("versete_tineri")),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:u.jsx(fs,{size:20,className:"text-green-600 dark:text-green-400"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:s("addToQueue.verseteTineri")}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("addToQueue.verseteTineriDescription")})]})]})]})]})})]})}const JV=[{type:"announcement",icon:fo},{type:"versete_tineri",icon:fs}];function lb({isOpen:t,onClose:e,scheduleId:n,afterItemId:r,editingItem:s,initialTemplate:i,onSaved:o}){const{t:l}=ke("queue"),{showToast:d}=mt(),f=C.useRef(null),p=hg(),g=WV(),m=!!s,[y,b]=C.useState("announcement"),[v,w]=C.useState(""),S=Uv({extensions:[Zv.configure({heading:{levels:[1,2]}}),Bv.configure({types:["heading","paragraph"]})],content:"",onUpdate:({editor:R})=>{w(R.getHTML())},editorProps:{attributes:{class:"min-h-[150px] p-4 focus:outline-none bg-white dark:bg-gray-900 prose prose-sm dark:prose-invert max-w-none",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}}});C.useEffect(()=>{t?(f.current?.showModal(),s?(b(s.slideType??"announcement"),w(s.slideContent??""),S?.commands.setContent(s.slideContent??"")):(b(i??"announcement"),w(""),S?.commands.setContent(""))):f.current?.close()},[t,S,s,i]);const T=async()=>{if(!v.trim()){d(l("insertSlide.errorEmpty"),"error");return}m&&s?(await g.mutateAsync({scheduleId:n,itemId:s.id,input:{slideType:y,slideContent:v}})).success?(d(l("messages.slideUpdated"),"success"),o?.(),e()):d(l("messages.error"),"error"):(await p.mutateAsync({scheduleId:n,input:{slideType:y,slideContent:v,afterItemId:r}})).success?(d(l("messages.slideInserted"),"success"),o?.(),e()):d(l("messages.error"),"error")},j=()=>{!p.isPending&&!g.isPending&&e()},M=p.isPending||g.isPending,_=R=>{R.target===f.current&&j()};return u.jsx("dialog",{ref:f,onCancel:j,onClick:_,className:"fixed inset-0 m-auto w-full max-w-xl p-0 rounded-lg bg-white dark:bg-gray-800 backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col max-h-[80vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:l(m?"insertSlide.editTitle":"insertSlide.title")}),u.jsx("button",{type:"button",onClick:j,disabled:M,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[(m||!i)&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:l("insertSlide.selectTemplate")}),u.jsx("div",{className:"flex gap-2",children:JV.map(({type:R,icon:O})=>u.jsxs("button",{type:"button",onClick:()=>b(R),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg border transition-colors ${y===R?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300":"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[u.jsx(O,{size:18}),u.jsx("span",{className:"text-sm font-medium",children:l(`slideTemplates.${R}`)})]},R))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:l("insertSlide.content")}),u.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 dark:bg-gray-900 rounded-t-lg border border-b-0 border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:()=>S?.chain().focus().toggleBold().run(),className:`px-2 py-1 rounded text-sm font-bold ${S?.isActive("bold")?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"B"}),u.jsx("button",{type:"button",onClick:()=>S?.chain().focus().toggleItalic().run(),className:`px-2 py-1 rounded text-sm italic ${S?.isActive("italic")?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"I"}),u.jsx("div",{className:"w-px h-5 bg-gray-300 dark:bg-gray-600 mx-1"}),u.jsx("button",{type:"button",onClick:()=>S?.chain().focus().toggleHeading({level:1}).run(),className:`px-2 py-1 rounded text-sm ${S?.isActive("heading",{level:1})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"H1"}),u.jsx("button",{type:"button",onClick:()=>S?.chain().focus().toggleHeading({level:2}).run(),className:`px-2 py-1 rounded text-sm ${S?.isActive("heading",{level:2})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-800"}`,children:"H2"})]}),u.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-b-lg overflow-hidden",children:u.jsx(Fv,{editor:S})})]})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsxs("button",{type:"button",onClick:j,disabled:M,className:"flex items-center gap-2 px-4 py-2 text-white bg-gray-600 hover:bg-gray-700 dark:bg-gray-500 dark:hover:bg-gray-600 rounded-lg disabled:opacity-50 transition-colors",children:[u.jsx(nt,{size:16}),l("actions.cancel")]}),u.jsxs("button",{type:"button",onClick:T,disabled:M||!v.trim(),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors",children:[M?u.jsx(Qe,{size:16,className:"animate-spin"}):m?u.jsx(ld,{size:16}):u.jsx(Xt,{size:16}),l(m?"insertSlide.save":"insertSlide.insert")]})]})]})})}function ZV({item:t,onRemove:e,onEditSlide:n,onInsertSongAfter:r,onInsertSlideAfter:s,dragHandleProps:i}){const{t:o}=ke("queue"),[l,d]=C.useState(!1),f=C.useRef(null),p=t.slideType==="announcement",g=p?fo:fs,m=p?"bg-orange-100 dark:bg-orange-900/30":"bg-green-100 dark:bg-green-900/30",y=p?"text-orange-600 dark:text-orange-400":"text-green-600 dark:text-green-400",b=t.slideContent?.replace(/<[^>]*>/g,"").substring(0,100);return u.jsx("div",{className:"rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:u.jsxs("div",{className:"flex items-center gap-2 p-3",children:[u.jsx("div",{...i,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(cr,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsxs("button",{type:"button",onClick:n,className:"flex items-center gap-3 flex-1 min-w-0 text-left",children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${m}`,children:u.jsx(g,{size:16,className:y})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-white",children:o(`slideTemplates.${t.slideType}`)}),b&&u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:b})]})]}),u.jsxs("div",{className:"relative",ref:f,children:[u.jsx("button",{type:"button",onClick:()=>d(!l),className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(Bp,{size:16,className:"text-gray-500"})}),l&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>d(!1)}),u.jsxs("div",{className:"absolute right-0 top-full mt-1 z-20 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg py-1",children:[u.jsxs("button",{type:"button",onClick:()=>{d(!1),n()},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(to,{size:14}),o("actions.editSlide")]}),u.jsxs("button",{type:"button",onClick:()=>{d(!1),r()},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(Xt,{size:14}),o("actions.insertAfter")]}),u.jsx("hr",{className:"my-1 border-gray-200 dark:border-gray-700"}),u.jsxs("button",{type:"button",onClick:()=>{d(!1),e()},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:[u.jsx(Fn,{size:14}),o("actions.remove")]})]})]})]})]})})}function eK({item:t,onRemove:e,onEditSong:n,onInsertSongAfter:r,onInsertSlideAfter:s,dragHandleProps:i}){const{t:o}=ke("queue"),[l,d]=C.useState(!0),[f,p]=C.useState(!1),g=C.useRef(null);return u.jsxs("div",{className:"rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 p-3",children:[u.jsx("div",{...i,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(cr,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsx("button",{type:"button",onClick:()=>d(!l),className:"flex-shrink-0 p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",title:o(l?"actions.collapse":"actions.expand"),children:l?u.jsx(Ms,{size:16,className:"text-gray-500"}):u.jsx(As,{size:16,className:"text-gray-500"})}),u.jsxs("button",{type:"button",onClick:n,className:"flex items-center gap-3 flex-1 min-w-0 text-left",children:[u.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 flex items-center justify-center",children:u.jsx(ya,{size:16})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"font-medium text-sm truncate text-gray-900 dark:text-white",children:t.song?.title}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t.slides.length," slides",t.song?.categoryName&&`  ${t.song.categoryName}`]})]})]}),u.jsxs("div",{className:"relative",ref:g,children:[u.jsx("button",{type:"button",onClick:()=>p(!f),className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(Bp,{size:16,className:"text-gray-500"})}),f&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>p(!1)}),u.jsxs("div",{className:"absolute right-0 top-full mt-1 z-20 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg py-1",children:[u.jsxs("button",{type:"button",onClick:()=>{p(!1),n()},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(to,{size:14}),o("actions.editSong")]}),u.jsxs("button",{type:"button",onClick:()=>{p(!1),r()},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(Xt,{size:14}),o("actions.insertAfter")]}),u.jsx("hr",{className:"my-1 border-gray-200 dark:border-gray-700"}),u.jsxs("button",{type:"button",onClick:()=>{p(!1),e()},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:[u.jsx(Fn,{size:14}),o("actions.remove")]})]})]})]})]}),l&&t.slides.length>0&&u.jsx("div",{className:"px-3 pb-3 space-y-1.5",children:t.slides.map((m,y)=>u.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 dark:bg-gray-900/50 rounded-lg text-sm",children:[u.jsx("span",{className:"flex-shrink-0 w-5 h-5 rounded bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 text-xs flex items-center justify-center",children:y+1}),u.jsxs("span",{className:"text-gray-600 dark:text-gray-400 line-clamp-1",children:[m.content.replace(/<[^>]*>/g,"").substring(0,60),m.content.length>60?"...":""]})]},m.id))})]})}function tK({scheduleId:t,item:e,onEditSong:n,onEditSlide:r,onInsertSongAfter:s,onInsertSlideAfter:i,onRemoveItem:o}){const{showToast:l}=mt(),{t:d}=ke("schedules"),f=l5(),{attributes:p,listeners:g,setNodeRef:m,transform:y,transition:b}=wo({id:e.id}),v={transform:us.Transform.toString(y),transition:b},w=async()=>{o?o(e.id):await f.mutateAsync({scheduleId:t,itemId:e.id})&&l(d("messages.itemRemoved"),"success")};return e.itemType==="slide"?u.jsx("div",{ref:m,style:v,children:u.jsx(ZV,{item:e,onRemove:w,onEditSlide:()=>r(e),onInsertSongAfter:()=>s(e.id),onInsertSlideAfter:S=>i(e.id,S),dragHandleProps:{...p,...g}})}):u.jsx("div",{ref:m,style:v,children:u.jsx(eK,{item:e,onRemove:w,onEditSong:()=>e.songId&&n(e.songId),onInsertSongAfter:()=>s(e.id),onInsertSlideAfter:S=>i(e.id,S),dragHandleProps:{...p,...g}})})}function nK({scheduleId:t,items:e,isLoading:n,onReorder:r,onRemoveItem:s}){const{t:i}=ke("schedules"),{showToast:o}=mt(),l=c5(),d=hg(),[f,p]=C.useState(null),[g,m]=C.useState(null),[y,b]=C.useState(null),[v,w]=C.useState(null),[S,T]=C.useState("announcement"),j=mo(ar(xi),ar(yi,{coordinateGetter:So})),M=R=>{const{active:O,over:L}=R;if(L&&O.id!==L.id&&e){const A=e.findIndex(H=>H.id===O.id),F=e.findIndex(H=>H.id===L.id);if(A!==-1&&F!==-1)if(r)r(A,F);else{const H=[...e],[P]=H.splice(A,1);H.splice(F,0,P),l.mutate({scheduleId:t,input:{itemIds:H.map(B=>B.id)}})}}},_=async R=>{(await d.mutateAsync({scheduleId:t,input:{songId:R,afterItemId:v??void 0}})).success&&o(i("messages.itemAdded"),"success"),w(null)};return n?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"})}):!e||e.length===0?u.jsxs("div",{className:"text-center py-8 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx(Vj,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:i("editor.noItems")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:i("editor.addFirstItem")})]}):u.jsxs(u.Fragment,{children:[u.jsx(xo,{sensors:j,collisionDetection:yo,onDragEnd:M,children:u.jsx(vo,{items:e.map(R=>R.id),strategy:bo,children:u.jsx("div",{className:"space-y-2",children:e.map(R=>u.jsx(tK,{scheduleId:t,item:R,onEditSong:p,onEditSlide:m,onInsertSongAfter:w,onInsertSlideAfter:(O,L)=>{b(O),T(L)},onRemoveItem:s},R.id))})})}),f!==null&&u.jsx(b5,{isOpen:f!==null,songId:f,onClose:()=>p(null),onSaved:()=>{}}),y!==null&&u.jsx(lb,{isOpen:y!==null,afterItemId:y,initialTemplate:S,scheduleId:t,onClose:()=>b(null),onSaved:()=>{}}),u.jsx(pg,{isOpen:v!==null,onClose:()=>w(null),onSongSelect:_,hideAddToQueue:!0}),g!==null&&u.jsx(lb,{isOpen:g!==null,editingItem:{id:g.id,slideType:g.slideType,slideContent:g.slideContent},scheduleId:t,onClose:()=>m(null),onSaved:()=>{}})]})}function rK({scheduleId:t,onBack:e,onDeleted:n,onScheduleCreated:r}){const{t:s}=ke("schedules"),{showToast:i}=mt(),o=lr(),{data:l,isLoading:d}=VV(t??void 0),f=u5(),p=HV(),g=hg(),m=o5(),y=c5(),b=l5(),[v,w]=C.useState(""),[S,T]=C.useState(""),[j,M]=C.useState([]),[_,R]=C.useState(!1),[O,L]=C.useState(!1),[A,F]=C.useState("announcement"),[H,P]=C.useState(!1),[B,E]=C.useState(null),K=t??B,q=C.useRef(null),V=C.useRef(null);C.useEffect(()=>{l?(w(l.title),T(l.description??""),M(l.items??[])):t===null&&(w(""),T(""),M([]),V.current?.focus())},[l,t]),C.useEffect(()=>{H?q.current?.showModal():q.current?.close()},[H]);const ie=me=>{w(me)},Y=me=>{T(me)},X=C.useCallback(async(me,Se)=>{if(!me.trim())return null;const Oe=await f.mutateAsync({id:K??void 0,title:me.trim(),description:Se.trim()||null});if(Oe.success&&Oe.data){const He=Oe.data.id;return t===null&&He&&(E(He),r?.(He)),He}return null},[K,t,f,r]);C.useEffect(()=>{if(!v.trim())return;const me=setTimeout(()=>{X(v,S)},500);return()=>clearTimeout(me)},[v,S,X]);const D=async()=>{if(!K)return;(await p.mutateAsync(K)).success?(i(s("messages.deleted"),"success"),P(!1),n?.(),e()):i(s("messages.error"),"error")},U=async()=>K!==null?K:await X(v,S),te=async()=>{await U()!==null&&R(!0)},Z=async me=>{await U()!==null&&(F(me),L(!0))},re=async me=>{const Se=K;if(!Se)return;(await g.mutateAsync({scheduleId:Se,input:{songId:me}})).success&&i(s("messages.itemAdded"),"success")},se=async(me,Se)=>{if(!K)return;const Oe=[...j],[He]=Oe.splice(me,1);Oe.splice(Se,0,He),M(Oe),await y.mutateAsync({scheduleId:K,input:{itemIds:Oe.map(ut=>ut.id)}})},ge=async me=>{K&&(M(Se=>Se.filter(Oe=>Oe.id!==me)),await b.mutateAsync({scheduleId:K,itemId:me}))},be=async()=>{if(!K)return;await m.mutateAsync(K)?(i(s("messages.importedToQueue"),"success"),o({to:"/present"})):i(s("messages.error"),"error")};return d&&t!==null?u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600"})}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("button",{type:"button",onClick:e,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 dark:bg-gray-500 dark:hover:bg-gray-600 rounded-lg transition-colors",children:[u.jsx(id,{size:16}),s("actions.back")]}),u.jsx("div",{className:"flex items-center gap-2",children:K!==null&&u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:be,disabled:m.isPending,className:"flex items-center gap-2 px-3 py-1.5 text-sm text-white bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 rounded-lg transition-colors disabled:opacity-50",children:[m.isPending?u.jsx(Qe,{size:16,className:"animate-spin"}):u.jsx(xD,{size:16}),s("actions.importToQueue")]}),u.jsx("button",{type:"button",onClick:()=>P(!0),className:"p-2 text-white bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 rounded-lg transition-colors",children:u.jsx(Fn,{size:16})})]})})]}),u.jsxs("div",{className:"space-y-3 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsx("input",{ref:V,type:"text",value:v,onChange:me=>ie(me.target.value),placeholder:s("editor.titlePlaceholder"),className:"w-full px-0 py-1 text-xl font-semibold bg-transparent border-0 border-b-2 border-transparent focus:border-indigo-500 focus:ring-0 text-gray-900 dark:text-white placeholder-gray-400 transition-colors"}),u.jsx("textarea",{value:S,onChange:me=>Y(me.target.value),placeholder:s("editor.descriptionPlaceholder"),rows:2,className:"w-full px-0 py-1 bg-transparent border-0 resize-none focus:ring-0 text-gray-600 dark:text-gray-400 placeholder-gray-400"})]}),u.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:s("editor.items")}),u.jsx(XV,{onAddSong:te,onAddSlide:Z})]}),K!==null?u.jsx(nK,{scheduleId:K,items:j,isLoading:d,onReorder:se,onRemoveItem:ge}):u.jsxs("div",{className:"text-center py-8 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:s("editor.noItems")}),u.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:s("editor.addFirstItem")})]})]}),u.jsx(pg,{isOpen:_,onClose:()=>R(!1),onSongSelect:re,hideAddToQueue:!0}),K!==null&&u.jsx(lb,{isOpen:O,onClose:()=>L(!1),scheduleId:K,initialTemplate:A}),u.jsx("dialog",{ref:q,onCancel:()=>P(!1),onClick:me=>{me.target===q.current&&P(!1)},className:"fixed inset-0 m-auto w-full max-w-sm p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",children:u.jsxs("div",{className:"p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:s("modal.deleteTitle")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:s("modal.deleteMessage")}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsxs("button",{type:"button",onClick:()=>P(!1),className:"flex items-center gap-2 px-4 py-2 text-white bg-gray-600 hover:bg-gray-700 dark:bg-gray-500 dark:hover:bg-gray-600 rounded-lg transition-colors",children:[u.jsx(nt,{size:16}),s("actions.cancel",{ns:"common"})]}),u.jsxs("button",{type:"button",onClick:D,disabled:p.isPending,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors",children:[p.isPending?u.jsx(Qe,{size:16,className:"animate-spin"}):u.jsx(Fn,{size:16}),s("actions.delete")]})]})]})})]})}function sK({isOpen:t,onClose:e,onImported:n}){const{t:r}=ke(["schedules","queue"]),{showToast:s}=mt(),i=C.useRef(null),o=o5();C.useEffect(()=>{t?i.current?.showModal():i.current?.close()},[t]),C.useEffect(()=>{const f=i.current;if(!f)return;const p=g=>{g.preventDefault(),o.isPending||e()};return f.addEventListener("cancel",p),()=>f.removeEventListener("cancel",p)},[e,o.isPending]);const l=async f=>{await o.mutateAsync(f)?(s(r("schedules:messages.importedToQueue"),"success"),n?.(),e()):s(r("schedules:messages.error"),"error")},d=()=>{o.isPending||e()};return u.jsx("dialog",{ref:i,className:"fixed inset-0 m-auto w-full max-w-lg p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:f=>{f.target===i.current&&d()},onKeyDown:f=>{f.key==="Escape"&&d()},children:u.jsxs("div",{className:"flex flex-col max-h-[80vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r("queue:importSchedule.title")}),u.jsx("button",{type:"button",onClick:d,disabled:o.isPending,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o.isPending?u.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:r("queue:importSchedule.importing")})]}):u.jsx(e1,{onScheduleClick:l})})]})})}const iK={announcement:fo,versete_tineri:fs};function aK(t){return new DOMParser().parseFromString(t,"text/html").body.textContent||""}function oK({item:t,isActive:e,onRemove:n,onClick:r,onEditSlide:s,onInsertSongAfter:i,onInsertBibleVerseAfter:o,onInsertBiblePassageAfter:l,onInsertSlideAfter:d,dragHandleProps:f}){const{t:p}=ke("queue"),g=C.useRef(null),m=t.slideType?iK[t.slideType]:fs,y=t.slideContent?aK(t.slideContent):"",b=v=>{v.preventDefault(),g.current?.openMenu()};return u.jsx("div",{className:`rounded-lg border transition-all ${e?"border-indigo-400 bg-indigo-50/50 dark:bg-indigo-900/10":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"}`,children:u.jsxs("div",{className:"flex items-center gap-2 p-3",onContextMenu:b,children:[u.jsx("div",{...f,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(cr,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsxs("button",{type:"button",onClick:r,className:"flex-1 flex items-center gap-3 min-w-0 text-left",children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${e?"bg-indigo-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:u.jsx(m,{size:16})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:`font-medium text-sm ${e?"text-indigo-900 dark:text-indigo-100":"text-gray-900 dark:text-white"}`,children:t.slideType&&p(`slideTemplates.${t.slideType}`)}),y&&u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:y})]})]}),u.jsx(xd,{ref:g,onEditSlide:s,onInsertSongAfter:i,onInsertBibleVerseAfter:o,onInsertBiblePassageAfter:l,onInsertSlideAfter:d,onRemove:n})]})})}function lK({slide:t,slideIndex:e,isActive:n,onClick:r}){const s=C.useRef(null);nv(s,n);const i=t.content.replace(/<[^>]*>/g," ").replace(/\s+/g," ").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&#(\d+);/g,(o,l)=>String.fromCharCode(l)).replace(/&#x([0-9a-fA-F]+);/g,(o,l)=>String.fromCharCode(parseInt(l,16))).trim()||"Empty slide";return u.jsx("button",{ref:s,type:"button",onClick:r,className:`w-full text-left p-2 pl-10 rounded-lg border transition-all ${n?"border-indigo-600 bg-indigo-50 dark:bg-indigo-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 bg-white dark:bg-gray-800"}`,children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium ${n?"bg-indigo-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:e+1}),u.jsx("div",{className:`flex-1 min-w-0 text-sm line-clamp-1 ${n?"text-indigo-900 dark:text-indigo-100":"text-gray-700 dark:text-gray-300"}`,children:i})]})})}function cK({item:t,isExpanded:e,activeSlideId:n,activeQueueItemId:r,onToggleExpand:s,onRemove:i,onSlideClick:o,onSongClick:l,onEditSong:d,onAddToSchedule:f,onInsertSongAfter:p,onInsertBibleVerseAfter:g,onInsertBiblePassageAfter:m,onInsertSlideAfter:y,dragHandleProps:b}){const{t:v}=ke("queue"),w=C.useRef(null),S=t.id===r,T=S&&t.slides.some(M=>M.id===n),j=M=>{M.preventDefault(),w.current?.openMenu()};return u.jsxs("div",{className:`rounded-lg border transition-all ${T?"border-indigo-400 bg-indigo-50/50 dark:bg-indigo-900/10":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"}`,children:[u.jsxs("div",{className:"flex items-center gap-2 p-3",onContextMenu:j,children:[u.jsx("div",{...b,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(cr,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsx("button",{type:"button",onClick:s,className:"flex-shrink-0 p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",title:v(e?"actions.collapse":"actions.expand"),children:e?u.jsx(Ms,{size:16,className:"text-gray-500"}):u.jsx(As,{size:16,className:"text-gray-500"})}),u.jsxs("button",{type:"button",onClick:l,className:"flex items-center gap-3 flex-1 min-w-0 text-left",children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${T?"bg-indigo-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:u.jsx(ya,{size:16})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:`font-medium text-sm truncate ${T?"text-indigo-900 dark:text-indigo-100":"text-gray-900 dark:text-white"}`,children:t.song?.title}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t.slides.length," slides",t.song?.categoryName&&`  ${t.song.categoryName}`]})]})]}),u.jsx(xd,{ref:w,onEditSong:d,onAddToSchedule:f,onInsertSongAfter:p,onInsertBibleVerseAfter:g,onInsertBiblePassageAfter:m,onInsertSlideAfter:y,onRemove:i})]}),e&&t.slides.length>0&&u.jsx("div",{className:"px-3 pb-3 space-y-1.5",children:t.slides.map((M,_)=>u.jsx(lK,{slide:M,slideIndex:_,isActive:S&&M.id===n,onClick:()=>o(M.id)},M.id))})]})}function uK({entry:t,entryIndex:e,isActive:n,onClick:r}){const s=C.useRef(null);nv(s,n);const i=t.text.length>80?`${t.text.slice(0,80)}...`:t.text;return u.jsx("button",{ref:s,type:"button",onClick:r,className:`w-full text-left p-2 pl-10 rounded-lg border transition-all ${n?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 bg-white dark:bg-gray-800"}`,children:u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium ${n?"bg-purple-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:e+1}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:`text-xs font-medium mb-0.5 ${n?"text-purple-700 dark:text-purple-300":"text-gray-500 dark:text-gray-400"}`,children:t.reference}),u.jsx("div",{className:`text-sm line-clamp-2 ${n?"text-purple-900 dark:text-purple-100":"text-gray-700 dark:text-gray-300"}`,children:i}),u.jsx("div",{className:`text-xs mt-1 italic ${n?"text-purple-600 dark:text-purple-400":"text-gray-400 dark:text-gray-500"}`,children:t.personName})]})]})})}function dK({item:t,isExpanded:e,activeEntryId:n,activeQueueItemId:r,onToggleExpand:s,onRemove:i,onEntryClick:o,onItemClick:l,onInsertSongAfter:d,onInsertBibleVerseAfter:f,onInsertBiblePassageAfter:p,onInsertSlideAfter:g,dragHandleProps:m}){const{t:y}=ke("queue"),b=C.useRef(null),v=t.id===r,w=v&&t.verseteTineriEntries.some(T=>T.id===n),S=T=>{T.preventDefault(),b.current?.openMenu()};return u.jsxs("div",{className:`rounded-lg border transition-all ${w?"border-purple-400 bg-purple-50/50 dark:bg-purple-900/10":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"}`,children:[u.jsxs("div",{className:"flex items-center gap-2 p-3",onContextMenu:S,children:[u.jsx("div",{...m,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(cr,{size:16,className:"text-gray-400 dark:text-gray-500"})}),u.jsx("button",{type:"button",onClick:s,className:"flex-shrink-0 p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",title:y(e?"actions.collapse":"actions.expand"),children:e?u.jsx(Ms,{size:16,className:"text-gray-500"}):u.jsx(As,{size:16,className:"text-gray-500"})}),u.jsxs("button",{type:"button",onClick:l,className:"flex items-center gap-3 flex-1 min-w-0 text-left",children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${w?"bg-purple-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:u.jsx($l,{size:16})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("span",{className:`font-medium text-sm truncate ${w?"text-purple-900 dark:text-purple-100":"text-gray-900 dark:text-white"}`,children:y("slideTemplates.versete_tineri")})}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:y("verseteTineri.entriesCount",{count:t.verseteTineriEntries.length})})]})]}),u.jsx(xd,{ref:b,onInsertSongAfter:d,onInsertBibleVerseAfter:f,onInsertBiblePassageAfter:p,onInsertSlideAfter:g,onRemove:i})]}),e&&t.verseteTineriEntries.length>0&&u.jsx("div",{className:"px-3 pb-3 space-y-1.5",children:t.verseteTineriEntries.map((T,j)=>u.jsx(uK,{entry:T,entryIndex:j,isActive:v&&T.id===n,onClick:()=>o(T.id)},T.id))})]})}function fK({item:t,activeSlideId:e,activeVerseId:n,activeEntryId:r,activeQueueItemId:s,onSlideClick:i,onVerseClick:o,onEntryClick:l,onSongClick:d,onPassageClick:f,onVerseteTineriClick:p,onEditSong:g,onEditSlide:m,onAddToSchedule:y,onInsertSongAfter:b,onInsertBibleVerseAfter:v,onInsertBiblePassageAfter:w,onInsertSlideAfter:S,onStandaloneSlideClick:T}){const{showToast:j}=mt(),{t:M}=ke("queue"),_=D8(),R=a3(),{attributes:O,listeners:L,setNodeRef:A,transform:F,transition:H}=wo({id:t.id}),P={transform:us.Transform.toString(F),transition:H},B=()=>{R.mutate({id:t.id,expanded:!t.isExpanded})},E=async()=>{await _.mutateAsync(t.id)&&j(M("messages.removed"),"success")};if(t.itemType==="slide"&&t.slideType==="versete_tineri")return u.jsx("div",{ref:A,style:P,children:u.jsx(dK,{item:t,isExpanded:t.isExpanded,activeEntryId:r,activeQueueItemId:s,onToggleExpand:B,onRemove:E,onEntryClick:l,onItemClick:p,onInsertSongAfter:()=>b(t.id),onInsertBibleVerseAfter:v?()=>v(t.id):void 0,onInsertBiblePassageAfter:w?()=>w(t.id):void 0,onInsertSlideAfter:K=>S(t.id,K),dragHandleProps:{...O,...L}})});if(t.itemType==="slide"){const K=t.id===s&&e===null;return u.jsx("div",{ref:A,style:P,children:u.jsx(oK,{item:t,isActive:K,onRemove:E,onClick:T,onEditSlide:()=>m(t),onInsertSongAfter:()=>b(t.id),onInsertBibleVerseAfter:v?()=>v(t.id):void 0,onInsertBiblePassageAfter:w?()=>w(t.id):void 0,onInsertSlideAfter:q=>S(t.id,q),dragHandleProps:{...O,...L}})})}if(t.itemType==="bible"){const K=t.id===s&&e===null;return u.jsx("div",{ref:A,style:P,children:u.jsx(RV,{item:t,isActive:K,onRemove:E,onClick:T,onInsertSongAfter:()=>b(t.id),onInsertBibleVerseAfter:v?()=>v(t.id):void 0,onInsertBiblePassageAfter:w?()=>w(t.id):void 0,onInsertSlideAfter:q=>S(t.id,q),dragHandleProps:{...O,...L}})})}return t.itemType==="bible_passage"?u.jsx("div",{ref:A,style:P,children:u.jsx(OV,{item:t,isExpanded:t.isExpanded,activeVerseId:n,activeQueueItemId:s,onToggleExpand:B,onRemove:E,onVerseClick:o,onPassageClick:f,onInsertSongAfter:()=>b(t.id),onInsertBibleVerseAfter:v?()=>v(t.id):void 0,onInsertBiblePassageAfter:w?()=>w(t.id):void 0,onInsertSlideAfter:K=>S(t.id,K),dragHandleProps:{...O,...L}})}):u.jsx("div",{ref:A,style:P,children:u.jsx(cK,{item:t,isExpanded:t.isExpanded,activeSlideId:e,activeQueueItemId:s,onToggleExpand:B,onRemove:E,onSlideClick:i,onSongClick:d,onEditSong:()=>t.songId&&g(t.songId),onAddToSchedule:t.songId?()=>y(t.songId):void 0,onInsertSongAfter:()=>b(t.id),onInsertBibleVerseAfter:v?()=>v(t.id):void 0,onInsertBiblePassageAfter:w?()=>w(t.id):void 0,onInsertSlideAfter:K=>S(t.id,K),dragHandleProps:{...O,...L}})})}function hK({activeSlideId:t,activeVerseId:e,activeEntryId:n,activeQueueItemId:r,onSlideClick:s,onVerseClick:i,onEntryClick:o,hideHeader:l=!1}){const{t:d}=ke("queue"),{showToast:f}=mt(),{data:p,isLoading:g}=Qp(),m=L8(),y=i3(),b=a3(),[v,w]=C.useState(!1),[S,T]=C.useState(null),[j,M]=C.useState(null),[_,R]=C.useState(null),[O,L]=C.useState(null),[A,F]=C.useState(null),[H,P]=C.useState("announcement"),[B,E]=C.useState(null);C.useEffect(()=>{if(t&&p){const se=p.find(ge=>ge.itemType==="song"&&ge.slides.some(be=>be.id===t));se&&!se.isExpanded&&b.mutate({id:se.id,expanded:!0})}},[t,p,b]);const K=mo(ar(xi),ar(yi,{coordinateGetter:So})),q=se=>{const{active:ge,over:be}=se;if(be&&ge.id!==be.id&&p){const me=p.findIndex(Oe=>Oe.id===ge.id),Se=p.findIndex(Oe=>Oe.id===be.id);if(me!==-1&&Se!==-1){const Oe=[...p],[He]=Oe.splice(me,1);Oe.splice(Se,0,He),m.mutate({itemIds:Oe.map(ut=>ut.id)})}}},V=(se,ge)=>{const be=p?.find(me=>me.id===se);be&&!be.isExpanded&&b.mutate({id:se,expanded:!0}),s(se,ge)},ie=se=>{s(se,-1)},Y=se=>{se.isExpanded||b.mutate({id:se.id,expanded:!0}),se.slides.length>0&&s(se.id,se.slides[0].id)},X=(se,ge)=>{const be=p?.find(me=>me.id===se);be&&!be.isExpanded&&b.mutate({id:se,expanded:!0}),i(se,ge)},D=se=>{se.isExpanded||b.mutate({id:se.id,expanded:!0}),se.biblePassageVerses&&se.biblePassageVerses.length>0&&i(se.id,se.biblePassageVerses[0].id)},U=(se,ge)=>{const be=p?.find(me=>me.id===se);be&&!be.isExpanded&&b.mutate({id:se,expanded:!0}),o(se,ge)},te=se=>{se.isExpanded||b.mutate({id:se.id,expanded:!0}),se.verseteTineriEntries&&se.verseteTineriEntries.length>0&&o(se.id,se.verseteTineriEntries[0].id)},Z=async()=>{w(!1),await y.mutateAsync()&&f(d("messages.cleared"),"success")};if(g)return u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"})});if(!p||p.length===0)return u.jsxs("div",{className:"text-center py-8",children:[u.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:d("empty")}),u.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:d("emptyDescription")})]});const re=p.length;return u.jsxs(u.Fragment,{children:[!l&&u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:d("itemCount",{count:re})}),u.jsxs("button",{type:"button",onClick:()=>w(!0),className:"flex items-center gap-1.5 px-2 py-1 text-xs text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",children:[u.jsx(Fn,{size:14}),d("actions.clear")]})]}),u.jsx(xo,{sensors:K,collisionDetection:yo,onDragEnd:q,children:u.jsx(vo,{items:p.map(se=>se.id),strategy:bo,children:u.jsx("div",{className:"space-y-2",children:p.map(se=>u.jsx(fK,{item:se,activeSlideId:t,activeVerseId:e,activeEntryId:n,activeQueueItemId:r,onSlideClick:ge=>V(se.id,ge),onVerseClick:ge=>X(se.id,ge),onEntryClick:ge=>U(se.id,ge),onSongClick:()=>Y(se),onPassageClick:()=>D(se),onVerseteTineriClick:()=>te(se),onEditSong:T,onEditSlide:M,onAddToSchedule:E,onInsertSongAfter:L,onInsertBiblePassageAfter:F,onInsertSlideAfter:(ge,be)=>{R(ge),P(be)},onStandaloneSlideClick:()=>ie(se.id)},se.id))})})}),u.jsx(fi,{isOpen:v,title:d("confirmClear.title"),message:d("confirmClear.message"),confirmLabel:d("actions.clear"),onConfirm:Z,onCancel:()=>w(!1),variant:"danger"}),S!==null&&u.jsx(b5,{isOpen:S!==null,songId:S,onClose:()=>T(null),onSaved:()=>{}}),_!==null&&u.jsx(ob,{isOpen:_!==null,afterItemId:_,initialTemplate:H,onClose:()=>R(null),onSaved:()=>{}}),u.jsx(pg,{isOpen:O!==null,afterItemId:O??void 0,onClose:()=>L(null)}),u.jsx(l3,{isOpen:A!==null,afterItemId:A??void 0,onClose:()=>F(null)}),j!==null&&u.jsx(ob,{isOpen:j!==null,editingItem:j,onClose:()=>M(null),onSaved:()=>{}}),B!==null&&u.jsx(t1,{isOpen:B!==null,songId:B,onClose:()=>E(null)})]})}function pK({isOpen:t,onClose:e,onSaved:n}){const{t:r}=ke("queue"),{showToast:s}=mt(),i=C.useRef(null),o=C.useRef(null),[l,d]=C.useState(""),f=z8();C.useEffect(()=>{t?(i.current?.showModal(),setTimeout(()=>o.current?.focus(),100)):(i.current?.close(),d(""))},[t]),C.useEffect(()=>{const m=i.current;if(!m)return;const y=b=>{b.preventDefault(),f.isPending||e()};return m.addEventListener("cancel",y),()=>m.removeEventListener("cancel",y)},[e,f.isPending]);const p=async m=>{if(m.preventDefault(),!l.trim())return;const y=await f.mutateAsync(l.trim());y.success&&y.data?(s(r("messages.savedAsProgram"),"success"),n?.(y.data.scheduleId),e()):s(r("messages.error"),"error")},g=()=>{f.isPending||e()};return u.jsx("dialog",{ref:i,className:"fixed inset-0 m-auto w-full max-w-sm p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:m=>{m.target===i.current&&g()},onKeyDown:m=>{m.key==="Escape"&&g()},children:u.jsxs("form",{onSubmit:p,className:"flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r("saveAsProgram.title")}),u.jsx("button",{type:"button",onClick:g,disabled:f.isPending,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"p-4",children:[u.jsx("label",{htmlFor:"program-title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("saveAsProgram.nameLabel")}),u.jsx("input",{ref:o,id:"program-title",type:"text",value:l,onChange:m=>d(m.target.value),disabled:f.isPending,placeholder:r("saveAsProgram.namePlaceholder"),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white disabled:opacity-50",autoComplete:"off"})]}),u.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:g,disabled:f.isPending,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50",children:r("saveAsProgram.cancel")}),u.jsxs("button",{type:"submit",disabled:!l.trim()||f.isPending,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors disabled:opacity-50",children:[f.isPending&&u.jsx(Qe,{size:16,className:"animate-spin"}),r("saveAsProgram.save")]})]})]})})}const gK={linear:"linear",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",bounce:"cubic-bezier(0.68, -0.55, 0.265, 1.55)"};function oh({children:t,animationIn:e,animationOut:n,isVisible:r,className:s="",style:i={}}){const[o,l]=C.useState(r),[d,f]=C.useState("idle");if(C.useEffect(()=>{if(r)l(!0),f("in");else if(o){f("out");const w=n?.duration||300;setTimeout(()=>{l(!1),f("idle")},w)}},[r,n?.duration,o]),!o)return null;const p=d==="in"?e:n,g=p?.type||"none",m=p?.duration||300,y=p?.delay||0,b=p?.easing||"easeOut",v=()=>{if(g==="none"||d==="idle")return{opacity:r?1:0};const w=gK[b]||"ease-out",S=`all ${m}ms ${w} ${y}ms`,T=d==="in",j={};switch(g){case"fade":j.opacity=T?1:0;break;case"slide-up":j.transform=T?"translateY(0)":"translateY(-20px)",j.opacity=T?1:0;break;case"slide-down":j.transform=T?"translateY(0)":"translateY(20px)",j.opacity=T?1:0;break;case"slide-left":j.transform=T?"translateX(0)":"translateX(-20px)",j.opacity=T?1:0;break;case"slide-right":j.transform=T?"translateX(0)":"translateX(20px)",j.opacity=T?1:0;break;case"zoom":j.transform=T?"scale(1)":"scale(0.8)",j.opacity=T?1:0;break;case"blur":j.filter=T?"blur(0)":"blur(10px)",j.opacity=T?1:0;break}return{transition:S,...j}};return u.jsx("div",{className:s,style:{...i,...v()},children:t})}const d5=20;function mK(t){const{measureElement:e,text:n,maxWidth:r,maxHeight:s,minFontSize:i,maxFontSize:o,lineHeight:l}=t,d=1,f=e.style.fontSize,p=e.style.whiteSpace,g=e.style.wordWrap,m=e.style.width,y=e.style.height,b=e.style.lineHeight,v=e.style.overflow,w=e.textContent;try{if(e.style.whiteSpace="pre-wrap",e.style.wordWrap="break-word",e.style.width=`${r}px`,e.style.height="auto",e.style.lineHeight=`${l}`,e.style.overflow="visible",e.textContent=n,e.style.fontSize=`${i}px`,e.scrollHeight>s)return{fontSize:i,fits:!1};if(e.style.fontSize=`${o}px`,e.scrollHeight<=s)return{fontSize:o,fits:!0};let S=i,T=o,j=0;for(;T-S>d&&j<d5;){j++;const M=Math.floor((S+T)/2);e.style.fontSize=`${M}px`,e.scrollHeight<=s?S=M:T=M}return{fontSize:S,fits:!0}}finally{e.style.fontSize=f,e.style.whiteSpace=p,e.style.wordWrap=g,e.style.width=m,e.style.height=y,e.style.lineHeight=b,e.style.overflow=v,e.textContent=w}}function yK(t){const{measureElement:e,text:n,maxWidth:r,minFontSize:s,maxFontSize:i,lineHeight:o}=t,l=1,d=n.split(`
`).filter(T=>T.trim()!=="");if(d.length===0)return{fontSize:i,fits:!0};const f=e.style.fontSize,p=e.style.whiteSpace,g=e.style.width,m=e.style.height,y=e.style.lineHeight,b=e.textContent,v=e.style.display,w=e.style.position,S=e.style.visibility;try{e.style.display="inline-block",e.style.position="absolute",e.style.visibility="hidden",e.style.whiteSpace="nowrap",e.style.width="auto",e.style.height="auto",e.style.lineHeight=`${o}`;let T=i;for(const j of d){if(e.textContent=j,e.style.fontSize=`${i}px`,e.scrollWidth<=r)continue;let _=s,R=i,O=0;for(;R-_>l&&O<d5;){O++;const L=Math.floor((_+R)/2);e.style.fontSize=`${L}px`,e.scrollWidth<=r?_=L:R=L}T=Math.min(T,_)}return{fontSize:Math.max(T,s),fits:!0}}finally{e.style.fontSize=f,e.style.whiteSpace=p,e.style.width=g,e.style.height=m,e.style.lineHeight=y,e.style.display=v,e.style.position=w,e.style.visibility=S,e.textContent=b}}function is(t,e,n){return e==="%"?t/100*n:t}function xK(t,e){return e===0?0:t/e*100}function ky(t,e,n,r){return e===n?t:e==="%"?is(t,"%",r):xK(t,r)}function xl(t){return Math.round(t*10)/10}function Va(t){return{fontFamily:t.fontFamily,color:t.color,fontWeight:t.bold?"bold":"normal",fontStyle:t.italic?"italic":"normal",textDecoration:t.underline?"underline":"none",textAlign:t.alignment,lineHeight:t.lineHeight,textShadow:t.shadow?"2px 2px 4px rgba(0,0,0,0.5)":"none"}}function ed(t){switch(t.type){case"transparent":return{backgroundColor:"transparent"};case"color":return{backgroundColor:t.color||"#000000",opacity:t.opacity??1};case"image":return{backgroundImage:t.imageUrl?`url(${t.imageUrl})`:"none",backgroundSize:"cover",backgroundPosition:"center",opacity:t.opacity??1};case"video":return{backgroundColor:"transparent"};default:return{backgroundColor:"#000000"}}}function bK(){return{top:{enabled:!0,value:0,unit:"%"},bottom:{enabled:!1,value:0,unit:"%"},left:{enabled:!0,value:0,unit:"%"},right:{enabled:!1,value:0,unit:"%"}}}function vK(){return{width:100,widthUnit:"%",height:100,heightUnit:"%"}}function Yr(t,e,n,r){const s=t??bK(),i=e??vK(),o=s.left.enabled?is(s.left.value,s.left.unit,n):0,l=s.right.enabled?is(s.right.value,s.right.unit,n):0;let d,f;s.left.enabled&&s.right.enabled?(d=o,f=n-o-l):s.left.enabled?(d=o,f=is(i.width,i.widthUnit,n)):s.right.enabled?(f=is(i.width,i.widthUnit,n),d=n-l-f):(d=0,f=is(i.width,i.widthUnit,n));const p=s.top.enabled?is(s.top.value,s.top.unit,r):0,g=s.bottom.enabled?is(s.bottom.value,s.bottom.unit,r):0;let m,y;return s.top.enabled&&s.bottom.enabled?(m=p,y=r-p-g):s.top.enabled?(m=p,y=is(i.height,i.heightUnit,r)):s.bottom.enabled?(y=is(i.height,i.heightUnit,r),m=r-g-y):(m=0,y=is(i.height,i.heightUnit,r)),{x:d,y:m,width:f,height:y}}const aT={space:"  ",dash:"  ",pipe:" | "};function wK(t){return aT[t]??aT.space}function f5(t,e){const n=t.split(`
`).filter(i=>i.trim()!=="");if(n.length<=1)return t.trim();const r=wK(e),s=[];for(let i=0;i<n.length;i+=2){const o=n[i].trim(),l=n[i+1]?.trim();l?s.push(`${o}${r}${l}`):s.push(o)}return s.join(`
`)}function fu(t){return t.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&nbsp;/g," ").replace(/&#(\d+);/g,(e,n)=>String.fromCharCode(Number(n))).replace(/&#x([0-9a-fA-F]+);/g,(e,n)=>String.fromCharCode(parseInt(n,16)))}function h5(t){return t.replace(/<\/p>\s*<p[^>]*>/gi,`
`).replace(/<br\s*\/?>/gi,`
`).replace(/<(p|div|h[1-6])[^>]*>/gi,"").replace(/<\/(p|div|h[1-6])>/gi,`
`)}function SK(t){const e=h5(t),n=[],r=/<mark([^>]*)>(.*?)<\/mark>/gis;let s=0,i;for(;(i=r.exec(e))!==null;){if(i.index>s){const g=e.slice(s,i.index),m=fu(g.replace(/<[^>]*>/g,""));m&&n.push({text:m})}const o=i[1],l=i[2];let d;const f=o.match(/data-color=["']([^"']+)["']/);if(f)d=f[1];else{const g=o.match(/style=["'][^"']*background-color:\s*([^;"']+)/i);g&&(d=g[1].trim())}const p=fu(l.replace(/<[^>]*>/g,""));p&&n.push({text:p,highlightColor:d}),s=i.index+i[0].length}if(s<e.length){const o=e.slice(s),l=fu(o.replace(/<[^>]*>/g,""));l&&n.push({text:l})}if(n.length===0){const o=fu(e.replace(/<[^>]*>/g,""));o&&n.push({text:o})}return n}function kK(t){const e=h5(t);return fu(e.replace(/<[^>]*>/g,"")).replace(/\n{3,}/g,`

`).trim()}function CK(t,e){const n=t.map(l=>l.text).join(""),r=f5(n,e);if(!t.some(l=>l.highlightColor))return[{text:r}];const i=[];let o=0;for(const l of t){const d=l.text.length;let f="";for(let p=0;p<d&&o<r.length;p++){const g=l.text[p],m=r[o];g!==`
`&&g===m&&(f+=m,o++)}f&&i.push({text:f,highlightColor:l.highlightColor})}if(o<r.length){const l=r.slice(o);l&&(i.length>0?i[i.length-1].text+=l:i.push({text:l}))}return i}function NK(t){return t.length===0?null:t.some(n=>n.highlightColor)?t.map((n,r)=>n.highlightColor?u.jsx("span",{style:{backgroundColor:n.highlightColor,borderRadius:"2px",padding:"0 2px"},children:n.text},r):u.jsx("span",{children:n.text},r)):t.map(n=>n.text).join("")}function ii({content:t,style:e,containerWidth:n,containerHeight:r,isHtml:s=!1}){const i=C.useRef(null),[o,l]=C.useState(null),d=C.useRef(t),f=C.useMemo(()=>s?kK(t):t,[t,s]),p=C.useMemo(()=>s?SK(t):[{text:t}],[t,s]),g=d.current!==t;g&&(d.current=t,o!==null&&e.autoScale&&l(null));const[m,y]=C.useState(p);C.useLayoutEffect(()=>{if(!i.current)return;const S=i.current,T=n,j=r;if(T<=0||j<=0)return;let M=f,_=p;if(e.compressLines&&(M=f5(f,e.lineSeparator??"space"),_=CK(p,e.lineSeparator??"space")),y(_),!e.autoScale){l(e.maxFontSize);return}const R=e.minFontSize??12,O=e.lineHeight??1.3,L=e.fitLineToWidth?yK({measureElement:S,text:M,maxWidth:T,minFontSize:R,maxFontSize:e.maxFontSize,lineHeight:O}):mK({measureElement:S,text:M,maxWidth:T,maxHeight:j,minFontSize:R,maxFontSize:e.maxFontSize,lineHeight:O});l(L.fontSize)},[f,p,e.autoScale,e.maxFontSize,e.minFontSize,e.compressLines,e.lineSeparator,e.fitLineToWidth,e.lineHeight,n,r]);const b=!g&&(o!==null||!e.autoScale),v=o??e.maxFontSize,w={...Va(e),fontSize:`${v}px`,width:"100%",height:"100%",display:"flex",alignItems:e.verticalAlignment==="top"?"flex-start":e.verticalAlignment==="bottom"?"flex-end":"center",justifyContent:e.alignment==="center"?"center":e.alignment==="right"?"flex-end":"flex-start",overflow:"hidden",wordWrap:e.fitLineToWidth?"normal":"break-word",whiteSpace:e.fitLineToWidth?"pre":"pre-wrap",visibility:b?"visible":"hidden"};return u.jsx("div",{ref:i,style:w,children:NK(m)})}function p5({screen:t,contentType:e,contentData:n,containerWidth:r,containerHeight:s,showClock:i=!0,isVisible:o=!0,nextSlideData:l,fillContainer:d=!1}){const f=t.contentConfigs[e],p=d?r:t.width,g=d?s:t.height,m=r/p,y=s/g,b=Math.min(m,y),v=p*b,w=g*b,S=(r-v)/2,T=(s-w)/2,j=()=>{if(!f||!("mainText"in f)||!n?.mainText)return null;const A=f.mainText;if(A.hidden)return null;const F=Yr(A.constraints,A.size,p,g),H={x:F.x*b,y:F.y*b,width:F.width*b,height:F.height*b};return u.jsx(oh,{animationIn:"animationIn"in A?A.animationIn:void 0,animationOut:"animationOut"in A?A.animationOut:void 0,isVisible:!0,style:{position:"absolute",left:H.x,top:H.y,width:H.width,height:H.height},children:u.jsx(ii,{content:n.mainText,style:{...A.style,maxFontSize:A.style.maxFontSize*b},containerWidth:H.width,containerHeight:H.height,isHtml:!0})},"mainText")},M=()=>{if(!f||!("contentText"in f)||!n?.contentText)return null;const A=f.contentText;if(A.hidden)return null;const F=Yr(A.constraints,A.size,p,g),H={x:F.x*b,y:F.y*b,width:F.width*b,height:F.height*b},E=f.includeReferenceInContent&&n.referenceText?`${n.referenceText} ${n.contentText}`:n.contentText;return u.jsx(oh,{animationIn:"animationIn"in A?A.animationIn:void 0,animationOut:"animationOut"in A?A.animationOut:void 0,isVisible:!0,style:{position:"absolute",left:H.x,top:H.y,width:H.width,height:H.height},children:u.jsx(ii,{content:E,style:{...A.style,maxFontSize:A.style.maxFontSize*b},containerWidth:H.width,containerHeight:H.height,isHtml:!1})},"contentText")},_=()=>{if(!f||!("referenceText"in f)||!n?.referenceText)return null;const A=f.referenceText;if(A.hidden||f.includeReferenceInContent)return null;const H=Yr(A.constraints,A.size,p,g),P={x:H.x*b,y:H.y*b,width:H.width*b,height:H.height*b};return u.jsx(oh,{animationIn:"animationIn"in A?A.animationIn:void 0,animationOut:"animationOut"in A?A.animationOut:void 0,isVisible:!0,style:{position:"absolute",left:P.x,top:P.y,width:P.width,height:P.height},children:u.jsx(ii,{content:n.referenceText,style:{...A.style,maxFontSize:A.style.maxFontSize*b},containerWidth:P.width,containerHeight:P.height,isHtml:!1})},"referenceText")},R=()=>{if(!f||!("personLabel"in f)||!n?.personLabel)return null;const A=f.personLabel;if(A.hidden)return null;const F=Yr(A.constraints,A.size,p,g),H={x:F.x*b,y:F.y*b,width:F.width*b,height:F.height*b};return u.jsx(oh,{animationIn:"animationIn"in A?A.animationIn:void 0,animationOut:"animationOut"in A?A.animationOut:void 0,isVisible:!0,style:{position:"absolute",left:H.x,top:H.y,width:H.width,height:H.height},children:u.jsx(ii,{content:n.personLabel,style:{...A.style,maxFontSize:A.style.maxFontSize*b},containerWidth:H.width,containerHeight:H.height,isHtml:!1})},"personLabel")},O=()=>{if(!i)return null;const A=f&&"clock"in f?f.clock:t.globalSettings.clockConfig;if(!A?.enabled||A.hidden)return null;const F=Yr(A.constraints,A.size,p,g),H=new Date,P=A.showSeconds?H.toLocaleTimeString("ro-RO",{hour12:!1}):H.toLocaleTimeString("ro-RO",{hour:"2-digit",minute:"2-digit",hour12:!1});return u.jsx("div",{className:"absolute overflow-hidden flex items-center justify-end",style:{left:F.x*b,top:F.y*b,width:F.width*b,height:F.height*b,...Va(A.style),fontSize:A.style.maxFontSize*b},children:P},"clock")},L=()=>{if(t.type!=="stage"||!t.nextSlideConfig?.enabled)return null;const A=t.nextSlideConfig;if(A.hidden)return null;const F=Yr(A.constraints,A.size,p,g),H={x:F.x*b,y:F.y*b,width:F.width*b,height:F.height*b},P=16*b;A.labelStyle.maxFontSize*b+8*b;const B=()=>{if(l?.verseteTineriSummary){const{entries:K,hasMore:q}=l.verseteTineriSummary;return u.jsxs("span",{style:{...Va(A.contentStyle),fontSize:A.contentStyle.maxFontSize*b},children:[K.map((V,ie)=>u.jsxs("span",{children:[V.personName," - ",V.reference,ie<K.length-1&&"  "]},ie)),q&&" ..."]})}const E=l?.preview||"";return E?u.jsx("span",{style:{...Va(A.contentStyle),fontSize:A.contentStyle.maxFontSize*b},dangerouslySetInnerHTML:{__html:E}}):null};return u.jsxs("div",{className:"absolute overflow-hidden",style:{left:H.x,top:H.y,width:H.width,height:H.height,padding:P,display:"flex",flexDirection:"column",...ed(A.background)},children:[u.jsx("div",{style:{...Va(A.labelStyle),fontSize:A.labelStyle.maxFontSize*b,flexShrink:0},children:A.labelText}),u.jsx("div",{style:{marginTop:8*b,flex:1,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:B()})]},"nextSlide")};return u.jsx("div",{className:"relative overflow-hidden",style:{width:r,height:s},children:u.jsxs("div",{className:"absolute",style:{left:S,top:T,width:v,height:w,position:"relative"},children:[o&&u.jsxs(u.Fragment,{children:[j(),M(),_(),R()]}),O(),L()]})})}function TK({screen:t,contentType:e,contentData:n,showClock:r=!0}){const s=C.useRef(null),[i,o]=C.useState({width:400,height:225});C.useEffect(()=>{const f=()=>{if(!s.current)return;const p=s.current.getBoundingClientRect();p.width>0&&p.height>0&&o({width:p.width,height:p.height})};if(f(),s.current){const p=new ResizeObserver(f);return p.observe(s.current),()=>p.disconnect()}},[]);const d=t.contentConfigs[e]?.background||t.contentConfigs.empty?.background;return u.jsx("div",{ref:s,className:"absolute inset-0 overflow-hidden",style:d?ed(d):{backgroundColor:"#000000"},children:u.jsx(p5,{screen:t,contentType:e,contentData:n,containerWidth:i.width,containerHeight:i.height,showClock:r,isVisible:!0})})}const jK=typeof window<"u"&&"__TAURI_INTERNALS__"in window,EK=jK&&pn()?hi:window.fetch.bind(window);function MK(){const t={"Cache-Control":"no-cache"};if(pn()){const e=Xl();e&&(t.Cookie=`user_auth=${e}`)}return t}function n1(){tc();const{data:t}=mi(),{data:e}=Wb(),n=C.useMemo(()=>e&&e.filter(p=>p.type==="primary").sort((p,g)=>p.sortOrder-g.sortOrder)[0]||null,[e]),{data:r}=Gb(n?.id??void 0),[s,i]=C.useState("empty"),[o,l]=C.useState({});C.useEffect(()=>{(async()=>{if(!t){l({}),i("empty");return}if(t.isHidden){l({}),i("empty");return}if(t.temporaryContent){const g=t.temporaryContent;if(g.type==="bible"){const m=g.data.reference.replace(/\s*-\s*[A-Z]+\s*$/,"");i("bible"),l({referenceText:m,contentText:g.data.text});return}if(g.type==="song"){const m=g.data.slides[g.data.currentSlideIndex];if(m){i("song"),l({mainText:m.content});return}}}try{const g=await EK(`${Ct()}/api/queue`,{cache:"no-store",headers:MK(),credentials:"include"});if(!g.ok){l({}),i("empty");return}const y=(await g.json()).data||[];if(t.currentSongSlideId)for(const b of y){const v=b.slides?.find(w=>w.id===t.currentSongSlideId);if(v){i("song"),l({mainText:v.content});return}}if(t.currentQueueItemId&&!t.currentSongSlideId){const b=y.find(v=>v.id===t.currentQueueItemId);if(b){if(b.itemType==="slide"){if(b.slideType==="versete_tineri"&&b.verseteTineriEntries){const v=t.currentVerseteTineriEntryId,w=v?b.verseteTineriEntries.find(S=>S.id===v):b.verseteTineriEntries[0];if(w){i("versete_tineri"),l({personLabel:w.person||"",referenceText:w.reference,contentText:w.text});return}}i("announcement"),l({mainText:b.slideContent||""});return}if(b.itemType==="bible"){const v=(b.bibleReference||"").replace(/\s*-\s*[A-Z]+\s*$/,"");i("bible"),l({referenceText:v,contentText:b.bibleText||""});return}if(b.itemType==="bible_passage"){const v=t.currentBiblePassageVerseId,w=v?b.biblePassageVerses?.find(S=>S.id===v):b.biblePassageVerses?.[0];if(w){i("bible_passage"),l({referenceText:w.reference,contentText:w.text});return}}}}l({}),i("empty")}catch{l({}),i("empty")}})()},[t?.currentSongSlideId,t?.currentQueueItemId,t?.currentBiblePassageVerseId,t?.currentVerseteTineriEntryId,t?.isHidden,t?.temporaryContent,t?.updatedAt]);const f=!(Object.keys(o).length>0)||t?.isHidden;return r?u.jsx("div",{className:"relative w-full aspect-video rounded-lg overflow-hidden shadow-lg",children:u.jsx(TK,{screen:r,contentType:s,contentData:o,showClock:f})}):u.jsx("div",{className:"relative w-full aspect-video rounded-lg overflow-hidden shadow-lg bg-gray-800 flex items-center justify-center",children:u.jsx("div",{className:"text-gray-400 text-sm",children:"Loading..."})})}function AK(){const{t}=ke(["presentation","queue"]),{showToast:e}=mt();tc(),cP();const{data:n}=mi(),{data:r}=Qp(),s=i3(),[i,o]=C.useState(!1),[l,d]=C.useState(!1),[f,p]=C.useState(!1),[g,m]=C.useState("announcement"),[y,b]=C.useState(!1),[v,w]=C.useState(!1),[S,T]=C.useState(!1),j=lr(),M=KE(),_=qp(),R=Yb(),O=vP(),L=!!n?.currentQueueItemId||!!n?.currentSongSlideId,A=async()=>{await M.mutateAsync("prev")},F=async()=>{await M.mutateAsync("next")},H=async()=>{(n?.lastSongSlideId||n?.currentQueueItemId)&&await R.mutateAsync()},P=async()=>{await _.mutateAsync()},B=async(se,ge)=>{const be=ge===-1;await O.mutateAsync({currentQueueItemId:se,currentSongSlideId:be?null:ge,currentBiblePassageVerseId:null,isHidden:!1})},E=async(se,ge)=>{await O.mutateAsync({currentQueueItemId:se,currentSongSlideId:null,currentBiblePassageVerseId:ge,currentVerseteTineriEntryId:null,isHidden:!1})},K=async(se,ge)=>{await O.mutateAsync({currentQueueItemId:se,currentSongSlideId:null,currentBiblePassageVerseId:null,currentVerseteTineriEntryId:ge,isHidden:!1})},q=async()=>{o(!1),await _.mutateAsync(),await s.mutateAsync()&&e(t("queue:messages.cleared"),"success")},V=()=>{d(!0)},ie=se=>{m(se),p(!0)},Y=()=>{b(!0)},X=()=>{T(!0)},D=se=>{j({to:"/schedules/$scheduleId",params:{scheduleId:String(se)}})},U=n?.isHidden??!1,te=!!n?.currentSongSlideId||!!n?.currentQueueItemId||!!n?.lastSongSlideId,Z=L,re=M.isPending;return u.jsxs("div",{className:"flex flex-col h-full gap-3",children:[u.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 flex-1 min-h-0",children:[u.jsxs("div",{className:"lg:w-2/3 space-y-3 overflow-auto",children:[u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Mh,{size:20,className:"text-indigo-600"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("presentation:controlRoom.title")})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-md ${U?"bg-gray-100 dark:bg-gray-700":"bg-red-100 dark:bg-red-900/30"}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${U?"bg-gray-400 dark:bg-gray-500":"bg-red-500 animate-pulse"}`}),u.jsx("span",{className:`text-xs font-semibold ${U?"text-gray-400 dark:text-gray-500":"text-red-600 dark:text-red-400"}`,children:"LIVE"})]}),U?u.jsxs("button",{type:"button",onClick:H,disabled:!te||R.isPending,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 transition-colors",title:`${t("presentation:controls.show")} (F10)`,children:[R.isPending?u.jsx(Qe,{size:18,className:"animate-spin"}):u.jsx(pa,{size:18}),u.jsx("span",{children:t("presentation:controls.show")}),u.jsx("span",{className:"text-xs opacity-75",children:"(F10)"})]}):u.jsxs("button",{type:"button",onClick:P,disabled:_.isPending,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 transition-colors",title:`${t("presentation:controls.hide")} (Esc)`,children:[_.isPending?u.jsx(Qe,{size:18,className:"animate-spin"}):u.jsx(Jl,{size:18}),u.jsx("span",{children:t("presentation:controls.hide")}),u.jsx("span",{className:"text-xs opacity-75",children:"(Esc)"})]})]})]}),u.jsx(n1,{})]}),u.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:u.jsxs("div",{className:"flex items-center justify-center gap-3 flex-wrap",children:[u.jsxs("button",{type:"button",onClick:A,disabled:!Z||re,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",title:t("presentation:controls.prev"),children:[u.jsx(Dj,{size:20}),u.jsx("span",{children:t("presentation:controls.prev")})]}),u.jsxs("button",{type:"button",onClick:F,disabled:!Z||re,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",title:t("presentation:controls.next"),children:[u.jsx("span",{children:t("presentation:controls.next")}),u.jsx(As,{size:20})]})]})})]}),u.jsx("div",{className:"lg:w-1/3 flex flex-col min-h-0 flex-1 lg:flex-initial",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 flex-1 flex flex-col min-h-0 overflow-hidden",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 pb-3 flex-shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("queue:title")}),r&&r.length>0&&u.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",t("queue:songCount",{count:r.length}),")"]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(EB,{onAddSong:V,onAddBiblePassage:X,onAddSlide:ie,onImportSchedule:Y}),r&&r.length>0&&u.jsx("button",{type:"button",onClick:()=>w(!0),className:"p-1.5 text-white bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 rounded-lg transition-colors",title:t("queue:actions.saveAsProgram"),children:u.jsx(ld,{size:18})}),r&&r.length>0&&u.jsx("button",{type:"button",onClick:()=>o(!0),className:"p-1.5 text-white bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 rounded-lg transition-colors",children:u.jsx(Fn,{size:18})})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin min-h-0 px-4 pb-4",children:u.jsx(hK,{activeSlideId:n?.currentSongSlideId??null,activeVerseId:n?.currentBiblePassageVerseId??null,activeEntryId:n?.currentVerseteTineriEntryId??null,activeQueueItemId:n?.currentQueueItemId??null,onSlideClick:B,onVerseClick:E,onEntryClick:K,hideHeader:!0})})]})})]}),u.jsx(fi,{isOpen:i,title:t("queue:confirmClear.title"),message:t("queue:confirmClear.message"),confirmLabel:t("queue:actions.clear"),onConfirm:q,onCancel:()=>o(!1),variant:"danger"}),u.jsx(pg,{isOpen:l,onClose:()=>d(!1)}),u.jsx(ob,{isOpen:f,onClose:()=>p(!1),initialTemplate:g}),u.jsx(sK,{isOpen:y,onClose:()=>b(!1)}),u.jsx(pK,{isOpen:v,onClose:()=>w(!1),onSaved:D}),u.jsx(l3,{isOpen:S,onClose:()=>T(!1)})]})}const RK=typeof window<"u"&&"__TAURI_INTERNALS__"in window;RK&&pn()||window.fetch.bind(window);const oT=5;function g5(t){return t.replace(/<[^>]*>/g," ").trim()}function m5(t){return g5(t)}function _K(t){return t.replace(/\s*-\s*[A-Z]+\s*$/,"").trim()}function Iu(t,e){return`${_K(t||"")}: ${e||""}`}function OK(t){return g5(t||"")}function IK(t){return{entries:t.slice(0,oT).map(n=>({personName:n.personName,reference:n.reference})),hasMore:t.length>oT}}function DK(t){return`${t.personName} - ${t.reference}`}function bl(t){if(t)switch(t.itemType){case"song":{const e=t.slides?.[0];return e?{contentType:"song",preview:m5(e.content)}:void 0}case"bible":return{contentType:"bible",preview:Iu(t.bibleReference,t.bibleText)};case"bible_passage":{const e=t.biblePassageVerses?.[0];return e?{contentType:"bible_passage",preview:Iu(e.reference,e.text)}:void 0}case"slide":{if(t.slideType==="versete_tineri"){const e=t.verseteTineriEntries||[];return e.length===0?void 0:{contentType:"versete_tineri",preview:e.map(n=>n.personName).join(", "),verseteTineriSummary:IK(e)}}return{contentType:"announcement",preview:OK(t.slideContent)}}default:return}}function LK(t){const{queueItems:e,presentationState:n,nextBibleVerse:r}=t,{currentQueueItemId:s,currentSongSlideId:i,currentBiblePassageVerseId:o,currentVerseteTineriEntryId:l}=n;if(!s||e.length===0)return;const d=e.findIndex(g=>g.id===s);if(d===-1)return;const f=e[d],p=e[d+1];if(f.itemType==="song"&&i){const g=f.slides||[],m=g.findIndex(y=>y.id===i);if(m!==-1&&m<g.length-1){const y=g[m+1];return{contentType:"song",preview:m5(y.content)}}return bl(p)}if(f.itemType==="bible_passage"){const g=f.biblePassageVerses||[],m=o||g[0]?.id;if(m){const y=g.findIndex(b=>b.id===m);if(y!==-1&&y<g.length-1){const b=g[y+1];return{contentType:"bible_passage",preview:Iu(b.reference,b.text)}}}return p?bl(p):r?{contentType:"bible",preview:Iu(`${r.bookName} ${r.chapter}:${r.verse}`,r.text)}:void 0}if(f.itemType==="slide"&&f.slideType==="versete_tineri"){const g=f.verseteTineriEntries||[],m=l||g[0]?.id;if(m){const y=g.findIndex(b=>b.id===m);if(y!==-1&&y<g.length-1){const b=g[y+1];return{contentType:"versete_tineri",preview:DK(b)}}}return bl(p)}return f.itemType==="bible"?p?bl(p):r?{contentType:"bible",preview:Iu(`${r.bookName} ${r.chapter}:${r.verse}`,r.text)}:void 0:(f.itemType==="slide"&&f.slideType==="announcement",bl(p))}const zK=sn()&&pn()?hi:window.fetch.bind(window);function PK(){const t={"Cache-Control":"no-cache"};if(pn()){const e=Xl();e&&(t.Cookie=`user_auth=${e}`)}return t}function BK({screenId:t}){tc();const{data:e}=mi(),{data:n,isLoading:r,isError:s}=Gb(t),i=GE(),o=C.useRef(null),[l,d]=C.useState(null),[f,p]=C.useState("empty"),[g,m]=C.useState(),[y,b]=C.useState(!1),[v,w]=C.useState(!1),S=C.useRef(null),T=C.useRef(!1),[j,M]=C.useState({width:0,height:0});C.useEffect(()=>{const B=()=>{o.current&&M({width:o.current.clientWidth,height:o.current.clientHeight})};B();const E=new ResizeObserver(B);return o.current&&E.observe(o.current),()=>E.disconnect()},[n]),C.useEffect(()=>{let B=null;const E=async()=>{if(sn())try{const{getCurrentWebviewWindow:q}=await Cn(async()=>{const{getCurrentWebviewWindow:Y}=await import("./webviewWindow-BLpYegvH.js");return{getCurrentWebviewWindow:Y}},__vite__mapDeps([0,1,2,3])),V=q(),ie=await V.isFullscreen();b(ie),B=await V.listen("tauri://resize",async()=>{const Y=await V.isMaximized(),X=await V.isFullscreen();Y&&!X&&!T.current&&(await Lh(V,!0),b(!0),n&&i.mutate({id:n.id,name:n.name,type:n.type,isFullscreen:!0})),!Y&&T.current&&setTimeout(()=>{T.current=!1},500),b(await V.isFullscreen())})}catch{}},K=()=>{if(!sn()){const q=document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement;b(!!q)}};return E(),document.addEventListener("fullscreenchange",K),document.addEventListener("webkitfullscreenchange",K),document.addEventListener("MSFullscreenChange",K),()=>{document.removeEventListener("fullscreenchange",K),document.removeEventListener("webkitfullscreenchange",K),document.removeEventListener("MSFullscreenChange",K),B&&B()}},[n,i]);const _=async B=>{try{if(B){const E=document.documentElement;E.requestFullscreen?await E.requestFullscreen():E.webkitRequestFullscreen?await E.webkitRequestFullscreen():E.msRequestFullscreen&&await E.msRequestFullscreen()}else document.fullscreenElement&&(document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.msExitFullscreen&&await document.msExitFullscreen());return!0}catch(E){return console.error("[useBrowserFullscreen] Error:",E),!1}},R=C.useCallback(async()=>{const B=!y;console.log(`[toggleFullscreen] Toggling fullscreen to: ${B}`),B||(T.current=!0);let E=!1;if(sn())try{const{getCurrentWebviewWindow:K}=await Cn(async()=>{const{getCurrentWebviewWindow:ie}=await import("./webviewWindow-BLpYegvH.js");return{getCurrentWebviewWindow:ie}},__vite__mapDeps([0,1,2,3])),q=K();console.log("[toggleFullscreen] Got window:",q?.label),await Lh(q,B)?(b(B),E=!0,console.log("[toggleFullscreen] Tauri fullscreen set successfully")):(console.log("[toggleFullscreen] Tauri methods failed, trying browser fullscreen fallback..."),E=await _(B),E&&(b(B),console.log("[toggleFullscreen] Browser fullscreen fallback succeeded")))}catch(K){console.error("[toggleFullscreen] Tauri fullscreen threw error, trying browser fallback:",K),E=await _(B),E&&(b(B),console.log("[toggleFullscreen] Browser fullscreen fallback succeeded after error"))}else E=await _(B),E&&b(B);E||console.error("[toggleFullscreen] All fullscreen methods failed"),n&&i.mutate({id:n.id,name:n.name,type:n.type,isFullscreen:B})},[y,n,i]),O=C.useCallback(B=>{B.clientY<60&&(w(!0),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{w(!1)},3e3))},[]);C.useEffect(()=>()=>{S.current&&clearTimeout(S.current)},[]),C.useEffect(()=>{const B=document.documentElement.style.backgroundColor,E=document.body.style.backgroundColor;return document.documentElement.style.backgroundColor="transparent",document.body.style.backgroundColor="transparent",()=>{document.documentElement.style.backgroundColor=B,document.body.style.backgroundColor=E}},[]),C.useEffect(()=>{const B=E=>{E.key==="F11"&&(E.preventDefault(),R())};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[R]);const[,L]=C.useState(0);if(C.useEffect(()=>{const B=setInterval(()=>L(E=>E+1),1e3);return()=>clearInterval(B)},[]),C.useEffect(()=>{(async()=>{if(!e){d(null),p("empty");return}if(e.isHidden){d(null),p("empty");return}if(e.temporaryContent){const E=e.temporaryContent;if(E.type==="bible"){const K=E.data.reference.replace(/\s*-\s*[A-Z]+\s*$/,"");p("bible"),d({referenceText:K,contentText:E.data.text}),m(void 0);return}if(E.type==="song"){const K=E.data.slides[E.data.currentSlideIndex];if(K){if(p("song"),d({mainText:K.content}),n?.type==="stage"){const q=E.data.slides[E.data.currentSlideIndex+1];m(q?{contentType:"song",preview:q.content}:void 0)}else m(void 0);return}}}try{const E=await zK(`${Ct()}/api/queue`,{cache:"no-store",headers:PK(),credentials:"include"});if(!E.ok){d(null),p("empty"),m(void 0);return}const q=(await E.json()).data||[];let V="empty",ie=null;if(e.currentSongSlideId)for(const Y of q){const X=Y.slides?.find(D=>D.id===e.currentSongSlideId);if(X){V="song",ie={mainText:X.content};break}}if(!ie&&e.currentQueueItemId&&!e.currentSongSlideId){const Y=q.find(X=>X.id===e.currentQueueItemId);if(Y){if(Y.itemType==="slide"){if(Y.slideType==="versete_tineri"&&Y.verseteTineriEntries){const X=e.currentVerseteTineriEntryId,D=X?Y.verseteTineriEntries.find(U=>U.id===X):Y.verseteTineriEntries[0];D&&(V="versete_tineri",ie={personLabel:D.personName||"",referenceText:D.reference,contentText:D.text})}ie||(V="announcement",ie={mainText:Y.slideContent||""})}else if(Y.itemType==="bible"){const X=(Y.bibleReference||"").replace(/\s*-\s*[A-Z]+\s*$/,"");V="bible",ie={referenceText:X,contentText:Y.bibleText||""}}else if(Y.itemType==="bible_passage"){const X=e.currentBiblePassageVerseId,D=X?Y.biblePassageVerses?.find(U=>U.id===X):Y.biblePassageVerses?.[0];D&&(V="bible_passage",ie={referenceText:D.reference,contentText:D.text})}}}if(p(V),d(ie),n?.type==="stage"){let Y=null;const X=q.findIndex(Z=>Z.id===e.currentQueueItemId),D=X!==-1&&X<q.length-1,U=q[X];if(!D&&U){let Z=null;if(U.itemType==="bible")Z=U.bibleVerseId;else if(U.itemType==="bible_passage"){const re=U.biblePassageVerses||[],se=e.currentBiblePassageVerseId?re.findIndex(be=>be.id===e.currentBiblePassageVerseId):0;se===re.length-1&&(Z=re[se]?.verseId??null)}if(Z)try{Y=await e8(Z)}catch{}}const te=LK({queueItems:q,presentationState:e,nextBibleVerse:Y});m(te)}else m(void 0)}catch{d(null),p("empty"),m(void 0)}})()},[e?.currentSongSlideId,e?.currentQueueItemId,e?.currentBiblePassageVerseId,e?.currentVerseteTineriEntryId,e?.isHidden,e?.temporaryContent,e?.updatedAt,n?.type]),s)return u.jsx("div",{className:"w-screen h-screen",style:{backgroundColor:"black",background:"transparent"}});if(r||!n)return u.jsx("div",{className:"w-screen h-screen",style:{backgroundColor:"black",background:"transparent"}});const F=l!==null&&!e?.isHidden,P=n.contentConfigs[f]?.background||n.contentConfigs.empty?.background;return u.jsxs("div",{ref:o,className:"w-screen h-screen overflow-hidden cursor-default",style:P?ed(P):{backgroundColor:"#000000"},onDoubleClick:R,onMouseMove:O,children:[u.jsx("div",{className:`fixed top-0 right-0 z-50 p-2 transition-opacity duration-300 ${v?"opacity-100":"opacity-0 pointer-events-none"}`,onMouseEnter:()=>{S.current&&clearTimeout(S.current),w(!0)},onMouseLeave:()=>{S.current=setTimeout(()=>{w(!1)},1e3)},children:u.jsx("button",{type:"button",onClick:R,className:"p-2 rounded-lg bg-black/50 hover:bg-black/70 text-white transition-colors",title:y?"Exit fullscreen":"Enter fullscreen",children:y?u.jsx(AD,{size:20}):u.jsx(CD,{size:20})})}),j.width>0&&j.height>0&&u.jsx(p5,{screen:n,contentType:f,contentData:l,containerWidth:j.width,containerHeight:j.height,showClock:!0,isVisible:F,nextSlideData:g,fillContainer:!0})]})}const FK=()=>({song:{},bible:{},bible_passage:{},announcement:{},versete_tineri:{},empty:{}});function UK(){const[t,e]=C.useState(null),[n,r]=C.useState("song"),[s,i]=C.useState(null),[o,l]=C.useState(1),[d,f]=C.useState(!1),[p,g]=C.useState(FK),m=C.useCallback(R=>{e(R),f(!1)},[]),y=C.useCallback(R=>{e(R)},[]),b=C.useCallback((R,O)=>{e(L=>L&&{...L,contentConfigs:{...L.contentConfigs,[R]:O}}),f(!0)},[]),v=C.useCallback(R=>{e(O=>O&&{...O,nextSlideConfig:R}),f(!0)},[]),w=C.useCallback(R=>{e(O=>O&&{...O,globalSettings:R}),f(!0)},[]),S=C.useCallback(()=>{i(null)},[]),T=C.useCallback(()=>{f(!1)},[]),j=C.useCallback((R,O,L)=>{g(A=>({...A,[R]:{...A[R],[O]:L}}))},[]),M=C.useCallback(R=>{g(O=>({...O,[R]:{}}))},[]),_=C.useMemo(()=>({setScreen:m,setScreenExternal:y,setSelectedContentType:r,setSelectedElement:i,setZoom:l,updateContentConfig:b,updateNextSlideConfig:v,updateGlobalSettings:w,clearSelection:S,markClean:T,setPreviewText:j,resetPreviewTexts:M}),[m,y,r,i,l,b,v,w,S,T,j,M]);return[{screen:t,selectedContentType:n,selectedElement:s,zoom:o,isDirty:d,previewTexts:p},_]}const $K={song:{main:`Aleluia, Aleluia!
Mrire Domnului!
Aleluia, Aleluia!
Slvit s fie El!`},bible:{reference:"Ioan 3:16",main:"Fiindc att de mult a iubit Dumnezeu lumea, c a dat pe singurul Lui Fiu, pentru ca oricine crede n El s nu piar, ci s aib via venic."},bible_passage:{reference:"Psalmul 23:1-3",main:"Domnul este Pstorul meu: nu voi duce lips de nimic. El m pate n puni verzi i m duce la ape de odihn; mi nvioreaz sufletul."},announcement:{main:"<h1>Anun Important</h1><p>Program special duminica viitoare!</p>"},versete_tineri:{person:"Andrei Popescu",reference:"Romani 8:28",main:"De alt parte, tim c toate lucrurile lucreaz mpreun spre binele celor ce iubesc pe Dumnezeu."},empty:{}};function vl({x:t,y:e,width:n,height:r,constraints:s,size:i,isSelected:o,isHidden:l=!1,onClick:d,onConstraintChange:f,onSizeChange:p,canvasWidth:g,canvasHeight:m,screenWidth:y,screenHeight:b,canvasRef:v,children:w}){const S=C.useRef(null),[T,j]=C.useState(!1),[M,_]=C.useState({x:0,y:0}),[R,O]=C.useState({x:t,y:e}),L=C.useRef(R),[A,F]=C.useState(null),[H,P]=C.useState({width:n,height:r}),B=C.useRef(H),[E,K]=C.useState({x:0,y:0,width:0,height:0,posX:0,posY:0}),q=g/y;C.useEffect(()=>{O({x:t,y:e})},[t,e]),C.useEffect(()=>{L.current=R},[R]),C.useEffect(()=>{P({width:n,height:r})},[n,r]),C.useEffect(()=>{B.current=H},[H]);const V=C.useCallback(D=>{D.stopPropagation(),d();const U=v.current?.getBoundingClientRect();if(!U)return;const te=D.clientX-U.left,Z=D.clientY-U.top;j(!0),_({x:te-R.x,y:Z-R.y})},[d,R,v]),ie=C.useCallback((D,U)=>{D.stopPropagation(),D.preventDefault(),F(U),K({x:D.clientX,y:D.clientY,width:H.width,height:H.height,posX:R.x,posY:R.y})},[H,R]),Y=C.useCallback((D,U,te)=>U==="%"?D/te*100:D,[]);C.useEffect(()=>{if(!T)return;const D=te=>{const Z=v.current?.getBoundingClientRect();if(!Z)return;const re=te.clientX-Z.left,se=te.clientY-Z.top,ge=re-M.x,be=se-M.y;O({x:ge,y:be})},U=()=>{j(!1);const te=L.current.x/q,Z=L.current.y/q,re=B.current.width/q,se=B.current.height/q,ge={...s};s.left.enabled&&(ge.left={...s.left,value:Y(te,s.left.unit,y)}),s.right.enabled&&(ge.right={...s.right,value:Y(y-te-re,s.right.unit,y)}),s.top.enabled&&(ge.top={...s.top,value:Y(Z,s.top.unit,b)}),s.bottom.enabled&&(ge.bottom={...s.bottom,value:Y(b-Z-se,s.bottom.unit,b)}),f(ge)};return document.addEventListener("mousemove",D),document.addEventListener("mouseup",U),()=>{document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",U)}},[T,M,s,f,Y,v,q,y,b]),C.useEffect(()=>{if(!A)return;const D=te=>{const Z=te.clientX-E.x,re=te.clientY-E.y;let se=E.width,ge=E.height,be=E.posX,me=E.posY;A==="n"?(ge=Math.max(30,E.height-re),me=E.posY+re):A==="s"?ge=Math.max(30,E.height+re):A==="e"?se=Math.max(50,E.width+Z):A==="w"?(se=Math.max(50,E.width-Z),be=E.posX+Z):A==="se"?(se=Math.max(50,E.width+Z),ge=Math.max(30,E.height+re)):A==="sw"?(se=Math.max(50,E.width-Z),ge=Math.max(30,E.height+re),be=E.posX+Z):A==="ne"?(se=Math.max(50,E.width+Z),ge=Math.max(30,E.height-re),me=E.posY+re):A==="nw"&&(se=Math.max(50,E.width-Z),ge=Math.max(30,E.height-re),be=E.posX+Z,me=E.posY+re),P({width:se,height:ge}),O({x:be,y:me})},U=()=>{F(null);const te=L.current.x/q,Z=L.current.y/q,re=B.current.width/q,se=B.current.height/q,ge={...s},be=s.left.enabled&&s.right.enabled,me=s.top.enabled&&s.bottom.enabled;(A==="w"||A==="nw"||A==="sw")&&s.left.enabled&&(ge.left={...s.left,value:Y(te,s.left.unit,y)}),(A==="e"||A==="ne"||A==="se")&&s.right.enabled&&(ge.right={...s.right,value:Y(y-te-re,s.right.unit,y)}),(A==="n"||A==="nw"||A==="ne")&&s.top.enabled&&(ge.top={...s.top,value:Y(Z,s.top.unit,b)}),(A==="s"||A==="sw"||A==="se")&&s.bottom.enabled&&(ge.bottom={...s.bottom,value:Y(b-Z-se,s.bottom.unit,b)}),f(ge);const Se={...i};be||(Se.width=Y(re,i.widthUnit,y)),me||(Se.height=Y(se,i.heightUnit,b)),p(Se)};return document.addEventListener("mousemove",D),document.addEventListener("mouseup",U),()=>{document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",U)}},[A,E,s,i,f,p,Y,q,y,b]);const X=()=>o?"2px solid #6366f1":l?"2px dashed rgba(239, 68, 68, 0.5)":"1px dashed rgba(255,255,255,0.3)";return u.jsxs("div",{ref:S,className:`absolute cursor-move ${T||A?"z-50":""}`,style:{left:R.x,top:R.y,width:H.width,height:H.height,border:X(),boxSizing:"border-box",opacity:l?.4:1},onMouseDown:V,onClick:D=>D.stopPropagation(),children:[w,o&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"absolute -right-1 -bottom-1 w-3 h-3 bg-indigo-500 cursor-se-resize rounded-sm",onMouseDown:D=>ie(D,"se")}),u.jsx("div",{className:"absolute -left-1 -bottom-1 w-3 h-3 bg-indigo-500 cursor-sw-resize rounded-sm",onMouseDown:D=>ie(D,"sw")}),u.jsx("div",{className:"absolute -right-1 -top-1 w-3 h-3 bg-indigo-500 cursor-ne-resize rounded-sm",onMouseDown:D=>ie(D,"ne")}),u.jsx("div",{className:"absolute -left-1 -top-1 w-3 h-3 bg-indigo-500 cursor-nw-resize rounded-sm",onMouseDown:D=>ie(D,"nw")}),u.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -top-1 w-6 h-2 bg-indigo-500 cursor-n-resize rounded-sm",onMouseDown:D=>ie(D,"n")}),u.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -bottom-1 w-6 h-2 bg-indigo-500 cursor-s-resize rounded-sm",onMouseDown:D=>ie(D,"s")}),u.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 -left-1 w-2 h-6 bg-indigo-500 cursor-w-resize rounded-sm",onMouseDown:D=>ie(D,"w")}),u.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 -right-1 w-2 h-6 bg-indigo-500 cursor-e-resize rounded-sm",onMouseDown:D=>ie(D,"e")})]})]})}function qK({screen:t,contentType:e,selectedElement:n,zoom:r,previewTexts:s,onSelectElement:i,onUpdateElement:o}){const l=C.useRef(null),d=C.useRef(null),[f,p]=C.useState({width:800,height:450}),g=t.contentConfigs[e],m=$K[e],y=t.width,b=t.height,v=C.useMemo(()=>({main:s?.main||m?.main,reference:s?.reference||m?.reference,person:s?.person||m?.person}),[e,s,m]);C.useEffect(()=>{const R=()=>{if(!l.current)return;const O=l.current,L=O.clientWidth-40,A=O.clientHeight-40,F=y/b;let H=L,P=H/F;P>A&&(P=A,H=P*F),p({width:H*r,height:P*r})};return R(),window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[y,b,r]);const w=f.width/y,S=()=>{i(null)},T=C.useCallback(R=>O=>{o(R,{constraints:O})},[o]),j=C.useCallback(R=>O=>{o(R,{size:O})},[o]),M=C.useMemo(()=>{const R=[];if("mainText"in g){const L=g.mainText,A=Yr(L.constraints,L.size,y,b);R.push(u.jsx(vl,{x:A.x*w,y:A.y*w,width:A.width*w,height:A.height*w,constraints:L.constraints,size:L.size,isSelected:n?.type==="mainText",isHidden:L.hidden,onClick:()=>i({type:"mainText"}),onConstraintChange:T("mainText"),onSizeChange:j("mainText"),canvasWidth:f.width,canvasHeight:f.height,screenWidth:y,screenHeight:b,canvasRef:d,children:u.jsx(ii,{content:v?.main??"Main Content",style:{...L.style,maxFontSize:L.style.maxFontSize*w},containerWidth:A.width*w,containerHeight:A.height*w,isHtml:!0})},"mainText"))}if("contentText"in g){const L=g.contentText,A=Yr(L.constraints,L.size,y,b),P=g.includeReferenceInContent&&v?.reference?`${v.reference} ${v?.main??"Content Text"}`:v?.main??"Content Text";R.push(u.jsx(vl,{x:A.x*w,y:A.y*w,width:A.width*w,height:A.height*w,constraints:L.constraints,size:L.size,isSelected:n?.type==="contentText",isHidden:L.hidden,onClick:()=>i({type:"contentText"}),onConstraintChange:T("contentText"),onSizeChange:j("contentText"),canvasWidth:f.width,canvasHeight:f.height,screenWidth:y,screenHeight:b,canvasRef:d,children:u.jsx(ii,{content:P,style:{...L.style,maxFontSize:L.style.maxFontSize*w},containerWidth:A.width*w,containerHeight:A.height*w})},"contentText"))}if("referenceText"in g){const L=g.referenceText,A=Yr(L.constraints,L.size,y,b),H=g.includeReferenceInContent;R.push(u.jsx(vl,{x:A.x*w,y:A.y*w,width:A.width*w,height:A.height*w,constraints:L.constraints,size:L.size,isSelected:n?.type==="referenceText",isHidden:L.hidden||H,onClick:()=>i({type:"referenceText"}),onConstraintChange:T("referenceText"),onSizeChange:j("referenceText"),canvasWidth:f.width,canvasHeight:f.height,screenWidth:y,screenHeight:b,canvasRef:d,children:u.jsx(ii,{content:v?.reference??"Reference",style:{...L.style,maxFontSize:L.style.maxFontSize*w},containerWidth:A.width*w,containerHeight:A.height*w})},"referenceText"))}if("personLabel"in g){const L=g.personLabel,A=Yr(L.constraints,L.size,y,b);R.push(u.jsx(vl,{x:A.x*w,y:A.y*w,width:A.width*w,height:A.height*w,constraints:L.constraints,size:L.size,isSelected:n?.type==="personLabel",isHidden:L.hidden,onClick:()=>i({type:"personLabel"}),onConstraintChange:T("personLabel"),onSizeChange:j("personLabel"),canvasWidth:f.width,canvasHeight:f.height,screenWidth:y,screenHeight:b,canvasRef:d,children:u.jsx(ii,{content:v?.person??"Person Name",style:{...L.style,maxFontSize:L.style.maxFontSize*w},containerWidth:A.width*w,containerHeight:A.height*w})},"personLabel"))}const O="clock"in g?g.clock:t.globalSettings.clockConfig;if(O?.enabled){const L=O.size??{width:10,widthUnit:"%",height:5,heightUnit:"%"},A=Yr(O.constraints,L,y,b);R.push(u.jsx(vl,{x:A.x*w,y:A.y*w,width:A.width*w,height:A.height*w,constraints:O.constraints,size:L,isSelected:n?.type==="clock",isHidden:O.hidden,onClick:()=>i({type:"clock"}),onConstraintChange:T("clock"),onSizeChange:j("clock"),canvasWidth:f.width,canvasHeight:f.height,screenWidth:y,screenHeight:b,canvasRef:d,children:u.jsx(ii,{content:O.showSeconds?"12:34:56":"12:34",style:{...O.style,maxFontSize:O.style.maxFontSize*w},containerWidth:A.width*w,containerHeight:A.height*w})},"clock"))}if(t.type==="stage"&&t.nextSlideConfig?.enabled){const L=t.nextSlideConfig,A=Yr(L.constraints,L.size,y,b);R.push(u.jsx(vl,{x:A.x*w,y:A.y*w,width:A.width*w,height:A.height*w,constraints:L.constraints,size:L.size,isSelected:n?.type==="nextSlide",isHidden:L.hidden,onClick:()=>i({type:"nextSlide"}),onConstraintChange:T("nextSlide"),onSizeChange:j("nextSlide"),canvasWidth:f.width,canvasHeight:f.height,screenWidth:y,screenHeight:b,canvasRef:d,children:u.jsxs("div",{className:"w-full h-full p-4",style:ed(L.background),children:[u.jsx("div",{style:{...Va(L.labelStyle),fontSize:L.labelStyle.maxFontSize*w},children:L.labelText}),u.jsx("div",{className:"mt-2",style:{...Va(L.contentStyle),fontSize:L.contentStyle.maxFontSize*w},children:"Next slide content preview..."})]})},"nextSlide"))}return R},[t,g,v,n,i,f,w,y,b,T,j]),_="background"in g?g.background:t.globalSettings.defaultBackground;return u.jsx("div",{ref:l,className:"flex-1 flex items-center justify-center bg-gray-100 dark:bg-gray-900 overflow-auto p-4",onClick:S,children:u.jsx("div",{ref:d,className:"relative rounded-lg overflow-hidden shadow-2xl border border-gray-300 dark:border-gray-600",style:{width:f.width,height:f.height,...ed(_)},onClick:R=>R.stopPropagation(),children:M})})}const Wt=C.forwardRef(({checked:t,onCheckedChange:e,label:n,disabled:r,className:s="",id:i},o)=>{const l=i||`checkbox-${Math.random().toString(36).slice(2,9)}`;return u.jsxs("label",{htmlFor:l,className:`flex items-center gap-2 cursor-pointer ${r?"opacity-50 cursor-not-allowed":""} ${s}`,children:[u.jsx("input",{ref:o,type:"checkbox",id:l,checked:t,onChange:d=>e?.(d.target.checked),disabled:r,className:"w-4 h-4 rounded border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-indigo-600 focus:ring-indigo-500 focus:ring-offset-white dark:focus:ring-offset-gray-900"}),n&&u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:n})]})});Wt.displayName="Checkbox";const pt=C.forwardRef(({className:t="",children:e,...n},r)=>u.jsx("label",{ref:r,className:`block text-sm font-medium text-gray-700 dark:text-gray-300 ${t}`,...n,children:e}));pt.displayName="Label";const cb=C.forwardRef(({value:t=[0],onValueChange:e,min:n=0,max:r=100,step:s=1,disabled:i,className:o=""},l)=>u.jsxs("div",{className:`flex items-center gap-3 ${o}`,children:[u.jsx("input",{ref:l,type:"range",value:t[0],onChange:d=>e?.([parseFloat(d.target.value)]),min:n,max:r,step:s,disabled:i,className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed"}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 w-12 text-right",children:t[0]})]}));cb.displayName="Slider";function HK({constraints:t,size:e,screenWidth:n,screenHeight:r,onChange:s}){const{t:i}=ke("presentation"),o=(y,b)=>{s({...t,[y]:b},e)},l=y=>{s(t,{...e,...y})},d=t.left.enabled&&t.right.enabled,f=t.top.enabled&&t.bottom.enabled,p=y=>{const b=t[y],v=b.unit==="%"?"px":"%",w=y==="left"||y==="right"?n:r,S=ky(b.value,b.unit,v,w);o(y,{...b,value:S,unit:v})},g=()=>{const y=e.widthUnit==="%"?"px":"%",b=ky(e.width,e.widthUnit,y,n);l({width:b,widthUnit:y})},m=()=>{const y=e.heightUnit==="%"?"px":"%",b=ky(e.height,e.heightUnit,y,r);l({height:b,heightUnit:y})};return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"relative w-full aspect-video bg-gray-100 dark:bg-gray-800 rounded border border-gray-200 dark:border-gray-700 p-4",children:[u.jsx("div",{className:"absolute inset-8 border-2 border-dashed border-gray-400 dark:border-gray-500 rounded flex items-center justify-center",children:u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:i("screens.position.element","Element")})}),u.jsx("button",{type:"button",onClick:()=>o("top",{...t.top,enabled:!t.top.enabled}),className:`
            absolute top-2 left-1/2 -translate-x-1/2 w-4 h-4 rounded-full border-2
            transition-all duration-150
            ${t.top.enabled?"bg-indigo-600 border-indigo-600":"bg-white dark:bg-gray-900 border-gray-300 dark:border-gray-600"}
          `,title:i("screens.position.top","Top")}),t.top.enabled&&u.jsxs("div",{className:"absolute top-7 left-1/2 -translate-x-1/2 flex items-center gap-0.5 bg-white/90 dark:bg-gray-900/90 rounded overflow-hidden",children:[u.jsx("input",{type:"number",value:xl(t.top.value),onChange:y=>o("top",{...t.top,value:parseFloat(y.target.value)||0}),step:"0.1",className:"w-10 h-5 text-[10px] text-indigo-600 dark:text-indigo-400 font-medium bg-transparent px-1 text-center border-0 focus:outline-none focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onClick:y=>y.stopPropagation()}),u.jsx("button",{type:"button",onClick:y=>{y.stopPropagation(),p("top")},className:"h-5 px-1 text-[10px] text-indigo-500 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/30",children:t.top.unit})]}),u.jsx("button",{type:"button",onClick:()=>o("bottom",{...t.bottom,enabled:!t.bottom.enabled}),className:`
            absolute bottom-2 left-1/2 -translate-x-1/2 w-4 h-4 rounded-full border-2
            transition-all duration-150
            ${t.bottom.enabled?"bg-indigo-600 border-indigo-600":"bg-white dark:bg-gray-900 border-gray-300 dark:border-gray-600"}
          `,title:i("screens.position.bottom","Bottom")}),t.bottom.enabled&&u.jsxs("div",{className:"absolute bottom-7 left-1/2 -translate-x-1/2 flex items-center gap-0.5 bg-white/90 dark:bg-gray-900/90 rounded overflow-hidden",children:[u.jsx("input",{type:"number",value:xl(t.bottom.value),onChange:y=>o("bottom",{...t.bottom,value:parseFloat(y.target.value)||0}),step:"0.1",className:"w-10 h-5 text-[10px] text-indigo-600 dark:text-indigo-400 font-medium bg-transparent px-1 text-center border-0 focus:outline-none focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onClick:y=>y.stopPropagation()}),u.jsx("button",{type:"button",onClick:y=>{y.stopPropagation(),p("bottom")},className:"h-5 px-1 text-[10px] text-indigo-500 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/30",children:t.bottom.unit})]}),u.jsx("button",{type:"button",onClick:()=>o("left",{...t.left,enabled:!t.left.enabled}),className:`
            absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border-2
            transition-all duration-150
            ${t.left.enabled?"bg-indigo-600 border-indigo-600":"bg-white dark:bg-gray-900 border-gray-300 dark:border-gray-600"}
          `,title:i("screens.position.left","Left")}),t.left.enabled&&u.jsxs("div",{className:"absolute left-7 top-1/2 -translate-y-1/2 flex items-center gap-0.5 bg-white/90 dark:bg-gray-900/90 rounded overflow-hidden",children:[u.jsx("input",{type:"number",value:xl(t.left.value),onChange:y=>o("left",{...t.left,value:parseFloat(y.target.value)||0}),step:"0.1",className:"w-10 h-5 text-[10px] text-indigo-600 dark:text-indigo-400 font-medium bg-transparent px-1 text-center border-0 focus:outline-none focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onClick:y=>y.stopPropagation()}),u.jsx("button",{type:"button",onClick:y=>{y.stopPropagation(),p("left")},className:"h-5 px-1 text-[10px] text-indigo-500 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/30",children:t.left.unit})]}),u.jsx("button",{type:"button",onClick:()=>o("right",{...t.right,enabled:!t.right.enabled}),className:`
            absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border-2
            transition-all duration-150
            ${t.right.enabled?"bg-indigo-600 border-indigo-600":"bg-white dark:bg-gray-900 border-gray-300 dark:border-gray-600"}
          `,title:i("screens.position.right","Right")}),t.right.enabled&&u.jsxs("div",{className:"absolute right-7 top-1/2 -translate-y-1/2 flex items-center gap-0.5 bg-white/90 dark:bg-gray-900/90 rounded overflow-hidden",children:[u.jsx("input",{type:"number",value:xl(t.right.value),onChange:y=>o("right",{...t.right,value:parseFloat(y.target.value)||0}),step:"0.1",className:"w-10 h-5 text-[10px] text-indigo-600 dark:text-indigo-400 font-medium bg-transparent px-1 text-center border-0 focus:outline-none focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onClick:y=>y.stopPropagation()}),u.jsx("button",{type:"button",onClick:y=>{y.stopPropagation(),p("right")},className:"h-5 px-1 text-[10px] text-indigo-500 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/30",children:t.right.unit})]}),t.top.enabled&&u.jsx("div",{className:"absolute top-6 left-1/2 w-0.5 h-2 bg-indigo-600 -translate-x-1/2"}),t.bottom.enabled&&u.jsx("div",{className:"absolute bottom-6 left-1/2 w-0.5 h-2 bg-indigo-600 -translate-x-1/2"}),t.left.enabled&&u.jsx("div",{className:"absolute left-6 top-1/2 h-0.5 w-2 bg-indigo-600 -translate-y-1/2"}),t.right.enabled&&u.jsx("div",{className:"absolute right-6 top-1/2 h-0.5 w-2 bg-indigo-600 -translate-y-1/2"})]}),u.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-200 dark:border-gray-700",children:[!d&&u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:i("screens.position.width","Width")}),u.jsxs("div",{className:"flex items-center gap-0.5 mt-1 bg-gray-100 dark:bg-gray-800 rounded overflow-hidden",children:[u.jsx("input",{type:"number",value:xl(e.width),onChange:y=>l({width:parseFloat(y.target.value)||0}),step:"0.1",className:"w-20 h-8 text-sm text-gray-900 dark:text-gray-100 font-medium bg-transparent px-2 text-center border-0 focus:outline-none focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"}),u.jsx("button",{type:"button",onClick:g,className:"h-8 px-2 text-sm text-indigo-600 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/30 font-medium",children:e.widthUnit})]})]}),d&&u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 italic",children:i("screens.position.stretchHorizontal","Width stretches between left and right constraints")}),!f&&u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:i("screens.position.height","Height")}),u.jsxs("div",{className:"flex items-center gap-0.5 mt-1 bg-gray-100 dark:bg-gray-800 rounded overflow-hidden",children:[u.jsx("input",{type:"number",value:xl(e.height),onChange:y=>l({height:parseFloat(y.target.value)||0}),step:"0.1",className:"w-20 h-8 text-sm text-gray-900 dark:text-gray-100 font-medium bg-transparent px-2 text-center border-0 focus:outline-none focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"}),u.jsx("button",{type:"button",onClick:m,className:"h-8 px-2 text-sm text-indigo-600 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/30 font-medium",children:e.heightUnit})]})]}),f&&u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 italic",children:i("screens.position.stretchVertical","Height stretches between top and bottom constraints")})]})]})}function Ur({title:t,icon:e,children:n,defaultOpen:r=!0}){const[s,i]=C.useState(r);return u.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-800",children:[u.jsxs("button",{className:"flex items-center w-full px-4 py-3 text-left hover:bg-gray-100 dark:hover:bg-gray-800/50",onClick:()=>i(!s),children:[s?u.jsx(Ms,{className:"w-4 h-4 mr-2 text-gray-500 dark:text-gray-400"}):u.jsx(As,{className:"w-4 h-4 mr-2 text-gray-500 dark:text-gray-400"}),u.jsx(e,{className:"w-4 h-4 mr-2 text-gray-500 dark:text-gray-400"}),u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-200",children:t})]}),s&&u.jsx("div",{className:"px-4 pb-4 space-y-4",children:n})]})}const Cy=[{value:"system-ui",label:"System Default"},{value:"Arial",label:"Arial"},{value:"Georgia",label:"Georgia"},{value:"Times New Roman",label:"Times New Roman"},{value:"Verdana",label:"Verdana"}],lT=[{value:"none",label:"None"},{value:"fade",label:"Fade"},{value:"slide-left",label:"Slide Left"},{value:"slide-right",label:"Slide Right"},{value:"slide-up",label:"Slide Up"},{value:"slide-down",label:"Slide Down"},{value:"zoom",label:"Zoom"},{value:"blur",label:"Blur"}],VK=[{value:"transparent",label:"Transparent"},{value:"color",label:"Solid Color"},{value:"image",label:"Image"},{value:"video",label:"Video"}],KK=[{value:"space",key:"space"},{value:"dash",key:"dash"},{value:"pipe",key:"pipe"}];function QK({screen:t,contentType:e,selectedElement:n,previewTexts:r,onSetPreviewText:s,onResetPreviewTexts:i,onUpdateContentConfig:o,onUpdateNextSlideConfig:l,onUpdateGlobalSettings:d}){const{t:f}=ke("presentation"),p=t.contentConfigs[e],g=(w,S)=>{const T=JSON.parse(JSON.stringify(p));let j=T;for(let M=0;M<w.length-1;M++)j=j[w[M]];j[w[w.length-1]]=S,o(e,T)},m=w=>{const S=JSON.parse(JSON.stringify(p));for(const{path:T,value:j}of w){let M=S;for(let _=0;_<T.length-1;_++)M=M[T[_]];M[T[T.length-1]]=j}o(e,S)},b=(()=>{if(!n)return null;switch(n.type){case"mainText":return"mainText"in p?{path:["mainText"],config:p.mainText}:null;case"contentText":return"contentText"in p?{path:["contentText"],config:p.contentText}:null;case"referenceText":return"referenceText"in p?{path:["referenceText"],config:p.referenceText}:null;case"personLabel":return"personLabel"in p?{path:["personLabel"],config:p.personLabel}:null;case"clock":return"clock"in p&&p.clock?{path:["clock"],config:p.clock}:null;case"nextSlide":return t.nextSlideConfig?{path:[],config:t.nextSlideConfig,isNextSlide:!0}:null;default:return null}})(),v=(w,S)=>{t.nextSlideConfig&&l({...t.nextSlideConfig,[w]:{...t.nextSlideConfig[w],...S}})};return u.jsx("div",{className:"w-80 bg-white dark:bg-gray-900 border-l border-gray-200 dark:border-gray-800 overflow-y-auto",children:n&&b?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-800/50",children:u.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-200 capitalize",children:n.type.replace(/([A-Z])/g," $1").trim()})}),"constraints"in b.config&&u.jsx(Ur,{title:"Position",icon:OD,children:u.jsx(HK,{constraints:b.config.constraints,size:b.config.size??{width:10,widthUnit:"%",height:5,heightUnit:"%"},screenWidth:t.width,screenHeight:t.height,onChange:(w,S)=>{b.isNextSlide?l({...t.nextSlideConfig,constraints:w,size:S}):m([{path:[...b.path,"constraints"],value:w},{path:[...b.path,"size"],value:S}])}})}),"constraints"in b.config&&u.jsx(Ur,{title:f("screens.panels.visibility"),icon:pa,defaultOpen:!1,children:u.jsx(Wt,{checked:b.config.hidden??!1,onCheckedChange:w=>{b.isNextSlide?l({...t.nextSlideConfig,hidden:!!w}):g([...b.path,"hidden"],!!w)},label:f("screens.visibility.hideElement")})}),"style"in b.config&&u.jsx(Ur,{title:"Text Style",icon:Uf,children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Font Family"}),u.jsx(An,{value:b.config.style.fontFamily,onChange:w=>{const S={...b.config.style,fontFamily:w};g([...b.path,"style"],S)},options:Cy,className:"w-full"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(Wt,{checked:b.config.style.autoScale??!0,onCheckedChange:w=>{const S={...b.config.style,autoScale:!!w};g([...b.path,"style"],S)},label:f("screens.textStyle.autoScale")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 ml-6",children:f("screens.textStyle.autoScaleDescription")})]}),u.jsxs("div",{children:[u.jsxs(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:[b.config.style.autoScale??!0?f("screens.textStyle.maxFontSize"):f("screens.textStyle.fontSize")," ","(px)"]}),u.jsx(br,{type:"number",value:b.config.style.maxFontSize,onChange:w=>{const S={...b.config.style,maxFontSize:parseInt(w.target.value)||24};g([...b.path,"style"],S)},className:"h-8"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Color"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"color",value:b.config.style.color,onChange:w=>{const S={...b.config.style,color:w.target.value};g([...b.path,"style"],S)},className:"w-10 h-8 rounded cursor-pointer"}),u.jsx(br,{value:b.config.style.color,onChange:w=>{const S={...b.config.style,color:w.target.value};g([...b.path,"style"],S)},className:"h-8 flex-1"})]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Wt,{checked:b.config.style.bold,onCheckedChange:w=>{const S={...b.config.style,bold:w};g([...b.path,"style"],S)},label:"Bold"}),u.jsx(Wt,{checked:b.config.style.italic,onCheckedChange:w=>{const S={...b.config.style,italic:w};g([...b.path,"style"],S)},label:"Italic"}),u.jsx(Wt,{checked:b.config.style.underline,onCheckedChange:w=>{const S={...b.config.style,underline:w};g([...b.path,"style"],S)},label:"Underline"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Horizontal Alignment"}),u.jsx("div",{className:"flex gap-2 mt-1",children:["left","center","right"].map(w=>u.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded ${b.config.style.alignment===w?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{const S={...b.config.style,alignment:w};g([...b.path,"style"],S)},children:w.charAt(0).toUpperCase()+w.slice(1)},w))})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Vertical Alignment"}),u.jsx("div",{className:"flex gap-2 mt-1",children:["top","middle","bottom"].map(w=>u.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded ${b.config.style.verticalAlignment===w?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{const S={...b.config.style,verticalAlignment:w};g([...b.path,"style"],S)},children:w.charAt(0).toUpperCase()+w.slice(1)},w))})]})]})}),"labelStyle"in b.config&&b.isNextSlide&&u.jsx(Ur,{title:"Title Style",icon:Uf,children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Font Family"}),u.jsx(An,{value:b.config.labelStyle.fontFamily,onChange:w=>{v("labelStyle",{fontFamily:w})},options:Cy,className:"w-full"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Max Font Size (px)"}),u.jsx(br,{type:"number",value:b.config.labelStyle.maxFontSize,onChange:w=>{v("labelStyle",{maxFontSize:parseInt(w.target.value)||24})},className:"h-8"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Color"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"color",value:b.config.labelStyle.color,onChange:w=>{v("labelStyle",{color:w.target.value})},className:"w-10 h-8 rounded cursor-pointer"}),u.jsx(br,{value:b.config.labelStyle.color,onChange:w=>{v("labelStyle",{color:w.target.value})},className:"h-8 flex-1"})]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Wt,{checked:b.config.labelStyle.bold,onCheckedChange:w=>{v("labelStyle",{bold:!!w})},label:"Bold"}),u.jsx(Wt,{checked:b.config.labelStyle.italic,onCheckedChange:w=>{v("labelStyle",{italic:!!w})},label:"Italic"}),u.jsx(Wt,{checked:b.config.labelStyle.underline,onCheckedChange:w=>{v("labelStyle",{underline:!!w})},label:"Underline"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Horizontal Alignment"}),u.jsx("div",{className:"flex gap-2 mt-1",children:["left","center","right"].map(w=>u.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded ${b.config.labelStyle.alignment===w?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{v("labelStyle",{alignment:w})},children:w.charAt(0).toUpperCase()+w.slice(1)},w))})]}),u.jsx(Wt,{checked:b.config.labelStyle.shadow??!1,onCheckedChange:w=>{v("labelStyle",{shadow:!!w})},label:"Shadow"})]})}),"contentStyle"in b.config&&b.isNextSlide&&u.jsx(Ur,{title:"Content Style",icon:Uf,children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Font Family"}),u.jsx(An,{value:b.config.contentStyle.fontFamily,onChange:w=>{v("contentStyle",{fontFamily:w})},options:Cy,className:"w-full"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Max Font Size (px)"}),u.jsx(br,{type:"number",value:b.config.contentStyle.maxFontSize,onChange:w=>{v("contentStyle",{maxFontSize:parseInt(w.target.value)||24})},className:"h-8"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Color"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"color",value:b.config.contentStyle.color,onChange:w=>{v("contentStyle",{color:w.target.value})},className:"w-10 h-8 rounded cursor-pointer"}),u.jsx(br,{value:b.config.contentStyle.color,onChange:w=>{v("contentStyle",{color:w.target.value})},className:"h-8 flex-1"})]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(Wt,{checked:b.config.contentStyle.bold,onCheckedChange:w=>{v("contentStyle",{bold:!!w})},label:"Bold"}),u.jsx(Wt,{checked:b.config.contentStyle.italic,onCheckedChange:w=>{v("contentStyle",{italic:!!w})},label:"Italic"}),u.jsx(Wt,{checked:b.config.contentStyle.underline,onCheckedChange:w=>{v("contentStyle",{underline:!!w})},label:"Underline"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Horizontal Alignment"}),u.jsx("div",{className:"flex gap-2 mt-1",children:["left","center","right"].map(w=>u.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded ${b.config.contentStyle.alignment===w?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{v("contentStyle",{alignment:w})},children:w.charAt(0).toUpperCase()+w.slice(1)},w))})]}),u.jsx(Wt,{checked:b.config.contentStyle.shadow??!1,onCheckedChange:w=>{v("contentStyle",{shadow:!!w})},label:"Shadow"})]})}),"animationIn"in b.config&&u.jsx(Ur,{title:"Animation",icon:GI,defaultOpen:!1,children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400 mb-1 block",children:"Animation In"}),u.jsx(An,{value:b.config.animationIn.type,onChange:w=>{const S={...b.config.animationIn,type:w};g([...b.path,"animationIn"],S)},options:lT,className:"w-full mb-2"}),u.jsx("div",{className:"space-y-2",children:u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Duration (ms)"}),u.jsx(cb,{value:[b.config.animationIn.duration],onValueChange:([w])=>{const S={...b.config.animationIn,duration:w};g([...b.path,"animationIn"],S)},min:0,max:1e3,step:50})]})})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400 mb-1 block",children:"Animation Out"}),u.jsx(An,{value:b.config.animationOut.type,onChange:w=>{const S={...b.config.animationOut,type:w};g([...b.path,"animationOut"],S)},options:lT,className:"w-full mb-2"}),u.jsx("div",{className:"space-y-2",children:u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Duration (ms)"}),u.jsx(cb,{value:[b.config.animationOut.duration],onValueChange:([w])=>{const S={...b.config.animationOut,duration:w};g([...b.path,"animationOut"],S)},min:0,max:1e3,step:50})]})})]})]})}),n?.type==="clock"&&u.jsx(Ur,{title:"Clock Settings",icon:Pp,children:u.jsxs("div",{className:"space-y-3",children:[u.jsx(Wt,{checked:b.config.showSeconds,onCheckedChange:w=>{g([...b.path,"showSeconds"],!!w)},label:"Show seconds"}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Format"}),u.jsx("div",{className:"flex gap-2 mt-1",children:["24h","12h"].map(w=>u.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded ${b.config.format===w?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{g([...b.path,"format"],w)},children:w},w))})]}),u.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[u.jsx(Wt,{checked:b.config.style.compressLines??!1,onCheckedChange:w=>{const S={...b.config.style,compressLines:!!w};g([...b.path,"style"],S)},label:f("screens.textStyle.compressLines")}),b.config.style.compressLines&&u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:f("screens.textStyle.lineSeparator")}),u.jsx(An,{value:b.config.style.lineSeparator??"space",onChange:w=>{const S={...b.config.style,lineSeparator:w};g([...b.path,"style"],S)},options:KK.map(w=>({value:w.value,label:f(`screens.textStyle.separators.${w.key}`)})),className:"w-full"})]}),u.jsx(Wt,{checked:b.config.style.fitLineToWidth??!1,onCheckedChange:w=>{const S={...b.config.style,fitLineToWidth:!!w};g([...b.path,"style"],S)},label:f("screens.textStyle.fitLineToWidth")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 ml-6",children:f("screens.textStyle.fitLineToWidthDescription")})]})]})}),"style"in b.config&&u.jsx(Ur,{title:f("screens.editor.previewText"),icon:pa,defaultOpen:!1,children:u.jsxs("div",{className:"space-y-3",children:[u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:f("screens.editor.previewTextDescription")}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:f("screens.editor.customPreviewText")}),u.jsx("textarea",{className:"w-full h-24 px-3 py-2 text-sm border rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:f("screens.editor.previewTextPlaceholder"),value:(()=>{if(!n||!r)return"";switch(n.type){case"mainText":case"contentText":return r.main??"";case"referenceText":return r.reference??"";case"personLabel":return r.person??"";default:return""}})(),onChange:w=>{if(!(!n||!s))switch(n.type){case"mainText":case"contentText":s("main",w.target.value);break;case"referenceText":s("reference",w.target.value);break;case"personLabel":s("person",w.target.value);break}}})]}),r&&(r.main||r.reference||r.person)&&u.jsx(it,{variant:"ghost",size:"sm",onClick:()=>i?.(),children:f("screens.editor.resetPreviewText")})]})})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-800/50",children:u.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-200",children:"Screen Settings"})}),u.jsx(Ur,{title:"Screen Size",icon:di,children:u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Width (px)"}),u.jsx(br,{type:"number",value:t.width,disabled:!0,className:"h-8"})]}),u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Height (px)"}),u.jsx(br,{type:"number",value:t.height,disabled:!0,className:"h-8"})]})]})}),u.jsx(Ur,{title:"Background",icon:Gj,children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Type"}),u.jsx(An,{value:p.background.type,onChange:w=>{o(e,{...p,background:{...p.background,type:w}})},options:VK,className:"w-full"})]}),p.background.type==="color"&&u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Color"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"color",value:p.background.color??"#000000",onChange:w=>{o(e,{...p,background:{...p.background,color:w.target.value}})},className:"w-10 h-8 rounded cursor-pointer"}),u.jsx(br,{value:p.background.color??"#000000",onChange:w=>{o(e,{...p,background:{...p.background,color:w.target.value}})},className:"h-8 flex-1"})]})]}),(p.background.type==="image"||p.background.type==="video")&&u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"URL"}),u.jsx(br,{value:p.background.type==="image"?p.background.imageUrl??"":p.background.videoUrl??"",onChange:w=>{o(e,{...p,background:{...p.background,...p.background.type==="image"?{imageUrl:w.target.value}:{videoUrl:w.target.value}}})},placeholder:"Enter URL...",className:"h-8"})]})]})}),(e==="bible"||e==="bible_passage")&&u.jsx(Ur,{title:f("screens.bibleOptions.title"),icon:di,defaultOpen:!1,children:u.jsxs("div",{className:"space-y-3",children:[u.jsx(Wt,{checked:p.includeReferenceInContent??!1,onCheckedChange:w=>{o(e,{...p,includeReferenceInContent:!!w})},label:f("screens.bibleOptions.includeReferenceInContent")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 ml-6",children:f("screens.bibleOptions.includeReferenceInContentDescription")})]})}),u.jsx(Ur,{title:"Clock",icon:Uf,defaultOpen:!1,children:u.jsxs("div",{className:"space-y-3",children:[u.jsx(Wt,{checked:t.globalSettings.clockEnabled,onCheckedChange:w=>{d({...t.globalSettings,clockEnabled:!!w})},label:"Show clock on all slides"}),t.globalSettings.clockEnabled&&t.globalSettings.clockConfig&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx(pt,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Format"}),u.jsx("div",{className:"flex gap-2 mt-1",children:["24h","12h"].map(w=>u.jsx("button",{className:`flex-1 py-1.5 text-xs font-medium rounded ${t.globalSettings.clockConfig?.format===w?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{d({...t.globalSettings,clockConfig:{...t.globalSettings.clockConfig,format:w}})},children:w},w))})]}),u.jsx(Wt,{checked:t.globalSettings.clockConfig.showSeconds,onCheckedChange:w=>{d({...t.globalSettings,clockConfig:{...t.globalSettings.clockConfig,showSeconds:!!w}})},label:"Show seconds"})]})]})})]})})}const WK=[{value:"song",label:"Song"},{value:"bible",label:"Bible Verse"},{value:"bible_passage",label:"Bible Passage"},{value:"announcement",label:"Announcement"},{value:"versete_tineri",label:"Versete Tineri"},{value:"empty",label:"Empty / Clock"}];function YK({screen:t,onSave:e,onClose:n}){const[r,s]=UK(),{send:i}=tc(),o=Le(),l=C.useRef(0),d=C.useRef(!1),f=C.useRef(0),p=C.useRef(0);C.useEffect(()=>{s.setScreen(t),p.current=Date.now()},[]),C.useEffect(()=>{const S=Fu(t.id),T=o.getQueryCache().subscribe(j=>{if(j.type==="updated"&&j.query.queryKey[0]===S[0]&&j.query.queryKey[1]===S[1]){if(f.current>p.current){p.current=f.current;return}if(d.current){d.current=!1;return}const M=j.query.state.data;M&&(s.setScreenExternal(M),p.current=Date.now())}});return()=>T()},[t.id,o,s]),C.useEffect(()=>{if(!r.screen||!r.isDirty)return;const S=()=>{d.current=!0,i({type:"screen_config_preview",payload:{screenId:r.screen.id,config:r.screen}}),l.current=Date.now()},j=Date.now()-l.current;if(j<100){const M=setTimeout(S,100-j);return()=>clearTimeout(M)}S()},[r.screen,r.isDirty,i]);const g=C.useCallback(()=>{s.setZoom(Math.min(r.zoom+.25,2))},[r.zoom,s]),m=C.useCallback(()=>{s.setZoom(Math.max(r.zoom-.25,.5))},[r.zoom,s]),y=C.useCallback(()=>{s.setZoom(1)},[s]),b=C.useCallback(async()=>{if(r.screen){f.current=Date.now();try{await e(r.screen),s.markClean(),p.current=f.current,i({type:"screen_config_preview",payload:{screenId:r.screen.id,config:r.screen}})}catch{throw f.current=p.current,new Error("Save failed")}}},[r.screen,e,s,i]),v=C.useCallback(()=>{r.screen&&i({type:"screen_config_preview",payload:{screenId:r.screen.id,config:t}}),n()},[r.screen,t,i,n]),w=C.useCallback((S,T)=>{if(!r.screen)return;const M={...r.screen.contentConfigs[r.selectedContentType]};if(S==="mainText"&&"mainText"in M)M.mainText={...M.mainText,...T.constraints&&{constraints:T.constraints},...T.size&&{size:T.size}};else if(S==="contentText"&&"contentText"in M)M.contentText={...M.contentText,...T.constraints&&{constraints:T.constraints},...T.size&&{size:T.size}};else if(S==="referenceText"&&"referenceText"in M)M.referenceText={...M.referenceText,...T.constraints&&{constraints:T.constraints},...T.size&&{size:T.size}};else if(S==="personLabel"&&"personLabel"in M)M.personLabel={...M.personLabel,...T.constraints&&{constraints:T.constraints},...T.size&&{size:T.size}};else if(S==="clock"&&"clock"in M&&M.clock)M.clock={...M.clock,...T.constraints&&{constraints:T.constraints},...T.size&&{size:T.size}};else if(S==="nextSlide"&&r.screen.nextSlideConfig){s.updateNextSlideConfig({...r.screen.nextSlideConfig,...T.constraints&&{constraints:T.constraints},...T.size&&{size:T.size}});return}s.updateContentConfig(r.selectedContentType,M)},[r.screen,r.selectedContentType,s]);return r.screen?u.jsxs("div",{className:"flex flex-col h-full bg-gray-50 dark:bg-gray-950",children:[u.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:r.screen.name}),u.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 capitalize",children:r.screen.type})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Preview:"}),u.jsx(An,{value:r.selectedContentType,onChange:S=>{s.setSelectedContentType(S),s.clearSelection()},options:WK,className:"w-48"})]}),u.jsxs("div",{className:"flex items-center gap-1 border-l border-gray-200 dark:border-gray-700 pl-4",children:[u.jsx(it,{variant:"ghost",size:"icon",onClick:m,disabled:r.zoom<=.5,children:u.jsx(L6,{className:"w-4 h-4"})}),u.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 w-12 text-center",children:[Math.round(r.zoom*100),"%"]}),u.jsx(it,{variant:"ghost",size:"icon",onClick:g,disabled:r.zoom>=2,children:u.jsx(I6,{className:"w-4 h-4"})}),u.jsx(it,{variant:"ghost",size:"icon",onClick:y,children:u.jsx(t6,{className:"w-4 h-4"})})]}),u.jsxs("div",{className:"flex items-center gap-2 border-l border-gray-200 dark:border-gray-700 pl-4",children:[u.jsxs(it,{variant:"primary",onClick:b,disabled:!r.isDirty,children:[u.jsx(ld,{className:"w-4 h-4 mr-2"}),"Save"]}),u.jsx(it,{variant:"ghost",onClick:v,children:u.jsx(nt,{className:"w-4 h-4"})})]})]})]}),u.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[u.jsx(qK,{screen:r.screen,contentType:r.selectedContentType,selectedElement:r.selectedElement,zoom:r.zoom,previewTexts:r.previewTexts[r.selectedContentType],onSelectElement:s.setSelectedElement,onUpdateElement:w}),u.jsx(QK,{screen:r.screen,contentType:r.selectedContentType,selectedElement:r.selectedElement,previewTexts:r.previewTexts[r.selectedContentType],onSetPreviewText:(S,T)=>s.setPreviewText(r.selectedContentType,S,T),onResetPreviewTexts:()=>s.resetPreviewTexts(r.selectedContentType),onUpdateContentConfig:s.updateContentConfig,onUpdateNextSlideConfig:s.updateNextSlideConfig,onUpdateGlobalSettings:s.updateGlobalSettings})]})]}):u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading..."})})}const y5=C.forwardRef(({checked:t=!1,onCheckedChange:e,disabled:n,className:r="",id:s},i)=>{const o=s||`switch-${Math.random().toString(36).slice(2,9)}`;return u.jsx("button",{ref:i,type:"button",role:"switch","aria-checked":t,id:o,disabled:n,onClick:()=>e?.(!t),className:`
          relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent
          transition-colors duration-200 ease-in-out
          focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-gray-900
          ${t?"bg-indigo-600":"bg-gray-200 dark:bg-gray-700"}
          ${n?"opacity-50 cursor-not-allowed":""}
          ${r}
        `,children:u.jsx("span",{className:`
            pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0
            transition duration-200 ease-in-out
            ${t?"translate-x-5":"translate-x-0"}
          `})})});y5.displayName="Switch";const GK=[{value:"primary",label:"Primary / Audience"},{value:"stage",label:"Stage Monitor"},{value:"livestream",label:"Live Stream"}],XK={primary:"bg-blue-600",stage:"bg-purple-600",livestream:"bg-green-600"};function JK(){const{showToast:t}=mt(),{data:e,isLoading:n}=Wb(),r=GE(),s=lP(),i=oP(),[o,l]=C.useState(!1),[d,f]=C.useState(""),[p,g]=C.useState("primary"),[m,y]=C.useState(null),[b,v]=C.useState(null),[w,S]=C.useState(new Set),{data:T}=Gb(m),j=()=>{f(""),g("primary"),l(!0)},M=async()=>{if(d.trim())try{const B=await r.mutateAsync({name:d.trim(),type:p});l(!1),B&&y(B.id),t("Screen created successfully","success")}catch{t("Failed to create screen","error")}},_=B=>{y(B.id)},R=C.useCallback(async B=>{try{await i.mutateAsync({screenId:B.id,globalSettings:B.globalSettings,contentConfigs:B.contentConfigs,nextSlideConfig:B.type==="stage"?B.nextSlideConfig:void 0}),t("Screen saved successfully","success")}catch{t("Failed to save screen","error")}},[i,t]),O=()=>{y(null)},L=B=>{v(B)},A=async B=>{const E=w.has(B.id);try{E?(await vC(B.id),S(K=>{const q=new Set(K);return q.delete(B.id),q}),t(`Window "${B.name}" closed`,"success")):(await VE(B.id,"native",B.isFullscreen,B.name),S(K=>new Set(K).add(B.id)),t(`Window "${B.name}" opened`,"success"))}catch{t("Failed to toggle window","error")}},F=async B=>{const E=`${Sx()}/screen/${B.id}`;try{await navigator.clipboard.writeText(E),t("URL copied to clipboard","success")}catch{t("Failed to copy URL","error")}},H=async B=>{const E=`${Sx()}/screen/${B.id}`;await nP(E)},P=async()=>{if(b)try{await vC(b.id),S(B=>{const E=new Set(B);return E.delete(b.id),E}),await s.mutateAsync(b.id),v(null),t("Screen deleted successfully","success")}catch{t("Failed to delete screen","error")}};return n?u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600"})}):m&&T?u.jsx("div",{className:"fixed inset-0 z-50 bg-gray-50 dark:bg-gray-950",children:u.jsx(YK,{screen:T,onSave:R,onClose:O})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(Mh,{size:24,className:"text-indigo-600"}),u.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Screens"})]}),u.jsxs(it,{onClick:j,variant:"primary",children:[u.jsx(Xt,{size:20,className:"mr-2"}),"Add Screen"]})]}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Configure screens for different display purposes. Each screen type has its own layout and configuration options."}),e&&e.length>0?u.jsx("div",{className:"space-y-3",children:e.map(B=>u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 p-3 md:p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[u.jsx("div",{className:`w-3 h-3 rounded-full flex-shrink-0 ${w.has(B.id)?"bg-green-500":"bg-gray-400"}`}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate",children:B.name}),u.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[u.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full text-white ${XK[B.type]}`,children:B.type}),u.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[B.width,"",B.height]})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2 md:gap-3 flex-wrap",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 hidden md:inline",children:w.has(B.id)?"Open":"Closed"}),u.jsx(y5,{checked:w.has(B.id),onCheckedChange:()=>A(B)})]}),u.jsx("div",{className:"hidden md:block h-6 w-px bg-gray-200 dark:bg-gray-700"}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(it,{variant:"ghost",size:"sm",onClick:()=>H(B),title:"Open in new tab",children:u.jsx(Fp,{size:16})}),u.jsx(it,{variant:"ghost",size:"sm",onClick:()=>F(B),title:"Copy URL to clipboard",children:u.jsx(ad,{size:16})}),u.jsxs(it,{variant:"secondary",size:"sm",onClick:()=>_(B),title:"Edit screen",children:[u.jsx(eE,{size:16}),u.jsx("span",{className:"hidden md:inline ml-1",children:"Edit"})]}),u.jsx(it,{variant:"ghost",size:"sm",onClick:()=>L(B),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",title:"Delete screen",children:u.jsx(Fn,{size:16})})]})]})]},B.id))}):u.jsxs("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsx(Mh,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-4"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No screens configured"}),u.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Add your first screen to configure how content is displayed."}),u.jsxs(it,{onClick:j,variant:"primary",children:[u.jsx(Xt,{size:20,className:"mr-2"}),"Add First Screen"]})]}),o&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md mx-4 p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Add New Screen"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Screen Name"}),u.jsx("input",{type:"text",value:d,onChange:B=>f(B.target.value),placeholder:"e.g., Main Projector",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",autoFocus:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Screen Type"}),u.jsx(An,{value:p,onChange:B=>g(B),options:GK,className:"w-full"})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[u.jsx(it,{variant:"ghost",onClick:()=>l(!1),children:"Cancel"}),u.jsxs(it,{variant:"primary",onClick:M,disabled:!d.trim()||r.isPending,children:[r.isPending&&u.jsx(Qe,{size:16,className:"animate-spin mr-2"}),"Create & Configure"]})]})]})}),b&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-sm mx-4 p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Screen?"}),u.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:['Are you sure you want to delete "',b.name,'"? This action cannot be undone.']}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx(it,{variant:"ghost",onClick:()=>v(null),children:"Cancel"}),u.jsxs(it,{variant:"danger",onClick:P,disabled:s.isPending,children:[s.isPending&&u.jsx(Qe,{size:16,className:"animate-spin mr-2"}),"Delete"]})]})]})})]})}function ZK({songId:t,onPrevSlide:e,onNextSlide:n,canNavigatePrev:r,canNavigateNext:s}){const{t:i}=ke(["songs","bible"]);tc();const{data:o}=mi(),l=YE(),d=WE(),f=o?.temporaryContent?.type==="song"&&o.temporaryContent.data.songId===t,g=!(o?.isHidden??!0)&&f,m=async()=>{await l.mutateAsync()},y=async()=>{f?await d.mutateAsync({direction:"prev"}):e()},b=async()=>{f?await d.mutateAsync({direction:"next"}):n()};return u.jsxs("div",{className:"flex flex-col lg:h-full bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"flex items-center justify-end p-2 lg:p-3 border-b border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-md ${g?"bg-red-100 dark:bg-red-900/30":"bg-gray-100 dark:bg-gray-700"}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${g?"bg-red-500 animate-pulse":"bg-gray-400 dark:bg-gray-500"}`}),u.jsx("span",{className:`text-xs font-semibold ${g?"text-red-600 dark:text-red-400":"text-gray-400 dark:text-gray-500"}`,children:"LIVE"})]}),g?u.jsxs("button",{type:"button",onClick:m,disabled:l.isPending,className:"flex items-center gap-1.5 px-2 lg:px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 transition-colors",title:`${i("bible:controls.hide")} (Esc)`,children:[l.isPending?u.jsx(Qe,{size:18,className:"animate-spin"}):u.jsx(Jl,{size:18}),u.jsx("span",{className:"hidden sm:inline",children:i("bible:controls.hide")}),u.jsx("span",{className:"text-xs opacity-75 hidden sm:inline",children:"(Esc)"})]}):u.jsxs("button",{type:"button",disabled:!0,className:"flex items-center gap-1.5 px-2 lg:px-3 py-1.5 text-sm text-gray-400 dark:text-gray-500 rounded-lg border border-gray-300 dark:border-gray-600 opacity-50 cursor-not-allowed",children:[u.jsx(pa,{size:18}),u.jsx("span",{className:"hidden sm:inline",children:i("bible:controls.show")})]})]})}),u.jsxs("div",{className:"p-2 lg:p-3 lg:flex-1 lg:min-h-0 flex flex-col",children:[u.jsx("div",{className:"w-full lg:flex-1 lg:min-h-0 lg:flex lg:items-center lg:justify-center",children:u.jsx(n1,{})}),u.jsxs("div",{className:"flex items-center justify-center gap-2 pt-2 lg:pt-3 flex-shrink-0",children:[u.jsxs("button",{type:"button",onClick:y,disabled:!r||d.isPending||l.isPending,className:"flex items-center gap-1.5 px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",title:i("bible:controls.prev"),children:[u.jsx(Eb,{size:18}),u.jsx("span",{className:"text-sm",children:i("bible:controls.prev")})]}),u.jsxs("button",{type:"button",onClick:b,disabled:!s||d.isPending||l.isPending,className:"flex items-center gap-1.5 px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",title:i("bible:controls.next"),children:[u.jsx("span",{className:"text-sm",children:i("bible:controls.next")}),u.jsx(Ms,{size:18})]})]})]})]})}function eQ({slide:t,index:e,onContentChange:n,onClone:r,onDelete:s}){const{t:i}=ke("songs"),{attributes:o,listeners:l,setNodeRef:d,transform:f,transition:p,isDragging:g}=wo({id:t.id}),m={transform:us.Transform.toString(f),transition:p},y=Uv({extensions:[Zv.configure({heading:{levels:[1,2,3]}}),Bv.configure({types:["heading","paragraph"]})],content:t.content,editorProps:{attributes:{class:"min-h-[100px] p-4 focus:outline-none",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}},onUpdate:({editor:b})=>{n(b.getHTML())}});return C.useEffect(()=>{y&&t.content!==y.getHTML()&&y.commands.setContent(t.content)},[y,t.content]),u.jsxs("div",{ref:d,style:m,className:`bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden ${g?"opacity-50 shadow-lg":""}`,children:[u.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",...o,...l,className:"cursor-grab active:cursor-grabbing p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",children:u.jsx(cr,{className:"w-4 h-4 text-gray-400"})}),u.jsxs("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:[i("editor.slideNumber",{number:e+1}),t.label&&u.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-indigo-100 dark:bg-indigo-900/50 text-indigo-700 dark:text-indigo-300 rounded text-xs font-semibold",children:t.label})]})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{type:"button",onClick:r,className:"p-1.5 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors",title:i("actions.cloneSlide"),children:u.jsx(ad,{className:"w-4 h-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"})}),u.jsx("button",{type:"button",onClick:s,className:"p-1.5 hover:bg-red-100 dark:hover:bg-red-900/20 rounded transition-colors",title:i("actions.delete"),children:u.jsx(Fn,{className:"w-4 h-4 text-gray-400 hover:text-red-500"})})]})]}),u.jsxs("div",{className:"flex items-center gap-1 px-3 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:()=>y?.chain().focus().toggleBold().run(),className:`px-2.5 py-1 rounded text-sm font-bold ${y?.isActive("bold")?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:"B"}),u.jsx("button",{type:"button",onClick:()=>y?.chain().focus().toggleItalic().run(),className:`px-2.5 py-1 rounded text-sm font-medium italic ${y?.isActive("italic")?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:"I"}),u.jsx("div",{className:"w-px h-5 bg-gray-300 dark:bg-gray-600 mx-1"}),u.jsx("button",{type:"button",onClick:()=>y?.chain().focus().toggleHeading({level:1}).run(),className:`px-2.5 py-1 rounded text-sm font-medium ${y?.isActive("heading",{level:1})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:"H1"}),u.jsx("button",{type:"button",onClick:()=>y?.chain().focus().toggleHeading({level:2}).run(),className:`px-2.5 py-1 rounded text-sm font-medium ${y?.isActive("heading",{level:2})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:"H2"}),u.jsx("div",{className:"w-px h-5 bg-gray-300 dark:bg-gray-600 mx-1"}),u.jsx("button",{type:"button",onClick:()=>y?.chain().focus().setTextAlign("left").run(),className:`px-2.5 py-1 rounded text-sm ${y?.isActive({textAlign:"left"})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:""}),u.jsx("button",{type:"button",onClick:()=>y?.chain().focus().setTextAlign("center").run(),className:`px-2.5 py-1 rounded text-sm ${y?.isActive({textAlign:"center"})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:""}),u.jsx("button",{type:"button",onClick:()=>y?.chain().focus().setTextAlign("right").run(),className:`px-2.5 py-1 rounded text-sm ${y?.isActive({textAlign:"right"})?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:""}),u.jsx("div",{className:"w-px h-5 bg-gray-300 dark:bg-gray-600 mx-1"}),u.jsx("button",{type:"button",onClick:()=>y?.chain().focus().undo().run(),disabled:!y?.can().undo(),className:"p-1.5 rounded text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed",title:i("editor.undo"),children:u.jsx(v6,{className:"w-4 h-4"})}),u.jsx("button",{type:"button",onClick:()=>y?.chain().focus().redo().run(),disabled:!y?.can().redo(),className:"p-1.5 rounded text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed",title:i("editor.redo"),children:u.jsx(JD,{className:"w-4 h-4"})})]}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50",children:u.jsx(Fv,{editor:y,className:"prose prose-sm dark:prose-invert max-w-none [&_.ProseMirror]:text-gray-900 [&_.ProseMirror]:dark:text-gray-100"})})]})}function x5({slides:t,onSlidesChange:e}){const{t:n}=ke("songs"),[r,s]=C.useState(null),i=mo(ar(xi),ar(yi,{coordinateGetter:So})),o=g=>{const{active:m,over:y}=g;if(y&&m.id!==y.id){const b=t.findIndex(S=>S.id===m.id),v=t.findIndex(S=>S.id===y.id),w=ic(t,b,v).map((S,T)=>({...S,sortOrder:T}));e(w)}},l=()=>{const g={id:`temp-${Date.now()}`,content:"",sortOrder:t.length};e([...t,g])},d=(g,m)=>{const y=t.map(b=>b.id===g?{...b,content:m}:b);e(y)},f=g=>{const m=t.findIndex(v=>v.id===g.id),y={id:`temp-${Date.now()}`,content:g.content,sortOrder:m+1},b=[...t.slice(0,m+1),y,...t.slice(m+1)].map((v,w)=>({...v,sortOrder:w}));e(b)},p=()=>{if(!r)return;const g=t.filter(m=>m.id!==r.id).map((m,y)=>({...m,sortOrder:y}));e(g),s(null)};return u.jsxs("div",{className:"space-y-4",children:[t.length>0?u.jsx(xo,{sensors:i,collisionDetection:yo,onDragEnd:o,children:u.jsx(vo,{items:t.map(g=>g.id),strategy:bo,children:u.jsx("div",{className:"space-y-3",children:t.map((g,m)=>u.jsx(eQ,{slide:g,index:m,onContentChange:y=>d(g.id,y),onClone:()=>f(g),onDelete:()=>s(g)},g.id))})})}):u.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg",children:[u.jsx(KI,{className:"w-10 h-10 text-gray-400 mb-3"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n("editor.noSlides")})]}),u.jsxs("button",{type:"button",onClick:l,className:"w-full flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-400 hover:border-indigo-400 hover:text-indigo-600 dark:hover:border-indigo-500 dark:hover:text-indigo-400 transition-colors",children:[u.jsx(Xt,{size:20}),n("actions.addSlide")]}),u.jsx(fi,{isOpen:!!r,onCancel:()=>s(null),onConfirm:p,title:n("modal.deleteSlideTitle"),message:n("modal.deleteSlideMessage"),confirmLabel:n("actions.delete"),cancelLabel:n("common:buttons.cancel","Cancel"),variant:"danger"})]})}const tQ={author:null,copyright:null,ccli:null,key:null,tempo:null,timeSignature:null,theme:null,altTheme:null,hymnNumber:null,keyLine:null,presentationOrder:null,sourceFilename:null};function nQ({isNew:t,isLoading:e,isSaving:n,isDeleting:r,isDirty:s=!0,songId:i,title:o,categoryId:l,slides:d,metadata:f=tQ,presentationCount:p=0,lastManualEdit:g,onTitleChange:m,onCategoryChange:y,onSlidesChange:b,onMetadataChange:v,onSave:w,onDelete:S,onBack:T}){const{t:j}=ke(["songs","queue"]),M=lr(),{showToast:_}=mt(),[R,O]=C.useState(!1),[L,A]=C.useState(!1),[F,H]=C.useState(!1),[P,B]=C.useState(!1),[E,K]=C.useState(null),[q,V]=C.useState(!1),ie=C.useRef(null),Y=QE();C.useEffect(()=>{P?ie.current?.showModal():ie.current?.close()},[P]);const X=async()=>{if(i)try{await Y.mutateAsync({songId:i,slideIndex:0}),_(j("queue:messages.presenting"),"success"),M({to:"/songs/$songId",params:{songId:String(i)}})}catch{_(j("queue:messages.error"),"error")}},D=()=>{i&&(s?(K("present"),B(!0)):X())},U=()=>{i&&(s?(K("addToSchedule"),B(!0)):H(!0))},te=async()=>{V(!0);const Se=await w();V(!1),B(!1),Se&&(E==="present"?X():E==="addToSchedule"&&H(!0)),K(null)},Z=()=>{B(!1),E==="present"?X():E==="addToSchedule"&&H(!0),K(null)},re=()=>{B(!1),K(null)},se=Se=>{M({to:"/schedules/$scheduleId",params:{scheduleId:String(Se)}})},ge=Se=>{const Oe=Se.map((He,ut)=>({id:`temp-${Date.now()}-${ut}`,content:`<p>${He.replace(/\n/g,"<br>")}</p>`,sortOrder:d.length+ut}));b([...d,...Oe])},be=(Se,Oe)=>{v&&v(Se,Oe||null)},me=f.author||f.hymnNumber||f.key;return u.jsxs("div",{className:"space-y-6 [scrollbar-gutter:stable] [scrollbar-width:none] [&::-webkit-scrollbar]:hidden",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{type:"button",onClick:T,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:u.jsx(id,{size:20,className:"text-gray-600 dark:text-gray-400"})}),u.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e?u.jsx("span",{className:"inline-block w-48 h-8 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}):t?j("actions.create"):o||j("editor.titlePlaceholder")})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[!t&&i&&u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:U,disabled:e,className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50 transition-colors",title:j("songs:actions.addToSchedule"),children:[u.jsx(Th,{size:20}),u.jsx("span",{className:"hidden sm:inline",children:j("songs:actions.addToSchedule")})]}),u.jsxs("button",{type:"button",onClick:D,disabled:e||Y.isPending,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors",title:j("queue:actions.presentNow"),children:[u.jsx(Mb,{size:20}),u.jsx("span",{className:"hidden sm:inline",children:j("queue:actions.presentNow")})]})]}),!t&&S&&u.jsx("button",{type:"button",onClick:S,disabled:r||e,className:"p-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors disabled:opacity-50",title:j("songs:actions.delete"),children:r?u.jsx(Qe,{size:20,className:"animate-spin"}):u.jsx(Fn,{size:20})}),u.jsxs("button",{type:"button",onClick:w,disabled:n||e||!o.trim()||!s,className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors",children:[n?u.jsx(Qe,{size:20,className:"animate-spin"}):u.jsx(ld,{size:20}),j("songs:actions.save")]})]})]}),u.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("editor.titlePlaceholder").replace("...","")}),e?u.jsx("div",{className:"w-full h-10 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}):u.jsx("input",{id:"title",type:"text",value:o,onChange:Se=>m(Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white",placeholder:j("editor.titlePlaceholder")})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"keyLine",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.keyLine")}),e?u.jsx("div",{className:"w-full h-10 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}):u.jsx("input",{id:"keyLine",type:"text",value:f.keyLine||"",onChange:Se=>be("keyLine",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white",placeholder:j("metadata.keyLinePlaceholder")})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("category.name")}),e?u.jsx("div",{className:"w-full h-10 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}):u.jsx(Vp,{value:l,onChange:y})]}),u.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[u.jsxs("button",{type:"button",onClick:()=>A(!L),className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",children:[L?u.jsx(Eb,{size:16}):u.jsx(Ms,{size:16}),j("metadata.detailsSection"),!L&&me&&u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:[f.author,f.hymnNumber&&`#${f.hymnNumber}`,f.key].filter(Boolean).join("  ")})]}),L&&!e&&u.jsxs("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"author",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.author")}),u.jsx("input",{id:"author",type:"text",value:f.author||"",onChange:Se=>be("author",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"copyright",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.copyright")}),u.jsx("input",{id:"copyright",type:"text",value:f.copyright||"",onChange:Se=>be("copyright",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"ccli",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.ccli")}),u.jsx("input",{id:"ccli",type:"text",value:f.ccli||"",onChange:Se=>be("ccli",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"hymnNumber",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.hymnNumber")}),u.jsx("input",{id:"hymnNumber",type:"text",value:f.hymnNumber||"",onChange:Se=>be("hymnNumber",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"key",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.key")}),u.jsx("input",{id:"key",type:"text",value:f.key||"",onChange:Se=>be("key",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm",placeholder:j("metadata.keyPlaceholder")})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"tempo",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.tempo")}),u.jsx("input",{id:"tempo",type:"text",value:f.tempo||"",onChange:Se=>be("tempo",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"timeSignature",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.timeSignature")}),u.jsx("input",{id:"timeSignature",type:"text",value:f.timeSignature||"",onChange:Se=>be("timeSignature",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"theme",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.theme")}),u.jsx("input",{id:"theme",type:"text",value:f.theme||"",onChange:Se=>be("theme",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"altTheme",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.altTheme")}),u.jsx("input",{id:"altTheme",type:"text",value:f.altTheme||"",onChange:Se=>be("altTheme",Se.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white text-sm"})]}),f.sourceFilename&&u.jsxs("div",{className:"sm:col-span-2",children:[u.jsx("label",{htmlFor:"sourceFilename",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.sourceFilename")}),u.jsx("input",{id:"sourceFilename",type:"text",value:f.sourceFilename||"",readOnly:!0,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-400 text-sm cursor-not-allowed"})]}),f.presentationOrder&&u.jsxs("div",{className:"sm:col-span-2",children:[u.jsx("label",{htmlFor:"presentationOrder",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.presentationOrder")}),u.jsx("input",{id:"presentationOrder",type:"text",value:f.presentationOrder||"",readOnly:!0,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-400 text-sm cursor-not-allowed"})]}),!t&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"presentationCount",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.presentationCount")}),u.jsx("input",{id:"presentationCount",type:"text",value:p,readOnly:!0,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-400 text-sm cursor-not-allowed"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"lastManualEdit",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j("metadata.lastManualEdit")}),u.jsx("input",{id:"lastManualEdit",type:"text",value:g?new Date(g).toLocaleString():j("metadata.neverEdited"),readOnly:!0,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-400 text-sm cursor-not-allowed"})]})]})]})]})]})}),u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[u.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-gray-50 dark:bg-gray-900/50 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[j("editor.slides")," (",e?"-":d.length,")"]}),u.jsxs("button",{type:"button",onClick:()=>O(!0),disabled:e,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 rounded-lg transition-colors disabled:opacity-50",children:[u.jsx(Du,{className:"w-5 h-5"}),j("actions.importFromText")]})]}),u.jsx("div",{className:"p-6 bg-gray-100 dark:bg-gray-900/30",children:e?u.jsxs("div",{className:"space-y-3",children:[u.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}),u.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"})]}):u.jsx(x5,{slides:d,onSlidesChange:b})})]}),u.jsx(UP,{isOpen:R,onClose:()=>O(!1),onImport:ge}),i&&u.jsx(t1,{isOpen:F,songId:i,onClose:()=>H(!1),onAdded:se}),u.jsx("dialog",{ref:ie,className:"fixed inset-0 m-auto w-full max-w-md p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:Se=>{Se.target===ie.current&&!q&&re()},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:j(q?"songs:actions.save":"songs:modal.unsavedChangesTitle")}),!q&&u.jsx("button",{type:"button",onClick:re,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsx("div",{className:"p-4",children:q?u.jsxs("div",{className:"flex flex-col items-center justify-center py-4 gap-3",children:[u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:j("songs:messages.saving")})]}):u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:j("songs:modal.unsavedBeforeActionMessage")})}),!q&&u.jsxs("div",{className:"flex flex-col gap-2 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:te,className:"w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors",children:j("songs:modal.saveAndContinue")}),u.jsx("button",{type:"button",onClick:Z,className:"w-full px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:j("songs:modal.continueWithoutSaving")}),u.jsx("button",{type:"button",onClick:re,className:"w-full px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors",children:j("songs:modal.cancel")})]})]})})]})}const rQ={author:null,copyright:null,ccli:null,key:null,tempo:null,timeSignature:null,theme:null,altTheme:null,hymnNumber:null,keyLine:null,presentationOrder:null,sourceFilename:null};function b5({isOpen:t,onClose:e,songId:n,onSaved:r}){const{t:s}=ke(["songs","common"]),{showToast:i}=mt(),o=C.useRef(null),{data:l,isLoading:d}=Xb(n),f=Zb(),[p,g]=C.useState(""),[m,y]=C.useState(null),[b,v]=C.useState([]),[w,S]=C.useState(rQ),[T,j]=C.useState(!1);C.useEffect(()=>{l&&t&&(g(l.title),y(l.categoryId),v(l.slides.map(L=>({id:L.id,content:L.content,sortOrder:L.sortOrder,label:L.label}))),S({author:l.author,copyright:l.copyright,ccli:l.ccli,key:l.key,tempo:l.tempo,timeSignature:l.timeSignature,theme:l.theme,altTheme:l.altTheme,hymnNumber:l.hymnNumber,keyLine:l.keyLine,presentationOrder:l.presentationOrder,sourceFilename:l.sourceFilename}),j(!0))},[l,t]),C.useEffect(()=>{t||j(!1)},[t]),C.useEffect(()=>{t?o.current?.showModal():o.current?.close()},[t]);const M=C.useCallback(async()=>{if(!p.trim())return;const L=await f.mutateAsync({id:n,title:p.trim(),categoryId:m,slides:b.map((A,F)=>({id:typeof A.id=="number"?A.id:void 0,content:A.content,sortOrder:F,label:A.label})),author:w.author,copyright:w.copyright,ccli:w.ccli,key:w.key,tempo:w.tempo,timeSignature:w.timeSignature,theme:w.theme,altTheme:w.altTheme,hymnNumber:w.hymnNumber,keyLine:w.keyLine,presentationOrder:w.presentationOrder});L.success&&L.data?(i(s("songs:messages.saved"),"success"),v(L.data.slides.map(A=>({id:A.id,content:A.content,sortOrder:A.sortOrder,label:A.label}))),S({author:L.data.author,copyright:L.data.copyright,ccli:L.data.ccli,key:L.data.key,tempo:L.data.tempo,timeSignature:L.data.timeSignature,theme:L.data.theme,altTheme:L.data.altTheme,hymnNumber:L.data.hymnNumber,keyLine:L.data.keyLine,presentationOrder:L.data.presentationOrder}),r?.(),e()):i(s("songs:messages.error"),"error")},[p,m,b,w,n,f,i,s,r,e]);C.useEffect(()=>{if(!t)return;const L=A=>{(A.metaKey||A.ctrlKey)&&A.key==="s"&&(A.preventDefault(),f.isPending||M())};return document.addEventListener("keydown",L),()=>document.removeEventListener("keydown",L)},[t,M,f.isPending]);const _=()=>{f.isPending||e()},R=L=>{L.target===o.current&&_()},O=d||!T;return u.jsx("dialog",{ref:o,onCancel:_,onClick:R,className:"fixed inset-0 m-auto w-full max-w-4xl p-0 rounded-lg bg-white dark:bg-gray-800 backdrop:bg-black/50",children:u.jsxs("div",{className:"flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:O?u.jsx("span",{className:"inline-block w-48 h-6 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}):p||s("songs:editor.titlePlaceholder")}),u.jsx("button",{type:"button",onClick:_,disabled:f.isPending,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"modal-title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:s("songs:editor.titlePlaceholder").replace("...","")}),O?u.jsx("div",{className:"w-full h-10 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}):u.jsx("input",{id:"modal-title",type:"text",value:p,onChange:L=>g(L.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-900 dark:text-white",placeholder:s("songs:editor.titlePlaceholder")})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:s("songs:category.name")}),O?u.jsx("div",{className:"w-full h-10 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}):u.jsx(Vp,{value:m,onChange:y})]})]}),u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:[s("songs:editor.slides")," (",O?"-":b.length,")"]}),O?u.jsxs("div",{className:"space-y-3",children:[u.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}),u.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"})]}):u.jsx(x5,{slides:b,onSlidesChange:v})]})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:_,disabled:f.isPending,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg disabled:opacity-50",children:s("common:buttons.cancel")}),u.jsxs("button",{type:"button",onClick:M,disabled:f.isPending||O||!p.trim(),className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:[f.isPending?u.jsx(Qe,{size:18,className:"animate-spin"}):u.jsx(ld,{size:18}),s("songs:actions.save")]})]})]})})}const Ny=50;function v5({onSongClick:t,searchQuery:e="",onSearchChange:n}){const{t:r}=ke("songs"),s=C.useRef(null),[i,o]=C.useState(e),{data:l,isLoading:d}=PP(),{data:f,isLoading:p}=LP(i),{data:g}=Hp();C.useEffect(()=>{o(e)},[e]),C.useEffect(()=>{s.current?.focus()},[]);const m=i.length>0,y=m?p:d,{displaySongs:b,totalCount:v}=C.useMemo(()=>{let T;return m&&f?T=f.map(j=>({id:j.id,title:j.title,categoryId:j.categoryId,categoryName:j.categoryName,highlightedTitle:j.highlightedTitle,matchedContent:j.matchedContent})):T=l?.map(j=>({id:j.id,title:j.title,categoryId:j.categoryId,categoryName:g?.find(M=>M.id===j.categoryId)?.name??null}))??[],{displaySongs:T.slice(0,Ny),totalCount:T.length}},[m,f,l,g]),w=T=>{const j=T.target.value;o(j),n?.(j)},S=v>Ny;return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Zl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{ref:s,type:"text",value:i,onChange:w,placeholder:r("search.placeholder"),className:"w-full pl-10 pr-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors"})]}),y?u.jsx("div",{className:"grid gap-3",children:[1,2,3].map(T=>u.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"},T))}):b.length===0?u.jsxs("div",{className:"text-center py-12 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx(ya,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:m?r("search.noResults",{query:i}):r("noSongs")}),!m&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:r("noSongsDescription")})]}):u.jsxs("div",{className:"grid gap-3",children:[u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:m?r("search.resultsCount",{count:v}):r("search.showingCount",{showing:b.length,total:v})}),b.map(T=>u.jsx($P,{song:T,onClick:()=>t(T.id)},T.id)),S&&u.jsx("p",{className:"text-center text-sm text-gray-400 dark:text-gray-500 py-2",children:r("search.moreResults",{count:v-Ny})})]})]})}function pg({isOpen:t,onClose:e,afterItemId:n,onSongAdded:r,onSongSelect:s,hideAddToQueue:i}){const{t:o}=ke(["queue","songs"]),{showToast:l}=mt(),d=C.useRef(null),f=R8(),[p,g]=C.useState(!1),y=!!(s||i)?p:f.isPending;C.useEffect(()=>{t?d.current?.showModal():d.current?.close()},[t]),C.useEffect(()=>{const w=d.current;if(!w)return;const S=T=>{T.preventDefault(),y||e()};return w.addEventListener("cancel",S),()=>w.removeEventListener("cancel",S)},[e,y]);const b=async w=>{if(s){g(!0);try{await s(w),e()}finally{g(!1)}return}(await f.mutateAsync({songId:w,afterItemId:n})).success?(l(o("queue:messages.added"),"success"),r?.(),e()):l(o("queue:messages.error"),"error")},v=()=>{y||e()};return u.jsx("dialog",{ref:d,className:"fixed inset-0 m-auto w-full max-w-lg p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:w=>{w.target===d.current&&v()},onKeyDown:w=>{w.key==="Escape"&&v()},children:u.jsxs("div",{className:"flex flex-col max-h-[80vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:o("queue:addToQueue.searchSong")}),u.jsx("button",{type:"button",onClick:v,disabled:y,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:y?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"})}):u.jsx(v5,{onSongClick:b})})]})})}const sQ=100;function iQ(t){const e=document.createElement("textarea");return e.innerHTML=t,e.value}function aQ(t){const e=t.replace(/<\/p>\s*<p>/gi,`
`).replace(/<br\s*\/?>/gi,`
`).replace(/<[^>]*>/g,"").trim();return iQ(e)}function oQ({song:t,presentedSlideIndex:e,isLoading:n,onSlideClick:r}){const s=C.useRef(null),i=C.useRef(null);if(C.useEffect(()=>{if(s.current&&i.current){const l=i.current,f=s.current.getBoundingClientRect(),p=l.getBoundingClientRect(),g=f.top-p.top+l.scrollTop,m=Math.max(0,g-sQ);l.scrollTo({top:m,behavior:"smooth"})}},[e]),n)return u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600 dark:text-indigo-400"})});const o=[...t.slides].sort((l,d)=>l.sortOrder-d.sortOrder);return u.jsx("div",{className:"flex flex-col h-full",children:u.jsx("div",{ref:i,className:"flex-1 min-h-0 space-y-1 overflow-hidden lg:overflow-y-auto px-0.5 py-0.5",children:o.map((l,d)=>{const f=d===e,p=d+1,g=()=>f?"bg-green-100 dark:bg-green-900/50 ring-2 ring-green-500":"hover:bg-gray-100 dark:hover:bg-gray-700",m=()=>f?"text-green-700 dark:text-green-300":"text-gray-500 dark:text-gray-400",y=()=>f?"text-green-900 dark:text-green-100":"text-gray-700 dark:text-gray-200",b=aQ(l.content);return u.jsxs("button",{ref:f?s:null,type:"button",onClick:()=>!f&&r(l,d),className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${g()}`,children:[u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx("span",{className:`font-semibold text-sm min-w-[24px] ${m()}`,children:p}),u.jsx("span",{className:`text-sm whitespace-pre-line ${y()}`,children:b})]}),l.label&&u.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 ml-8 mt-1 block",children:l.label})]},l.id)})})})}function lQ({synonym:t,onEdit:e,onDelete:n}){const{t:r}=ke("settings");return u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"flex-1 min-w-0",children:u.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.primary}),u.jsx(vI,{size:14,className:"text-gray-400 dark:text-gray-500 shrink-0"}),u.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:t.synonyms.join(", ")})]})}),u.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[u.jsx("button",{type:"button",onClick:e,className:"p-2 text-gray-500 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors",title:r("sections.synonyms.actions.edit"),children:u.jsx(to,{size:16})}),u.jsx("button",{type:"button",onClick:n,className:"p-2 text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors",title:r("sections.synonyms.actions.delete"),children:u.jsx(Fn,{size:16})})]})]})}function cQ({isOpen:t,synonym:e,onSubmit:n,onCancel:r,isLoading:s}){const{t:i}=ke("settings"),o=C.useRef(null),l=C.useRef(null),[d,f]=C.useState(e?.primary??""),[p,g]=C.useState(e?.synonyms.join(", ")??"");C.useEffect(()=>{t?(o.current?.showModal(),l.current?.focus()):o.current?.close()},[t]),C.useEffect(()=>{f(e?.primary??""),g(e?.synonyms.join(", ")??"")},[e]);const m=b=>{if(b.preventDefault(),d.trim()&&p.trim()){const v=p.split(",").map(w=>w.trim().toLowerCase()).filter(w=>w.length>0);v.length>0&&n(d.trim().toLowerCase(),v)}},y=b=>{b.target===o.current&&r()};return u.jsx("dialog",{ref:o,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-md w-full",onClose:r,onClick:y,children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:i(e?"sections.synonyms.modals.edit.title":"sections.synonyms.modals.create.title")}),u.jsx("button",{type:"button",onClick:r,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:u.jsx(nt,{size:20})})]}),u.jsxs("form",{onSubmit:m,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("sections.synonyms.primaryTerm")}),u.jsx("input",{ref:l,type:"text",value:d,onChange:b=>f(b.target.value),placeholder:i("sections.synonyms.primaryTermPlaceholder"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("sections.synonyms.synonymTerms")}),u.jsx("input",{type:"text",value:p,onChange:b=>g(b.target.value),placeholder:i("sections.synonyms.synonymTermsPlaceholder"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0}),u.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:i("sections.synonyms.synonymTermsHint")})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:i("common:buttons.cancel","Cancel")}),u.jsx("button",{type:"submit",disabled:s||!d.trim()||!p.trim(),className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors disabled:opacity-50",children:i(e?"sections.synonyms.modals.edit.submit":"sections.synonyms.modals.create.submit")})]})]})]})})}const w5="search_synonyms";async function gg(){const t=await po("app_settings",w5);if(!t)return{groups:[]};try{return JSON.parse(t.value)}catch{return{groups:[]}}}async function r1(t){return await go("app_settings",{key:w5,value:JSON.stringify(t)})}async function uQ(t){const e=await gg(),n={...t,id:crypto.randomUUID()};return e.groups.push(n),await r1(e)}async function dQ(t){const e=await gg(),n=e.groups.findIndex(r=>r.id===t.id);return n===-1?!1:(e.groups[n]=t,await r1(e))}async function fQ(t){const e=await gg();return e.groups=e.groups.filter(n=>n.id!==t),await r1(e)}function hQ(){const t=Le();return De({mutationFn:fQ,onSuccess:e=>{e&&t.invalidateQueries({queryKey:["synonyms"]})}})}function pQ(){return lt({queryKey:["synonyms"],queryFn:async()=>(await gg()).groups})}function gQ(){const t=Le();return De({mutationFn:async e=>{if(e.id){const n={id:e.id,primary:e.primary,synonyms:e.synonyms};return await dQ(n)}return await uQ({primary:e.primary,synonyms:e.synonyms})},onSuccess:e=>{e&&t.invalidateQueries({queryKey:["synonyms"]})}})}function mQ(){const{t}=ke("settings"),{showToast:e}=mt(),{data:n,isLoading:r,error:s}=pQ(),i=gQ(),o=hQ(),[l,d]=C.useState({type:"none"}),f=async(m,y)=>{await i.mutateAsync({primary:m,synonyms:y})?(d({type:"none"}),e(t("sections.synonyms.toast.created"),"success")):e(t("sections.synonyms.toast.error"),"error")},p=async(m,y)=>{if(l.type!=="edit")return;await i.mutateAsync({id:l.synonym.id,primary:m,synonyms:y})?(d({type:"none"}),e(t("sections.synonyms.toast.updated"),"success")):e(t("sections.synonyms.toast.error"),"error")},g=async()=>{if(l.type!=="delete")return;await o.mutateAsync(l.synonym.id)?(d({type:"none"}),e(t("sections.synonyms.toast.deleted"),"success")):e(t("sections.synonyms.toast.error"),"error")};return r?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s?u.jsx("div",{className:"text-center py-8 text-red-500",children:t("sections.synonyms.toast.error")}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.synonyms.title")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("sections.synonyms.description")})]}),u.jsxs("button",{type:"button",onClick:()=>d({type:"create"}),className:"flex items-center gap-2 px-3 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors text-sm whitespace-nowrap shrink-0",children:[u.jsx(Xt,{size:16}),t("sections.synonyms.addSynonym")]})]}),n&&n.length>0?u.jsx("div",{className:"space-y-2",children:n.map(m=>u.jsx(lQ,{synonym:m,onEdit:()=>d({type:"edit",synonym:m}),onDelete:()=>d({type:"delete",synonym:m})},m.id))}):u.jsxs("div",{className:"text-center py-12 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx(Zl,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:t("sections.synonyms.noSynonyms")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:t("sections.synonyms.noSynonymsDescription")})]}),(l.type==="create"||l.type==="edit")&&u.jsx(cQ,{isOpen:!0,synonym:l.type==="edit"?l.synonym:void 0,onSubmit:l.type==="create"?f:p,onCancel:()=>d({type:"none"}),isLoading:i.isPending}),l.type==="delete"&&u.jsx(fi,{isOpen:!0,title:t("sections.synonyms.modals.delete.title"),message:t("sections.synonyms.modals.delete.message",{primary:l.synonym.primary}),confirmLabel:t("sections.synonyms.modals.delete.confirm"),cancelLabel:t("common:buttons.cancel","Cancel"),onConfirm:g,onCancel:()=>d({type:"none"}),variant:"danger"})]})}function yQ({isOpen:t,onConfirm:e,onCancel:n}){const{t:r}=ke("settings"),s=C.useRef(null),[i,o]=C.useState("all"),[l,d]=C.useState(null);C.useEffect(()=>{const g=s.current;g&&(t?g.showModal():g.close())},[t]),C.useEffect(()=>{t||(o("all"),d(null))},[t]);const f=g=>{g.target===s.current&&n()},p=()=>{e(i==="all"?null:l)};return u.jsx("dialog",{ref:s,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:n,onClick:f,children:u.jsxs("div",{className:"p-6 min-w-[400px] max-w-lg",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Eh,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r("sections.importExport.export.title")})]}),u.jsx("button",{type:"button",onClick:n,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded transition-colors",children:u.jsx(nt,{className:"w-5 h-5"})})]}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:r("sections.importExport.export.description")}),u.jsxs("div",{className:"space-y-4 mb-6",children:[u.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[u.jsx("input",{type:"radio",name:"exportScope",checked:i==="all",onChange:()=>o("all"),className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600"}),u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:r("sections.importExport.export.allSongs")})]}),u.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[u.jsx("input",{type:"radio",name:"exportScope",checked:i==="category",onChange:()=>o("category"),className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600"}),u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:r("sections.importExport.export.byCategory")})]}),i==="category"&&u.jsx("div",{className:"ml-7",children:u.jsx(Vp,{value:l,onChange:d,placeholder:r("sections.importExport.export.selectCategory")})})]}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:r("common:buttons.cancel",{ns:"common"})}),u.jsx("button",{type:"button",onClick:p,disabled:i==="category"&&l===null,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:r("sections.importExport.export.button")})]})]})})}function xQ({isOpen:t,progress:e}){const{t:n}=ke("settings");if(!t)return null;const r=()=>{if(!e)return n("sections.importExport.export.exporting");switch(e.phase){case"fetching":return n("sections.importExport.export.fetching");case"generating":return n("sections.importExport.export.generating");case"zipping":return n("sections.importExport.export.zipping");case"saving":return n("sections.importExport.export.saving");default:return n("sections.importExport.export.exporting")}},s=e&&e.total>0?Math.round(e.current/e.total*100):0;return u.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[u.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),u.jsx("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-8 max-w-md w-full mx-4",children:u.jsxs("div",{className:"flex flex-col items-center gap-6",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Qe,{className:"w-16 h-16 text-indigo-600 animate-spin"}),e&&e.total>0&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsxs("span",{className:"text-sm font-semibold text-indigo-600",children:[s,"%"]})})]}),u.jsxs("div",{className:"text-center space-y-2",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r()}),e&&e.total>0&&u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n("sections.importExport.export.processingProgress",{current:e.current,total:e.total})}),e.currentSong&&u.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 truncate max-w-xs",children:e.currentSong})]})]}),u.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:u.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${s}%`}})})]})})]})}async function S5(t={}){return typeof t=="object"&&Object.freeze(t),await Yt("plugin:dialog|open",{options:t})}async function k5(t={}){return typeof t=="object"&&Object.freeze(t),await Yt("plugin:dialog|save",{options:t})}var cT;(function(t){t[t.Audio=1]="Audio",t[t.Cache=2]="Cache",t[t.Config=3]="Config",t[t.Data=4]="Data",t[t.LocalData=5]="LocalData",t[t.Document=6]="Document",t[t.Download=7]="Download",t[t.Picture=8]="Picture",t[t.Public=9]="Public",t[t.Video=10]="Video",t[t.Resource=11]="Resource",t[t.Temp=12]="Temp",t[t.AppConfig=13]="AppConfig",t[t.AppData=14]="AppData",t[t.AppLocalData=15]="AppLocalData",t[t.AppCache=16]="AppCache",t[t.AppLog=17]="AppLog",t[t.Desktop=18]="Desktop",t[t.Executable=19]="Executable",t[t.Font=20]="Font",t[t.Home=21]="Home",t[t.Runtime=22]="Runtime",t[t.Template=23]="Template"})(cT||(cT={}));var uT;(function(t){t[t.Start=0]="Start",t[t.Current=1]="Current",t[t.End=2]="End"})(uT||(uT={}));function bQ(t){return{isFile:t.isFile,isDirectory:t.isDirectory,isSymlink:t.isSymlink,size:t.size,mtime:t.mtime!==null?new Date(t.mtime):null,atime:t.atime!==null?new Date(t.atime):null,birthtime:t.birthtime!==null?new Date(t.birthtime):null,readonly:t.readonly,fileAttributes:t.fileAttributes,dev:t.dev,ino:t.ino,mode:t.mode,nlink:t.nlink,uid:t.uid,gid:t.gid,rdev:t.rdev,blksize:t.blksize,blocks:t.blocks}}function vQ(t){const e=new Uint8ClampedArray(t),n=e.byteLength;let r=0;for(let s=0;s<n;s++){const i=e[s];r*=256,r+=i}return r}class wQ extends aI{async read(e){if(e.byteLength===0)return 0;const n=await Yt("plugin:fs|read",{rid:this.rid,len:e.byteLength}),r=vQ(n.slice(-8)),s=n instanceof ArrayBuffer?new Uint8Array(n):n;return e.set(s.slice(0,s.length-8)),r===0?null:r}async seek(e,n){return await Yt("plugin:fs|seek",{rid:this.rid,offset:e,whence:n})}async stat(){const e=await Yt("plugin:fs|fstat",{rid:this.rid});return bQ(e)}async truncate(e){await Yt("plugin:fs|ftruncate",{rid:this.rid,len:e})}async write(e){return await Yt("plugin:fs|write",{rid:this.rid,data:e})}}async function SQ(t,e){if(t instanceof URL&&t.protocol!=="file:")throw new TypeError("Must be a file URL.");const n=await Yt("plugin:fs|open",{path:t instanceof URL?t.toString():t,options:e});return new wQ(n)}async function hu(t,e){if(t instanceof URL&&t.protocol!=="file:")throw new TypeError("Must be a file URL.");const n=await Yt("plugin:fs|read_file",{path:t instanceof URL?t.toString():t,options:e});return n instanceof ArrayBuffer?new Uint8Array(n):Uint8Array.from(n)}async function kQ(t,e,n){if(t instanceof URL&&t.protocol!=="file:")throw new TypeError("Must be a file URL.");if(e instanceof ReadableStream){const r=await SQ(t,{read:!1,create:!0,write:!0,...n}),s=e.getReader();try{for(;;){const{done:i,value:o}=await s.read();if(i)break;await r.write(o)}}finally{s.releaseLock(),await r.close()}}else await Yt("plugin:fs|write_file",e,{headers:{path:encodeURIComponent(t instanceof URL?t.toString():t),options:JSON.stringify(n)}})}async function CQ(t){const e=new URLSearchParams;t!==null&&e.set("categoryId",String(t));const n=e.toString(),r=n?`/api/songs/export?${n}`:"/api/songs/export";return(await Me(r)).data??[]}function lh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ty={exports:{}};var dT;function NQ(){return dT||(dT=1,(function(t,e){(function(n){t.exports=n()})(function(){return(function n(r,s,i){function o(f,p){if(!s[f]){if(!r[f]){var g=typeof lh=="function"&&lh;if(!p&&g)return g(f,!0);if(l)return l(f,!0);var m=new Error("Cannot find module '"+f+"'");throw m.code="MODULE_NOT_FOUND",m}var y=s[f]={exports:{}};r[f][0].call(y.exports,function(b){var v=r[f][1][b];return o(v||b)},y,y.exports,n,r,s,i)}return s[f].exports}for(var l=typeof lh=="function"&&lh,d=0;d<i.length;d++)o(i[d]);return o})({1:[function(n,r,s){var i=n("./utils"),o=n("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(d){for(var f,p,g,m,y,b,v,w=[],S=0,T=d.length,j=T,M=i.getTypeOf(d)!=="string";S<d.length;)j=T-S,g=M?(f=d[S++],p=S<T?d[S++]:0,S<T?d[S++]:0):(f=d.charCodeAt(S++),p=S<T?d.charCodeAt(S++):0,S<T?d.charCodeAt(S++):0),m=f>>2,y=(3&f)<<4|p>>4,b=1<j?(15&p)<<2|g>>6:64,v=2<j?63&g:64,w.push(l.charAt(m)+l.charAt(y)+l.charAt(b)+l.charAt(v));return w.join("")},s.decode=function(d){var f,p,g,m,y,b,v=0,w=0,S="data:";if(d.substr(0,S.length)===S)throw new Error("Invalid base64 input, it looks like a data url.");var T,j=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===l.charAt(64)&&j--,d.charAt(d.length-2)===l.charAt(64)&&j--,j%1!=0)throw new Error("Invalid base64 input, bad content length.");for(T=o.uint8array?new Uint8Array(0|j):new Array(0|j);v<d.length;)f=l.indexOf(d.charAt(v++))<<2|(m=l.indexOf(d.charAt(v++)))>>4,p=(15&m)<<4|(y=l.indexOf(d.charAt(v++)))>>2,g=(3&y)<<6|(b=l.indexOf(d.charAt(v++))),T[w++]=f,y!==64&&(T[w++]=p),b!==64&&(T[w++]=g);return T}},{"./support":30,"./utils":32}],2:[function(n,r,s){var i=n("./external"),o=n("./stream/DataWorker"),l=n("./stream/Crc32Probe"),d=n("./stream/DataLengthProbe");function f(p,g,m,y,b){this.compressedSize=p,this.uncompressedSize=g,this.crc32=m,this.compression=y,this.compressedContent=b}f.prototype={getContentWorker:function(){var p=new o(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),g=this;return p.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),p},getCompressedWorker:function(){return new o(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(p,g,m){return p.pipe(new l).pipe(new d("uncompressedSize")).pipe(g.compressWorker(m)).pipe(new d("compressedSize")).withStreamInfo("compression",g)},r.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,s){var i=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,s){var i=n("./utils"),o=(function(){for(var l,d=[],f=0;f<256;f++){l=f;for(var p=0;p<8;p++)l=1&l?3988292384^l>>>1:l>>>1;d[f]=l}return d})();r.exports=function(l,d){return l!==void 0&&l.length?i.getTypeOf(l)!=="string"?(function(f,p,g,m){var y=o,b=m+g;f^=-1;for(var v=m;v<b;v++)f=f>>>8^y[255&(f^p[v])];return-1^f})(0|d,l,l.length,0):(function(f,p,g,m){var y=o,b=m+g;f^=-1;for(var v=m;v<b;v++)f=f>>>8^y[255&(f^p.charCodeAt(v))];return-1^f})(0|d,l,l.length,0):0}},{"./utils":32}],5:[function(n,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,r,s){var i=null;i=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=n("pako"),l=n("./utils"),d=n("./stream/GenericWorker"),f=i?"uint8array":"array";function p(g,m){d.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=m,this.meta={}}s.magic="\b\0",l.inherits(p,d),p.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(f,g.data),!1)},p.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},p.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},p.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(m){g.push({data:m,meta:g.meta})}},s.compressWorker=function(g){return new p("Deflate",g)},s.uncompressWorker=function(){return new p("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,s){function i(y,b){var v,w="";for(v=0;v<b;v++)w+=String.fromCharCode(255&y),y>>>=8;return w}function o(y,b,v,w,S,T){var j,M,_=y.file,R=y.compression,O=T!==f.utf8encode,L=l.transformTo("string",T(_.name)),A=l.transformTo("string",f.utf8encode(_.name)),F=_.comment,H=l.transformTo("string",T(F)),P=l.transformTo("string",f.utf8encode(F)),B=A.length!==_.name.length,E=P.length!==F.length,K="",q="",V="",ie=_.dir,Y=_.date,X={crc32:0,compressedSize:0,uncompressedSize:0};b&&!v||(X.crc32=y.crc32,X.compressedSize=y.compressedSize,X.uncompressedSize=y.uncompressedSize);var D=0;b&&(D|=8),O||!B&&!E||(D|=2048);var U=0,te=0;ie&&(U|=16),S==="UNIX"?(te=798,U|=(function(re,se){var ge=re;return re||(ge=se?16893:33204),(65535&ge)<<16})(_.unixPermissions,ie)):(te=20,U|=(function(re){return 63&(re||0)})(_.dosPermissions)),j=Y.getUTCHours(),j<<=6,j|=Y.getUTCMinutes(),j<<=5,j|=Y.getUTCSeconds()/2,M=Y.getUTCFullYear()-1980,M<<=4,M|=Y.getUTCMonth()+1,M<<=5,M|=Y.getUTCDate(),B&&(q=i(1,1)+i(p(L),4)+A,K+="up"+i(q.length,2)+q),E&&(V=i(1,1)+i(p(H),4)+P,K+="uc"+i(V.length,2)+V);var Z="";return Z+=`
\0`,Z+=i(D,2),Z+=R.magic,Z+=i(j,2),Z+=i(M,2),Z+=i(X.crc32,4),Z+=i(X.compressedSize,4),Z+=i(X.uncompressedSize,4),Z+=i(L.length,2),Z+=i(K.length,2),{fileRecord:g.LOCAL_FILE_HEADER+Z+L+K,dirRecord:g.CENTRAL_FILE_HEADER+i(te,2)+Z+i(H.length,2)+"\0\0\0\0"+i(U,4)+i(w,4)+L+K+H}}var l=n("../utils"),d=n("../stream/GenericWorker"),f=n("../utf8"),p=n("../crc32"),g=n("../signature");function m(y,b,v,w){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=v,this.encodeFileName=w,this.streamFiles=y,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(m,d),m.prototype.push=function(y){var b=y.meta.percent||0,v=this.entriesCount,w=this._sources.length;this.accumulate?this.contentBuffer.push(y):(this.bytesWritten+=y.data.length,d.prototype.push.call(this,{data:y.data,meta:{currentFile:this.currentFile,percent:v?(b+100*(v-w-1))/v:100}}))},m.prototype.openedSource=function(y){this.currentSourceOffset=this.bytesWritten,this.currentFile=y.file.name;var b=this.streamFiles&&!y.file.dir;if(b){var v=o(y,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(y){this.accumulate=!1;var b=this.streamFiles&&!y.file.dir,v=o(y,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),b)this.push({data:(function(w){return g.DATA_DESCRIPTOR+i(w.crc32,4)+i(w.compressedSize,4)+i(w.uncompressedSize,4)})(y),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var y=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var v=this.bytesWritten-y,w=(function(S,T,j,M,_){var R=l.transformTo("string",_(M));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(S,2)+i(S,2)+i(T,4)+i(j,4)+i(R.length,2)+R})(this.dirRecords.length,v,y,this.zipComment,this.encodeFileName);this.push({data:w,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(y){this._sources.push(y);var b=this;return y.on("data",function(v){b.processChunk(v)}),y.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),y.on("error",function(v){b.error(v)}),this},m.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(y){var b=this._sources;if(!d.prototype.error.call(this,y))return!1;for(var v=0;v<b.length;v++)try{b[v].error(y)}catch{}return!0},m.prototype.lock=function(){d.prototype.lock.call(this);for(var y=this._sources,b=0;b<y.length;b++)y[b].lock()},r.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,s){var i=n("../compressions"),o=n("./ZipFileWorker");s.generateWorker=function(l,d,f){var p=new o(d.streamFiles,f,d.platform,d.encodeFileName),g=0;try{l.forEach(function(m,y){g++;var b=(function(T,j){var M=T||j,_=i[M];if(!_)throw new Error(M+" is not a valid compression method !");return _})(y.options.compression,d.compression),v=y.options.compressionOptions||d.compressionOptions||{},w=y.dir,S=y.date;y._compressWorker(b,v).withStreamInfo("file",{name:m,dir:w,date:S,comment:y.comment||"",unixPermissions:y.unixPermissions,dosPermissions:y.dosPermissions}).pipe(p)}),p.entriesCount=g}catch(m){p.error(m)}return p}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new i;for(var l in this)typeof this[l]!="function"&&(o[l]=this[l]);return o}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(o,l){return new i().loadAsync(o,l)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,s){var i=n("./utils"),o=n("./external"),l=n("./utf8"),d=n("./zipEntries"),f=n("./stream/Crc32Probe"),p=n("./nodejsUtils");function g(m){return new o.Promise(function(y,b){var v=m.decompressed.getContentWorker().pipe(new f);v.on("error",function(w){b(w)}).on("end",function(){v.streamInfo.crc32!==m.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):y()}).resume()})}r.exports=function(m,y){var b=this;return y=i.extend(y||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),p.isNode&&p.isStream(m)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",m,!0,y.optimizedBinaryString,y.base64).then(function(v){var w=new d(y);return w.load(v),w}).then(function(v){var w=[o.Promise.resolve(v)],S=v.files;if(y.checkCRC32)for(var T=0;T<S.length;T++)w.push(g(S[T]));return o.Promise.all(w)}).then(function(v){for(var w=v.shift(),S=w.files,T=0;T<S.length;T++){var j=S[T],M=j.fileNameStr,_=i.resolve(j.fileNameStr);b.file(_,j.decompressed,{binary:!0,optimizedBinaryString:!0,date:j.date,dir:j.dir,comment:j.fileCommentStr.length?j.fileCommentStr:null,unixPermissions:j.unixPermissions,dosPermissions:j.dosPermissions,createFolders:y.createFolders}),j.dir||(b.file(_).unsafeOriginalName=M)}return w.zipComment.length&&(b.comment=w.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,s){var i=n("../utils"),o=n("../stream/GenericWorker");function l(d,f){o.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(f)}i.inherits(l,o),l.prototype._bindStream=function(d){var f=this;(this._stream=d).pause(),d.on("data",function(p){f.push({data:p,meta:{percent:0}})}).on("error",function(p){f.isPaused?this.generatedError=p:f.error(p)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},l.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,s){var i=n("readable-stream").Readable;function o(l,d,f){i.call(this,d),this._helper=l;var p=this;l.on("data",function(g,m){p.push(g)||p._helper.pause(),f&&f(m)}).on("error",function(g){p.emit("error",g)}).on("end",function(){p.push(null)})}n("../utils").inherits(o,i),o.prototype._read=function(){this._helper.resume()},r.exports=o},{"../utils":32,"readable-stream":16}],14:[function(n,r,s){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,o);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,o)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var o=new Buffer(i);return o.fill(0),o},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,s){function i(_,R,O){var L,A=l.getTypeOf(R),F=l.extend(O||{},p);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(_=S(_)),F.createFolders&&(L=w(_))&&T.call(this,L,!0);var H=A==="string"&&F.binary===!1&&F.base64===!1;O&&O.binary!==void 0||(F.binary=!H),(R instanceof g&&R.uncompressedSize===0||F.dir||!R||R.length===0)&&(F.base64=!1,F.binary=!0,R="",F.compression="STORE",A="string");var P=null;P=R instanceof g||R instanceof d?R:b.isNode&&b.isStream(R)?new v(_,R):l.prepareContent(_,R,F.binary,F.optimizedBinaryString,F.base64);var B=new m(_,P,F);this.files[_]=B}var o=n("./utf8"),l=n("./utils"),d=n("./stream/GenericWorker"),f=n("./stream/StreamHelper"),p=n("./defaults"),g=n("./compressedObject"),m=n("./zipObject"),y=n("./generate"),b=n("./nodejsUtils"),v=n("./nodejs/NodejsStreamInputAdapter"),w=function(_){_.slice(-1)==="/"&&(_=_.substring(0,_.length-1));var R=_.lastIndexOf("/");return 0<R?_.substring(0,R):""},S=function(_){return _.slice(-1)!=="/"&&(_+="/"),_},T=function(_,R){return R=R!==void 0?R:p.createFolders,_=S(_),this.files[_]||i.call(this,_,null,{dir:!0,createFolders:R}),this.files[_]};function j(_){return Object.prototype.toString.call(_)==="[object RegExp]"}var M={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(_){var R,O,L;for(R in this.files)L=this.files[R],(O=R.slice(this.root.length,R.length))&&R.slice(0,this.root.length)===this.root&&_(O,L)},filter:function(_){var R=[];return this.forEach(function(O,L){_(O,L)&&R.push(L)}),R},file:function(_,R,O){if(arguments.length!==1)return _=this.root+_,i.call(this,_,R,O),this;if(j(_)){var L=_;return this.filter(function(F,H){return!H.dir&&L.test(F)})}var A=this.files[this.root+_];return A&&!A.dir?A:null},folder:function(_){if(!_)return this;if(j(_))return this.filter(function(A,F){return F.dir&&_.test(A)});var R=this.root+_,O=T.call(this,R),L=this.clone();return L.root=O.name,L},remove:function(_){_=this.root+_;var R=this.files[_];if(R||(_.slice(-1)!=="/"&&(_+="/"),R=this.files[_]),R&&!R.dir)delete this.files[_];else for(var O=this.filter(function(A,F){return F.name.slice(0,_.length)===_}),L=0;L<O.length;L++)delete this.files[O[L].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(_){var R,O={};try{if((O=l.extend(_||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=O.type.toLowerCase(),O.compression=O.compression.toUpperCase(),O.type==="binarystring"&&(O.type="string"),!O.type)throw new Error("No output type specified.");l.checkSupport(O.type),O.platform!=="darwin"&&O.platform!=="freebsd"&&O.platform!=="linux"&&O.platform!=="sunos"||(O.platform="UNIX"),O.platform==="win32"&&(O.platform="DOS");var L=O.comment||this.comment||"";R=y.generateWorker(this,O,L)}catch(A){(R=new d("error")).error(A)}return new f(R,O.type||"string",O.mimeType)},generateAsync:function(_,R){return this.generateInternalStream(_).accumulate(R)},generateNodeStream:function(_,R){return(_=_||{}).type||(_.type="nodebuffer"),this.generateInternalStream(_).toNodejsStream(R)}};r.exports=M},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,s){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,s){var i=n("./DataReader");function o(l){i.call(this,l);for(var d=0;d<this.data.length;d++)l[d]=255&l[d]}n("../utils").inherits(o,i),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var d=l.charCodeAt(0),f=l.charCodeAt(1),p=l.charCodeAt(2),g=l.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===d&&this.data[m+1]===f&&this.data[m+2]===p&&this.data[m+3]===g)return m-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var d=l.charCodeAt(0),f=l.charCodeAt(1),p=l.charCodeAt(2),g=l.charCodeAt(3),m=this.readData(4);return d===m[0]&&f===m[1]&&p===m[2]&&g===m[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,d},r.exports=o},{"../utils":32,"./DataReader":18}],18:[function(n,r,s){var i=n("../utils");function o(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var d,f=0;for(this.checkOffset(l),d=this.index+l-1;d>=this.index;d--)f=(f<<8)+this.byteAt(d);return this.index+=l,f},readString:function(l){return i.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},r.exports=o},{"../utils":32}],19:[function(n,r,s){var i=n("./Uint8ArrayReader");function o(l){i.call(this,l)}n("../utils").inherits(o,i),o.prototype.readData=function(l){this.checkOffset(l);var d=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,d},r.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,s){var i=n("./DataReader");function o(l){i.call(this,l)}n("../utils").inherits(o,i),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},o.prototype.readData=function(l){this.checkOffset(l);var d=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,d},r.exports=o},{"../utils":32,"./DataReader":18}],21:[function(n,r,s){var i=n("./ArrayReader");function o(l){i.call(this,l)}n("../utils").inherits(o,i),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,d},r.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,s){var i=n("../utils"),o=n("../support"),l=n("./ArrayReader"),d=n("./StringReader"),f=n("./NodeBufferReader"),p=n("./Uint8ArrayReader");r.exports=function(g){var m=i.getTypeOf(g);return i.checkSupport(m),m!=="string"||o.uint8array?m==="nodebuffer"?new f(g):o.uint8array?new p(i.transformTo("uint8array",g)):new l(i.transformTo("array",g)):new d(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,s){var i=n("./GenericWorker"),o=n("../utils");function l(d){i.call(this,"ConvertWorker to "+d),this.destType=d}o.inherits(l,i),l.prototype.processChunk=function(d){this.push({data:o.transformTo(this.destType,d.data),meta:d.meta})},r.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,s){var i=n("./GenericWorker"),o=n("../crc32");function l(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(l,i),l.prototype.processChunk=function(d){this.streamInfo.crc32=o(d.data,this.streamInfo.crc32||0),this.push(d)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,s){var i=n("../utils"),o=n("./GenericWorker");function l(d){o.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}i.inherits(l,o),l.prototype.processChunk=function(d){if(d){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+d.data.length}o.prototype.processChunk.call(this,d)},r.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,s){var i=n("../utils"),o=n("./GenericWorker");function l(d){o.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(p){f.dataIsReady=!0,f.data=p,f.max=p&&p.length||0,f.type=i.getTypeOf(p),f.isPaused||f._tickAndRepeat()},function(p){f.error(p)})}i.inherits(l,o),l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,f);break;case"uint8array":d=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":d=this.data.slice(this.index,f)}return this.index=f,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,s){function i(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,l){return this._listeners[o].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,l){if(this._listeners[o])for(var d=0;d<this._listeners[o].length;d++)this._listeners[o][d].call(this,l)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var l=this;return o.on("data",function(d){l.processChunk(d)}),o.on("end",function(){l.end()}),o.on("error",function(d){l.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,l){return this.extraStreamInfo[o]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},r.exports=i},{}],29:[function(n,r,s){var i=n("../utils"),o=n("./ConvertWorker"),l=n("./GenericWorker"),d=n("../base64"),f=n("../support"),p=n("../external"),g=null;if(f.nodestream)try{g=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(b,v){return new p.Promise(function(w,S){var T=[],j=b._internalType,M=b._outputType,_=b._mimeType;b.on("data",function(R,O){T.push(R),v&&v(O)}).on("error",function(R){T=[],S(R)}).on("end",function(){try{var R=(function(O,L,A){switch(O){case"blob":return i.newBlob(i.transformTo("arraybuffer",L),A);case"base64":return d.encode(L);default:return i.transformTo(O,L)}})(M,(function(O,L){var A,F=0,H=null,P=0;for(A=0;A<L.length;A++)P+=L[A].length;switch(O){case"string":return L.join("");case"array":return Array.prototype.concat.apply([],L);case"uint8array":for(H=new Uint8Array(P),A=0;A<L.length;A++)H.set(L[A],F),F+=L[A].length;return H;case"nodebuffer":return Buffer.concat(L);default:throw new Error("concat : unsupported type '"+O+"'")}})(j,T),_);w(R)}catch(O){S(O)}T=[]}).resume()})}function y(b,v,w){var S=v;switch(v){case"blob":case"arraybuffer":S="uint8array";break;case"base64":S="string"}try{this._internalType=S,this._outputType=v,this._mimeType=w,i.checkSupport(S),this._worker=b.pipe(new o(S)),b.lock()}catch(T){this._worker=new l("error"),this._worker.error(T)}}y.prototype={accumulate:function(b){return m(this,b)},on:function(b,v){var w=this;return b==="data"?this._worker.on(b,function(S){v.call(w,S.data,S.meta)}):this._worker.on(b,function(){i.delay(v,arguments,w)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},b)}},r.exports=y},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(i),s.blob=o.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,s){for(var i=n("./utils"),o=n("./support"),l=n("./nodejsUtils"),d=n("./stream/GenericWorker"),f=new Array(256),p=0;p<256;p++)f[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;f[254]=f[254]=1;function g(){d.call(this,"utf-8 decode"),this.leftOver=null}function m(){d.call(this,"utf-8 encode")}s.utf8encode=function(y){return o.nodebuffer?l.newBufferFrom(y,"utf-8"):(function(b){var v,w,S,T,j,M=b.length,_=0;for(T=0;T<M;T++)(64512&(w=b.charCodeAt(T)))==55296&&T+1<M&&(64512&(S=b.charCodeAt(T+1)))==56320&&(w=65536+(w-55296<<10)+(S-56320),T++),_+=w<128?1:w<2048?2:w<65536?3:4;for(v=o.uint8array?new Uint8Array(_):new Array(_),T=j=0;j<_;T++)(64512&(w=b.charCodeAt(T)))==55296&&T+1<M&&(64512&(S=b.charCodeAt(T+1)))==56320&&(w=65536+(w-55296<<10)+(S-56320),T++),w<128?v[j++]=w:(w<2048?v[j++]=192|w>>>6:(w<65536?v[j++]=224|w>>>12:(v[j++]=240|w>>>18,v[j++]=128|w>>>12&63),v[j++]=128|w>>>6&63),v[j++]=128|63&w);return v})(y)},s.utf8decode=function(y){return o.nodebuffer?i.transformTo("nodebuffer",y).toString("utf-8"):(function(b){var v,w,S,T,j=b.length,M=new Array(2*j);for(v=w=0;v<j;)if((S=b[v++])<128)M[w++]=S;else if(4<(T=f[S]))M[w++]=65533,v+=T-1;else{for(S&=T===2?31:T===3?15:7;1<T&&v<j;)S=S<<6|63&b[v++],T--;1<T?M[w++]=65533:S<65536?M[w++]=S:(S-=65536,M[w++]=55296|S>>10&1023,M[w++]=56320|1023&S)}return M.length!==w&&(M.subarray?M=M.subarray(0,w):M.length=w),i.applyFromCharCode(M)})(y=i.transformTo(o.uint8array?"uint8array":"array",y))},i.inherits(g,d),g.prototype.processChunk=function(y){var b=i.transformTo(o.uint8array?"uint8array":"array",y.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var v=b;(b=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),b.set(v,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var w=(function(T,j){var M;for((j=j||T.length)>T.length&&(j=T.length),M=j-1;0<=M&&(192&T[M])==128;)M--;return M<0||M===0?j:M+f[T[M]]>j?M:j})(b),S=b;w!==b.length&&(o.uint8array?(S=b.subarray(0,w),this.leftOver=b.subarray(w,b.length)):(S=b.slice(0,w),this.leftOver=b.slice(w,b.length))),this.push({data:s.utf8decode(S),meta:y.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=g,i.inherits(m,d),m.prototype.processChunk=function(y){this.push({data:s.utf8encode(y.data),meta:y.meta})},s.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,s){var i=n("./support"),o=n("./base64"),l=n("./nodejsUtils"),d=n("./external");function f(v){return v}function p(v,w){for(var S=0;S<v.length;++S)w[S]=255&v.charCodeAt(S);return w}n("setimmediate"),s.newBlob=function(v,w){s.checkSupport("blob");try{return new Blob([v],{type:w})}catch{try{var S=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return S.append(v),S.getBlob(w)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(v,w,S){var T=[],j=0,M=v.length;if(M<=S)return String.fromCharCode.apply(null,v);for(;j<M;)w==="array"||w==="nodebuffer"?T.push(String.fromCharCode.apply(null,v.slice(j,Math.min(j+S,M)))):T.push(String.fromCharCode.apply(null,v.subarray(j,Math.min(j+S,M)))),j+=S;return T.join("")},stringifyByChar:function(v){for(var w="",S=0;S<v.length;S++)w+=String.fromCharCode(v[S]);return w},applyCanBeUsed:{uint8array:(function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}})()}};function m(v){var w=65536,S=s.getTypeOf(v),T=!0;if(S==="uint8array"?T=g.applyCanBeUsed.uint8array:S==="nodebuffer"&&(T=g.applyCanBeUsed.nodebuffer),T)for(;1<w;)try{return g.stringifyByChunk(v,S,w)}catch{w=Math.floor(w/2)}return g.stringifyByChar(v)}function y(v,w){for(var S=0;S<v.length;S++)w[S]=v[S];return w}s.applyFromCharCode=m;var b={};b.string={string:f,array:function(v){return p(v,new Array(v.length))},arraybuffer:function(v){return b.string.uint8array(v).buffer},uint8array:function(v){return p(v,new Uint8Array(v.length))},nodebuffer:function(v){return p(v,l.allocBuffer(v.length))}},b.array={string:m,array:f,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return l.newBufferFrom(v)}},b.arraybuffer={string:function(v){return m(new Uint8Array(v))},array:function(v){return y(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:f,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return l.newBufferFrom(new Uint8Array(v))}},b.uint8array={string:m,array:function(v){return y(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:f,nodebuffer:function(v){return l.newBufferFrom(v)}},b.nodebuffer={string:m,array:function(v){return y(v,new Array(v.length))},arraybuffer:function(v){return b.nodebuffer.uint8array(v).buffer},uint8array:function(v){return y(v,new Uint8Array(v.length))},nodebuffer:f},s.transformTo=function(v,w){if(w=w||"",!v)return w;s.checkSupport(v);var S=s.getTypeOf(w);return b[S][v](w)},s.resolve=function(v){for(var w=v.split("/"),S=[],T=0;T<w.length;T++){var j=w[T];j==="."||j===""&&T!==0&&T!==w.length-1||(j===".."?S.pop():S.push(j))}return S.join("/")},s.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":i.nodebuffer&&l.isBuffer(v)?"nodebuffer":i.uint8array&&v instanceof Uint8Array?"uint8array":i.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(v){if(!i[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(v){var w,S,T="";for(S=0;S<(v||"").length;S++)T+="\\x"+((w=v.charCodeAt(S))<16?"0":"")+w.toString(16).toUpperCase();return T},s.delay=function(v,w,S){setImmediate(function(){v.apply(S||null,w||[])})},s.inherits=function(v,w){function S(){}S.prototype=w.prototype,v.prototype=new S},s.extend=function(){var v,w,S={};for(v=0;v<arguments.length;v++)for(w in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],w)&&S[w]===void 0&&(S[w]=arguments[v][w]);return S},s.prepareContent=function(v,w,S,T,j){return d.Promise.resolve(w).then(function(M){return i.blob&&(M instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(M))!==-1)&&typeof FileReader<"u"?new d.Promise(function(_,R){var O=new FileReader;O.onload=function(L){_(L.target.result)},O.onerror=function(L){R(L.target.error)},O.readAsArrayBuffer(M)}):M}).then(function(M){var _=s.getTypeOf(M);return _?(_==="arraybuffer"?M=s.transformTo("uint8array",M):_==="string"&&(j?M=o.decode(M):S&&T!==!0&&(M=(function(R){return p(R,i.uint8array?new Uint8Array(R.length):new Array(R.length))})(M))),M):d.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,s){var i=n("./reader/readerFor"),o=n("./utils"),l=n("./signature"),d=n("./zipEntry"),f=n("./support");function p(g){this.files=[],this.loadOptions=g}p.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(m)+", expected "+o.pretty(g)+")")}},isSignature:function(g,m){var y=this.reader.index;this.reader.setIndex(g);var b=this.reader.readString(4)===m;return this.reader.setIndex(y),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),m=f.uint8array?"uint8array":"array",y=o.transformTo(m,g);this.zipComment=this.loadOptions.decodeFileName(y)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,m,y,b=this.zip64EndOfCentralSize-44;0<b;)g=this.reader.readInt(2),m=this.reader.readInt(4),y=this.reader.readData(m),this.zip64ExtensibleData[g]={id:g,length:m,value:y}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,m;for(g=0;g<this.files.length;g++)m=this.files[g],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(g=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var m=g;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var y=this.centralDirOffset+this.centralDirSize;this.zip64&&(y+=20,y+=12+this.zip64EndOfCentralSize);var b=m-y;if(0<b)this.isSignature(m,l.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(g){this.reader=i(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=p},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,s){var i=n("./reader/readerFor"),o=n("./utils"),l=n("./compressedObject"),d=n("./crc32"),f=n("./utf8"),p=n("./compressions"),g=n("./support");function m(y,b){this.options=y,this.loadOptions=b}m.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(y){var b,v;if(y.skip(22),this.fileNameLength=y.readInt(2),v=y.readInt(2),this.fileName=y.readData(this.fileNameLength),y.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((b=(function(w){for(var S in p)if(Object.prototype.hasOwnProperty.call(p,S)&&p[S].magic===w)return p[S];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,b,y.readData(this.compressedSize))},readCentralPart:function(y){this.versionMadeBy=y.readInt(2),y.skip(2),this.bitFlag=y.readInt(2),this.compressionMethod=y.readString(2),this.date=y.readDate(),this.crc32=y.readInt(4),this.compressedSize=y.readInt(4),this.uncompressedSize=y.readInt(4);var b=y.readInt(2);if(this.extraFieldsLength=y.readInt(2),this.fileCommentLength=y.readInt(2),this.diskNumberStart=y.readInt(2),this.internalFileAttributes=y.readInt(2),this.externalFileAttributes=y.readInt(4),this.localHeaderOffset=y.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");y.skip(b),this.readExtraFields(y),this.parseZIP64ExtraField(y),this.fileComment=y.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var y=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),y==0&&(this.dosPermissions=63&this.externalFileAttributes),y==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var y=i(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=y.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=y.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=y.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=y.readInt(4))}},readExtraFields:function(y){var b,v,w,S=y.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});y.index+4<S;)b=y.readInt(2),v=y.readInt(2),w=y.readData(v),this.extraFields[b]={id:b,length:v,value:w};y.setIndex(S)},handleUTF8:function(){var y=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var v=o.transformTo(y,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var w=this.findExtraFieldUnicodeComment();if(w!==null)this.fileCommentStr=w;else{var S=o.transformTo(y,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(S)}}},findExtraFieldUnicodePath:function(){var y=this.extraFields[28789];if(y){var b=i(y.value);return b.readInt(1)!==1||d(this.fileName)!==b.readInt(4)?null:f.utf8decode(b.readData(y.length-5))}return null},findExtraFieldUnicodeComment:function(){var y=this.extraFields[25461];if(y){var b=i(y.value);return b.readInt(1)!==1||d(this.fileComment)!==b.readInt(4)?null:f.utf8decode(b.readData(y.length-5))}return null}},r.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,s){function i(b,v,w){this.name=b,this.dir=w.dir,this.date=w.date,this.comment=w.comment,this.unixPermissions=w.unixPermissions,this.dosPermissions=w.dosPermissions,this._data=v,this._dataBinary=w.binary,this.options={compression:w.compression,compressionOptions:w.compressionOptions}}var o=n("./stream/StreamHelper"),l=n("./stream/DataWorker"),d=n("./utf8"),f=n("./compressedObject"),p=n("./stream/GenericWorker");i.prototype={internalStream:function(b){var v=null,w="string";try{if(!b)throw new Error("No output type specified.");var S=(w=b.toLowerCase())==="string"||w==="text";w!=="binarystring"&&w!=="text"||(w="string"),v=this._decompressWorker();var T=!this._dataBinary;T&&!S&&(v=v.pipe(new d.Utf8EncodeWorker)),!T&&S&&(v=v.pipe(new d.Utf8DecodeWorker))}catch(j){(v=new p("error")).error(j)}return new o(v,w,"")},async:function(b,v){return this.internalStream(b).accumulate(v)},nodeStream:function(b,v){return this.internalStream(b||"nodebuffer").toNodejsStream(v)},_compressWorker:function(b,v){if(this._data instanceof f&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var w=this._decompressWorker();return this._dataBinary||(w=w.pipe(new d.Utf8EncodeWorker)),f.createWorkerFrom(w,b,v)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof p?this._data:new l(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},y=0;y<g.length;y++)i.prototype[g[y]]=m;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,s){(function(i){var o,l,d=i.MutationObserver||i.WebKitMutationObserver;if(d){var f=0,p=new d(b),g=i.document.createTextNode("");p.observe(g,{characterData:!0}),o=function(){g.data=f=++f%2}}else if(i.setImmediate||i.MessageChannel===void 0)o="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var v=i.document.createElement("script");v.onreadystatechange=function(){b(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},i.document.documentElement.appendChild(v)}:function(){setTimeout(b,0)};else{var m=new i.MessageChannel;m.port1.onmessage=b,o=function(){m.port2.postMessage(0)}}var y=[];function b(){var v,w;l=!0;for(var S=y.length;S;){for(w=y,y=[],v=-1;++v<S;)w[v]();S=y.length}l=!1}r.exports=function(v){y.push(v)!==1||l||o()}}).call(this,typeof Of<"u"?Of:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,s){var i=n("immediate");function o(){}var l={},d=["REJECTED"],f=["FULFILLED"],p=["PENDING"];function g(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,S!==o&&v(this,S)}function m(S,T,j){this.promise=S,typeof T=="function"&&(this.onFulfilled=T,this.callFulfilled=this.otherCallFulfilled),typeof j=="function"&&(this.onRejected=j,this.callRejected=this.otherCallRejected)}function y(S,T,j){i(function(){var M;try{M=T(j)}catch(_){return l.reject(S,_)}M===S?l.reject(S,new TypeError("Cannot resolve promise with itself")):l.resolve(S,M)})}function b(S){var T=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof T=="function")return function(){T.apply(S,arguments)}}function v(S,T){var j=!1;function M(O){j||(j=!0,l.reject(S,O))}function _(O){j||(j=!0,l.resolve(S,O))}var R=w(function(){T(_,M)});R.status==="error"&&M(R.value)}function w(S,T){var j={};try{j.value=S(T),j.status="success"}catch(M){j.status="error",j.value=M}return j}(r.exports=g).prototype.finally=function(S){if(typeof S!="function")return this;var T=this.constructor;return this.then(function(j){return T.resolve(S()).then(function(){return j})},function(j){return T.resolve(S()).then(function(){throw j})})},g.prototype.catch=function(S){return this.then(null,S)},g.prototype.then=function(S,T){if(typeof S!="function"&&this.state===f||typeof T!="function"&&this.state===d)return this;var j=new this.constructor(o);return this.state!==p?y(j,this.state===f?S:T,this.outcome):this.queue.push(new m(j,S,T)),j},m.prototype.callFulfilled=function(S){l.resolve(this.promise,S)},m.prototype.otherCallFulfilled=function(S){y(this.promise,this.onFulfilled,S)},m.prototype.callRejected=function(S){l.reject(this.promise,S)},m.prototype.otherCallRejected=function(S){y(this.promise,this.onRejected,S)},l.resolve=function(S,T){var j=w(b,T);if(j.status==="error")return l.reject(S,j.value);var M=j.value;if(M)v(S,M);else{S.state=f,S.outcome=T;for(var _=-1,R=S.queue.length;++_<R;)S.queue[_].callFulfilled(T)}return S},l.reject=function(S,T){S.state=d,S.outcome=T;for(var j=-1,M=S.queue.length;++j<M;)S.queue[j].callRejected(T);return S},g.resolve=function(S){return S instanceof this?S:l.resolve(new this(o),S)},g.reject=function(S){var T=new this(o);return l.reject(T,S)},g.all=function(S){var T=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=S.length,M=!1;if(!j)return this.resolve([]);for(var _=new Array(j),R=0,O=-1,L=new this(o);++O<j;)A(S[O],O);return L;function A(F,H){T.resolve(F).then(function(P){_[H]=P,++R!==j||M||(M=!0,l.resolve(L,_))},function(P){M||(M=!0,l.reject(L,P))})}},g.race=function(S){var T=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=S.length,M=!1;if(!j)return this.resolve([]);for(var _=-1,R=new this(o);++_<j;)O=S[_],T.resolve(O).then(function(L){M||(M=!0,l.resolve(R,L))},function(L){M||(M=!0,l.reject(R,L))});var O;return R}},{immediate:36}],38:[function(n,r,s){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,s){var i=n("./zlib/deflate"),o=n("./utils/common"),l=n("./utils/strings"),d=n("./zlib/messages"),f=n("./zlib/zstream"),p=Object.prototype.toString,g=0,m=-1,y=0,b=8;function v(S){if(!(this instanceof v))return new v(S);this.options=o.assign({level:m,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:y,to:""},S||{});var T=this.options;T.raw&&0<T.windowBits?T.windowBits=-T.windowBits:T.gzip&&0<T.windowBits&&T.windowBits<16&&(T.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var j=i.deflateInit2(this.strm,T.level,T.method,T.windowBits,T.memLevel,T.strategy);if(j!==g)throw new Error(d[j]);if(T.header&&i.deflateSetHeader(this.strm,T.header),T.dictionary){var M;if(M=typeof T.dictionary=="string"?l.string2buf(T.dictionary):p.call(T.dictionary)==="[object ArrayBuffer]"?new Uint8Array(T.dictionary):T.dictionary,(j=i.deflateSetDictionary(this.strm,M))!==g)throw new Error(d[j]);this._dict_set=!0}}function w(S,T){var j=new v(T);if(j.push(S,!0),j.err)throw j.msg||d[j.err];return j.result}v.prototype.push=function(S,T){var j,M,_=this.strm,R=this.options.chunkSize;if(this.ended)return!1;M=T===~~T?T:T===!0?4:0,typeof S=="string"?_.input=l.string2buf(S):p.call(S)==="[object ArrayBuffer]"?_.input=new Uint8Array(S):_.input=S,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new o.Buf8(R),_.next_out=0,_.avail_out=R),(j=i.deflate(_,M))!==1&&j!==g)return this.onEnd(j),!(this.ended=!0);_.avail_out!==0&&(_.avail_in!==0||M!==4&&M!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(o.shrinkBuf(_.output,_.next_out))):this.onData(o.shrinkBuf(_.output,_.next_out)))}while((0<_.avail_in||_.avail_out===0)&&j!==1);return M===4?(j=i.deflateEnd(this.strm),this.onEnd(j),this.ended=!0,j===g):M!==2||(this.onEnd(g),!(_.avail_out=0))},v.prototype.onData=function(S){this.chunks.push(S)},v.prototype.onEnd=function(S){S===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=S,this.msg=this.strm.msg},s.Deflate=v,s.deflate=w,s.deflateRaw=function(S,T){return(T=T||{}).raw=!0,w(S,T)},s.gzip=function(S,T){return(T=T||{}).gzip=!0,w(S,T)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,s){var i=n("./zlib/inflate"),o=n("./utils/common"),l=n("./utils/strings"),d=n("./zlib/constants"),f=n("./zlib/messages"),p=n("./zlib/zstream"),g=n("./zlib/gzheader"),m=Object.prototype.toString;function y(v){if(!(this instanceof y))return new y(v);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},v||{});var w=this.options;w.raw&&0<=w.windowBits&&w.windowBits<16&&(w.windowBits=-w.windowBits,w.windowBits===0&&(w.windowBits=-15)),!(0<=w.windowBits&&w.windowBits<16)||v&&v.windowBits||(w.windowBits+=32),15<w.windowBits&&w.windowBits<48&&(15&w.windowBits)==0&&(w.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var S=i.inflateInit2(this.strm,w.windowBits);if(S!==d.Z_OK)throw new Error(f[S]);this.header=new g,i.inflateGetHeader(this.strm,this.header)}function b(v,w){var S=new y(w);if(S.push(v,!0),S.err)throw S.msg||f[S.err];return S.result}y.prototype.push=function(v,w){var S,T,j,M,_,R,O=this.strm,L=this.options.chunkSize,A=this.options.dictionary,F=!1;if(this.ended)return!1;T=w===~~w?w:w===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof v=="string"?O.input=l.binstring2buf(v):m.call(v)==="[object ArrayBuffer]"?O.input=new Uint8Array(v):O.input=v,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new o.Buf8(L),O.next_out=0,O.avail_out=L),(S=i.inflate(O,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&A&&(R=typeof A=="string"?l.string2buf(A):m.call(A)==="[object ArrayBuffer]"?new Uint8Array(A):A,S=i.inflateSetDictionary(this.strm,R)),S===d.Z_BUF_ERROR&&F===!0&&(S=d.Z_OK,F=!1),S!==d.Z_STREAM_END&&S!==d.Z_OK)return this.onEnd(S),!(this.ended=!0);O.next_out&&(O.avail_out!==0&&S!==d.Z_STREAM_END&&(O.avail_in!==0||T!==d.Z_FINISH&&T!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(j=l.utf8border(O.output,O.next_out),M=O.next_out-j,_=l.buf2string(O.output,j),O.next_out=M,O.avail_out=L-M,M&&o.arraySet(O.output,O.output,j,M,0),this.onData(_)):this.onData(o.shrinkBuf(O.output,O.next_out)))),O.avail_in===0&&O.avail_out===0&&(F=!0)}while((0<O.avail_in||O.avail_out===0)&&S!==d.Z_STREAM_END);return S===d.Z_STREAM_END&&(T=d.Z_FINISH),T===d.Z_FINISH?(S=i.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===d.Z_OK):T!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(O.avail_out=0))},y.prototype.onData=function(v){this.chunks.push(v)},y.prototype.onEnd=function(v){v===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},s.Inflate=y,s.inflate=b,s.inflateRaw=function(v,w){return(w=w||{}).raw=!0,b(v,w)},s.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(d){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var p=f.shift();if(p){if(typeof p!="object")throw new TypeError(p+"must be non-object");for(var g in p)p.hasOwnProperty(g)&&(d[g]=p[g])}}return d},s.shrinkBuf=function(d,f){return d.length===f?d:d.subarray?d.subarray(0,f):(d.length=f,d)};var o={arraySet:function(d,f,p,g,m){if(f.subarray&&d.subarray)d.set(f.subarray(p,p+g),m);else for(var y=0;y<g;y++)d[m+y]=f[p+y]},flattenChunks:function(d){var f,p,g,m,y,b;for(f=g=0,p=d.length;f<p;f++)g+=d[f].length;for(b=new Uint8Array(g),f=m=0,p=d.length;f<p;f++)y=d[f],b.set(y,m),m+=y.length;return b}},l={arraySet:function(d,f,p,g,m){for(var y=0;y<g;y++)d[m+y]=f[p+y]},flattenChunks:function(d){return[].concat.apply([],d)}};s.setTyped=function(d){d?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,o)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,l))},s.setTyped(i)},{}],42:[function(n,r,s){var i=n("./common"),o=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var d=new i.Buf8(256),f=0;f<256;f++)d[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function p(g,m){if(m<65537&&(g.subarray&&l||!g.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(g,m));for(var y="",b=0;b<m;b++)y+=String.fromCharCode(g[b]);return y}d[254]=d[254]=1,s.string2buf=function(g){var m,y,b,v,w,S=g.length,T=0;for(v=0;v<S;v++)(64512&(y=g.charCodeAt(v)))==55296&&v+1<S&&(64512&(b=g.charCodeAt(v+1)))==56320&&(y=65536+(y-55296<<10)+(b-56320),v++),T+=y<128?1:y<2048?2:y<65536?3:4;for(m=new i.Buf8(T),v=w=0;w<T;v++)(64512&(y=g.charCodeAt(v)))==55296&&v+1<S&&(64512&(b=g.charCodeAt(v+1)))==56320&&(y=65536+(y-55296<<10)+(b-56320),v++),y<128?m[w++]=y:(y<2048?m[w++]=192|y>>>6:(y<65536?m[w++]=224|y>>>12:(m[w++]=240|y>>>18,m[w++]=128|y>>>12&63),m[w++]=128|y>>>6&63),m[w++]=128|63&y);return m},s.buf2binstring=function(g){return p(g,g.length)},s.binstring2buf=function(g){for(var m=new i.Buf8(g.length),y=0,b=m.length;y<b;y++)m[y]=g.charCodeAt(y);return m},s.buf2string=function(g,m){var y,b,v,w,S=m||g.length,T=new Array(2*S);for(y=b=0;y<S;)if((v=g[y++])<128)T[b++]=v;else if(4<(w=d[v]))T[b++]=65533,y+=w-1;else{for(v&=w===2?31:w===3?15:7;1<w&&y<S;)v=v<<6|63&g[y++],w--;1<w?T[b++]=65533:v<65536?T[b++]=v:(v-=65536,T[b++]=55296|v>>10&1023,T[b++]=56320|1023&v)}return p(T,b)},s.utf8border=function(g,m){var y;for((m=m||g.length)>g.length&&(m=g.length),y=m-1;0<=y&&(192&g[y])==128;)y--;return y<0||y===0?m:y+d[g[y]]>m?y:m}},{"./common":41}],43:[function(n,r,s){r.exports=function(i,o,l,d){for(var f=65535&i|0,p=i>>>16&65535|0,g=0;l!==0;){for(l-=g=2e3<l?2e3:l;p=p+(f=f+o[d++]|0)|0,--g;);f%=65521,p%=65521}return f|p<<16|0}},{}],44:[function(n,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,s){var i=(function(){for(var o,l=[],d=0;d<256;d++){o=d;for(var f=0;f<8;f++)o=1&o?3988292384^o>>>1:o>>>1;l[d]=o}return l})();r.exports=function(o,l,d,f){var p=i,g=f+d;o^=-1;for(var m=f;m<g;m++)o=o>>>8^p[255&(o^l[m])];return-1^o}},{}],46:[function(n,r,s){var i,o=n("../utils/common"),l=n("./trees"),d=n("./adler32"),f=n("./crc32"),p=n("./messages"),g=0,m=4,y=0,b=-2,v=-1,w=4,S=2,T=8,j=9,M=286,_=30,R=19,O=2*M+1,L=15,A=3,F=258,H=F+A+1,P=42,B=113,E=1,K=2,q=3,V=4;function ie(z,fe){return z.msg=p[fe],fe}function Y(z){return(z<<1)-(4<z?9:0)}function X(z){for(var fe=z.length;0<=--fe;)z[fe]=0}function D(z){var fe=z.state,ue=fe.pending;ue>z.avail_out&&(ue=z.avail_out),ue!==0&&(o.arraySet(z.output,fe.pending_buf,fe.pending_out,ue,z.next_out),z.next_out+=ue,fe.pending_out+=ue,z.total_out+=ue,z.avail_out-=ue,fe.pending-=ue,fe.pending===0&&(fe.pending_out=0))}function U(z,fe){l._tr_flush_block(z,0<=z.block_start?z.block_start:-1,z.strstart-z.block_start,fe),z.block_start=z.strstart,D(z.strm)}function te(z,fe){z.pending_buf[z.pending++]=fe}function Z(z,fe){z.pending_buf[z.pending++]=fe>>>8&255,z.pending_buf[z.pending++]=255&fe}function re(z,fe){var ue,W,Q=z.max_chain_length,ee=z.strstart,pe=z.prev_length,we=z.nice_match,ae=z.strstart>z.w_size-H?z.strstart-(z.w_size-H):0,xe=z.window,Ce=z.w_mask,Te=z.prev,Ie=z.strstart+F,Ze=xe[ee+pe-1],Ue=xe[ee+pe];z.prev_length>=z.good_match&&(Q>>=2),we>z.lookahead&&(we=z.lookahead);do if(xe[(ue=fe)+pe]===Ue&&xe[ue+pe-1]===Ze&&xe[ue]===xe[ee]&&xe[++ue]===xe[ee+1]){ee+=2,ue++;do;while(xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&xe[++ee]===xe[++ue]&&ee<Ie);if(W=F-(Ie-ee),ee=Ie-F,pe<W){if(z.match_start=fe,we<=(pe=W))break;Ze=xe[ee+pe-1],Ue=xe[ee+pe]}}while((fe=Te[fe&Ce])>ae&&--Q!=0);return pe<=z.lookahead?pe:z.lookahead}function se(z){var fe,ue,W,Q,ee,pe,we,ae,xe,Ce,Te=z.w_size;do{if(Q=z.window_size-z.lookahead-z.strstart,z.strstart>=Te+(Te-H)){for(o.arraySet(z.window,z.window,Te,Te,0),z.match_start-=Te,z.strstart-=Te,z.block_start-=Te,fe=ue=z.hash_size;W=z.head[--fe],z.head[fe]=Te<=W?W-Te:0,--ue;);for(fe=ue=Te;W=z.prev[--fe],z.prev[fe]=Te<=W?W-Te:0,--ue;);Q+=Te}if(z.strm.avail_in===0)break;if(pe=z.strm,we=z.window,ae=z.strstart+z.lookahead,xe=Q,Ce=void 0,Ce=pe.avail_in,xe<Ce&&(Ce=xe),ue=Ce===0?0:(pe.avail_in-=Ce,o.arraySet(we,pe.input,pe.next_in,Ce,ae),pe.state.wrap===1?pe.adler=d(pe.adler,we,Ce,ae):pe.state.wrap===2&&(pe.adler=f(pe.adler,we,Ce,ae)),pe.next_in+=Ce,pe.total_in+=Ce,Ce),z.lookahead+=ue,z.lookahead+z.insert>=A)for(ee=z.strstart-z.insert,z.ins_h=z.window[ee],z.ins_h=(z.ins_h<<z.hash_shift^z.window[ee+1])&z.hash_mask;z.insert&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[ee+A-1])&z.hash_mask,z.prev[ee&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=ee,ee++,z.insert--,!(z.lookahead+z.insert<A)););}while(z.lookahead<H&&z.strm.avail_in!==0)}function ge(z,fe){for(var ue,W;;){if(z.lookahead<H){if(se(z),z.lookahead<H&&fe===g)return E;if(z.lookahead===0)break}if(ue=0,z.lookahead>=A&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+A-1])&z.hash_mask,ue=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),ue!==0&&z.strstart-ue<=z.w_size-H&&(z.match_length=re(z,ue)),z.match_length>=A)if(W=l._tr_tally(z,z.strstart-z.match_start,z.match_length-A),z.lookahead-=z.match_length,z.match_length<=z.max_lazy_match&&z.lookahead>=A){for(z.match_length--;z.strstart++,z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+A-1])&z.hash_mask,ue=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart,--z.match_length!=0;);z.strstart++}else z.strstart+=z.match_length,z.match_length=0,z.ins_h=z.window[z.strstart],z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+1])&z.hash_mask;else W=l._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++;if(W&&(U(z,!1),z.strm.avail_out===0))return E}return z.insert=z.strstart<A-1?z.strstart:A-1,fe===m?(U(z,!0),z.strm.avail_out===0?q:V):z.last_lit&&(U(z,!1),z.strm.avail_out===0)?E:K}function be(z,fe){for(var ue,W,Q;;){if(z.lookahead<H){if(se(z),z.lookahead<H&&fe===g)return E;if(z.lookahead===0)break}if(ue=0,z.lookahead>=A&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+A-1])&z.hash_mask,ue=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),z.prev_length=z.match_length,z.prev_match=z.match_start,z.match_length=A-1,ue!==0&&z.prev_length<z.max_lazy_match&&z.strstart-ue<=z.w_size-H&&(z.match_length=re(z,ue),z.match_length<=5&&(z.strategy===1||z.match_length===A&&4096<z.strstart-z.match_start)&&(z.match_length=A-1)),z.prev_length>=A&&z.match_length<=z.prev_length){for(Q=z.strstart+z.lookahead-A,W=l._tr_tally(z,z.strstart-1-z.prev_match,z.prev_length-A),z.lookahead-=z.prev_length-1,z.prev_length-=2;++z.strstart<=Q&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+A-1])&z.hash_mask,ue=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),--z.prev_length!=0;);if(z.match_available=0,z.match_length=A-1,z.strstart++,W&&(U(z,!1),z.strm.avail_out===0))return E}else if(z.match_available){if((W=l._tr_tally(z,0,z.window[z.strstart-1]))&&U(z,!1),z.strstart++,z.lookahead--,z.strm.avail_out===0)return E}else z.match_available=1,z.strstart++,z.lookahead--}return z.match_available&&(W=l._tr_tally(z,0,z.window[z.strstart-1]),z.match_available=0),z.insert=z.strstart<A-1?z.strstart:A-1,fe===m?(U(z,!0),z.strm.avail_out===0?q:V):z.last_lit&&(U(z,!1),z.strm.avail_out===0)?E:K}function me(z,fe,ue,W,Q){this.good_length=z,this.max_lazy=fe,this.nice_length=ue,this.max_chain=W,this.func=Q}function Se(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*O),this.dyn_dtree=new o.Buf16(2*(2*_+1)),this.bl_tree=new o.Buf16(2*(2*R+1)),X(this.dyn_ltree),X(this.dyn_dtree),X(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(L+1),this.heap=new o.Buf16(2*M+1),X(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*M+1),X(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Oe(z){var fe;return z&&z.state?(z.total_in=z.total_out=0,z.data_type=S,(fe=z.state).pending=0,fe.pending_out=0,fe.wrap<0&&(fe.wrap=-fe.wrap),fe.status=fe.wrap?P:B,z.adler=fe.wrap===2?0:1,fe.last_flush=g,l._tr_init(fe),y):ie(z,b)}function He(z){var fe=Oe(z);return fe===y&&(function(ue){ue.window_size=2*ue.w_size,X(ue.head),ue.max_lazy_match=i[ue.level].max_lazy,ue.good_match=i[ue.level].good_length,ue.nice_match=i[ue.level].nice_length,ue.max_chain_length=i[ue.level].max_chain,ue.strstart=0,ue.block_start=0,ue.lookahead=0,ue.insert=0,ue.match_length=ue.prev_length=A-1,ue.match_available=0,ue.ins_h=0})(z.state),fe}function ut(z,fe,ue,W,Q,ee){if(!z)return b;var pe=1;if(fe===v&&(fe=6),W<0?(pe=0,W=-W):15<W&&(pe=2,W-=16),Q<1||j<Q||ue!==T||W<8||15<W||fe<0||9<fe||ee<0||w<ee)return ie(z,b);W===8&&(W=9);var we=new Se;return(z.state=we).strm=z,we.wrap=pe,we.gzhead=null,we.w_bits=W,we.w_size=1<<we.w_bits,we.w_mask=we.w_size-1,we.hash_bits=Q+7,we.hash_size=1<<we.hash_bits,we.hash_mask=we.hash_size-1,we.hash_shift=~~((we.hash_bits+A-1)/A),we.window=new o.Buf8(2*we.w_size),we.head=new o.Buf16(we.hash_size),we.prev=new o.Buf16(we.w_size),we.lit_bufsize=1<<Q+6,we.pending_buf_size=4*we.lit_bufsize,we.pending_buf=new o.Buf8(we.pending_buf_size),we.d_buf=1*we.lit_bufsize,we.l_buf=3*we.lit_bufsize,we.level=fe,we.strategy=ee,we.method=ue,He(z)}i=[new me(0,0,0,0,function(z,fe){var ue=65535;for(ue>z.pending_buf_size-5&&(ue=z.pending_buf_size-5);;){if(z.lookahead<=1){if(se(z),z.lookahead===0&&fe===g)return E;if(z.lookahead===0)break}z.strstart+=z.lookahead,z.lookahead=0;var W=z.block_start+ue;if((z.strstart===0||z.strstart>=W)&&(z.lookahead=z.strstart-W,z.strstart=W,U(z,!1),z.strm.avail_out===0)||z.strstart-z.block_start>=z.w_size-H&&(U(z,!1),z.strm.avail_out===0))return E}return z.insert=0,fe===m?(U(z,!0),z.strm.avail_out===0?q:V):(z.strstart>z.block_start&&(U(z,!1),z.strm.avail_out),E)}),new me(4,4,8,4,ge),new me(4,5,16,8,ge),new me(4,6,32,32,ge),new me(4,4,16,16,be),new me(8,16,32,32,be),new me(8,16,128,128,be),new me(8,32,128,256,be),new me(32,128,258,1024,be),new me(32,258,258,4096,be)],s.deflateInit=function(z,fe){return ut(z,fe,T,15,8,0)},s.deflateInit2=ut,s.deflateReset=He,s.deflateResetKeep=Oe,s.deflateSetHeader=function(z,fe){return z&&z.state?z.state.wrap!==2?b:(z.state.gzhead=fe,y):b},s.deflate=function(z,fe){var ue,W,Q,ee;if(!z||!z.state||5<fe||fe<0)return z?ie(z,b):b;if(W=z.state,!z.output||!z.input&&z.avail_in!==0||W.status===666&&fe!==m)return ie(z,z.avail_out===0?-5:b);if(W.strm=z,ue=W.last_flush,W.last_flush=fe,W.status===P)if(W.wrap===2)z.adler=0,te(W,31),te(W,139),te(W,8),W.gzhead?(te(W,(W.gzhead.text?1:0)+(W.gzhead.hcrc?2:0)+(W.gzhead.extra?4:0)+(W.gzhead.name?8:0)+(W.gzhead.comment?16:0)),te(W,255&W.gzhead.time),te(W,W.gzhead.time>>8&255),te(W,W.gzhead.time>>16&255),te(W,W.gzhead.time>>24&255),te(W,W.level===9?2:2<=W.strategy||W.level<2?4:0),te(W,255&W.gzhead.os),W.gzhead.extra&&W.gzhead.extra.length&&(te(W,255&W.gzhead.extra.length),te(W,W.gzhead.extra.length>>8&255)),W.gzhead.hcrc&&(z.adler=f(z.adler,W.pending_buf,W.pending,0)),W.gzindex=0,W.status=69):(te(W,0),te(W,0),te(W,0),te(W,0),te(W,0),te(W,W.level===9?2:2<=W.strategy||W.level<2?4:0),te(W,3),W.status=B);else{var pe=T+(W.w_bits-8<<4)<<8;pe|=(2<=W.strategy||W.level<2?0:W.level<6?1:W.level===6?2:3)<<6,W.strstart!==0&&(pe|=32),pe+=31-pe%31,W.status=B,Z(W,pe),W.strstart!==0&&(Z(W,z.adler>>>16),Z(W,65535&z.adler)),z.adler=1}if(W.status===69)if(W.gzhead.extra){for(Q=W.pending;W.gzindex<(65535&W.gzhead.extra.length)&&(W.pending!==W.pending_buf_size||(W.gzhead.hcrc&&W.pending>Q&&(z.adler=f(z.adler,W.pending_buf,W.pending-Q,Q)),D(z),Q=W.pending,W.pending!==W.pending_buf_size));)te(W,255&W.gzhead.extra[W.gzindex]),W.gzindex++;W.gzhead.hcrc&&W.pending>Q&&(z.adler=f(z.adler,W.pending_buf,W.pending-Q,Q)),W.gzindex===W.gzhead.extra.length&&(W.gzindex=0,W.status=73)}else W.status=73;if(W.status===73)if(W.gzhead.name){Q=W.pending;do{if(W.pending===W.pending_buf_size&&(W.gzhead.hcrc&&W.pending>Q&&(z.adler=f(z.adler,W.pending_buf,W.pending-Q,Q)),D(z),Q=W.pending,W.pending===W.pending_buf_size)){ee=1;break}ee=W.gzindex<W.gzhead.name.length?255&W.gzhead.name.charCodeAt(W.gzindex++):0,te(W,ee)}while(ee!==0);W.gzhead.hcrc&&W.pending>Q&&(z.adler=f(z.adler,W.pending_buf,W.pending-Q,Q)),ee===0&&(W.gzindex=0,W.status=91)}else W.status=91;if(W.status===91)if(W.gzhead.comment){Q=W.pending;do{if(W.pending===W.pending_buf_size&&(W.gzhead.hcrc&&W.pending>Q&&(z.adler=f(z.adler,W.pending_buf,W.pending-Q,Q)),D(z),Q=W.pending,W.pending===W.pending_buf_size)){ee=1;break}ee=W.gzindex<W.gzhead.comment.length?255&W.gzhead.comment.charCodeAt(W.gzindex++):0,te(W,ee)}while(ee!==0);W.gzhead.hcrc&&W.pending>Q&&(z.adler=f(z.adler,W.pending_buf,W.pending-Q,Q)),ee===0&&(W.status=103)}else W.status=103;if(W.status===103&&(W.gzhead.hcrc?(W.pending+2>W.pending_buf_size&&D(z),W.pending+2<=W.pending_buf_size&&(te(W,255&z.adler),te(W,z.adler>>8&255),z.adler=0,W.status=B)):W.status=B),W.pending!==0){if(D(z),z.avail_out===0)return W.last_flush=-1,y}else if(z.avail_in===0&&Y(fe)<=Y(ue)&&fe!==m)return ie(z,-5);if(W.status===666&&z.avail_in!==0)return ie(z,-5);if(z.avail_in!==0||W.lookahead!==0||fe!==g&&W.status!==666){var we=W.strategy===2?(function(ae,xe){for(var Ce;;){if(ae.lookahead===0&&(se(ae),ae.lookahead===0)){if(xe===g)return E;break}if(ae.match_length=0,Ce=l._tr_tally(ae,0,ae.window[ae.strstart]),ae.lookahead--,ae.strstart++,Ce&&(U(ae,!1),ae.strm.avail_out===0))return E}return ae.insert=0,xe===m?(U(ae,!0),ae.strm.avail_out===0?q:V):ae.last_lit&&(U(ae,!1),ae.strm.avail_out===0)?E:K})(W,fe):W.strategy===3?(function(ae,xe){for(var Ce,Te,Ie,Ze,Ue=ae.window;;){if(ae.lookahead<=F){if(se(ae),ae.lookahead<=F&&xe===g)return E;if(ae.lookahead===0)break}if(ae.match_length=0,ae.lookahead>=A&&0<ae.strstart&&(Te=Ue[Ie=ae.strstart-1])===Ue[++Ie]&&Te===Ue[++Ie]&&Te===Ue[++Ie]){Ze=ae.strstart+F;do;while(Te===Ue[++Ie]&&Te===Ue[++Ie]&&Te===Ue[++Ie]&&Te===Ue[++Ie]&&Te===Ue[++Ie]&&Te===Ue[++Ie]&&Te===Ue[++Ie]&&Te===Ue[++Ie]&&Ie<Ze);ae.match_length=F-(Ze-Ie),ae.match_length>ae.lookahead&&(ae.match_length=ae.lookahead)}if(ae.match_length>=A?(Ce=l._tr_tally(ae,1,ae.match_length-A),ae.lookahead-=ae.match_length,ae.strstart+=ae.match_length,ae.match_length=0):(Ce=l._tr_tally(ae,0,ae.window[ae.strstart]),ae.lookahead--,ae.strstart++),Ce&&(U(ae,!1),ae.strm.avail_out===0))return E}return ae.insert=0,xe===m?(U(ae,!0),ae.strm.avail_out===0?q:V):ae.last_lit&&(U(ae,!1),ae.strm.avail_out===0)?E:K})(W,fe):i[W.level].func(W,fe);if(we!==q&&we!==V||(W.status=666),we===E||we===q)return z.avail_out===0&&(W.last_flush=-1),y;if(we===K&&(fe===1?l._tr_align(W):fe!==5&&(l._tr_stored_block(W,0,0,!1),fe===3&&(X(W.head),W.lookahead===0&&(W.strstart=0,W.block_start=0,W.insert=0))),D(z),z.avail_out===0))return W.last_flush=-1,y}return fe!==m?y:W.wrap<=0?1:(W.wrap===2?(te(W,255&z.adler),te(W,z.adler>>8&255),te(W,z.adler>>16&255),te(W,z.adler>>24&255),te(W,255&z.total_in),te(W,z.total_in>>8&255),te(W,z.total_in>>16&255),te(W,z.total_in>>24&255)):(Z(W,z.adler>>>16),Z(W,65535&z.adler)),D(z),0<W.wrap&&(W.wrap=-W.wrap),W.pending!==0?y:1)},s.deflateEnd=function(z){var fe;return z&&z.state?(fe=z.state.status)!==P&&fe!==69&&fe!==73&&fe!==91&&fe!==103&&fe!==B&&fe!==666?ie(z,b):(z.state=null,fe===B?ie(z,-3):y):b},s.deflateSetDictionary=function(z,fe){var ue,W,Q,ee,pe,we,ae,xe,Ce=fe.length;if(!z||!z.state||(ee=(ue=z.state).wrap)===2||ee===1&&ue.status!==P||ue.lookahead)return b;for(ee===1&&(z.adler=d(z.adler,fe,Ce,0)),ue.wrap=0,Ce>=ue.w_size&&(ee===0&&(X(ue.head),ue.strstart=0,ue.block_start=0,ue.insert=0),xe=new o.Buf8(ue.w_size),o.arraySet(xe,fe,Ce-ue.w_size,ue.w_size,0),fe=xe,Ce=ue.w_size),pe=z.avail_in,we=z.next_in,ae=z.input,z.avail_in=Ce,z.next_in=0,z.input=fe,se(ue);ue.lookahead>=A;){for(W=ue.strstart,Q=ue.lookahead-(A-1);ue.ins_h=(ue.ins_h<<ue.hash_shift^ue.window[W+A-1])&ue.hash_mask,ue.prev[W&ue.w_mask]=ue.head[ue.ins_h],ue.head[ue.ins_h]=W,W++,--Q;);ue.strstart=W,ue.lookahead=A-1,se(ue)}return ue.strstart+=ue.lookahead,ue.block_start=ue.strstart,ue.insert=ue.lookahead,ue.lookahead=0,ue.match_length=ue.prev_length=A-1,ue.match_available=0,z.next_in=we,z.input=ae,z.avail_in=pe,ue.wrap=ee,y},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,s){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,s){r.exports=function(i,o){var l,d,f,p,g,m,y,b,v,w,S,T,j,M,_,R,O,L,A,F,H,P,B,E,K;l=i.state,d=i.next_in,E=i.input,f=d+(i.avail_in-5),p=i.next_out,K=i.output,g=p-(o-i.avail_out),m=p+(i.avail_out-257),y=l.dmax,b=l.wsize,v=l.whave,w=l.wnext,S=l.window,T=l.hold,j=l.bits,M=l.lencode,_=l.distcode,R=(1<<l.lenbits)-1,O=(1<<l.distbits)-1;e:do{j<15&&(T+=E[d++]<<j,j+=8,T+=E[d++]<<j,j+=8),L=M[T&R];t:for(;;){if(T>>>=A=L>>>24,j-=A,(A=L>>>16&255)===0)K[p++]=65535&L;else{if(!(16&A)){if((64&A)==0){L=M[(65535&L)+(T&(1<<A)-1)];continue t}if(32&A){l.mode=12;break e}i.msg="invalid literal/length code",l.mode=30;break e}F=65535&L,(A&=15)&&(j<A&&(T+=E[d++]<<j,j+=8),F+=T&(1<<A)-1,T>>>=A,j-=A),j<15&&(T+=E[d++]<<j,j+=8,T+=E[d++]<<j,j+=8),L=_[T&O];n:for(;;){if(T>>>=A=L>>>24,j-=A,!(16&(A=L>>>16&255))){if((64&A)==0){L=_[(65535&L)+(T&(1<<A)-1)];continue n}i.msg="invalid distance code",l.mode=30;break e}if(H=65535&L,j<(A&=15)&&(T+=E[d++]<<j,(j+=8)<A&&(T+=E[d++]<<j,j+=8)),y<(H+=T&(1<<A)-1)){i.msg="invalid distance too far back",l.mode=30;break e}if(T>>>=A,j-=A,(A=p-g)<H){if(v<(A=H-A)&&l.sane){i.msg="invalid distance too far back",l.mode=30;break e}if(B=S,(P=0)===w){if(P+=b-A,A<F){for(F-=A;K[p++]=S[P++],--A;);P=p-H,B=K}}else if(w<A){if(P+=b+w-A,(A-=w)<F){for(F-=A;K[p++]=S[P++],--A;);if(P=0,w<F){for(F-=A=w;K[p++]=S[P++],--A;);P=p-H,B=K}}}else if(P+=w-A,A<F){for(F-=A;K[p++]=S[P++],--A;);P=p-H,B=K}for(;2<F;)K[p++]=B[P++],K[p++]=B[P++],K[p++]=B[P++],F-=3;F&&(K[p++]=B[P++],1<F&&(K[p++]=B[P++]))}else{for(P=p-H;K[p++]=K[P++],K[p++]=K[P++],K[p++]=K[P++],2<(F-=3););F&&(K[p++]=K[P++],1<F&&(K[p++]=K[P++]))}break}}break}}while(d<f&&p<m);d-=F=j>>3,T&=(1<<(j-=F<<3))-1,i.next_in=d,i.next_out=p,i.avail_in=d<f?f-d+5:5-(d-f),i.avail_out=p<m?m-p+257:257-(p-m),l.hold=T,l.bits=j}},{}],49:[function(n,r,s){var i=n("../utils/common"),o=n("./adler32"),l=n("./crc32"),d=n("./inffast"),f=n("./inftrees"),p=1,g=2,m=0,y=-2,b=1,v=852,w=592;function S(P){return(P>>>24&255)+(P>>>8&65280)+((65280&P)<<8)+((255&P)<<24)}function T(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function j(P){var B;return P&&P.state?(B=P.state,P.total_in=P.total_out=B.total=0,P.msg="",B.wrap&&(P.adler=1&B.wrap),B.mode=b,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new i.Buf32(v),B.distcode=B.distdyn=new i.Buf32(w),B.sane=1,B.back=-1,m):y}function M(P){var B;return P&&P.state?((B=P.state).wsize=0,B.whave=0,B.wnext=0,j(P)):y}function _(P,B){var E,K;return P&&P.state?(K=P.state,B<0?(E=0,B=-B):(E=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?y:(K.window!==null&&K.wbits!==B&&(K.window=null),K.wrap=E,K.wbits=B,M(P))):y}function R(P,B){var E,K;return P?(K=new T,(P.state=K).window=null,(E=_(P,B))!==m&&(P.state=null),E):y}var O,L,A=!0;function F(P){if(A){var B;for(O=new i.Buf32(512),L=new i.Buf32(32),B=0;B<144;)P.lens[B++]=8;for(;B<256;)P.lens[B++]=9;for(;B<280;)P.lens[B++]=7;for(;B<288;)P.lens[B++]=8;for(f(p,P.lens,0,288,O,0,P.work,{bits:9}),B=0;B<32;)P.lens[B++]=5;f(g,P.lens,0,32,L,0,P.work,{bits:5}),A=!1}P.lencode=O,P.lenbits=9,P.distcode=L,P.distbits=5}function H(P,B,E,K){var q,V=P.state;return V.window===null&&(V.wsize=1<<V.wbits,V.wnext=0,V.whave=0,V.window=new i.Buf8(V.wsize)),K>=V.wsize?(i.arraySet(V.window,B,E-V.wsize,V.wsize,0),V.wnext=0,V.whave=V.wsize):(K<(q=V.wsize-V.wnext)&&(q=K),i.arraySet(V.window,B,E-K,q,V.wnext),(K-=q)?(i.arraySet(V.window,B,E-K,K,0),V.wnext=K,V.whave=V.wsize):(V.wnext+=q,V.wnext===V.wsize&&(V.wnext=0),V.whave<V.wsize&&(V.whave+=q))),0}s.inflateReset=M,s.inflateReset2=_,s.inflateResetKeep=j,s.inflateInit=function(P){return R(P,15)},s.inflateInit2=R,s.inflate=function(P,B){var E,K,q,V,ie,Y,X,D,U,te,Z,re,se,ge,be,me,Se,Oe,He,ut,z,fe,ue,W,Q=0,ee=new i.Buf8(4),pe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return y;(E=P.state).mode===12&&(E.mode=13),ie=P.next_out,q=P.output,X=P.avail_out,V=P.next_in,K=P.input,Y=P.avail_in,D=E.hold,U=E.bits,te=Y,Z=X,fe=m;e:for(;;)switch(E.mode){case b:if(E.wrap===0){E.mode=13;break}for(;U<16;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}if(2&E.wrap&&D===35615){ee[E.check=0]=255&D,ee[1]=D>>>8&255,E.check=l(E.check,ee,2,0),U=D=0,E.mode=2;break}if(E.flags=0,E.head&&(E.head.done=!1),!(1&E.wrap)||(((255&D)<<8)+(D>>8))%31){P.msg="incorrect header check",E.mode=30;break}if((15&D)!=8){P.msg="unknown compression method",E.mode=30;break}if(U-=4,z=8+(15&(D>>>=4)),E.wbits===0)E.wbits=z;else if(z>E.wbits){P.msg="invalid window size",E.mode=30;break}E.dmax=1<<z,P.adler=E.check=1,E.mode=512&D?10:12,U=D=0;break;case 2:for(;U<16;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}if(E.flags=D,(255&E.flags)!=8){P.msg="unknown compression method",E.mode=30;break}if(57344&E.flags){P.msg="unknown header flags set",E.mode=30;break}E.head&&(E.head.text=D>>8&1),512&E.flags&&(ee[0]=255&D,ee[1]=D>>>8&255,E.check=l(E.check,ee,2,0)),U=D=0,E.mode=3;case 3:for(;U<32;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}E.head&&(E.head.time=D),512&E.flags&&(ee[0]=255&D,ee[1]=D>>>8&255,ee[2]=D>>>16&255,ee[3]=D>>>24&255,E.check=l(E.check,ee,4,0)),U=D=0,E.mode=4;case 4:for(;U<16;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}E.head&&(E.head.xflags=255&D,E.head.os=D>>8),512&E.flags&&(ee[0]=255&D,ee[1]=D>>>8&255,E.check=l(E.check,ee,2,0)),U=D=0,E.mode=5;case 5:if(1024&E.flags){for(;U<16;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}E.length=D,E.head&&(E.head.extra_len=D),512&E.flags&&(ee[0]=255&D,ee[1]=D>>>8&255,E.check=l(E.check,ee,2,0)),U=D=0}else E.head&&(E.head.extra=null);E.mode=6;case 6:if(1024&E.flags&&(Y<(re=E.length)&&(re=Y),re&&(E.head&&(z=E.head.extra_len-E.length,E.head.extra||(E.head.extra=new Array(E.head.extra_len)),i.arraySet(E.head.extra,K,V,re,z)),512&E.flags&&(E.check=l(E.check,K,re,V)),Y-=re,V+=re,E.length-=re),E.length))break e;E.length=0,E.mode=7;case 7:if(2048&E.flags){if(Y===0)break e;for(re=0;z=K[V+re++],E.head&&z&&E.length<65536&&(E.head.name+=String.fromCharCode(z)),z&&re<Y;);if(512&E.flags&&(E.check=l(E.check,K,re,V)),Y-=re,V+=re,z)break e}else E.head&&(E.head.name=null);E.length=0,E.mode=8;case 8:if(4096&E.flags){if(Y===0)break e;for(re=0;z=K[V+re++],E.head&&z&&E.length<65536&&(E.head.comment+=String.fromCharCode(z)),z&&re<Y;);if(512&E.flags&&(E.check=l(E.check,K,re,V)),Y-=re,V+=re,z)break e}else E.head&&(E.head.comment=null);E.mode=9;case 9:if(512&E.flags){for(;U<16;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}if(D!==(65535&E.check)){P.msg="header crc mismatch",E.mode=30;break}U=D=0}E.head&&(E.head.hcrc=E.flags>>9&1,E.head.done=!0),P.adler=E.check=0,E.mode=12;break;case 10:for(;U<32;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}P.adler=E.check=S(D),U=D=0,E.mode=11;case 11:if(E.havedict===0)return P.next_out=ie,P.avail_out=X,P.next_in=V,P.avail_in=Y,E.hold=D,E.bits=U,2;P.adler=E.check=1,E.mode=12;case 12:if(B===5||B===6)break e;case 13:if(E.last){D>>>=7&U,U-=7&U,E.mode=27;break}for(;U<3;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}switch(E.last=1&D,U-=1,3&(D>>>=1)){case 0:E.mode=14;break;case 1:if(F(E),E.mode=20,B!==6)break;D>>>=2,U-=2;break e;case 2:E.mode=17;break;case 3:P.msg="invalid block type",E.mode=30}D>>>=2,U-=2;break;case 14:for(D>>>=7&U,U-=7&U;U<32;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}if((65535&D)!=(D>>>16^65535)){P.msg="invalid stored block lengths",E.mode=30;break}if(E.length=65535&D,U=D=0,E.mode=15,B===6)break e;case 15:E.mode=16;case 16:if(re=E.length){if(Y<re&&(re=Y),X<re&&(re=X),re===0)break e;i.arraySet(q,K,V,re,ie),Y-=re,V+=re,X-=re,ie+=re,E.length-=re;break}E.mode=12;break;case 17:for(;U<14;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}if(E.nlen=257+(31&D),D>>>=5,U-=5,E.ndist=1+(31&D),D>>>=5,U-=5,E.ncode=4+(15&D),D>>>=4,U-=4,286<E.nlen||30<E.ndist){P.msg="too many length or distance symbols",E.mode=30;break}E.have=0,E.mode=18;case 18:for(;E.have<E.ncode;){for(;U<3;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}E.lens[pe[E.have++]]=7&D,D>>>=3,U-=3}for(;E.have<19;)E.lens[pe[E.have++]]=0;if(E.lencode=E.lendyn,E.lenbits=7,ue={bits:E.lenbits},fe=f(0,E.lens,0,19,E.lencode,0,E.work,ue),E.lenbits=ue.bits,fe){P.msg="invalid code lengths set",E.mode=30;break}E.have=0,E.mode=19;case 19:for(;E.have<E.nlen+E.ndist;){for(;me=(Q=E.lencode[D&(1<<E.lenbits)-1])>>>16&255,Se=65535&Q,!((be=Q>>>24)<=U);){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}if(Se<16)D>>>=be,U-=be,E.lens[E.have++]=Se;else{if(Se===16){for(W=be+2;U<W;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}if(D>>>=be,U-=be,E.have===0){P.msg="invalid bit length repeat",E.mode=30;break}z=E.lens[E.have-1],re=3+(3&D),D>>>=2,U-=2}else if(Se===17){for(W=be+3;U<W;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}U-=be,z=0,re=3+(7&(D>>>=be)),D>>>=3,U-=3}else{for(W=be+7;U<W;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}U-=be,z=0,re=11+(127&(D>>>=be)),D>>>=7,U-=7}if(E.have+re>E.nlen+E.ndist){P.msg="invalid bit length repeat",E.mode=30;break}for(;re--;)E.lens[E.have++]=z}}if(E.mode===30)break;if(E.lens[256]===0){P.msg="invalid code -- missing end-of-block",E.mode=30;break}if(E.lenbits=9,ue={bits:E.lenbits},fe=f(p,E.lens,0,E.nlen,E.lencode,0,E.work,ue),E.lenbits=ue.bits,fe){P.msg="invalid literal/lengths set",E.mode=30;break}if(E.distbits=6,E.distcode=E.distdyn,ue={bits:E.distbits},fe=f(g,E.lens,E.nlen,E.ndist,E.distcode,0,E.work,ue),E.distbits=ue.bits,fe){P.msg="invalid distances set",E.mode=30;break}if(E.mode=20,B===6)break e;case 20:E.mode=21;case 21:if(6<=Y&&258<=X){P.next_out=ie,P.avail_out=X,P.next_in=V,P.avail_in=Y,E.hold=D,E.bits=U,d(P,Z),ie=P.next_out,q=P.output,X=P.avail_out,V=P.next_in,K=P.input,Y=P.avail_in,D=E.hold,U=E.bits,E.mode===12&&(E.back=-1);break}for(E.back=0;me=(Q=E.lencode[D&(1<<E.lenbits)-1])>>>16&255,Se=65535&Q,!((be=Q>>>24)<=U);){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}if(me&&(240&me)==0){for(Oe=be,He=me,ut=Se;me=(Q=E.lencode[ut+((D&(1<<Oe+He)-1)>>Oe)])>>>16&255,Se=65535&Q,!(Oe+(be=Q>>>24)<=U);){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}D>>>=Oe,U-=Oe,E.back+=Oe}if(D>>>=be,U-=be,E.back+=be,E.length=Se,me===0){E.mode=26;break}if(32&me){E.back=-1,E.mode=12;break}if(64&me){P.msg="invalid literal/length code",E.mode=30;break}E.extra=15&me,E.mode=22;case 22:if(E.extra){for(W=E.extra;U<W;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}E.length+=D&(1<<E.extra)-1,D>>>=E.extra,U-=E.extra,E.back+=E.extra}E.was=E.length,E.mode=23;case 23:for(;me=(Q=E.distcode[D&(1<<E.distbits)-1])>>>16&255,Se=65535&Q,!((be=Q>>>24)<=U);){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}if((240&me)==0){for(Oe=be,He=me,ut=Se;me=(Q=E.distcode[ut+((D&(1<<Oe+He)-1)>>Oe)])>>>16&255,Se=65535&Q,!(Oe+(be=Q>>>24)<=U);){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}D>>>=Oe,U-=Oe,E.back+=Oe}if(D>>>=be,U-=be,E.back+=be,64&me){P.msg="invalid distance code",E.mode=30;break}E.offset=Se,E.extra=15&me,E.mode=24;case 24:if(E.extra){for(W=E.extra;U<W;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}E.offset+=D&(1<<E.extra)-1,D>>>=E.extra,U-=E.extra,E.back+=E.extra}if(E.offset>E.dmax){P.msg="invalid distance too far back",E.mode=30;break}E.mode=25;case 25:if(X===0)break e;if(re=Z-X,E.offset>re){if((re=E.offset-re)>E.whave&&E.sane){P.msg="invalid distance too far back",E.mode=30;break}se=re>E.wnext?(re-=E.wnext,E.wsize-re):E.wnext-re,re>E.length&&(re=E.length),ge=E.window}else ge=q,se=ie-E.offset,re=E.length;for(X<re&&(re=X),X-=re,E.length-=re;q[ie++]=ge[se++],--re;);E.length===0&&(E.mode=21);break;case 26:if(X===0)break e;q[ie++]=E.length,X--,E.mode=21;break;case 27:if(E.wrap){for(;U<32;){if(Y===0)break e;Y--,D|=K[V++]<<U,U+=8}if(Z-=X,P.total_out+=Z,E.total+=Z,Z&&(P.adler=E.check=E.flags?l(E.check,q,Z,ie-Z):o(E.check,q,Z,ie-Z)),Z=X,(E.flags?D:S(D))!==E.check){P.msg="incorrect data check",E.mode=30;break}U=D=0}E.mode=28;case 28:if(E.wrap&&E.flags){for(;U<32;){if(Y===0)break e;Y--,D+=K[V++]<<U,U+=8}if(D!==(4294967295&E.total)){P.msg="incorrect length check",E.mode=30;break}U=D=0}E.mode=29;case 29:fe=1;break e;case 30:fe=-3;break e;case 31:return-4;case 32:default:return y}return P.next_out=ie,P.avail_out=X,P.next_in=V,P.avail_in=Y,E.hold=D,E.bits=U,(E.wsize||Z!==P.avail_out&&E.mode<30&&(E.mode<27||B!==4))&&H(P,P.output,P.next_out,Z-P.avail_out)?(E.mode=31,-4):(te-=P.avail_in,Z-=P.avail_out,P.total_in+=te,P.total_out+=Z,E.total+=Z,E.wrap&&Z&&(P.adler=E.check=E.flags?l(E.check,q,Z,P.next_out-Z):o(E.check,q,Z,P.next_out-Z)),P.data_type=E.bits+(E.last?64:0)+(E.mode===12?128:0)+(E.mode===20||E.mode===15?256:0),(te==0&&Z===0||B===4)&&fe===m&&(fe=-5),fe)},s.inflateEnd=function(P){if(!P||!P.state)return y;var B=P.state;return B.window&&(B.window=null),P.state=null,m},s.inflateGetHeader=function(P,B){var E;return P&&P.state?(2&(E=P.state).wrap)==0?y:((E.head=B).done=!1,m):y},s.inflateSetDictionary=function(P,B){var E,K=B.length;return P&&P.state?(E=P.state).wrap!==0&&E.mode!==11?y:E.mode===11&&o(1,B,K,0)!==E.check?-3:H(P,B,K,K)?(E.mode=31,-4):(E.havedict=1,m):y},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,s){var i=n("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(p,g,m,y,b,v,w,S){var T,j,M,_,R,O,L,A,F,H=S.bits,P=0,B=0,E=0,K=0,q=0,V=0,ie=0,Y=0,X=0,D=0,U=null,te=0,Z=new i.Buf16(16),re=new i.Buf16(16),se=null,ge=0;for(P=0;P<=15;P++)Z[P]=0;for(B=0;B<y;B++)Z[g[m+B]]++;for(q=H,K=15;1<=K&&Z[K]===0;K--);if(K<q&&(q=K),K===0)return b[v++]=20971520,b[v++]=20971520,S.bits=1,0;for(E=1;E<K&&Z[E]===0;E++);for(q<E&&(q=E),P=Y=1;P<=15;P++)if(Y<<=1,(Y-=Z[P])<0)return-1;if(0<Y&&(p===0||K!==1))return-1;for(re[1]=0,P=1;P<15;P++)re[P+1]=re[P]+Z[P];for(B=0;B<y;B++)g[m+B]!==0&&(w[re[g[m+B]]++]=B);if(O=p===0?(U=se=w,19):p===1?(U=o,te-=257,se=l,ge-=257,256):(U=d,se=f,-1),P=E,R=v,ie=B=D=0,M=-1,_=(X=1<<(V=q))-1,p===1&&852<X||p===2&&592<X)return 1;for(;;){for(L=P-ie,F=w[B]<O?(A=0,w[B]):w[B]>O?(A=se[ge+w[B]],U[te+w[B]]):(A=96,0),T=1<<P-ie,E=j=1<<V;b[R+(D>>ie)+(j-=T)]=L<<24|A<<16|F|0,j!==0;);for(T=1<<P-1;D&T;)T>>=1;if(T!==0?(D&=T-1,D+=T):D=0,B++,--Z[P]==0){if(P===K)break;P=g[m+w[B]]}if(q<P&&(D&_)!==M){for(ie===0&&(ie=q),R+=E,Y=1<<(V=P-ie);V+ie<K&&!((Y-=Z[V+ie])<=0);)V++,Y<<=1;if(X+=1<<V,p===1&&852<X||p===2&&592<X)return 1;b[M=D&_]=q<<24|V<<16|R-v|0}}return D!==0&&(b[R+D]=P-ie<<24|64<<16|0),S.bits=q,0}},{"../utils/common":41}],51:[function(n,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,s){var i=n("../utils/common"),o=0,l=1;function d(Q){for(var ee=Q.length;0<=--ee;)Q[ee]=0}var f=0,p=29,g=256,m=g+1+p,y=30,b=19,v=2*m+1,w=15,S=16,T=7,j=256,M=16,_=17,R=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],L=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=new Array(2*(m+2));d(H);var P=new Array(2*y);d(P);var B=new Array(512);d(B);var E=new Array(256);d(E);var K=new Array(p);d(K);var q,V,ie,Y=new Array(y);function X(Q,ee,pe,we,ae){this.static_tree=Q,this.extra_bits=ee,this.extra_base=pe,this.elems=we,this.max_length=ae,this.has_stree=Q&&Q.length}function D(Q,ee){this.dyn_tree=Q,this.max_code=0,this.stat_desc=ee}function U(Q){return Q<256?B[Q]:B[256+(Q>>>7)]}function te(Q,ee){Q.pending_buf[Q.pending++]=255&ee,Q.pending_buf[Q.pending++]=ee>>>8&255}function Z(Q,ee,pe){Q.bi_valid>S-pe?(Q.bi_buf|=ee<<Q.bi_valid&65535,te(Q,Q.bi_buf),Q.bi_buf=ee>>S-Q.bi_valid,Q.bi_valid+=pe-S):(Q.bi_buf|=ee<<Q.bi_valid&65535,Q.bi_valid+=pe)}function re(Q,ee,pe){Z(Q,pe[2*ee],pe[2*ee+1])}function se(Q,ee){for(var pe=0;pe|=1&Q,Q>>>=1,pe<<=1,0<--ee;);return pe>>>1}function ge(Q,ee,pe){var we,ae,xe=new Array(w+1),Ce=0;for(we=1;we<=w;we++)xe[we]=Ce=Ce+pe[we-1]<<1;for(ae=0;ae<=ee;ae++){var Te=Q[2*ae+1];Te!==0&&(Q[2*ae]=se(xe[Te]++,Te))}}function be(Q){var ee;for(ee=0;ee<m;ee++)Q.dyn_ltree[2*ee]=0;for(ee=0;ee<y;ee++)Q.dyn_dtree[2*ee]=0;for(ee=0;ee<b;ee++)Q.bl_tree[2*ee]=0;Q.dyn_ltree[2*j]=1,Q.opt_len=Q.static_len=0,Q.last_lit=Q.matches=0}function me(Q){8<Q.bi_valid?te(Q,Q.bi_buf):0<Q.bi_valid&&(Q.pending_buf[Q.pending++]=Q.bi_buf),Q.bi_buf=0,Q.bi_valid=0}function Se(Q,ee,pe,we){var ae=2*ee,xe=2*pe;return Q[ae]<Q[xe]||Q[ae]===Q[xe]&&we[ee]<=we[pe]}function Oe(Q,ee,pe){for(var we=Q.heap[pe],ae=pe<<1;ae<=Q.heap_len&&(ae<Q.heap_len&&Se(ee,Q.heap[ae+1],Q.heap[ae],Q.depth)&&ae++,!Se(ee,we,Q.heap[ae],Q.depth));)Q.heap[pe]=Q.heap[ae],pe=ae,ae<<=1;Q.heap[pe]=we}function He(Q,ee,pe){var we,ae,xe,Ce,Te=0;if(Q.last_lit!==0)for(;we=Q.pending_buf[Q.d_buf+2*Te]<<8|Q.pending_buf[Q.d_buf+2*Te+1],ae=Q.pending_buf[Q.l_buf+Te],Te++,we===0?re(Q,ae,ee):(re(Q,(xe=E[ae])+g+1,ee),(Ce=O[xe])!==0&&Z(Q,ae-=K[xe],Ce),re(Q,xe=U(--we),pe),(Ce=L[xe])!==0&&Z(Q,we-=Y[xe],Ce)),Te<Q.last_lit;);re(Q,j,ee)}function ut(Q,ee){var pe,we,ae,xe=ee.dyn_tree,Ce=ee.stat_desc.static_tree,Te=ee.stat_desc.has_stree,Ie=ee.stat_desc.elems,Ze=-1;for(Q.heap_len=0,Q.heap_max=v,pe=0;pe<Ie;pe++)xe[2*pe]!==0?(Q.heap[++Q.heap_len]=Ze=pe,Q.depth[pe]=0):xe[2*pe+1]=0;for(;Q.heap_len<2;)xe[2*(ae=Q.heap[++Q.heap_len]=Ze<2?++Ze:0)]=1,Q.depth[ae]=0,Q.opt_len--,Te&&(Q.static_len-=Ce[2*ae+1]);for(ee.max_code=Ze,pe=Q.heap_len>>1;1<=pe;pe--)Oe(Q,xe,pe);for(ae=Ie;pe=Q.heap[1],Q.heap[1]=Q.heap[Q.heap_len--],Oe(Q,xe,1),we=Q.heap[1],Q.heap[--Q.heap_max]=pe,Q.heap[--Q.heap_max]=we,xe[2*ae]=xe[2*pe]+xe[2*we],Q.depth[ae]=(Q.depth[pe]>=Q.depth[we]?Q.depth[pe]:Q.depth[we])+1,xe[2*pe+1]=xe[2*we+1]=ae,Q.heap[1]=ae++,Oe(Q,xe,1),2<=Q.heap_len;);Q.heap[--Q.heap_max]=Q.heap[1],(function(Ue,$t){var Zr,Bt,hs,dt,qt,Nn,Nt=$t.dyn_tree,jo=$t.max_code,Eo=$t.stat_desc.static_tree,lc=$t.stat_desc.has_stree,vi=$t.stat_desc.extra_bits,_s=$t.stat_desc.extra_base,vt=$t.stat_desc.max_length,Tt=0;for(dt=0;dt<=w;dt++)Ue.bl_count[dt]=0;for(Nt[2*Ue.heap[Ue.heap_max]+1]=0,Zr=Ue.heap_max+1;Zr<v;Zr++)vt<(dt=Nt[2*Nt[2*(Bt=Ue.heap[Zr])+1]+1]+1)&&(dt=vt,Tt++),Nt[2*Bt+1]=dt,jo<Bt||(Ue.bl_count[dt]++,qt=0,_s<=Bt&&(qt=vi[Bt-_s]),Nn=Nt[2*Bt],Ue.opt_len+=Nn*(dt+qt),lc&&(Ue.static_len+=Nn*(Eo[2*Bt+1]+qt)));if(Tt!==0){do{for(dt=vt-1;Ue.bl_count[dt]===0;)dt--;Ue.bl_count[dt]--,Ue.bl_count[dt+1]+=2,Ue.bl_count[vt]--,Tt-=2}while(0<Tt);for(dt=vt;dt!==0;dt--)for(Bt=Ue.bl_count[dt];Bt!==0;)jo<(hs=Ue.heap[--Zr])||(Nt[2*hs+1]!==dt&&(Ue.opt_len+=(dt-Nt[2*hs+1])*Nt[2*hs],Nt[2*hs+1]=dt),Bt--)}})(Q,ee),ge(xe,Ze,Q.bl_count)}function z(Q,ee,pe){var we,ae,xe=-1,Ce=ee[1],Te=0,Ie=7,Ze=4;for(Ce===0&&(Ie=138,Ze=3),ee[2*(pe+1)+1]=65535,we=0;we<=pe;we++)ae=Ce,Ce=ee[2*(we+1)+1],++Te<Ie&&ae===Ce||(Te<Ze?Q.bl_tree[2*ae]+=Te:ae!==0?(ae!==xe&&Q.bl_tree[2*ae]++,Q.bl_tree[2*M]++):Te<=10?Q.bl_tree[2*_]++:Q.bl_tree[2*R]++,xe=ae,Ze=(Te=0)===Ce?(Ie=138,3):ae===Ce?(Ie=6,3):(Ie=7,4))}function fe(Q,ee,pe){var we,ae,xe=-1,Ce=ee[1],Te=0,Ie=7,Ze=4;for(Ce===0&&(Ie=138,Ze=3),we=0;we<=pe;we++)if(ae=Ce,Ce=ee[2*(we+1)+1],!(++Te<Ie&&ae===Ce)){if(Te<Ze)for(;re(Q,ae,Q.bl_tree),--Te!=0;);else ae!==0?(ae!==xe&&(re(Q,ae,Q.bl_tree),Te--),re(Q,M,Q.bl_tree),Z(Q,Te-3,2)):Te<=10?(re(Q,_,Q.bl_tree),Z(Q,Te-3,3)):(re(Q,R,Q.bl_tree),Z(Q,Te-11,7));xe=ae,Ze=(Te=0)===Ce?(Ie=138,3):ae===Ce?(Ie=6,3):(Ie=7,4)}}d(Y);var ue=!1;function W(Q,ee,pe,we){Z(Q,(f<<1)+(we?1:0),3),(function(ae,xe,Ce,Te){me(ae),te(ae,Ce),te(ae,~Ce),i.arraySet(ae.pending_buf,ae.window,xe,Ce,ae.pending),ae.pending+=Ce})(Q,ee,pe)}s._tr_init=function(Q){ue||((function(){var ee,pe,we,ae,xe,Ce=new Array(w+1);for(ae=we=0;ae<p-1;ae++)for(K[ae]=we,ee=0;ee<1<<O[ae];ee++)E[we++]=ae;for(E[we-1]=ae,ae=xe=0;ae<16;ae++)for(Y[ae]=xe,ee=0;ee<1<<L[ae];ee++)B[xe++]=ae;for(xe>>=7;ae<y;ae++)for(Y[ae]=xe<<7,ee=0;ee<1<<L[ae]-7;ee++)B[256+xe++]=ae;for(pe=0;pe<=w;pe++)Ce[pe]=0;for(ee=0;ee<=143;)H[2*ee+1]=8,ee++,Ce[8]++;for(;ee<=255;)H[2*ee+1]=9,ee++,Ce[9]++;for(;ee<=279;)H[2*ee+1]=7,ee++,Ce[7]++;for(;ee<=287;)H[2*ee+1]=8,ee++,Ce[8]++;for(ge(H,m+1,Ce),ee=0;ee<y;ee++)P[2*ee+1]=5,P[2*ee]=se(ee,5);q=new X(H,O,g+1,m,w),V=new X(P,L,0,y,w),ie=new X(new Array(0),A,0,b,T)})(),ue=!0),Q.l_desc=new D(Q.dyn_ltree,q),Q.d_desc=new D(Q.dyn_dtree,V),Q.bl_desc=new D(Q.bl_tree,ie),Q.bi_buf=0,Q.bi_valid=0,be(Q)},s._tr_stored_block=W,s._tr_flush_block=function(Q,ee,pe,we){var ae,xe,Ce=0;0<Q.level?(Q.strm.data_type===2&&(Q.strm.data_type=(function(Te){var Ie,Ze=4093624447;for(Ie=0;Ie<=31;Ie++,Ze>>>=1)if(1&Ze&&Te.dyn_ltree[2*Ie]!==0)return o;if(Te.dyn_ltree[18]!==0||Te.dyn_ltree[20]!==0||Te.dyn_ltree[26]!==0)return l;for(Ie=32;Ie<g;Ie++)if(Te.dyn_ltree[2*Ie]!==0)return l;return o})(Q)),ut(Q,Q.l_desc),ut(Q,Q.d_desc),Ce=(function(Te){var Ie;for(z(Te,Te.dyn_ltree,Te.l_desc.max_code),z(Te,Te.dyn_dtree,Te.d_desc.max_code),ut(Te,Te.bl_desc),Ie=b-1;3<=Ie&&Te.bl_tree[2*F[Ie]+1]===0;Ie--);return Te.opt_len+=3*(Ie+1)+5+5+4,Ie})(Q),ae=Q.opt_len+3+7>>>3,(xe=Q.static_len+3+7>>>3)<=ae&&(ae=xe)):ae=xe=pe+5,pe+4<=ae&&ee!==-1?W(Q,ee,pe,we):Q.strategy===4||xe===ae?(Z(Q,2+(we?1:0),3),He(Q,H,P)):(Z(Q,4+(we?1:0),3),(function(Te,Ie,Ze,Ue){var $t;for(Z(Te,Ie-257,5),Z(Te,Ze-1,5),Z(Te,Ue-4,4),$t=0;$t<Ue;$t++)Z(Te,Te.bl_tree[2*F[$t]+1],3);fe(Te,Te.dyn_ltree,Ie-1),fe(Te,Te.dyn_dtree,Ze-1)})(Q,Q.l_desc.max_code+1,Q.d_desc.max_code+1,Ce+1),He(Q,Q.dyn_ltree,Q.dyn_dtree)),be(Q),we&&me(Q)},s._tr_tally=function(Q,ee,pe){return Q.pending_buf[Q.d_buf+2*Q.last_lit]=ee>>>8&255,Q.pending_buf[Q.d_buf+2*Q.last_lit+1]=255&ee,Q.pending_buf[Q.l_buf+Q.last_lit]=255&pe,Q.last_lit++,ee===0?Q.dyn_ltree[2*pe]++:(Q.matches++,ee--,Q.dyn_ltree[2*(E[pe]+g+1)]++,Q.dyn_dtree[2*U(ee)]++),Q.last_lit===Q.lit_bufsize-1},s._tr_align=function(Q){Z(Q,2,3),re(Q,j,H),(function(ee){ee.bi_valid===16?(te(ee,ee.bi_buf),ee.bi_buf=0,ee.bi_valid=0):8<=ee.bi_valid&&(ee.pending_buf[ee.pending++]=255&ee.bi_buf,ee.bi_buf>>=8,ee.bi_valid-=8)})(Q)}},{"../utils/common":41}],53:[function(n,r,s){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,s){(function(i){(function(o,l){if(!o.setImmediate){var d,f,p,g,m=1,y={},b=!1,v=o.document,w=Object.getPrototypeOf&&Object.getPrototypeOf(o);w=w&&w.setTimeout?w:o,d={}.toString.call(o.process)==="[object process]"?function(M){process.nextTick(function(){T(M)})}:(function(){if(o.postMessage&&!o.importScripts){var M=!0,_=o.onmessage;return o.onmessage=function(){M=!1},o.postMessage("","*"),o.onmessage=_,M}})()?(g="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",j,!1):o.attachEvent("onmessage",j),function(M){o.postMessage(g+M,"*")}):o.MessageChannel?((p=new MessageChannel).port1.onmessage=function(M){T(M.data)},function(M){p.port2.postMessage(M)}):v&&"onreadystatechange"in v.createElement("script")?(f=v.documentElement,function(M){var _=v.createElement("script");_.onreadystatechange=function(){T(M),_.onreadystatechange=null,f.removeChild(_),_=null},f.appendChild(_)}):function(M){setTimeout(T,0,M)},w.setImmediate=function(M){typeof M!="function"&&(M=new Function(""+M));for(var _=new Array(arguments.length-1),R=0;R<_.length;R++)_[R]=arguments[R+1];var O={callback:M,args:_};return y[m]=O,d(m),m++},w.clearImmediate=S}function S(M){delete y[M]}function T(M){if(b)setTimeout(T,0,M);else{var _=y[M];if(_){b=!0;try{(function(R){var O=R.callback,L=R.args;switch(L.length){case 0:O();break;case 1:O(L[0]);break;case 2:O(L[0],L[1]);break;case 3:O(L[0],L[1],L[2]);break;default:O.apply(l,L)}})(_)}finally{S(M),b=!1}}}}function j(M){M.source===o&&typeof M.data=="string"&&M.data.indexOf(g)===0&&T(+M.data.slice(g.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Of<"u"?Of:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Ty)),Ty.exports}var TQ=NQ();const s1=Gl(TQ);function jQ(t){return t.replace(/[<>:"/\\|?*]/g,"").replace(/\s+/g," ").trim().slice(0,200)}async function EQ(t,e){const n=new s1;for(let r=0;r<t.length;r++){const{filename:s,xmlContent:i}=t[r],o=jQ(s);n.file(`${o}`,i),e?.(r+1,t.length)}return n.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}})}function MQ(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function $r(t,e){return e?`  <${t}>${MQ(e)}</${t}>
`:""}function AQ(t){let e=t.replace(/<br\s*\/?>/gi,`
`).replace(/<\/p>/gi,`
`).replace(/<p>/gi,"");return e=e.replace(/<[^>]+>/g,""),e=e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&apos;/g,"'").replace(/&nbsp;/g," "),e.replace(/\n+$/,"")}function RQ(t){if(!t||t.length===0)return"";const e=[];for(const n of t){n.label&&e.push(`[${n.label}]`);const s=AQ(n.content).split(`
`).filter(i=>i.trim());for(const i of s)e.push(` ${i}`)}return e.join(`
`)}function _Q(t){const e=[];e.push(`<?xml version="1.0" encoding="UTF-8"?>
`),e.push(`<song>
`),e.push($r("title",t.title)),e.push($r("author",t.author)),e.push($r("copyright",t.copyright)),e.push($r("ccli",t.ccli)),e.push($r("key",t.key)),e.push($r("tempo",t.tempo)),e.push($r("timesig",t.timeSignature)),e.push($r("theme",t.theme)),e.push($r("alttheme",t.altTheme)),e.push($r("hymn_number",t.hymnNumber)),e.push($r("key_line",t.keyLine)),e.push($r("presentation",t.presentationOrder));const n=RQ(t.slides);return n&&(e.push(`  <lyrics>
`),e.push(n),e.push(`
  </lyrics>
`)),e.push(`</song>
`),e.join("")}function OQ(){const[t,e]=C.useState(!1),[n,r]=C.useState(null);return{exportSongs:C.useCallback(async i=>{const l=`songs-export-${new Date().toISOString().split("T")[0]}.zip`,d=await k5({defaultPath:l,filters:[{name:"ZIP Archive",extensions:["zip"]}]});if(!d)return{success:!1,cancelled:!0,songCount:0,filename:""};e(!0),r({phase:"fetching",current:0,total:0});try{const f=await CQ(i.categoryId);if(f.length===0)return{success:!1,songCount:0,filename:"",error:"No songs to export"};r({phase:"generating",current:0,total:f.length});const p=f.map((y,b)=>(r({phase:"generating",current:b+1,total:f.length,currentSong:y.title}),{filename:y.title,xmlContent:_Q(y)}));r({phase:"zipping",current:0,total:p.length});const g=await EQ(p,(y,b)=>{r({phase:"zipping",current:y,total:b})});r({phase:"saving",current:0,total:1});const m=await g.arrayBuffer();return await kQ(d,new Uint8Array(m)),r({phase:"saving",current:1,total:1}),{success:!0,songCount:f.length,filename:d}}catch(f){return{success:!1,songCount:0,filename:"",error:f instanceof Error?f.message:String(f)}}finally{e(!1),r(null)}},[]),isPending:t,progress:n}}const IQ="https://download.resursecrestine.ro/programe-crestine/cantece-resurse-crestine-opensong-standard.zip",fT="Resurse Crestine";function DQ(){const{t}=ke("settings"),{showToast:e}=mt(),{batchImport:n,isPending:r,progress:s}=KQ(),{exportSongs:i,isPending:o,progress:l}=OQ(),{data:d}=Hp(),{mutateAsync:f}=Jb(),[p,g]=C.useState({type:"none"}),[m,y]=C.useState([]),[b,v]=C.useState(null),[w,S]=C.useState(!1),[T,j]=C.useState(null),[M,_]=C.useState({useFirstVerseAsTitle:!0,overwriteDuplicates:!1}),R=async()=>{try{const B=await S5({multiple:!0});if(B&&B.length>0){g({type:"importProgress"}),v(null);const E=await oW(B,K=>{v(K)});v(null),E.songs.length>0?(y(E.songs),j(null),_({useFirstVerseAsTitle:!0,overwriteDuplicates:!1}),g({type:"importConfirm"})):g({type:"noSongs"})}}catch(B){g({type:"none"}),v(null),e(t("sections.importExport.toast.importFailed",{error:String(B)}),"error")}},O=async(B,E)=>{const K=await n({songs:m.map(q=>{const V="metadata"in q.parsed?q.parsed.metadata:void 0;let ie;if(E.useFirstVerseAsTitle&&q.parsed.slides.length>0){const X=q.parsed.slides[0].text.split(`
`)[0]?.trim();ie=td(X||q.parsed.title)}else q.sourceFilename?ie=q.sourceFilename.replace(/\.[^.]+$/,"")||q.parsed.title:ie=q.parsed.title;return{title:ie,slides:q.parsed.slides.map((Y,X)=>({content:Y.htmlContent,sortOrder:X,label:"label"in Y?Y.label:null})),sourceFilename:q.sourceFilename,author:V?.author,copyright:V?.copyright,ccli:V?.ccli,key:V?.key,tempo:V?.tempo,timeSignature:V?.timeSignature,theme:V?.theme,altTheme:V?.altTheme,hymnNumber:V?.hymnNumber,keyLine:V?.keyLine,presentationOrder:V?.presentationOrder}}),categoryId:B},{overwriteDuplicates:E.overwriteDuplicates});g({type:"none"}),y([]),K.songIds.length>0&&e(t("sections.importExport.toast.importSuccess",{count:K.songIds.length}),"success")},L=()=>{g({type:"none"}),y([])},A=()=>{g({type:"exportOptions"})},F=async B=>{g({type:"none"});const E=await i({categoryId:B});E.cancelled||(E.success?e(t("sections.importExport.toast.exportSuccess",{count:E.songCount}),"success"):e(t("sections.importExport.toast.exportFailed",{error:E.error}),"error"))},H=()=>{g({type:"none"})},P=async()=>{S(!0),g({type:"importProgress"}),v({phase:"downloading",current:0,total:null,currentFile:"Resurse Crestine archive"});try{const B=await XQ(IQ,(V,ie)=>{v({phase:"downloading",current:V,total:ie,currentFile:"Resurse Crestine archive"})}),E=await lW(B,V=>{v(V)});if(v(null),E.songs.length===0){g({type:"noSongs"}),S(!1);return}let K=null;const q=d?.find(V=>V.name===fT);if(q)K=q.id;else{const V=await f({name:fT});V.success&&V.category&&(K=V.category.id)}y(E.songs),j(K),_({useFirstVerseAsTitle:!0,overwriteDuplicates:!0}),g({type:"importConfirm"})}catch(B){g({type:"none"}),v(null),e(t("sections.importExport.toast.importFailed",{error:String(B)}),"error")}finally{S(!1)}};return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.importExport.title")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:t("sections.importExport.description")})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(Du,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}),u.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:t("sections.importExport.import.title")})]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:t("sections.importExport.import.description")}),u.jsx("button",{type:"button",onClick:R,className:"w-full px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:t("sections.importExport.import.button")}),u.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-2",children:t("sections.importExport.import.supportedFormats")})]}),u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(od,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}),u.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:t("sections.importExport.resurseCrestine.title")})]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:t("sections.importExport.resurseCrestine.description")}),u.jsx("button",{type:"button",onClick:P,disabled:w,className:"w-full px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:t(w?"sections.importExport.resurseCrestine.importing":"sections.importExport.resurseCrestine.button")}),u.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-2",children:t("sections.importExport.resurseCrestine.note")})]}),u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(Eh,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}),u.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:t("sections.importExport.export.title")})]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:t("sections.importExport.export.description")}),u.jsx("button",{type:"button",onClick:A,className:"w-full px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:t("sections.importExport.export.button")})]})]}),u.jsx(BQ,{isOpen:p.type==="importProgress",progress:b}),u.jsx(PQ,{isOpen:p.type==="importConfirm",songs:m.map(B=>B.parsed),onConfirm:O,onCancel:L,isPending:r,progress:s,defaultCategoryId:T,defaultUseFirstVerseAsTitle:M.useFirstVerseAsTitle,defaultOverwriteDuplicates:M.overwriteDuplicates}),u.jsx(XE,{isOpen:p.type==="noSongs",title:t("sections.importExport.import.noSongsTitle"),message:t("sections.importExport.import.noSongsMessage"),onClose:()=>g({type:"none"})}),u.jsx(yQ,{isOpen:p.type==="exportOptions",onConfirm:F,onCancel:H}),u.jsx(xQ,{isOpen:o,progress:l})]})}function LQ({isOpen:t,onClose:e}){const{t:n}=ke("songs"),r=C.useRef(null);C.useEffect(()=>{t?r.current?.showModal():r.current?.close()},[t]),C.useEffect(()=>{const i=r.current;if(!i)return;const o=l=>{l.preventDefault(),e()};return i.addEventListener("cancel",o),()=>i.removeEventListener("cancel",o)},[e]);const s=i=>{i.target===r.current&&e()};return u.jsx("dialog",{ref:r,className:"fixed inset-0 m-auto w-full max-w-4xl p-0 bg-white dark:bg-gray-800 rounded-xl shadow-xl backdrop:bg-black/50",onClick:s,children:u.jsxs("div",{className:"flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n("settings.title")}),u.jsx("button",{type:"button",onClick:e,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(nt,{size:20,className:"text-gray-500"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:u.jsx(FP,{})}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:u.jsx(DQ,{})}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:u.jsx(mQ,{})})]})]})})}function zQ({isOpen:t,onDiscard:e,onCancel:n}){const{t:r}=ke(["songs","common"]),s=C.useRef(null);C.useEffect(()=>{const o=s.current;o&&(t?o.showModal():o.close())},[t]);const i=o=>{o.target===s.current&&n()};return u.jsx("dialog",{ref:s,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:n,onClick:i,children:u.jsxs("div",{className:"p-6 min-w-[300px] max-w-md",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:r("songs:modal.unsavedChangesTitle")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:r("songs:modal.unsavedChangesMessage")}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:r("common:buttons.cancel")}),u.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:r("songs:modal.discardChanges")})]})]})})}function PQ({isOpen:t,songs:e,onConfirm:n,onCancel:r,isPending:s,progress:i=0,defaultCategoryId:o=null,defaultUseFirstVerseAsTitle:l=!0,defaultOverwriteDuplicates:d=!1}){const{t:f}=ke("songs"),p=C.useRef(null),[g,m]=C.useState(o),[y,b]=C.useState(d),[v,w]=C.useState(l),[S,T]=C.useState(!1);C.useEffect(()=>{const R=p.current;R&&(t?R.showModal():R.close())},[t]),C.useEffect(()=>{t&&(m(o),b(d),w(l),T(!1))},[t,o,d,l]);const j=R=>{R.target===p.current&&!s&&r()},M=()=>{n(g,{overwriteDuplicates:y,useFirstVerseAsTitle:v,skipManuallyEdited:S})},_=e.length;return u.jsx("dialog",{ref:p,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:r,onClick:j,children:u.jsxs("div",{className:"p-6 min-w-[400px] max-w-lg",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Du,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:f("batchImport.title")})]}),u.jsx("button",{type:"button",onClick:r,disabled:s,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded transition-colors disabled:opacity-50",children:u.jsx(nt,{className:"w-5 h-5"})})]}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:f("batchImport.description",{count:_})}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:f("batchImport.categoryLabel")}),u.jsx(Vp,{value:g,onChange:m,disabled:s})]}),u.jsxs("div",{className:"mb-4 space-y-3",children:[u.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:v,onChange:R=>w(R.target.checked),disabled:s,className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"}),u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:f("batchImport.useFirstVerseAsTitle")})]}),u.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:y,onChange:R=>b(R.target.checked),disabled:s,className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"}),u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:f("batchImport.overwriteDuplicates")})]}),u.jsxs("label",{className:`flex items-center gap-2 ${y?"cursor-pointer":"opacity-50"}`,children:[u.jsx("input",{type:"checkbox",checked:S,onChange:R=>T(R.target.checked),disabled:s||!y,className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50"}),u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:f("batchImport.skipManuallyEdited")})]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:f("batchImport.songsList")}),u.jsx("div",{className:"max-h-48 overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg",children:u.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:e.map((R,O)=>u.jsxs("li",{className:"px-3 py-2 text-sm text-gray-900 dark:text-gray-100",children:[O+1,". ",R.title]},`${R.title}-${O}`))})})]}),s?u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex items-center justify-center gap-3",children:[u.jsx(Qe,{className:"w-5 h-5 text-indigo-600 animate-spin"}),u.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[f("batchImport.saving")," ",i,"%"]})]}),u.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:u.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${i}%`}})})]}):u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:f("common:buttons.cancel",{ns:"common"})}),u.jsx("button",{type:"button",onClick:M,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:f("batchImport.confirmButton",{count:_})})]})]})})}function BQ({isOpen:t,progress:e}){const{t:n}=ke("songs");if(!t)return null;const r=()=>{if(!e)return n("batchImport.processing");switch(e.phase){case"downloading":return n("batchImport.downloading");case"extracting":return n("batchImport.extracting");case"converting":return n("batchImport.converting");case"parsing":return n("batchImport.parsing");case"saving":return n("batchImport.saving");default:return n("batchImport.processing")}},s=e&&e.total!==null&&e.total>0,i=s?Math.round(e.current/e.total*100):0,o=l=>l<1024?`${l} B`:l<1024*1024?`${(l/1024).toFixed(1)} KB`:`${(l/(1024*1024)).toFixed(1)} MB`;return u.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[u.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),u.jsx("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-8 max-w-md w-full mx-4",children:u.jsxs("div",{className:"flex flex-col items-center gap-6",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Qe,{className:"w-16 h-16 text-indigo-600 animate-spin"}),s&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsxs("span",{className:"text-sm font-semibold text-indigo-600",children:[i,"%"]})})]}),u.jsxs("div",{className:"text-center space-y-2",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r()}),e&&u.jsxs(u.Fragment,{children:[e.phase==="downloading"?u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s?`${o(e.current)} / ${o(e.total)}`:o(e.current)}):s&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n("batchImport.processingProgress",{current:e.current,total:e.total})}),e.currentFile&&u.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 truncate max-w-xs",children:e.currentFile})]})]}),u.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:u.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ease-out ${s?"bg-indigo-600":"bg-indigo-600 animate-pulse"}`,style:{width:s?`${i}%`:"100%"}})})]})})]})}function td(t){if(!t.trim())return"Untitled Song";let e=t.replace(/^[^\p{L}]+/u,"");return e=e.replace(/[^\p{L}\p{N}\s\-\u2013\u2014]/gu,"").trim(),e||"Untitled Song"}function hT(t){return(t.split(/[/\\]/).pop()||t).replace(/\.[^.]+$/,"")}function FQ(t){if(!t.trim())return null;const e=t.split(`
`)[0].trim();if(!e)return null;const n=td(e);return n==="Untitled Song"?null:n}async function ia(t,e){const n=await s1.loadAsync(t),r=[],s=Object.keys(n.files).filter(o=>o.match(/ppt\/slides\/slide\d+\.xml$/)).sort((o,l)=>{const d=Number.parseInt(o.match(/slide(\d+)/)?.[1]||"0"),f=Number.parseInt(l.match(/slide(\d+)/)?.[1]||"0");return d-f});for(const o of s){const l=await n.file(o)?.async("string");if(l){const d=Number.parseInt(o.match(/slide(\d+)/)?.[1]||"0"),{text:f,htmlContent:p}=UQ(l);f.trim()&&r.push({slideNumber:d,text:f,htmlContent:p})}}let i="Imported Song";if(r.length>0){const o=FQ(r[0].text);o&&(i=o)}return i==="Imported Song"&&(e?i=td(hT(e)):t instanceof File&&t.name&&(i=td(hT(t.name)))),{title:i,slides:r}}function UQ(t){const n=new DOMParser().parseFromString(t,"application/xml"),r="http://schemas.openxmlformats.org/drawingml/2006/main",s=n.getElementsByTagNameNS(r,"p"),i=[];for(let d=0;d<s.length;d++){const f=s[d],p=$Q(f,r);for(const g of p)g.trim()&&i.push(g.trim())}const o=i.join(`
`),l=i.map(d=>`<p>${qQ(d)}</p>`).join("");return{text:o,htmlContent:l}}function $Q(t,e){const n=[];let r="";const s=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,null);let i=s.currentNode;for(;i;){if(i.nodeType===Node.ELEMENT_NODE){const o=i;o.localName==="br"&&o.namespaceURI===e&&(r.trim()&&n.push(r.trim()),r="")}else if(i.nodeType===Node.TEXT_NODE){const o=i.parentElement;if(o?.localName==="t"&&o.namespaceURI===e){const l=i.textContent||"";if(l.includes(`
`)){const d=l.split(`
`);for(let f=0;f<d.length;f++)r+=d[f],f<d.length-1&&(r.trim()&&n.push(r.trim()),r="")}else r+=l}}i=s.nextNode()}return r.trim()&&n.push(r.trim()),n}function qQ(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}const HQ=C.createContext({isDragging:!1});function VQ({children:t}){const{t:e}=ke("songs"),n=lr(),[r,s]=C.useState(!1),i=C.useRef(0),o=Zb(),l=C.useCallback(async(d,f)=>{const p=await o.mutateAsync({title:d.title,sourceFilename:f,slides:d.slides.map((g,m)=>({content:g.htmlContent,sortOrder:m}))});p.success&&p.data&&n({to:"/songs/$songId",params:{songId:String(p.data.id)}})},[n,o]);return C.useEffect(()=>{if(!(typeof window<"u"&&"__TAURI_INTERNALS__"in window))return;async function f(){try{const p=await Yt("get_pending_import");if(p&&p.toLowerCase().endsWith(".pptx")){const g=await hu(p),m=await ia(g.buffer,p);await l(m,p)}}catch(p){console.error("[pptx-import] Failed to handle pending import:",p)}}f()},[l]),C.useEffect(()=>{const d=m=>{m.preventDefault(),i.current++,m.dataTransfer?.items&&Array.from(m.dataTransfer.items).some(b=>b.kind==="file")&&s(!0)},f=m=>{m.preventDefault(),m.dataTransfer&&(m.dataTransfer.dropEffect="copy")},p=m=>{m.preventDefault(),i.current--,i.current===0&&s(!1)},g=async m=>{if(m.preventDefault(),i.current=0,s(!1),!m.dataTransfer?.files)return;const b=Array.from(m.dataTransfer.files).find(v=>v.name.toLowerCase().endsWith(".pptx"));if(b)try{const v=await ia(b),w=b.path;await l(v,w||null)}catch(v){console.error("[pptx-import] Failed to parse PPTX:",v)}};return document.addEventListener("dragenter",d),document.addEventListener("dragover",f),document.addEventListener("dragleave",p),document.addEventListener("drop",g),()=>{document.removeEventListener("dragenter",d),document.removeEventListener("dragover",f),document.removeEventListener("dragleave",p),document.removeEventListener("drop",g)}},[l]),u.jsxs(HQ.Provider,{value:{isDragging:r},children:[t,r&&u.jsx("div",{className:"fixed inset-0 z-50 bg-indigo-500/20 border-4 border-dashed border-indigo-500 pointer-events-none flex items-center justify-center",children:u.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-8 shadow-xl",children:u.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:e("pptxImport.dropHint")})})})]})}const jy=200;function KQ(){const t=Le(),[e,n]=C.useState(!1),[r,s]=C.useState(0);return{batchImport:async(o,l)=>{n(!0),s(0);const d=[];let f=0,p=0,g=0;try{for(let m=0;m<o.songs.length;m+=jy){const y=o.songs.slice(m,m+jy),b=await fetch(`${Ct()}/api/songs/batch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({songs:y.map(S=>({title:S.title,categoryId:o.categoryId,sourceFilename:S.sourceFilename,slides:S.slides,author:S.author,copyright:S.copyright,ccli:S.ccli,key:S.key,tempo:S.tempo,timeSignature:S.timeSignature,theme:S.theme,altTheme:S.altTheme,hymnNumber:S.hymnNumber,keyLine:S.keyLine,presentationOrder:S.presentationOrder})),categoryId:o.categoryId,overwriteDuplicates:l?.overwriteDuplicates??!1,skipManuallyEdited:l?.skipManuallyEdited??!1})});if(!b.ok){const S=await b.json().catch(()=>({}));throw new Error(S.error||`Batch import failed: ${b.statusText}`)}const v=await b.json();d.push(...v.data.songIds),f+=v.data.successCount,p+=v.data.failedCount,g+=v.data.skippedCount;const w=Math.min(m+jy,o.songs.length);s(Math.round(w/o.songs.length*100))}t.invalidateQueries({queryKey:["songs"]})}finally{n(!1),s(0)}return{successCount:f,failedCount:p,skippedCount:g,songIds:d}},isPending:e,progress:r}}class Mp extends Error{constructor(){super("LibreOffice is not installed"),this.name="LibreOfficeNotInstalledError"}}function QQ(t){const e=new Uint8Array(t);let n="";for(let r=0;r<e.byteLength;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function WQ(t){const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n.buffer}async function ub(t){const e=QQ(t),n=await fetch(`${Ct()}/api/convert/ppt-to-pptx`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:e})});if(!n.ok){const s=await n.json().catch(()=>({}));throw s.errorCode==="LIBREOFFICE_NOT_INSTALLED"?new Mp:new Error(s.error||"Conversion failed")}const r=await n.json();return WQ(r.data)}const YQ=typeof window<"u"&&"__TAURI_INTERNALS__"in window,GQ=YQ?hi:window.fetch.bind(window);async function XQ(t,e){const n=await GQ(t,{method:"GET",redirect:"follow"});if(!n.ok)throw new Error(`Failed to download: ${n.status} ${n.statusText}`);const r=n.headers.get("content-length"),s=r?parseInt(r,10):null,i=n.body?.getReader();if(!i)throw new Error("Failed to get response reader");const o=[];let l=0;for(;;){const{done:p,value:g}=await i.read();if(p)break;o.push(g),l+=g.length,e?.(l,s)}const d=new Uint8Array(l);let f=0;for(const p of o)d.set(p,f),f+=p.length;return d.buffer}const Ey=10;function JQ(t){const e=t.split(/[/\\]/).pop()||"",n=t.toLowerCase();return n.includes("__macosx")||n.includes(".ds_store")||e.startsWith(".")?!1:n.endsWith(".xml")||!e.includes(".")}function ZQ(t){const e=t.trim();return e.startsWith("<song")&&e.includes("<lyrics>")}async function My(t,e,n){const r=[];for(let s=0;s<t.length;s+=n){const i=t.slice(s,s+n),o=await Promise.all(i.map(e));r.push(...o)}return r}async function i1(t,e){const n=[],r=[],s=[],i=[];try{const o=await s1.loadAsync(t),d=Object.keys(o.files).filter(T=>!o.files[T].dir).map(T=>({path:T,file:o.files[T]})),f=d.length;let p=0;const g=[],m=[],y=[],b=[];for(const T of d){const j=T.path.toLowerCase();j.endsWith(".pptx")?g.push(T):j.endsWith(".ppt")?m.push(T):j.endsWith(".zip")?b.push(T):JQ(T.path)&&y.push(T)}const v=await My(g,async T=>{try{const j=await T.file.async("arraybuffer"),M=T.path.split(/[/\\]/).pop()||T.path;return p++,e?.(p,f),{success:!0,data:{filename:M,data:j,sourcePath:T.path}}}catch(j){p++,e?.(p,f);const M=j instanceof Error?j.message:"Unknown error";return{success:!1,error:`Failed to extract ${T.path}: ${M}`}}},Ey);for(const T of v)T.success?n.push(T.data):i.push(T.error);const w=await My(m,async T=>{try{const j=await T.file.async("arraybuffer"),M=T.path.split(/[/\\]/).pop()||T.path;return p++,e?.(p,f),{success:!0,data:{filename:M,data:j,sourcePath:T.path}}}catch(j){p++,e?.(p,f);const M=j instanceof Error?j.message:"Unknown error";return{success:!1,error:`Failed to extract ${T.path}: ${M}`}}},Ey);for(const T of w)T.success?r.push(T.data):i.push(T.error);const S=await My(y,async T=>{try{const j=await T.file.async("uint8array"),M=new TextDecoder().decode(j);return p++,e?.(p,f),ZQ(M)?{success:!0,data:{filename:T.path.split(/[/\\]/).pop()||T.path,content:M,sourcePath:T.path}}:{success:!1,error:null}}catch(j){p++,e?.(p,f);const M=j instanceof Error?j.message:"Unknown error";return{success:!1,error:`Failed to extract ${T.path}: ${M}`}}},Ey);for(const T of S)T.success&&T.data?s.push(T.data):T.error&&i.push(T.error);for(const T of b)try{const j=await T.file.async("arraybuffer"),M=await i1(j,(_,R)=>{e?.(p+_,f+R)});n.push(...M.pptxFiles),r.push(...M.pptFiles),s.push(...M.opensongFiles),i.push(...M.errors),p++,e?.(p,f)}catch(j){p++,e?.(p,f);const M=j instanceof Error?j.message:"Unknown error";i.push(`Failed to process nested ZIP ${T.path}: ${M}`)}}catch(o){const l=o instanceof Error?o.message:"Unknown error";i.push(`Failed to open ZIP archive: ${l}`)}return{pptxFiles:n,pptFiles:r,opensongFiles:s,errors:i}}function eW(t){return(t.split(/[/\\]/).pop()||t).replace(/\.[^.]+$/,"")}function tW(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function qr(t,e){return t.querySelector(e)?.textContent?.trim()||null}function nW(t,e){const n=qr(t,"title")||(e?eW(e):"Untitled Song"),r=td(n),s={author:qr(t,"author"),copyright:qr(t,"copyright"),ccli:qr(t,"ccli"),key:qr(t,"key"),tempo:qr(t,"tempo"),timeSignature:qr(t,"timesig"),theme:qr(t,"theme"),altTheme:qr(t,"alttheme"),hymnNumber:qr(t,"hymn_number"),keyLine:qr(t,"key_line"),presentationOrder:qr(t,"presentation")};return{title:r,metadata:s}}function rW(t){const e=[],n=t.split(`
`);let r=null;for(const s of n){const o=s.trim().match(/^\[([A-Z]\d*)\]$/);if(o)r&&r.lines.length>0&&e.push(r),r={label:o[1],lines:[]};else if(r){const d=(s.startsWith(" ")?s.substring(1):s).trim();d&&r.lines.push(d)}}return r&&r.lines.length>0&&e.push(r),e}function sW(t,e){const n=[],r=new Map;for(const o of t)r.set(o.label,o);let s;e&&e.trim()?s=e.trim().split(/\s+/):s=t.map(o=>o.label);let i=1;for(const o of s){const l=r.get(o);if(l){const d=l.lines.join(`
`),f=l.lines.map(p=>`<p>${tW(p)}</p>`).join("");n.push({slideNumber:i,text:d,htmlContent:f,label:l.label}),i++}}return n}function db(t,e){const r=new DOMParser().parseFromString(t,"application/xml"),s=r.querySelector("parsererror");if(s)throw new Error(`Invalid XML: ${s.textContent}`);const i=r.querySelector("song");if(!i)throw new Error("Invalid OpenSong file: missing <song> element");const{title:o,metadata:l}=nW(i,e),f=i.querySelector("lyrics")?.textContent||"",p=rW(f),g=sW(p,l.presentationOrder);return{title:o,slides:g,metadata:l,verses:p}}function Ay(t){if(!t)return null;const e=t.split(/[/\\]/);return e[e.length-1]||null}const wl=5;function iW(t){const e=t.split(/[/\\]/).pop()||"";return t.toLowerCase().endsWith(".xml")||!e.includes(".")}function aW(t){const e=t.trim();return e.startsWith("<song")&&e.includes("<lyrics>")}async function Sl(t,e,n,r){const s=[],i=t.length;for(let o=0;o<t.length;o+=n){const l=t.slice(o,o+n),d=await Promise.all(l.map((f,p)=>e(f,o+p)));s.push(...d),r?.(Math.min(o+n,i),i)}return s}async function oW(t,e){const n=[],r=[],s=[],i=[],o=[],l=[];for(const p of t){const g=p.toLowerCase();g.endsWith(".pptx")?i.push(p):g.endsWith(".ppt")?s.push(p):g.endsWith(".zip")?o.push(p):iW(p)&&l.push(p)}const d=s.length+i.length+o.length+l.length;let f=0;if(s.length>0){e?.({phase:"converting",current:0,total:s.length,currentFile:"PPT files"});const p=await Sl(s,async g=>{try{const m=await hu(g),y=await ub(m.buffer);return{success:!0,data:{parsed:await ia(y,g),sourceFilename:Ay(g),sourceFormat:"pptx"}}}catch(m){if(m instanceof Mp)return{success:!1,error:"LIBREOFFICE_NOT_INSTALLED"};const y=m instanceof Error?m.message:"Unknown error";return{success:!1,error:`Failed to convert ${g.split(/[/\\]/).pop()||g}: ${y}`}}},wl,(g,m)=>{e?.({phase:"converting",current:g,total:m,currentFile:"PPT files"})});for(const g of p)g.success?n.push(g.data):r.push(g.error)}for(const p of o){e?.({phase:"extracting",current:f,total:d,currentFile:p.split(/[/\\]/).pop()});try{const g=await hu(p),m=await i1(g.buffer,(y,b)=>{e?.({phase:"extracting",current:y,total:b,currentFile:p.split(/[/\\]/).pop()})});if(r.push(...m.errors),m.pptxFiles.length>0){e?.({phase:"parsing",current:0,total:m.pptxFiles.length,currentFile:"PPTX files"});const y=await Sl(m.pptxFiles,async b=>{try{return{success:!0,data:{parsed:await ia(b.data,b.filename),sourceFilename:b.filename,sourceFormat:"pptx"}}}catch(v){const w=v instanceof Error?v.message:"Unknown error";return{success:!1,error:`Failed to parse ${b.filename}: ${w}`}}},wl,(b,v)=>{e?.({phase:"parsing",current:b,total:v,currentFile:"PPTX files"})});for(const b of y)b.success?n.push(b.data):r.push(b.error)}if(m.pptFiles.length>0){e?.({phase:"converting",current:0,total:m.pptFiles.length,currentFile:"PPT files from ZIP"});const y=await Sl(m.pptFiles,async b=>{try{const v=await ub(b.data);return{success:!0,data:{parsed:await ia(v,b.filename),sourceFilename:b.filename,sourceFormat:"pptx"}}}catch(v){if(v instanceof Mp)return{success:!1,error:"LIBREOFFICE_NOT_INSTALLED"};const w=v instanceof Error?v.message:"Unknown error";return{success:!1,error:`Failed to convert ${b.filename}: ${w}`}}},wl,(b,v)=>{e?.({phase:"converting",current:b,total:v,currentFile:"PPT files from ZIP"})});for(const b of y)b.success?n.push(b.data):r.push(b.error)}if(m.opensongFiles.length>0){e?.({phase:"parsing",current:0,total:m.opensongFiles.length,currentFile:"OpenSong files"});const y=await Sl(m.opensongFiles,async b=>{try{return{success:!0,data:{parsed:db(b.content,b.filename),sourceFilename:b.filename,sourceFormat:"opensong"}}}catch(v){const w=v instanceof Error?v.message:"Unknown error";return{success:!1,error:`Failed to parse ${b.filename}: ${w}`}}},wl,(b,v)=>{e?.({phase:"parsing",current:b,total:v,currentFile:"OpenSong files"})});for(const b of y)b.success?n.push(b.data):r.push(b.error)}}catch(g){const m=g instanceof Error?g.message:"Unknown error",y=p.split(/[/\\]/).pop()||p;r.push(`Failed to read ${y}: ${m}`)}f++}if(i.length>0){e?.({phase:"parsing",current:0,total:i.length,currentFile:"PPTX files"});const p=await Sl(i,async g=>{try{const m=await hu(g);return{success:!0,data:{parsed:await ia(m.buffer,g),sourceFilename:Ay(g),sourceFormat:"pptx"}}}catch(m){const y=m instanceof Error?m.message:"Unknown error";return{success:!1,error:`Failed to process ${g.split(/[/\\]/).pop()||g}: ${y}`}}},wl,(g,m)=>{e?.({phase:"parsing",current:g,total:m,currentFile:"PPTX files"})});for(const g of p)g.success?n.push(g.data):r.push(g.error)}if(l.length>0){e?.({phase:"parsing",current:0,total:l.length,currentFile:"OpenSong files"});const p=await Sl(l,async g=>{try{const m=await hu(g),y=new TextDecoder().decode(m);return aW(y)?{success:!0,data:{parsed:db(y,g),sourceFilename:Ay(g),sourceFormat:"opensong"}}:{success:!1,error:`${g.split(/[/\\]/).pop()||g}: Not a valid OpenSong file`}}catch(m){const y=m instanceof Error?m.message:"Unknown error";return{success:!1,error:`Failed to parse ${g.split(/[/\\]/).pop()||g} as OpenSong: ${y}`}}},wl,(g,m)=>{e?.({phase:"parsing",current:g,total:m,currentFile:"OpenSong files"})});for(const g of p)g.success?n.push(g.data):g.error&&!g.error.includes("Not a valid OpenSong")&&r.push(g.error)}return{songs:n,errors:r}}const Ry=5;async function _y(t,e,n,r){const s=[],i=t.length;for(let o=0;o<t.length;o+=n){const l=t.slice(o,o+n),d=await Promise.all(l.map((f,p)=>e(f,o+p)));s.push(...d),r?.(Math.min(o+n,i),i)}return s}async function lW(t,e){const n=[],r=[];e?.({phase:"extracting",current:0,total:1,currentFile:"ZIP archive"});const s=await i1(t,(i,o)=>{e?.({phase:"extracting",current:i,total:o,currentFile:"ZIP archive"})});if(r.push(...s.errors),s.pptxFiles.length>0){e?.({phase:"parsing",current:0,total:s.pptxFiles.length,currentFile:"PPTX files"});const i=await _y(s.pptxFiles,async o=>{try{return{success:!0,data:{parsed:await ia(o.data,o.filename),sourceFilename:o.filename,sourceFormat:"pptx"}}}catch(l){const d=l instanceof Error?l.message:"Unknown error";return{success:!1,error:`Failed to parse ${o.filename}: ${d}`}}},Ry,(o,l)=>{e?.({phase:"parsing",current:o,total:l,currentFile:"PPTX files"})});for(const o of i)o.success?n.push(o.data):r.push(o.error)}if(s.pptFiles.length>0){e?.({phase:"converting",current:0,total:s.pptFiles.length,currentFile:"PPT files"});const i=await _y(s.pptFiles,async o=>{try{const l=await ub(o.data);return{success:!0,data:{parsed:await ia(l,o.filename),sourceFilename:o.filename,sourceFormat:"pptx"}}}catch(l){if(l instanceof Mp)return{success:!1,error:"LIBREOFFICE_NOT_INSTALLED"};const d=l instanceof Error?l.message:"Unknown error";return{success:!1,error:`Failed to convert ${o.filename}: ${d}`}}},Ry,(o,l)=>{e?.({phase:"converting",current:o,total:l,currentFile:"PPT files"})});for(const o of i)o.success?n.push(o.data):r.push(o.error)}if(s.opensongFiles.length>0){e?.({phase:"parsing",current:0,total:s.opensongFiles.length,currentFile:"OpenSong files"});const i=await _y(s.opensongFiles,async o=>{try{return{success:!0,data:{parsed:db(o.content,o.filename),sourceFilename:o.filename,sourceFormat:"opensong"}}}catch(l){const d=l instanceof Error?l.message:"Unknown error";return{success:!1,error:`Failed to parse ${o.filename}: ${d}`}}},Ry,(o,l)=>{e?.({phase:"parsing",current:o,total:l,currentFile:"OpenSong files"})});for(const o of i)o.success?n.push(o.data):r.push(o.error)}return{songs:n,errors:r}}const C5="language";function cW(){return navigator.language.toLowerCase().startsWith("ro")?"ro":"en"}async function uW(){const t=await po("app_settings",C5);if(!t)return null;const e=t.value;return e==="system"||e==="en"||e==="ro"?e:null}async function dW(t){return await go("app_settings",{key:C5,value:t})}function Oy(t){return!t||t==="system"?cW():t}const N5=C.createContext(void 0);function fW({children:t}){const{i18n:e}=ke(),[n,r]=C.useState("system"),[s,i]=C.useState("en"),[o,l]=C.useState(!0);C.useEffect(()=>{async function f(){try{const g=await uW()||"system",m=Oy(g);r(g),i(m),await e.changeLanguage(m)}catch{const g=Oy("system");i(g),await e.changeLanguage(g)}finally{l(!1)}}f()},[e]);const d=async f=>{try{const p=Oy(f);await dW(f)&&(r(f),i(p),await e.changeLanguage(p),localStorage.setItem("church-hub-language",p))}catch{}};return u.jsx(N5.Provider,{value:{language:s,preference:n,setLanguagePreference:d,isLoading:o},children:t})}function hW(){const t=C.useContext(N5);if(t===void 0)throw new Error("useI18n must be used within an I18nProvider");return t}async function pW(){return(await Me("/api/users")).data}async function gW(t){return(await Me("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).data}async function mW(t,e){return(await Me(`/api/users/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).data}async function yW(t){return(await Me(`/api/users/${t}`,{method:"DELETE"})).data.success}async function xW(t,e){return(await Me(`/api/users/${t}/permissions`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({permissions:e})})).data}async function bW(t){return(await Me(`/api/users/${t}/regenerate-token`,{method:"POST"})).data}async function vW(){try{return(await Me("/api/auth/me")).data}catch{return null}}function wW(t){return`${Ct()}/api/auth/user/${encodeURIComponent(t)}`}function SW(t,e){return`http://${e}:3000/api/auth/user/${encodeURIComponent(t)}`}async function kW(){return(await Me("/api/network/interfaces")).data}function CW(t){return t.startsWith("custom_page.")&&t.endsWith(".view")}const fb=["songs.view","songs.create","songs.edit","songs.delete","songs.add_to_queue","songs.present_now","bible.view","bible.import","bible.delete","bible.add_to_queue","bible.present_now","control_room.view","control_room.control","programs.view","programs.create","programs.edit","programs.delete","programs.import_to_queue","queue.view","queue.add","queue.remove","queue.reorder","queue.clear","settings.view","settings.edit","displays.view","displays.create","displays.edit","displays.delete","users.view","users.create","users.edit","users.delete"],kl={songs:["songs.view","songs.create","songs.edit","songs.delete","songs.add_to_queue","songs.present_now"],bible:["bible.view","bible.import","bible.delete","bible.add_to_queue","bible.present_now"],control_room:["control_room.view","control_room.control"],programs:["programs.view","programs.create","programs.edit","programs.delete","programs.import_to_queue"],queue:["queue.view","queue.add","queue.remove","queue.reorder","queue.clear"],settings:["settings.view","settings.edit"],displays:["displays.view","displays.create","displays.edit","displays.delete"],users:["users.view","users.create","users.edit","users.delete"]},hb={admin:fb,presenter:["control_room.view","control_room.control","songs.view","songs.add_to_queue","songs.present_now","bible.view","bible.add_to_queue","bible.present_now","queue.view","queue.add","queue.remove","queue.reorder","programs.view","programs.import_to_queue","displays.view"],viewer:["control_room.view","songs.view","bible.view","programs.view","queue.view","displays.view"],queue_manager:["queue.view","queue.add","queue.remove","queue.reorder","queue.clear","songs.view","songs.add_to_queue","programs.view","programs.import_to_queue","control_room.view"]},T5=C.createContext(void 0);function NW({children:t}){const[e,n]=C.useState(null),[r,s]=C.useState(!0),i=async()=>{try{const b=await vW();n(b)}catch{n(null)}finally{s(!1)}};C.useEffect(()=>{i()},[]);const o=e?.permissions??[],l=e?.isApp??!1,d=l?fb:o,f=b=>l?!0:(CW(b),d.includes(b)),p=b=>l?!0:b.some(v=>f(v)),g=b=>l?!0:b.every(v=>f(v)),m=l||fb.every(b=>d.includes(b)),y={permissions:d,hasPermission:f,hasAnyPermission:p,hasAllPermissions:g,isAdmin:m,isApp:l,isAuthenticated:e!==null,isLoading:r,userId:e?.id??null,userName:e?.name??null,refresh:i};return u.jsx(T5.Provider,{value:y,children:t})}function j5(){const t=C.useContext(T5);if(t===void 0)throw new Error("usePermissions must be used within a PermissionsProvider");return t}const TW=new GL({defaultOptions:{queries:{refetchOnWindowFocus:!1,refetchOnReconnect:!0,gcTime:1e4*60,retry:3},mutations:{retry:0}}});function E5({children:t}){return u.jsx(XL,{client:TW,children:t})}const M5="theme";function A5(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"}async function jW(){const t=await po("app_settings",M5);if(!t)return null;const e=t.value;return e==="system"||e==="light"||e==="dark"?e:null}async function EW(t){return await go("app_settings",{key:M5,value:t})}function pT(t){return!t||t==="system"?A5():t}const R5=C.createContext(void 0);function _5({children:t}){const[e,n]=C.useState("system"),[r,s]=C.useState("dark"),[i,o]=C.useState(!0);C.useEffect(()=>{async function d(){try{const p=await jW()||"system",g=pT(p);n(p),s(g)}catch{const p=A5();s(p)}finally{o(!1)}}d()},[]),C.useEffect(()=>{const d=document.documentElement,f=document.body;d.classList.remove("light","dark"),d.classList.add(r),f.classList.remove("light","dark"),f.classList.add(r),localStorage.setItem("church-hub-theme",r)},[r]),C.useEffect(()=>{if(e!=="system")return;const d=window.matchMedia("(prefers-color-scheme: dark)"),f=p=>{const g=p.matches?"dark":"light";s(g)};return d.addEventListener("change",f),()=>d.removeEventListener("change",f)},[e]);const l=async d=>{try{const f=pT(d);await EW(d)&&(n(d),s(f))}catch{}};return u.jsx(R5.Provider,{value:{theme:r,preference:e,setThemePreference:l,isLoading:i},children:t})}function MW(){const t=C.useContext(R5);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t}function AW(t){const e=[/(?:youtube\.com\/watch\?v=|youtube\.com\/watch\?.*&v=)([a-zA-Z0-9_-]{11})/,/youtu\.be\/([a-zA-Z0-9_-]{11})/,/youtube\.com\/embed\/([a-zA-Z0-9_-]{11})/,/youtube\.com\/v\/([a-zA-Z0-9_-]{11})/,/youtube\.com\/shorts\/([a-zA-Z0-9_-]{11})/];for(const n of e){const r=t.match(n);if(r?.[1])return r[1]}return null}function RW(t){return t.includes("youtube.com")||t.includes("youtu.be")||t.includes("youtube-nocookie.com")}function _W(t){const e=AW(t);return e?`https://www.youtube-nocookie.com/embed/${e}?autoplay=0&rel=0`:null}function O5(t){if(RW(t)){const e=_W(t);if(e)return e}return t}const I5=new Map;let zn=null,gT=null;const OW="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36";function IW(t){return`custom-page-${t}`}async function a1(){const e=document.querySelector("aside")?.getBoundingClientRect().width??256;try{const{getCurrentWindow:n}=await Cn(async()=>{const{getCurrentWindow:f}=await import("./window-D06WGgXh.js").then(p=>p.w);return{getCurrentWindow:f}},__vite__mapDeps([3,2])),r=n(),s=await r.innerSize(),i=await r.scaleFactor(),o=s.width/i,l=s.height/i;return{x:e,y:0,width:o-e,height:l}}catch{return{x:e,y:0,width:window.innerWidth-e,height:window.innerHeight}}}async function D5(){if(zn)try{const{Webview:t}=await Cn(async()=>{const{Webview:i}=await import("./webview-Cdqbqo1f.js");return{Webview:i}},__vite__mapDeps([1,2,3])),{LogicalPosition:e,LogicalSize:n}=await Cn(async()=>{const{LogicalPosition:i,LogicalSize:o}=await import("./dpi-Dqb_mONB.js");return{LogicalPosition:i,LogicalSize:o}},[]),r=await t.getByLabel(zn);if(!r)return;const s=await a1();await r.setPosition(new e(s.x,s.y)),await r.setSize(new n(s.width,s.height))}catch{}}function mT(){if(gT)return;let t=null;const e=()=>{t&&clearTimeout(t),t=setTimeout(D5,100)};window.addEventListener("resize",e),gT=()=>{window.removeEventListener("resize",e),t&&clearTimeout(t)}}async function DW(t,e){if(!sn())return;const n=IW(t),r=O5(e);try{const{Webview:s}=await Cn(async()=>{const{Webview:m}=await import("./webview-Cdqbqo1f.js");return{Webview:m}},__vite__mapDeps([1,2,3])),{getCurrentWindow:i}=await Cn(async()=>{const{getCurrentWindow:m}=await import("./window-D06WGgXh.js").then(y=>y.w);return{getCurrentWindow:m}},__vite__mapDeps([3,2])),{LogicalPosition:o,LogicalSize:l}=await Cn(async()=>{const{LogicalPosition:m,LogicalSize:y}=await import("./dpi-Dqb_mONB.js");return{LogicalPosition:m,LogicalSize:y}},[]);zn&&zn!==n&&await o1(zn);const d=await a1(),f=await s.getByLabel(n);if(f){await f.setPosition(new o(d.x,d.y)),await f.setSize(new l(d.width,d.height)),await f.show(),await f.setFocus(),zn=n,mT();return}const p=i(),g=new s(p,n,{url:r,x:d.x,y:d.y,width:d.width,height:d.height,userAgent:OW});await new Promise((m,y)=>{g.once("tauri://created",()=>{m()}),g.once("tauri://error",b=>{y(new Error(`Failed to create webview: ${b}`))})}),I5.set(n,g),zn=n,mT(),p.onResized(D5)}catch(s){throw s}}async function o1(t){try{const{Webview:e}=await Cn(async()=>{const{Webview:s}=await import("./webview-Cdqbqo1f.js");return{Webview:s}},__vite__mapDeps([1,2,3])),{LogicalPosition:n}=await Cn(async()=>{const{LogicalPosition:s}=await import("./dpi-Dqb_mONB.js");return{LogicalPosition:s}},[]),r=await e.getByLabel(t);if(!r)return;await r.setPosition(new n(-9999,-9999));try{await r.hide()}catch{}zn===t&&(zn=null)}catch{zn===t&&(zn=null)}}async function LW(){if(!sn())return;const t=zn;t&&await o1(t)}async function L5(){if(!sn())return;const t=Array.from(I5.keys());for(const e of t)await o1(e);zn=null}async function zW(){if(!(!sn()||!zn))try{const{Webview:t}=await Cn(async()=>{const{Webview:i}=await import("./webview-Cdqbqo1f.js");return{Webview:i}},__vite__mapDeps([1,2,3])),{LogicalPosition:e,LogicalSize:n}=await Cn(async()=>{const{LogicalPosition:i,LogicalSize:o}=await import("./dpi-Dqb_mONB.js");return{LogicalPosition:i,LogicalSize:o}},[]),r=await t.getByLabel(zn);if(!r)return;const s=await a1();await r.setPosition(new e(s.x,s.y)),await r.setSize(new n(s.width,s.height))}catch{}}function yT(t){const e=t.match(/^\/custom-page\/(.+)$/);return e?e[1]:null}function PW(){const t=Ip(),[e]=C.useState(()=>sn()),n=C.useRef(t.pathname);return C.useEffect(()=>{if(!e)return;const r=t.pathname,s=yT(n.current),i=yT(r);s!==null&&!(i!==null)&&L5(),n.current=r},[t.pathname,e]),null}function BW({isCollapsed:t}){return u.jsxs("div",{className:"flex items-center justify-center gap-3 px-4 py-4 border-b border-gray-200 dark:border-gray-800",children:[u.jsx("img",{src:"/logo192.png",alt:"Church Hub",className:"flex-shrink-0",style:{width:t?32:40,height:t?32:40}}),!t&&u.jsx("h1",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Church Hub"})]})}function xT({icon:t,label:e,to:n,isCollapsed:r,isActive:s,className:i="",disabled:o=!1,onClick:l}){const d=`
    flex items-center gap-3 px-4 py-3 rounded-lg transition-all
    ${r?"md:justify-center":""}
    ${i}
  `,f=s?"bg-indigo-50 dark:bg-indigo-950 text-indigo-600 dark:text-indigo-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800",p="opacity-50 cursor-not-allowed text-gray-400 dark:text-gray-600",g=u.jsxs(u.Fragment,{children:[u.jsx(t,{size:20,className:"flex-shrink-0"}),u.jsx("span",{className:"text-sm font-medium md:hidden",children:e}),!r&&u.jsx("span",{className:"text-sm font-medium hidden md:inline",children:e})]});return o?u.jsx("div",{className:`${d} ${p}`,title:r?e:void 0,children:g}):u.jsx(kb,{to:n,className:`${d} ${f}`,title:r?e:void 0,onClick:l,children:g})}const l1={present:{id:"present",icon:u6,labelKey:"sidebar:navigation.present",to:"/present",permission:"control_room.view"},songs:{id:"songs",icon:ya,labelKey:"sidebar:navigation.songs",to:"/songs",permission:"songs.view"},bible:{id:"bible",icon:Sr,labelKey:"sidebar:navigation.bible",to:"/bible",permission:"bible.view"},schedules:{id:"schedules",icon:zp,labelKey:"sidebar:navigation.schedules",to:"/schedules",permission:"programs.view"},livestream:{id:"livestream",icon:GD,labelKey:"sidebar:navigation.livestream",to:"/livestream",permission:"settings.view"},settings:{id:"settings",icon:di,labelKey:"sidebar:navigation.settings",to:"/settings",permission:"settings.view"}},Iy={version:1,items:[{id:"present",type:"builtin",builtinId:"present",order:0,isVisible:!0},{id:"songs",type:"builtin",builtinId:"songs",order:1,isVisible:!0},{id:"bible",type:"builtin",builtinId:"bible",order:2,isVisible:!0},{id:"schedules",type:"builtin",builtinId:"schedules",order:3,isVisible:!0},{id:"livestream",type:"builtin",builtinId:"livestream",order:4,isVisible:!0}]},FW=["Globe","Link","ExternalLink","FileText","Video","Image","Bookmark","Star","Heart","Home","Users","Calendar","MessageSquare","Phone","Mail","Map","Compass","Search","Clock","Bell","Layers","Grid","List","Folder"],z5="sidebar_configuration",UW={Globe:od,Link:Hj,ExternalLink:Fp,FileText:fs,Video:rE,Image:$j,Bookmark:Oj,Star:nE,Heart:Fj,Home:Uj,Users:$l,Calendar:Ij,MessageSquare:Yj,Phone:Xj,Mail:Qj,Map:Wj,Compass:Lj,Search:Zl,Clock:Pp,Bell:_j,Layers:qj,Grid:Bj,List:Kj,Folder:Pj};function $W({value:t,onChange:e}){const{t:n}=ke("settings");return u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-sm font-medium text-gray-900 dark:text-white",children:n("sections.sidebar.fields.icon")}),u.jsx("div",{className:"grid grid-cols-6 gap-2 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:FW.map(r=>{const s=UW[r],i=t===r;return u.jsx("button",{type:"button",onClick:()=>e(r),className:`
                p-2.5 rounded-lg transition-all flex items-center justify-center
                ${i?"bg-indigo-100 dark:bg-indigo-900/50 text-indigo-600 dark:text-indigo-400 ring-2 ring-indigo-500":"bg-white dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-600"}
              `,title:r,children:u.jsx(s,{size:20})},r)})}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:n("sections.sidebar.fields.selectIcon")})]})}function qW(t){try{return new URL(t),!0}catch{return!1}}function bT({isOpen:t,editingPage:e,onSubmit:n,onClose:r}){const{t:s}=ke("settings"),i=C.useRef(null),o=C.useRef(null),[l,d]=C.useState(""),[f,p]=C.useState(""),[g,m]=C.useState("Globe"),[y,b]=C.useState(!1),[v,w]=C.useState({}),S=!!e;C.useEffect(()=>{t&&(e?(d(e.title),p(e.url),m(e.iconName),b(e.useIframeEmbedding??!1)):(d(""),p(""),m("Globe"),b(!1)),w({}))},[t,e]),C.useEffect(()=>{const _=i.current;_&&(t?(_.showModal(),setTimeout(()=>o.current?.focus(),50)):_.close())},[t]);const T=_=>{_.target===i.current&&r()},j=()=>{const _={};return l.trim()||(_.title=s("sections.sidebar.validation.titleRequired")),f.trim()?qW(f)||(_.url=s("sections.sidebar.validation.urlInvalid")):_.url=s("sections.sidebar.validation.urlRequired"),w(_),Object.keys(_).length===0},M=_=>{_.preventDefault(),j()&&n({id:e?.id,title:l.trim(),url:f.trim(),iconName:g,useIframeEmbedding:y})};return u.jsx("dialog",{ref:i,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-lg w-full",onClose:r,onClick:T,children:u.jsxs("form",{onSubmit:M,className:"p-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:s(S?"sections.sidebar.modals.edit.title":"sections.sidebar.modals.create.title")}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{htmlFor:"custom-page-title",className:"text-sm font-medium text-gray-900 dark:text-white",children:s("sections.sidebar.fields.title")}),u.jsx("input",{ref:o,id:"custom-page-title",type:"text",value:l,onChange:_=>d(_.target.value),placeholder:s("sections.sidebar.fields.titlePlaceholder"),className:`
                block w-full px-3 py-2.5 bg-white dark:bg-gray-700
                border text-gray-900 dark:text-white text-sm rounded-lg
                focus:ring-indigo-500 focus:border-indigo-500
                placeholder:text-gray-500 dark:placeholder:text-gray-400
                ${v.title?"border-red-500":"border-gray-300 dark:border-gray-600"}
              `}),v.title&&u.jsx("p",{className:"text-sm text-red-500",children:v.title})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{htmlFor:"custom-page-url",className:"text-sm font-medium text-gray-900 dark:text-white",children:s("sections.sidebar.fields.url")}),u.jsx("input",{id:"custom-page-url",type:"text",value:f,onChange:_=>p(_.target.value),placeholder:s("sections.sidebar.fields.urlPlaceholder"),className:`
                block w-full px-3 py-2.5 bg-white dark:bg-gray-700
                border text-gray-900 dark:text-white text-sm rounded-lg
                focus:ring-indigo-500 focus:border-indigo-500
                placeholder:text-gray-500 dark:placeholder:text-gray-400
                ${v.url?"border-red-500":"border-gray-300 dark:border-gray-600"}
              `}),v.url&&u.jsx("p",{className:"text-sm text-red-500",children:v.url}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s("sections.sidebar.fields.urlHint")})]}),u.jsx($W,{value:g,onChange:m}),u.jsxs("div",{className:"flex items-start gap-3 pt-2",children:[u.jsx("input",{id:"use-iframe-embedding",type:"checkbox",checked:y,onChange:_=>b(_.target.checked),className:"mt-1 h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx("label",{htmlFor:"use-iframe-embedding",className:"text-sm font-medium text-gray-900 dark:text-white cursor-pointer",children:s("sections.sidebar.fields.useIframeEmbedding")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s("sections.sidebar.fields.useIframeEmbeddingHint")})]})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:s("common:buttons.cancel",{defaultValue:"Cancel"})}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:s(S?"sections.sidebar.modals.edit.submit":"sections.sidebar.modals.create.submit")})]})]})})}function HW(t){const e=Object.keys(l1),n=new Set(t.items.map(s=>s.id)),r=e.filter(s=>!n.has(s)).map((s,i)=>({id:s,type:"builtin",builtinId:s,order:t.items.length+i,isVisible:!0}));return r.length===0?t:{...t,items:[...t.items,...r]}}function VW(t){if(typeof t!="object"||t===null)return!1;const e=t;return!(e.version!==1||!Array.isArray(e.items))}async function KW(){const t=await po("app_settings",z5);if(!t)return Iy;try{const e=JSON.parse(t.value);return VW(e)?HW(e):Iy}catch{return Iy}}async function QW(t){return go("app_settings",{key:z5,value:JSON.stringify(t)})}function WW(){return`custom_${Date.now()}_${Math.random().toString(36).substring(2,9)}`}function YW(t){return`custom_page.${t}.view`}const Cl=["settings","sidebar_configuration"];function c1(){const t=Le(),{data:e,isLoading:n,error:r}=lt({queryKey:Cl,queryFn:KW,staleTime:300*1e3}),s=De({mutationFn:QW,onMutate:async i=>{await t.cancelQueries({queryKey:Cl});const o=t.getQueryData(Cl);return t.setQueryData(Cl,i),{previousConfig:o}},onError:(i,o,l)=>{l?.previousConfig&&t.setQueryData(Cl,l.previousConfig)},onSettled:()=>{t.invalidateQueries({queryKey:Cl})}});return{config:e,isLoading:n,error:r,updateConfig:s}}function GW({pageId:t}){const{t:e}=ke("settings"),{config:n,isLoading:r}=c1(),[s,i]=C.useState(!0),[o,l]=C.useState(null),[d]=C.useState(()=>sn()),f=n?.items.find(m=>m.id===t&&m.type==="custom"),p=C.useMemo(()=>f?.url?O5(f.url):null,[f?.url]),g=!d||f?.useIframeEmbedding;return C.useEffect(()=>{i(!0),l(null)},[t]),C.useEffect(()=>{g&&d&&LW()},[g,d,t]),C.useEffect(()=>{if(!f||!d||g){g||i(!1);return}const y=setTimeout(async()=>{try{await DW(f.id,f.url),i(!1),l(null)}catch(b){l(String(b)),i(!1)}},150);return()=>{clearTimeout(y)}},[f?.id,f?.url,d,g]),r?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600"})}):f?g?u.jsx("div",{className:"-m-4 md:-m-6 h-[calc(100%+2rem)] md:h-[calc(100%+3rem)] flex flex-col",children:u.jsx("iframe",{src:p??f.url,title:f.title,className:"flex-1 w-full border-0",sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-downloads",allow:"clipboard-write; clipboard-read; fullscreen"})}):!s&&!o?null:u.jsx("div",{className:"-m-4 md:-m-6 h-[calc(100%+2rem)] md:h-[calc(100%+3rem)] flex flex-col",children:u.jsxs("div",{className:"flex-1 relative bg-white dark:bg-gray-900",children:[s&&!o&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50 dark:bg-gray-800 z-10",children:u.jsxs("div",{className:"flex flex-col items-center gap-3",children:[u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e("sections.sidebar.loadingPage",{defaultValue:"Loading page..."})})]})}),o&&u.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-800 gap-4 p-8",children:[u.jsx(jh,{className:"w-12 h-12 text-red-500"}),u.jsxs("div",{className:"text-center max-w-md",children:[u.jsx("p",{className:"text-gray-900 dark:text-white font-medium mb-2",children:e("sections.sidebar.loadError",{defaultValue:"Failed to load page"})}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:o})]})]})]})}):u.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[u.jsx(jh,{className:"w-12 h-12 text-gray-400"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e("sections.sidebar.pageNotFound",{defaultValue:"Page not found"})})]})}const P5={Globe:od,Link:Hj,ExternalLink:Fp,FileText:fs,Video:rE,Image:$j,Bookmark:Oj,Star:nE,Heart:Fj,Home:Uj,Users:$l,Calendar:Ij,MessageSquare:Yj,Phone:Xj,Mail:Qj,Map:Wj,Compass:Lj,Search:Zl,Clock:Pp,Bell:_j,Layers:qj,Grid:Bj,List:Kj,Folder:Pj};function XW(t){const{t:e}=ke();return C.useMemo(()=>{if(!t)return[];const n=[];for(const r of t.filter(s=>s.isVisible).sort((s,i)=>s.order-i.order))if(r.type==="builtin"){const s=l1[r.builtinId];if(!s)continue;n.push({id:r.id,icon:s.icon,label:e(s.labelKey),to:s.to,permission:s.permission,isCustom:!1})}else{const s=P5[r.iconName]??od;n.push({id:r.id,icon:s,label:r.title,to:`/custom-page/${r.id}`,permission:YW(r.id),isCustom:!0})}return n},[t,e])}function JW(t){return P5[t]??od}function ZW({item:t,onToggleVisibility:e,onEdit:n,onDelete:r}){const{t:s}=ke(["settings","sidebar"]),{attributes:i,listeners:o,setNodeRef:l,transform:d,transition:f,isDragging:p}=wo({id:t.id}),g={transform:us.Transform.toString(d),transition:f,opacity:p?.5:1},m=t.type==="builtin",y=t.type==="custom";let b,v;if(m){const w=l1[t.builtinId];b=w?.icon,v=s(w?.labelKey??"")}else b=JW(t.iconName),v=t.title;return u.jsxs("div",{ref:l,style:g,className:`
        flex items-center gap-3 p-3 bg-white dark:bg-gray-800
        border border-gray-200 dark:border-gray-700 rounded-lg
        ${p?"shadow-lg ring-2 ring-indigo-500":""}
        ${t.isVisible?"":"opacity-60"}
      `,children:[u.jsx("button",{type:"button",className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 cursor-grab active:cursor-grabbing",...i,...o,children:u.jsx(cr,{size:20})}),b&&u.jsx("div",{className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-md bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400",children:u.jsx(b,{size:18})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate",children:v}),u.jsx("span",{className:`
              text-xs px-1.5 py-0.5 rounded
              ${m?"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400":"bg-indigo-100 dark:bg-indigo-900/50 text-indigo-600 dark:text-indigo-400"}
            `,children:s(m?"settings:sections.sidebar.builtIn":"settings:sections.sidebar.custom")})]}),y&&u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 truncate block",children:t.url})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{type:"button",onClick:e,className:`
            p-2 rounded-lg transition-colors
            ${t.isVisible?"text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20":"text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"}
          `,title:t.isVisible?s("settings:sections.sidebar.visible"):s("settings:sections.sidebar.hidden"),children:t.isVisible?u.jsx(pa,{size:18}):u.jsx(Jl,{size:18})}),y&&n&&u.jsx("button",{type:"button",onClick:n,className:"p-2 text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 rounded-lg transition-colors",title:s("common:buttons.edit",{defaultValue:"Edit"}),children:u.jsx(to,{size:18})}),y&&r&&u.jsx("button",{type:"button",onClick:r,className:"p-2 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:s("common:buttons.delete",{defaultValue:"Delete"}),children:u.jsx(Fn,{size:18})})]})]})}function eY(){const{t}=ke("settings"),{showToast:e}=mt(),{config:n,isLoading:r,updateConfig:s}=c1(),[i,o]=C.useState(!1),[l,d]=C.useState(null),[f,p]=C.useState(null),g=mo(ar(xi),ar(yi,{coordinateGetter:So})),m=j=>{const{active:M,over:_}=j;if(!_||!n||M.id===_.id)return;const R=[...n.items],O=R.findIndex(H=>H.id===M.id),L=R.findIndex(H=>H.id===_.id);if(O===-1||L===-1)return;const[A]=R.splice(O,1);R.splice(L,0,A);const F=R.map((H,P)=>({...H,order:P}));s.mutate({...n,items:F},{onSuccess:()=>{e(t("sections.sidebar.toast.saved"),"success")},onError:()=>{e(t("sections.sidebar.toast.error"),"error")}})},y=j=>{if(!n)return;const M=n.items.map(_=>_.id===j?{..._,isVisible:!_.isVisible}:_);s.mutate({...n,items:M},{onSuccess:()=>{e(t("sections.sidebar.toast.saved"),"success")},onError:()=>{e(t("sections.sidebar.toast.error"),"error")}})},b=j=>{if(!n)return;const M={id:WW(),type:"custom",title:j.title,url:j.url,iconName:j.iconName,useIframeEmbedding:j.useIframeEmbedding,order:n.items.length,isVisible:!0},_=[...n.items,M];s.mutate({...n,items:_},{onSuccess:()=>{o(!1),e(t("sections.sidebar.toast.customPageCreated"),"success")},onError:()=>{e(t("sections.sidebar.toast.error"),"error")}})},v=j=>{if(!n||!j.id)return;const M=n.items.map(_=>_.id===j.id&&_.type==="custom"?{..._,title:j.title,url:j.url,iconName:j.iconName,useIframeEmbedding:j.useIframeEmbedding}:_);s.mutate({...n,items:M},{onSuccess:()=>{d(null),e(t("sections.sidebar.toast.customPageUpdated"),"success")},onError:()=>{e(t("sections.sidebar.toast.error"),"error")}})},w=()=>{if(!n||!f)return;const j=n.items.filter(M=>M.id!==f).map((M,_)=>({...M,order:_}));s.mutate({...n,items:j},{onSuccess:()=>{p(null),e(t("sections.sidebar.toast.customPageDeleted"),"success")},onError:()=>{e(t("sections.sidebar.toast.error"),"error")}})},S=n?.items?[...n.items].filter(j=>j.id!=="settings").sort((j,M)=>j.order-M.order):[],T=f?S.find(j=>j.id===f&&j.type==="custom"):null;return r?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(Qe,{className:"w-6 h-6 animate-spin text-indigo-600"})}):u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[u.jsx(BD,{className:"w-5 h-5"}),t("sections.sidebar.title")]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t("sections.sidebar.description")})]}),u.jsxs("button",{type:"button",onClick:()=>o(!0),className:"flex items-center gap-2 px-3 py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-medium rounded-lg transition-colors",children:[u.jsx(Xt,{size:16}),t("sections.sidebar.addCustomPage")]})]}),u.jsx(xo,{sensors:g,collisionDetection:yo,onDragEnd:m,children:u.jsx(vo,{items:S.map(j=>j.id),strategy:bo,children:u.jsx("div",{className:"space-y-2",children:S.map(j=>u.jsx(ZW,{item:j,onToggleVisibility:()=>y(j.id),onEdit:j.type==="custom"?()=>d(j):void 0,onDelete:j.type==="custom"?()=>p(j.id):void 0},j.id))})})}),u.jsx(bT,{isOpen:i,onSubmit:b,onClose:()=>o(!1)}),u.jsx(bT,{isOpen:!!l,editingPage:l,onSubmit:v,onClose:()=>d(null)}),u.jsx(fi,{isOpen:!!f,title:t("sections.sidebar.modals.delete.title"),message:t("sections.sidebar.modals.delete.message",{name:T?.title??""}),confirmLabel:t("sections.sidebar.modals.delete.confirm"),onConfirm:w,onCancel:()=>p(null),variant:"danger"})]})}function tY(){const[t,e]=C.useState(!1),[n,r]=C.useState(!1),s=Ip(),{t:i}=ke(["sidebar","common"]),{hasPermission:o}=j5(),{config:l}=c1(),f=XW(l?.items).filter(m=>m.id==="settings"?!1:m.isCustom||m.permission?o(m.permission):!0),p=o("settings.view"),g=C.useCallback(m=>{m.startsWith("/custom-page/")||L5()},[]);return C.useEffect(()=>{r(!1)},[s.pathname]),C.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[n]),C.useEffect(()=>{const m=setTimeout(()=>{zW()},350);return()=>clearTimeout(m)},[t]),u.jsxs(u.Fragment,{children:[u.jsxs("header",{className:"md:hidden fixed top-0 left-0 right-0 z-40 flex items-center justify-between px-4 py-3 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("img",{src:"/logo192.png",alt:"Church Hub",className:"w-8 h-8"}),u.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Church Hub"})]}),u.jsx("button",{onClick:()=>r(!0),className:"p-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":i("sidebar:actions.openMenu"),children:u.jsx(jD,{size:24})})]}),n&&u.jsx("div",{className:"md:hidden fixed inset-0 z-40 bg-black/50 backdrop-blur-sm",onClick:()=>r(!1)}),u.jsxs("aside",{className:`
          fixed md:relative z-50 md:z-auto
          flex flex-col h-full bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800
          transition-all duration-300 ease-in-out
          w-72 md:w-auto top-0 left-0
          ${t?"md:w-20":"md:w-64"}
          ${n?"translate-x-0":"-translate-x-full md:translate-x-0"}
        `,children:[u.jsxs("div",{className:"md:hidden flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("img",{src:"/logo192.png",alt:"Church Hub",className:"w-8 h-8"}),u.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Church Hub"})]}),u.jsx("button",{onClick:()=>r(!1),className:"p-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":i("sidebar:actions.closeMenu"),children:u.jsx(nt,{size:24})})]}),u.jsx("div",{className:"hidden md:block",children:u.jsx(BW,{isCollapsed:t})}),u.jsxs("nav",{className:"flex-1 flex flex-col gap-2 p-3 overflow-y-auto",children:[f.map(m=>u.jsx(xT,{icon:m.icon,label:m.label,to:m.to,isCollapsed:t,isActive:s.pathname===m.to||s.pathname.startsWith(`${m.to}/`),className:"md:flex",onClick:()=>g(m.to)},m.id)),p&&u.jsx("div",{className:"mt-auto",children:u.jsx(xT,{icon:di,label:i("sidebar:navigation.settings"),to:"/settings",isCollapsed:t,isActive:s.pathname==="/settings"||s.pathname.startsWith("/settings/"),className:"md:flex",onClick:()=>g("/settings")})})]}),u.jsx("div",{className:"p-3 border-t border-gray-200 dark:border-gray-800 space-y-2",children:u.jsx("button",{onClick:()=>e(!t),className:`hidden md:flex w-full items-center gap-3 px-4 py-3 rounded-lg
              text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800
              transition-colors`,title:i(t?"sidebar:actions.expand":"sidebar:actions.collapseSidebar"),children:t?u.jsx(As,{size:20,className:"flex-shrink-0"}):u.jsxs(u.Fragment,{children:[u.jsx(Dj,{size:20,className:"flex-shrink-0"}),u.jsx("span",{className:"text-sm font-medium",children:i("sidebar:actions.collapse")})]})})})]})]})}function nY({children:t}){return Ip().pathname.startsWith("/screen/")?u.jsx(u.Fragment,{children:t}):u.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-50 dark:bg-gray-950",children:[u.jsx(PW,{}),u.jsx(tY,{}),u.jsx("main",{className:"flex-1 overflow-y-auto [scrollbar-gutter:stable] scrollbar-thin bg-gray-50 dark:bg-gray-950 pt-14 md:pt-0",children:u.jsx("div",{className:"p-4 md:p-6 h-full",children:t})})]})}const{slice:rY,forEach:sY}=[];function iY(t){return sY.call(rY.call(arguments,1),e=>{if(e)for(const n in e)t[n]===void 0&&(t[n]=e[n])}),t}function aY(t){return typeof t!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(n=>n.test(t))}const vT=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,oY=function(t,e){const r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},s=encodeURIComponent(e);let i=`${t}=${s}`;if(r.maxAge>0){const o=r.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");i+=`; Max-Age=${Math.floor(o)}`}if(r.domain){if(!vT.test(r.domain))throw new TypeError("option domain is invalid");i+=`; Domain=${r.domain}`}if(r.path){if(!vT.test(r.path))throw new TypeError("option path is invalid");i+=`; Path=${r.path}`}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");i+=`; Expires=${r.expires.toUTCString()}`}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return r.partitioned&&(i+="; Partitioned"),i},wT={create(t,e,n,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};n&&(s.expires=new Date,s.expires.setTime(s.expires.getTime()+n*60*1e3)),r&&(s.domain=r),document.cookie=oY(t,e,s)},read(t){const e=`${t}=`,n=document.cookie.split(";");for(let r=0;r<n.length;r++){let s=n[r];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return s.substring(e.length,s.length)}return null},remove(t,e){this.create(t,"",-1,e)}};var lY={name:"cookie",lookup(t){let{lookupCookie:e}=t;if(e&&typeof document<"u")return wT.read(e)||void 0},cacheUserLanguage(t,e){let{lookupCookie:n,cookieMinutes:r,cookieDomain:s,cookieOptions:i}=e;n&&typeof document<"u"&&wT.create(n,t,r,s,i)}},cY={name:"querystring",lookup(t){let{lookupQuerystring:e}=t,n;if(typeof window<"u"){let{search:r}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(r=window.location.hash.substring(window.location.hash.indexOf("?")));const i=r.substring(1).split("&");for(let o=0;o<i.length;o++){const l=i[o].indexOf("=");l>0&&i[o].substring(0,l)===e&&(n=i[o].substring(l+1))}}return n}},uY={name:"hash",lookup(t){let{lookupHash:e,lookupFromHashIndex:n}=t,r;if(typeof window<"u"){const{hash:s}=window.location;if(s&&s.length>2){const i=s.substring(1);if(e){const o=i.split("&");for(let l=0;l<o.length;l++){const d=o[l].indexOf("=");d>0&&o[l].substring(0,d)===e&&(r=o[l].substring(d+1))}}if(r)return r;if(!r&&n>-1){const o=s.match(/\/([a-zA-Z-]*)/g);return Array.isArray(o)?o[typeof n=="number"?n:0]?.replace("/",""):void 0}}}return r}};let Nl=null;const ST=()=>{if(Nl!==null)return Nl;try{if(Nl=typeof window<"u"&&window.localStorage!==null,!Nl)return!1;const t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{Nl=!1}return Nl};var dY={name:"localStorage",lookup(t){let{lookupLocalStorage:e}=t;if(e&&ST())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupLocalStorage:n}=e;n&&ST()&&window.localStorage.setItem(n,t)}};let Tl=null;const kT=()=>{if(Tl!==null)return Tl;try{if(Tl=typeof window<"u"&&window.sessionStorage!==null,!Tl)return!1;const t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{Tl=!1}return Tl};var fY={name:"sessionStorage",lookup(t){let{lookupSessionStorage:e}=t;if(e&&kT())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupSessionStorage:n}=e;n&&kT()&&window.sessionStorage.setItem(n,t)}},hY={name:"navigator",lookup(t){const e=[];if(typeof navigator<"u"){const{languages:n,userLanguage:r,language:s}=navigator;if(n)for(let i=0;i<n.length;i++)e.push(n[i]);r&&e.push(r),s&&e.push(s)}return e.length>0?e:void 0}},pY={name:"htmlTag",lookup(t){let{htmlTag:e}=t,n;const r=e||(typeof document<"u"?document.documentElement:null);return r&&typeof r.getAttribute=="function"&&(n=r.getAttribute("lang")),n}},gY={name:"path",lookup(t){let{lookupFromPathIndex:e}=t;if(typeof window>"u")return;const n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(n)?n[typeof e=="number"?e:0]?.replace("/",""):void 0}},mY={name:"subdomain",lookup(t){let{lookupFromSubdomainIndex:e}=t;const n=typeof e=="number"?e+1:1,r=typeof window<"u"&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(r)return r[n]}};let B5=!1;try{document.cookie,B5=!0}catch{}const F5=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];B5||F5.splice(1,1);const yY=()=>({order:F5,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t});class U5{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,n)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=iY(n,this.options||{},yY()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=s=>s.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=r,this.addDetector(lY),this.addDetector(cY),this.addDetector(dY),this.addDetector(fY),this.addDetector(hY),this.addDetector(pY),this.addDetector(gY),this.addDetector(mY),this.addDetector(uY)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,n=[];return e.forEach(r=>{if(this.detectors[r]){let s=this.detectors[r].lookup(this.options);s&&typeof s=="string"&&(s=[s]),s&&(n=n.concat(s))}}),n=n.filter(r=>r!=null&&!aY(r)).map(r=>this.options.convertDetectedLanguage(r)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}cacheUserLanguage(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;n&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||n.forEach(r=>{this.detectors[r]&&this.detectors[r].cacheUserLanguage(e,this.options)}))}}U5.type="languageDetector";const xY="Bible",bY={placeholder:'Search verses (e.g., "Gen 1:1" or "In the beginning")',hint:'Type a reference like "Gen 1:1" or search for text',noResults:"No results found",searching:"Searching...",directReference:"Direct reference",resultsCount:"{{count}} verse found",resultsCount_other:"{{count}} verses found"},vY={back:"Back",oldTestament:"Old Testament",newTestament:"New Testament",noBooks:"No books available"},wY={title:"Bible Queue",empty:"No verses in queue",removed:"Verse removed from queue",remove:"Remove"},SY={title:"Preview",prev:"Prev",next:"Next",prevVerse:"Previous verse",nextVerse:"Next verse",show:"Show",hide:"Hide"},kY={title:"Keyboard Shortcuts",navigate:"Navigate verses",back:"Go back",hide:"Hide display",present:"Present verse"},CY={presentNow:"Present now",addToQueue:"Add to queue",import:"Import",importFirst:"Import Bible Translation",settings:"Settings",openSettings:"Open Settings"},NY={title:"No Bible translations",description:"Import a Bible translation in USFX XML format to get started.",noTranslationsSelected:"No translations selected",noTranslationsSelectedDescription:"Go to Settings > Bible Translations to select which translations to use."},TY={title:"Bible Settings",import:{title:"Import Translation",description:"Import a Bible translation from an USFX XML file.",button:"Select File",formatTitle:"Required Format: USFX XML",formatDescription:"The Bible translation must be in USFX (Unified Standard Format XML) format. This is a standardized format used for Scripture encoding.",structureTitle:"File Structure Example:",hints:{rootElement:"Root element must be <usfx>",bookElement:'Each book uses <book id="XXX"> with standard abbreviations (GEN, EXO, etc.)',chapterElement:'Chapters use <c id="N"> where N is the chapter number',verseElement:'Verses use <v id="N">text</v> where N is the verse number'}}},jY={select:"Select translation",loading:"Loading translations..."},EY={title:xY,search:bY,navigation:vY,queue:wY,controls:SY,shortcuts:kY,actions:CY,empty:NY,import:{title:"Import Bible Translation",error:"Failed to import translation",errorTitle:"Import Error",success:"Translation imported successfully"},settings:TY,translation:jY},MY={goBack:"Go back",startOver:"Start Over",cancel:"Cancel",confirm:"Confirm",delete:"Delete",save:"Save",ok:"OK"},AY={pageNotFound:"The page you are looking for does not exist.",noPermission:"You don't have permission to access this page.",noPermissionTitle:"Access Denied",contactAdmin:"Please contact your administrator if you believe this is an error."},RY={system:"System",lightMode:"Light mode",darkMode:"Dark mode",toggleTheme:"Toggle theme"},_Y={buttons:MY,errors:AY,theme:RY},OY="Live Stream",IY={notConnected:"YouTube not connected",connected:"Connected as {{channelName}}",login:"Login with YouTube",logout:"Disconnect YouTube",authenticating:"Authenticating...",loggingOut:"Logging out...",clickToConnect:"Click to connect to YouTube",clickToDisconnect:"Click to disconnect from YouTube",openGuide:"Setup Guide",settings:"YouTube Settings",titleTemplate:"Title Template",description:"Description",privacyStatus:"Privacy",privacyPublic:"Public",privacyUnlisted:"Unlisted",privacyPrivate:"Private",streamKey:"Stream Key",selectStreamKey:"Select stream key",playlist:"Playlist ID",startScene:"Start Scene",setup:{title:"YouTube Live Setup",templateTitle:"Use Previous Broadcast Settings",templateDescription:"Select settings from a past broadcast:",noTemplates:"No past broadcasts found",noTemplatesHint:"Create a live stream in YouTube Studio first. After your broadcast ends, it will appear here.",completedAt:"Completed",usingTemplate:"Using broadcast settings",usingTemplateHint:"These settings will be applied to your next broadcast.",firstTimeTitle:"First time streaming?",firstTimeDescription:"Create a live stream directly in YouTube Studio. Configure your stream settings, go live from OBS, and your broadcast will be saved here for future use.",openYouTubeStudio:"Open YouTube Studio",close:"Close"}},DY={connected:"OBS Connected",disconnected:"OBS Disconnected",connecting:"Connecting...",connect:"Connect to OBS",disconnect:"Disconnect",disconnecting:"Disconnecting...",clickToConnect:"Click to connect to OBS",clickToDisconnect:"Click to disconnect from OBS",openGuide:"Setup Guide",settings:"OBS Settings",host:"Host",port:"Port",password:"Password",autoConnect:"Auto-connect on startup",setup:{title:"OBS WebSocket Setup",helpLink:"Need help connecting?",step1Title:"Step 1: Install OBS WebSocket",step1Description:"OBS WebSocket is required for Church Hub to control OBS Studio. For OBS 28+, it's built-in. For older versions, download and install it:",downloadLink:"Download OBS WebSocket from GitHub",step2Title:"Step 2: Enable WebSocket Server",step2Instruction1:"Open OBS Studio",step2Instruction2:"Go to Tools  WebSocket Server Settings",step2Instruction3:'Check "Enable WebSocket server" and set the password below',step3Title:"Step 3: Configure Password",step3Description:"Copy this password and paste it in OBS WebSocket Server Settings:",copy:"Copy",copied:"Copied!",noteTitle:"Note:",noteDescription:"Make sure to use the same password in OBS. Church Hub will automatically use this password when connecting.",saveAndClose:"Save & Close"}},LY={startStream:"Start Stream",stopStream:"Stop Stream",isLive:"LIVE",notStreaming:"Not Streaming",starting:"Starting...",stopping:"Stopping...",progress:{creating_broadcast:"Creating broadcast",waiting_for_ready:"Waiting for YouTube",delay_before_stream:"Preparing stream",starting_obs:"Starting OBS",completed:"Stream started",error:"Error starting stream"}},zY={currentBroadcast:"Current Broadcast",noBroadcast:"No active broadcast",loading:"Loading broadcast info...",copyMessage:"Copy Message",messageCopied:"Message copied to clipboard",copyToClipboard:"Copy to clipboard",copied:"Copied!",openInYouTube:"Open in YouTube",watchLive:"Watch Live",openStudio:"YouTube Studio"},PY={title:"Scenes",settings:"Scene Settings",sceneSettings:"Scene Settings",displayName:"Display Name",visible:"Visible",hidden:"Hidden",current:"Current",shortcuts:"Keyboard Shortcuts",addShortcut:"Add Shortcut",removeShortcut:"Remove",recordShortcut:"Press keys...",clickToRecord:"Click to record",recording:"Recording...",noShortcuts:"No shortcuts assigned",shortcutConflict:'Already used by "{{scene}}"',streamSceneSettings:"Stream Scene Settings",useAsStartScene:"Use as stream start scene",useAsStartSceneDescription:"This scene will be activated before the stream starts",useAsStopScene:"Use as stream stop scene",useAsStopSceneDescription:"This scene will be activated after the stream stops",autoSceneSettings:"Auto-Switch Settings",autoSceneDescription:"Switch to this scene when showing:",contentTypes:{song:"Songs",bible:"Bible Verse",biblePassage:"Bible Passage",announcement:"Announcements",verseteTineri:"Versete Tineri",empty:"Empty / Clock"},mixerActions:"Mixer Channel Actions",mixerActionsDescription:"Configure mixer channels when this scene activates:",unmute:"Unmute",mute:"Mute",selectChannels:"Select channels...",selectContentTypes:"Select content types...",addMore:"Add more..."},BY={title:"Mixer",connected:"Mixer Connected",disconnected:"Mixer Disconnected",reconnecting:"Reconnecting...",testing:"Testing...",enable:"Enable Mixer",disable:"Disable Mixer",settings:"Mixer Settings",setup:{title:"Mixer Setup",connectionSettings:"Connection Settings",host:"Host IP",port:"Port",enableControl:"Enable Mixer Control",channelConfiguration:"Channel Configuration",channelCount:"Number of Channels",channelPlaceholder:"Channel label",testConnection:"Test Connection",testing:"Testing...",testSuccess:"Connection successful!",testFailed:"Connection failed",save:"Save"}},FY={obsConnectionFailed:"Failed to connect to OBS",obsNotRunning:"Cannot connect to OBS. Make sure OBS is running and WebSocket server is enabled (Tools  WebSocket Server Settings).",obsAuthFailed:"OBS authentication failed. Check your WebSocket password in OBS settings.",obsTimeout:"Connection to OBS timed out. Check that the host and port are correct.",youtubeAuthFailed:"YouTube authentication failed",youtubeSessionExpired:"Your YouTube session has expired. Please reconnect.",youtubeReauthRequired:"YouTube requires you to sign in again",broadcastFailed:"Failed to create broadcast",sceneSwitchFailed:"Failed to switch scene",startStreamFailed:"Failed to start stream",stopStreamFailed:"Failed to stop stream"},UY={title:OY,youtube:IY,obs:DY,stream:LY,broadcast:zY,scenes:PY,mixer:BY,errors:FY},$Y={title:"Screens",description:"Configure screens for different display purposes. Each screen type has its own layout and configuration options.",addScreen:"Add Screen",addFirstScreen:"Add First Screen",noScreens:"No screens configured",noScreensDescription:"Add your first screen to configure how content is displayed.",screenName:"Screen Name",screenNamePlaceholder:"e.g., Main Projector",screenType:"Screen Type",screenTypes:{primary:"Primary / Audience",stage:"Stage Monitor",livestream:"Live Stream"},createAndConfigure:"Create & Configure",deleteConfirmTitle:"Delete Screen?",deleteConfirmMessage:'Are you sure you want to delete "{{name}}"? This action cannot be undone.',editor:{preview:"Preview",zoom:"Zoom",resetZoom:"Reset Zoom",save:"Save",unsavedChanges:"Unsaved changes",previewText:"Preview Text",previewTextDescription:"Customize the preview text to test how your styling looks with different content.",customPreviewText:"Custom Text",previewTextPlaceholder:"Enter custom preview text (multiline supported)...",resetPreviewText:"Reset to Default"},contentTypes:{song:"Song",bible:"Bible Verse",bible_passage:"Bible Passage",announcement:"Announcement",versete_tineri:"Versete Tineri",empty:"Empty / Clock"},panels:{position:"Position & Size",textStyle:"Text Style",animation:"Animation",background:"Background",general:"General Settings",nextSlide:"Next Slide Section",visibility:"Visibility"},visibility:{hideElement:"Hide element"},position:{x:"X Position",y:"Y Position",width:"Width",height:"Height",unit:"Unit",pixels:"Pixels",percent:"Percent",constraints:"Constraints",element:"Element",top:"Top",bottom:"Bottom",left:"Left",right:"Right",stretchHorizontal:"Width stretches between left and right constraints",stretchVertical:"Height stretches between top and bottom constraints"},textStyle:{fontFamily:"Font Family",maxFontSize:"Max Font Size",autoScale:"Auto Scale",autoScaleDescription:"Automatically scales text to fit the container. When disabled, uses a fixed font size.",fontSize:"Font Size",color:"Color",bold:"Bold",italic:"Italic",underline:"Underline",horizontalAlignment:"Horizontal Alignment",verticalAlignment:"Vertical Alignment",left:"Left",center:"Center",right:"Right",top:"Top",middle:"Middle",bottom:"Bottom",lineHeight:"Line Height",shadow:"Text Shadow",compressLines:"Compress Lines",lineSeparator:"Line Separator",separators:{space:"Double Space",dash:"Em Dash ()",pipe:"Pipe (|)"},fitLineToWidth:"Fit Each Line to Width",fitLineToWidthDescription:"Prevents line wrapping - each line scales to fit container width"},animation:{animationIn:"Animation In",animationOut:"Animation Out",type:"Type",duration:"Duration",delay:"Delay",easing:"Easing",types:{none:"None",fade:"Fade",slideUp:"Slide Up",slideDown:"Slide Down",slideLeft:"Slide Left",slideRight:"Slide Right",scale:"Scale",blur:"Blur"},easings:{linear:"Linear",easeIn:"Ease In",easeOut:"Ease Out",easeInOut:"Ease In Out",bounce:"Bounce"}},background:{type:"Type",types:{transparent:"Transparent",color:"Solid Color",image:"Image",video:"Video"},color:"Color",imageUrl:"Image URL",videoUrl:"Video URL",opacity:"Opacity"},general:{screenSize:"Screen Size",width:"Width",height:"Height",clockEnabled:"Show Clock",defaultBackground:"Default Background"},nextSlide:{enabled:"Show Next Slide Section",labelText:"Label Text",labelStyle:"Label Style",contentStyle:"Content Style"},bibleOptions:{title:"Bible Options",includeReferenceInContent:"Include reference in content",includeReferenceInContentDescription:"Prepends the Bible reference to the verse content and hides the separate reference element"},nativeWindow:"Native Window",messages:{screenCreated:"Screen created successfully",screenCreateFailed:"Failed to create screen",screenSaved:"Screen saved successfully",screenSaveFailed:"Failed to save screen",screenDeleted:"Screen deleted successfully",screenDeleteFailed:"Failed to delete screen"},renderer:{loading:"Loading screen configuration...",error:"Failed to load screen",notFound:"Screen not found"}},qY={title:"Displays",description:"Configure output displays for your presentations. Each display can have its own theme and settings.",add:"Add Display",addFirst:"Add Your First Display",edit:"Edit Display",empty:"No Displays",emptyDescription:"Create displays to output your presentations to different screens or windows.",name:"Display Name",namePlaceholder:"e.g., Main Screen, Stage Monitor",activeLabel:"Display is active",active:"Active",inactive:"Inactive",activate:"Activate",deactivate:"Deactivate",editTheme:"Edit Theme",openWindow:"Open Display Window",deleteConfirmTitle:"Delete Display?",deleteConfirmMessage:'Are you sure you want to delete "{{name}}"? This action cannot be undone.',openMode:"Open Mode",openModes:{browser:"Browser",native:"Native Window"},fullscreenLabel:"Open in fullscreen by default"},HY={title:"Display Theme",backgroundType:"Background Type",backgrounds:{transparent:"Transparent",color:"Solid Color",image:"Image"},backgroundColor:"Background Color",backgroundImage:"Image URL",textColor:"Text Color",fontFamily:"Font Family",padding:"Padding",preview:"Preview",sampleText:"Sample Text"},VY={save:"Save",cancel:"Cancel",delete:"Delete",close:"Close"},KY={displaySaved:"Display saved successfully",displaySaveFailed:"Failed to save display",displayDeleted:"Display deleted",displayDeleteFailed:"Failed to delete display",displayActivated:"Display activated",displayDeactivated:"Display deactivated",displayToggleFailed:"Failed to toggle display status",themeSaved:"Theme saved successfully",themeSaveFailed:"Failed to save theme"},QY={start:"Start",stop:"Stop",prev:"Previous",next:"Next",clear:"Clear Slide",show:"Show",hide:"Hide",screenHidden:"Screen is hidden",screenDisplayed:"Screen is displayed"},WY={title:"Control Room",selectProgram:"Select a program",presenting:"Presenting",notPresenting:"Not presenting",connected:"Connected",connecting:"Connecting...",disconnected:"Disconnected",openDisplay:"Open Display",slides:"Slides",noSlides:"No slides in this program",preview:"Preview"},YY={screens:$Y,displays:qY,theme:HY,actions:VY,messages:KY,controls:QY,controlRoom:WY},GY="Queue",XY="Queue is empty",JY="Add songs to start presenting",ZY="{{count}} song",eG="{{count}} songs",tG="{{count}} item",nG="{{count}} items",rG={addToQueue:"Add to Queue",presentNow:"Present Now",remove:"Remove",clear:"Clear Queue",expand:"Expand",collapse:"Collapse",editSong:"Edit",editSlide:"Edit Slide",insertSlide:"Insert Slide After",insertAfter:"Insert After",moreOptions:"More options",cancel:"Cancel",addToSchedule:"Add to Schedule",saveAsProgram:"Save as Program"},sG={button:"Add",title:"Add to Queue",searchSong:"Search Song",searchSongDescription:"Find and add an existing song",bibleVerse:"Bible Verse",bibleVerseDescription:"Search and add a Bible verse",biblePassage:"Bible Passage",biblePassageDescription:"Add a range of Bible verses",announcement:"Announcement",announcementDescription:"Create a custom announcement slide",verseteTineri:"Versete Tineri",verseteTineriDescription:"Add a youth verse slide",importSchedule:"Import Schedule",importScheduleDescription:"Add all items from a saved schedule"},iG={added:"Added to queue",removed:"Removed from queue",cleared:"Queue cleared",presenting:"Now presenting",error:"An error occurred",slideInserted:"Slide inserted",slideUpdated:"Slide updated",savedAsProgram:"Queue saved as program",biblePassageInserted:"Bible passage added to queue",verseteTineriInserted:"Youth verses added to queue"},aG={title:"Save Queue as Program",nameLabel:"Program Name",namePlaceholder:"Enter program name",save:"Save",cancel:"Cancel"},oG={title:"Clear Queue?",message:"This will remove all items from the queue."},lG={announcement:"Announcement",versete_tineri:"Versete tineri"},cG={title:"Insert Slide",editTitle:"Edit Slide",selectTemplate:"Select template",content:"Content",insert:"Insert",save:"Save",errorEmpty:"Please add content to the slide"},uG={title:"Import Schedule",description:"Add all items from a saved schedule to the queue"},dG={title:"Add Bible Passage",translation:"Translation",reference:"Reference",referencePlaceholder:"e.g., Gen 1:1-5 or Ioan 3:16",referenceHint:"Enter book, chapter, and verse range",valid:"Valid",add:"Add to Queue",passage:"Bible Passage",errors:{empty:"Please enter a reference",invalid_format:"Invalid format. Try: Gen 1:1 or Gen 1:1-5",book_not_found:"Book not found",invalid_chapter:"Invalid chapter number",end_before_start:"End must be after start"}},fG={title:"Youth Verses",addEntry:"Add Entry",personName:"Person Name",personNamePlaceholder:"Enter name...",bibleReference:"Bible Reference",bibleReferencePlaceholder:"e.g., John 3:16",entriesCount_one:"{{count}} entry",entriesCount_other:"{{count}} entries",removeEntry:"Remove entry",noEntries:"No entries added yet",addFirstEntry:"Add an entry to get started"},hG={title:GY,empty:XY,emptyDescription:JY,songCount_one:ZY,songCount_other:eG,itemCount_one:tG,itemCount_other:nG,actions:rG,addToQueue:sG,messages:iG,saveAsProgram:aG,confirmClear:oG,slideTemplates:lG,insertSlide:cG,importSchedule:uG,biblePassage:dG,verseteTineri:fG},pG="Schedules",gG={create:"New Schedule",save:"Save",delete:"Delete",back:"Back to Schedules",addItem:"Add",importToQueue:"Import to Queue"},mG={titlePlaceholder:"Enter schedule title...",descriptionPlaceholder:"Add a description (optional)...",items:"Items",noItems:"No items yet",addFirstItem:"Add songs or slides to build your schedule"},yG={placeholder:"Search schedules...",noResults:'No schedules found for "{{query}}"',resultsCount:"{{count}} schedules found"},xG={saved:"Schedule saved successfully",deleted:"Schedule deleted successfully",itemAdded:"Item added to schedule",itemRemoved:"Item removed from schedule",importedToQueue:"Schedule imported to queue",error:"An error occurred"},bG={deleteTitle:"Delete Schedule",deleteMessage:"Are you sure you want to delete this schedule? This action cannot be undone.",importTitle:"Import Schedule",unsavedChangesTitle:"Unsaved Changes",unsavedChangesMessage:"You have unsaved changes. Are you sure you want to leave?",discardChanges:"Lose changes",addSongTitle:"Add to Schedule",addSongDescription:"Select a schedule to add this song",adding:"Adding...",createTitle:"New Schedule",scheduleName:"Schedule name",create:"Create",cancel:"Cancel",createNew:"Create new schedule"},vG="No schedules yet",wG="Create your first schedule to plan your presentations",SG="{{count}} item",kG="{{count}} items",CG="Created {{date}}",NG={title:pG,actions:gG,editor:mG,search:yG,messages:xG,modal:bG,noSchedules:vG,noSchedulesDescription:wG,itemCount_one:SG,itemCount_other:kG,createdAt:CG},TG="Settings",jG=JSON.parse(`{"appearance":{"title":"Appearance"},"bible":{"title":"Bible Translations","description":"Select up to 3 translations to display. Drag to reorder.","addTranslation":"Add Translation","primary":"Primary","secondary":"Secondary","tertiary":"Tertiary","noTranslations":"No translations selected","noTranslationsDescription":"Add a Bible translation to get started","maxReached":"Maximum 3 translations","translationsSelected":"translations selected","modals":{"add":{"title":"Add Translation","selectLabel":"Select a translation","submit":"Add"}},"toast":{"saved":"Translations saved","removed":"Translation removed","added":"Translation added","error":"An error occurred"}},"application":{"title":"Application Settings","description":"Configure your Church Hub preferences here"},"language":{"title":"Language","description":"Select your preferred language","options":{"system":"System Default","english":"English","romanian":"Romanian"}},"theme":{"title":"Theme","description":"Choose your preferred color theme","options":{"system":"System Default","light":"Light","dark":"Dark"}},"shortcuts":{"title":"Keyboard Shortcuts","description":"Configure global keyboard shortcuts for quick actions. These shortcuts work from anywhere in the application.","actions":{"startLive":{"label":"Start Live Stream","description":"Start the YouTube live stream (only when ready)"},"stopLive":{"label":"Stop Live Stream","description":"Stop the current YouTube live stream"},"searchSong":{"label":"Search Songs","description":"Navigate to songs and focus the search input"},"searchBible":{"label":"Search Bible","description":"Navigate to Bible and focus the search input"}},"addShortcut":"Add Shortcut","noShortcuts":"No shortcuts configured","enabled":"Enabled","disabled":"Disabled","clickToRecord":"Click to record","recording":"Recording...","recordShortcut":"Press keys...","recordShortcutOrMidi":"Press key or MIDI button...","removeShortcut":"Remove","conflicts":{"global":"Already used by \\"{{action}}\\"","scene":"Already used by scene \\"{{scene}}\\""},"midi":{"title":"MIDI Controller","description":"Use hardware MIDI controllers for shortcuts with LED feedback","notSupported":"Web MIDI API is not supported in this browser. MIDI controller features are unavailable.","inputDevice":"Input Device","outputDevice":"Output Device (LEDs)","selectDevice":"Select device...","noInputDevices":"No MIDI input devices detected","noOutputDevices":"No MIDI output devices detected","refresh":"Refresh devices","requestPermission":"Grant MIDI Access","permissionError":"MIDI access denied: {{error}}","fullyConnected":"Input and output connected","inputOnly":"Input connected (no LED feedback)","outputOnly":"Output connected (no triggers)"}},"users":{"title":"Authorized Users","description":"Manage users that can access your Church Hub","addUser":"Add User","noUsers":"No users configured","noUsersDescription":"Add a user to allow external access to your Church Hub","userName":"User Name","userNamePlaceholder":"e.g., John's Tablet","permissions":"permissions","permissionsSelected":"permissions selected","status":"Status","active":"Active","inactive":"Inactive","lastUsed":"Last used","never":"Never","createdAt":"Created","roleTemplate":"Role Template","roles":{"admin":"Administrator","presenter":"Presenter","viewer":"Viewer","queue_manager":"Queue Manager"},"groups":{"songs":"Songs","control_room":"Control Room","programs":"Programs","queue":"Queue","settings":"Settings","displays":"Displays","users":"User Management"},"permissionLabels":{"songs.view":"View songs","songs.create":"Create songs","songs.edit":"Edit songs","songs.delete":"Delete songs","songs.add_to_queue":"Add songs to queue","songs.present_now":"Present songs immediately","control_room.view":"View control room","control_room.control":"Control presentation","programs.view":"View programs","programs.create":"Create programs","programs.edit":"Edit programs","programs.delete":"Delete programs","programs.import_to_queue":"Import programs to queue","queue.view":"View queue","queue.add":"Add items to queue","queue.remove":"Remove items from queue","queue.reorder":"Reorder queue items","queue.clear":"Clear queue","settings.view":"View settings","settings.edit":"Edit settings","displays.view":"View displays","displays.create":"Create displays","displays.edit":"Edit displays","displays.delete":"Delete displays","users.view":"View users","users.create":"Create users","users.edit":"Edit users","users.delete":"Delete users"},"actions":{"edit":"Edit","delete":"Delete","regenerateToken":"Regenerate Token","showQRCode":"Show QR Code","deactivate":"Deactivate","activate":"Activate","copyUrl":"Copy URL"},"modals":{"cancel":"Cancel","create":{"title":"Add New User","submit":"Create User"},"edit":{"title":"Edit User","submit":"Save Changes"},"delete":{"title":"Delete User","message":"Are you sure you want to delete \\"{{name}}\\"? This action cannot be undone.","confirm":"Delete"},"qrCode":{"title":"Scan QR Code","userName":"User","description":"Scan this QR code with the device you want to authorize","networkInterface":"Network Interface","warning":"This token will only be shown once. Save it if needed.","manualUrl":"Or visit this URL manually:","done":"Done"},"regenerate":{"title":"Regenerate Token","message":"This will invalidate the current token for \\"{{name}}\\". The user will need to be re-authenticated.","confirm":"Regenerate"}},"toast":{"created":"User created successfully","updated":"User updated successfully","deleted":"User deleted successfully","tokenRegenerated":"Token regenerated successfully","urlCopied":"URL copied to clipboard","error":"An error occurred"}},"categories":{"title":"Song Categories","description":"Manage song categories and their search priority. Higher position = higher priority in search results.","addCategory":"Add Category","noCategories":"No categories configured","noCategoriesDescription":"Add a category to organize your songs","categoryName":"Category Name","categoryNamePlaceholder":"e.g., Worship, Hymns, Christmas","priority":"Priority","value":"Value","actions":{"edit":"Edit","delete":"Delete"},"modals":{"create":{"title":"Add New Category","submit":"Create Category"},"edit":{"title":"Edit Category","submit":"Save Changes"},"delete":{"title":"Delete Category","message":"Are you sure you want to delete \\"{{name}}\\"? Songs in this category will become uncategorized.","confirm":"Delete"}},"toast":{"created":"Category created successfully","updated":"Category updated successfully","deleted":"Category deleted successfully","reordered":"Category order updated","error":"An error occurred"}},"synonyms":{"title":"Search Synonyms","description":"Define word synonyms to improve search results. When you search for one word, results with its synonyms will also appear.","addSynonym":"Add Synonym","noSynonyms":"No synonyms configured","noSynonymsDescription":"Add synonyms to find songs with alternative spellings","primaryTerm":"Primary Term","primaryTermPlaceholder":"e.g., cristos","synonymTerms":"Synonym Terms","synonymTermsPlaceholder":"e.g., hristos, christ","synonymTermsHint":"Separate multiple synonyms with commas","actions":{"edit":"Edit","delete":"Delete"},"modals":{"create":{"title":"Add New Synonym","submit":"Create Synonym"},"edit":{"title":"Edit Synonym","submit":"Save Changes"},"delete":{"title":"Delete Synonym","message":"Are you sure you want to delete the synonym group for \\"{{primary}}\\"?","confirm":"Delete"}},"toast":{"created":"Synonym created successfully","updated":"Synonym updated successfully","deleted":"Synonym deleted successfully","error":"An error occurred"}},"importExport":{"title":"Import & Export Songs","description":"Import songs from files or export your song library","import":{"title":"Import Songs","description":"Import songs from OpenSong XML, PPTX, or ZIP files","button":"Select Files","supportedFormats":"Supported: OpenSong XML, PPTX, PPT, ZIP","noSongsTitle":"No Songs Found","noSongsMessage":"No valid songs were found in the selected files."},"export":{"title":"Export Songs","description":"Export songs to OpenSong XML format in a ZIP archive","button":"Export Songs","allSongs":"All songs","byCategory":"By category","selectCategory":"Select a category","exporting":"Exporting...","fetching":"Exporting songs...","generating":"Generating XML files...","zipping":"Creating ZIP archive...","saving":"Saving file...","processingProgress":"Processing {{current}} of {{total}}"},"resurseCrestine":{"title":"Import from Resurse Crestine","description":"Download and import songs from Resurse Crestine website","button":"Import from Resurse Crestine","importing":"Importing...","note":"Songs will be imported to the 'Resurse Crestine' category with first verse as title"},"toast":{"importSuccess":"Successfully imported {{count}} songs","importFailed":"Import failed: {{error}}","exportSuccess":"Successfully exported {{count}} songs","exportFailed":"Export failed: {{error}}"}},"apiDocs":{"title":"API Documentation","description":"Access the REST API documentation for developers","link":"Open API Docs"},"systemToken":{"title":"System API Token","description":"Use this token to access the API with superuser privileges from external applications. This section is only visible on localhost.","token":"Token","showToken":"Show Token","loading":"Loading...","show":"Show token","hide":"Hide token","copy":"Copy to clipboard","regenerate":"Regenerate Token","regenerating":"Regenerating...","regenerateWarning":"Regenerating will invalidate the current token","createdAt":"Created","lastUsed":"Last used","never":"Never","toast":{"copied":"Token copied to clipboard","regenerated":"System token regenerated successfully","fetchError":"Failed to fetch system token","regenerateError":"Failed to regenerate system token"}},"sidebar":{"title":"Sidebar Configuration","description":"Customize sidebar menu items, their order, and add custom pages","builtIn":"Built-in","custom":"Custom Page","addCustomPage":"Add Custom Page","visible":"Visible","hidden":"Hidden","pageNotFound":"Page not found","openInNewTab":"Open in new tab","openInWindow":"Open in window","openInBrowser":"Open in browser","loadingPage":"Loading page...","loadError":"This page cannot be embedded","loadErrorDescription":"Some websites block embedding for security reasons. Open in a new tab instead.","nativeWindowTitle":"External page opened in native window","nativeWindowDescription":"This page has been opened in a separate window to ensure full functionality. Click the button above to reopen it if needed.","fields":{"title":"Title","titlePlaceholder":"e.g., Church Calendar","url":"URL","urlPlaceholder":"https://example.com/calendar","urlHint":"The URL will be embedded in an iframe","icon":"Icon","selectIcon":"Select an icon for the sidebar","useIframeEmbedding":"Use iframe embedding","useIframeEmbeddingHint":"Embed using an iframe instead of native webview. Recommended for sites like YouTube that support iframe embedding."},"validation":{"titleRequired":"Title is required","urlRequired":"URL is required","urlInvalid":"Please enter a valid URL"},"modals":{"create":{"title":"Add Custom Page","submit":"Add Page"},"edit":{"title":"Edit Custom Page","submit":"Save Changes"},"delete":{"title":"Delete Custom Page","message":"Are you sure you want to delete \\"{{name}}\\"?","confirm":"Delete"}},"toast":{"saved":"Sidebar configuration saved","customPageCreated":"Custom page added","customPageUpdated":"Custom page updated","customPageDeleted":"Custom page deleted","error":"An error occurred"}},"apiUrl":{"title":"Server Connection","label":"Server URL","hint":"Enter the auth URL from your Church Hub (e.g., http://192.168.1.100:3000/api/auth/user/usr_TOKEN)","settingsDescription":"Configure the server your mobile app connects to","testConnection":"Test Connection","testing":"Testing...","retry":"Retry","save":"Save & Continue","saved":"Server URL saved successfully","connectionSuccess":"Connection successful","authTokenDetected":"Authentication token detected","setup":{"title":"Connect to Server","description":"Scan the QR code or paste the authentication URL from your Church Hub"},"errors":{"emptyUrl":"Please enter a server URL","invalidUrl":"Please enter a valid URL (e.g., http://192.168.1.100:3000/api/auth/user/usr_TOKEN)","connectionFailed":"Could not connect to the server. Please check the URL and try again.","testFirst":"Please test the connection before saving"}},"database":{"title":"Database Management","description":"Manage your SQLite database backup and location","path":"Database Path","copyPath":"Copy path","openFolder":"Open in File Explorer","size":"Size","export":{"title":"Export Database","description":"Create a backup copy of your database","button":"Export Database","exporting":"Exporting..."},"import":{"title":"Import Database","description":"Restore from a backup file","button":"Import Database","importing":"Importing...","confirm":{"title":"Import Database","message":"This will replace your current database with the selected file. A backup of your current database will be created. The application will need to be restarted after import.","warning":"This action cannot be undone.","confirm":"Import","cancel":"Cancel"}},"toast":{"pathCopied":"Database path copied to clipboard","exportSuccess":"Database exported successfully to {{path}}","exportFailed":"Failed to export database: {{error}}","openFolderFailed":"Failed to open file explorer","importSuccess":"Database imported successfully. Please restart the application.","importFailed":"Failed to import database: {{error}}"}}}`),EG={title:TG,sections:jG},MG={home:"Home",dashboard:"Dashboard",schedules:"Schedules",songs:"Songs",bible:"Bible",present:"Control Room",livestream:"Live Stream",settings:"Settings"},AG={collapse:"Collapse",expand:"Expand sidebar",collapseSidebar:"Collapse sidebar",openMenu:"Open menu",closeMenu:"Close menu"},RG={navigation:MG,actions:AG},_G="Songs",OG={create:"New Song",save:"Save",delete:"Delete",back:"Back to Songs",import:"Import",importFromText:"Import from Text",addSlide:"Add Slide",cloneSlide:"Clone Slide",addToSchedule:"Add to Schedule"},IG={titlePlaceholder:"Enter song title...",categoryPlaceholder:"Select category...",slides:"Slides",slideNumber:"Slide {{number}}",emptySlide:"Empty slide - click to edit",noSlides:"No slides yet",saveFirst:"Save the song to add slides",undo:"Undo",redo:"Redo"},DG={placeholder:"Search songs...",noResults:'No songs found for "{{query}}"',resultsCount:"{{count}} songs found",showingCount:"Showing {{showing}} of {{total}} songs",moreResults:"{{count}} more songs not shown. Use search to find specific songs."},LG={none:"No Category",create:"Create",name:"Category"},zG={saving:"Saving song...",saved:"Song saved successfully",deleted:"Song deleted successfully",error:"An error occurred",slideSaved:"Slide saved",slideDeleted:"Slide deleted",slideCloned:"Slide cloned",reorderFailed:"Failed to reorder slides",categoryCreated:"Category created"},PG={deleteTitle:"Delete Song",deleteMessage:"Are you sure you want to delete this song? This action cannot be undone.",deleteSlideTitle:"Delete Slide",deleteSlideMessage:"Are you sure you want to delete this slide?",unsavedChangesTitle:"Unsaved Changes",unsavedChangesMessage:"You have unsaved changes. Are you sure you want to leave this page?",unsavedBeforeActionMessage:"You have unsaved changes. What would you like to do?",discardChanges:"Lose changes",saveAndContinue:"Save and continue",continueWithoutSaving:"Continue without saving",cancel:"Cancel"},BG="No songs yet",FG="Create your first song to get started",UG={title:"Import PowerPoint",description:"Found {{count}} slides. Import as a new song?",songTitle:"Song Title",createSong:"Create Song",dropHint:"Drop PPTX file to import as song",slideNumber:"Slide {{number}}"},$G={title:"Import Songs",description:"Ready to import {{count}} song(s)",categoryLabel:"Category (optional)",songsList:"Songs to import:",confirmButton:"Import {{count}} Song(s)",importing:"Importing...",noSongsFound:"No song files found",noSongsFoundDescription:"The selected files could not be parsed as songs. Please make sure you're importing valid song files (OpenSong XML or PowerPoint files).",successMessage:"Successfully imported {{count}} song(s)",processing:"Processing files...",processingProgress:"Processing: {{current}} of {{total}} files",downloading:"Downloading...",extracting:"Extracting archive...",converting:"Converting PPT files...",convertingProgress:"Converting: {{current}} of {{total}} PPT files",parsing:"Parsing songs...",saving:"Saving to database...",useFirstVerseAsTitle:"Use first verse as title",overwriteDuplicates:"Overwrite existing songs with same title",skipManuallyEdited:"Skip songs that were manually edited",libreOfficeNotInstalled:"LibreOffice is required to import .ppt files",libreOfficeNotInstalledDescription:"Please install LibreOffice from https://www.libreoffice.org to enable .ppt file import. Alternatively, convert your files to .pptx format first."},qG={title:"Songs Settings"},HG={backToSongs:"Back",edit:"Edit",slides:"Slides",noSlides:"No slides",slideNumber:"Slide {{number}}"},VG={detailsSection:"Details",author:"Author",copyright:"Copyright",ccli:"CCLI Number",hymnNumber:"Hymn Number",key:"Musical Key",keyPlaceholder:"C Major",tempo:"Tempo",timeSignature:"Time Signature",theme:"Theme",altTheme:"Alternative Theme",keyLine:"Key Line",keyLinePlaceholder:"Enter a memorable line from the song...",presentationOrder:"Presentation Order",sourceFilename:"Source File",presentationCount:"Times Presented",lastManualEdit:"Last Manual Edit",neverEdited:"Never edited"},KG={title:_G,actions:OG,editor:IG,search:DG,import:{title:"Import from Text",description:"Paste your song text below. Each paragraph will become a separate slide.",placeholder:"Paste song lyrics here...",preview:"Preview: {{count}} slides",confirm:"Import",cancel:"Cancel"},category:LG,messages:zG,modal:PG,noSongs:BG,noSongsDescription:FG,pptxImport:UG,batchImport:$G,settings:qG,preview:HG,metadata:VG},QG="Biblie",WG={placeholder:'Cauta versete (ex: "Gen 1:1" sau "La inceput")',hint:'Scrie o referinta precum "Gen 1:1" sau cauta un text',noResults:"Niciun rezultat gasit",searching:"Se cauta...",directReference:"Referinta directa",resultsCount:"{{count}} verset gasit",resultsCount_other:"{{count}} versete gasite"},YG={back:"Inapoi",oldTestament:"Vechiul Testament",newTestament:"Noul Testament",noBooks:"Nicio carte disponibila"},GG={title:"Lista versete",empty:"Niciun verset in lista",removed:"Versetul a fost eliminat din lista",remove:"Elimina"},XG={title:"Previzualizare",prev:"Ant.",next:"Urm.",prevVerse:"Versetul anterior",nextVerse:"Versetul urmator",show:"Afiseaza",hide:"Ascunde"},JG={title:"Scurtaturi tastatura",navigate:"Navigheaza versete",back:"Inapoi",hide:"Ascunde afisajul",present:"Prezinta versetul"},ZG={presentNow:"Prezinta acum",addToQueue:"Adauga in lista",import:"Importa",importFirst:"Importa traducere Biblie",settings:"Setari",openSettings:"Deschide Setari"},eX={title:"Nicio traducere disponibila",description:"Importa o traducere a Bibliei in format USFX XML pentru a incepe.",noTranslationsSelected:"Nicio traducere selectata",noTranslationsSelectedDescription:"Mergi la Setari > Traduceri Biblice pentru a selecta traducerile dorite."},tX={title:"Setari Biblie",import:{title:"Importa Traducere",description:"Importa o traducere a Bibliei dintr-un fisier USFX XML.",button:"Selecteaza Fisier",formatTitle:"Format Necesar: USFX XML",formatDescription:"Traducerea Bibliei trebuie sa fie in format USFX (Unified Standard Format XML). Acesta este un format standardizat folosit pentru codificarea Scripturii.",structureTitle:"Exemplu Structura Fisier:",hints:{rootElement:"Elementul radacina trebuie sa fie <usfx>",bookElement:'Fiecare carte foloseste <book id="XXX"> cu abrevieri standard (GEN, EXO, etc.)',chapterElement:'Capitolele folosesc <c id="N"> unde N este numarul capitolului',verseElement:'Versetele folosesc <v id="N">text</v> unde N este numarul versetului'}}},nX={select:"Selecteaza traducerea",loading:"Se incarca traducerile..."},rX={title:QG,search:WG,navigation:YG,queue:GG,controls:XG,shortcuts:JG,actions:ZG,empty:eX,import:{title:"Importa traducere Biblie",error:"Importul traducerii a esuat",errorTitle:"Eroare la import",success:"Traducerea a fost importata cu succes"},settings:tX,translation:nX},sX={goBack:"napoi",startOver:"ncepe din nou",cancel:"Anuleaz",confirm:"Confirm",delete:"terge",save:"Salveaz",ok:"OK"},iX={pageNotFound:"Pagina pe care o cutai nu exist.",noPermission:"Nu avei permisiunea de a accesa aceast pagin.",noPermissionTitle:"Acces interzis",contactAdmin:"V rugm s contactai administratorul dac credei c aceasta este o eroare."},aX={system:"Sistem",lightMode:"Mod luminos",darkMode:"Mod ntunecat",toggleTheme:"Schimb tema"},oX={buttons:sX,errors:iX,theme:aX},lX="Live Stream",cX={notConnected:"YouTube neconectat",connected:"Conectat ca {{channelName}}",login:"Conecteaza-te cu YouTube",logout:"Deconecteaza YouTube",authenticating:"Se autentifica...",loggingOut:"Se deconecteaza...",clickToConnect:"Click pentru a te conecta la YouTube",clickToDisconnect:"Click pentru a te deconecta de la YouTube",openGuide:"Ghid de configurare",settings:"Setari YouTube",titleTemplate:"Sablon titlu",description:"Descriere",privacyStatus:"Confidentialitate",privacyPublic:"Public",privacyUnlisted:"Nelistat",privacyPrivate:"Privat",streamKey:"Cheie Stream",selectStreamKey:"Selecteaza cheia stream",playlist:"ID Playlist",startScene:"Scena de start",setup:{title:"Configurare YouTube Live",templateTitle:"Foloseste setari din transmisii anterioare",templateDescription:"Selecteaza setari dintr-o transmisie anterioara:",noTemplates:"Nicio transmisie anterioara gasita",noTemplatesHint:"Creeaza o transmisie live in YouTube Studio. Dupa ce transmisia se incheie, va aparea aici.",completedAt:"Finalizat",usingTemplate:"Foloseste setarile transmisiei",usingTemplateHint:"Aceste setari vor fi aplicate urmatoarei tale transmisii.",firstTimeTitle:"Prima transmisie?",firstTimeDescription:"Creeaza o transmisie live direct in YouTube Studio. Configureaza setarile, porneste live-ul din OBS, iar transmisia va fi salvata aici pentru utilizare viitoare.",openYouTubeStudio:"Deschide YouTube Studio",close:"Inchide"}},uX={connected:"OBS Conectat",disconnected:"OBS Deconectat",connecting:"Se conecteaza...",connect:"Conecteaza la OBS",disconnect:"Deconecteaza",disconnecting:"Se deconecteaza...",clickToConnect:"Click pentru a te conecta la OBS",clickToDisconnect:"Click pentru a te deconecta de la OBS",openGuide:"Ghid de configurare",settings:"Setari OBS",host:"Host",port:"Port",password:"Parola",autoConnect:"Auto-conectare la pornire",setup:{title:"Configurare OBS WebSocket",helpLink:"Ai nevoie de ajutor pentru conectare?",step1Title:"Pasul 1: Instaleaza OBS WebSocket",step1Description:"OBS WebSocket este necesar pentru ca Church Hub sa controleze OBS Studio. Pentru OBS 28+, este inclus. Pentru versiuni mai vechi, descarca si instaleaza:",downloadLink:"Descarca OBS WebSocket de pe GitHub",step2Title:"Pasul 2: Activeaza Serverul WebSocket",step2Instruction1:"Deschide OBS Studio",step2Instruction2:"Mergi la Tools  WebSocket Server Settings",step2Instruction3:'Bifeaza "Enable WebSocket server" si seteaza parola de mai jos',step3Title:"Pasul 3: Configureaza Parola",step3Description:"Copiaza aceasta parola si paste-o in OBS WebSocket Server Settings:",copy:"Copiaza",copied:"Copiat!",noteTitle:"Nota:",noteDescription:"Asigura-te ca folosesti aceeasi parola in OBS. Church Hub va folosi automat aceasta parola la conectare.",saveAndClose:"Salveaza si Inchide"}},dX={startStream:"Porneste live-ul",stopStream:"Opreste Stream",isLive:"LIVE",notStreaming:"Nu transmite",starting:"Se porneste...",stopping:"Se opreste...",progress:{creating_broadcast:"Se creeaza transmisia",waiting_for_ready:"Se asteapta YouTube",delay_before_stream:"Se pregateste stream-ul",starting_obs:"Se porneste OBS",completed:"Stream pornit",error:"Eroare la pornirea stream-ului"}},fX={currentBroadcast:"Transmisie curenta",noBroadcast:"Nicio transmisie activa",loading:"Se incarca informatiile transmisiei...",copyMessage:"Copiaza mesaj",messageCopied:"Mesaj copiat",copyToClipboard:"Copiaza in clipboard",copied:"Copiat!",openInYouTube:"Deschide in YouTube",watchLive:"Vizualizare Live",openStudio:"YouTube Studio"},hX={title:"Scene",settings:"Setari scene",sceneSettings:"Setari scena",displayName:"Nume afisat",visible:"Vizibila",hidden:"Ascunsa",current:"Curenta",shortcuts:"Scurtaturi de tastatura",addShortcut:"Adauga scurtatura",removeShortcut:"Sterge",recordShortcut:"Apasa taste...",clickToRecord:"Click pentru a inregistra",recording:"Se inregistreaza...",noShortcuts:"Nicio scurtatura atribuita",shortcutConflict:'Deja folosita de "{{scene}}"',streamSceneSettings:"Setari scena stream",useAsStartScene:"Foloseste ca scena de start",useAsStartSceneDescription:"Aceasta scena va fi activata inainte de inceperea stream-ului",useAsStopScene:"Foloseste ca scena de stop",useAsStopSceneDescription:"Aceasta scena va fi activata dupa oprirea stream-ului",autoSceneSettings:"Setari auto-switch",autoSceneDescription:"Schimba la aceasta scena cand afisezi:",contentTypes:{song:"Cantari",bible:"Verset biblic",biblePassage:"Pasaj biblic",announcement:"Anunturi",verseteTineri:"Versete Tineri",empty:"Gol / Ceas"},mixerActions:"Actiuni Mixer",mixerActionsDescription:"Configureaza canalele mixerului cand aceasta scena se activeaza:",unmute:"Porneste",mute:"Opreste",selectChannels:"Selecteaza canale...",selectContentTypes:"Selecteaza tipuri de continut...",addMore:"Adauga..."},pX={title:"Mixer",connected:"Mixer Conectat",disconnected:"Mixer Deconectat",reconnecting:"Se reconecteaza...",testing:"Se testeaza...",enable:"Activeaza Mixer",disable:"Dezactiveaza Mixer",settings:"Setari Mixer",setup:{title:"Configurare Mixer",connectionSettings:"Setari Conexiune",host:"Adresa IP",port:"Port",enableControl:"Activeaza controlul mixerului",channelConfiguration:"Configurare Canale",channelCount:"Numar de canale",channelPlaceholder:"Eticheta canal",testConnection:"Testeaza conexiunea",testing:"Se testeaza...",testSuccess:"Conexiune reusita!",testFailed:"Conexiune esuata",save:"Salveaza"}},gX={obsConnectionFailed:"Conectarea la OBS a esuat",obsNotRunning:"Nu se poate conecta la OBS. Asigura-te ca OBS ruleaza si serverul WebSocket este activat (Tools  WebSocket Server Settings).",obsAuthFailed:"Autentificarea OBS a esuat. Verifica parola WebSocket din setarile OBS.",obsTimeout:"Conexiunea la OBS a expirat. Verifica daca host-ul si portul sunt corecte.",youtubeAuthFailed:"Autentificarea YouTube a esuat",youtubeSessionExpired:"Sesiunea YouTube a expirat. Te rugam sa te reconectezi.",youtubeReauthRequired:"YouTube necesita autentificare din nou",broadcastFailed:"Crearea transmisiei a esuat",sceneSwitchFailed:"Schimbarea scenei a esuat",startStreamFailed:"Pornirea stream-ului a esuat",stopStreamFailed:"Oprirea stream-ului a esuat"},mX={title:lX,youtube:cX,obs:uX,stream:dX,broadcast:fX,scenes:hX,mixer:pX,errors:gX},yX={title:"Ecrane",description:"Configurai ecrane pentru diferite scopuri de afiare. Fiecare tip de ecran are propriile opiuni de configurare.",addScreen:"Adaug Ecran",addFirstScreen:"Adaug Primul Ecran",noScreens:"Niciun ecran configurat",noScreensDescription:"Adaug primul tu ecran pentru a configura cum este afiat coninutul.",screenName:"Nume Ecran",screenNamePlaceholder:"ex: Proiector Principal",screenType:"Tip Ecran",screenTypes:{primary:"Principal / Audien",stage:"Monitor Scen",livestream:"Transmisie Live"},createAndConfigure:"Creeaz i Configureaz",deleteConfirmTitle:"terge Ecranul?",deleteConfirmMessage:'Eti sigur c vrei s tergi "{{name}}"? Aceast aciune nu poate fi anulat.',editor:{preview:"Previzualizare",zoom:"Zoom",resetZoom:"Reseteaz Zoom",save:"Salveaz",unsavedChanges:"Modificri nesalvate",previewText:"Text Previzualizare",previewTextDescription:"Personalizai textul de previzualizare pentru a testa cum arat stilul cu coninut diferit.",customPreviewText:"Text Personalizat",previewTextPlaceholder:"Introducei text personalizat (multiline suportat)...",resetPreviewText:"Reseteaz la Implicit"},contentTypes:{song:"Cntec",bible:"Verset Biblic",bible_passage:"Pasaj Biblic",announcement:"Anun",versete_tineri:"Versete Tineri",empty:"Gol / Ceas"},panels:{position:"Poziie i Dimensiune",textStyle:"Stil Text",animation:"Animaie",background:"Fundal",general:"Setri Generale",nextSlide:"Seciune Slide Urmtor",visibility:"Vizibilitate"},visibility:{hideElement:"Ascunde elementul"},position:{x:"Poziie X",y:"Poziie Y",width:"Lime",height:"nlime",unit:"Unitate",pixels:"Pixeli",percent:"Procent",constraints:"Constrngeri",element:"Element",top:"Sus",bottom:"Jos",left:"Stnga",right:"Dreapta",stretchHorizontal:"Limea se ntinde ntre constrngerile stnga i dreapta",stretchVertical:"nlimea se ntinde ntre constrngerile sus i jos"},textStyle:{fontFamily:"Familie Font",maxFontSize:"Dimensiune Max Font",autoScale:"Scalare Automat",autoScaleDescription:"Scaleaz automat textul pentru a ncpea n container. Cnd este dezactivat, folosete o dimensiune fix.",fontSize:"Dimensiune Font",color:"Culoare",bold:"Bold",italic:"Italic",underline:"Subliniat",horizontalAlignment:"Aliniere Orizontal",verticalAlignment:"Aliniere Vertical",left:"Stnga",center:"Centru",right:"Dreapta",top:"Sus",middle:"Mijloc",bottom:"Jos",lineHeight:"nlime Linie",shadow:"Umbr Text",compressLines:"Comprim Liniile",lineSeparator:"Separator Linii",separators:{space:"Spaiu Dublu",dash:"Liniu Em ()",pipe:"Bar Vertical (|)"},fitLineToWidth:"Potrivete Fiecare Linie la Lime",fitLineToWidthDescription:"Previne ntreruperea liniilor - fiecare linie se scaleaz pentru a ncpea"},animation:{animationIn:"Animaie Intrare",animationOut:"Animaie Ieire",type:"Tip",duration:"Durat",delay:"ntrziere",easing:"Easing",types:{none:"Niciunul",fade:"Fade",slideUp:"Alunecare Sus",slideDown:"Alunecare Jos",slideLeft:"Alunecare Stnga",slideRight:"Alunecare Dreapta",scale:"Scalare",blur:"Blur"},easings:{linear:"Liniar",easeIn:"Ease In",easeOut:"Ease Out",easeInOut:"Ease In Out",bounce:"Bounce"}},background:{type:"Tip",types:{transparent:"Transparent",color:"Culoare Solid",image:"Imagine",video:"Video"},color:"Culoare",imageUrl:"URL Imagine",videoUrl:"URL Video",opacity:"Opacitate"},general:{screenSize:"Dimensiune Ecran",width:"Lime",height:"nlime",clockEnabled:"Afieaz Ceas",defaultBackground:"Fundal Implicit"},nextSlide:{enabled:"Afieaz Seciunea Slide Urmtor",labelText:"Text Etichet",labelStyle:"Stil Etichet",contentStyle:"Stil Coninut"},bibleOptions:{title:"Opiuni Biblie",includeReferenceInContent:"Include referina n coninut",includeReferenceInContentDescription:"Adaug referina biblic la nceputul versetului i ascunde elementul separat de referin"},nativeWindow:"Fereastr nativ",messages:{screenCreated:"Ecran creat cu succes",screenCreateFailed:"Eroare la crearea ecranului",screenSaved:"Ecran salvat cu succes",screenSaveFailed:"Eroare la salvarea ecranului",screenDeleted:"Ecran ters cu succes",screenDeleteFailed:"Eroare la tergerea ecranului"},renderer:{loading:"Se ncarc configuraia ecranului...",error:"Eroare la ncrcarea ecranului",notFound:"Ecranul nu a fost gsit"}},xX={title:"Ecrane",description:"Configurai ecranele de ieire pentru prezentrile dumneavoastr. Fiecare ecran poate avea propria tem i setri.",add:"Adaug Ecran",addFirst:"Adaug Primul Ecran",edit:"Editeaz Ecran",empty:"Niciun Ecran",emptyDescription:"Creai ecrane pentru a proiecta prezentrile pe diferite monitoare sau ferestre.",name:"Nume Ecran",namePlaceholder:"ex: Ecran Principal, Monitor Scen",activeLabel:"Ecranul este activ",active:"Activ",inactive:"Inactiv",activate:"Activeaz",deactivate:"Dezactiveaz",editTheme:"Editeaz Tema",openWindow:"Deschide Fereastra Ecran",deleteConfirmTitle:"tergei Ecranul?",deleteConfirmMessage:'Suntei sigur c dorii s tergei "{{name}}"? Aceast aciune nu poate fi anulat.',openMode:"Mod Deschidere",openModes:{browser:"Browser",native:"Fereastr Nativ"},fullscreenLabel:"Deschide n ecran complet implicit"},bX={title:"Tema Ecranului",backgroundType:"Tip Fundal",backgrounds:{transparent:"Transparent",color:"Culoare Solid",image:"Imagine"},backgroundColor:"Culoare Fundal",backgroundImage:"URL Imagine",textColor:"Culoare Text",fontFamily:"Familie Font",padding:"Spaiere",preview:"Previzualizare",sampleText:"Text Exemplu"},vX={save:"Salveaz",cancel:"Anuleaz",delete:"terge",close:"nchide"},wX={displaySaved:"Ecran salvat cu succes",displaySaveFailed:"Eroare la salvarea ecranului",displayDeleted:"Ecran ters",displayDeleteFailed:"Eroare la tergerea ecranului",displayActivated:"Ecran activat",displayDeactivated:"Ecran dezactivat",displayToggleFailed:"Eroare la schimbarea strii ecranului",themeSaved:"Tema salvat cu succes",themeSaveFailed:"Eroare la salvarea temei"},SX={start:"Pornete",stop:"Oprete",prev:"Anterior",next:"Urmtor",clear:"Golete Slide",show:"Afieaz",hide:"Ascunde",screenHidden:"Ecranul este ascuns",screenDisplayed:"Ecranul este afiat"},kX={title:"Camer de Control",selectProgram:"Selecteaz un program",presenting:"n prezentare",notPresenting:"Nu prezint",connected:"Conectat",connecting:"Se conecteaz...",disconnected:"Deconectat",openDisplay:"Deschide Ecran",slides:"Slide-uri",noSlides:"Niciun slide n acest program",preview:"Previzualizare"},CX={screens:yX,displays:xX,theme:bX,actions:vX,messages:wX,controls:SX,controlRoom:kX},NX="Coad",TX="Coada este goal",jX="Adaug cntri pentru a ncepe prezentarea",EX="{{count}} cntare",MX="{{count}} cntri",AX="{{count}} cntri",RX="{{count}} element",_X="{{count}} elemente",OX="{{count}} elemente",IX={addToQueue:"Adaug n coad",presentNow:"Prezint acum",remove:"terge",clear:"Golete coada",expand:"Extinde",collapse:"Restrnge",editSong:"Editeaz",editSlide:"Editeaz slide-ul",insertSlide:"Insereaz slide dup",insertAfter:"Insereaz dup",moreOptions:"Mai multe opiuni",cancel:"Anuleaz",addToSchedule:"Adaug n program",saveAsProgram:"Salveaz ca program"},DX={button:"Adaug",title:"Adaug n coad",searchSong:"Caut cntare",searchSongDescription:"Gsete i adaug o cntare existent",bibleVerse:"Verset Biblic",bibleVerseDescription:"Caut i adaug un verset din Biblie",biblePassage:"Pasaj Biblic",biblePassageDescription:"Adaug un interval de versete",announcement:"Anun",announcementDescription:"Creeaz un slide de anun personalizat",verseteTineri:"Versete Tineri",verseteTineriDescription:"Adaug un slide cu versete pentru tineri",importSchedule:"Import Program",importScheduleDescription:"Adaug toate elementele dintr-un program salvat"},LX={added:"Adugat n coad",removed:"ters din coad",cleared:"Coada a fost golit",presenting:"Se prezint acum",error:"A aprut o eroare",slideInserted:"Slide-ul a fost inserat",slideUpdated:"Slide-ul a fost actualizat",savedAsProgram:"Coada a fost salvat ca program",biblePassageInserted:"Pasajul biblic a fost adugat n coad",verseteTineriInserted:"Versetele tineri au fost adugate n coad"},zX={title:"Salveaz coada ca program",nameLabel:"Nume program",namePlaceholder:"Introdu numele programului",save:"Salveaz",cancel:"Anuleaz"},PX={title:"Goleti coada?",message:"Aceasta va terge toate elementele din coad."},BX={announcement:"Anun",versete_tineri:"Versete tineri"},FX={title:"Insereaz slide",editTitle:"Editeaz slide-ul",selectTemplate:"Selecteaz ablonul",content:"Coninut",insert:"Insereaz",save:"Salveaz",errorEmpty:"Te rugm s adaugi coninut slide-ului"},UX={title:"Import Program",description:"Adaug toate elementele dintr-un program salvat n coad"},$X={title:"Adaug Pasaj Biblic",translation:"Traducere",reference:"Referin",referencePlaceholder:"ex: Gen 1:1-5 sau Ioan 3:16",referenceHint:"Introdu cartea, capitolul i intervalul de versete",valid:"Valid",add:"Adaug n coad",passage:"Pasaj Biblic",errors:{empty:"Te rugm s introduci o referin",invalid_format:"Format invalid. ncearc: Gen 1:1 sau Gen 1:1-5",book_not_found:"Cartea nu a fost gsit",invalid_chapter:"Numr de capitol invalid",end_before_start:"Sfritul trebuie s fie dup nceput"}},qX={title:"Versete Tineri",addEntry:"Adaug intrare",personName:"Nume persoan",personNamePlaceholder:"Introdu numele...",bibleReference:"Referin biblic",bibleReferencePlaceholder:"ex: Ioan 3:16",entriesCount_one:"{{count}} intrare",entriesCount_few:"{{count}} intrri",entriesCount_other:"{{count}} intrri",removeEntry:"terge intrare",noEntries:"Nu exist intrri",addFirstEntry:"Adaug o intrare pentru a ncepe"},HX={title:NX,empty:TX,emptyDescription:jX,songCount_one:EX,songCount_few:MX,songCount_other:AX,itemCount_one:RX,itemCount_few:_X,itemCount_other:OX,actions:IX,addToQueue:DX,messages:LX,saveAsProgram:zX,confirmClear:PX,slideTemplates:BX,insertSlide:FX,importSchedule:UX,biblePassage:$X,verseteTineri:qX},VX="Programe",KX={create:"Program Nou",save:"Salveaza",delete:"Sterge",back:"Inapoi la Programe",addItem:"Adauga",importToQueue:"Adauga in Coada"},QX={titlePlaceholder:"Introdu titlul programului...",descriptionPlaceholder:"Adauga o descriere (optional)...",items:"Elemente",noItems:"Niciun element inca",addFirstItem:"Adauga cantari sau slide-uri pentru a construi programul"},WX={placeholder:"Cauta programe...",noResults:'Nu s-au gasit programe pentru "{{query}}"',resultsCount:"{{count}} programe gasite"},YX={saved:"Programul a fost salvat cu succes",deleted:"Programul a fost sters cu succes",itemAdded:"Element adaugat la program",itemRemoved:"Element eliminat din program",importedToQueue:"Programul a fost importat in coada",error:"A aparut o eroare"},GX={deleteTitle:"Sterge Programul",deleteMessage:"Esti sigur ca vrei sa stergi acest program? Aceasta actiune nu poate fi anulata.",importTitle:"Importa Program",unsavedChangesTitle:"Modificari Nesalvate",unsavedChangesMessage:"Ai modificari nesalvate. Esti sigur ca vrei sa parasesti aceasta pagina?",discardChanges:"Pierde modificarile",addSongTitle:"Adauga in Program",addSongDescription:"Selecteaza un program pentru a adauga aceasta cantare",adding:"Se adauga...",createTitle:"Program Nou",scheduleName:"Numele programului",create:"Creeaza",cancel:"Anuleaza",createNew:"Creeaza program nou"},XX="Niciun program inca",JX="Creeaza primul tau program pentru a planifica prezentarile",ZX="{{count}} element",eJ="{{count}} elemente",tJ="Creat pe {{date}}",nJ={title:VX,actions:KX,editor:QX,search:WX,messages:YX,modal:GX,noSchedules:XX,noSchedulesDescription:JX,itemCount_one:ZX,itemCount_other:eJ,createdAt:tJ},rJ="Setri",sJ=JSON.parse(`{"appearance":{"title":"Aspect"},"bible":{"title":"Traduceri Biblice","description":"Selecteaz pn la 3 traduceri pentru afiare. Trage pentru a reordona.","addTranslation":"Adaug Traducere","primary":"Principal","secondary":"Secundar","tertiary":"Teriar","noTranslations":"Nicio traducere selectat","noTranslationsDescription":"Adaug o traducere biblic pentru a ncepe","maxReached":"Maximum 3 traduceri","translationsSelected":"traduceri selectate","modals":{"add":{"title":"Adaug Traducere","selectLabel":"Selecteaz o traducere","submit":"Adaug"}},"toast":{"saved":"Traduceri salvate","removed":"Traducere eliminat","added":"Traducere adugat","error":"A aprut o eroare"}},"application":{"title":"Setri aplicaie","description":"Configureaz preferinele tale pentru Church Hub"},"language":{"title":"Limb","description":"Selecteaz limba preferat","options":{"system":"Implicit din sistem","english":"Englez","romanian":"Romn"}},"theme":{"title":"Tem","description":"Alege tema de culoare preferat","options":{"system":"Implicit din sistem","light":"Luminos","dark":"ntunecat"}},"shortcuts":{"title":"Scurtturi de Tastatur","description":"Configureaz scurtturi globale de tastatur pentru aciuni rapide. Aceste scurtturi funcioneaz de oriunde n aplicaie.","actions":{"startLive":{"label":"Pornete Transmisiunea","description":"Pornete transmisiunea YouTube (doar cnd este pregtit)"},"stopLive":{"label":"Oprete Transmisiunea","description":"Oprete transmisiunea YouTube curent"},"searchSong":{"label":"Caut Cntri","description":"Navigheaz la cntri i focuseaz cmpul de cutare"},"searchBible":{"label":"Caut n Biblie","description":"Navigheaz la Biblie i focuseaz cmpul de cutare"}},"addShortcut":"Adaug Scurttur","noShortcuts":"Nicio scurttur configurat","enabled":"Activat","disabled":"Dezactivat","clickToRecord":"Click pentru nregistrare","recording":"nregistrare...","recordShortcut":"Apas tastele...","recordShortcutOrMidi":"Apas tast sau buton MIDI...","removeShortcut":"terge","conflicts":{"global":"Folosit deja de \\"{{action}}\\"","scene":"Folosit deja de scena \\"{{scene}}\\""},"midi":{"title":"Controller MIDI","description":"Folosete controllere MIDI hardware pentru scurtturi cu feedback LED","notSupported":"API-ul Web MIDI nu este suportat n acest browser. Funciile controller MIDI nu sunt disponibile.","inputDevice":"Dispozitiv Intrare","outputDevice":"Dispozitiv Ieire (LED-uri)","selectDevice":"Selecteaz dispozitiv...","noInputDevices":"Niciun dispozitiv MIDI de intrare detectat","noOutputDevices":"Niciun dispozitiv MIDI de ieire detectat","refresh":"Remprospteaz dispozitive","requestPermission":"Acord Acces MIDI","permissionError":"Acces MIDI refuzat: {{error}}","fullyConnected":"Intrare i ieire conectate","inputOnly":"Intrare conectat (fr feedback LED)","outputOnly":"Ieire conectat (fr declanatoare)"}},"users":{"title":"Utilizatori autorizai","description":"Administreaz utilizatorii care pot accesa Church Hub","addUser":"Adaug utilizator","noUsers":"Niciun utilizator configurat","noUsersDescription":"Adaug un utilizator pentru a permite acces extern la Church Hub","userName":"Nume utilizator","userNamePlaceholder":"ex., Tableta lui Ion","permissions":"permisiuni","permissionsSelected":"permisiuni selectate","status":"Stare","active":"Activ","inactive":"Inactiv","lastUsed":"Ultima utilizare","never":"Niciodat","createdAt":"Creat la","roleTemplate":"ablon rol","roles":{"admin":"Administrator","presenter":"Prezentator","viewer":"Vizualizator","queue_manager":"Manager coad"},"groups":{"songs":"Cntri","control_room":"Camer de control","programs":"Programe","queue":"Coad","settings":"Setri","displays":"Afiaje","users":"Administrare utilizatori"},"permissionLabels":{"songs.view":"Vizualizare cntri","songs.create":"Creare cntri","songs.edit":"Editare cntri","songs.delete":"tergere cntri","songs.add_to_queue":"Adugare cntri n coad","songs.present_now":"Prezentare cntri imediat","control_room.view":"Vizualizare camer de control","control_room.control":"Control prezentare","programs.view":"Vizualizare programe","programs.create":"Creare programe","programs.edit":"Editare programe","programs.delete":"tergere programe","programs.import_to_queue":"Import programe n coad","queue.view":"Vizualizare coad","queue.add":"Adugare n coad","queue.remove":"Eliminare din coad","queue.reorder":"Reordonare coad","queue.clear":"Golire coad","settings.view":"Vizualizare setri","settings.edit":"Editare setri","displays.view":"Vizualizare afiaje","displays.create":"Creare afiaje","displays.edit":"Editare afiaje","displays.delete":"tergere afiaje","users.view":"Vizualizare utilizatori","users.create":"Creare utilizatori","users.edit":"Editare utilizatori","users.delete":"tergere utilizatori"},"actions":{"edit":"Editeaz","delete":"terge","regenerateToken":"Regenereaz token","showQRCode":"Afieaz cod QR","deactivate":"Dezactiveaz","activate":"Activeaz","copyUrl":"Copiaz URL"},"modals":{"cancel":"Anuleaz","create":{"title":"Adaug utilizator nou","submit":"Creeaz utilizator"},"edit":{"title":"Editeaz utilizator","submit":"Salveaz modificrile"},"delete":{"title":"terge utilizator","message":"Eti sigur c vrei s tergi \\"{{name}}\\"? Aceast aciune nu poate fi anulat.","confirm":"terge"},"qrCode":{"title":"Scaneaz codul QR","userName":"Utilizator","description":"Scaneaz acest cod QR cu dispozitivul pe care vrei s l autorizezi","networkInterface":"Interfa de reea","warning":"Acest token va fi afiat o singur dat. Salveaz-l dac este necesar.","manualUrl":"Sau viziteaz manual acest URL:","done":"Gata"},"regenerate":{"title":"Regenereaz token","message":"Aceasta va invalida tokenul curent pentru \\"{{name}}\\". Utilizatorul va trebui re-autentificat.","confirm":"Regenereaz"}},"toast":{"created":"Utilizator creat cu succes","updated":"Utilizator actualizat cu succes","deleted":"Utilizator ters cu succes","tokenRegenerated":"Token regenerat cu succes","urlCopied":"URL copiat n clipboard","error":"A aprut o eroare"}},"categories":{"title":"Categorii Cntri","description":"Administreaz categoriile de cntri i prioritatea lor n cutare. Poziie mai sus = prioritate mai mare n rezultatele cutrii.","addCategory":"Adaug Categorie","noCategories":"Nicio categorie configurat","noCategoriesDescription":"Adaug o categorie pentru a organiza cntrile tale","categoryName":"Nume Categorie","categoryNamePlaceholder":"ex., nchinare, Imnuri, Crciun","priority":"Prioritate","value":"Prioritate","actions":{"edit":"Editeaz","delete":"terge"},"modals":{"create":{"title":"Adaug Categorie Nou","submit":"Creeaz Categorie"},"edit":{"title":"Editeaz Categorie","submit":"Salveaz Modificrile"},"delete":{"title":"terge Categorie","message":"Eti sigur c vrei s tergi \\"{{name}}\\"? Cntrile din aceast categorie vor deveni necategorizate.","confirm":"terge"}},"toast":{"created":"Categorie creat cu succes","updated":"Categorie actualizat cu succes","deleted":"Categorie tears cu succes","reordered":"Ordinea categoriilor actualizat","error":"A aprut o eroare"}},"synonyms":{"title":"Sinonime Cutare","description":"Definete sinonime pentru cuvinte pentru a mbunti rezultatele cutrii. Cnd caui un cuvnt, vor aprea i rezultatele cu sinonimele acestuia.","addSynonym":"Adaug Sinonim","noSynonyms":"Niciun sinonim configurat","noSynonymsDescription":"Adaug sinonime pentru a gsi cntri cu ortografii alternative","primaryTerm":"Termen Principal","primaryTermPlaceholder":"ex., cristos","synonymTerms":"Termeni Sinonimi","synonymTermsPlaceholder":"ex., hristos, christ","synonymTermsHint":"Separ sinonimele multiple cu virgul","actions":{"edit":"Editeaz","delete":"terge"},"modals":{"create":{"title":"Adaug Sinonim Nou","submit":"Creeaz Sinonim"},"edit":{"title":"Editeaz Sinonim","submit":"Salveaz Modificrile"},"delete":{"title":"terge Sinonim","message":"Eti sigur c vrei s tergi grupul de sinonime pentru \\"{{primary}}\\"?","confirm":"terge"}},"toast":{"created":"Sinonim creat cu succes","updated":"Sinonim actualizat cu succes","deleted":"Sinonim ters cu succes","error":"A aprut o eroare"}},"importExport":{"title":"Import & Export Cntri","description":"Import cntri din fiiere sau export biblioteca de cntri","import":{"title":"Import Cntri","description":"Import cntri din fiiere OpenSong XML, PPTX sau ZIP","button":"Selecteaz Fiiere","supportedFormats":"Formate acceptate: OpenSong XML, PPTX, PPT, ZIP","noSongsTitle":"Nicio Cntare Gsit","noSongsMessage":"Nu s-au gsit cntri valide n fiierele selectate."},"export":{"title":"Export Cntri","description":"Export cntrile n format OpenSong XML ntr-o arhiv ZIP","button":"Export Cntri","allSongs":"Toate cntrile","byCategory":"Dup categorie","selectCategory":"Selecteaz o categorie","exporting":"Se export...","fetching":"Se export cntrile...","generating":"Se genereaz fiierele XML...","zipping":"Se creeaz arhiva ZIP...","saving":"Se salveaz fiierul...","processingProgress":"Se proceseaz {{current}} din {{total}}"},"resurseCrestine":{"title":"Import din Resurse Crestine","description":"Descarc i import cntri de pe site-ul Resurse Crestine","button":"Import din Resurse Crestine","importing":"Se import...","note":"Cntrile vor fi importate n categoria 'Resurse Crestine' cu primul vers ca titlu"},"toast":{"importSuccess":"S-au importat cu succes {{count}} cntri","importFailed":"Importul a euat: {{error}}","exportSuccess":"S-au exportat cu succes {{count}} cntri","exportFailed":"Exportul a euat: {{error}}"}},"apiDocs":{"title":"Documentatie API","description":"Acceseaza documentatia API REST pentru dezvoltatori","link":"Deschide Documentatia API"},"systemToken":{"title":"Token API de Sistem","description":"Foloseste acest token pentru a accesa API-ul cu privilegii de superutilizator din aplicatii externe. Aceasta sectiune este vizibila doar pe localhost.","token":"Token","showToken":"Afiseaza Token","loading":"Se incarca...","show":"Afiseaza token","hide":"Ascunde token","copy":"Copiaza in clipboard","regenerate":"Regenereaza Token","regenerating":"Se regenereaza...","regenerateWarning":"Regenerarea va invalida tokenul curent","createdAt":"Creat","lastUsed":"Ultima utilizare","never":"Niciodata","toast":{"copied":"Token copiat in clipboard","regenerated":"Token de sistem regenerat cu succes","fetchError":"Nu s-a putut obtine tokenul de sistem","regenerateError":"Nu s-a putut regenera tokenul de sistem"}},"sidebar":{"title":"Configurare Bar Lateral","description":"Personalizeaz elementele meniului din bara lateral, ordinea lor i adaug pagini personalizate","builtIn":"Predefinit","custom":"Pagin Personalizat","addCustomPage":"Adaug Pagin Personalizat","visible":"Vizibil","hidden":"Ascuns","pageNotFound":"Pagina nu a fost gsit","openInNewTab":"Deschide n tab nou","openInWindow":"Deschide n fereastr","openInBrowser":"Deschide n browser","loadingPage":"Se ncarc pagina...","loadError":"Aceast pagin nu poate fi ncorporat","loadErrorDescription":"Unele site-uri web blocheaz ncorporarea din motive de securitate. Deschide ntr-un tab nou.","nativeWindowTitle":"Pagina extern deschis n fereastr nativ","nativeWindowDescription":"Aceast pagin a fost deschis ntr-o fereastr separat pentru a asigura funcionalitatea complet. Apas butonul de mai sus pentru a o redeschide dac este necesar.","fields":{"title":"Titlu","titlePlaceholder":"ex., Calendar Biseric","url":"URL","urlPlaceholder":"https://exemplu.com/calendar","urlHint":"URL-ul va fi ncorporat ntr-un iframe","icon":"Pictogram","selectIcon":"Selecteaz o pictogram pentru bara lateral","useIframeEmbedding":"Folosete ncorporare iframe","useIframeEmbeddingHint":"ncorporeaz folosind un iframe n loc de webview nativ. Recomandat pentru site-uri ca YouTube care suport ncorporarea iframe."},"validation":{"titleRequired":"Titlul este obligatoriu","urlRequired":"URL-ul este obligatoriu","urlInvalid":"Te rog introdu un URL valid"},"modals":{"create":{"title":"Adaug Pagin Personalizat","submit":"Adaug Pagina"},"edit":{"title":"Editeaz Pagin Personalizat","submit":"Salveaz Modificrile"},"delete":{"title":"terge Pagin Personalizat","message":"Eti sigur c vrei s tergi \\"{{name}}\\"?","confirm":"terge"}},"toast":{"saved":"Configurare bar lateral salvat","customPageCreated":"Pagin personalizat adugat","customPageUpdated":"Pagin personalizat actualizat","customPageDeleted":"Pagin personalizat tears","error":"A aprut o eroare"}},"apiUrl":{"title":"Conexiune Server","label":"URL Server","hint":"Introdu URL-ul de autentificare din Church Hub (ex., http://192.168.1.100:3000/api/auth/user/usr_TOKEN)","settingsDescription":"Configureaz serverul la care se conecteaz aplicaia mobil","testConnection":"Testeaz Conexiunea","testing":"Se testeaz...","retry":"Rencearc","save":"Salveaz i Continu","saved":"URL-ul serverului salvat cu succes","connectionSuccess":"Conexiune reuit","authTokenDetected":"Token de autentificare detectat","setup":{"title":"Conectare la Server","description":"Scaneaz codul QR sau lipete URL-ul de autentificare din Church Hub"},"errors":{"emptyUrl":"Te rugm s introduci un URL de server","invalidUrl":"Te rugm s introduci un URL valid (ex., http://192.168.1.100:3000/api/auth/user/usr_TOKEN)","connectionFailed":"Nu s-a putut conecta la server. Verific URL-ul i ncearc din nou.","testFirst":"Te rugm s testezi conexiunea nainte de a salva"}},"database":{"title":"Administrare Baz de Date","description":"Administreaz locaia i backup-ul bazei de date SQLite","path":"Calea Bazei de Date","copyPath":"Copiaz calea","openFolder":"Deschide n Explorator","size":"Dimensiune","export":{"title":"Export Baza de Date","description":"Creeaz o copie de siguran a bazei de date","button":"Export Baza de Date","exporting":"Se export..."},"import":{"title":"Import Baza de Date","description":"Restaureaz dintr-o copie de siguran","button":"Import Baza de Date","importing":"Se import...","confirm":{"title":"Import Baza de Date","message":"Aceasta va nlocui baza de date curent cu fiierul selectat. O copie de siguran a bazei de date curente va fi creat. Aplicaia va trebui repornit dup import.","warning":"Aceast aciune nu poate fi anulat.","confirm":"Import","cancel":"Anuleaz"}},"toast":{"pathCopied":"Calea bazei de date copiat n clipboard","exportSuccess":"Baza de date exportat cu succes n {{path}}","exportFailed":"Exportul a euat: {{error}}","openFolderFailed":"Nu s-a putut deschide exploratorul de fiiere","importSuccess":"Baza de date importat cu succes. Te rugm s reporneti aplicaia.","importFailed":"Importul a euat: {{error}}"}}}`),iJ={title:rJ,sections:sJ},aJ={home:"Acas",dashboard:"Panou",schedules:"Programe",songs:"Cntri",bible:"Biblie",present:"Camera de control",livestream:"Live Stream",settings:"Setri"},oJ={collapse:"Restrnge",expand:"Extinde bara lateral",collapseSidebar:"Restrnge bara lateral",openMenu:"Deschide meniu",closeMenu:"nchide meniu"},lJ={navigation:aJ,actions:oJ},cJ="Cntri",uJ={create:"Cntare nou",save:"Salveaz",delete:"terge",back:"napoi la cntri",import:"Import",importFromText:"Import din text",addSlide:"Adaug slide",cloneSlide:"Cloneaz slide",addToSchedule:"Adaug n program"},dJ={titlePlaceholder:"Introdu titlul cntrii...",categoryPlaceholder:"Selecteaz categoria...",slides:"Slide-uri",slideNumber:"Slide {{number}}",emptySlide:"Slide gol - click pentru a edita",noSlides:"Nu exist slide-uri nc",saveFirst:"Salveaz cntarea pentru a aduga slide-uri",undo:"Anuleaz",redo:"Ref"},fJ={placeholder:"Caut cntri...",noResults:'Nu s-au gsit cntri pentru "{{query}}"',resultsCount:"{{count}} cntri gsite",showingCount:"Se afieaz {{showing}} din {{total}} cntri",moreResults:"{{count}} cntri n plus nu sunt afiate. Folosete cutarea pentru a gsi cntri specifice."},hJ={none:"Fr categorie",create:"Creeaz",name:"Categorie"},pJ={saving:"Se salveaz cntarea...",saved:"Cntarea a fost salvat cu succes",deleted:"Cntarea a fost tears cu succes",error:"A aprut o eroare",slideSaved:"Slide salvat",slideDeleted:"Slide ters",slideCloned:"Slide clonat",reorderFailed:"Nu s-a putut reordona slide-urile",categoryCreated:"Categoria a fost creat"},gJ={deleteTitle:"terge cntarea",deleteMessage:"Eti sigur c vrei s tergi aceast cntare? Aceast aciune nu poate fi anulat.",deleteSlideTitle:"terge slide",deleteSlideMessage:"Eti sigur c vrei s tergi acest slide?",unsavedChangesTitle:"Modificri nesalvate",unsavedChangesMessage:"Ai modificri nesalvate. Eti sigur c vrei s prseti pagina?",unsavedBeforeActionMessage:"Ai modificri nesalvate. Ce vrei s faci?",discardChanges:"Pierde modificrile",saveAndContinue:"Salveaz i continu",continueWithoutSaving:"Continu fr a salva",cancel:"Anuleaz"},mJ="Nu exist cntri nc",yJ="Creeaz prima ta cntare pentru a ncepe",xJ={title:"Import PowerPoint",description:"S-au gsit {{count}} slide-uri. Import ca o cntare nou?",songTitle:"Titlul cntrii",createSong:"Creeaz cntare",dropHint:"Trage fiierul PPTX pentru a importa ca cntare",slideNumber:"Slide {{number}}"},bJ={title:"Import cntri",description:"Pregtit pentru importul a {{count}} cntare/cntri",categoryLabel:"Categorie (opional)",songsList:"Cntri de importat:",confirmButton:"Import {{count}} cntare/cntri",importing:"Se import...",noSongsFound:"Nu s-au gsit fiiere de cntri",noSongsFoundDescription:"Fiierele selectate nu au putut fi interpretate ca i cntri. Te rugm s te asiguri c importezi fiiere de cntri valide (OpenSong XML sau fiiere PowerPoint).",successMessage:"S-au importat cu succes {{count}} cntare/cntri",processing:"Se proceseaz fiierele...",processingProgress:"Procesare: {{current}} din {{total}} fiiere",downloading:"Se descarc...",extracting:"Se extrage arhiva...",converting:"Se convertesc fiierele PPT...",convertingProgress:"Conversie: {{current}} din {{total}} fiiere PPT",parsing:"Se parseaz cntrile...",saving:"Se salveaz n baza de date...",useFirstVerseAsTitle:"Folosete primul vers ca titlu",overwriteDuplicates:"Suprascrie cntrile existente cu acelai titlu",skipManuallyEdited:"Sari peste cntrile editate manual",libreOfficeNotInstalled:"LibreOffice este necesar pentru a importa fiiere .ppt",libreOfficeNotInstalledDescription:"Te rugm s instalezi LibreOffice de la https://www.libreoffice.org pentru a activa importul fiierelor .ppt. Alternativ, convertete fiierele n format .pptx mai nti."},vJ={title:"Setri cntri"},wJ={backToSongs:"napoi",edit:"Editeaz",slides:"Slide-uri",noSlides:"Fr slide-uri",slideNumber:"Slide {{number}}"},SJ={detailsSection:"Detalii",author:"Autor",copyright:"Drepturi de autor",ccli:"Numr CCLI",hymnNumber:"Numr imn",key:"Tonalitate",keyPlaceholder:"Do Major",tempo:"Tempo",timeSignature:"Msur",theme:"Tem",altTheme:"Tem alternativ",keyLine:"Gama melodie",keyLinePlaceholder:"Introdu un vers memorabil din cntare...",presentationOrder:"Ordinea prezentrii",sourceFilename:"Fiier surs",presentationCount:"Numr prezentri",lastManualEdit:"Ultima editare manual",neverEdited:"Needitat"},kJ={title:cJ,actions:uJ,editor:dJ,search:fJ,import:{title:"Import din text",description:"Introdu textul cntecului mai jos. Fiecare paragraf va deveni un slide separat.",placeholder:"Introdu versurile aici...",preview:"Previzualizare: {{count}} slide-uri",confirm:"Import",cancel:"Anuleaz"},category:hJ,messages:pJ,modal:gJ,noSongs:mJ,noSongsDescription:yJ,pptxImport:xJ,batchImport:bJ,settings:vJ,preview:wJ,metadata:SJ},CJ={en:{bible:EY,common:_Y,livestream:UY,presentation:YY,queue:hG,schedules:NG,sidebar:RG,settings:EG,songs:KG},ro:{bible:rX,common:oX,livestream:mX,presentation:CX,queue:HX,schedules:nJ,sidebar:lJ,settings:iJ,songs:kJ}};Hn.use(U5).use(pL).init({resources:CJ,fallbackLng:"en",defaultNS:"common",ns:["bible","common","livestream","presentation","queue","schedules","sidebar","settings","songs"],detection:{order:["localStorage","navigator"],caches:["localStorage"],lookupLocalStorage:"church-hub-language"},interpolation:{escapeValue:!1},react:{useSuspense:!0}});const Vn=HO({component:EJ});function NJ(){return aP(),null}function TJ(){return u.jsx(_5,{children:u.jsx(E5,{children:u.jsx(Cb,{})})})}function jJ(){return u.jsx(_5,{children:u.jsx(E5,{children:u.jsx(NW,{children:u.jsx(fW,{children:u.jsxs(SL,{children:[u.jsx(Hz,{children:u.jsx(Mz,{children:u.jsxs(VQ,{children:[u.jsx(NJ,{}),u.jsx(Pz,{}),u.jsx(nY,{children:u.jsx(Cb,{})})]})})}),null]})})})})})}function EJ(){return Ip().pathname.startsWith("/screen/")?u.jsx(TJ,{}):u.jsx(jJ,{})}function MJ(){const{t}=ke("common");return u.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] p-8 text-center",children:[u.jsx(o6,{className:"w-16 h-16 text-gray-400 dark:text-gray-600 mb-4"}),u.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:t("errors.noPermissionTitle")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4 max-w-md",children:t("errors.noPermission")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:t("errors.contactAdmin")})]})}function bd({permission:t,children:e}){const{hasPermission:n,isLoading:r}=j5();return r?u.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):n(t)?u.jsx(u.Fragment,{children:e}):u.jsx(MJ,{})}const AJ=_n("/songs/")({component:RJ,validateSearch:t=>({q:typeof t.q=="string"?t.q:void 0,fromSong:t.fromSong===!0||t.fromSong==="true"})});function RJ(){const{t}=ke("songs"),e=lr(),{q:n="",fromSong:r}=rd({from:"/songs/"}),[s,i]=C.useState(!1),{data:o}=mi(),{data:l}=Qp(),d=C.useRef(!1);C.useEffect(()=>{if(d.current||r||!o)return;let g=null;if(o.temporaryContent?.type==="song")g=o.temporaryContent.data.songId;else if(o.currentQueueItemId&&l){const m=l.find(y=>y.id===o.currentQueueItemId);m?.itemType==="song"&&m.songId&&(g=m.songId)}g&&(d.current=!0,e({to:"/songs/$songId",params:{songId:String(g)},search:{q:n||void 0}}))},[o,l,e,n,r]);const f=g=>{e({to:"/songs/$songId",params:{songId:String(g)},search:{q:n||void 0}})},p=g=>{e({to:"/songs/",search:{q:g||void 0},replace:!0})};return u.jsx(bd,{permission:"songs.view",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:t("title")}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("button",{type:"button",onClick:()=>e({to:"/songs/$songId",params:{songId:"new"}}),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors",children:[u.jsx(Xt,{className:"w-5 h-5"}),t("actions.create")]}),u.jsx("button",{type:"button",onClick:()=>i(!0),className:"px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-600 dark:text-gray-400 transition-colors",title:t("settings.title"),children:u.jsx(di,{className:"w-5 h-5"})})]})]}),u.jsx(v5,{onSongClick:f,searchQuery:n,onSearchChange:p}),u.jsx(LQ,{isOpen:s,onClose:()=>i(!1)})]})})}function _J(){const[t,e]=C.useState(!1);return{exportDatabase:C.useCallback(async()=>{const s=`church-hub-backup-${new Date().toISOString().split("T")[0]}.db`,i=await k5({defaultPath:s,filters:[{name:"SQLite Database",extensions:["db"]}]});if(!i)return{success:!1,cancelled:!0};e(!0);try{const o=await Me("/api/database/export",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({destinationPath:i})});return o.error?{success:!1,error:o.error}:{success:!0,path:o.data?.exportedPath||i}}catch(o){return{success:!1,error:o instanceof Error?o.message:String(o)}}finally{e(!1)}},[]),isPending:t}}function OJ(){const[t,e]=C.useState(!1),[n,r]=C.useState(null),s=C.useCallback(async()=>{const o=await S5({multiple:!1,filters:[{name:"SQLite Database",extensions:["db","sqlite"]}]});return typeof o=="string"?(r(o),o):(r(null),null)},[]),i=C.useCallback(async o=>{e(!0);try{const l=await Me("/api/database/import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourcePath:o})});return l.error?{success:!1,error:l.error}:{success:!0,requiresRestart:l.data?.requiresRestart}}catch(l){return{success:!1,error:l instanceof Error?l.message:String(l)}}finally{e(!1),r(null)}},[]);return{selectFile:s,importDatabase:i,isPending:t,selectedPath:n}}function IJ(t){if(t===0)return"0 B";const e=1024,n=["B","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(e));return`${Number.parseFloat((t/e**r).toFixed(2))} ${n[r]}`}function DJ(){const{t}=ke("settings"),{showToast:e}=mt(),[n,r]=C.useState(null),[s,i]=C.useState(!0),[o,l]=C.useState(!1),[d,f]=C.useState(null),{exportDatabase:p,isPending:g}=_J(),{selectFile:m,importDatabase:y,isPending:b}=OJ(),v=C.useCallback(async()=>{i(!0);try{const R=await Me("/api/database/info");R.data&&r(R.data)}catch{}finally{i(!1)}},[]);C.useEffect(()=>{v()},[v]);const w=C.useCallback(()=>{n?.path&&(navigator.clipboard.writeText(n.path),e(t("sections.database.toast.pathCopied"),"success"))},[n?.path,e,t]),S=C.useCallback(async()=>{if(n?.path)try{await Yt("plugin:opener|reveal_item_in_dir",{path:n.path})}catch{e(t("sections.database.toast.openFolderFailed"),"error")}},[n?.path,e,t]),T=C.useCallback(async()=>{const R=await p();R.cancelled||(R.success?e(t("sections.database.toast.exportSuccess",{path:R.path}),"success"):e(t("sections.database.toast.exportFailed",{error:R.error}),"error"))},[p,e,t]),j=C.useCallback(async()=>{const R=await m();R&&(f(R),l(!0))},[m]),M=C.useCallback(async()=>{if(!d)return;l(!1);const R=await y(d);f(null),R.success?e(t("sections.database.toast.importSuccess"),"success"):e(t("sections.database.toast.importFailed",{error:R.error}),"error")},[d,y,e,t]),_=C.useCallback(()=>{l(!1),f(null)},[]);return u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:t("sections.database.title")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:t("sections.database.description")}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:t("sections.database.path")}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:w,disabled:s||!n?.path,className:"p-1.5 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 disabled:opacity-50",title:t("sections.database.copyPath"),children:u.jsx(ad,{className:"w-4 h-4"})}),u.jsx("button",{type:"button",onClick:S,disabled:s||!n?.path,className:"p-1.5 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 disabled:opacity-50",title:t("sections.database.openFolder"),children:u.jsx(zj,{className:"w-4 h-4"})})]})]}),u.jsx("code",{className:"block text-sm font-mono bg-gray-100 dark:bg-gray-900 p-2 rounded break-all",children:s?"...":n?.path||"N/A"}),n&&u.jsx("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:u.jsxs("span",{children:[t("sections.database.size"),":"," ",IJ(n.sizeBytes)]})})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"p-2 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg",children:u.jsx(Eh,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t("sections.database.export.title")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:t("sections.database.export.description")}),u.jsxs("button",{type:"button",onClick:T,disabled:g||s||b,className:"mt-3 inline-flex items-center gap-2 px-3 py-1.5 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50 text-sm",children:[u.jsx(Eh,{className:"w-4 h-4"}),t(g?"sections.database.export.exporting":"sections.database.export.button")]})]})]})}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"p-2 bg-amber-100 dark:bg-amber-900/30 rounded-lg",children:u.jsx(F2,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t("sections.database.import.title")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:t("sections.database.import.description")}),u.jsxs("button",{type:"button",onClick:j,disabled:b||s||g,className:"mt-3 inline-flex items-center gap-2 px-3 py-1.5 bg-amber-600 text-white rounded-md hover:bg-amber-700 disabled:opacity-50 text-sm",children:[u.jsx(F2,{className:"w-4 h-4"}),t(b?"sections.database.import.importing":"sections.database.import.button")]})]})]})})]})]}),o&&u.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[u.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:_,onKeyDown:R=>R.key==="Escape"&&_()}),u.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx("div",{className:"p-2 bg-amber-100 dark:bg-amber-900/30 rounded-full",children:u.jsx(y6,{className:"w-6 h-6 text-amber-600 dark:text-amber-400"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.database.import.confirm.title")}),u.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:t("sections.database.import.confirm.message")}),u.jsx("p",{className:"mt-2 text-sm font-medium text-amber-600 dark:text-amber-400",children:t("sections.database.import.confirm.warning")})]})]}),u.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[u.jsx("button",{type:"button",onClick:_,className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:t("sections.database.import.confirm.cancel")}),u.jsx("button",{type:"button",onClick:M,className:"px-4 py-2 text-sm bg-amber-600 text-white hover:bg-amber-700 rounded-md",children:t("sections.database.import.confirm.confirm")})]})]})]})]})}function LJ(){const{t}=ke("settings"),{showToast:e}=mt(),[n,r]=C.useState(null),[s,i]=C.useState(!1),[o,l]=C.useState(!1),[d,f]=C.useState(!1),p=C.useCallback(async()=>{i(!0);try{const b=await Me("/api/system-token");r(b.data),l(!0)}catch{e(t("sections.systemToken.toast.fetchError"),"error")}finally{i(!1)}},[t,e]),g=async()=>{f(!0);try{const b=await Me("/api/system-token/regenerate",{method:"POST"});r(v=>v?{...v,token:b.data.token,lastUsedAt:null}:{token:b.data.token,lastUsedAt:null,createdAt:new Date().toISOString()}),l(!0),e(t("sections.systemToken.toast.regenerated"),"success")}catch{e(t("sections.systemToken.toast.regenerateError"),"error")}finally{f(!1)}},m=()=>{n?.token&&(navigator.clipboard.writeText(n.token),e(t("sections.systemToken.toast.copied"),"success"))},y=b=>b?new Date(b).toLocaleString():t("sections.systemToken.never");return u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:t("sections.systemToken.title")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:t("sections.systemToken.description")}),!n&&!o?u.jsxs("button",{type:"button",onClick:p,disabled:s,className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 text-sm",children:[u.jsx(uD,{className:"w-4 h-4"}),t(s?"sections.systemToken.loading":"sections.systemToken.showToken")]}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:t("sections.systemToken.token")}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>l(!o),className:"p-1.5 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",title:t(o?"sections.systemToken.hide":"sections.systemToken.show"),children:o?u.jsx(Jl,{className:"w-4 h-4"}):u.jsx(pa,{className:"w-4 h-4"})}),u.jsx("button",{type:"button",onClick:m,className:"p-1.5 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",title:t("sections.systemToken.copy"),children:u.jsx(ad,{className:"w-4 h-4"})})]})]}),u.jsx("code",{className:"block text-sm font-mono bg-gray-100 dark:bg-gray-900 p-2 rounded break-all",children:o?n?.token:n?.token.replace(/./g,"*")})]}),n&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 space-y-1",children:[u.jsxs("p",{children:[t("sections.systemToken.createdAt"),":"," ",y(n.createdAt)]}),u.jsxs("p",{children:[t("sections.systemToken.lastUsed"),":"," ",y(n.lastUsedAt)]})]}),u.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[u.jsxs("button",{type:"button",onClick:g,disabled:d,className:"inline-flex items-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50 text-sm",children:[u.jsx(Ab,{className:`w-4 h-4 ${d?"animate-spin":""}`}),t(d?"sections.systemToken.regenerating":"sections.systemToken.regenerate")]}),u.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400",children:t("sections.systemToken.regenerateWarning")})]})]})]})}function zJ({user:t,onEdit:e,onDelete:n,onShowQR:r,onRegenerateToken:s,onToggleActive:i}){const{t:o}=ke("settings"),[l,d]=C.useState(!1),f=g=>g?new Date(g*1e3).toLocaleDateString():o("sections.users.never"),p=t.permissions.length;return u.jsx("div",{className:`relative border rounded-lg p-4 ${t.isActive?"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800":"border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 opacity-60"}`,children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h3",{className:"text-base font-medium text-gray-900 dark:text-white truncate",children:t.name}),u.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${t.isActive?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-400"}`,children:t.isActive?o("sections.users.active"):o("sections.users.inactive")})]}),t.roleName&&u.jsx("p",{className:"mt-1 text-sm text-indigo-600 dark:text-indigo-400",children:o(`sections.users.roles.${t.roleName}`,t.roleName)}),u.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[o("sections.users.lastUsed"),": ",f(t.lastUsedAt)]}),u.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[p," ",o("sections.users.permissions").toLowerCase()]})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{onClick:()=>r(t),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:o("sections.users.actions.showQRCode"),children:u.jsx(B2,{size:20,className:"text-indigo-600 dark:text-indigo-400"})}),u.jsx("button",{onClick:()=>d(!l),className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u.jsx(Bp,{size:20,className:"text-gray-500 dark:text-gray-400"})}),l&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>d(!1)}),u.jsxs("div",{className:"absolute right-0 mt-1 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-20",children:[u.jsxs("button",{onClick:()=>{r(t),d(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(B2,{size:16}),o("sections.users.actions.showQRCode")]}),u.jsxs("button",{onClick:()=>{e(t),d(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(eE,{size:16}),o("sections.users.actions.edit")]}),u.jsxs("button",{onClick:()=>{s(t),d(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx(Ab,{size:16}),o("sections.users.actions.regenerateToken")]}),u.jsx("button",{onClick:()=>{i(t),d(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:t.isActive?u.jsxs(u.Fragment,{children:[u.jsx(KD,{size:16}),o("sections.users.actions.deactivate")]}):u.jsxs(u.Fragment,{children:[u.jsx(Jj,{size:16}),o("sections.users.actions.activate")]})}),u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700"}),u.jsxs("button",{onClick:()=>{n(t),d(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:[u.jsx(Fn,{size:16}),o("sections.users.actions.delete")]})]})]})]})]})})}const PJ=["songs","control_room","programs","queue","settings","displays","users"];function BJ({permissions:t,onChange:e,disabled:n,selectedRole:r,onRoleChange:s}){const{t:i}=ke("settings"),[o,l]=C.useState(new Set(["songs","control_room"])),d=v=>{const w=new Set(o);w.has(v)?w.delete(v):w.add(v),l(w)},f=(v,w)=>{e(w?[...t,v]:t.filter(S=>S!==v)),s&&s(null)},p=(v,w)=>{const S=kl[v];if(w){const T=new Set([...t,...S]);e(Array.from(T))}else e(t.filter(T=>!S.includes(T)));s&&s(null)},g=v=>{s&&s(v),v&&e([...hb[v]])},m=v=>kl[v].every(w=>t.includes(w)),y=v=>{const w=kl[v],S=w.filter(T=>t.includes(T)).length;return S>0&&S<w.length},b=v=>kl[v].filter(w=>t.includes(w)).length;return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("sections.users.roleTemplate")}),u.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.keys(hb).map(v=>u.jsx("button",{type:"button",onClick:()=>g(v),disabled:n,className:`px-3 py-2 text-sm rounded-lg border transition-colors ${r===v?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300":"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:border-indigo-300 dark:hover:border-indigo-700 hover:bg-gray-50 dark:hover:bg-gray-800"} disabled:opacity-50 disabled:cursor-not-allowed`,children:i(`sections.users.roles.${v}`)},v))})]}),u.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:PJ.map(v=>{const w=o.has(v),S=m(v),T=y(v),j=b(v),M=kl[v].length;return u.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:[u.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 dark:bg-gray-800/50",children:[u.jsx("button",{type:"button",onClick:()=>d(v),className:"p-0.5 hover:bg-gray-200 dark:hover:bg-gray-700 rounded",children:w?u.jsx(Ms,{size:16,className:"text-gray-500"}):u.jsx(As,{size:16,className:"text-gray-500"})}),u.jsx("input",{type:"checkbox",checked:S,ref:_=>{_&&(_.indeterminate=T)},onChange:_=>p(v,_.target.checked),disabled:n,className:`w-4 h-4 text-indigo-600 rounded border-gray-300
                    focus:ring-indigo-500 disabled:opacity-50 cursor-pointer
                    disabled:cursor-not-allowed`}),u.jsx("button",{type:"button",onClick:()=>d(v),className:"flex-1 text-left text-sm font-medium text-gray-900 dark:text-white",children:i(`sections.users.groups.${v}`)}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[j,"/",M]})]}),w&&u.jsx("div",{className:"px-3 py-2 space-y-2 bg-white dark:bg-gray-800",children:kl[v].map(_=>u.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:t.includes(_),onChange:R=>f(_,R.target.checked),disabled:n,className:`w-4 h-4 text-indigo-600 rounded border-gray-300
                          focus:ring-indigo-500 disabled:opacity-50 cursor-pointer
                          disabled:cursor-not-allowed ml-6`}),u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:i(`sections.users.permissionLabels.${_}`)})]},_))})]},v)})}),u.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-right",children:[t.length," ",i("sections.users.permissionsSelected")]})]})}function FJ({user:t,onSubmit:e,onCancel:n,isLoading:r}){const{t:s}=ke("settings"),[i,o]=C.useState(t?.name??""),[l,d]=C.useState(t?.permissions??[]),[f,p]=C.useState(()=>{if(!t?.permissions)return null;for(const[y,b]of Object.entries(hb))if(b.length===t.permissions.length&&b.every(v=>t.permissions.includes(v)))return y;return null}),g=y=>{y.preventDefault(),i.trim()&&e({name:i.trim(),permissions:l})},m=!!t;return u.jsxs("form",{onSubmit:g,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"user-name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:s("sections.users.userName")}),u.jsx("input",{id:"user-name",type:"text",value:i,onChange:y=>o(y.target.value),placeholder:s("sections.users.userNamePlaceholder"),disabled:r,className:`block w-full px-3 py-2 bg-white dark:bg-gray-800
            border border-gray-300 dark:border-gray-600 rounded-lg
            text-gray-900 dark:text-white
            focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500
            disabled:opacity-50`,autoFocus:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:s("sections.users.permissions")}),u.jsx(BJ,{permissions:l,onChange:d,disabled:r,selectedRole:f,onRoleChange:p})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:n,disabled:r,className:`px-4 py-2 text-gray-700 dark:text-gray-300
            hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg
            transition-colors disabled:opacity-50`,children:s("sections.users.modals.cancel")}),u.jsx("button",{type:"submit",disabled:r||!i.trim(),className:`px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg
            transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,children:r?u.jsxs("span",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s(m?"sections.users.modals.edit.submit":"sections.users.modals.create.submit")]}):s(m?"sections.users.modals.edit.submit":"sections.users.modals.create.submit")})]})]})}const oc=["users"];function UJ(){return lt({queryKey:oc,queryFn:pW})}function $J(){const t=Le();return De({mutationFn:e=>gW(e),onSuccess:()=>{t.invalidateQueries({queryKey:oc})}})}function qJ(){const t=Le();return De({mutationFn:e=>yW(e),onSuccess:()=>{t.invalidateQueries({queryKey:oc})}})}var jl={},Dy,CT;function HJ(){return CT||(CT=1,Dy=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Dy}var Ly={},Ki={},NT;function No(){if(NT)return Ki;NT=1;let t;const e=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Ki.getSymbolSize=function(r){if(!r)throw new Error('"version" cannot be null or undefined');if(r<1||r>40)throw new Error('"version" should be in range from 1 to 40');return r*4+17},Ki.getSymbolTotalCodewords=function(r){return e[r]},Ki.getBCHDigit=function(n){let r=0;for(;n!==0;)r++,n>>>=1;return r},Ki.setToSJISFunction=function(r){if(typeof r!="function")throw new Error('"toSJISFunc" is not a valid function.');t=r},Ki.isKanjiModeEnabled=function(){return typeof t<"u"},Ki.toSJIS=function(r){return t(r)},Ki}var zy={},TT;function u1(){return TT||(TT=1,(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+n)}}t.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},t.from=function(r,s){if(t.isValid(r))return r;try{return e(r)}catch{return s}}})(zy)),zy}var Py,jT;function VJ(){if(jT)return Py;jT=1;function t(){this.buffer=[],this.length=0}return t.prototype={get:function(e){const n=Math.floor(e/8);return(this.buffer[n]>>>7-e%8&1)===1},put:function(e,n){for(let r=0;r<n;r++)this.putBit((e>>>n-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),e&&(this.buffer[n]|=128>>>this.length%8),this.length++}},Py=t,Py}var By,ET;function KJ(){if(ET)return By;ET=1;function t(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}return t.prototype.set=function(e,n,r,s){const i=e*this.size+n;this.data[i]=r,s&&(this.reservedBit[i]=!0)},t.prototype.get=function(e,n){return this.data[e*this.size+n]},t.prototype.xor=function(e,n,r){this.data[e*this.size+n]^=r},t.prototype.isReserved=function(e,n){return this.reservedBit[e*this.size+n]},By=t,By}var Fy={},MT;function QJ(){return MT||(MT=1,(function(t){const e=No().getSymbolSize;t.getRowColCoords=function(r){if(r===1)return[];const s=Math.floor(r/7)+2,i=e(r),o=i===145?26:Math.ceil((i-13)/(2*s-2))*2,l=[i-7];for(let d=1;d<s-1;d++)l[d]=l[d-1]-o;return l.push(6),l.reverse()},t.getPositions=function(r){const s=[],i=t.getRowColCoords(r),o=i.length;for(let l=0;l<o;l++)for(let d=0;d<o;d++)l===0&&d===0||l===0&&d===o-1||l===o-1&&d===0||s.push([i[l],i[d]]);return s}})(Fy)),Fy}var Uy={},AT;function WJ(){if(AT)return Uy;AT=1;const t=No().getSymbolSize,e=7;return Uy.getPositions=function(r){const s=t(r);return[[0,0],[s-e,0],[0,s-e]]},Uy}var $y={},RT;function YJ(){return RT||(RT=1,(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(s){return s!=null&&s!==""&&!isNaN(s)&&s>=0&&s<=7},t.from=function(s){return t.isValid(s)?parseInt(s,10):void 0},t.getPenaltyN1=function(s){const i=s.size;let o=0,l=0,d=0,f=null,p=null;for(let g=0;g<i;g++){l=d=0,f=p=null;for(let m=0;m<i;m++){let y=s.get(g,m);y===f?l++:(l>=5&&(o+=e.N1+(l-5)),f=y,l=1),y=s.get(m,g),y===p?d++:(d>=5&&(o+=e.N1+(d-5)),p=y,d=1)}l>=5&&(o+=e.N1+(l-5)),d>=5&&(o+=e.N1+(d-5))}return o},t.getPenaltyN2=function(s){const i=s.size;let o=0;for(let l=0;l<i-1;l++)for(let d=0;d<i-1;d++){const f=s.get(l,d)+s.get(l,d+1)+s.get(l+1,d)+s.get(l+1,d+1);(f===4||f===0)&&o++}return o*e.N2},t.getPenaltyN3=function(s){const i=s.size;let o=0,l=0,d=0;for(let f=0;f<i;f++){l=d=0;for(let p=0;p<i;p++)l=l<<1&2047|s.get(f,p),p>=10&&(l===1488||l===93)&&o++,d=d<<1&2047|s.get(p,f),p>=10&&(d===1488||d===93)&&o++}return o*e.N3},t.getPenaltyN4=function(s){let i=0;const o=s.data.length;for(let d=0;d<o;d++)i+=s.data[d];return Math.abs(Math.ceil(i*100/o/5)-10)*e.N4};function n(r,s,i){switch(r){case t.Patterns.PATTERN000:return(s+i)%2===0;case t.Patterns.PATTERN001:return s%2===0;case t.Patterns.PATTERN010:return i%3===0;case t.Patterns.PATTERN011:return(s+i)%3===0;case t.Patterns.PATTERN100:return(Math.floor(s/2)+Math.floor(i/3))%2===0;case t.Patterns.PATTERN101:return s*i%2+s*i%3===0;case t.Patterns.PATTERN110:return(s*i%2+s*i%3)%2===0;case t.Patterns.PATTERN111:return(s*i%3+(s+i)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}t.applyMask=function(s,i){const o=i.size;for(let l=0;l<o;l++)for(let d=0;d<o;d++)i.isReserved(d,l)||i.xor(d,l,n(s,d,l))},t.getBestMask=function(s,i){const o=Object.keys(t.Patterns).length;let l=0,d=1/0;for(let f=0;f<o;f++){i(f),t.applyMask(f,s);const p=t.getPenaltyN1(s)+t.getPenaltyN2(s)+t.getPenaltyN3(s)+t.getPenaltyN4(s);t.applyMask(f,s),p<d&&(d=p,l=f)}return l}})($y)),$y}var ch={},_T;function $5(){if(_T)return ch;_T=1;const t=u1(),e=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return ch.getBlocksCount=function(s,i){switch(i){case t.L:return e[(s-1)*4+0];case t.M:return e[(s-1)*4+1];case t.Q:return e[(s-1)*4+2];case t.H:return e[(s-1)*4+3];default:return}},ch.getTotalCodewordsCount=function(s,i){switch(i){case t.L:return n[(s-1)*4+0];case t.M:return n[(s-1)*4+1];case t.Q:return n[(s-1)*4+2];case t.H:return n[(s-1)*4+3];default:return}},ch}var qy={},au={},OT;function GJ(){if(OT)return au;OT=1;const t=new Uint8Array(512),e=new Uint8Array(256);return(function(){let r=1;for(let s=0;s<255;s++)t[s]=r,e[r]=s,r<<=1,r&256&&(r^=285);for(let s=255;s<512;s++)t[s]=t[s-255]})(),au.log=function(r){if(r<1)throw new Error("log("+r+")");return e[r]},au.exp=function(r){return t[r]},au.mul=function(r,s){return r===0||s===0?0:t[e[r]+e[s]]},au}var IT;function XJ(){return IT||(IT=1,(function(t){const e=GJ();t.mul=function(r,s){const i=new Uint8Array(r.length+s.length-1);for(let o=0;o<r.length;o++)for(let l=0;l<s.length;l++)i[o+l]^=e.mul(r[o],s[l]);return i},t.mod=function(r,s){let i=new Uint8Array(r);for(;i.length-s.length>=0;){const o=i[0];for(let d=0;d<s.length;d++)i[d]^=e.mul(s[d],o);let l=0;for(;l<i.length&&i[l]===0;)l++;i=i.slice(l)}return i},t.generateECPolynomial=function(r){let s=new Uint8Array([1]);for(let i=0;i<r;i++)s=t.mul(s,new Uint8Array([1,e.exp(i)]));return s}})(qy)),qy}var Hy,DT;function JJ(){if(DT)return Hy;DT=1;const t=XJ();function e(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return e.prototype.initialize=function(r){this.degree=r,this.genPoly=t.generateECPolynomial(this.degree)},e.prototype.encode=function(r){if(!this.genPoly)throw new Error("Encoder not initialized");const s=new Uint8Array(r.length+this.degree);s.set(r);const i=t.mod(s,this.genPoly),o=this.degree-i.length;if(o>0){const l=new Uint8Array(this.degree);return l.set(i,o),l}return i},Hy=e,Hy}var Vy={},Ky={},Qy={},LT;function q5(){return LT||(LT=1,Qy.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}),Qy}var xs={},zT;function H5(){if(zT)return xs;zT=1;const t="[0-9]+",e="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const r="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;xs.KANJI=new RegExp(n,"g"),xs.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),xs.BYTE=new RegExp(r,"g"),xs.NUMERIC=new RegExp(t,"g"),xs.ALPHANUMERIC=new RegExp(e,"g");const s=new RegExp("^"+n+"$"),i=new RegExp("^"+t+"$"),o=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return xs.testKanji=function(d){return s.test(d)},xs.testNumeric=function(d){return i.test(d)},xs.testAlphanumeric=function(d){return o.test(d)},xs}var PT;function To(){return PT||(PT=1,(function(t){const e=q5(),n=H5();t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},t.getBestModeForData=function(i){return n.testNumeric(i)?t.NUMERIC:n.testAlphanumeric(i)?t.ALPHANUMERIC:n.testKanji(i)?t.KANJI:t.BYTE},t.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},t.isValid=function(i){return i&&i.bit&&i.ccBits};function r(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+s)}}t.from=function(i,o){if(t.isValid(i))return i;try{return r(i)}catch{return o}}})(Ky)),Ky}var BT;function ZJ(){return BT||(BT=1,(function(t){const e=No(),n=$5(),r=u1(),s=To(),i=q5(),o=7973,l=e.getBCHDigit(o);function d(m,y,b){for(let v=1;v<=40;v++)if(y<=t.getCapacity(v,b,m))return v}function f(m,y){return s.getCharCountIndicator(m,y)+4}function p(m,y){let b=0;return m.forEach(function(v){const w=f(v.mode,y);b+=w+v.getBitsLength()}),b}function g(m,y){for(let b=1;b<=40;b++)if(p(m,b)<=t.getCapacity(b,y,s.MIXED))return b}t.from=function(y,b){return i.isValid(y)?parseInt(y,10):b},t.getCapacity=function(y,b,v){if(!i.isValid(y))throw new Error("Invalid QR Code version");typeof v>"u"&&(v=s.BYTE);const w=e.getSymbolTotalCodewords(y),S=n.getTotalCodewordsCount(y,b),T=(w-S)*8;if(v===s.MIXED)return T;const j=T-f(v,y);switch(v){case s.NUMERIC:return Math.floor(j/10*3);case s.ALPHANUMERIC:return Math.floor(j/11*2);case s.KANJI:return Math.floor(j/13);case s.BYTE:default:return Math.floor(j/8)}},t.getBestVersionForData=function(y,b){let v;const w=r.from(b,r.M);if(Array.isArray(y)){if(y.length>1)return g(y,w);if(y.length===0)return 1;v=y[0]}else v=y;return d(v.mode,v.getLength(),w)},t.getEncodedBits=function(y){if(!i.isValid(y)||y<7)throw new Error("Invalid QR Code version");let b=y<<12;for(;e.getBCHDigit(b)-l>=0;)b^=o<<e.getBCHDigit(b)-l;return y<<12|b}})(Vy)),Vy}var Wy={},FT;function eZ(){if(FT)return Wy;FT=1;const t=No(),e=1335,n=21522,r=t.getBCHDigit(e);return Wy.getEncodedBits=function(i,o){const l=i.bit<<3|o;let d=l<<10;for(;t.getBCHDigit(d)-r>=0;)d^=e<<t.getBCHDigit(d)-r;return(l<<10|d)^n},Wy}var Yy={},Gy,UT;function tZ(){if(UT)return Gy;UT=1;const t=To();function e(n){this.mode=t.NUMERIC,this.data=n.toString()}return e.getBitsLength=function(r){return 10*Math.floor(r/3)+(r%3?r%3*3+1:0)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(r){let s,i,o;for(s=0;s+3<=this.data.length;s+=3)i=this.data.substr(s,3),o=parseInt(i,10),r.put(o,10);const l=this.data.length-s;l>0&&(i=this.data.substr(s),o=parseInt(i,10),r.put(o,l*3+1))},Gy=e,Gy}var Xy,$T;function nZ(){if($T)return Xy;$T=1;const t=To(),e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(r){this.mode=t.ALPHANUMERIC,this.data=r}return n.getBitsLength=function(s){return 11*Math.floor(s/2)+6*(s%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(s){let i;for(i=0;i+2<=this.data.length;i+=2){let o=e.indexOf(this.data[i])*45;o+=e.indexOf(this.data[i+1]),s.put(o,11)}this.data.length%2&&s.put(e.indexOf(this.data[i]),6)},Xy=n,Xy}var Jy,qT;function rZ(){if(qT)return Jy;qT=1;const t=To();function e(n){this.mode=t.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return e.getBitsLength=function(r){return r*8},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(n){for(let r=0,s=this.data.length;r<s;r++)n.put(this.data[r],8)},Jy=e,Jy}var Zy,HT;function sZ(){if(HT)return Zy;HT=1;const t=To(),e=No();function n(r){this.mode=t.KANJI,this.data=r}return n.getBitsLength=function(s){return s*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let s;for(s=0;s<this.data.length;s++){let i=e.toSJIS(this.data[s]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[s]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),r.put(i,13)}},Zy=n,Zy}var ex={exports:{}},VT;function iZ(){return VT||(VT=1,(function(t){var e={single_source_shortest_paths:function(n,r,s){var i={},o={};o[r]=0;var l=e.PriorityQueue.make();l.push(r,0);for(var d,f,p,g,m,y,b,v,w;!l.empty();){d=l.pop(),f=d.value,g=d.cost,m=n[f]||{};for(p in m)m.hasOwnProperty(p)&&(y=m[p],b=g+y,v=o[p],w=typeof o[p]>"u",(w||v>b)&&(o[p]=b,l.push(p,b),i[p]=f))}if(typeof s<"u"&&typeof o[s]>"u"){var S=["Could not find a path from ",r," to ",s,"."].join("");throw new Error(S)}return i},extract_shortest_path_from_predecessor_list:function(n,r){for(var s=[],i=r;i;)s.push(i),n[i],i=n[i];return s.reverse(),s},find_path:function(n,r,s){var i=e.single_source_shortest_paths(n,r,s);return e.extract_shortest_path_from_predecessor_list(i,s)},PriorityQueue:{make:function(n){var r=e.PriorityQueue,s={},i;n=n||{};for(i in r)r.hasOwnProperty(i)&&(s[i]=r[i]);return s.queue=[],s.sorter=n.sorter||r.default_sorter,s},default_sorter:function(n,r){return n.cost-r.cost},push:function(n,r){var s={value:n,cost:r};this.queue.push(s),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(ex)),ex.exports}var KT;function aZ(){return KT||(KT=1,(function(t){const e=To(),n=tZ(),r=nZ(),s=rZ(),i=sZ(),o=H5(),l=No(),d=iZ();function f(S){return unescape(encodeURIComponent(S)).length}function p(S,T,j){const M=[];let _;for(;(_=S.exec(j))!==null;)M.push({data:_[0],index:_.index,mode:T,length:_[0].length});return M}function g(S){const T=p(o.NUMERIC,e.NUMERIC,S),j=p(o.ALPHANUMERIC,e.ALPHANUMERIC,S);let M,_;return l.isKanjiModeEnabled()?(M=p(o.BYTE,e.BYTE,S),_=p(o.KANJI,e.KANJI,S)):(M=p(o.BYTE_KANJI,e.BYTE,S),_=[]),T.concat(j,M,_).sort(function(O,L){return O.index-L.index}).map(function(O){return{data:O.data,mode:O.mode,length:O.length}})}function m(S,T){switch(T){case e.NUMERIC:return n.getBitsLength(S);case e.ALPHANUMERIC:return r.getBitsLength(S);case e.KANJI:return i.getBitsLength(S);case e.BYTE:return s.getBitsLength(S)}}function y(S){return S.reduce(function(T,j){const M=T.length-1>=0?T[T.length-1]:null;return M&&M.mode===j.mode?(T[T.length-1].data+=j.data,T):(T.push(j),T)},[])}function b(S){const T=[];for(let j=0;j<S.length;j++){const M=S[j];switch(M.mode){case e.NUMERIC:T.push([M,{data:M.data,mode:e.ALPHANUMERIC,length:M.length},{data:M.data,mode:e.BYTE,length:M.length}]);break;case e.ALPHANUMERIC:T.push([M,{data:M.data,mode:e.BYTE,length:M.length}]);break;case e.KANJI:T.push([M,{data:M.data,mode:e.BYTE,length:f(M.data)}]);break;case e.BYTE:T.push([{data:M.data,mode:e.BYTE,length:f(M.data)}])}}return T}function v(S,T){const j={},M={start:{}};let _=["start"];for(let R=0;R<S.length;R++){const O=S[R],L=[];for(let A=0;A<O.length;A++){const F=O[A],H=""+R+A;L.push(H),j[H]={node:F,lastCount:0},M[H]={};for(let P=0;P<_.length;P++){const B=_[P];j[B]&&j[B].node.mode===F.mode?(M[B][H]=m(j[B].lastCount+F.length,F.mode)-m(j[B].lastCount,F.mode),j[B].lastCount+=F.length):(j[B]&&(j[B].lastCount=F.length),M[B][H]=m(F.length,F.mode)+4+e.getCharCountIndicator(F.mode,T))}}_=L}for(let R=0;R<_.length;R++)M[_[R]].end=0;return{map:M,table:j}}function w(S,T){let j;const M=e.getBestModeForData(S);if(j=e.from(T,M),j!==e.BYTE&&j.bit<M.bit)throw new Error('"'+S+'" cannot be encoded with mode '+e.toString(j)+`.
 Suggested mode is: `+e.toString(M));switch(j===e.KANJI&&!l.isKanjiModeEnabled()&&(j=e.BYTE),j){case e.NUMERIC:return new n(S);case e.ALPHANUMERIC:return new r(S);case e.KANJI:return new i(S);case e.BYTE:return new s(S)}}t.fromArray=function(T){return T.reduce(function(j,M){return typeof M=="string"?j.push(w(M,null)):M.data&&j.push(w(M.data,M.mode)),j},[])},t.fromString=function(T,j){const M=g(T,l.isKanjiModeEnabled()),_=b(M),R=v(_,j),O=d.find_path(R.map,"start","end"),L=[];for(let A=1;A<O.length-1;A++)L.push(R.table[O[A]].node);return t.fromArray(y(L))},t.rawSplit=function(T){return t.fromArray(g(T,l.isKanjiModeEnabled()))}})(Yy)),Yy}var QT;function oZ(){if(QT)return Ly;QT=1;const t=No(),e=u1(),n=VJ(),r=KJ(),s=QJ(),i=WJ(),o=YJ(),l=$5(),d=JJ(),f=ZJ(),p=eZ(),g=To(),m=aZ();function y(R,O){const L=R.size,A=i.getPositions(O);for(let F=0;F<A.length;F++){const H=A[F][0],P=A[F][1];for(let B=-1;B<=7;B++)if(!(H+B<=-1||L<=H+B))for(let E=-1;E<=7;E++)P+E<=-1||L<=P+E||(B>=0&&B<=6&&(E===0||E===6)||E>=0&&E<=6&&(B===0||B===6)||B>=2&&B<=4&&E>=2&&E<=4?R.set(H+B,P+E,!0,!0):R.set(H+B,P+E,!1,!0))}}function b(R){const O=R.size;for(let L=8;L<O-8;L++){const A=L%2===0;R.set(L,6,A,!0),R.set(6,L,A,!0)}}function v(R,O){const L=s.getPositions(O);for(let A=0;A<L.length;A++){const F=L[A][0],H=L[A][1];for(let P=-2;P<=2;P++)for(let B=-2;B<=2;B++)P===-2||P===2||B===-2||B===2||P===0&&B===0?R.set(F+P,H+B,!0,!0):R.set(F+P,H+B,!1,!0)}}function w(R,O){const L=R.size,A=f.getEncodedBits(O);let F,H,P;for(let B=0;B<18;B++)F=Math.floor(B/3),H=B%3+L-8-3,P=(A>>B&1)===1,R.set(F,H,P,!0),R.set(H,F,P,!0)}function S(R,O,L){const A=R.size,F=p.getEncodedBits(O,L);let H,P;for(H=0;H<15;H++)P=(F>>H&1)===1,H<6?R.set(H,8,P,!0):H<8?R.set(H+1,8,P,!0):R.set(A-15+H,8,P,!0),H<8?R.set(8,A-H-1,P,!0):H<9?R.set(8,15-H-1+1,P,!0):R.set(8,15-H-1,P,!0);R.set(A-8,8,1,!0)}function T(R,O){const L=R.size;let A=-1,F=L-1,H=7,P=0;for(let B=L-1;B>0;B-=2)for(B===6&&B--;;){for(let E=0;E<2;E++)if(!R.isReserved(F,B-E)){let K=!1;P<O.length&&(K=(O[P]>>>H&1)===1),R.set(F,B-E,K),H--,H===-1&&(P++,H=7)}if(F+=A,F<0||L<=F){F-=A,A=-A;break}}}function j(R,O,L){const A=new n;L.forEach(function(E){A.put(E.mode.bit,4),A.put(E.getLength(),g.getCharCountIndicator(E.mode,R)),E.write(A)});const F=t.getSymbolTotalCodewords(R),H=l.getTotalCodewordsCount(R,O),P=(F-H)*8;for(A.getLengthInBits()+4<=P&&A.put(0,4);A.getLengthInBits()%8!==0;)A.putBit(0);const B=(P-A.getLengthInBits())/8;for(let E=0;E<B;E++)A.put(E%2?17:236,8);return M(A,R,O)}function M(R,O,L){const A=t.getSymbolTotalCodewords(O),F=l.getTotalCodewordsCount(O,L),H=A-F,P=l.getBlocksCount(O,L),B=A%P,E=P-B,K=Math.floor(A/P),q=Math.floor(H/P),V=q+1,ie=K-q,Y=new d(ie);let X=0;const D=new Array(P),U=new Array(P);let te=0;const Z=new Uint8Array(R.buffer);for(let me=0;me<P;me++){const Se=me<E?q:V;D[me]=Z.slice(X,X+Se),U[me]=Y.encode(D[me]),X+=Se,te=Math.max(te,Se)}const re=new Uint8Array(A);let se=0,ge,be;for(ge=0;ge<te;ge++)for(be=0;be<P;be++)ge<D[be].length&&(re[se++]=D[be][ge]);for(ge=0;ge<ie;ge++)for(be=0;be<P;be++)re[se++]=U[be][ge];return re}function _(R,O,L,A){let F;if(Array.isArray(R))F=m.fromArray(R);else if(typeof R=="string"){let K=O;if(!K){const q=m.rawSplit(R);K=f.getBestVersionForData(q,L)}F=m.fromString(R,K||40)}else throw new Error("Invalid data");const H=f.getBestVersionForData(F,L);if(!H)throw new Error("The amount of data is too big to be stored in a QR Code");if(!O)O=H;else if(O<H)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+H+`.
`);const P=j(O,L,F),B=t.getSymbolSize(O),E=new r(B);return y(E,O),b(E),v(E,O),S(E,L,0),O>=7&&w(E,O),T(E,P),isNaN(A)&&(A=o.getBestMask(E,S.bind(null,E,L))),o.applyMask(A,E),S(E,L,A),{modules:E,version:O,errorCorrectionLevel:L,maskPattern:A,segments:F}}return Ly.create=function(O,L){if(typeof O>"u"||O==="")throw new Error("No input text");let A=e.M,F,H;return typeof L<"u"&&(A=e.from(L.errorCorrectionLevel,e.M),F=f.from(L.version),H=o.from(L.maskPattern),L.toSJISFunc&&t.setToSJISFunction(L.toSJISFunc)),_(O,F,A,H)},Ly}var tx={},nx={},WT;function V5(){return WT||(WT=1,(function(t){function e(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let r=n.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+n);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(i){return[i,i]}))),r.length===6&&r.push("F","F");const s=parseInt(r.join(""),16);return{r:s>>24&255,g:s>>16&255,b:s>>8&255,a:s&255,hex:"#"+r.slice(0,6).join("")}}t.getOptions=function(r){r||(r={}),r.color||(r.color={});const s=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,i=r.width&&r.width>=21?r.width:void 0,o=r.scale||4;return{width:i,scale:i?4:o,margin:s,color:{dark:e(r.color.dark||"#000000ff"),light:e(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},t.getScale=function(r,s){return s.width&&s.width>=r+s.margin*2?s.width/(r+s.margin*2):s.scale},t.getImageWidth=function(r,s){const i=t.getScale(r,s);return Math.floor((r+s.margin*2)*i)},t.qrToImageData=function(r,s,i){const o=s.modules.size,l=s.modules.data,d=t.getScale(o,i),f=Math.floor((o+i.margin*2)*d),p=i.margin*d,g=[i.color.light,i.color.dark];for(let m=0;m<f;m++)for(let y=0;y<f;y++){let b=(m*f+y)*4,v=i.color.light;if(m>=p&&y>=p&&m<f-p&&y<f-p){const w=Math.floor((m-p)/d),S=Math.floor((y-p)/d);v=g[l[w*o+S]?1:0]}r[b++]=v.r,r[b++]=v.g,r[b++]=v.b,r[b]=v.a}}})(nx)),nx}var YT;function lZ(){return YT||(YT=1,(function(t){const e=V5();function n(s,i,o){s.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(i,o,l){let d=l,f=o;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),o||(f=r()),d=e.getOptions(d);const p=e.getImageWidth(i.modules.size,d),g=f.getContext("2d"),m=g.createImageData(p,p);return e.qrToImageData(m.data,i,d),n(g,f,p),g.putImageData(m,0,0),f},t.renderToDataURL=function(i,o,l){let d=l;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),d||(d={});const f=t.render(i,o,d),p=d.type||"image/png",g=d.rendererOpts||{};return f.toDataURL(p,g.quality)}})(tx)),tx}var rx={},GT;function cZ(){if(GT)return rx;GT=1;const t=V5();function e(s,i){const o=s.a/255,l=i+'="'+s.hex+'"';return o<1?l+" "+i+'-opacity="'+o.toFixed(2).slice(1)+'"':l}function n(s,i,o){let l=s+i;return typeof o<"u"&&(l+=" "+o),l}function r(s,i,o){let l="",d=0,f=!1,p=0;for(let g=0;g<s.length;g++){const m=Math.floor(g%i),y=Math.floor(g/i);!m&&!f&&(f=!0),s[g]?(p++,g>0&&m>0&&s[g-1]||(l+=f?n("M",m+o,.5+y+o):n("m",d,0),d=0,f=!1),m+1<i&&s[g+1]||(l+=n("h",p),p=0)):d++}return l}return rx.render=function(i,o,l){const d=t.getOptions(o),f=i.modules.size,p=i.modules.data,g=f+d.margin*2,m=d.color.light.a?"<path "+e(d.color.light,"fill")+' d="M0 0h'+g+"v"+g+'H0z"/>':"",y="<path "+e(d.color.dark,"stroke")+' d="'+r(p,f,d.margin)+'"/>',b='viewBox="0 0 '+g+" "+g+'"',w='<svg xmlns="http://www.w3.org/2000/svg" '+(d.width?'width="'+d.width+'" height="'+d.width+'" ':"")+b+' shape-rendering="crispEdges">'+m+y+`</svg>
`;return typeof l=="function"&&l(null,w),w},rx}var XT;function uZ(){if(XT)return jl;XT=1;const t=HJ(),e=oZ(),n=lZ(),r=cZ();function s(i,o,l,d,f){const p=[].slice.call(arguments,1),g=p.length,m=typeof p[g-1]=="function";if(!m&&!t())throw new Error("Callback required as last argument");if(m){if(g<2)throw new Error("Too few arguments provided");g===2?(f=l,l=o,o=d=void 0):g===3&&(o.getContext&&typeof f>"u"?(f=d,d=void 0):(f=d,d=l,l=o,o=void 0))}else{if(g<1)throw new Error("Too few arguments provided");return g===1?(l=o,o=d=void 0):g===2&&!o.getContext&&(d=l,l=o,o=void 0),new Promise(function(y,b){try{const v=e.create(l,d);y(i(v,o,d))}catch(v){b(v)}})}try{const y=e.create(l,d);f(null,i(y,o,d))}catch(y){f(y)}}return jl.create=e.create,jl.toCanvas=s.bind(null,n.render),jl.toDataURL=s.bind(null,n.renderToDataURL),jl.toString=s.bind(null,function(i,o,l){return r.render(i,l)}),jl}var dZ=uZ();const fZ=Gl(dZ);function hZ(t){const[e,n]=C.useState(null),[r,s]=C.useState(null),[i,o]=C.useState(!1);return C.useEffect(()=>{if(!t){n(null),s(null);return}o(!0),s(null),fZ.toDataURL(t,{width:256,margin:2,color:{dark:"#000000",light:"#ffffff"}}).then(l=>{n(l),o(!1)}).catch(l=>{s(l),o(!1)})},[t]),{qrDataUrl:e,error:r,isLoading:i}}function pZ(){const t=Le();return De({mutationFn:e=>bW(e),onSuccess:()=>{t.invalidateQueries({queryKey:oc})}})}function gZ(){const t=Le();return De({mutationFn:({id:e,permissions:n})=>xW(e,n),onSuccess:()=>{t.invalidateQueries({queryKey:oc})}})}function mZ(){const t=Le();return De({mutationFn:({id:e,input:n})=>mW(e,n),onSuccess:()=>{t.invalidateQueries({queryKey:oc})}})}function yZ({isOpen:t,userName:e,token:n,onClose:r}){const s=C.useRef(null),{t:i}=ke("settings"),{showToast:o}=mt(),[l,d]=C.useState([]),[f,p]=C.useState(null),g=C.useMemo(()=>l.map(S=>({value:S.address,label:`${S.name} - ${S.address}`})),[l]);C.useEffect(()=>{t&&kW().then(S=>{d(S),S.length>0&&!f&&p(S[0])}).catch(()=>{d([])})},[t,f]);const m=t?f?SW(n,f.address):wW(n):null,{qrDataUrl:y,isLoading:b}=hZ(m);C.useEffect(()=>{const S=s.current;S&&(t?S.showModal():S.close())},[t]);const v=async()=>{m&&(await navigator.clipboard.writeText(m),o(i("sections.users.toast.urlCopied"),"success"))},w=S=>{S.target===s.current&&r()};return u.jsx("dialog",{ref:s,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800",onClose:r,onClick:w,children:u.jsxs("div",{className:"p-6 min-w-[350px] max-w-md",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:i("sections.users.modals.qrCode.title")}),u.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:u.jsx(nt,{size:20})})]}),u.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:[i("sections.users.modals.qrCode.userName"),":"," ",u.jsx("strong",{children:e})]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:i("sections.users.modals.qrCode.description")}),l.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("sections.users.modals.qrCode.networkInterface")}),u.jsx(An,{options:g,value:f?.address??null,onChange:S=>p(l.find(T=>T.address===S)??null),allowClear:!1})]}),u.jsx("div",{className:"flex justify-center mb-4 bg-white p-4 rounded-lg",children:b?u.jsx("div",{className:"w-64 h-64 flex items-center justify-center",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):y?u.jsx("img",{src:y,alt:"QR Code",className:"rounded-lg"}):null}),u.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3 mb-4",children:u.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:i("sections.users.modals.qrCode.warning")})}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:i("sections.users.modals.qrCode.manualUrl")}),u.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 dark:bg-gray-700 rounded-lg p-2",children:[u.jsx("code",{className:"text-xs flex-1 break-all text-gray-800 dark:text-gray-200",children:m}),u.jsx("button",{onClick:v,className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded",title:i("sections.users.actions.copyUrl"),children:u.jsx(ad,{size:16,className:"text-gray-600 dark:text-gray-400"})})]}),u.jsx("div",{className:"flex justify-end mt-6",children:u.jsx("button",{onClick:r,className:`px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg
              transition-colors`,children:i("sections.users.modals.qrCode.done")})})]})})}function xZ(){const{t}=ke("settings"),{showToast:e}=mt(),{data:n,isLoading:r,error:s}=UJ(),i=$J(),o=mZ(),l=qJ(),d=gZ(),f=pZ(),[p,g]=C.useState({type:"none"}),m=C.useRef(null);C.useEffect(()=>{const j=m.current;j&&(p.type==="create"||p.type==="edit"?j.showModal():j.close())},[p.type]);const y=async j=>{try{const M=await i.mutateAsync(j);g({type:"qr",user:M.user}),e(t("sections.users.toast.created"),"success")}catch{e(t("sections.users.toast.error"),"error")}},b=async j=>{if(p.type==="edit")try{await o.mutateAsync({id:p.user.id,input:{name:j.name}}),await d.mutateAsync({id:p.user.id,permissions:j.permissions}),g({type:"none"}),e(t("sections.users.toast.updated"),"success")}catch{e(t("sections.users.toast.error"),"error")}},v=async()=>{if(p.type==="delete")try{await l.mutateAsync(p.user.id),g({type:"none"}),e(t("sections.users.toast.deleted"),"success")}catch{e(t("sections.users.toast.error"),"error")}},w=async()=>{if(p.type==="regenerate")try{const j=await f.mutateAsync(p.user.id);g({type:"qr",user:j.user}),e(t("sections.users.toast.tokenRegenerated"),"success")}catch{e(t("sections.users.toast.error"),"error")}},S=async j=>{try{await o.mutateAsync({id:j.id,input:{isActive:!j.isActive}}),e(t("sections.users.toast.updated"),"success")}catch{e(t("sections.users.toast.error"),"error")}},T=j=>{g({type:"qr",user:j})};return r?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s?u.jsx("div",{className:"text-center py-8 text-red-500",children:t("sections.users.toast.error")}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t("sections.users.title")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("sections.users.description")})]}),u.jsxs("button",{onClick:()=>g({type:"create"}),className:`flex items-center gap-2 px-3 py-2 bg-indigo-600 hover:bg-indigo-700
            text-white rounded-lg transition-colors text-sm`,children:[u.jsx(Xt,{size:16}),t("sections.users.addUser")]})]}),n&&n.length>0?u.jsx("div",{className:"grid gap-3",children:n.map(j=>u.jsx(zJ,{user:j,onEdit:M=>g({type:"edit",user:M}),onDelete:M=>g({type:"delete",user:M}),onShowQR:T,onRegenerateToken:M=>g({type:"regenerate",user:M}),onToggleActive:S},j.id))}):u.jsxs("div",{className:"text-center py-12 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[u.jsx($l,{size:48,className:"mx-auto text-gray-400 dark:text-gray-500 mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:t("sections.users.noUsers")}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:t("sections.users.noUsersDescription")})]}),u.jsx("dialog",{ref:m,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-lg w-full max-h-[90vh] overflow-y-auto",onClose:()=>g({type:"none"}),onClick:j=>{j.target===m.current&&g({type:"none"})},children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:p.type==="create"?t("sections.users.modals.create.title"):t("sections.users.modals.edit.title")}),u.jsx("button",{onClick:()=>g({type:"none"}),className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:u.jsx(nt,{size:20})})]}),u.jsx(FJ,{user:p.type==="edit"?p.user:void 0,onSubmit:p.type==="create"?y:b,onCancel:()=>g({type:"none"}),isLoading:i.isPending||o.isPending},p.type==="edit"?p.user.id:"create")]})}),p.type==="qr"&&u.jsx(yZ,{isOpen:!0,userName:p.user.name,token:p.user.token,onClose:()=>g({type:"none"})}),p.type==="delete"&&u.jsx(fi,{isOpen:!0,title:t("sections.users.modals.delete.title"),message:t("sections.users.modals.delete.message",{name:p.user.name}),confirmLabel:t("sections.users.modals.delete.confirm"),cancelLabel:t("sections.users.modals.cancel"),onConfirm:v,onCancel:()=>g({type:"none"}),variant:"danger"}),p.type==="regenerate"&&u.jsx(fi,{isOpen:!0,title:t("sections.users.modals.regenerate.title"),message:t("sections.users.modals.regenerate.message",{name:p.user.name}),confirmLabel:t("sections.users.modals.regenerate.confirm"),cancelLabel:t("sections.users.modals.cancel"),onConfirm:w,onCancel:()=>g({type:"none"})})]})}const bZ=_n("/settings/")({component:vZ});function vZ(){const{t}=ke("settings"),{preference:e,setLanguagePreference:n,isLoading:r}=hW(),{preference:s,setThemePreference:i,isLoading:o}=MW(),l=[{value:"system",label:t("sections.language.options.system")},{value:"en",label:t("sections.language.options.english")},{value:"ro",label:t("sections.language.options.romanian")}],d=[{value:"system",label:t("sections.theme.options.system")},{value:"light",label:t("sections.theme.options.light")},{value:"dark",label:t("sections.theme.options.dark")}];return u.jsx(bd,{permission:"settings.view",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:t("title")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:t("sections.application.description")})]}),u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800 space-y-6",children:u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:t("sections.appearance.title")}),u.jsxs("div",{className:"space-y-2 mb-6",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(hD,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}),u.jsx("label",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t("sections.language.title")})]}),u.jsx(An,{options:l,value:e,onChange:f=>n(f),disabled:r,allowClear:!1}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-xs",children:t("sections.language.description")})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Gj,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}),u.jsx("label",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t("sections.theme.title")})]}),u.jsx(An,{options:d,value:s,onChange:f=>i(f),disabled:o,allowClear:!1}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-xs",children:t("sections.theme.description")})]})]})}),pn()&&u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800",children:u.jsx(kL,{})}),u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800",children:u.jsx(JK,{})}),u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800",children:u.jsx(eY,{})}),u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800",children:u.jsx(xZ,{})}),u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800",children:u.jsx(PE,{children:u.jsx(Kz,{})})}),u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800 space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("sections.apiDocs.title")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:t("sections.apiDocs.description")})]}),u.jsxs("a",{href:"http://localhost:3000/api/docs",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-indigo-600 dark:text-indigo-400 hover:underline text-sm",children:[u.jsx(Fp,{className:"w-4 h-4"}),t("sections.apiDocs.link")]})]}),D2()&&u.jsxs(u.Fragment,{children:[u.jsx("hr",{className:"border-gray-200 dark:border-gray-700"}),u.jsx(LJ,{})]}),D2()&&u.jsxs(u.Fragment,{children:[u.jsx("hr",{className:"border-gray-200 dark:border-gray-700"}),u.jsx(DJ,{})]})]})]})})}const wZ=_n("/schedules/")({component:SZ});function SZ(){const{t}=ke("schedules"),e=lr(),n=r=>{e({to:"/schedules/$scheduleId",params:{scheduleId:String(r)}})};return u.jsx(bd,{permission:"programs.view",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:t("title")}),u.jsxs("button",{type:"button",onClick:()=>e({to:"/schedules/$scheduleId",params:{scheduleId:"new"}}),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors",children:[u.jsx(Xt,{className:"w-5 h-5"}),t("actions.create")]})]}),u.jsx(e1,{onScheduleClick:n})]})})}const kZ=_n("/present/")({component:CZ});function CZ(){return u.jsx(bd,{permission:"control_room.view",children:u.jsx("div",{className:"h-full",children:u.jsx(AK,{})})})}const NZ={top:"bottom-full left-1/2 -translate-x-1/2 mb-2",bottom:"top-full left-1/2 -translate-x-1/2 mt-2",left:"right-full top-1/2 -translate-y-1/2 mr-2",right:"left-full top-1/2 -translate-y-1/2 ml-2"},TZ={top:"top-full left-1/2 -translate-x-1/2 border-t-gray-900 dark:border-t-gray-100 border-x-transparent border-b-transparent",bottom:"bottom-full left-1/2 -translate-x-1/2 border-b-gray-900 dark:border-b-gray-100 border-x-transparent border-t-transparent",left:"left-full top-1/2 -translate-y-1/2 border-l-gray-900 dark:border-l-gray-100 border-y-transparent border-r-transparent",right:"right-full top-1/2 -translate-y-1/2 border-r-gray-900 dark:border-r-gray-100 border-y-transparent border-l-transparent"};function sx({content:t,children:e,position:n="top"}){const[r,s]=C.useState(!1);return u.jsxs("div",{className:"relative inline-flex",onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:[e,r&&u.jsxs("div",{className:`absolute z-50 pointer-events-none ${NZ[n]}`,children:[u.jsx("div",{className:"px-2 py-1 text-xs font-medium text-white dark:text-gray-900 bg-gray-900 dark:bg-gray-100 rounded shadow-lg whitespace-nowrap",children:t}),u.jsx("div",{className:`absolute w-0 h-0 border-4 ${TZ[n]}`})]})]})}function jZ({className:t}){return u.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})})}function EZ({className:t}){return u.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z"})})}function MZ({className:t}){return u.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),u.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})}function AZ({className:t}){return u.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("polyline",{points:"20 6 9 17 4 12"})})}function RZ({progress:t,t:e}){return t.step==="error"?u.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("span",{className:"text-sm text-red-600 dark:text-red-400",children:t.error||e("errors.startStreamFailed")})})}):t.step==="completed"?null:u.jsx("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e(`stream.progress.${t.step}`)}),u.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.progress,"%"]})]}),u.jsx("div",{className:"w-full h-2 bg-gray-300 dark:bg-gray-700 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-blue-600 dark:bg-blue-400 transition-all duration-300",style:{width:`${t.progress}%`}})}),u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:t.message})]})})}function _Z(){const{t}=ke("livestream"),{activeBroadcast:e,isLoadingBroadcast:n,isStopping:r,streamStartProgress:s}=$p(),{isStreaming:i}=Fb(),{message:o,fetchMessage:l,copyMessage:d,copied:f,isLoading:p}=Sz();if(C.useEffect(()=>{e?.url&&!o&&!p&&l(e.url).catch(()=>{})},[e?.url]),s&&s.step!=="completed")return u.jsx(RZ,{progress:s,t});if(n)return u.jsx("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:u.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t("broadcast.loading")})});if(!e||!i||r)return null;const g=o||e.url,y=(v=>{const w=v.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&]+)/);return w?w[1]:null})(e.url),b=y?`https://studio.youtube.com/video/${y}/livestreaming`:null;return u.jsx("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:"relative flex-1 px-3 py-2 pr-10 text-sm bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg whitespace-pre-wrap break-words",children:[g,u.jsx(sx,{content:t(f?"broadcast.copied":"broadcast.copyToClipboard"),position:"left",children:u.jsx("button",{type:"button",onClick:()=>d(e.url),disabled:p,className:"absolute right-2 top-2 p-1.5 rounded-md text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors disabled:opacity-50",children:f?u.jsx(AZ,{className:"w-4 h-4 text-green-500"}):u.jsx(MZ,{className:"w-4 h-4"})})})]}),u.jsxs("div",{className:"flex gap-2 shrink-0",children:[u.jsx(sx,{content:t("broadcast.watchLive"),position:"bottom",children:u.jsx(it,{variant:"ghost",size:"icon",onClick:()=>wx(e.url),className:"text-red-600 hover:text-red-700 dark:text-red-500 dark:hover:text-red-400",children:u.jsx(jZ,{className:"w-5 h-5"})})}),b&&u.jsx(sx,{content:t("broadcast.openStudio"),position:"bottom",children:u.jsx(it,{variant:"ghost",size:"icon",onClick:()=>wx(b),className:"text-gray-600 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:u.jsx(EZ,{className:"w-5 h-5"})})})]})]})})}const OZ=[8,16,24,32];function IZ({isOpen:t,onClose:e}){const{t:n}=ke("livestream"),r=C.useRef(null),{config:s,update:i,isUpdating:o,testConnection:l,isTesting:d}=Bb(),{channels:f,update:p,isUpdating:g}=OE(),[m,y]=C.useState(""),[b,v]=C.useState(10024),[w,S]=C.useState(16),[T,j]=C.useState({}),[M,_]=C.useState("idle");C.useEffect(()=>{s&&(y(s.host),v(s.port),S(s.channelCount))},[s]),C.useEffect(()=>{const F={};for(const H of f)F[H.channelNumber]=H.label;j(F)},[f]),C.useEffect(()=>{const F=r.current;F&&(t?F.showModal():F.close())},[t]);const R=F=>{F.target===r.current&&e()},O=async()=>{_("idle");try{const F=await l();_(F.success?"success":"error")}catch{_("error")}},L=(F,H)=>{j(P=>({...P,[F]:H}))},A=async()=>{i({host:m,port:b,isEnabled:s?.isEnabled??!1,channelCount:w});const F=Object.entries(T).filter(([,H])=>H.trim()!=="").map(([H,P])=>({channelNumber:Number.parseInt(H,10),label:P.trim()}));F.length>0&&p(F),e()};return u.jsx("dialog",{ref:r,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-lg w-full",onClose:e,onClick:R,children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n("mixer.setup.title")}),u.jsx("button",{type:"button",onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"space-y-6 max-h-[60vh] overflow-y-auto",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:n("mixer.setup.connectionSettings")}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-600 dark:text-gray-400 mb-1",children:n("mixer.setup.host")}),u.jsx("input",{type:"text",value:m,onChange:F=>y(F.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"192.168.0.50"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-600 dark:text-gray-400 mb-1",children:n("mixer.setup.port")}),u.jsx("input",{type:"number",value:b,onChange:F=>v(Number.parseInt(F.target.value,10)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"10024"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(it,{variant:"secondary",size:"sm",onClick:O,disabled:d||!m,children:n(d?"mixer.setup.testing":"mixer.setup.testConnection")}),M==="success"&&u.jsx("span",{className:"text-sm text-green-600 dark:text-green-400",children:n("mixer.setup.testSuccess")}),M==="error"&&u.jsx("span",{className:"text-sm text-red-600 dark:text-red-400",children:n("mixer.setup.testFailed")})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:n("mixer.setup.channelConfiguration")}),u.jsxs("div",{className:"mb-3",children:[u.jsx("label",{className:"block text-sm text-gray-600 dark:text-gray-400 mb-1",children:n("mixer.setup.channelCount")}),u.jsx("select",{value:w,onChange:F=>S(Number.parseInt(F.target.value,10)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:OZ.map(F=>u.jsx("option",{value:F,children:F},F))})]}),u.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:Array.from({length:w},(F,H)=>H+1).map(F=>u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("span",{className:"w-8 text-sm text-gray-500 dark:text-gray-400 text-right",children:[F.toString().padStart(2,"0"),":"]}),u.jsx("input",{type:"text",value:T[F]||"",onChange:H=>L(F,H.target.value),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:`CH${F.toString().padStart(2,"0")}`})]},F))})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx(it,{variant:"ghost",onClick:e,children:n("common:buttons.cancel","Cancel")}),u.jsx(it,{onClick:A,disabled:o||g,children:n("mixer.setup.save")})]})]})})}const DZ=5e3,LZ=1e3;function zZ(){const{t}=ke("livestream"),{config:e,update:n,isUpdating:r,testConnection:s,isTesting:i}=Bb(),[o,l]=C.useState(!1),[d,f]=C.useState(!1),[p,g]=C.useState("idle"),[m,y]=C.useState(!1),[b,v]=C.useState(!1),w=C.useRef(null),S=C.useRef(null),T=C.useRef(null),j=e?.isEnabled??!1,M=r||i||b&&!m;C.useEffect(()=>{if(!o)return;const B=E=>{w.current&&!w.current.contains(E.target)&&S.current&&!S.current.contains(E.target)&&l(!1)};return document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[o]),C.useEffect(()=>{if(!o)return;const B=E=>{E.key==="Escape"&&l(!1)};return document.addEventListener("keydown",B),()=>document.removeEventListener("keydown",B)},[o]);const _=C.useRef(!1),R=C.useRef(!1);C.useEffect(()=>{R.current=m},[m]);const O=C.useCallback(async()=>{if(!(!e?.host||_.current)){_.current=!0,R.current||v(!0);try{const B=await _E();B.success!==R.current&&y(B.success)}catch{R.current&&y(!1)}finally{_.current=!1,R.current||v(!1)}}},[e?.host]);C.useEffect(()=>{if(!j||!e?.host){R.current&&y(!1),T.current&&(clearTimeout(T.current),T.current=null);return}let B=!0;const E=async()=>{if(!B||(await O(),!B))return;const K=R.current?DZ:LZ;T.current=setTimeout(E,K)};return E(),()=>{B=!1,T.current&&(clearTimeout(T.current),T.current=null)}},[j,e?.host,O]);function L(){M||l(!o)}function A(){l(!1),f(!0)}async function F(){g("idle");try{const B=await s();g(B.success?"success":"error"),setTimeout(()=>g("idle"),3e3)}catch{g("error"),setTimeout(()=>g("idle"),3e3)}}function H(){e&&(n({...e,isEnabled:!e.isEnabled}),l(!1))}function P(){return i||b&&!m?t("mixer.testing"):j&&m?t("mixer.connected").replace("Mixer ",""):j&&!m?t("mixer.reconnecting"):t("mixer.disconnected").replace("Mixer ","")}return u.jsxs("div",{className:"relative",children:[u.jsxs("button",{ref:S,type:"button",onClick:L,disabled:M,className:`
          inline-flex items-center gap-1.5 sm:gap-2 px-2 py-1 sm:px-3 sm:py-1.5 rounded-full text-sm font-medium
          transition-all duration-200 ease-in-out
          ${m?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-900/50":j&&!m?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":i?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 cursor-wait":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}
          ${M?"opacity-75 cursor-wait":"cursor-pointer"}
        `,children:[u.jsxs("div",{className:"relative flex items-center gap-1.5 sm:gap-2",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})}),u.jsx("span",{className:"font-medium",children:t("mixer.title")})]}),u.jsx("span",{className:"text-xs opacity-75 hidden sm:inline",children:P()}),(i||j&&!m)&&u.jsx("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"})]}),o&&u.jsxs("div",{ref:w,className:"absolute left-0 top-full mt-2 z-50 min-w-[140px] bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-1.5 space-y-1",children:[u.jsxs("button",{type:"button",onClick:A,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),t("mixer.setup.title")]}),e?.host&&u.jsxs("button",{type:"button",onClick:F,disabled:i,className:`w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left rounded-lg transition-colors ${p==="success"?"text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20":p==="error"?"text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p==="success"?u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}):p==="error"?u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"})}),t(i?"mixer.setup.testing":p==="success"?"mixer.setup.testSuccess":p==="error"?"mixer.setup.testFailed":"mixer.setup.testConnection")]}),u.jsxs("button",{type:"button",onClick:H,disabled:r||!e?.host,className:`w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left rounded-lg transition-colors ${e?.host?j?"text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20":"text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20":"text-gray-400 dark:text-gray-500 cursor-not-allowed"}`,children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:j?u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"}):u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.636 18.364a9 9 0 010-12.728m12.728 0a9 9 0 010 12.728M12 9v2m0 4h.01"})}),t(j?"mixer.disable":"mixer.enable")]})]}),u.jsx(IZ,{isOpen:d,onClose:()=>f(!1)})]})}function PZ(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let n=0;n<16;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}function BZ({isOpen:t,onClose:e}){const{t:n}=ke("livestream"),r=C.useRef(null),{config:s,update:i,isUpdating:o}=jz(),[l,d]=C.useState(!1),f=C.useMemo(()=>PZ(),[]),p=s?.password||f;C.useEffect(()=>{const b=r.current;b&&(t?b.showModal():b.close())},[t]);const g=b=>{b.target===r.current&&e()},m=async()=>{await navigator.clipboard.writeText(p),d(!0),setTimeout(()=>d(!1),2e3)},y=()=>{s?.password||i({host:s?.host||"localhost",port:s?.port||4455,password:f,autoConnect:s?.autoConnect??!0}),e()};return u.jsx("dialog",{ref:r,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-lg w-full",onClose:e,onClick:g,children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n("obs.setup.title")}),u.jsx("button",{type:"button",onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:n("obs.setup.step1Title")}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:n("obs.setup.step1Description")}),u.jsxs("a",{href:"https://github.com/obsproject/obs-websocket/releases",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-indigo-600 dark:text-indigo-400 hover:underline text-sm",children:[u.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"})}),n("obs.setup.downloadLink")]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:n("obs.setup.step2Title")}),u.jsxs("ol",{className:"text-sm text-gray-600 dark:text-gray-400 list-decimal list-inside space-y-1",children:[u.jsx("li",{children:n("obs.setup.step2Instruction1")}),u.jsx("li",{children:n("obs.setup.step2Instruction2")}),u.jsx("li",{children:n("obs.setup.step2Instruction3")})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:n("obs.setup.step3Title")}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:n("obs.setup.step3Description")}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("code",{className:"flex-1 px-3 py-2 bg-gray-100 dark:bg-gray-700 rounded text-sm font-mono text-gray-900 dark:text-gray-100 break-all",children:p}),u.jsx(it,{variant:"secondary",size:"sm",onClick:m,children:n(l?"obs.setup.copied":"obs.setup.copy")})]})]}),u.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:u.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[u.jsx("strong",{children:n("obs.setup.noteTitle")})," ",n("obs.setup.noteDescription")]})})]}),u.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx(it,{variant:"ghost",onClick:e,children:n("common:buttons.cancel","Cancel")}),u.jsx(it,{onClick:y,disabled:o,children:n("obs.setup.saveAndClose")})]})]})})}function FZ(){const{t}=ke("livestream"),{isConnected:e,isConnecting:n,isDisconnecting:r,connect:s,disconnect:i}=Fb(),[o,l]=C.useState(!1),[d,f]=C.useState(!1),p=C.useRef(null),g=C.useRef(null),m=n||r;C.useEffect(()=>{if(!d)return;const S=T=>{p.current&&!p.current.contains(T.target)&&g.current&&!g.current.contains(T.target)&&f(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[d]),C.useEffect(()=>{if(!d)return;const S=T=>{T.key==="Escape"&&f(!1)};return document.addEventListener("keydown",S),()=>document.removeEventListener("keydown",S)},[d]);function y(){m||f(!d)}function b(){f(!1),s()}function v(){f(!1),i()}function w(){f(!1),l(!0)}return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"relative",children:[u.jsxs("button",{ref:g,type:"button",onClick:y,disabled:m,className:`
            inline-flex items-center gap-1.5 sm:gap-2 px-2 py-1 sm:px-3 sm:py-1.5 rounded-full text-sm font-medium
            transition-all duration-200 ease-in-out
            ${e?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-900/50":n?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 cursor-wait":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}
            ${m?"opacity-75 cursor-wait":"cursor-pointer"}
          `,children:[u.jsxs("div",{className:"relative flex items-center gap-1.5 sm:gap-2",children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${e?"bg-green-500":n?"bg-yellow-500 animate-pulse":"bg-gray-400 dark:bg-gray-500"}`}),u.jsxs("span",{className:"font-medium",children:[u.jsx("span",{className:"sm:hidden",children:"OBS"}),u.jsx("span",{className:"hidden sm:inline",children:"OBS Studio"})]})]}),u.jsx("span",{className:"text-xs opacity-75 hidden sm:inline",children:n?t("obs.connecting"):r?t("obs.disconnect")+"...":e?t("obs.connected").replace("OBS ",""):t("obs.disconnected").replace("OBS ","")})]}),d&&u.jsx("div",{ref:p,className:"absolute left-0 top-full mt-2 z-50 min-w-[140px] bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-1.5 space-y-1",children:e?u.jsxs("button",{type:"button",onClick:v,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),t("obs.disconnect")]}):u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:b,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),t("obs.connect")]}),u.jsxs("button",{type:"button",onClick:w,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t("obs.openGuide")]})]})})]}),u.jsx(BZ,{isOpen:o,onClose:()=>l(!1)})]})}function UZ({scene:t,onSwitch:e}){const{t:n}=ke("livestream");return u.jsxs("div",{className:`
        relative p-4 rounded-lg border-2 transition-all cursor-pointer
        ${t.isCurrent?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-gray-300 dark:hover:border-gray-600"}
      `,onClick:()=>e(t.obsSceneName),children:[t.isCurrent&&u.jsx("div",{className:"absolute -top-2 -right-2 px-2 py-0.5 text-xs font-bold text-white bg-indigo-500 rounded-full",children:n("scenes.current")}),u.jsx("div",{children:u.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:t.displayName})})]})}function $Z({scene:t,onOpenSettings:e}){const{t:n}=ke("livestream"),{attributes:r,listeners:s,setNodeRef:i,transform:o,transition:l,isDragging:d}=wo({id:t.id}),f={transform:us.Transform.toString(o),transition:l,opacity:d?.5:1},p=t.shortcuts&&t.shortcuts.length>0;return u.jsxs("div",{ref:i,style:f,className:`
        flex items-center gap-3 p-3 bg-white dark:bg-gray-800
        border border-gray-200 dark:border-gray-700 rounded-lg
        ${d?"shadow-lg ring-2 ring-indigo-500":""}
        ${t.isVisible?"":"opacity-60"}
      `,children:[u.jsx("button",{type:"button",className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 cursor-grab active:cursor-grabbing",...r,...s,children:u.jsx(cr,{size:20})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate block",children:t.displayName}),u.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.displayName!==t.obsSceneName&&u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:t.obsSceneName}),p&&u.jsx("div",{className:"flex flex-wrap gap-1",children:t.shortcuts.map(g=>u.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded",children:UE(g)},g))})]})]}),u.jsx("button",{type:"button",onClick:e,className:"p-2 text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 rounded-lg transition-colors",title:n("scenes.settings"),children:u.jsx(di,{size:18})})]})}const JT=[{value:"song",labelKey:"scenes.contentTypes.song"},{value:"bible",labelKey:"scenes.contentTypes.bible"},{value:"bible_passage",labelKey:"scenes.contentTypes.biblePassage"},{value:"announcement",labelKey:"scenes.contentTypes.announcement"},{value:"versete_tineri",labelKey:"scenes.contentTypes.verseteTineri"},{value:"empty",labelKey:"scenes.contentTypes.empty"}];function ZT(t,e,n){for(const r of n)if(r.id!==e&&r.shortcuts?.includes(t))return{shortcut:t,conflictingSceneName:r.displayName};return null}function qZ({scene:t,allScenes:e,youtubeConfig:n,onUpdateYouTubeConfig:r,onClose:s,onSave:i}){const{t:o}=ke("livestream"),{config:l}=Bb(),{channels:d}=OE(),f=Array.from({length:l?.channelCount??0},(X,D)=>{const U=D+1,te=d.find(Z=>Z.channelNumber===U);return{channelNumber:U,label:te?.label||""}}),[p,g]=C.useState(t.displayName),[m,y]=C.useState(t.isVisible),[b,v]=C.useState(t.shortcuts||[]),[w,S]=C.useState(t.contentTypes||[]),[T,j]=C.useState(t.mixerChannelActions?.mute||[]),[M,_]=C.useState(t.mixerChannelActions?.unmute||[]),[R,O]=C.useState({}),L=C.useCallback(()=>{v(X=>[...X,""])},[]),A=C.useCallback(X=>{v(D=>D.filter((U,te)=>te!==X)),O(D=>{const U={...D};return delete U[X],U})},[]),F=C.useCallback((X,D)=>{const U=[...b];U[X]=D,v(U);const te=ZT(D,t.id,e);O(te?Z=>({...Z,[X]:o("scenes.shortcutConflict",{scene:te.conflictingSceneName})}):Z=>{const re={...Z};return delete re[X],re})},[b,t.id,e,o]),H=C.useCallback(()=>{const X=b.filter(U=>U.length>0);let D=!1;for(const U of X)if(ZT(U,t.id,e)){D=!0;break}D||i({displayName:p.trim()||t.obsSceneName,isVisible:m,shortcuts:X,contentTypes:w,mixerChannelActions:{mute:T,unmute:M}})},[p,m,b,w,T,M,t,e,i]),P=n?.startSceneName===t.obsSceneName,B=n?.stopSceneName===t.obsSceneName,E=C.useCallback(()=>{r&&r(P?{startSceneName:null}:{startSceneName:t.obsSceneName,...B&&{stopSceneName:null}})},[P,B,t.obsSceneName,r]),K=C.useCallback(()=>{r&&r(B?{stopSceneName:null}:{stopSceneName:t.obsSceneName,...P&&{startSceneName:null}})},[P,B,t.obsSceneName,r]),q=C.useCallback(X=>{S(D=>D.includes(X)?D.filter(U=>U!==X):[...D,X])},[]),V=C.useCallback(X=>{j(D=>D.includes(X)?D.filter(U=>U!==X):[...D,X]),_(D=>D.filter(U=>U!==X))},[]),ie=C.useCallback(X=>{_(D=>D.includes(X)?D.filter(U=>U!==X):[...D,X]),j(D=>D.filter(U=>U!==X))},[]),Y=Object.keys(R).length>0;return u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/50",onClick:X=>X.target===X.currentTarget&&s(),children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md mx-4 max-h-[80vh] flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:o("scenes.sceneSettings",{defaultValue:"Scene Settings"})}),u.jsx("button",{type:"button",onClick:s,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:u.jsx(nt,{size:20})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o("scenes.displayName")}),u.jsx("input",{id:"displayName",type:"text",value:p,onChange:X=>g(X.target.value),placeholder:t.obsSceneName,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500"}),t.displayName!==t.obsSceneName&&u.jsxs("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["OBS: ",t.obsSceneName]})]}),u.jsx("div",{children:u.jsxs("button",{type:"button",onClick:()=>y(!m),className:`
                flex items-center gap-3 w-full px-3 py-2 rounded-lg transition-colors
                ${m?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}
              `,children:[m?u.jsx(pa,{size:20}):u.jsx(Jl,{size:20}),u.jsx("span",{className:"text-sm font-medium",children:o(m?"scenes.visible":"scenes.hidden")})]})}),u.jsxs("div",{children:[u.jsx("div",{className:"flex items-center justify-between mb-2",children:u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:o("scenes.shortcuts")})}),b.length===0?u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:o("scenes.noShortcuts")}):u.jsx("div",{className:"space-y-2 mb-2",children:b.map((X,D)=>u.jsxs("div",{children:[u.jsx($E,{value:X,onChange:U=>F(D,U),onRemove:()=>A(D),error:R[D],namespace:"livestream"}),R[D]&&u.jsx("p",{className:"mt-1 text-xs text-red-500",children:R[D]})]},D))}),u.jsxs("button",{type:"button",onClick:L,className:"flex items-center gap-2 text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300",children:[u.jsx(Xt,{size:16}),o("scenes.addShortcut")]})]}),n&&r&&u.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:o("scenes.streamSceneSettings")}),u.jsxs("button",{type:"button",onClick:E,className:`
                  flex items-center gap-3 w-full px-3 py-2 rounded-lg transition-colors mb-2
                  ${P?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}
                `,children:[u.jsx(Mb,{size:20}),u.jsxs("div",{className:"flex-1 text-left",children:[u.jsx("span",{className:"text-sm font-medium block",children:o("scenes.useAsStartScene")}),u.jsx("span",{className:"text-xs opacity-75",children:o("scenes.useAsStartSceneDescription")})]})]}),u.jsxs("button",{type:"button",onClick:K,className:`
                  flex items-center gap-3 w-full px-3 py-2 rounded-lg transition-colors
                  ${B?"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}
                `,children:[u.jsx(tE,{size:20}),u.jsxs("div",{className:"flex-1 text-left",children:[u.jsx("span",{className:"text-sm font-medium block",children:o("scenes.useAsStopScene")}),u.jsx("span",{className:"text-xs opacity-75",children:o("scenes.useAsStopSceneDescription")})]})]})]}),u.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o("scenes.autoSceneSettings")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:o("scenes.autoSceneDescription")}),u.jsxs("div",{className:"flex flex-wrap gap-1.5 min-h-[36px] p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700",children:[w.map(X=>{const D=JT.find(U=>U.value===X);return u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-400 rounded-full",children:[D?o(D.labelKey):X,u.jsx("button",{type:"button",onClick:()=>q(X),className:"hover:text-indigo-900 dark:hover:text-indigo-200",children:u.jsx(nt,{size:12})})]},X)}),u.jsxs("select",{value:"",onChange:X=>{X.target.value&&q(X.target.value)},className:"flex-1 min-w-[100px] text-sm bg-transparent border-none outline-none text-gray-500 dark:text-gray-400 cursor-pointer",children:[u.jsx("option",{value:"",children:w.length===0?o("scenes.selectContentTypes"):o("scenes.addMore")}),JT.filter(X=>!w.includes(X.value)).map(({value:X,labelKey:D})=>u.jsx("option",{value:X,children:o(D)},X))]})]})]}),f.length>0&&u.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o("scenes.mixerActions")}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:o("scenes.mixerActionsDescription")}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(j6,{size:16,className:"text-green-600 dark:text-green-400"}),u.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:o("scenes.unmute")})]}),u.jsxs("div",{className:"flex flex-wrap gap-1.5 min-h-[36px] p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700",children:[M.map(X=>{const D=f.find(U=>U.channelNumber.toString().padStart(2,"0")===X);return u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-full",children:[D?.label||`CH${X}`,u.jsx("button",{type:"button",onClick:()=>ie(X),className:"hover:text-green-900 dark:hover:text-green-200",children:u.jsx(nt,{size:12})})]},X)}),u.jsxs("select",{value:"",onChange:X=>{X.target.value&&ie(X.target.value)},className:"flex-1 min-w-[100px] text-sm bg-transparent border-none outline-none text-gray-500 dark:text-gray-400 cursor-pointer",children:[u.jsx("option",{value:"",children:M.length===0?o("scenes.selectChannels"):o("scenes.addMore")}),f.filter(X=>!M.includes(X.channelNumber.toString().padStart(2,"0"))).map(X=>{const D=X.channelNumber.toString().padStart(2,"0");return u.jsx("option",{value:D,children:X.label||`CH${D}`},D)})]})]})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(M6,{size:16,className:"text-red-600 dark:text-red-400"}),u.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:o("scenes.mute")})]}),u.jsxs("div",{className:"flex flex-wrap gap-1.5 min-h-[36px] p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700",children:[T.map(X=>{const D=f.find(U=>U.channelNumber.toString().padStart(2,"0")===X);return u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-full",children:[D?.label||`CH${X}`,u.jsx("button",{type:"button",onClick:()=>V(X),className:"hover:text-red-900 dark:hover:text-red-200",children:u.jsx(nt,{size:12})})]},X)}),u.jsxs("select",{value:"",onChange:X=>{X.target.value&&V(X.target.value)},className:"flex-1 min-w-[100px] text-sm bg-transparent border-none outline-none text-gray-500 dark:text-gray-400 cursor-pointer",children:[u.jsx("option",{value:"",children:T.length===0?o("scenes.selectChannels"):o("scenes.addMore")}),f.filter(X=>!T.includes(X.channelNumber.toString().padStart(2,"0"))).map(X=>{const D=X.channelNumber.toString().padStart(2,"0");return u.jsx("option",{value:D,children:X.label||`CH${D}`},D)})]})]})]})]})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:o("common:buttons.cancel",{defaultValue:"Cancel"})}),u.jsx("button",{type:"button",onClick:H,disabled:Y,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 disabled:cursor-not-allowed rounded-lg transition-colors",children:o("common:buttons.save",{defaultValue:"Save"})})]})]})})}function HZ({scenes:t,onClose:e,onReorder:n,onUpdateScene:r}){const{t:s}=ke("livestream"),[i,o]=C.useState(null),{config:l,update:d}=$b(),f=mo(ar(xi),ar(yi,{coordinateGetter:So})),p=C.useCallback(b=>{const{active:v,over:w}=b;if(w&&v.id!==w.id){const S=t.findIndex(M=>M.id===v.id),T=t.findIndex(M=>M.id===w.id),j=ic(t,S,T);n(j.map(M=>M.id))}},[t,n]),g=C.useCallback(b=>{o(b)},[]),m=C.useCallback(()=>{o(null)},[]),y=C.useCallback(b=>{i&&(r(i.id,b),o(null))},[i,r]);return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:b=>b.target===b.currentTarget&&e(),children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-lg mx-4 max-h-[80vh] flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s("scenes.settings")}),u.jsx("button",{type:"button",onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:u.jsx(nt,{size:20})})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:u.jsx(xo,{sensors:f,collisionDetection:yo,onDragEnd:p,children:u.jsx(vo,{items:t.map(b=>b.id),strategy:bo,children:u.jsx("div",{className:"space-y-2",children:t.map(b=>u.jsx($Z,{scene:b,onOpenSettings:()=>g(b)},b.id))})})})})]})}),i&&u.jsx(qZ,{scene:i,allScenes:t,youtubeConfig:l,onUpdateYouTubeConfig:d,onClose:m,onSave:y})]})}function VZ(){const{t}=ke("livestream"),{scenes:e,isLoading:n,switchScene:r,reorderScenes:s,updateScene:i}=Ub(),[o,l]=C.useState(!1),d=e.filter(g=>g.isVisible),f=C.useCallback(g=>{s(g)},[s]),p=C.useCallback((g,m)=>{i({id:g,data:m})},[i]);return n?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(g=>u.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"},g))}):d.length===0?u.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 rounded-lg",children:u.jsx("p",{children:"No scenes available. Connect to OBS to see scenes."})}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("scenes.title")}),u.jsx("button",{type:"button",onClick:()=>l(!0),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:t("scenes.settings"),children:u.jsx(di,{size:20})})]}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:d.map(g=>u.jsx(UZ,{scene:g,onSwitch:r},g.id))})]}),o&&u.jsx(HZ,{scenes:e,onClose:()=>l(!1),onReorder:f,onUpdateScene:p})]})}function KZ(){const{t}=ke("livestream"),{isAuthenticated:e}=DE(),{isConnected:n,isStreaming:r}=Fb(),{start:s,stop:i,isStarting:o,isStopping:l,streamStartProgress:d}=$p(),f=e&&n&&!r,p=n&&r,g=d&&d.step!=="completed"&&d.step!=="error";return u.jsx("div",{className:"flex items-center gap-2 sm:gap-4",children:r?u.jsx(it,{variant:"danger",size:"lg",onClick:()=>i(),disabled:!p||l,className:"text-sm sm:text-base px-3 sm:px-4",children:t(l?"stream.stopping":"stream.stopStream")}):u.jsx(it,{variant:"primary",size:"lg",onClick:()=>s(),disabled:!f||o||!!g,className:"text-sm sm:text-base px-3 sm:px-4",children:t(o||g?"stream.starting":"stream.startStream")})})}function QZ(t){return new Date(t).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}function WZ(t){switch(t){case"public":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"unlisted":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"private":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-400"}}function YZ({selectedBroadcastId:t,onSelectBroadcast:e,enabled:n=!0}){const{t:r}=ke("livestream"),{broadcasts:s,isLoading:i,refetch:o,isRefetching:l}=LE(n);return i?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"})}):u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r("youtube.setup.templateDescription")}),u.jsx(it,{variant:"ghost",size:"sm",onClick:()=>o(),disabled:l,className:"flex-shrink-0",children:l?u.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),s.length>0&&u.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:s.map(d=>u.jsx("button",{type:"button",onClick:()=>e(d),className:`w-full text-left p-3 rounded-lg border-2 transition-colors ${t===d.broadcastId?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:u.jsxs("div",{className:"flex items-start justify-between gap-2",children:[u.jsxs("div",{className:"min-w-0 flex-1",children:[u.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:d.title}),d.description&&u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5 truncate",children:d.description}),u.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:[r("youtube.setup.completedAt")," ",QZ(d.completedAt)]})]}),u.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium flex-shrink-0 ${WZ(d.privacyStatus)}`,children:r(`youtube.privacy${d.privacyStatus.charAt(0).toUpperCase()+d.privacyStatus.slice(1)}`)})]})},d.broadcastId))}),s.length===0&&u.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-800 rounded-lg p-3",children:[u.jsx("p",{className:"font-medium",children:r("youtube.setup.noTemplates")}),u.jsx("p",{className:"text-xs mt-1",children:r("youtube.setup.noTemplatesHint")})]})]})}function GZ({isOpen:t,onClose:e}){const{t:n}=ke("livestream"),r=C.useRef(null),{config:s,update:i,isUpdating:o}=$b(),{broadcasts:l}=LE(t),[d,f]=C.useState(null),[p,g]=C.useState(null),[m,y]=C.useState(!1);C.useEffect(()=>{if(m||!s?.selectedBroadcastId||!l.length)return;const S=l.find(T=>T.broadcastId===s.selectedBroadcastId);S&&(f(S.broadcastId),g(S)),y(!0)},[s?.selectedBroadcastId,l,m]),C.useEffect(()=>{t||y(!1)},[t]);const b=S=>{f(S?.broadcastId??null),g(S),S&&i({titleTemplate:S.title,description:S.description,privacyStatus:S.privacyStatus,selectedBroadcastId:S.broadcastId})};C.useEffect(()=>{const S=r.current;S&&(t?S.showModal():S.close())},[t]);const v=S=>{S.target===r.current&&e()},w=()=>{wx("https://studio.youtube.com/channel/UC/livestreaming")};return u.jsx("dialog",{ref:r,className:"fixed inset-0 m-auto p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-white dark:bg-gray-800 max-w-lg w-full max-h-[90vh] overflow-hidden",onClose:e,onClick:v,children:u.jsxs("div",{className:"flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 pb-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n("youtube.setup.title")}),u.jsx("button",{type:"button",onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:n("youtube.setup.templateTitle")}),u.jsx(YZ,{selectedBroadcastId:d,onSelectBroadcast:b,enabled:t})]}),p&&u.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 border border-blue-200 dark:border-blue-800",children:[u.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[u.jsxs("strong",{children:[n("youtube.setup.usingTemplate"),":"]})," ",p.title]}),u.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-1",children:n("youtube.setup.usingTemplateHint")})]}),u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:n("youtube.setup.firstTimeTitle")}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:n("youtube.setup.firstTimeDescription")}),u.jsxs("button",{type:"button",onClick:w,className:"inline-flex items-center gap-2 text-red-600 dark:text-red-400 hover:underline text-sm font-medium",children:[u.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})}),n("youtube.setup.openYouTubeStudio")]})]})]}),u.jsx("div",{className:"flex justify-end gap-3 p-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:u.jsx(it,{variant:"ghost",onClick:e,disabled:o,children:n("youtube.setup.close")})})]})})}function XZ(){const{t}=ke("livestream"),{isAuthenticated:e,channelName:n,login:r,logout:s,isLoggingOut:i,isLoading:o,isAuthenticating:l}=DE(),{config:d}=$b(),[f,p]=C.useState(!1),[g,m]=C.useState(!1),[y,b]=C.useState(e),v=C.useRef(null),w=C.useRef(null),S=o||i||l;C.useEffect(()=>{!y&&e&&!d?.selectedBroadcastId&&m(!0),b(e)},[e,y,d?.selectedBroadcastId]),C.useEffect(()=>{if(!f)return;const O=L=>{v.current&&!v.current.contains(L.target)&&w.current&&!w.current.contains(L.target)&&p(!1)};return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[f]),C.useEffect(()=>{if(!f)return;const O=L=>{L.key==="Escape"&&p(!1)};return document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)},[f]);function T(){S||p(!f)}function j(){p(!1),r()}function M(){p(!1),s()}function _(){p(!1),m(!0)}function R(){return l?t("youtube.authenticating"):i?t("youtube.loggingOut"):e&&n?n:e?t("youtube.connected").replace("{{channelName}}","").trim():t("youtube.notConnected").replace("YouTube ","")}return u.jsxs("div",{className:"relative",children:[u.jsxs("button",{ref:w,type:"button",onClick:T,disabled:S,className:`
          inline-flex items-center gap-1.5 sm:gap-2 px-2 py-1 sm:px-3 sm:py-1.5 rounded-full text-sm font-medium
          transition-all duration-200 ease-in-out
          ${e?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-900/50":l?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 cursor-wait":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}
          ${S?"opacity-75 cursor-wait":"cursor-pointer"}
        `,children:[u.jsxs("div",{className:"relative flex items-center gap-1.5 sm:gap-2",children:[u.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})}),u.jsxs("span",{className:"font-medium",children:[u.jsx("span",{className:"sm:hidden",children:"YT"}),u.jsx("span",{className:"hidden sm:inline",children:"YouTube"})]})]}),u.jsx("span",{className:"text-xs opacity-75 max-w-[120px] truncate hidden sm:inline",children:R()}),l&&u.jsx("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"})]}),f&&u.jsx("div",{ref:v,className:"absolute left-0 top-full mt-2 z-50 min-w-[140px] bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-1.5 space-y-1",children:e?u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:_,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t("youtube.openGuide")]}),u.jsxs("button",{type:"button",onClick:M,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),t("youtube.logout")]})]}):u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:j,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),t("youtube.login")]}),u.jsxs("button",{type:"button",onClick:_,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t("youtube.openGuide")]})]})}),u.jsx(GZ,{isOpen:g,onClose:()=>m(!1)})]})}function JZ(){const{t}=ke("livestream"),{isLive:e}=$p();return RE(),u.jsxs("div",{className:"h-full overflow-auto p-4 md:p-6 space-y-4 md:space-y-6",children:[u.jsxs("div",{className:"flex flex-col gap-3 md:gap-4",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100",children:t("title")}),e&&u.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 px-1.5 sm:px-2 py-0.5 sm:py-1 bg-red-600 rounded-full animate-pulse",children:[u.jsx("div",{className:"w-1.5 sm:w-2 h-1.5 sm:h-2 bg-white rounded-full"}),u.jsx("span",{className:"text-[10px] sm:text-xs font-bold text-white",children:t("stream.isLive")})]})]}),u.jsx(KZ,{})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[u.jsx(XZ,{}),u.jsx(FZ,{}),u.jsx(zZ,{})]})]}),u.jsx(_Z,{}),u.jsx("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow",children:u.jsx(VZ,{})})]})}const ZZ=_n("/livestream/")({component:JZ}),eee=_n("/dashboard/")({component:tee});function tee(){return u.jsxs("div",{className:"space-y-6",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Dashboard"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-800",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Welcome"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Your dashboard is ready to use"})]})})]})}const nee=_n("/bible/")({component:ree});function ree(){const{t}=ke("bible"),{selectedTranslations:e,primaryTranslation:n,translations:r,isLoading:s}=tv(),i=wP(),o=qp(),[l,d]=C.useState(!1),[f,p]=C.useState(40),[g,m]=C.useState(!1),y=C.useRef(null),b=C.useRef(!1),v=C.useRef(!1);C.useEffect(()=>{const Y=()=>{m(window.innerWidth>=1024)};return Y(),window.addEventListener("resize",Y),()=>window.removeEventListener("resize",Y)},[]);const w=C.useRef(null),S=o8(n?.id),{data:T}=mi(),{data:j}=Qp(),M=j?.find(Y=>Y.id===T?.currentQueueItemId&&Y.itemType==="bible"&&Y.bibleVerseId),{data:_}=y8(M?.bibleVerseId??void 0),R=T?.temporaryContent?.type==="bible"?T.temporaryContent.data.translationId:void 0,{data:O=[]}=Kp(R);C.useEffect(()=>{n&&!S.state.translationId&&S.selectTranslation(n.id)},[n,S]),C.useEffect(()=>{if(!v.current){if(T?.temporaryContent?.type==="bible"){const Y=T.temporaryContent.data,X=O.find(D=>D.id===Y.bookId);X&&(v.current=!0,S.navigateToVerse({translationId:Y.translationId,bookId:Y.bookId,bookName:X.bookName,chapter:Y.chapter,verseIndex:Y.currentVerseIndex}));return}_&&(v.current=!0,S.navigateToVerse({translationId:_.translationId,bookId:_.bookId,bookName:_.bookName,chapter:_.chapter,verseIndex:_.verse-1}))}},[T,_,O,S]);const{data:L=[]}=s3(S.state.bookId,S.state.chapter),A=r.find(Y=>Y.id===S.state.translationId),F=C.useCallback(async(Y,X)=>{const D=jB(Y.bookName,Y.chapter,Y.verse,A?.abbreviation);await i.mutateAsync({verseId:Y.id,reference:D,text:Y.text,translationAbbreviation:A?.abbreviation||"",translationId:Y.translationId,bookId:Y.bookId,bookCode:Y.bookCode,chapter:Y.chapter,currentVerseIndex:X})},[A?.abbreviation,i]);C.useEffect(()=>{const{bookId:Y,chapter:X,presentedIndex:D}=S.state;if(!Y||!X||L.length===0)return;const U=w.current,te=U&&(U.bookId!==Y||U.chapter!==X);if(w.current={bookId:Y,chapter:X},te&&D!==null){const Z=Math.min(D,L.length-1),re=L[Z];re&&(Z!==D&&S.presentVerse(Z),F(re,Z))}},[S,L,F]);const H=C.useCallback(async(Y,X)=>{S.presentVerse(X),await F(Y,X)},[S,F]),P=C.useCallback(async Y=>{const X=Y.reference||`${Y.bookName} ${Y.chapter}:${Y.verse}`;await i.mutateAsync({verseId:Y.id,reference:X,text:Y.text,translationAbbreviation:A?.abbreviation||"",translationId:Y.translationId,bookId:Y.bookId,bookCode:Y.bookCode,chapter:Y.chapter,currentVerseIndex:Y.verse-1})},[A?.abbreviation,i]),B=C.useCallback(async()=>{const X=(S.state.presentedIndex??S.state.searchedIndex??-1)+1;if(X<L.length){S.nextVerse();const D=L[X];D&&await F(D,X);return}S.clearPresentation(),await o.mutateAsync()},[S,L,F,o]),E=C.useCallback(async()=>{const X=(S.state.presentedIndex??S.state.searchedIndex??0)-1;if(X>=0){S.previousVerse();const D=L[X];D&&await F(D,X)}},[S,L,F]),K=C.useCallback(async()=>{S.clearPresentation(),await o.mutateAsync()},[S,o]),q=C.useCallback(async()=>{const{searchedIndex:Y,presentedIndex:X}=S.state;if(Y!==null&&Y!==X){const D=L[Y];D&&(S.presentVerse(Y),await F(D,Y))}},[S,L,F]);a8({onNextVerse:B,onPreviousVerse:E,onGoBack:S.goBack,onHidePresentation:K,onPresentSearched:q,enabled:S.state.level==="verses"});const V=S.state.level==="verses"&&L.length>0,ie=C.useCallback(Y=>{Y.preventDefault(),b.current=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none";const X=U=>{if(!b.current||!y.current)return;const te=y.current.getBoundingClientRect(),Z=(U.clientX-te.left)/te.width*100;p(Math.min(80,Math.max(20,Z)))},D=()=>{b.current=!1,document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",X),document.removeEventListener("mouseup",D)};document.addEventListener("mousemove",X),document.addEventListener("mouseup",D)},[]);return u.jsx(bd,{permission:"bible.view",children:u.jsxs("div",{className:"flex flex-col h-full lg:overflow-hidden overflow-auto scrollbar-thin",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3 lg:mb-4 flex-shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(Sr,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"}),u.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:t("title")})]}),u.jsxs("button",{type:"button",onClick:()=>d(!0),className:"flex items-center gap-2 px-2 py-1.5 lg:px-3 text-sm bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-lg transition-colors",children:[u.jsx(di,{className:"w-4 h-4"}),u.jsx("span",{className:"hidden sm:inline",children:t("actions.settings")})]})]}),s?u.jsx("div",{className:"flex items-center justify-center flex-1",children:u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600 dark:text-indigo-400"})}):e.length>0?u.jsxs("div",{ref:y,className:"flex flex-col lg:flex-row lg:flex-1 lg:min-h-0 gap-3 lg:gap-0",children:[u.jsx("div",{className:"order-3 lg:order-1 lg:min-h-0 lg:h-full lg:flex-initial overflow-hidden",style:g?{width:`${f}%`}:void 0,children:u.jsx(x8,{navigation:S,onSelectVerse:H,onSelectSearchResult:P,onPresentSearched:q})}),u.jsx("div",{className:"hidden lg:flex items-center justify-center w-2 cursor-col-resize hover:bg-indigo-100 dark:hover:bg-indigo-900/30 transition-colors group",onMouseDown:ie,children:u.jsx(cr,{size:16,className:"text-gray-400 group-hover:text-indigo-500 transition-colors"})}),u.jsx("div",{className:"order-1 lg:order-2 lg:min-h-0 lg:flex-1 overflow-hidden",style:g?{width:`${100-f}%`}:void 0,children:u.jsx(HP,{onPrevVerse:E,onNextVerse:B,canNavigate:V})})]}):r.length>0?u.jsxs("div",{className:"text-center py-12 flex-1 flex flex-col items-center justify-center",children:[u.jsx(Sr,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:t("empty.noTranslationsSelected")}),u.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:t("empty.noTranslationsSelectedDescription")})]}):u.jsxs("div",{className:"text-center py-12 flex-1 flex flex-col items-center justify-center",children:[u.jsx(Sr,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:t("empty.title")}),u.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:t("empty.description")}),u.jsxs("button",{type:"button",onClick:()=>d(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors",children:[u.jsx(di,{className:"w-5 h-5"}),t("actions.openSettings")]})]}),u.jsx(TB,{isOpen:l,onClose:()=>d(!1)})]})})}const see=_n("/(root)/")({beforeLoad:()=>{throw xb({to:"/present"})}}),K5=_n("/screen/$screenId")({component:iee});function iee(){const{screenId:t}=K5.useParams(),e=Number.parseInt(t,10);return Number.isNaN(e)||e<=0?u.jsx("div",{className:"w-screen h-screen flex items-center justify-center bg-black text-white",children:u.jsx("p",{children:"Invalid screen ID"})}):u.jsx(BK,{screenId:e})}const Q5=_n("/schedules/$scheduleId")({component:aee});function aee(){const t=lr(),{scheduleId:e}=Q5.useParams(),r=e==="new"?null:parseInt(e,10),s=()=>{t({to:"/schedules"})},i=o=>{t({to:"/schedules/$scheduleId",params:{scheduleId:String(o)},replace:!0})};return u.jsx(rK,{scheduleId:r,onBack:s,onDeleted:s,onScheduleCreated:i})}const W5=_n("/custom-page/$pageId")({component:oee});function oee(){const{pageId:t}=W5.useParams();return u.jsx(GW,{pageId:t})}const Y5=_n("/songs/$songId/")({component:lee,beforeLoad:({params:t})=>{if(t.songId==="new")throw xb({to:"/songs/$songId/edit",params:{songId:"new"}})}});function lee(){const{t}=ke("songs"),e=lr(),{songId:n}=Y5.useParams(),r=parseInt(n,10),{data:s,isLoading:i}=Xb(r),o=QE(),l=WE(),d=YE(),{data:f}=mi(),[p,g]=C.useState(40),[m,y]=C.useState(!1),[b,v]=C.useState(!1),w=C.useRef(null),S=C.useRef(!1);C.useEffect(()=>{const B=()=>{v(window.innerWidth>=1024)};return B(),window.addEventListener("resize",B),()=>window.removeEventListener("resize",B)},[]);const T=f?.temporaryContent?.type==="song"&&f.temporaryContent.data.songId===r?f.temporaryContent.data.currentSlideIndex:null,j=C.useCallback(async(B,E)=>{if(T===E){e({to:"/songs/",search:{fromSong:!0}});return}await o.mutateAsync({songId:r,slideIndex:E})},[r,o,T,e]),M=C.useCallback(()=>{e({to:"/songs/"})},[e]),_=C.useCallback(async()=>{T!==null&&T>0&&await l.mutateAsync({direction:"prev"})},[T,l]),R=C.useCallback(async()=>{T!==null&&await l.mutateAsync({direction:"next"})},[T,l]),O=C.useCallback(async()=>{await d.mutateAsync()},[d]),L=C.useCallback(()=>{e({to:"/songs/$songId/edit",params:{songId:n}})},[e,n]),A=C.useCallback(B=>{e({to:"/schedules/$scheduleId",params:{scheduleId:String(B)}})},[e]);zP({onNextSlide:R,onPreviousSlide:_,onHidePresentation:O,enabled:T!==null});const F=C.useCallback(B=>{B.preventDefault(),S.current=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none";const E=q=>{if(!S.current||!w.current)return;const V=w.current.getBoundingClientRect(),ie=(q.clientX-V.left)/V.width*100;g(Math.min(80,Math.max(20,ie)))},K=()=>{S.current=!1,document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",K)};document.addEventListener("mousemove",E),document.addEventListener("mouseup",K)},[]);if(i||!s)return u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx(Qe,{className:"w-8 h-8 animate-spin text-indigo-600 dark:text-indigo-400"})});const H=T!==null&&T>0,P=T!==null;return u.jsxs("div",{className:"flex flex-col h-full lg:overflow-hidden overflow-auto scrollbar-thin",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3 lg:mb-4 flex-shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[u.jsx("button",{type:"button",onClick:M,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:u.jsx(id,{size:20,className:"text-gray-600 dark:text-gray-400"})}),u.jsx("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900 dark:text-white",children:s.title})]}),u.jsxs("div",{className:"hidden lg:flex items-center gap-2",children:[u.jsxs("button",{type:"button",onClick:()=>y(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",title:t("actions.addToSchedule"),children:[u.jsx(Th,{size:20}),u.jsx("span",{children:t("actions.addToSchedule")})]}),u.jsxs("button",{type:"button",onClick:L,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors",children:[u.jsx(to,{size:16}),u.jsx("span",{children:t("preview.edit")})]})]})]}),u.jsxs("div",{ref:w,className:"flex flex-col lg:flex-row lg:flex-1 lg:min-h-0 gap-3 lg:gap-0",children:[u.jsx("div",{className:"order-3 lg:order-1 lg:min-h-0 lg:h-full lg:flex-initial overflow-hidden bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-3 lg:p-4",style:b?{width:`${p}%`}:void 0,children:u.jsx(oQ,{song:s,presentedSlideIndex:T,isLoading:i,onSlideClick:j})}),u.jsx("div",{className:"hidden lg:flex items-center justify-center w-2 cursor-col-resize hover:bg-indigo-100 dark:hover:bg-indigo-900/30 transition-colors group",onMouseDown:F,children:u.jsx(cr,{size:16,className:"text-gray-400 group-hover:text-indigo-500 transition-colors"})}),u.jsx("div",{className:"order-1 lg:order-2 lg:min-h-0 lg:flex-1 overflow-hidden",style:b?{width:`${100-p}%`}:void 0,children:u.jsx(ZK,{songId:r,onPrevSlide:_,onNextSlide:R,canNavigatePrev:H,canNavigateNext:P})}),u.jsxs("div",{className:"order-2 lg:hidden flex items-center justify-center gap-2 py-2",children:[u.jsxs("button",{type:"button",onClick:()=>y(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",title:t("actions.addToSchedule"),children:[u.jsx(Th,{size:18}),u.jsx("span",{className:"text-sm",children:t("actions.addToSchedule")})]}),u.jsxs("button",{type:"button",onClick:L,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors",children:[u.jsx(to,{size:16}),u.jsx("span",{children:t("preview.edit")})]})]})]}),u.jsx(t1,{isOpen:m,songId:r,onClose:()=>y(!1),onAdded:A})]})}const cee={author:null,copyright:null,ccli:null,key:null,tempo:null,timeSignature:null,theme:null,altTheme:null,hymnNumber:null,keyLine:null,presentationOrder:null,sourceFilename:null},G5=_n("/songs/$songId/edit")({component:uee,validateSearch:t=>({q:typeof t.q=="string"?t.q:void 0})});function uee(){const{t}=ke(["songs","common"]),e=lr(),{songId:n}=G5.useParams(),{q:r}=rd({from:"/songs/$songId/edit"}),{showToast:s}=mt(),i=n==="new",o=i?null:parseInt(n,10),{data:l,isLoading:d}=Xb(o),f=Zb(),p=OP(),[g,m]=C.useState(""),[y,b]=C.useState(null),[v,w]=C.useState([]),[S,T]=C.useState(cee),[j,M]=C.useState(!1),{setSavedState:_,isDirty:R}=DP(),O=R({title:g,categoryId:y,slides:v,metadata:S});C.useEffect(()=>{if(l){m(l.title),b(l.categoryId);const q=l.slides.map(ie=>({id:ie.id,content:ie.content,sortOrder:ie.sortOrder,label:ie.label}));w(q);const V={author:l.author,copyright:l.copyright,ccli:l.ccli,key:l.key,tempo:l.tempo,timeSignature:l.timeSignature,theme:l.theme,altTheme:l.altTheme,hymnNumber:l.hymnNumber,keyLine:l.keyLine,presentationOrder:l.presentationOrder,sourceFilename:l.sourceFilename};T(V),_({title:l.title,categoryId:l.categoryId,slides:q,metadata:V})}},[l,_]);const L=C.useCallback((q,V)=>{T(ie=>({...ie,[q]:V}))},[]),A=C.useCallback(async()=>{if(!g.trim())return!1;const q=await f.mutateAsync({id:o??void 0,title:g.trim(),categoryId:y,slides:v.map((V,ie)=>({id:typeof V.id=="number"?V.id:void 0,content:V.content,sortOrder:ie,label:V.label})),author:S.author,copyright:S.copyright,ccli:S.ccli,key:S.key,tempo:S.tempo,timeSignature:S.timeSignature,theme:S.theme,altTheme:S.altTheme,hymnNumber:S.hymnNumber,keyLine:S.keyLine,presentationOrder:S.presentationOrder});if(q.success&&q.data){s(t("songs:messages.saved"),"success");const V=q.data.slides.map(Y=>({id:Y.id,content:Y.content,sortOrder:Y.sortOrder,label:Y.label})),ie={author:q.data.author,copyright:q.data.copyright,ccli:q.data.ccli,key:q.data.key,tempo:q.data.tempo,timeSignature:q.data.timeSignature,theme:q.data.theme,altTheme:q.data.altTheme,hymnNumber:q.data.hymnNumber,keyLine:q.data.keyLine,presentationOrder:q.data.presentationOrder};return _({title:q.data.title,categoryId:q.data.categoryId,slides:V,metadata:ie}),i?e({to:"/songs/$songId",params:{songId:String(q.data.id)}}):(w(V),T(ie)),!0}else return s(t("songs:messages.error"),"error"),!1},[g,y,v,S,o,i,f,s,t,e,_]);C.useEffect(()=>{const q=V=>{(V.metaKey||V.ctrlKey)&&V.key==="s"&&(V.preventDefault(),f.isPending||A())};return document.addEventListener("keydown",q),()=>document.removeEventListener("keydown",q)},[A,f.isPending]);const F=C.useCallback(()=>{e(i?{to:"/songs/",search:{q:r}}:{to:"/songs/$songId",params:{songId:n}})},[e,r,n,i]),H=async()=>{if(!o)return;M(!1),await p.mutateAsync(o)?(s(t("songs:messages.deleted"),"success"),e({to:"/songs/",search:{q:r}})):s(t("songs:messages.error"),"error")},{showModal:P,handleCancel:B,handleDiscard:E}=BP({isDirty:O}),K=!i&&d;return u.jsxs(u.Fragment,{children:[u.jsx(nQ,{isNew:i,isLoading:K,isSaving:f.isPending,isDeleting:p.isPending,isDirty:O,songId:o,title:g,categoryId:y,slides:v,metadata:S,presentationCount:l?.presentationCount,lastManualEdit:l?.lastManualEdit,onTitleChange:m,onCategoryChange:b,onSlidesChange:w,onMetadataChange:L,onSave:A,onDelete:i?void 0:()=>M(!0),onBack:F}),u.jsx(fi,{isOpen:j,title:t("songs:modal.deleteTitle"),message:t("songs:modal.deleteMessage"),confirmLabel:t("songs:actions.delete"),cancelLabel:t("common:buttons.cancel"),onConfirm:H,onCancel:()=>M(!1),variant:"danger"}),u.jsx(zQ,{isOpen:P,onDiscard:E,onCancel:B})]})}const X5=_n("/auth/youtube/callback")({validateSearch:t=>({accessToken:t.accessToken||"",refreshToken:t.refreshToken||"",expiresAt:t.expiresAt||"",channelId:t.channelId||"",channelName:t.channelName||"",error:t.error||""}),component:dee});function dee(){const{accessToken:t,refreshToken:e,expiresAt:n,channelId:r,channelName:s,error:i}=X5.useSearch(),o=lr(),[l,d]=C.useState("processing"),[f,p]=C.useState(null);return C.useEffect(()=>{async function g(){if(i){d("error"),p(i);return}if(!t||!e||!n){d("error"),p("Missing token data");return}try{await AE({accessToken:t,refreshToken:e,expiresAt:parseInt(n,10),channelId:r||void 0,channelName:s||void 0}),d("success"),setTimeout(()=>{o({to:"/livestream"})},1500)}catch(m){d("error"),p(m instanceof Error?m.message:"Failed to store tokens")}}g()},[t,e,n,i,o]),u.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background",children:u.jsxs("div",{className:"text-center",children:[l==="processing"&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"mb-4 h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent mx-auto"}),u.jsx("p",{className:"text-lg",children:"Connecting YouTube account..."})]}),l==="success"&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"mb-4 text-4xl",children:""}),u.jsx("p",{className:"text-lg text-green-600",children:"YouTube account connected successfully!"}),u.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Redirecting to livestream settings..."})]}),l==="error"&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"mb-4 text-4xl",children:""}),u.jsx("p",{className:"text-lg text-red-600",children:"Connection failed"}),u.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:f}),u.jsx("button",{onClick:()=>o({to:"/livestream"}),className:"mt-4 px-4 py-2 bg-primary text-primary-foreground rounded-md",children:"Go to Livestream Settings"})]})]})})}const fee=AJ.update({id:"/songs/",path:"/songs/",getParentRoute:()=>Vn}),hee=bZ.update({id:"/settings/",path:"/settings/",getParentRoute:()=>Vn}),pee=wZ.update({id:"/schedules/",path:"/schedules/",getParentRoute:()=>Vn}),gee=kZ.update({id:"/present/",path:"/present/",getParentRoute:()=>Vn}),mee=ZZ.update({id:"/livestream/",path:"/livestream/",getParentRoute:()=>Vn}),yee=eee.update({id:"/dashboard/",path:"/dashboard/",getParentRoute:()=>Vn}),xee=nee.update({id:"/bible/",path:"/bible/",getParentRoute:()=>Vn}),bee=see.update({id:"/(root)/",path:"/",getParentRoute:()=>Vn}),vee=K5.update({id:"/screen/$screenId",path:"/screen/$screenId",getParentRoute:()=>Vn}),wee=Q5.update({id:"/schedules/$scheduleId",path:"/schedules/$scheduleId",getParentRoute:()=>Vn}),See=W5.update({id:"/custom-page/$pageId",path:"/custom-page/$pageId",getParentRoute:()=>Vn}),kee=Y5.update({id:"/songs/$songId/",path:"/songs/$songId/",getParentRoute:()=>Vn}),Cee=G5.update({id:"/songs/$songId/edit",path:"/songs/$songId/edit",getParentRoute:()=>Vn}),Nee=X5.update({id:"/auth/youtube/callback",path:"/auth/youtube/callback",getParentRoute:()=>Vn}),Tee={CustomPagePageIdRoute:See,SchedulesScheduleIdRoute:wee,ScreenScreenIdRoute:vee,rootIndexRoute:bee,BibleIndexRoute:xee,DashboardIndexRoute:yee,LivestreamIndexRoute:mee,PresentIndexRoute:gee,SchedulesIndexRoute:pee,SettingsIndexRoute:hee,SongsIndexRoute:fee,AuthYoutubeCallbackRoute:Nee,SongsSongIdEditRoute:Cee,SongsSongIdIndexRoute:kee},jee=Vn._addFileChildren(Tee)._addFileTypes();async function Eee(){return await Yt("get_server_config")}const Mee=ZO({routeTree:jee,defaultPreload:"intent"}),d1=typeof window<"u"&&"__TAURI_INTERNALS__"in window,Aee=d1&&pn()?hi:window.fetch.bind(window),Ree=performance.now(),Ln=t=>{console.log(`[client-startup] ${t}: ${(performance.now()-Ree).toFixed(1)}ms`)};Ln("script_loaded");if(typeof window<"u"&&window.__htmlLoadTime){const t=performance.now()-window.__htmlLoadTime;console.log(`[client-startup] module_executed (time since HTML): ${t.toFixed(1)}ms`)}const J5=typeof window<"u"&&"__TAURI_INTERNALS__"in window;Ln(`tauri_check (isTauri=${J5})`);function Ap(t){const e=document.getElementById("loading-status");e&&(e.textContent=t)}let ej=!1;function Dn(t){const e=document.getElementById("loading-logs");e&&(ej||(e.textContent="",ej=!0),e.textContent+=`${t}
`,e.scrollTop=e.scrollHeight)}function pb(){const t=document.getElementById("loading-screen");t&&(t.style.opacity="0",t.style.transition="opacity 0.3s ease-out",setTimeout(()=>t.remove(),300))}async function tj(t,e=60){const n=`${t}/ping`,r=performance.now(),s=J5?100:500;for(let i=1;i<=e;i++){try{const o=performance.now();if(Dn(`[${new Date().toLocaleTimeString()}] Checking server... (attempt ${i})`),(await Aee(n,{method:"GET"})).ok){const d=(performance.now()-r).toFixed(1),f=(performance.now()-o).toFixed(1);return Dn(`[${new Date().toLocaleTimeString()}] Server is ready! (attempt took ${f}ms, total wait ${d}ms)`),console.log(`[client-startup] waitForServer success: attempt=${i}, attemptTime=${f}ms, totalWait=${d}ms`),Ap("Server ready, loading app..."),!0}}catch(o){console.log(`[client-startup] waitForServer attempt ${i} failed:`,o)}i<e&&await new Promise(o=>setTimeout(o,s))}return Dn(`[${new Date().toLocaleTimeString()}] Server failed to start after ${e} attempts`),Ap("Failed to connect to server"),!1}if(typeof window<"u")if(window.__appVersion="0.0.0",window.__envMode="production",d1)try{if(Ln("tauri_block_start"),Dn(`[${new Date().toLocaleTimeString()}] Church Hub starting...`),Dn(`[${new Date().toLocaleTimeString()}] Initializing Tauri context...`),pn())if(Ln("mobile_mode"),Dn(`[${new Date().toLocaleTimeString()}] Mobile mode detected`),Ej())Dn(`[${new Date().toLocaleTimeString()}] API URL not configured - showing setup`),pb();else{const t=Ct();if(t){Dn(`[${new Date().toLocaleTimeString()}] API URL: ${t}`),Ap("Connecting to server..."),Ln("before_waitForServer");const e=await tj(t,10);Ln("after_waitForServer"),e?Dn(`[${new Date().toLocaleTimeString()}] Connected! Mounting React application...`):(console.error("[router] Failed to connect to remote server"),Dn(`[${new Date().toLocaleTimeString()}] Failed to connect to server`))}}else{Dn(`[${new Date().toLocaleTimeString()}] Getting server configuration...`),Ln("before_getServerConfig");const t=await Eee();Ln("after_getServerConfig"),t&&(window.__serverConfig={serverPort:t.serverPort},Dn(`[${new Date().toLocaleTimeString()}] Server port: ${t.serverPort}`)),Ap("Waiting for server...");const e=Ct();Dn(`[${new Date().toLocaleTimeString()}] API URL: ${e}`),Ln("before_waitForServer");const n=await tj(e,5);Ln("after_waitForServer"),n?Dn(`[${new Date().toLocaleTimeString()}] Mounting React application...`):console.error("[router] Server failed to start")}}catch(t){console.error("[router] Error getting server config:",t),Dn(`[${new Date().toLocaleTimeString()}] Error: ${t}`)}else pb();Ln("before_react_mount");const nj=document.getElementById("app");function _ee(){const[t,e]=St.useState(Ej());return t?u.jsx(CL,{onComplete:()=>{e(!1),window.location.reload()}}):u.jsx(nI,{router:Mee})}if(!nj.innerHTML){const t=fI.createRoot(nj);Ln("react_root_created"),t.render(u.jsx(_ee,{})),Ln("react_render_called"),d1&&(pb(),Ln("loading_screen_hidden"))}Ln("script_complete");export{aI as R,M2 as S,Yt as i,iI as t};
